{"version":3,"sources":["turbopack:///[project]/apps/admin/src/lib/stores/campaign-store.ts","turbopack:///[project]/apps/admin/src/components/marketing/audience-selector.tsx","turbopack:///[project]/apps/admin/src/components/marketing/campaign-builder.tsx","turbopack:///[project]/apps/admin/src/actions/data:7b52ff <text/javascript>","turbopack:///[project]/apps/admin/src/actions/data:ea4a16 <text/javascript>","turbopack:///[project]/apps/admin/src/actions/data:47fe4b <text/javascript>","turbopack:///[project]/apps/admin/src/app/(dashboard)/dashboard/marketing/campaigns/new/page.tsx","turbopack:///[project]/node_modules/.pnpm/lucide-react@0.552.0_react@19.2.0/node_modules/lucide-react/src/icons/funnel.ts","turbopack:///[project]/node_modules/.pnpm/lucide-react@0.552.0_react@19.2.0/node_modules/lucide-react/src/icons/arrow-right.ts"],"sourcesContent":["/**\n * Email Campaign Store - Zustand state management\n *\n * Manages campaign state for the admin marketing panel:\n * - Campaign list with filtering/sorting\n * - Selected campaign for detail view\n * - Campaign builder wizard state\n * - Sending progress tracking\n * - Audience preview state\n */\n\nimport { create } from \"zustand\";\nimport type {\n\tEmailCampaign,\n\tEmailCampaignStatus,\n\tEmailCampaignAudienceType,\n\tCampaignDraft,\n\tCampaignBuilderStep,\n\tAudienceFilter,\n\tWaitlistStats,\n} from \"@/types/campaigns\";\n\n// ============================================================================\n// Filter & Sort Types\n// ============================================================================\n\ntype CampaignSortField = \"name\" | \"status\" | \"createdAt\" | \"scheduledFor\" | \"sentAt\" | \"openRate\" | \"clickRate\";\ntype SortDirection = \"asc\" | \"desc\";\n\ntype CampaignFilters = {\n\tstatus?: EmailCampaignStatus[];\n\taudienceType?: EmailCampaignAudienceType[];\n\tdateRange?: {\n\t\tstart: string;\n\t\tend: string;\n\t};\n\tsearch?: string;\n\ttags?: string[];\n};\n\n// ============================================================================\n// Builder State Types\n// ============================================================================\n\ntype BuilderState = {\n\tisOpen: boolean;\n\tcurrentStep: CampaignBuilderStep;\n\tdraft: CampaignDraft;\n\teditingCampaignId?: string;\n\tisDirty: boolean;\n\tvalidationErrors: Record<string, string>;\n};\n\nconst defaultDraft: CampaignDraft = {\n\tname: \"\",\n\tsubject: \"\",\n\tpreviewText: \"\",\n\taudienceType: \"waitlist\",\n\taudienceFilter: {\n\t\texcludeUnsubscribed: true,\n\t\texcludeBounced: true,\n\t\texcludeComplained: true,\n\t},\n\tfromName: \"Thorbis\",\n\tfromEmail: \"noreply@thorbis.com\",\n\ttags: [],\n};\n\n// ============================================================================\n// Sending State Types\n// ============================================================================\n\ntype SendingProgress = {\n\tcampaignId: string;\n\tstatus: \"preparing\" | \"sending\" | \"completed\" | \"failed\" | \"cancelled\";\n\ttotalRecipients: number;\n\tsentCount: number;\n\tfailedCount: number;\n\tstartedAt: string;\n\testimatedCompletionTime?: string;\n\terrorMessage?: string;\n};\n\n// ============================================================================\n// Audience Preview Types\n// ============================================================================\n\ntype AudiencePreview = {\n\tisLoading: boolean;\n\testimatedCount: number;\n\tsampleRecipients: {\n\t\temail: string;\n\t\tname?: string;\n\t\ttype: string;\n\t}[];\n\tlastUpdated?: string;\n};\n\n// ============================================================================\n// Store Type Definition\n// ============================================================================\n\ntype CampaignStore = {\n\t// -------------------------------------------------------------------------\n\t// Campaign List State\n\t// -------------------------------------------------------------------------\n\tcampaigns: EmailCampaign[];\n\tsetCampaigns: (campaigns: EmailCampaign[]) => void;\n\taddCampaign: (campaign: EmailCampaign) => void;\n\tupdateCampaign: (id: string, updates: Partial<EmailCampaign>) => void;\n\tremoveCampaign: (id: string) => void;\n\n\t// List loading state\n\tisLoading: boolean;\n\tsetIsLoading: (loading: boolean) => void;\n\terror: string | null;\n\tsetError: (error: string | null) => void;\n\n\t// -------------------------------------------------------------------------\n\t// Selection State\n\t// -------------------------------------------------------------------------\n\tselectedCampaignId: string | null;\n\tsetSelectedCampaignId: (id: string | null) => void;\n\n\t// -------------------------------------------------------------------------\n\t// Filters & Sorting\n\t// -------------------------------------------------------------------------\n\tfilters: CampaignFilters;\n\tsetFilters: (filters: Partial<CampaignFilters>) => void;\n\tresetFilters: () => void;\n\n\tsortField: CampaignSortField;\n\tsortDirection: SortDirection;\n\tsetSort: (field: CampaignSortField, direction?: SortDirection) => void;\n\n\t// -------------------------------------------------------------------------\n\t// Campaign Builder State\n\t// -------------------------------------------------------------------------\n\tbuilder: BuilderState;\n\topenBuilder: (campaignId?: string) => void;\n\tcloseBuilder: () => void;\n\tsetBuilderStep: (step: CampaignBuilderStep) => void;\n\tupdateDraft: (updates: Partial<CampaignDraft>) => void;\n\tsetValidationErrors: (errors: Record<string, string>) => void;\n\tclearValidationError: (field: string) => void;\n\tresetBuilder: () => void;\n\n\t// -------------------------------------------------------------------------\n\t// Audience Preview State\n\t// -------------------------------------------------------------------------\n\taudiencePreview: AudiencePreview;\n\tsetAudiencePreview: (preview: Partial<AudiencePreview>) => void;\n\tresetAudiencePreview: () => void;\n\n\t// -------------------------------------------------------------------------\n\t// Sending Progress State\n\t// -------------------------------------------------------------------------\n\tsendingProgress: SendingProgress | null;\n\tsetSendingProgress: (progress: SendingProgress | null) => void;\n\tupdateSendingProgress: (updates: Partial<SendingProgress>) => void;\n\n\t// -------------------------------------------------------------------------\n\t// Waitlist Stats (for dashboard)\n\t// -------------------------------------------------------------------------\n\twaitlistStats: WaitlistStats | null;\n\tsetWaitlistStats: (stats: WaitlistStats | null) => void;\n\n\t// -------------------------------------------------------------------------\n\t// UI State\n\t// -------------------------------------------------------------------------\n\tactiveTab: \"campaigns\" | \"templates\" | \"segments\" | \"settings\";\n\tsetActiveTab: (tab: \"campaigns\" | \"templates\" | \"segments\" | \"settings\") => void;\n\n\t// Preview modal\n\tpreviewCampaignId: string | null;\n\tsetPreviewCampaignId: (id: string | null) => void;\n\n\t// Delete confirmation\n\tdeletingCampaignId: string | null;\n\tsetDeletingCampaignId: (id: string | null) => void;\n};\n\n// ============================================================================\n// Store Implementation\n// ============================================================================\n\nexport const useCampaignStore = create<CampaignStore>((set, get) => ({\n\t// -------------------------------------------------------------------------\n\t// Campaign List State\n\t// -------------------------------------------------------------------------\n\tcampaigns: [],\n\tsetCampaigns: (campaigns) => set({ campaigns }),\n\taddCampaign: (campaign) =>\n\t\tset((state) => ({\n\t\t\tcampaigns: [campaign, ...state.campaigns],\n\t\t})),\n\tupdateCampaign: (id, updates) =>\n\t\tset((state) => ({\n\t\t\tcampaigns: state.campaigns.map((c) => (c.id === id ? { ...c, ...updates } : c)),\n\t\t})),\n\tremoveCampaign: (id) =>\n\t\tset((state) => ({\n\t\t\tcampaigns: state.campaigns.filter((c) => c.id !== id),\n\t\t\tselectedCampaignId: state.selectedCampaignId === id ? null : state.selectedCampaignId,\n\t\t})),\n\n\tisLoading: false,\n\tsetIsLoading: (isLoading) => set({ isLoading }),\n\terror: null,\n\tsetError: (error) => set({ error }),\n\n\t// -------------------------------------------------------------------------\n\t// Selection State\n\t// -------------------------------------------------------------------------\n\tselectedCampaignId: null,\n\tsetSelectedCampaignId: (id) => set({ selectedCampaignId: id }),\n\n\t// -------------------------------------------------------------------------\n\t// Filters & Sorting\n\t// -------------------------------------------------------------------------\n\tfilters: {},\n\tsetFilters: (filters) =>\n\t\tset((state) => ({\n\t\t\tfilters: { ...state.filters, ...filters },\n\t\t})),\n\tresetFilters: () => set({ filters: {} }),\n\n\tsortField: \"createdAt\",\n\tsortDirection: \"desc\",\n\tsetSort: (field, direction) =>\n\t\tset((state) => ({\n\t\t\tsortField: field,\n\t\t\tsortDirection: direction ?? (state.sortField === field && state.sortDirection === \"asc\" ? \"desc\" : \"asc\"),\n\t\t})),\n\n\t// -------------------------------------------------------------------------\n\t// Campaign Builder State\n\t// -------------------------------------------------------------------------\n\tbuilder: {\n\t\tisOpen: false,\n\t\tcurrentStep: \"details\",\n\t\tdraft: { ...defaultDraft },\n\t\tisDirty: false,\n\t\tvalidationErrors: {},\n\t},\n\topenBuilder: (campaignId) => {\n\t\tconst { campaigns } = get();\n\t\tconst existingCampaign = campaignId ? campaigns.find((c) => c.id === campaignId) : null;\n\n\t\tif (existingCampaign) {\n\t\t\t// Load existing campaign into draft\n\t\t\tset({\n\t\t\t\tbuilder: {\n\t\t\t\t\tisOpen: true,\n\t\t\t\t\tcurrentStep: \"details\",\n\t\t\t\t\teditingCampaignId: campaignId,\n\t\t\t\t\tisDirty: false,\n\t\t\t\t\tvalidationErrors: {},\n\t\t\t\t\tdraft: {\n\t\t\t\t\t\tname: existingCampaign.name,\n\t\t\t\t\t\tsubject: existingCampaign.subject,\n\t\t\t\t\t\tpreviewText: existingCampaign.previewText || \"\",\n\t\t\t\t\t\ttemplateId: existingCampaign.templateId,\n\t\t\t\t\t\ttemplateData: existingCampaign.templateData,\n\t\t\t\t\t\thtmlContent: existingCampaign.htmlContent,\n\t\t\t\t\t\tplainTextContent: existingCampaign.plainTextContent,\n\t\t\t\t\t\taudienceType: existingCampaign.audienceType,\n\t\t\t\t\t\taudienceFilter: existingCampaign.audienceFilter || defaultDraft.audienceFilter,\n\t\t\t\t\t\tfromName: existingCampaign.fromName,\n\t\t\t\t\t\tfromEmail: existingCampaign.fromEmail,\n\t\t\t\t\t\treplyTo: existingCampaign.replyTo,\n\t\t\t\t\t\ttags: existingCampaign.tags,\n\t\t\t\t\t\tnotes: existingCampaign.notes,\n\t\t\t\t\t\tscheduledFor: existingCampaign.scheduledFor,\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t});\n\t\t} else {\n\t\t\t// New campaign\n\t\t\tset({\n\t\t\t\tbuilder: {\n\t\t\t\t\tisOpen: true,\n\t\t\t\t\tcurrentStep: \"details\",\n\t\t\t\t\tdraft: { ...defaultDraft },\n\t\t\t\t\tisDirty: false,\n\t\t\t\t\tvalidationErrors: {},\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\t},\n\tcloseBuilder: () =>\n\t\tset({\n\t\t\tbuilder: {\n\t\t\t\tisOpen: false,\n\t\t\t\tcurrentStep: \"details\",\n\t\t\t\tdraft: { ...defaultDraft },\n\t\t\t\tisDirty: false,\n\t\t\t\tvalidationErrors: {},\n\t\t\t},\n\t\t}),\n\tsetBuilderStep: (step) =>\n\t\tset((state) => ({\n\t\t\tbuilder: { ...state.builder, currentStep: step },\n\t\t})),\n\tupdateDraft: (updates) =>\n\t\tset((state) => ({\n\t\t\tbuilder: {\n\t\t\t\t...state.builder,\n\t\t\t\tdraft: { ...state.builder.draft, ...updates },\n\t\t\t\tisDirty: true,\n\t\t\t},\n\t\t})),\n\tsetValidationErrors: (errors) =>\n\t\tset((state) => ({\n\t\t\tbuilder: { ...state.builder, validationErrors: errors },\n\t\t})),\n\tclearValidationError: (field) =>\n\t\tset((state) => {\n\t\t\tconst { [field]: _, ...rest } = state.builder.validationErrors;\n\t\t\treturn {\n\t\t\t\tbuilder: { ...state.builder, validationErrors: rest },\n\t\t\t};\n\t\t}),\n\tresetBuilder: () =>\n\t\tset({\n\t\t\tbuilder: {\n\t\t\t\tisOpen: false,\n\t\t\t\tcurrentStep: \"details\",\n\t\t\t\tdraft: { ...defaultDraft },\n\t\t\t\tisDirty: false,\n\t\t\t\tvalidationErrors: {},\n\t\t\t},\n\t\t}),\n\n\t// -------------------------------------------------------------------------\n\t// Audience Preview State\n\t// -------------------------------------------------------------------------\n\taudiencePreview: {\n\t\tisLoading: false,\n\t\testimatedCount: 0,\n\t\tsampleRecipients: [],\n\t},\n\tsetAudiencePreview: (preview) =>\n\t\tset((state) => ({\n\t\t\taudiencePreview: { ...state.audiencePreview, ...preview },\n\t\t})),\n\tresetAudiencePreview: () =>\n\t\tset({\n\t\t\taudiencePreview: {\n\t\t\t\tisLoading: false,\n\t\t\t\testimatedCount: 0,\n\t\t\t\tsampleRecipients: [],\n\t\t\t},\n\t\t}),\n\n\t// -------------------------------------------------------------------------\n\t// Sending Progress State\n\t// -------------------------------------------------------------------------\n\tsendingProgress: null,\n\tsetSendingProgress: (progress) => set({ sendingProgress: progress }),\n\tupdateSendingProgress: (updates) =>\n\t\tset((state) => ({\n\t\t\tsendingProgress: state.sendingProgress ? { ...state.sendingProgress, ...updates } : null,\n\t\t})),\n\n\t// -------------------------------------------------------------------------\n\t// Waitlist Stats\n\t// -------------------------------------------------------------------------\n\twaitlistStats: null,\n\tsetWaitlistStats: (stats) => set({ waitlistStats: stats }),\n\n\t// -------------------------------------------------------------------------\n\t// UI State\n\t// -------------------------------------------------------------------------\n\tactiveTab: \"campaigns\",\n\tsetActiveTab: (tab) => set({ activeTab: tab }),\n\n\tpreviewCampaignId: null,\n\tsetPreviewCampaignId: (id) => set({ previewCampaignId: id }),\n\n\tdeletingCampaignId: null,\n\tsetDeletingCampaignId: (id) => set({ deletingCampaignId: id }),\n}));\n\n// ============================================================================\n// Selector Hooks (for optimized re-renders)\n// ============================================================================\n\n/** Get filtered and sorted campaigns */\nexport const useFilteredCampaigns = () => {\n\treturn useCampaignStore((state) => {\n\t\tlet filtered = [...state.campaigns];\n\n\t\t// Apply filters\n\t\tif (state.filters.status?.length) {\n\t\t\tfiltered = filtered.filter((c) => state.filters.status!.includes(c.status));\n\t\t}\n\t\tif (state.filters.audienceType?.length) {\n\t\t\tfiltered = filtered.filter((c) => state.filters.audienceType!.includes(c.audienceType));\n\t\t}\n\t\tif (state.filters.search) {\n\t\t\tconst search = state.filters.search.toLowerCase();\n\t\t\tfiltered = filtered.filter(\n\t\t\t\t(c) => c.name.toLowerCase().includes(search) || c.subject.toLowerCase().includes(search) || c.tags.some((t) => t.toLowerCase().includes(search))\n\t\t\t);\n\t\t}\n\t\tif (state.filters.tags?.length) {\n\t\t\tfiltered = filtered.filter((c) => state.filters.tags!.some((t) => c.tags.includes(t)));\n\t\t}\n\t\tif (state.filters.dateRange) {\n\t\t\tconst { start, end } = state.filters.dateRange;\n\t\t\tfiltered = filtered.filter((c) => {\n\t\t\t\tconst date = new Date(c.createdAt);\n\t\t\t\treturn date >= new Date(start) && date <= new Date(end);\n\t\t\t});\n\t\t}\n\n\t\t// Apply sorting\n\t\tfiltered.sort((a, b) => {\n\t\t\tlet aVal: string | number | undefined;\n\t\t\tlet bVal: string | number | undefined;\n\n\t\t\tswitch (state.sortField) {\n\t\t\t\tcase \"name\":\n\t\t\t\t\taVal = a.name.toLowerCase();\n\t\t\t\t\tbVal = b.name.toLowerCase();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"status\":\n\t\t\t\t\taVal = a.status;\n\t\t\t\t\tbVal = b.status;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"createdAt\":\n\t\t\t\t\taVal = a.createdAt;\n\t\t\t\t\tbVal = b.createdAt;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"scheduledFor\":\n\t\t\t\t\taVal = a.scheduledFor || \"\";\n\t\t\t\t\tbVal = b.scheduledFor || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sentAt\":\n\t\t\t\t\taVal = a.sentAt || \"\";\n\t\t\t\t\tbVal = b.sentAt || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"openRate\":\n\t\t\t\t\taVal = a.totalRecipients > 0 ? a.uniqueOpens / a.totalRecipients : 0;\n\t\t\t\t\tbVal = b.totalRecipients > 0 ? b.uniqueOpens / b.totalRecipients : 0;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"clickRate\":\n\t\t\t\t\taVal = a.totalRecipients > 0 ? a.uniqueClicks / a.totalRecipients : 0;\n\t\t\t\t\tbVal = b.totalRecipients > 0 ? b.uniqueClicks / b.totalRecipients : 0;\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\taVal = a.createdAt;\n\t\t\t\t\tbVal = b.createdAt;\n\t\t\t}\n\n\t\t\tif (aVal === undefined || bVal === undefined) return 0;\n\t\t\tif (aVal < bVal) return state.sortDirection === \"asc\" ? -1 : 1;\n\t\t\tif (aVal > bVal) return state.sortDirection === \"asc\" ? 1 : -1;\n\t\t\treturn 0;\n\t\t});\n\n\t\treturn filtered;\n\t});\n};\n\n/** Get selected campaign */\nexport const useSelectedCampaign = () => {\n\treturn useCampaignStore((state) => (state.selectedCampaignId ? state.campaigns.find((c) => c.id === state.selectedCampaignId) || null : null));\n};\n\n/** Get campaign stats summary */\nexport const useCampaignStats = () => {\n\treturn useCampaignStore((state) => {\n\t\tconst campaigns = state.campaigns;\n\t\treturn {\n\t\t\ttotal: campaigns.length,\n\t\t\tdraft: campaigns.filter((c) => c.status === \"draft\").length,\n\t\t\tscheduled: campaigns.filter((c) => c.status === \"scheduled\").length,\n\t\t\tsending: campaigns.filter((c) => c.status === \"sending\").length,\n\t\t\tsent: campaigns.filter((c) => c.status === \"sent\").length,\n\t\t\ttotalRecipients: campaigns.reduce((sum, c) => sum + c.totalRecipients, 0),\n\t\t\ttotalOpens: campaigns.reduce((sum, c) => sum + c.uniqueOpens, 0),\n\t\t\ttotalClicks: campaigns.reduce((sum, c) => sum + c.uniqueClicks, 0),\n\t\t\ttotalRevenue: campaigns.reduce((sum, c) => sum + c.revenueAttributed, 0),\n\t\t};\n\t});\n};\n\n/** Check if builder has unsaved changes */\nexport const useBuilderIsDirty = () => {\n\treturn useCampaignStore((state) => state.builder.isDirty);\n};\n","\"use client\";\n\n/**\n * Audience Selector Component\n *\n * Allows selection of campaign audience type and filters.\n * Used in the campaign builder for targeting recipients.\n */\n\nimport { useState, useEffect } from \"react\";\nimport {\n\tBuilding2,\n\tCheck,\n\tClock,\n\tFilter,\n\tMail,\n\tUsers,\n\tLoader2,\n} from \"lucide-react\";\nimport { Button, Label, cn } from \"@stratos/ui\";\nimport { Checkbox } from \"@/components/ui/checkbox\";\nimport type { EmailCampaignAudienceType, AudienceFilter } from \"@/types/campaigns\";\nimport { useCampaignStore } from \"@/lib/stores/campaign-store\";\n\ntype AudienceSelectorProps = {\n\tvalue: EmailCampaignAudienceType;\n\tfilter?: AudienceFilter;\n\tonChange: (type: EmailCampaignAudienceType, filter: AudienceFilter) => void;\n\terror?: string;\n};\n\ntype AudienceOption = {\n\tid: EmailCampaignAudienceType;\n\tlabel: string;\n\tdescription: string;\n\ticon: typeof Users;\n\ticonColor: string;\n\tbgColor: string;\n};\n\nconst AUDIENCE_OPTIONS: AudienceOption[] = [\n\t{\n\t\tid: \"waitlist\",\n\t\tlabel: \"Waitlist Subscribers\",\n\t\tdescription: \"Send to everyone who signed up for the waitlist\",\n\t\ticon: Clock,\n\t\ticonColor: \"text-emerald-600\",\n\t\tbgColor: \"bg-emerald-500/10\",\n\t},\n\t{\n\t\tid: \"all_users\",\n\t\tlabel: \"All Platform Users\",\n\t\tdescription: \"Send to all registered users across all companies\",\n\t\ticon: Users,\n\t\ticonColor: \"text-blue-600\",\n\t\tbgColor: \"bg-blue-500/10\",\n\t},\n\t{\n\t\tid: \"all_companies\",\n\t\tlabel: \"All Companies\",\n\t\tdescription: \"Send to company owners/admins only\",\n\t\ticon: Building2,\n\t\ticonColor: \"text-purple-600\",\n\t\tbgColor: \"bg-purple-500/10\",\n\t},\n\t{\n\t\tid: \"segment\",\n\t\tlabel: \"Custom Segment\",\n\t\tdescription: \"Filter users or companies by specific criteria\",\n\t\ticon: Filter,\n\t\ticonColor: \"text-amber-600\",\n\t\tbgColor: \"bg-amber-500/10\",\n\t},\n\t{\n\t\tid: \"custom\",\n\t\tlabel: \"Custom Email List\",\n\t\tdescription: \"Enter specific email addresses manually\",\n\t\ticon: Mail,\n\t\ticonColor: \"text-gray-600\",\n\t\tbgColor: \"bg-gray-500/10\",\n\t},\n];\n\nexport function AudienceSelector({ value, filter, onChange, error }: AudienceSelectorProps) {\n\tconst [localFilter, setLocalFilter] = useState<AudienceFilter>(\n\t\tfilter || {\n\t\t\texcludeUnsubscribed: true,\n\t\t\texcludeBounced: true,\n\t\t\texcludeComplained: true,\n\t\t}\n\t);\n\tconst [customEmails, setCustomEmails] = useState<string>(\n\t\tfilter?.customEmails?.join(\"\\n\") || \"\"\n\t);\n\n\tconst { audiencePreview, setAudiencePreview } = useCampaignStore();\n\n\t// Simulate fetching audience count when selection changes\n\tuseEffect(() => {\n\t\tsetAudiencePreview({ isLoading: true });\n\n\t\t// Simulate API call\n\t\tconst timer = setTimeout(() => {\n\t\t\tconst counts: Record<EmailCampaignAudienceType, number> = {\n\t\t\t\twaitlist: 2156,\n\t\t\t\tall_users: 8432,\n\t\t\t\tall_companies: 342,\n\t\t\t\tsegment: 0,\n\t\t\t\tcustom: customEmails.split(\"\\n\").filter((e) => e.trim()).length,\n\t\t\t};\n\n\t\t\tsetAudiencePreview({\n\t\t\t\tisLoading: false,\n\t\t\t\testimatedCount: counts[value] || 0,\n\t\t\t\tsampleRecipients: [\n\t\t\t\t\t{ email: \"john@example.com\", name: \"John Doe\", type: value },\n\t\t\t\t\t{ email: \"jane@example.com\", name: \"Jane Smith\", type: value },\n\t\t\t\t\t{ email: \"mike@example.com\", name: \"Mike Johnson\", type: value },\n\t\t\t\t],\n\t\t\t\tlastUpdated: new Date().toISOString(),\n\t\t\t});\n\t\t}, 500);\n\n\t\treturn () => clearTimeout(timer);\n\t}, [value, customEmails, setAudiencePreview]);\n\n\tconst handleTypeChange = (type: EmailCampaignAudienceType) => {\n\t\tonChange(type, localFilter);\n\t};\n\n\tconst handleFilterChange = (updates: Partial<AudienceFilter>) => {\n\t\tconst newFilter = { ...localFilter, ...updates };\n\t\tsetLocalFilter(newFilter);\n\t\tonChange(value, newFilter);\n\t};\n\n\tconst handleCustomEmailsChange = (emails: string) => {\n\t\tsetCustomEmails(emails);\n\t\tconst emailList = emails\n\t\t\t.split(\"\\n\")\n\t\t\t.map((e) => e.trim())\n\t\t\t.filter((e) => e && e.includes(\"@\"));\n\t\thandleFilterChange({ customEmails: emailList });\n\t};\n\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t{/* Audience Type Selection */}\n\t\t\t<div className=\"grid gap-3\">\n\t\t\t\t{AUDIENCE_OPTIONS.map((option) => {\n\t\t\t\t\tconst isSelected = value === option.id;\n\t\t\t\t\tconst Icon = option.icon;\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tkey={option.id}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex items-start gap-4 rounded-lg border p-4 text-left transition-colors\",\n\t\t\t\t\t\t\t\tisSelected\n\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5 ring-1 ring-primary\"\n\t\t\t\t\t\t\t\t\t: \"hover:border-primary/50 hover:bg-muted/50\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={() => handleTypeChange(option.id)}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className={cn(\"rounded-lg p-2\", option.bgColor)}>\n\t\t\t\t\t\t\t\t<Icon className={cn(\"size-5\", option.iconColor)} />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">{option.label}</p>\n\t\t\t\t\t\t\t\t\t{isSelected && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"rounded-full bg-primary p-0.5\">\n\t\t\t\t\t\t\t\t\t\t\t<Check className=\"size-3 text-primary-foreground\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">{option.description}</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t);\n\t\t\t\t})}\n\t\t\t</div>\n\n\t\t\t{error && <p className=\"text-sm text-destructive\">{error}</p>}\n\n\t\t\t{/* Filter Options for Segment */}\n\t\t\t{value === \"segment\" && (\n\t\t\t\t<div className=\"rounded-lg border p-4 space-y-4\">\n\t\t\t\t\t<h4 className=\"font-medium\">Segment Filters</h4>\n\n\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t{/* User Roles */}\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<Label className=\"text-sm\">User Roles</Label>\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t{([\"owner\", \"admin\", \"manager\", \"technician\"] as const).map((role) => (\n\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\tkey={role}\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-2 rounded border px-3 py-1.5 text-sm cursor-pointer hover:bg-muted\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\t\t\t\t\tchecked={localFilter.userRoles?.includes(role) || false}\n\t\t\t\t\t\t\t\t\t\t\tonCheckedChange={(checked) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst currentRoles = localFilter.userRoles || [];\n\t\t\t\t\t\t\t\t\t\t\t\tconst newRoles = checked\n\t\t\t\t\t\t\t\t\t\t\t\t\t? [...currentRoles, role]\n\t\t\t\t\t\t\t\t\t\t\t\t\t: currentRoles.filter((r) => r !== role);\n\t\t\t\t\t\t\t\t\t\t\t\thandleFilterChange({ userRoles: newRoles.length > 0 ? newRoles : undefined });\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<span className=\"capitalize\">{role}</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Company Plans */}\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<Label className=\"text-sm\">Company Plans</Label>\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t{([\"starter\", \"professional\", \"enterprise\"] as const).map((plan) => (\n\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\tkey={plan}\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-2 rounded border px-3 py-1.5 text-sm cursor-pointer hover:bg-muted\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\t\t\t\t\tchecked={localFilter.companyPlans?.includes(plan) || false}\n\t\t\t\t\t\t\t\t\t\t\tonCheckedChange={(checked) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst currentPlans = localFilter.companyPlans || [];\n\t\t\t\t\t\t\t\t\t\t\t\tconst newPlans = checked\n\t\t\t\t\t\t\t\t\t\t\t\t\t? [...currentPlans, plan]\n\t\t\t\t\t\t\t\t\t\t\t\t\t: currentPlans.filter((p) => p !== plan);\n\t\t\t\t\t\t\t\t\t\t\t\thandleFilterChange({ companyPlans: newPlans.length > 0 ? newPlans : undefined });\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<span className=\"capitalize\">{plan}</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Status Filters */}\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<Label className=\"text-sm\">Company Status</Label>\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap gap-2\">\n\t\t\t\t\t\t\t\t{([\"active\", \"trial\", \"suspended\"] as const).map((status) => (\n\t\t\t\t\t\t\t\t\t<label\n\t\t\t\t\t\t\t\t\t\tkey={status}\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex items-center gap-2 rounded border px-3 py-1.5 text-sm cursor-pointer hover:bg-muted\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\t\t\t\t\tchecked={localFilter.companyStatuses?.includes(status) || false}\n\t\t\t\t\t\t\t\t\t\t\tonCheckedChange={(checked) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst currentStatuses = localFilter.companyStatuses || [];\n\t\t\t\t\t\t\t\t\t\t\t\tconst newStatuses = checked\n\t\t\t\t\t\t\t\t\t\t\t\t\t? [...currentStatuses, status]\n\t\t\t\t\t\t\t\t\t\t\t\t\t: currentStatuses.filter((s) => s !== status);\n\t\t\t\t\t\t\t\t\t\t\t\thandleFilterChange({ companyStatuses: newStatuses.length > 0 ? newStatuses : undefined });\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<span className=\"capitalize\">{status}</span>\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* Custom Email Input */}\n\t\t\t{value === \"custom\" && (\n\t\t\t\t<div className=\"rounded-lg border p-4 space-y-4\">\n\t\t\t\t\t<h4 className=\"font-medium\">Custom Email List</h4>\n\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\tEnter email addresses, one per line\n\t\t\t\t\t</p>\n\t\t\t\t\t<textarea\n\t\t\t\t\t\tclassName=\"w-full min-h-[150px] rounded-md border bg-background px-3 py-2 text-sm font-mono\"\n\t\t\t\t\t\tplaceholder={\"john@example.com\\njane@example.com\\nmike@example.com\"}\n\t\t\t\t\t\tvalue={customEmails}\n\t\t\t\t\t\tonChange={(e) => handleCustomEmailsChange(e.target.value)}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* Exclusion Options */}\n\t\t\t<div className=\"rounded-lg border p-4 space-y-4\">\n\t\t\t\t<h4 className=\"font-medium\">Exclusions</h4>\n\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t<label className=\"flex items-center gap-2 cursor-pointer\">\n\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\tchecked={localFilter.excludeUnsubscribed !== false}\n\t\t\t\t\t\t\tonCheckedChange={(checked) =>\n\t\t\t\t\t\t\t\thandleFilterChange({ excludeUnsubscribed: checked === true })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"text-sm\">Exclude unsubscribed contacts</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label className=\"flex items-center gap-2 cursor-pointer\">\n\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\tchecked={localFilter.excludeBounced !== false}\n\t\t\t\t\t\t\tonCheckedChange={(checked) =>\n\t\t\t\t\t\t\t\thandleFilterChange({ excludeBounced: checked === true })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"text-sm\">Exclude bounced emails</span>\n\t\t\t\t\t</label>\n\t\t\t\t\t<label className=\"flex items-center gap-2 cursor-pointer\">\n\t\t\t\t\t\t<Checkbox\n\t\t\t\t\t\t\tchecked={localFilter.excludeComplained !== false}\n\t\t\t\t\t\t\tonCheckedChange={(checked) =>\n\t\t\t\t\t\t\t\thandleFilterChange({ excludeComplained: checked === true })\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<span className=\"text-sm\">Exclude spam complaints</span>\n\t\t\t\t\t</label>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Audience Preview */}\n\t\t\t<div className=\"rounded-lg border bg-muted/30 p-4\">\n\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t<Users className=\"size-4 text-muted-foreground\" />\n\t\t\t\t\t\t<span className=\"text-sm font-medium\">Estimated Recipients</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t{audiencePreview.isLoading ? (\n\t\t\t\t\t\t<Loader2 className=\"size-4 animate-spin text-muted-foreground\" />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<span className=\"text-lg font-bold\">\n\t\t\t\t\t\t\t{audiencePreview.estimatedCount.toLocaleString()}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{!audiencePreview.isLoading && audiencePreview.sampleRecipients.length > 0 && (\n\t\t\t\t\t<div className=\"mt-3 pt-3 border-t\">\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mb-2\">Sample recipients:</p>\n\t\t\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t\t\t{audiencePreview.sampleRecipients.slice(0, 3).map((recipient, i) => (\n\t\t\t\t\t\t\t\t<div key={i} className=\"flex items-center gap-2 text-sm\">\n\t\t\t\t\t\t\t\t\t<Mail className=\"size-3 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t<span>{recipient.email}</span>\n\t\t\t\t\t\t\t\t\t{recipient.name && (\n\t\t\t\t\t\t\t\t\t\t<span className=\"text-muted-foreground\">({recipient.name})</span>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","\"use client\";\n\n/**\n * Campaign Builder Component\n *\n * Multi-step wizard for creating and editing email campaigns.\n * Steps: Details → Content → Audience → Review\n */\n\nimport { useState, useCallback } from \"react\";\nimport {\n\tArrowLeft,\n\tArrowRight,\n\tCheck,\n\tFileText,\n\tLoader2,\n\tMail,\n\tSend,\n\tUsers,\n\tEye,\n\tCalendar,\n\tClock,\n} from \"lucide-react\";\nimport { Button, Input, Label, Textarea, cn } from \"@stratos/ui\";\nimport { useCampaignStore } from \"@/lib/stores/campaign-store\";\nimport type { CampaignBuilderStep, CampaignDraft, EmailCampaignAudienceType } from \"@/types/campaigns\";\nimport { AudienceSelector } from \"./audience-selector\";\n\ntype CampaignBuilderProps = {\n\tonSave?: (draft: CampaignDraft) => Promise<void>;\n\tonSend?: (draft: CampaignDraft) => Promise<void>;\n\tonSchedule?: (draft: CampaignDraft, scheduledFor: string) => Promise<void>;\n\tonCancel?: () => void;\n\tisSubmitting?: boolean;\n};\n\nconst STEPS: { id: CampaignBuilderStep; label: string; icon: typeof FileText }[] = [\n\t{ id: \"details\", label: \"Details\", icon: FileText },\n\t{ id: \"content\", label: \"Content\", icon: Mail },\n\t{ id: \"audience\", label: \"Audience\", icon: Users },\n\t{ id: \"review\", label: \"Review\", icon: Eye },\n];\n\nexport function CampaignBuilder({\n\tonSave,\n\tonSend,\n\tonSchedule,\n\tonCancel,\n\tisSubmitting = false,\n}: CampaignBuilderProps) {\n\tconst { builder, setBuilderStep, updateDraft, setValidationErrors, clearValidationError } =\n\t\tuseCampaignStore();\n\tconst [scheduleDate, setScheduleDate] = useState<string>(\"\");\n\tconst [scheduleTime, setScheduleTime] = useState<string>(\"09:00\");\n\n\tconst { currentStep, draft, validationErrors, editingCampaignId } = builder;\n\tconst currentStepIndex = STEPS.findIndex((s) => s.id === currentStep);\n\n\t// Validation\n\tconst validateStep = useCallback(\n\t\t(step: CampaignBuilderStep): boolean => {\n\t\t\tconst errors: Record<string, string> = {};\n\n\t\t\tswitch (step) {\n\t\t\t\tcase \"details\":\n\t\t\t\t\tif (!draft.name.trim()) errors.name = \"Campaign name is required\";\n\t\t\t\t\tif (!draft.subject.trim()) errors.subject = \"Subject line is required\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"content\":\n\t\t\t\t\tif (!draft.htmlContent?.trim() && !draft.templateId) {\n\t\t\t\t\t\terrors.content = \"Email content or template is required\";\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"audience\":\n\t\t\t\t\tif (!draft.audienceType) errors.audienceType = \"Audience type is required\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif (Object.keys(errors).length > 0) {\n\t\t\t\tsetValidationErrors(errors);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\t[draft, setValidationErrors]\n\t);\n\n\tconst handleNext = useCallback(() => {\n\t\tif (!validateStep(currentStep)) return;\n\n\t\tconst nextIndex = currentStepIndex + 1;\n\t\tif (nextIndex < STEPS.length) {\n\t\t\tsetBuilderStep(STEPS[nextIndex]!.id);\n\t\t}\n\t}, [currentStep, currentStepIndex, validateStep, setBuilderStep]);\n\n\tconst handleBack = useCallback(() => {\n\t\tconst prevIndex = currentStepIndex - 1;\n\t\tif (prevIndex >= 0) {\n\t\t\tsetBuilderStep(STEPS[prevIndex]!.id);\n\t\t}\n\t}, [currentStepIndex, setBuilderStep]);\n\n\tconst handleStepClick = useCallback(\n\t\t(stepId: CampaignBuilderStep) => {\n\t\t\tconst targetIndex = STEPS.findIndex((s) => s.id === stepId);\n\t\t\t// Can only go back, or to current step\n\t\t\tif (targetIndex <= currentStepIndex) {\n\t\t\t\tsetBuilderStep(stepId);\n\t\t\t}\n\t\t},\n\t\t[currentStepIndex, setBuilderStep]\n\t);\n\n\tconst handleSave = useCallback(async () => {\n\t\tif (onSave) {\n\t\t\tawait onSave(draft);\n\t\t}\n\t}, [draft, onSave]);\n\n\tconst handleSend = useCallback(async () => {\n\t\tif (!validateStep(\"details\") || !validateStep(\"content\") || !validateStep(\"audience\")) {\n\t\t\treturn;\n\t\t}\n\t\tif (onSend) {\n\t\t\tawait onSend(draft);\n\t\t}\n\t}, [draft, onSend, validateStep]);\n\n\tconst handleSchedule = useCallback(async () => {\n\t\tif (!validateStep(\"details\") || !validateStep(\"content\") || !validateStep(\"audience\")) {\n\t\t\treturn;\n\t\t}\n\t\tif (!scheduleDate) {\n\t\t\tsetValidationErrors({ schedule: \"Please select a date\" });\n\t\t\treturn;\n\t\t}\n\t\tconst scheduledFor = `${scheduleDate}T${scheduleTime}:00.000Z`;\n\t\tif (onSchedule) {\n\t\t\tawait onSchedule(draft, scheduledFor);\n\t\t}\n\t}, [draft, onSchedule, scheduleDate, scheduleTime, validateStep, setValidationErrors]);\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col\">\n\t\t\t{/* Step Indicator */}\n\t\t\t<div className=\"border-b px-6 py-4\">\n\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t{STEPS.map((step, index) => {\n\t\t\t\t\t\tconst isActive = step.id === currentStep;\n\t\t\t\t\t\tconst isCompleted = index < currentStepIndex;\n\t\t\t\t\t\tconst isClickable = index <= currentStepIndex;\n\t\t\t\t\t\tconst Icon = step.icon;\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<div key={step.id} className=\"flex items-center\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors\",\n\t\t\t\t\t\t\t\t\t\tisActive && \"bg-primary text-primary-foreground\",\n\t\t\t\t\t\t\t\t\t\tisCompleted && !isActive && \"bg-emerald-100 text-emerald-700\",\n\t\t\t\t\t\t\t\t\t\t!isActive && !isCompleted && \"text-muted-foreground\",\n\t\t\t\t\t\t\t\t\t\tisClickable && !isActive && \"hover:bg-muted cursor-pointer\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tonClick={() => handleStepClick(step.id)}\n\t\t\t\t\t\t\t\t\tdisabled={!isClickable}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{isCompleted && !isActive ? (\n\t\t\t\t\t\t\t\t\t\t<Check className=\"size-4\" />\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<Icon className=\"size-4\" />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t<span className=\"hidden sm:inline\">{step.label}</span>\n\t\t\t\t\t\t\t\t\t<span className=\"sm:hidden\">{index + 1}</span>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t{index < STEPS.length - 1 && (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"mx-2 h-px w-8 sm:w-12\",\n\t\t\t\t\t\t\t\t\t\t\tindex < currentStepIndex ? \"bg-emerald-500\" : \"bg-border\"\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Step Content */}\n\t\t\t<div className=\"flex-1 overflow-auto p-6\">\n\t\t\t\t{currentStep === \"details\" && (\n\t\t\t\t\t<DetailsStep\n\t\t\t\t\t\tdraft={draft}\n\t\t\t\t\t\terrors={validationErrors}\n\t\t\t\t\t\tonChange={updateDraft}\n\t\t\t\t\t\tonClearError={clearValidationError}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{currentStep === \"content\" && (\n\t\t\t\t\t<ContentStep\n\t\t\t\t\t\tdraft={draft}\n\t\t\t\t\t\terrors={validationErrors}\n\t\t\t\t\t\tonChange={updateDraft}\n\t\t\t\t\t\tonClearError={clearValidationError}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{currentStep === \"audience\" && (\n\t\t\t\t\t<AudienceStep\n\t\t\t\t\t\tdraft={draft}\n\t\t\t\t\t\terrors={validationErrors}\n\t\t\t\t\t\tonChange={updateDraft}\n\t\t\t\t\t\tonClearError={clearValidationError}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t\t{currentStep === \"review\" && (\n\t\t\t\t\t<ReviewStep\n\t\t\t\t\t\tdraft={draft}\n\t\t\t\t\t\tscheduleDate={scheduleDate}\n\t\t\t\t\t\tscheduleTime={scheduleTime}\n\t\t\t\t\t\tonScheduleDateChange={setScheduleDate}\n\t\t\t\t\t\tonScheduleTimeChange={setScheduleTime}\n\t\t\t\t\t\terrors={validationErrors}\n\t\t\t\t\t/>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Footer Actions */}\n\t\t\t<div className=\"flex items-center justify-between border-t px-6 py-4\">\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t{currentStepIndex > 0 && (\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={handleBack} disabled={isSubmitting}>\n\t\t\t\t\t\t\t<ArrowLeft className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\tBack\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t{onCancel && (\n\t\t\t\t\t\t<Button variant=\"ghost\" onClick={onCancel} disabled={isSubmitting}>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t{onSave && (\n\t\t\t\t\t\t<Button variant=\"outline\" onClick={handleSave} disabled={isSubmitting}>\n\t\t\t\t\t\t\t{isSubmitting ? (\n\t\t\t\t\t\t\t\t<Loader2 className=\"mr-2 size-4 animate-spin\" />\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\tSave Draft\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\n\t\t\t\t\t{currentStep !== \"review\" ? (\n\t\t\t\t\t\t<Button onClick={handleNext} disabled={isSubmitting}>\n\t\t\t\t\t\t\tNext\n\t\t\t\t\t\t\t<ArrowRight className=\"ml-2 size-4\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t{onSchedule && scheduleDate && (\n\t\t\t\t\t\t\t\t<Button variant=\"secondary\" onClick={handleSchedule} disabled={isSubmitting}>\n\t\t\t\t\t\t\t\t\t{isSubmitting ? (\n\t\t\t\t\t\t\t\t\t\t<Loader2 className=\"mr-2 size-4 animate-spin\" />\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<Calendar className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tSchedule\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{onSend && (\n\t\t\t\t\t\t\t\t<Button onClick={handleSend} disabled={isSubmitting}>\n\t\t\t\t\t\t\t\t\t{isSubmitting ? (\n\t\t\t\t\t\t\t\t\t\t<Loader2 className=\"mr-2 size-4 animate-spin\" />\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<Send className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tSend Now\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\n// ============================================================================\n// Step Components\n// ============================================================================\n\ntype StepProps = {\n\tdraft: CampaignDraft;\n\terrors: Record<string, string>;\n\tonChange: (updates: Partial<CampaignDraft>) => void;\n\tonClearError: (field: string) => void;\n};\n\nfunction DetailsStep({ draft, errors, onChange, onClearError }: StepProps) {\n\treturn (\n\t\t<div className=\"mx-auto max-w-2xl space-y-6\">\n\t\t\t<div>\n\t\t\t\t<h2 className=\"text-lg font-semibold\">Campaign Details</h2>\n\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\tSet up the basic information for your campaign\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<div className=\"space-y-4\">\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t<Label htmlFor=\"name\">Campaign Name *</Label>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tid=\"name\"\n\t\t\t\t\t\tplaceholder=\"e.g., Holiday Promotion 2024\"\n\t\t\t\t\t\tvalue={draft.name}\n\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\tonChange({ name: e.target.value });\n\t\t\t\t\t\t\tonClearError(\"name\");\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={errors.name ? \"border-destructive\" : \"\"}\n\t\t\t\t\t/>\n\t\t\t\t\t{errors.name && (\n\t\t\t\t\t\t<p className=\"text-sm text-destructive\">{errors.name}</p>\n\t\t\t\t\t)}\n\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\tInternal name for organization (not shown to recipients)\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t<Label htmlFor=\"subject\">Subject Line *</Label>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tid=\"subject\"\n\t\t\t\t\t\tplaceholder=\"e.g., Special Holiday Offer Inside!\"\n\t\t\t\t\t\tvalue={draft.subject}\n\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\tonChange({ subject: e.target.value });\n\t\t\t\t\t\t\tonClearError(\"subject\");\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={errors.subject ? \"border-destructive\" : \"\"}\n\t\t\t\t\t/>\n\t\t\t\t\t{errors.subject && (\n\t\t\t\t\t\t<p className=\"text-sm text-destructive\">{errors.subject}</p>\n\t\t\t\t\t)}\n\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t{draft.subject.length}/60 characters recommended\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t<Label htmlFor=\"previewText\">Preview Text</Label>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tid=\"previewText\"\n\t\t\t\t\t\tplaceholder=\"e.g., Get 20% off your next purchase...\"\n\t\t\t\t\t\tvalue={draft.previewText}\n\t\t\t\t\t\tonChange={(e) => onChange({ previewText: e.target.value })}\n\t\t\t\t\t/>\n\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\tText shown after the subject in the inbox preview\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"grid gap-4 sm:grid-cols-2\">\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<Label htmlFor=\"fromName\">From Name</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tid=\"fromName\"\n\t\t\t\t\t\t\tplaceholder=\"Thorbis\"\n\t\t\t\t\t\t\tvalue={draft.fromName}\n\t\t\t\t\t\t\tonChange={(e) => onChange({ fromName: e.target.value })}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<Label htmlFor=\"fromEmail\">From Email</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tid=\"fromEmail\"\n\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\tplaceholder=\"hello@thorbis.com\"\n\t\t\t\t\t\t\tvalue={draft.fromEmail}\n\t\t\t\t\t\t\tonChange={(e) => onChange({ fromEmail: e.target.value })}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t<Label htmlFor=\"replyTo\">Reply-To Email</Label>\n\t\t\t\t\t<Input\n\t\t\t\t\t\tid=\"replyTo\"\n\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\tplaceholder=\"support@thorbis.com (optional)\"\n\t\t\t\t\t\tvalue={draft.replyTo || \"\"}\n\t\t\t\t\t\tonChange={(e) => onChange({ replyTo: e.target.value || undefined })}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction ContentStep({ draft, errors, onChange, onClearError }: StepProps) {\n\t// For now, simple HTML textarea - can be replaced with rich editor\n\treturn (\n\t\t<div className=\"mx-auto max-w-3xl space-y-6\">\n\t\t\t<div>\n\t\t\t\t<h2 className=\"text-lg font-semibold\">Email Content</h2>\n\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\tCreate your email content using HTML or select a template\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<div className=\"space-y-4\">\n\t\t\t\t{/* Template selector would go here */}\n\t\t\t\t<div className=\"rounded-lg border bg-muted/50 p-4\">\n\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\tTemplate library coming soon. For now, enter HTML content directly.\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t<Label htmlFor=\"htmlContent\">HTML Content *</Label>\n\t\t\t\t\t<Textarea\n\t\t\t\t\t\tid=\"htmlContent\"\n\t\t\t\t\t\tplaceholder=\"<html><body><h1>Hello!</h1><p>Your email content here...</p></body></html>\"\n\t\t\t\t\t\tvalue={draft.htmlContent || \"\"}\n\t\t\t\t\t\tonChange={(e) => {\n\t\t\t\t\t\t\tonChange({ htmlContent: e.target.value });\n\t\t\t\t\t\t\tonClearError(\"content\");\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tclassName={cn(\"min-h-[300px] font-mono text-sm\", errors.content && \"border-destructive\")}\n\t\t\t\t\t/>\n\t\t\t\t\t{errors.content && (\n\t\t\t\t\t\t<p className=\"text-sm text-destructive\">{errors.content}</p>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t<Label htmlFor=\"plainTextContent\">Plain Text Version (optional)</Label>\n\t\t\t\t\t<Textarea\n\t\t\t\t\t\tid=\"plainTextContent\"\n\t\t\t\t\t\tplaceholder=\"Hello! Your email content here...\"\n\t\t\t\t\t\tvalue={draft.plainTextContent || \"\"}\n\t\t\t\t\t\tonChange={(e) => onChange({ plainTextContent: e.target.value })}\n\t\t\t\t\t\tclassName=\"min-h-[150px]\"\n\t\t\t\t\t/>\n\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\tFallback for email clients that don't support HTML\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\nfunction AudienceStep({ draft, errors, onChange, onClearError }: StepProps) {\n\treturn (\n\t\t<div className=\"mx-auto max-w-2xl space-y-6\">\n\t\t\t<div>\n\t\t\t\t<h2 className=\"text-lg font-semibold\">Select Audience</h2>\n\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\tChoose who will receive this campaign\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t<AudienceSelector\n\t\t\t\tvalue={draft.audienceType}\n\t\t\t\tfilter={draft.audienceFilter}\n\t\t\t\tonChange={(audienceType, audienceFilter) => {\n\t\t\t\t\tonChange({ audienceType, audienceFilter });\n\t\t\t\t\tonClearError(\"audienceType\");\n\t\t\t\t}}\n\t\t\t\terror={errors.audienceType}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n\nfunction ReviewStep({\n\tdraft,\n\tscheduleDate,\n\tscheduleTime,\n\tonScheduleDateChange,\n\tonScheduleTimeChange,\n\terrors,\n}: {\n\tdraft: CampaignDraft;\n\tscheduleDate: string;\n\tscheduleTime: string;\n\tonScheduleDateChange: (date: string) => void;\n\tonScheduleTimeChange: (time: string) => void;\n\terrors: Record<string, string>;\n}) {\n\tconst audienceLabels: Record<EmailCampaignAudienceType, string> = {\n\t\tall_users: \"All Users\",\n\t\tall_companies: \"All Companies\",\n\t\twaitlist: \"Waitlist Subscribers\",\n\t\tsegment: \"Custom Segment\",\n\t\tcustom: \"Custom List\",\n\t};\n\n\treturn (\n\t\t<div className=\"mx-auto max-w-2xl space-y-6\">\n\t\t\t<div>\n\t\t\t\t<h2 className=\"text-lg font-semibold\">Review & Send</h2>\n\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\tReview your campaign before sending\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t{/* Campaign Summary */}\n\t\t\t<div className=\"rounded-lg border p-4 space-y-4\">\n\t\t\t\t<h3 className=\"font-medium\">Campaign Summary</h3>\n\n\t\t\t\t<div className=\"grid gap-4 sm:grid-cols-2\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Campaign Name</p>\n\t\t\t\t\t\t<p className=\"font-medium\">{draft.name || \"—\"}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">From</p>\n\t\t\t\t\t\t<p className=\"font-medium\">{draft.fromName} &lt;{draft.fromEmail}&gt;</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Subject Line</p>\n\t\t\t\t\t\t<p className=\"font-medium\">{draft.subject || \"—\"}</p>\n\t\t\t\t\t</div>\n\t\t\t\t\t{draft.previewText && (\n\t\t\t\t\t\t<div className=\"sm:col-span-2\">\n\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Preview Text</p>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">{draft.previewText}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Audience</p>\n\t\t\t\t\t\t<p className=\"font-medium\">{audienceLabels[draft.audienceType]}</p>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Schedule Option */}\n\t\t\t<div className=\"rounded-lg border p-4 space-y-4\">\n\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t<Clock className=\"size-4 text-muted-foreground\" />\n\t\t\t\t\t<h3 className=\"font-medium\">Schedule (Optional)</h3>\n\t\t\t\t</div>\n\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\tSchedule this campaign for later, or send it immediately\n\t\t\t\t</p>\n\n\t\t\t\t<div className=\"grid gap-4 sm:grid-cols-2\">\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<Label htmlFor=\"scheduleDate\">Date</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tid=\"scheduleDate\"\n\t\t\t\t\t\t\ttype=\"date\"\n\t\t\t\t\t\t\tvalue={scheduleDate}\n\t\t\t\t\t\t\tonChange={(e) => onScheduleDateChange(e.target.value)}\n\t\t\t\t\t\t\tmin={new Date().toISOString().split(\"T\")[0]}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<Label htmlFor=\"scheduleTime\">Time (UTC)</Label>\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tid=\"scheduleTime\"\n\t\t\t\t\t\t\ttype=\"time\"\n\t\t\t\t\t\t\tvalue={scheduleTime}\n\t\t\t\t\t\t\tonChange={(e) => onScheduleTimeChange(e.target.value)}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t{errors.schedule && (\n\t\t\t\t\t<p className=\"text-sm text-destructive\">{errors.schedule}</p>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Email Preview */}\n\t\t\t<div className=\"rounded-lg border p-4 space-y-4\">\n\t\t\t\t<h3 className=\"font-medium\">Email Preview</h3>\n\t\t\t\t{draft.htmlContent ? (\n\t\t\t\t\t<div className=\"rounded border bg-white p-4\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"prose prose-sm max-w-none\"\n\t\t\t\t\t\t\tdangerouslySetInnerHTML={{ __html: draft.htmlContent }}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">No content to preview</p>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","/* __next_internal_action_entry_do_not_use__ [{\"40258905938530fcaaa6c784215a0af2e117525e15\":\"createCampaign\"},\"apps/admin/src/actions/campaigns.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var createCampaign=/*#__PURE__*/createServerReference(\"40258905938530fcaaa6c784215a0af2e117525e15\",callServer,void 0,findSourceMapURL,\"createCampaign\");","/* __next_internal_action_entry_do_not_use__ [{\"405237084f20421a77a390c37538f97ae561efb671\":\"sendCampaign\"},\"apps/admin/src/actions/campaigns.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var sendCampaign=/*#__PURE__*/createServerReference(\"405237084f20421a77a390c37538f97ae561efb671\",callServer,void 0,findSourceMapURL,\"sendCampaign\");","/* __next_internal_action_entry_do_not_use__ [{\"603c1099f42d7fe11c54fe611b3e9cb7940af4926b\":\"scheduleCampaign\"},\"apps/admin/src/actions/campaigns.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var scheduleCampaign=/*#__PURE__*/createServerReference(\"603c1099f42d7fe11c54fe611b3e9cb7940af4926b\",callServer,void 0,findSourceMapURL,\"scheduleCampaign\");","\"use client\";\n\n/**\n * New Campaign Page\n *\n * Create a new email marketing campaign using the campaign builder wizard.\n * Connects to real server actions for campaign CRUD operations.\n */\n\nimport { useRouter } from \"next/navigation\";\nimport { useCallback, useState, useEffect } from \"react\";\nimport { ArrowLeft } from \"lucide-react\";\nimport Link from \"next/link\";\nimport { Button } from \"@stratos/ui\";\nimport { CampaignBuilder } from \"@/components/marketing/campaign-builder\";\nimport { useCampaignStore } from \"@/lib/stores/campaign-store\";\nimport { createCampaign, sendCampaign, scheduleCampaign } from \"@/actions/campaigns\";\nimport type { CampaignDraft } from \"@/types/campaigns\";\n\nexport default function NewCampaignPage() {\n\tconst router = useRouter();\n\tconst [isSubmitting, setIsSubmitting] = useState(false);\n\tconst [error, setError] = useState<string | null>(null);\n\tconst { openBuilder, closeBuilder } = useCampaignStore();\n\n\t// Initialize builder when page loads\n\tuseEffect(() => {\n\t\topenBuilder();\n\t\treturn () => closeBuilder();\n\t}, [openBuilder, closeBuilder]);\n\n\tconst handleSave = useCallback(\n\t\tasync (draft: CampaignDraft) => {\n\t\t\tsetIsSubmitting(true);\n\t\t\tsetError(null);\n\t\t\ttry {\n\t\t\t\tconst result = await createCampaign(draft);\n\n\t\t\t\tif (!result.success) {\n\t\t\t\t\tsetError(result.error || \"Failed to create campaign\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (result.data) {\n\t\t\t\t\trouter.push(`/dashboard/marketing/campaigns/${result.data.id}`);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(\"Failed to save campaign:\", err);\n\t\t\t\tsetError(\"An unexpected error occurred\");\n\t\t\t} finally {\n\t\t\t\tsetIsSubmitting(false);\n\t\t\t}\n\t\t},\n\t\t[router]\n\t);\n\n\tconst handleSend = useCallback(\n\t\tasync (draft: CampaignDraft) => {\n\t\t\tsetIsSubmitting(true);\n\t\t\tsetError(null);\n\t\t\ttry {\n\t\t\t\t// First create the campaign as draft\n\t\t\t\tconst createResult = await createCampaign(draft);\n\n\t\t\t\tif (!createResult.success || !createResult.data) {\n\t\t\t\t\tsetError(createResult.error || \"Failed to create campaign\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Then send it\n\t\t\t\tconst sendResult = await sendCampaign(createResult.data.id);\n\n\t\t\t\tif (!sendResult.success) {\n\t\t\t\t\tsetError(sendResult.error || \"Failed to send campaign\");\n\t\t\t\t\t// Still redirect to campaign page so user can see the draft\n\t\t\t\t\trouter.push(`/dashboard/marketing/campaigns/${createResult.data.id}`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\trouter.push(`/dashboard/marketing/campaigns/${createResult.data.id}`);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(\"Failed to send campaign:\", err);\n\t\t\t\tsetError(\"An unexpected error occurred\");\n\t\t\t} finally {\n\t\t\t\tsetIsSubmitting(false);\n\t\t\t}\n\t\t},\n\t\t[router]\n\t);\n\n\tconst handleSchedule = useCallback(\n\t\tasync (draft: CampaignDraft, scheduledFor: string) => {\n\t\t\tsetIsSubmitting(true);\n\t\t\tsetError(null);\n\t\t\ttry {\n\t\t\t\t// First create the campaign as draft\n\t\t\t\tconst createResult = await createCampaign(draft);\n\n\t\t\t\tif (!createResult.success || !createResult.data) {\n\t\t\t\t\tsetError(createResult.error || \"Failed to create campaign\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Then schedule it\n\t\t\t\tconst scheduleResult = await scheduleCampaign(createResult.data.id, scheduledFor);\n\n\t\t\t\tif (!scheduleResult.success) {\n\t\t\t\t\tsetError(scheduleResult.error || \"Failed to schedule campaign\");\n\t\t\t\t\t// Still redirect to campaign page so user can see the draft\n\t\t\t\t\trouter.push(`/dashboard/marketing/campaigns/${createResult.data.id}`);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\trouter.push(`/dashboard/marketing/campaigns/${createResult.data.id}`);\n\t\t\t} catch (err) {\n\t\t\t\tconsole.error(\"Failed to schedule campaign:\", err);\n\t\t\t\tsetError(\"An unexpected error occurred\");\n\t\t\t} finally {\n\t\t\t\tsetIsSubmitting(false);\n\t\t\t}\n\t\t},\n\t\t[router]\n\t);\n\n\tconst handleCancel = useCallback(() => {\n\t\trouter.push(\"/dashboard/marketing/campaigns\");\n\t}, [router]);\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col\">\n\t\t\t{/* Header */}\n\t\t\t<div className=\"flex items-center gap-4 border-b px-6 py-4\">\n\t\t\t\t<Button variant=\"ghost\" size=\"icon\" asChild>\n\t\t\t\t\t<Link href=\"/dashboard/marketing/campaigns\">\n\t\t\t\t\t\t<ArrowLeft className=\"size-4\" />\n\t\t\t\t\t</Link>\n\t\t\t\t</Button>\n\t\t\t\t<div>\n\t\t\t\t\t<h1 className=\"text-lg font-semibold\">Create Campaign</h1>\n\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\tBuild a new email marketing campaign\n\t\t\t\t\t</p>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Error Display */}\n\t\t\t{error && (\n\t\t\t\t<div className=\"mx-6 mt-4 rounded-lg border border-destructive/50 bg-destructive/10 p-4\">\n\t\t\t\t\t<p className=\"text-sm text-destructive\">{error}</p>\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* Campaign Builder */}\n\t\t\t<div className=\"flex-1 overflow-hidden\">\n\t\t\t\t<CampaignBuilder\n\t\t\t\t\tonSave={handleSave}\n\t\t\t\t\tonSend={handleSend}\n\t\t\t\t\tonSchedule={handleSchedule}\n\t\t\t\t\tonCancel={handleCancel}\n\t\t\t\t\tisSubmitting={isSubmitting}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z',\n      key: 'sc7q7i',\n    },\n  ],\n];\n\n/**\n * @component @name Funnel\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNMTAgMjBhMSAxIDAgMCAwIC41NTMuODk1bDIgMUExIDEgMCAwIDAgMTQgMjF2LTdhMiAyIDAgMCAxIC41MTctMS4zNDFMMjEuNzQgNC42N0ExIDEgMCAwIDAgMjEgM0gzYTEgMSAwIDAgMC0uNzQyIDEuNjdsNy4yMjUgNy45ODlBMiAyIDAgMCAxIDEwIDE0eiIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/funnel\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Funnel = createLucideIcon('funnel', __iconNode);\n\nexport default Funnel;\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M5 12h14', key: '1ays0h' }],\n  ['path', { d: 'm12 5 7 7-7 7', key: 'xquz4c' }],\n];\n\n/**\n * @component @name ArrowRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNSAxMmgxNCIgLz4KICA8cGF0aCBkPSJtMTIgNSA3IDctNyA3IiAvPgo8L3N2Zz4K) - https://lucide.dev/icons/arrow-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowRight = createLucideIcon('arrow-right', __iconNode);\n\nexport default ArrowRight;\n"],"names":[],"mappings":"wDMSA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,sDEMmD,CAAA,ADZ1C,ACHN,CAegD,ADZ1C,ACHN,CAegD,ADZ1C,ACHN,CAegD,ADZ1C,ACHN,CDGM,ACHN,AAegD,CAfhD,AAegD,ADZ1C,CCHN,AAegD,ADZ1C,CCHN,AAAQ,AAewC,ADZ1C,CCHE,AAAE,AAesC,ADZ1C,CAAA,ACYoD,CAf7C,AAe6C,ADZpD,CCHO,ADGP,CCHO,ADGP,CCHO,ADGP,CAAA,ACHO,CDGP,ACHO,CDGP,ACHO,CDGP,ACHO,CDGP,ACHO,CAAA,ADGP,CCHO,ADGP,CCHO,AAAY,ADGnB,CAAA,ACHmB,CDGnB,ACHmB,CDGnB,ACHmB,CAAK,AAAL,ADGnB,CAAA,ACHwB,CDGxB,ACHwB,CDGxB,ACHwB,CDGxB,ACHwB,CDGxB,ACHwB,CDGxB,ACHwB,CAAA,ADGxB,CCHwB,ADGxB,CCHkC,ADGlC,CCHkC,ADGlC,CCFP,ADEO,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CCFE,ADEF,CCFE,AAAE,ADEJ,CAAA,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CCFO,ADEP,CAAA,ACFO,CDEP,ACFO,CDEP,ACFO,CAAA,ADEP,CAAA,ACFO,CDEP,ACFO,CAAA,ADEP,CCFO,ADEP,ACFwB,CDExB,ACFwB,CDExB,ACFwB,CDExB,ACFwB,CDExB,ACFwB,AAAK,CDE7B,ACF6B,CAAA,ADE7B,CCF6B,ADE7B,CAAA,ACF6B,CDE7B,ACF6B,CDE7B,ACF6B,CDE7B,ACF6B,CDE7B,ACF6B,CDE7B,ACFuC,CDEvC,ACFuC,CDEvC,CAAA,CAAA,ALGT,CKHS,CAAA,CAAA,CAAA,ALGT,CKHS,CAAA,ALGT,CKHS,CLGT,AKHS,CAAA,ALGT,CKHS,ALGT,CKHS,CAAA,CAAA,CAAA,CAAA,CAAA,CLGT,AKHS,CAAA,CAA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","ignoreList":[7,8]}