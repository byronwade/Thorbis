module.exports=[25841,(a,b,c)=>{"use strict";b.exports=a.r(31294).vendored.contexts.HooksClientContext},62121,(a,b,c)=>{"use strict";b.exports=a.r(31294).vendored.contexts.ServerInsertedHtml},56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},87239,(a,b,c)=>{"use strict";b.exports=a.r(31294).vendored["react-ssr"].ReactServerDOMTurbopackClient},34760,(a,b,c)=>{"use strict";b.exports=a.r(31294).vendored.contexts.AppRouterContext},3988,(a,b,c)=>{"use strict";function d(a){if("function"!=typeof WeakMap)return null;var b=new WeakMap,c=new WeakMap;return(d=function(a){return a?c:b})(a)}c._=function(a,b){if(!b&&a&&a.__esModule)return a;if(null===a||"object"!=typeof a&&"function"!=typeof a)return{default:a};var c=d(b);if(c&&c.has(a))return c.get(a);var e={__proto__:null},f=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var g in a)if("default"!==g&&Object.prototype.hasOwnProperty.call(a,g)){var h=f?Object.getOwnPropertyDescriptor(a,g):null;h&&(h.get||h.set)?Object.defineProperty(e,g,h):e[g]=a[g]}return e.default=a,c&&c.set(a,e),e}},7343,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d,e={ACTION_HMR_REFRESH:function(){return k},ACTION_NAVIGATE:function(){return h},ACTION_REFRESH:function(){return g},ACTION_RESTORE:function(){return i},ACTION_SERVER_ACTION:function(){return l},ACTION_SERVER_PATCH:function(){return j},PrefetchKind:function(){return m}};for(var f in e)Object.defineProperty(c,f,{enumerable:!0,get:e[f]});let g="refresh",h="navigate",i="restore",j="server-patch",k="hmr-refresh",l="server-action";var m=((d={}).AUTO="auto",d.FULL="full",d.TEMPORARY="temporary",d);("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},73354,(a,b,c)=>{"use strict";function d(a){return null!==a&&"object"==typeof a&&"then"in a&&"function"==typeof a.then}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"isThenable",{enumerable:!0,get:function(){return d}})},96157,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={dispatchAppRouterAction:function(){return i},useActionQueue:function(){return j}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(3988)._(a.r(47473)),g=a.r(73354),h=null;function i(a){if(null===h)throw Object.defineProperty(Error("Internal Next.js error: Router action dispatched before initialization."),"__NEXT_ERROR_CODE",{value:"E668",enumerable:!1,configurable:!0});h(a)}function j(a){let[b,c]=f.default.useState(a.state);h=b=>a.dispatch(b,c);let d=(0,f.useMemo)(()=>b,[b]);return(0,g.isThenable)(d)?(0,f.use)(d):d}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},24861,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"callServer",{enumerable:!0,get:function(){return g}});let d=a.r(47473),e=a.r(7343),f=a.r(96157);async function g(a,b){return new Promise((c,g)=>{(0,d.startTransition)(()=>{(0,f.dispatchAppRouterAction)({type:e.ACTION_SERVER_ACTION,actionId:a,actionArgs:b,resolve:c,reject:g})})})}("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},80637,(a,b,c)=>{"use strict";let d;Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"findSourceMapURL",{enumerable:!0,get:function(){return d}});("function"==typeof c.default||"object"==typeof c.default&&null!==c.default)&&void 0===c.default.__esModule&&(Object.defineProperty(c.default,"__esModule",{value:!0}),Object.assign(c.default,c),b.exports=c.default)},25434,a=>{"use strict";a.i(56120),a.s([])},53995,a=>{"use strict";let b=(0,a.i(3431).default)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);a.s(["Ticket",()=>b],53995)},29891,a=>{"use strict";a.i(56120),a.s([])},24126,a=>{"use strict";let b=(0,a.i(3431).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);a.s(["Clock",()=>b],24126)},98803,a=>{"use strict";let b=(0,a.i(3431).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);a.s(["Loader2",()=>b],98803)},53520,40716,a=>{"use strict";var b=a.i(3431);let c=(0,b.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);a.s(["CheckCircle",()=>c],53520);let d=(0,b.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);a.s(["XCircle",()=>d],40716)},4741,a=>{"use strict";a.i(56120),a.s([])},89162,a=>{"use strict";var b=a.i(45139),c=a.i(47473),d=a.i(78279),e=a.i(24126),f=a.i(52424),g=a.i(53995),h=a.i(98803),i=a.i(53520),j=a.i(40716);a.i(4741);var k=a.i(47421);a.i(25434);var l=a.i(86990);a.i(29891);var m=a.i(18170),n=a.i(47452);function o({sessionId:a,companyId:o,companyName:p,ticketId:q,reason:r,requestedAt:s}){let t=(0,d.useRouter)(),[u,v]=(0,c.useState)("pending"),[w,x]=(0,c.useState)(""),[y,z]=(0,c.useState)(0);return((0,c.useEffect)(()=>{let a=()=>{let a=new Date,b=new Date(s),c=a.getTime()-b.getTime(),d=Math.floor(c/1e3/60),e=Math.floor(c/1e3%60);d>0?x(`${d}m ${e}s`):x(`${e}s`)};a();let b=setInterval(a,1e3);return()=>clearInterval(b)},[s]),(0,c.useEffect)(()=>{let b=async()=>{try{let b=function(){let a=process.env.ADMIN_SUPABASE_SERVICE_ROLE_KEY;if(!a)throw Error("Missing ADMIN_SUPABASE_SERVICE_ROLE_KEY environment variable. Get this from Supabase dashboard -> Settings -> API -> service_role key");return(0,n.createClient)("https://iwudmixxoozwskgolqlz.supabase.co",a,{auth:{autoRefreshToken:!1,persistSession:!1}})}(),{data:c,error:d}=await b.from("support_sessions").select("status, rejection_reason").eq("id",a).single();if(d)return void console.error("Error checking session status:",d);if(!c)return;z(a=>a+1),"active"===c.status&&(v("active"),setTimeout(()=>{t.push(`/admin/dashboard/view-as/${o}/work/jobs`)},1500)),"rejected"===c.status&&(v("rejected"),setTimeout(()=>{t.refresh()},1500))}catch(a){console.error("Error polling session status:",a)}};b();let c=setInterval(b,5e3);return()=>clearInterval(c)},[a,o,t]),"active"===u)?(0,b.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center space-y-4 animate-in fade-in zoom-in",children:[(0,b.jsx)("div",{className:"rounded-full bg-green-100 dark:bg-green-900/20 w-20 h-20 flex items-center justify-center mx-auto",children:(0,b.jsx)(i.CheckCircle,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Access Approved!"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Redirecting to customer view..."})]})}):"rejected"===u?(0,b.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center space-y-4 animate-in fade-in zoom-in",children:[(0,b.jsx)("div",{className:"rounded-full bg-red-100 dark:bg-red-900/20 w-20 h-20 flex items-center justify-center mx-auto",children:(0,b.jsx)(j.XCircle,{className:"h-10 w-10 text-red-600 dark:text-red-400"})}),(0,b.jsx)("h1",{className:"text-2xl font-bold",children:"Access Denied"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Customer declined the request..."})]})}):(0,b.jsx)("div",{className:"flex h-screen items-center justify-center p-6 bg-gradient-to-br from-background to-muted/20",children:(0,b.jsxs)(k.Card,{className:"max-w-2xl w-full shadow-lg",children:[(0,b.jsxs)(k.CardHeader,{className:"text-center space-y-4",children:[(0,b.jsxs)("div",{className:"mx-auto rounded-full bg-orange-100 dark:bg-orange-900/20 w-20 h-20 flex items-center justify-center relative",children:[(0,b.jsx)(f.Shield,{className:"h-10 w-10 text-orange-600 dark:text-orange-400"}),(0,b.jsx)("div",{className:"absolute inset-0 rounded-full border-2 border-orange-300 dark:border-orange-700 animate-ping"}),(0,b.jsx)("div",{className:"absolute inset-0 rounded-full border-2 border-orange-400 dark:border-orange-600 animate-pulse"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(k.CardTitle,{className:"text-3xl",children:"Waiting for Customer Approval"}),(0,b.jsx)(k.CardDescription,{className:"text-base",children:"The customer will see a notification in their account to approve or deny your access request."})]})]}),(0,b.jsxs)(k.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-6 space-y-4",children:[(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Company"}),(0,b.jsx)("p",{className:"text-lg font-semibold",children:p})]}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Time Waiting"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Clock,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("p",{className:"text-lg font-semibold font-mono",children:w})]})]})]}),q&&(0,b.jsxs)("div",{className:"flex items-center gap-2 pt-4 border-t",children:[(0,b.jsx)(g.Ticket,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Support Ticket:"}),(0,b.jsx)(l.Badge,{variant:"outline",className:"font-mono",children:q})]}),(0,b.jsxs)("div",{className:"space-y-2 pt-4 border-t",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Reason for Access"}),(0,b.jsx)("p",{className:"text-sm rounded-md border bg-background p-3",children:r})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[(0,b.jsx)(h.Loader2,{className:"h-4 w-4 animate-spin"}),(0,b.jsxs)("span",{children:["Checking for approval... (",y," ",1===y?"check":"checks",")"]})]}),(0,b.jsxs)("div",{className:"rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20 p-4 space-y-2",children:[(0,b.jsxs)("h3",{className:"font-medium text-blue-900 dark:text-blue-100 flex items-center gap-2",children:[(0,b.jsx)(f.Shield,{className:"h-4 w-4"}),"What Happens Next"]}),(0,b.jsxs)("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-disc list-inside",children:[(0,b.jsx)("li",{children:"The customer will see an approval modal in their dashboard"}),(0,b.jsx)("li",{children:"They can approve access for 30 minutes to 4 hours"}),(0,b.jsx)("li",{children:"Once approved, you'll be redirected automatically"}),(0,b.jsx)("li",{children:"If denied, you'll see the rejection reason"}),(0,b.jsx)("li",{children:"The session will expire if not approved within 24 hours"})]})]}),(0,b.jsx)("div",{className:"flex justify-center pt-4",children:(0,b.jsx)(m.Button,{variant:"outline",onClick:()=>t.push("/admin/dashboard/view-as"),className:"w-full sm:w-auto",children:"Cancel & Return to Companies"})})]})]})})}a.s(["PendingSessionClient",()=>o],89162)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__3fd7e38b._.js.map