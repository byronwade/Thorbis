{"version":3,"sources":["turbopack:///[project]/packages/database/src/service-client.ts","turbopack:///[project]/node_modules/.pnpm/cookie@1.0.2/node_modules/cookie/src/index.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/dist/module/types.js","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/version.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/cookies.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/index.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/utils/index.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/utils/helpers.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/createBrowserClient.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/createServerClient.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/utils/chunker.ts","turbopack:///[project]/packages/database/src/server.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/utils/constants.ts","turbopack:///[project]/node_modules/.pnpm/@supabase+ssr@0.7.0_@supabase+supabase-js@2.81.0/node_modules/@supabase/ssr/src/utils/base64url.ts","turbopack:///[project]/packages/auth/src/company-context.ts","turbopack:///[project]/packages/shared/src/onboarding.ts","turbopack:///[project]/packages/auth/src/session.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient as createSupabaseClient } from \"@supabase/supabase-js\";\nimport type { Database } from \"./types\";\n\n/**\n * Creates a Supabase client using the service role key.\n * This bypasses RLS and is intended for background jobs / automation.\n *\n * Performance Optimization:\n * - Uses SUPABASE_POOLER_URL (Transaction Mode) if available for 30-50% faster queries\n * - Falls back to NEXT_PUBLIC_SUPABASE_URL (Session Mode) if pooler not configured\n * - Transaction Mode supports 10,000+ concurrent connections vs 100 in Session Mode\n *\n * @returns Supabase client with service role, or null if not configured\n */\nexport async function createServiceSupabaseClient() {\n\t// Prefer pooler URL for Transaction Mode (better performance)\n\tconst supabaseUrl =\n\t\tprocess.env.SUPABASE_POOLER_URL || process.env.NEXT_PUBLIC_SUPABASE_URL;\n\tconst serviceRoleKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\n\n\tif (!supabaseUrl || !serviceRoleKey) {\n\t\treturn null;\n\t}\n\n\treturn createSupabaseClient<Database>(supabaseUrl, serviceRoleKey, {\n\t\tauth: {\n\t\t\tpersistSession: false,\n\t\t\tautoRefreshToken: false,\n\t\t},\n\t\tdb: {\n\t\t\tschema: \"public\",\n\t\t},\n\t\tglobal: {\n\t\t\theaders: {\n\t\t\t\t\"x-my-custom-header\": \"service-role\",\n\t\t\t},\n\t\t},\n\t});\n}\n\nexport type ServiceSupabaseClient = Awaited<\n\tReturnType<typeof createServiceSupabaseClient>\n>;\n","/**\n * RegExp to match cookie-name in RFC 6265 sec 4.1.1\n * This refers out to the obsoleted definition of token in RFC 2616 sec 2.2\n * which has been replaced by the token definition in RFC 7230 appendix B.\n *\n * cookie-name       = token\n * token             = 1*tchar\n * tchar             = \"!\" / \"#\" / \"$\" / \"%\" / \"&\" / \"'\" /\n *                     \"*\" / \"+\" / \"-\" / \".\" / \"^\" / \"_\" /\n *                     \"`\" / \"|\" / \"~\" / DIGIT / ALPHA\n *\n * Note: Allowing more characters - https://github.com/jshttp/cookie/issues/191\n * Allow same range as cookie value, except `=`, which delimits end of name.\n */\nconst cookieNameRegExp = /^[\\u0021-\\u003A\\u003C\\u003E-\\u007E]+$/;\n\n/**\n * RegExp to match cookie-value in RFC 6265 sec 4.1.1\n *\n * cookie-value      = *cookie-octet / ( DQUOTE *cookie-octet DQUOTE )\n * cookie-octet      = %x21 / %x23-2B / %x2D-3A / %x3C-5B / %x5D-7E\n *                     ; US-ASCII characters excluding CTLs,\n *                     ; whitespace DQUOTE, comma, semicolon,\n *                     ; and backslash\n *\n * Allowing more characters: https://github.com/jshttp/cookie/issues/191\n * Comma, backslash, and DQUOTE are not part of the parsing algorithm.\n */\nconst cookieValueRegExp = /^[\\u0021-\\u003A\\u003C-\\u007E]*$/;\n\n/**\n * RegExp to match domain-value in RFC 6265 sec 4.1.1\n *\n * domain-value      = <subdomain>\n *                     ; defined in [RFC1034], Section 3.5, as\n *                     ; enhanced by [RFC1123], Section 2.1\n * <subdomain>       = <label> | <subdomain> \".\" <label>\n * <label>           = <let-dig> [ [ <ldh-str> ] <let-dig> ]\n *                     Labels must be 63 characters or less.\n *                     'let-dig' not 'letter' in the first char, per RFC1123\n * <ldh-str>         = <let-dig-hyp> | <let-dig-hyp> <ldh-str>\n * <let-dig-hyp>     = <let-dig> | \"-\"\n * <let-dig>         = <letter> | <digit>\n * <letter>          = any one of the 52 alphabetic characters A through Z in\n *                     upper case and a through z in lower case\n * <digit>           = any one of the ten digits 0 through 9\n *\n * Keep support for leading dot: https://github.com/jshttp/cookie/issues/173\n *\n * > (Note that a leading %x2E (\".\"), if present, is ignored even though that\n * character is not permitted, but a trailing %x2E (\".\"), if present, will\n * cause the user agent to ignore the attribute.)\n */\nconst domainValueRegExp =\n  /^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i;\n\n/**\n * RegExp to match path-value in RFC 6265 sec 4.1.1\n *\n * path-value        = <any CHAR except CTLs or \";\">\n * CHAR              = %x01-7F\n *                     ; defined in RFC 5234 appendix B.1\n */\nconst pathValueRegExp = /^[\\u0020-\\u003A\\u003D-\\u007E]*$/;\n\nconst __toString = Object.prototype.toString;\n\nconst NullObject = /* @__PURE__ */ (() => {\n  const C = function () {};\n  C.prototype = Object.create(null);\n  return C;\n})() as unknown as { new (): any };\n\n/**\n * Parse options.\n */\nexport interface ParseOptions {\n  /**\n   * Specifies a function that will be used to decode a [cookie-value](https://datatracker.ietf.org/doc/html/rfc6265#section-4.1.1).\n   * Since the value of a cookie has a limited character set (and must be a simple string), this function can be used to decode\n   * a previously-encoded cookie value into a JavaScript string.\n   *\n   * The default function is the global `decodeURIComponent`, wrapped in a `try..catch`. If an error\n   * is thrown it will return the cookie's original value. If you provide your own encode/decode\n   * scheme you must ensure errors are appropriately handled.\n   *\n   * @default decode\n   */\n  decode?: (str: string) => string | undefined;\n}\n\n/**\n * Parse a cookie header.\n *\n * Parse the given cookie header string into an object\n * The object has the various cookies as keys(names) => values\n */\nexport function parse(\n  str: string,\n  options?: ParseOptions,\n): Record<string, string | undefined> {\n  const obj: Record<string, string | undefined> = new NullObject();\n  const len = str.length;\n  // RFC 6265 sec 4.1.1, RFC 2616 2.2 defines a cookie name consists of one char minimum, plus '='.\n  if (len < 2) return obj;\n\n  const dec = options?.decode || decode;\n  let index = 0;\n\n  do {\n    const eqIdx = str.indexOf(\"=\", index);\n    if (eqIdx === -1) break; // No more cookie pairs.\n\n    const colonIdx = str.indexOf(\";\", index);\n    const endIdx = colonIdx === -1 ? len : colonIdx;\n\n    if (eqIdx > endIdx) {\n      // backtrack on prior semicolon\n      index = str.lastIndexOf(\";\", eqIdx - 1) + 1;\n      continue;\n    }\n\n    const keyStartIdx = startIndex(str, index, eqIdx);\n    const keyEndIdx = endIndex(str, eqIdx, keyStartIdx);\n    const key = str.slice(keyStartIdx, keyEndIdx);\n\n    // only assign once\n    if (obj[key] === undefined) {\n      let valStartIdx = startIndex(str, eqIdx + 1, endIdx);\n      let valEndIdx = endIndex(str, endIdx, valStartIdx);\n\n      const value = dec(str.slice(valStartIdx, valEndIdx));\n      obj[key] = value;\n    }\n\n    index = endIdx + 1;\n  } while (index < len);\n\n  return obj;\n}\n\nfunction startIndex(str: string, index: number, max: number) {\n  do {\n    const code = str.charCodeAt(index);\n    if (code !== 0x20 /*   */ && code !== 0x09 /* \\t */) return index;\n  } while (++index < max);\n  return max;\n}\n\nfunction endIndex(str: string, index: number, min: number) {\n  while (index > min) {\n    const code = str.charCodeAt(--index);\n    if (code !== 0x20 /*   */ && code !== 0x09 /* \\t */) return index + 1;\n  }\n  return min;\n}\n\n/**\n * Serialize options.\n */\nexport interface SerializeOptions {\n  /**\n   * Specifies a function that will be used to encode a [cookie-value](https://datatracker.ietf.org/doc/html/rfc6265#section-4.1.1).\n   * Since value of a cookie has a limited character set (and must be a simple string), this function can be used to encode\n   * a value into a string suited for a cookie's value, and should mirror `decode` when parsing.\n   *\n   * @default encodeURIComponent\n   */\n  encode?: (str: string) => string;\n  /**\n   * Specifies the `number` (in seconds) to be the value for the [`Max-Age` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.2).\n   *\n   * The [cookie storage model specification](https://tools.ietf.org/html/rfc6265#section-5.3) states that if both `expires` and\n   * `maxAge` are set, then `maxAge` takes precedence, but it is possible not all clients by obey this,\n   * so if both are set, they should point to the same date and time.\n   */\n  maxAge?: number;\n  /**\n   * Specifies the `Date` object to be the value for the [`Expires` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.1).\n   * When no expiration is set clients consider this a \"non-persistent cookie\" and delete it the current session is over.\n   *\n   * The [cookie storage model specification](https://tools.ietf.org/html/rfc6265#section-5.3) states that if both `expires` and\n   * `maxAge` are set, then `maxAge` takes precedence, but it is possible not all clients by obey this,\n   * so if both are set, they should point to the same date and time.\n   */\n  expires?: Date;\n  /**\n   * Specifies the value for the [`Domain` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.3).\n   * When no domain is set clients consider the cookie to apply to the current domain only.\n   */\n  domain?: string;\n  /**\n   * Specifies the value for the [`Path` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.4).\n   * When no path is set, the path is considered the [\"default path\"](https://tools.ietf.org/html/rfc6265#section-5.1.4).\n   */\n  path?: string;\n  /**\n   * Enables the [`HttpOnly` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.6).\n   * When enabled, clients will not allow client-side JavaScript to see the cookie in `document.cookie`.\n   */\n  httpOnly?: boolean;\n  /**\n   * Enables the [`Secure` `Set-Cookie` attribute](https://tools.ietf.org/html/rfc6265#section-5.2.5).\n   * When enabled, clients will only send the cookie back if the browser has a HTTPS connection.\n   */\n  secure?: boolean;\n  /**\n   * Enables the [`Partitioned` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-cutler-httpbis-partitioned-cookies/).\n   * When enabled, clients will only send the cookie back when the current domain _and_ top-level domain matches.\n   *\n   * This is an attribute that has not yet been fully standardized, and may change in the future.\n   * This also means clients may ignore this attribute until they understand it. More information\n   * about can be found in [the proposal](https://github.com/privacycg/CHIPS).\n   */\n  partitioned?: boolean;\n  /**\n   * Specifies the value for the [`Priority` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-west-cookie-priority-00#section-4.1).\n   *\n   * - `'low'` will set the `Priority` attribute to `Low`.\n   * - `'medium'` will set the `Priority` attribute to `Medium`, the default priority when not set.\n   * - `'high'` will set the `Priority` attribute to `High`.\n   *\n   * More information about priority levels can be found in [the specification](https://tools.ietf.org/html/draft-west-cookie-priority-00#section-4.1).\n   */\n  priority?: \"low\" | \"medium\" | \"high\";\n  /**\n   * Specifies the value for the [`SameSite` `Set-Cookie` attribute](https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).\n   *\n   * - `true` will set the `SameSite` attribute to `Strict` for strict same site enforcement.\n   * - `'lax'` will set the `SameSite` attribute to `Lax` for lax same site enforcement.\n   * - `'none'` will set the `SameSite` attribute to `None` for an explicit cross-site cookie.\n   * - `'strict'` will set the `SameSite` attribute to `Strict` for strict same site enforcement.\n   *\n   * More information about enforcement levels can be found in [the specification](https://tools.ietf.org/html/draft-ietf-httpbis-rfc6265bis-09#section-5.4.7).\n   */\n  sameSite?: boolean | \"lax\" | \"strict\" | \"none\";\n}\n\n/**\n * Serialize data into a cookie header.\n *\n * Serialize a name value pair into a cookie string suitable for\n * http headers. An optional options object specifies cookie parameters.\n *\n * serialize('foo', 'bar', { httpOnly: true })\n *   => \"foo=bar; httpOnly\"\n */\nexport function serialize(\n  name: string,\n  val: string,\n  options?: SerializeOptions,\n): string {\n  const enc = options?.encode || encodeURIComponent;\n\n  if (!cookieNameRegExp.test(name)) {\n    throw new TypeError(`argument name is invalid: ${name}`);\n  }\n\n  const value = enc(val);\n\n  if (!cookieValueRegExp.test(value)) {\n    throw new TypeError(`argument val is invalid: ${val}`);\n  }\n\n  let str = name + \"=\" + value;\n  if (!options) return str;\n\n  if (options.maxAge !== undefined) {\n    if (!Number.isInteger(options.maxAge)) {\n      throw new TypeError(`option maxAge is invalid: ${options.maxAge}`);\n    }\n\n    str += \"; Max-Age=\" + options.maxAge;\n  }\n\n  if (options.domain) {\n    if (!domainValueRegExp.test(options.domain)) {\n      throw new TypeError(`option domain is invalid: ${options.domain}`);\n    }\n\n    str += \"; Domain=\" + options.domain;\n  }\n\n  if (options.path) {\n    if (!pathValueRegExp.test(options.path)) {\n      throw new TypeError(`option path is invalid: ${options.path}`);\n    }\n\n    str += \"; Path=\" + options.path;\n  }\n\n  if (options.expires) {\n    if (\n      !isDate(options.expires) ||\n      !Number.isFinite(options.expires.valueOf())\n    ) {\n      throw new TypeError(`option expires is invalid: ${options.expires}`);\n    }\n\n    str += \"; Expires=\" + options.expires.toUTCString();\n  }\n\n  if (options.httpOnly) {\n    str += \"; HttpOnly\";\n  }\n\n  if (options.secure) {\n    str += \"; Secure\";\n  }\n\n  if (options.partitioned) {\n    str += \"; Partitioned\";\n  }\n\n  if (options.priority) {\n    const priority =\n      typeof options.priority === \"string\"\n        ? options.priority.toLowerCase()\n        : undefined;\n    switch (priority) {\n      case \"low\":\n        str += \"; Priority=Low\";\n        break;\n      case \"medium\":\n        str += \"; Priority=Medium\";\n        break;\n      case \"high\":\n        str += \"; Priority=High\";\n        break;\n      default:\n        throw new TypeError(`option priority is invalid: ${options.priority}`);\n    }\n  }\n\n  if (options.sameSite) {\n    const sameSite =\n      typeof options.sameSite === \"string\"\n        ? options.sameSite.toLowerCase()\n        : options.sameSite;\n    switch (sameSite) {\n      case true:\n      case \"strict\":\n        str += \"; SameSite=Strict\";\n        break;\n      case \"lax\":\n        str += \"; SameSite=Lax\";\n        break;\n      case \"none\":\n        str += \"; SameSite=None\";\n        break;\n      default:\n        throw new TypeError(`option sameSite is invalid: ${options.sameSite}`);\n    }\n  }\n\n  return str;\n}\n\n/**\n * URL-decode string value. Optimized to skip native call when no %.\n */\nfunction decode(str: string): string {\n  if (str.indexOf(\"%\") === -1) return str;\n\n  try {\n    return decodeURIComponent(str);\n  } catch (e) {\n    return str;\n  }\n}\n\n/**\n * Determine if value is a Date.\n */\nfunction isDate(val: any): val is Date {\n  return __toString.call(val) === \"[object Date]\";\n}\n","//# sourceMappingURL=types.js.map","export const VERSION = '0.7.0';\n","import { parse, serialize } from \"cookie\";\n\nimport {\n  DEFAULT_COOKIE_OPTIONS,\n  combineChunks,\n  createChunks,\n  isBrowser,\n  isChunkLike,\n  stringFromBase64URL,\n  stringToBase64URL,\n} from \"./utils\";\n\nimport type {\n  CookieMethodsServer,\n  CookieMethodsServerDeprecated,\n  CookieMethodsBrowser,\n  CookieMethodsBrowserDeprecated,\n  CookieOptions,\n  CookieOptionsWithName,\n  GetAllCookies,\n  SetAllCookies,\n} from \"./types\";\n\nconst BASE64_PREFIX = \"base64-\";\n\n/**\n * Creates a storage client that handles cookies correctly for browser and\n * server clients with or without properly provided cookie methods.\n *\n * @param options The options passed to createBrowserClient or createServer client.\n *\n * @param isServerClient Whether it's called from createServerClient.\n */\nexport function createStorageFromOptions(\n  options: {\n    cookieEncoding: \"raw\" | \"base64url\";\n    cookies?:\n      | CookieMethodsBrowser\n      | CookieMethodsBrowserDeprecated\n      | CookieMethodsServer\n      | CookieMethodsServerDeprecated;\n    cookieOptions?: CookieOptionsWithName;\n  },\n  isServerClient: boolean,\n) {\n  const cookies = options.cookies ?? null;\n  const cookieEncoding = options.cookieEncoding;\n\n  const setItems: { [key: string]: string } = {};\n  const removedItems: { [key: string]: boolean } = {};\n\n  let getAll: (keyHints: string[]) => ReturnType<GetAllCookies>;\n  let setAll: SetAllCookies;\n\n  if (cookies) {\n    if (\"get\" in cookies) {\n      // Just get is not enough, because the client needs to see what cookies\n      // are already set and unset them if necessary. To attempt to fix this\n      // behavior for most use cases, we pass \"hints\" which is the keys of the\n      // storage items. They are then converted to their corresponding cookie\n      // chunk names and are fetched with get. Only 5 chunks are fetched, which\n      // should be enough for the majority of use cases, but does not solve\n      // those with very large sessions.\n\n      const getWithHints = async (keyHints: string[]) => {\n        // optimistically find the first 5 potential chunks for the specified key\n        const chunkNames = keyHints.flatMap((keyHint) => [\n          keyHint,\n          ...Array.from({ length: 5 }).map((_, i) => `${keyHint}.${i}`),\n        ]);\n\n        const chunks: ReturnType<GetAllCookies> = [];\n\n        for (let i = 0; i < chunkNames.length; i += 1) {\n          const value = await cookies.get(chunkNames[i]);\n\n          if (!value && typeof value !== \"string\") {\n            continue;\n          }\n\n          chunks.push({ name: chunkNames[i], value });\n        }\n\n        // TODO: detect and log stale chunks error\n\n        return chunks;\n      };\n\n      getAll = async (keyHints: string[]) => await getWithHints(keyHints);\n\n      if (\"set\" in cookies && \"remove\" in cookies) {\n        setAll = async (setCookies) => {\n          for (let i = 0; i < setCookies.length; i += 1) {\n            const { name, value, options } = setCookies[i];\n\n            if (value) {\n              await cookies.set!(name, value, options);\n            } else {\n              await cookies.remove!(name, options);\n            }\n          }\n        };\n      } else if (isServerClient) {\n        setAll = async () => {\n          console.warn(\n            \"@supabase/ssr: createServerClient was configured without set and remove cookie methods, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness. Consider switching to the getAll and setAll cookie methods instead of get, set and remove which are deprecated and can be difficult to use correctly.\",\n          );\n        };\n      } else {\n        throw new Error(\n          \"@supabase/ssr: createBrowserClient requires configuring a getAll and setAll cookie method (deprecated: alternatively both get, set and remove can be used)\",\n        );\n      }\n    } else if (\"getAll\" in cookies) {\n      getAll = async () => await cookies.getAll!();\n\n      if (\"setAll\" in cookies) {\n        setAll = cookies.setAll!;\n      } else if (isServerClient) {\n        setAll = async () => {\n          console.warn(\n            \"@supabase/ssr: createServerClient was configured without the setAll cookie method, but the client needs to set cookies. This can lead to issues such as random logouts, early session termination or increased token refresh requests. If in NextJS, check your middleware.ts file, route handlers and server actions for correctness.\",\n          );\n        };\n      } else {\n        throw new Error(\n          \"@supabase/ssr: createBrowserClient requires configuring both getAll and setAll cookie methods (deprecated: alternatively both get, set and remove can be used)\",\n        );\n      }\n    } else {\n      // neither get nor getAll is present on cookies, only will occur if pure JavaScript is used, but cookies is an object\n      throw new Error(\n        `@supabase/ssr: ${isServerClient ? \"createServerClient\" : \"createBrowserClient\"} requires configuring getAll and setAll cookie methods (deprecated: alternatively use get, set and remove).${isBrowser() ? \" As this is called in a browser runtime, consider removing the cookies option object to use the document.cookie API automatically.\" : \"\"}`,\n      );\n    }\n  } else if (!isServerClient && isBrowser()) {\n    // The environment is browser, so use the document.cookie API to implement getAll and setAll.\n\n    const noHintGetAll = () => {\n      const parsed = parse(document.cookie);\n\n      return Object.keys(parsed).map((name) => ({\n        name,\n        value: parsed[name] ?? \"\",\n      }));\n    };\n\n    getAll = () => noHintGetAll();\n\n    setAll = (setCookies) => {\n      setCookies.forEach(({ name, value, options }) => {\n        document.cookie = serialize(name, value, options);\n      });\n    };\n  } else if (isServerClient) {\n    throw new Error(\n      \"@supabase/ssr: createServerClient must be initialized with cookie options that specify getAll and setAll functions (deprecated, not recommended: alternatively use get, set and remove)\",\n    );\n  } else {\n    // getting cookies when there's no window but we're in browser mode can be OK, because the developer probably is not using auth functions\n    getAll = () => {\n      return [];\n    };\n\n    // this is NOT OK because the developer is using auth functions that require setting some state, so that must error out\n    setAll = () => {\n      throw new Error(\n        \"@supabase/ssr: createBrowserClient in non-browser runtimes (including Next.js pre-rendering mode) was not initialized cookie options that specify getAll and setAll functions (deprecated: alternatively use get, set and remove), but they were needed\",\n      );\n    };\n  }\n\n  if (!isServerClient) {\n    // This is the storage client to be used in browsers. It only\n    // works on the cookies abstraction, unlike the server client\n    // which only uses cookies to read the initial state. When an\n    // item is set, cookies are both cleared and set to values so\n    // that stale chunks are not left remaining.\n    return {\n      getAll, // for type consistency\n      setAll, // for type consistency\n      setItems, // for type consistency\n      removedItems, // for type consistency\n      storage: {\n        isServer: false,\n        getItem: async (key: string) => {\n          const allCookies = await getAll([key]);\n          const chunkedCookie = await combineChunks(\n            key,\n            async (chunkName: string) => {\n              const cookie =\n                allCookies?.find(({ name }) => name === chunkName) || null;\n\n              if (!cookie) {\n                return null;\n              }\n\n              return cookie.value;\n            },\n          );\n\n          if (!chunkedCookie) {\n            return null;\n          }\n\n          let decoded = chunkedCookie;\n\n          if (chunkedCookie.startsWith(BASE64_PREFIX)) {\n            decoded = stringFromBase64URL(\n              chunkedCookie.substring(BASE64_PREFIX.length),\n            );\n          }\n\n          return decoded;\n        },\n        setItem: async (key: string, value: string) => {\n          const allCookies = await getAll([key]);\n          const cookieNames = allCookies?.map(({ name }) => name) || [];\n\n          const removeCookies = new Set(\n            cookieNames.filter((name) => isChunkLike(name, key)),\n          );\n\n          let encoded = value;\n\n          if (cookieEncoding === \"base64url\") {\n            encoded = BASE64_PREFIX + stringToBase64URL(value);\n          }\n\n          const setCookies = createChunks(key, encoded);\n\n          setCookies.forEach(({ name }) => {\n            removeCookies.delete(name);\n          });\n\n          const removeCookieOptions = {\n            ...DEFAULT_COOKIE_OPTIONS,\n            ...options?.cookieOptions,\n            maxAge: 0,\n          };\n          const setCookieOptions = {\n            ...DEFAULT_COOKIE_OPTIONS,\n            ...options?.cookieOptions,\n            maxAge: DEFAULT_COOKIE_OPTIONS.maxAge,\n          };\n\n          // the NextJS cookieStore API can get confused if the `name` from\n          // options.cookieOptions leaks\n          delete removeCookieOptions.name;\n          delete setCookieOptions.name;\n\n          const allToSet = [\n            ...[...removeCookies].map((name) => ({\n              name,\n              value: \"\",\n              options: removeCookieOptions,\n            })),\n            ...setCookies.map(({ name, value }) => ({\n              name,\n              value,\n              options: setCookieOptions,\n            })),\n          ];\n\n          if (allToSet.length > 0) {\n            await setAll(allToSet);\n          }\n        },\n        removeItem: async (key: string) => {\n          const allCookies = await getAll([key]);\n          const cookieNames = allCookies?.map(({ name }) => name) || [];\n          const removeCookies = cookieNames.filter((name) =>\n            isChunkLike(name, key),\n          );\n\n          const removeCookieOptions = {\n            ...DEFAULT_COOKIE_OPTIONS,\n            ...options?.cookieOptions,\n            maxAge: 0,\n          };\n\n          // the NextJS cookieStore API can get confused if the `name` from\n          // options.cookieOptions leaks\n          delete removeCookieOptions.name;\n\n          if (removeCookies.length > 0) {\n            await setAll(\n              removeCookies.map((name) => ({\n                name,\n                value: \"\",\n                options: removeCookieOptions,\n              })),\n            );\n          }\n        },\n      },\n    };\n  }\n\n  // This is the server client. It only uses getAll to read the initial\n  // state. Any subsequent changes to the items is persisted in the\n  // setItems and removedItems objects. createServerClient *must* use\n  // getAll, setAll and the values in setItems and removedItems to\n  // persist the changes *at once* when appropriate (usually only when\n  // the TOKEN_REFRESHED, USER_UPDATED or SIGNED_OUT events are fired by\n  // the Supabase Auth client).\n  return {\n    getAll,\n    setAll,\n    setItems,\n    removedItems,\n    storage: {\n      // to signal to the libraries that these cookies are\n      // coming from a server environment and their value\n      // should not be trusted\n      isServer: true,\n      getItem: async (key: string) => {\n        if (typeof setItems[key] === \"string\") {\n          return setItems[key];\n        }\n\n        if (removedItems[key]) {\n          return null;\n        }\n\n        const allCookies = await getAll([key]);\n        const chunkedCookie = await combineChunks(\n          key,\n          async (chunkName: string) => {\n            const cookie =\n              allCookies?.find(({ name }) => name === chunkName) || null;\n\n            if (!cookie) {\n              return null;\n            }\n\n            return cookie.value;\n          },\n        );\n\n        if (!chunkedCookie) {\n          return null;\n        }\n\n        let decoded = chunkedCookie;\n\n        if (\n          typeof chunkedCookie === \"string\" &&\n          chunkedCookie.startsWith(BASE64_PREFIX)\n        ) {\n          decoded = stringFromBase64URL(\n            chunkedCookie.substring(BASE64_PREFIX.length),\n          );\n        }\n\n        return decoded;\n      },\n      setItem: async (key: string, value: string) => {\n        // We don't have an `onAuthStateChange` event that can let us know that\n        // the PKCE code verifier is being set. Therefore, if we see it being\n        // set, we need to apply the storage (call `setAll` so the cookie is\n        // set properly).\n        if (key.endsWith(\"-code-verifier\")) {\n          await applyServerStorage(\n            {\n              getAll,\n              setAll,\n              // pretend only that the code verifier was set\n              setItems: { [key]: value },\n              // pretend that nothing was removed\n              removedItems: {},\n            },\n            {\n              cookieOptions: options?.cookieOptions ?? null,\n              cookieEncoding,\n            },\n          );\n        }\n\n        setItems[key] = value;\n        delete removedItems[key];\n      },\n      removeItem: async (key: string) => {\n        // Intentionally not applying the storage when the key is the PKCE code\n        // verifier, as usually right after it's removed other items are set,\n        // so application of the storage will be handled by the\n        // `onAuthStateChange` callback that follows removal -- usually as part\n        // of the `exchangeCodeForSession` call.\n        delete setItems[key];\n        removedItems[key] = true;\n      },\n    },\n  };\n}\n\n/**\n * When createServerClient needs to apply the created storage to cookies, it\n * should call this function which handles correcly setting cookies for stored\n * and removed items in the storage.\n */\nexport async function applyServerStorage(\n  {\n    getAll,\n    setAll,\n    setItems,\n    removedItems,\n  }: {\n    getAll: (keyHints: string[]) => ReturnType<GetAllCookies>;\n    setAll: SetAllCookies;\n    setItems: { [name: string]: string };\n    removedItems: { [name: string]: boolean };\n  },\n  options: {\n    cookieEncoding: \"raw\" | \"base64url\";\n    cookieOptions?: CookieOptions | null;\n  },\n) {\n  const cookieEncoding = options.cookieEncoding;\n  const cookieOptions = options.cookieOptions ?? null;\n\n  const allCookies = await getAll([\n    ...(setItems ? (Object.keys(setItems) as string[]) : []),\n    ...(removedItems ? (Object.keys(removedItems) as string[]) : []),\n  ]);\n  const cookieNames = allCookies?.map(({ name }) => name) || [];\n\n  const removeCookies: string[] = Object.keys(removedItems).flatMap(\n    (itemName) => {\n      return cookieNames.filter((name) => isChunkLike(name, itemName));\n    },\n  );\n\n  const setCookies = Object.keys(setItems).flatMap((itemName) => {\n    const removeExistingCookiesForItem = new Set(\n      cookieNames.filter((name) => isChunkLike(name, itemName)),\n    );\n\n    let encoded = setItems[itemName];\n\n    if (cookieEncoding === \"base64url\") {\n      encoded = BASE64_PREFIX + stringToBase64URL(encoded);\n    }\n\n    const chunks = createChunks(itemName, encoded);\n\n    chunks.forEach((chunk) => {\n      removeExistingCookiesForItem.delete(chunk.name);\n    });\n\n    removeCookies.push(...removeExistingCookiesForItem);\n\n    return chunks;\n  });\n\n  const removeCookieOptions = {\n    ...DEFAULT_COOKIE_OPTIONS,\n    ...cookieOptions,\n    maxAge: 0,\n  };\n  const setCookieOptions = {\n    ...DEFAULT_COOKIE_OPTIONS,\n    ...cookieOptions,\n    maxAge: DEFAULT_COOKIE_OPTIONS.maxAge,\n  };\n\n  // the NextJS cookieStore API can get confused if the `name` from\n  // options.cookieOptions leaks\n  delete (removeCookieOptions as any).name;\n  delete (setCookieOptions as any).name;\n\n  await setAll([\n    ...removeCookies.map((name) => ({\n      name,\n      value: \"\",\n      options: removeCookieOptions,\n    })),\n    ...setCookies.map(({ name, value }) => ({\n      name,\n      value,\n      options: setCookieOptions,\n    })),\n  ]);\n}\n","export * from \"./createBrowserClient\";\nexport * from \"./createServerClient\";\nexport * from \"./types\";\nexport * from \"./utils\";\n","export * from \"./helpers\";\nexport * from \"./constants\";\nexport * from \"./chunker\";\nexport * from \"./base64url\";\n","import type { SerializeOptions } from \"cookie\";\nimport { parse as cookieParse, serialize as cookieSerialize } from \"cookie\";\n\n/**\n * @deprecated Since v0.4.0: Please use {@link parseCookieHeader}. `parse` will\n * not be available for import starting v1.0.0 of `@supabase/ssr`.\n */\nexport const parse = cookieParse;\n\n/**\n * @deprecated Since v0.4.0: Please use {@link serializeCookieHeader}.\n * `serialize` will not be available for import starting v1.0.0 of\n * `@supabase/ssr`.\n */\nexport const serialize = cookieSerialize;\n\n/**\n * Parses the `Cookie` HTTP header into an array of cookie name-value objects.\n *\n * @param header The `Cookie` HTTP header. Decodes cookie names and values from\n * URI encoding first.\n */\nexport function parseCookieHeader(\n  header: string,\n): { name: string; value?: string }[] {\n  const parsed = cookieParse(header);\n\n  return Object.keys(parsed ?? {}).map((name) => ({\n    name,\n    value: parsed[name],\n  }));\n}\n\n/**\n * Converts the arguments to a valid `Set-Cookie` header. Non US-ASCII chars\n * and other forbidden cookie chars will be URI encoded.\n *\n * @param name Name of cookie.\n * @param value Value of cookie.\n */\nexport function serializeCookieHeader(\n  name: string,\n  value: string,\n  options: SerializeOptions,\n): string {\n  return cookieSerialize(name, value, options);\n}\n\nexport function isBrowser() {\n  return (\n    typeof window !== \"undefined\" && typeof window.document !== \"undefined\"\n  );\n}\n","import {\n  createClient,\n  SupabaseClient,\n  SupabaseClientOptions,\n} from \"@supabase/supabase-js\";\n\nimport { VERSION } from \"./version\";\nimport { isBrowser } from \"./utils\";\n\nimport type {\n  CookieMethodsBrowser,\n  CookieMethodsBrowserDeprecated,\n  CookieOptionsWithName,\n} from \"./types\";\n\nimport { createStorageFromOptions } from \"./cookies\";\n\nlet cachedBrowserClient: SupabaseClient<any, any, any> | undefined;\n\n/**\n * Creates a Supabase Client for use in a browser environment.\n *\n * In most cases you should not configure the `options.cookies` object, as this\n * is automatically handled for you. If you do customize this, prefer using the\n * `getAll` and `setAll` functions over `get`, `set` and `remove`. The latter\n * are deprecated due to being difficult to correctly implement and not\n * supporting some edge-cases. Both `getAll` and `setAll` (or both `get`, `set`\n * and `remove`) must be provided. Failing to provide the methods for setting\n * will throw an exception, and in previous versions of the library will result\n * in difficult to debug authentication issues such as random logouts, early\n * session termination or problems with inconsistent state.\n *\n * @param supabaseUrl The URL of the Supabase project.\n * @param supabaseKey The `anon` API key of the Supabase project.\n * @param options Various configuration options.\n */\nexport function createBrowserClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options?: SupabaseClientOptions<SchemaName> & {\n    cookies?: CookieMethodsBrowser;\n    cookieOptions?: CookieOptionsWithName;\n    cookieEncoding?: \"raw\" | \"base64url\";\n    isSingleton?: boolean;\n  },\n): SupabaseClient<Database, SchemaName>;\n\n/**\n * @deprecated Please specify `getAll` and `setAll` cookie methods instead of\n * the `get`, `set` and `remove`. These will not be supported in the next major\n * version.\n */\nexport function createBrowserClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options?: SupabaseClientOptions<SchemaName> & {\n    cookies: CookieMethodsBrowserDeprecated;\n    cookieOptions?: CookieOptionsWithName;\n    cookieEncoding?: \"raw\" | \"base64url\";\n    isSingleton?: boolean;\n  },\n): SupabaseClient<Database, SchemaName>;\n\nexport function createBrowserClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options?: SupabaseClientOptions<SchemaName> & {\n    cookies?: CookieMethodsBrowser | CookieMethodsBrowserDeprecated;\n    cookieOptions?: CookieOptionsWithName;\n    cookieEncoding?: \"raw\" | \"base64url\";\n    isSingleton?: boolean;\n  },\n): SupabaseClient<Database, SchemaName> {\n  // singleton client is created only if isSingleton is set to true, or if isSingleton is not defined and we detect a browser\n  const shouldUseSingleton =\n    options?.isSingleton === true ||\n    ((!options || !(\"isSingleton\" in options)) && isBrowser());\n\n  if (shouldUseSingleton && cachedBrowserClient) {\n    return cachedBrowserClient;\n  }\n\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error(\n      `@supabase/ssr: Your project's URL and API key are required to create a Supabase client!\\n\\nCheck your Supabase project's API settings to find these values\\n\\nhttps://supabase.com/dashboard/project/_/settings/api`,\n    );\n  }\n\n  const { storage } = createStorageFromOptions(\n    {\n      ...options,\n      cookieEncoding: options?.cookieEncoding ?? \"base64url\",\n    },\n    false,\n  );\n\n  const client = createClient<Database, SchemaName>(supabaseUrl, supabaseKey, {\n    // TODO: resolve type error\n    ...(options as any),\n    global: {\n      ...options?.global,\n      headers: {\n        ...options?.global?.headers,\n        \"X-Client-Info\": `supabase-ssr/${VERSION} createBrowserClient`,\n      },\n    },\n    auth: {\n      ...options?.auth,\n      ...(options?.cookieOptions?.name\n        ? { storageKey: options.cookieOptions.name }\n        : null),\n      flowType: \"pkce\",\n      autoRefreshToken: isBrowser(),\n      detectSessionInUrl: isBrowser(),\n      persistSession: true,\n      storage,\n    },\n  });\n\n  if (shouldUseSingleton) {\n    cachedBrowserClient = client;\n  }\n\n  return client;\n}\n","import {\n  AuthChangeEvent,\n  createClient,\n  SupabaseClient,\n  SupabaseClientOptions,\n} from \"@supabase/supabase-js\";\n\nimport { VERSION } from \"./version\";\nimport { createStorageFromOptions, applyServerStorage } from \"./cookies\";\nimport type {\n  CookieOptionsWithName,\n  CookieMethodsServer,\n  CookieMethodsServerDeprecated,\n} from \"./types\";\n\n/**\n * @deprecated Please specify `getAll` and `setAll` cookie methods instead of\n * the `get`, `set` and `remove`. These will not be supported in the next major\n * version.\n */\nexport function createServerClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options: SupabaseClientOptions<SchemaName> & {\n    cookieOptions?: CookieOptionsWithName;\n    cookies: CookieMethodsServerDeprecated;\n    cookieEncoding?: \"raw\" | \"base64url\";\n  },\n): SupabaseClient<Database, SchemaName>;\n\n/**\n * Creates a Supabase Client for use on the server-side of a server-side\n * rendering (SSR) framework.\n *\n * There are two categories of uses for this function: use in middlewares and\n * use in pages, components or routes.\n *\n * **Use in middlewares.**\n *\n * Middlewares are functions that run before any rendering logic is executed on\n * the server-side. They typically have access to request headers (cookies) and\n * can modify both the request and response headers.\n *\n * In most SSR frameworks, to use Supabase correctly you *must set up a\n * middleware* and use this function in it.\n *\n * When using this in a middleware, the `cookie` option must be configured to\n * use both `getAll` and `setAll`. Alternatively you can use the `get`, `set`\n * and `remove` functions. The latter are deprecated **and not recommended**\n * for most use cases due to being difficult to use properly and they do not\n * cover important edge cases. In future major versions of the library, the\n * option to configure `get`, `set` and `remove` will be removed.\n *\n * **IMPORTANT:** Failing to implement `getAll` and `setAll` correctly (or the\n * deprecated `get`, `set` and `remove`) including omitting them **will cause\n * significant and difficult to debug authentication issues**. They will\n * manifest as: random logouts, early session termination, JSON parsing errors,\n * increased number of refresh token requests, or relying on garbage state.\n *\n * **Use in pages, components or routes.**\n *\n * To use Supabase features server-side rendered in pages, components or routes\n * (a.k.a. actions / APIs) you must create a client with this function. Not all\n * frameworks allow the ability to set cookies or response headers when pages\n * or components are rendered. In those cases you _can omit `setAll` (or the\n * deprecated `set`, `remove`) cookie option methods_. **It is strongly\n * recommended that if the ability to set cookies and response headers is\n * present, you should configure the `setAll` (or the deprecated `set` and\n * `remove`) cookie access methods.**\n *\n * **IMPORTANT:** If the ability to set cookies or response headers is not\n * available **middleware or an equivalent must be used.** Failing to do this\n * will cause significant and difficult to debug authentication issues.\n *\n * When `setAll` (or the deprecated `set`, `remove`) cookie methods are not\n * configured, the Supabase Client will emit a warning if it is used in a way\n * that requires setting cookies. If you see this warning, it usually means\n * that you are using the Supabase Client in a wrong way:\n *\n * - You should have, but did not configure a middleware client.\n * - There is a bug in your middleware function.\n * - You are using features of the Supabase Client that change the User, e.g.\n *   by calling `supabase.auth.updateUser()` on the server.\n *\n * Please consult the latest Supabase guides for advice on how to avoid common\n * pitfalls depending on SSR framework.\n *\n * @param supabaseUrl The URL of the Supabase project.\n * @param supabaseKey The `anon` API key of the Supabase project.\n * @param options Various configuration options.\n */\nexport function createServerClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options: SupabaseClientOptions<SchemaName> & {\n    cookieOptions?: CookieOptionsWithName;\n    cookies: CookieMethodsServer;\n    cookieEncoding?: \"raw\" | \"base64url\";\n  },\n): SupabaseClient<Database, SchemaName>;\n\nexport function createServerClient<\n  Database = any,\n  SchemaName extends string &\n    keyof Omit<Database, \"__InternalSupabase\"> = \"public\" extends keyof Omit<\n    Database,\n    \"__InternalSupabase\"\n  >\n    ? \"public\"\n    : string & keyof Omit<Database, \"__InternalSupabase\">,\n>(\n  supabaseUrl: string,\n  supabaseKey: string,\n  options: SupabaseClientOptions<SchemaName> & {\n    cookieOptions?: CookieOptionsWithName;\n    cookies: CookieMethodsServer | CookieMethodsServerDeprecated;\n    cookieEncoding?: \"raw\" | \"base64url\";\n  },\n): SupabaseClient<Database, SchemaName> {\n  if (!supabaseUrl || !supabaseKey) {\n    throw new Error(\n      `Your project's URL and Key are required to create a Supabase client!\\n\\nCheck your Supabase project's API settings to find these values\\n\\nhttps://supabase.com/dashboard/project/_/settings/api`,\n    );\n  }\n\n  const { storage, getAll, setAll, setItems, removedItems } =\n    createStorageFromOptions(\n      {\n        ...options,\n        cookieEncoding: options?.cookieEncoding ?? \"base64url\",\n      },\n      true,\n    );\n\n  const client = createClient<Database, SchemaName>(supabaseUrl, supabaseKey, {\n    // TODO: resolve type error\n    ...(options as any),\n    global: {\n      ...options?.global,\n      headers: {\n        ...options?.global?.headers,\n        \"X-Client-Info\": `supabase-ssr/${VERSION} createServerClient`,\n      },\n    },\n    auth: {\n      ...(options?.cookieOptions?.name\n        ? { storageKey: options.cookieOptions.name }\n        : null),\n      ...options?.auth,\n      flowType: \"pkce\",\n      autoRefreshToken: false,\n      detectSessionInUrl: false,\n      persistSession: true,\n      storage,\n    },\n  });\n\n  client.auth.onAuthStateChange(async (event: AuthChangeEvent) => {\n    // The SIGNED_IN event is fired very often, but we don't need to\n    // apply the storage each time it fires, only if there are changes\n    // that need to be set -- which is if setItems / removeItems have\n    // data.\n    const hasStorageChanges =\n      Object.keys(setItems).length > 0 || Object.keys(removedItems).length > 0;\n\n    if (\n      hasStorageChanges &&\n      (event === \"SIGNED_IN\" ||\n        event === \"TOKEN_REFRESHED\" ||\n        event === \"USER_UPDATED\" ||\n        event === \"PASSWORD_RECOVERY\" ||\n        event === \"SIGNED_OUT\" ||\n        event === \"MFA_CHALLENGE_VERIFIED\")\n    ) {\n      await applyServerStorage(\n        { getAll, setAll, setItems, removedItems },\n        {\n          cookieOptions: options?.cookieOptions ?? null,\n          cookieEncoding: options?.cookieEncoding ?? \"base64url\",\n        },\n      );\n    }\n  });\n\n  return client;\n}\n","interface Chunk {\n  name: string;\n  value: string;\n}\n\nexport const MAX_CHUNK_SIZE = 3180;\n\nconst CHUNK_LIKE_REGEX = /^(.*)[.](0|[1-9][0-9]*)$/;\nexport function isChunkLike(cookieName: string, key: string) {\n  if (cookieName === key) {\n    return true;\n  }\n\n  const chunkLike = cookieName.match(CHUNK_LIKE_REGEX);\n  if (chunkLike && chunkLike[1] === key) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * create chunks from a string and return an array of object\n */\nexport function createChunks(\n  key: string,\n  value: string,\n  chunkSize?: number,\n): Chunk[] {\n  const resolvedChunkSize = chunkSize ?? MAX_CHUNK_SIZE;\n\n  let encodedValue = encodeURIComponent(value);\n\n  if (encodedValue.length <= resolvedChunkSize) {\n    return [{ name: key, value }];\n  }\n\n  const chunks: string[] = [];\n\n  while (encodedValue.length > 0) {\n    let encodedChunkHead = encodedValue.slice(0, resolvedChunkSize);\n\n    const lastEscapePos = encodedChunkHead.lastIndexOf(\"%\");\n\n    // Check if the last escaped character is truncated.\n    if (lastEscapePos > resolvedChunkSize - 3) {\n      // If so, reslice the string to exclude the whole escape sequence.\n      // We only reduce the size of the string as the chunk must\n      // be smaller than the chunk size.\n      encodedChunkHead = encodedChunkHead.slice(0, lastEscapePos);\n    }\n\n    let valueHead: string = \"\";\n\n    // Check if the chunk was split along a valid unicode boundary.\n    while (encodedChunkHead.length > 0) {\n      try {\n        // Try to decode the chunk back and see if it is valid.\n        // Stop when the chunk is valid.\n        valueHead = decodeURIComponent(encodedChunkHead);\n        break;\n      } catch (error) {\n        if (\n          error instanceof URIError &&\n          encodedChunkHead.at(-3) === \"%\" &&\n          encodedChunkHead.length > 3\n        ) {\n          encodedChunkHead = encodedChunkHead.slice(\n            0,\n            encodedChunkHead.length - 3,\n          );\n        } else {\n          throw error;\n        }\n      }\n    }\n\n    chunks.push(valueHead);\n    encodedValue = encodedValue.slice(encodedChunkHead.length);\n  }\n\n  return chunks.map((value, i) => ({ name: `${key}.${i}`, value }));\n}\n\n// Get fully constructed chunks\nexport async function combineChunks(\n  key: string,\n  retrieveChunk: (\n    name: string,\n  ) => Promise<string | null | undefined> | string | null | undefined,\n) {\n  const value = await retrieveChunk(key);\n\n  if (value) {\n    return value;\n  }\n\n  let values: string[] = [];\n\n  for (let i = 0; ; i++) {\n    const chunkName = `${key}.${i}`;\n    const chunk = await retrieveChunk(chunkName);\n\n    if (!chunk) {\n      break;\n    }\n\n    values.push(chunk);\n  }\n\n  if (values.length > 0) {\n    return values.join(\"\");\n  }\n\n  return null;\n}\n\nexport async function deleteChunks(\n  key: string,\n  retrieveChunk: (\n    name: string,\n  ) => Promise<string | null | undefined> | string | null | undefined,\n  removeChunk: (name: string) => Promise<void> | void,\n) {\n  const value = await retrieveChunk(key);\n\n  if (value) {\n    await removeChunk(key);\n  }\n\n  for (let i = 0; ; i++) {\n    const chunkName = `${key}.${i}`;\n    const chunk = await retrieveChunk(chunkName);\n\n    if (!chunk) {\n      break;\n    }\n\n    await removeChunk(chunkName);\n  }\n}\n","import { createServerClient } from \"@supabase/ssr\";\nimport { cache } from \"react\";\n\n/**\n * Create a Supabase client for use in Server Components\n * This is useful for Supabase Auth, Storage, Realtime, etc.\n *\n * PERFORMANCE: Wrapped with React.cache() to prevent recreating\n * the client on every component render. This dramatically improves\n * performance by reusing the same client instance across the request.\n *\n * SESSION ISOLATION: This client uses default Supabase cookie names.\n * The admin app uses prefixed cookies (admin_*) to isolate its sessions.\n * This ensures admin and contractor sessions don't conflict.\n */\nexport const createClient = cache(async () => {\n\tconst supabaseUrl = process.env.NEXT_PUBLIC_SUPABASE_URL;\n\tconst supabaseAnonKey = process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY;\n\n\tif (!(supabaseUrl && supabaseAnonKey)) {\n\t\treturn null;\n\t}\n\n\t// Dynamic import of next/headers to prevent bundling in client components\n\tconst { cookies, headers } = await import(\"next/headers\");\n\n\tlet cookieStore;\n\n\t// Check if we're in a prerendering context by looking at headers\n\tlet headersStore;\n\ttry {\n\t\theadersStore = await headers();\n\t\t// If we can get headers and there's no x-prerender header, we might be safe\n\t\tif (headersStore.get('x-prerender')) {\n\t\t\treturn null;\n\t\t}\n\t} catch {\n\t\t// If headers() fails, we're likely in prerendering\n\t\treturn null;\n\t}\n\n\ttry {\n\t\tcookieStore = await cookies();\n\t} catch (error) {\n\t\t// During prerendering, cookies() may reject - return null\n\t\t// This allows PPR to work correctly\n\t\tif (error instanceof Error && (\n\t\t\terror.message.includes(\"During prerendering\") ||\n\t\t\terror.message.includes(\"prerendering\") ||\n\t\t\terror.message.includes(\"cookies()\")\n\t\t)) {\n\t\t\treturn null;\n\t\t}\n\t\t// For other errors, rethrow\n\t\tthrow error;\n\t}\n\n\treturn createServerClient(supabaseUrl, supabaseAnonKey, {\n\t\tcookies: {\n\t\t\tget(name: string) {\n\t\t\t\treturn cookieStore.get(name)?.value;\n\t\t\t},\n\t\t\tset(name: string, value: string, options) {\n\t\t\t\ttry {\n\t\t\t\t\tcookieStore.set(name, value, options);\n\t\t\t\t} catch {\n\t\t\t\t\t// The `set` method was called from a Server Component.\n\t\t\t\t\t// This can be ignored if you have middleware refreshing\n\t\t\t\t\t// user sessions.\n\t\t\t\t}\n\t\t\t},\n\t\t\tremove(name: string, _options) {\n\t\t\t\ttry {\n\t\t\t\t\tcookieStore.delete(name);\n\t\t\t\t} catch {\n\t\t\t\t\t// The `delete` method was called from a Server Component.\n\t\t\t\t\t// This can be ignored if you have middleware refreshing\n\t\t\t\t\t// user sessions.\n\t\t\t\t}\n\t\t\t},\n\t\t},\n\t});\n});\n","import { CookieOptions } from \"../types\";\n\nexport const DEFAULT_COOKIE_OPTIONS: CookieOptions = {\n  path: \"/\",\n  sameSite: \"lax\",\n  httpOnly: false,\n  // https://developer.chrome.com/blog/cookie-max-age-expires\n  // https://httpwg.org/http-extensions/draft-ietf-httpbis-rfc6265bis.html#name-cookie-lifetime-limits\n  maxAge: 400 * 24 * 60 * 60,\n};\n","/**\n * Avoid modifying this file. It's part of\n * https://github.com/supabase-community/base64url-js.  Submit all fixes on\n * that repo!\n */\n\n/**\n * An array of characters that encode 6 bits into a Base64-URL alphabet\n * character.\n */\nconst TO_BASE64URL =\n  \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_\".split(\"\");\n\n/**\n * An array of characters that can appear in a Base64-URL encoded string but\n * should be ignored.\n */\nconst IGNORE_BASE64URL = \" \\t\\n\\r=\".split(\"\");\n\n/**\n * An array of 128 numbers that map a Base64-URL character to 6 bits, or if -2\n * used to skip the character, or if -1 used to error out.\n */\nconst FROM_BASE64URL = (() => {\n  const charMap: number[] = new Array(128);\n\n  for (let i = 0; i < charMap.length; i += 1) {\n    charMap[i] = -1;\n  }\n\n  for (let i = 0; i < IGNORE_BASE64URL.length; i += 1) {\n    charMap[IGNORE_BASE64URL[i].charCodeAt(0)] = -2;\n  }\n\n  for (let i = 0; i < TO_BASE64URL.length; i += 1) {\n    charMap[TO_BASE64URL[i].charCodeAt(0)] = i;\n  }\n\n  return charMap;\n})();\n\n/**\n * Converts a JavaScript string (which may include any valid character) into a\n * Base64-URL encoded string. The string is first encoded in UTF-8 which is\n * then encoded as Base64-URL.\n *\n * @param str The string to convert.\n */\nexport function stringToBase64URL(str: string) {\n  const base64: string[] = [];\n\n  let queue = 0;\n  let queuedBits = 0;\n\n  const emitter = (byte: number) => {\n    queue = (queue << 8) | byte;\n    queuedBits += 8;\n\n    while (queuedBits >= 6) {\n      const pos = (queue >> (queuedBits - 6)) & 63;\n      base64.push(TO_BASE64URL[pos]);\n      queuedBits -= 6;\n    }\n  };\n\n  stringToUTF8(str, emitter);\n\n  if (queuedBits > 0) {\n    queue = queue << (6 - queuedBits);\n    queuedBits = 6;\n\n    while (queuedBits >= 6) {\n      const pos = (queue >> (queuedBits - 6)) & 63;\n      base64.push(TO_BASE64URL[pos]);\n      queuedBits -= 6;\n    }\n  }\n\n  return base64.join(\"\");\n}\n\n/**\n * Converts a Base64-URL encoded string into a JavaScript string. It is assumed\n * that the underlying string has been encoded as UTF-8.\n *\n * @param str The Base64-URL encoded string.\n */\nexport function stringFromBase64URL(str: string) {\n  const conv: string[] = [];\n\n  const emit = (codepoint: number) => {\n    conv.push(String.fromCodePoint(codepoint));\n  };\n\n  const state = {\n    utf8seq: 0,\n    codepoint: 0,\n  };\n\n  let queue = 0;\n  let queuedBits = 0;\n\n  for (let i = 0; i < str.length; i += 1) {\n    const codepoint = str.charCodeAt(i);\n    const bits = FROM_BASE64URL[codepoint];\n\n    if (bits > -1) {\n      // valid Base64-URL character\n      queue = (queue << 6) | bits;\n      queuedBits += 6;\n\n      while (queuedBits >= 8) {\n        stringFromUTF8((queue >> (queuedBits - 8)) & 0xff, state, emit);\n        queuedBits -= 8;\n      }\n    } else if (bits === -2) {\n      // ignore spaces, tabs, newlines, =\n      continue;\n    } else {\n      throw new Error(\n        `Invalid Base64-URL character \"${str.at(i)}\" at position ${i}`,\n      );\n    }\n  }\n\n  return conv.join(\"\");\n}\n\n/**\n * Converts a Unicode codepoint to a multi-byte UTF-8 sequence.\n *\n * @param codepoint The Unicode codepoint.\n * @param emit      Function which will be called for each UTF-8 byte that represents the codepoint.\n */\nexport function codepointToUTF8(\n  codepoint: number,\n  emit: (byte: number) => void,\n) {\n  if (codepoint <= 0x7f) {\n    emit(codepoint);\n    return;\n  } else if (codepoint <= 0x7ff) {\n    emit(0xc0 | (codepoint >> 6));\n    emit(0x80 | (codepoint & 0x3f));\n    return;\n  } else if (codepoint <= 0xffff) {\n    emit(0xe0 | (codepoint >> 12));\n    emit(0x80 | ((codepoint >> 6) & 0x3f));\n    emit(0x80 | (codepoint & 0x3f));\n    return;\n  } else if (codepoint <= 0x10ffff) {\n    emit(0xf0 | (codepoint >> 18));\n    emit(0x80 | ((codepoint >> 12) & 0x3f));\n    emit(0x80 | ((codepoint >> 6) & 0x3f));\n    emit(0x80 | (codepoint & 0x3f));\n    return;\n  }\n\n  throw new Error(`Unrecognized Unicode codepoint: ${codepoint.toString(16)}`);\n}\n\n/**\n * Converts a JavaScript string to a sequence of UTF-8 bytes.\n *\n * @param str  The string to convert to UTF-8.\n * @param emit Function which will be called for each UTF-8 byte of the string.\n */\nexport function stringToUTF8(str: string, emit: (byte: number) => void) {\n  for (let i = 0; i < str.length; i += 1) {\n    let codepoint = str.charCodeAt(i);\n\n    if (codepoint > 0xd7ff && codepoint <= 0xdbff) {\n      // most UTF-16 codepoints are Unicode codepoints, except values in this\n      // range where the next UTF-16 codepoint needs to be combined with the\n      // current one to get the Unicode codepoint\n      const highSurrogate = ((codepoint - 0xd800) * 0x400) & 0xffff;\n      const lowSurrogate = (str.charCodeAt(i + 1) - 0xdc00) & 0xffff;\n      codepoint = (lowSurrogate | highSurrogate) + 0x10000;\n      i += 1;\n    }\n\n    codepointToUTF8(codepoint, emit);\n  }\n}\n\n/**\n * Converts a UTF-8 byte to a Unicode codepoint.\n *\n * @param byte  The UTF-8 byte next in the sequence.\n * @param state The shared state between consecutive UTF-8 bytes in the\n *              sequence, an object with the shape `{ utf8seq: 0, codepoint: 0 }`.\n * @param emit  Function which will be called for each codepoint.\n */\nexport function stringFromUTF8(\n  byte: number,\n  state: { utf8seq: number; codepoint: number },\n  emit: (codepoint: number) => void,\n) {\n  if (state.utf8seq === 0) {\n    if (byte <= 0x7f) {\n      emit(byte);\n      return;\n    }\n\n    // count the number of 1 leading bits until you reach 0\n    for (let leadingBit = 1; leadingBit < 6; leadingBit += 1) {\n      if (((byte >> (7 - leadingBit)) & 1) === 0) {\n        state.utf8seq = leadingBit;\n        break;\n      }\n    }\n\n    if (state.utf8seq === 2) {\n      state.codepoint = byte & 31;\n    } else if (state.utf8seq === 3) {\n      state.codepoint = byte & 15;\n    } else if (state.utf8seq === 4) {\n      state.codepoint = byte & 7;\n    } else {\n      throw new Error(\"Invalid UTF-8 sequence\");\n    }\n\n    state.utf8seq -= 1;\n  } else if (state.utf8seq > 0) {\n    if (byte <= 0x7f) {\n      throw new Error(\"Invalid UTF-8 sequence\");\n    }\n\n    state.codepoint = (state.codepoint << 6) | (byte & 63);\n    state.utf8seq -= 1;\n\n    if (state.utf8seq === 0) {\n      emit(state.codepoint);\n    }\n  }\n}\n","/**\n * Company Context Management\n *\n * Handles multi-tenancy by tracking and switching between companies\n * for users who may be members of multiple companies.\n *\n * Features:\n * - Active company stored in HTTP-only cookie\n * - Falls back to first available company\n * - Validates access before switching\n * - Server-side only (no client-side state)\n *\n * PERFORMANCE: All functions wrapped with React.cache() to prevent\n * redundant database queries across components in the same request.\n */\n\n\nimport { createClient } from \"@stratos/database/server\";\nimport { createServiceSupabaseClient } from \"@stratos/database/service-client\";\nimport { isOnboardingComplete } from \"@stratos/shared/onboarding\";\nimport { cache } from \"react\";\nimport { getCurrentUser } from \"./session\";\n\nconst ACTIVE_COMPANY_COOKIE = \"active_company_id\";\n\n/**\n * Company Info\n */\nexport type CompanyInfo = {\n\tid: string;\n\tname: string;\n\tlogo?: string | null;\n\tphone?: string | null;\n\temail?: string | null;\n};\n\n/**\n * Get Active Company ID\n *\n * Returns the currently active company for the user.\n * Falls back to first company if no active company is set.\n *\n * PERFORMANCE: Wrapped with React.cache() - called by every component,\n * but only executes once per request.\n *\n * @returns Company ID string or null if user has no companies\n */\nexport const getActiveCompanyId = cache(async (): Promise<string | null> => {\n\tconst { cookies } = await import(\"next/headers\");\n\tlet cookieStore;\n\ttry {\n\t\tcookieStore = await cookies();\n\t} catch (error) {\n\t\t// During prerendering, cookies() may reject - return null\n\t\t// This allows PPR to work correctly\n\t\tif (error instanceof Error && (\n\t\t\terror.message.includes(\"During prerendering\") ||\n\t\t\terror.message.includes(\"prerendering\") ||\n\t\t\terror.message.includes(\"cookies()\")\n\t\t)) {\n\t\t\treturn null;\n\t\t}\n\t\tthrow error;\n\t}\n\tconst activeCompanyId = cookieStore.get(ACTIVE_COMPANY_COOKIE)?.value;\n\n\tif (activeCompanyId) {\n\t\t// Verify user still has access to this company\n\t\tconst hasAccess = await verifyCompanyAccess(activeCompanyId);\n\t\tif (hasAccess) {\n\t\t\treturn activeCompanyId;\n\t\t}\n\t}\n\n\t// Fall back to first available company\n\tconst companies = await getUserCompanies();\n\treturn companies[0]?.id || null;\n});\n\n/**\n * Get Active Company Info\n *\n * Returns the full company object for the active company.\n *\n * PERFORMANCE: Wrapped with React.cache() - called by multiple components,\n * but only executes once per request.\n *\n * @returns CompanyInfo object or null\n */\nexport const getActiveCompany = cache(async (): Promise<CompanyInfo | null> => {\n\tconst companyId = await getActiveCompanyId();\n\tif (!companyId) {\n\t\treturn null;\n\t}\n\n\tconst supabase = await createClient();\n\tif (!supabase) {\n\t\treturn null;\n\t}\n\n\tconst { data: company } = await supabase\n\t\t.from(\"companies\")\n\t\t.select(\"id, name, logo, phone, email\")\n\t\t.eq(\"id\", companyId)\n\t\t.is(\"deleted_at\", null) // Exclude archived companies\n\t\t.single();\n\n\treturn company;\n});\n\n/**\n * Set Active Company\n *\n * Switches the user's active company context.\n * Validates access before switching.\n *\n * @param companyId - Company ID to switch to\n * @throws Error if user doesn't have access to this company\n */\nexport async function setActiveCompany(companyId: string): Promise<void> {\n\t// Verify access before switching\n\tconst hasAccess = await verifyCompanyAccess(companyId);\n\n\tif (!hasAccess) {\n\t\tthrow new Error(\"You don't have access to this company\");\n\t}\n\n\tconst { cookies } = await import(\"next/headers\");\n\tconst cookieStore = await cookies();\n\tcookieStore.set(ACTIVE_COMPANY_COOKIE, companyId, {\n\t\thttpOnly: true,\n\t\tsecure: process.env.NODE_ENV === \"production\",\n\t\tsameSite: \"lax\",\n\t\tmaxAge: 60 * 60 * 24 * 30, // 30 days\n\t\tpath: \"/\",\n\t});\n}\n\n/**\n * Clear Active Company\n *\n * Removes the active company cookie.\n */\nexport async function clearActiveCompany(): Promise<void> {\n\tconst { cookies } = await import(\"next/headers\");\n\tconst cookieStore = await cookies();\n\tcookieStore.delete(ACTIVE_COMPANY_COOKIE);\n}\n\n/**\n * Get User Companies\n *\n * Returns all companies the user has access to.\n *\n * SECURITY: Uses service role because:\n * - Query filters to user's own memberships (user_id = authenticated user)\n * - JOIN to companies table causes RLS recursion with anon key\n * - User only sees their own team_members records\n * - Companies table has its own RLS protection\n *\n * @returns Array of CompanyInfo objects\n */\nexport const getUserCompanies = cache(async (): Promise<CompanyInfo[]> => {\n\tconst user = await getCurrentUser();\n\tif (!user) {\n\t\treturn [];\n\t}\n\n\t// Use service role to bypass RLS recursion on JOIN\n\t// Query is safe: explicitly filtered to user's own records\n\tconst supabase = await createServiceSupabaseClient();\n\tif (!supabase) {\n\t\treturn [];\n\t}\n\n\tconst { data: memberships } = await supabase\n\t\t.from(\"company_memberships\")\n\t\t.select(\n\t\t\t`\n      company_id,\n      companies!inner (\n        id,\n        name,\n        logo,\n        deleted_at,\n        onboarding_completed_at\n      )\n    `,\n\t\t)\n\t\t.eq(\"user_id\", user.id)\n\t\t.eq(\"status\", \"active\")\n\t\t.is(\"companies.deleted_at\", null); // Exclude archived companies\n\n\tif (!memberships) {\n\t\treturn [];\n\t}\n\n\t// Sort companies: prioritize completed onboarding over incomplete\n\tconst sorted = memberships.sort((a: any, b: any) => {\n\t\tconst aCompleted = !!a.companies.onboarding_completed_at;\n\t\tconst bCompleted = !!b.companies.onboarding_completed_at;\n\n\t\t// Completed companies first\n\t\tif (aCompleted && !bCompleted) return -1;\n\t\tif (!aCompleted && bCompleted) return 1;\n\n\t\t// Then by name alphabetically\n\t\treturn a.companies.name.localeCompare(b.companies.name);\n\t});\n\n\treturn sorted.map((m: any) => ({\n\t\tid: m.companies.id,\n\t\tname: m.companies.name,\n\t\tlogo: m.companies.logo,\n\t}));\n});\n\n/**\n * Verify Company Access\n *\n * Checks if user has access to a company.\n *\n * @param companyId - Company ID to verify\n * @returns true if user has access, false otherwise\n */\nconst verifyCompanyAccess = cache(\n\tasync (companyId: string): Promise<boolean> => {\n\t\tconst user = await getCurrentUser();\n\t\tif (!user) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Parallel queries instead of sequential (saves 20-30ms)\n\t\tconst [companyResult, memberResult] = await Promise.all([\n\t\t\t// Check if company exists and is not archived\n\t\t\tsupabase\n\t\t\t\t.from(\"companies\")\n\t\t\t\t.select(\"id\")\n\t\t\t\t.eq(\"id\", companyId)\n\t\t\t\t.is(\"deleted_at\", null)\n\t\t\t\t.single(),\n\n\t\t\t// Check if user has active membership\n\t\t\tsupabase\n\t\t\t\t.from(\"company_memberships\")\n\t\t\t\t.select(\"id\")\n\t\t\t\t.eq(\"user_id\", user.id)\n\t\t\t\t.eq(\"company_id\", companyId)\n\t\t\t\t.eq(\"status\", \"active\")\n\t\t\t\t.single(),\n\t\t]);\n\n\t\t// Both must succeed\n\t\treturn !!(companyResult.data && memberResult.data);\n\t},\n);\n\n/**\n * Get Active Team Member ID\n *\n * Returns the team_members.id for the current user in the active company.\n * Used for personal inbox filtering and other team-member-specific features.\n *\n * PERFORMANCE: Wrapped with React.cache() - called by multiple components,\n * but only executes once per request.\n *\n * @returns Team member ID string or null if not found\n */\nexport const getActiveTeamMemberId = cache(async (): Promise<string | null> => {\n\tconst user = await getCurrentUser();\n\tif (!user) {\n\t\treturn null;\n\t}\n\n\tconst companyId = await getActiveCompanyId();\n\tif (!companyId) {\n\t\treturn null;\n\t}\n\n\tconst supabase = await createClient();\n\tif (!supabase) {\n\t\treturn null;\n\t}\n\n\tconst { data: teamMember } = await supabase\n\t\t.from(\"team_members\")\n\t\t.select(\"id\")\n\t\t.eq(\"user_id\", user.id)\n\t\t.eq(\"company_id\", companyId)\n\t\t.eq(\"status\", \"active\")\n\t\t.single();\n\n\treturn teamMember?.id || null;\n});\n\n/**\n * Require Active Company\n *\n * Throws error if no active company is set.\n * Useful for actions that require a company context.\n *\n * @returns Company ID string\n * @throws Error if no active company\n */\nexport async function requireActiveCompany(): Promise<string> {\n\tconst companyId = await getActiveCompanyId();\n\n\tif (!companyId) {\n\t\tthrow new Error(\"No active company selected. Please select a company.\");\n\t}\n\n\treturn companyId;\n}\n\n/**\n * Check if User Has Multiple Companies\n *\n * Useful for conditionally showing company switcher UI.\n *\n * @returns true if user has 2+ companies, false otherwise\n */\nasync function hasMultipleCompanies(): Promise<boolean> {\n\tconst companies = await getUserCompanies();\n\treturn companies.length > 1;\n}\n\n/**\n * Check if Active Company Has Completed Onboarding\n *\n * Checks if the active company has an active payment subscription.\n * This is used to determine if onboarding is complete.\n *\n * SECURITY: Uses service role because:\n * - Query filters to user's own membership (user_id = authenticated user)\n * - JOIN to companies table causes RLS recursion with anon key\n * - User only sees their own team_members record\n * - Companies table has its own RLS protection\n *\n * @returns true if company has active/trialing subscription, false otherwise\n */\nexport async function isActiveCompanyOnboardingComplete(): Promise<boolean> {\n\tconst user = await getCurrentUser();\n\tif (!user) {\n\t\treturn false;\n\t}\n\n\tconst activeCompanyId = await getActiveCompanyId();\n\tif (!activeCompanyId) {\n\t\treturn false;\n\t}\n\n\t// Use service role to bypass RLS recursion on JOIN\n\t// Query is safe: explicitly filtered to user's own record\n\tconst supabase = await createServiceSupabaseClient();\n\tif (!supabase) {\n\t\treturn false;\n\t}\n\n\t// Check the ACTIVE company's payment status\n\tconst { data: teamMember } = await supabase\n\t\t.from(\"company_memberships\")\n\t\t.select(\n\t\t\t\"company_id, companies!inner(stripe_subscription_status, onboarding_progress, onboarding_completed_at)\",\n\t\t)\n\t\t.eq(\"user_id\", user.id)\n\t\t.eq(\"company_id\", activeCompanyId)\n\t\t.eq(\"status\", \"active\")\n\t\t.maybeSingle();\n\n\tif (!teamMember) {\n\t\treturn false;\n\t}\n\n\tconst companies = Array.isArray(teamMember.companies)\n\t\t? teamMember.companies[0]\n\t\t: teamMember.companies;\n\tconst subscriptionStatus = companies?.stripe_subscription_status;\n\tconst subscriptionActive =\n\t\tsubscriptionStatus === \"active\" || subscriptionStatus === \"trialing\";\n\tconst onboardingProgress =\n\t\t(companies?.onboarding_progress as Record<string, unknown>) || null;\n\tconst onboardingFinished = isOnboardingComplete({\n\t\tprogress: onboardingProgress,\n\t\tcompletedAt: companies?.onboarding_completed_at ?? null,\n\t});\n\n\treturn (\n\t\t(subscriptionActive && onboardingFinished) ||\n\t\tprocess.env.NODE_ENV === \"development\"\n\t);\n}\n","/**\n * Utilities for determining onboarding completion across server components\n * and API routes. Keeps the logic centralized so we can evolve the rules\n * (e.g. adding new steps) without hunting down scattered checks.\n */\n\ntype ProgressRecord = Record<string, unknown> | null | undefined;\n\n// Must match STEPS_ORDER from onboarding-store.ts\nconst REQUIRED_STEPS = [\"welcome\", \"company\"] as const;\nconst FINAL_STEP = \"complete\" as const;\n\n/**\n * Determine whether onboarding is complete based on stored progress metadata.\n *\n * Completion criteria (in priority order):\n * 1. `completedAt` timestamp exists (set by completeOnboardingWizard action)\n * 2. `onboardingCompleted` flag is true in progress data\n * 3. \"complete\" step exists in completedSteps array\n *\n * Note: We intentionally check multiple signals for backward compatibility\n * with older onboarding records that may have different data structures.\n */\nexport function isOnboardingComplete(options: {\n\tprogress?: ProgressRecord;\n\tcompletedAt?: string | null;\n}): boolean {\n\tconst { progress, completedAt } = options;\n\n\t// Primary check: completedAt timestamp from database\n\tif (completedAt) {\n\t\treturn true;\n\t}\n\n\tif (!progress || typeof progress !== \"object\") {\n\t\treturn false;\n\t}\n\n\tconst progressRecord = progress as Record<string, unknown>;\n\n\t// Check onboardingCompleted flag\n\tif (progressRecord.onboardingCompleted === true) {\n\t\treturn true;\n\t}\n\n\t// Check if completedSteps array includes the final step\n\tconst completedSteps = progressRecord.completedSteps;\n\tif (Array.isArray(completedSteps) && completedSteps.includes(FINAL_STEP)) {\n\t\treturn true;\n\t}\n\n\treturn false;\n}\n\n/**\n * Get onboarding progress percentage based on completed steps.\n */\nexport function getOnboardingProgress(options: {\n\tprogress?: ProgressRecord;\n}): number {\n\tconst { progress } = options;\n\n\tif (!progress || typeof progress !== \"object\") {\n\t\treturn 0;\n\t}\n\n\tconst progressRecord = progress as Record<string, unknown>;\n\tconst completedSteps = progressRecord.completedSteps;\n\tconst skippedSteps = progressRecord.skippedSteps;\n\n\tif (!Array.isArray(completedSteps)) {\n\t\treturn 0;\n\t}\n\n\tconst totalSteps = 14; // Total steps in onboarding\n\tconst finishedCount = completedSteps.length + (Array.isArray(skippedSteps) ? skippedSteps.length : 0);\n\n\treturn Math.round((finishedCount / totalSteps) * 100);\n}\n\n/**\n * Check if required steps are completed.\n * Returns which required steps are missing if any.\n */\nexport function getMissingRequiredSteps(options: {\n\tprogress?: ProgressRecord;\n}): string[] {\n\tconst { progress } = options;\n\n\tif (!progress || typeof progress !== \"object\") {\n\t\treturn [...REQUIRED_STEPS];\n\t}\n\n\tconst progressRecord = progress as Record<string, unknown>;\n\tconst completedSteps = progressRecord.completedSteps;\n\n\tif (!Array.isArray(completedSteps)) {\n\t\treturn [...REQUIRED_STEPS];\n\t}\n\n\treturn REQUIRED_STEPS.filter((step) => !completedSteps.includes(step));\n}\n\n/**\n * Get the current onboarding step from progress data.\n */\nexport function getCurrentOnboardingStep(options: {\n\tprogress?: ProgressRecord;\n}): string {\n\tconst { progress } = options;\n\n\tif (!progress || typeof progress !== \"object\") {\n\t\treturn \"welcome\";\n\t}\n\n\tconst progressRecord = progress as Record<string, unknown>;\n\tconst currentStep = progressRecord.currentStep;\n\n\tif (typeof currentStep === \"string\" && currentStep.length > 0) {\n\t\treturn currentStep;\n\t}\n\n\treturn \"welcome\";\n}\n","/**\n * Session Management Utilities - Server Component Helpers\n *\n * Features:\n * - Get current authenticated user\n * - Get current session\n * - Require authentication (throw error if not authenticated)\n * - Check user permissions and roles\n * - Server Component compatible\n */\n\nimport type { Session, User } from \"@supabase/supabase-js\";\nimport { cache } from \"react\";\nimport { createClient } from \"@stratos/database/server\";\n\n/**\n * Get Current User - Cached for performance\n *\n * Returns the currently authenticated user or null if not authenticated.\n * Cached per request to avoid multiple database calls.\n *\n * SECURITY: Uses getUser() instead of getSession() to verify the session\n * is authentic by contacting the Supabase Auth server. Session data from\n * cookies cannot be trusted without server-side verification.\n */\nexport const getCurrentUser = cache(async (): Promise<User | null> => {\n\ttry {\n\t\tconst supabase = await createClient();\n\n\t\tif (!supabase) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Use getUser() to authenticate with Supabase Auth server\n\t\t// This verifies the session is valid and not tampered with\n\t\tconst {\n\t\t\tdata: { user },\n\t\t\terror,\n\t\t} = await supabase.auth.getUser();\n\n\t\t// Handle error - could be AuthSessionMissingError or network error\n\t\tif (error) {\n\t\t\t// AuthSessionMissingError is expected when user is not authenticated\n\t\t\t// Don't log this as an error, just return null\n\t\t\tif (error.name === \"AuthSessionMissingError\") {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\n\t\treturn user;\n\t} catch (error) {\n\t\t// Catch any unexpected errors (network issues, etc.)\n\t\t// The error might be thrown instead of returned in some cases\n\t\tif (\n\t\t\terror &&\n\t\t\ttypeof error === \"object\" &&\n\t\t\t\"name\" in error &&\n\t\t\terror.name === \"AuthSessionMissingError\"\n\t\t) {\n\t\t\treturn null;\n\t\t}\n\t\treturn null;\n\t}\n});\n\n/**\n * Get Session - Cached for performance\n *\n * Returns the current session or null if not authenticated.\n * Cached per request to avoid multiple database calls.\n */\nconst getSession = cache(async (): Promise<Session | null> => {\n\ttry {\n\t\tconst supabase = await createClient();\n\n\t\tif (!supabase) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { session },\n\t\t\terror,\n\t\t} = await supabase.auth.getSession();\n\n\t\tif (error) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn session;\n\t} catch (_error) {\n\t\treturn null;\n\t}\n});\n\n/**\n * Require User - Throw error if not authenticated\n *\n * Use this in Server Components or Server Actions that require authentication.\n * Will throw an error that can be caught by error boundaries.\n */\nexport async function requireUser(): Promise<User> {\n\tconst user = await getCurrentUser();\n\n\tif (!user) {\n\t\tthrow new Error(\"Authentication required. Please log in to continue.\");\n\t}\n\n\treturn user;\n}\n\n/**\n * Require Session - Throw error if no session\n *\n * Use this when you need both user and session data (e.g., access token).\n */\nasync function requireSession(): Promise<Session> {\n\tconst session = await getSession();\n\n\tif (!session) {\n\t\tthrow new Error(\"Active session required. Please log in to continue.\");\n\t}\n\n\treturn session;\n}\n\n/**\n * Check if user is authenticated\n *\n * Returns true if user is authenticated, false otherwise.\n * Useful for conditional rendering in Server Components.\n */\nasync function isAuthenticated(): Promise<boolean> {\n\tconst user = await getCurrentUser();\n\treturn user !== null;\n}\n\n/**\n * Get User Metadata\n *\n * Returns user metadata from Supabase Auth.\n * Useful for accessing additional user properties stored in auth.users.\n */\nasync function getUserMetadata<\n\tT = Record<string, any>,\n>(): Promise<T | null> {\n\tconst user = await getCurrentUser();\n\n\tif (!user) {\n\t\treturn null;\n\t}\n\n\treturn (user.user_metadata as T) || null;\n}\n\n/**\n * Check User Email Verified\n *\n * Returns true if user's email is verified, false otherwise.\n */\nasync function isEmailVerified(): Promise<boolean> {\n\tconst user = await getCurrentUser();\n\n\tif (!user) {\n\t\treturn false;\n\t}\n\n\treturn user.email_confirmed_at !== undefined;\n}\n\n/**\n * Get User ID\n *\n * Returns the user's ID or null if not authenticated.\n * Convenient helper for getting just the user ID.\n */\nasync function getUserId(): Promise<string | null> {\n\tconst user = await getCurrentUser();\n\treturn user?.id || null;\n}\n\n/**\n * Get User Email\n *\n * Returns the user's email or null if not authenticated.\n */\nasync function getUserEmail(): Promise<string | null> {\n\tconst user = await getCurrentUser();\n\treturn user?.email || null;\n}\n\n/**\n * Get Access Token\n *\n * Returns the current access token for API calls.\n * Useful for calling external APIs that require authentication.\n */\nasync function getAccessToken(): Promise<string | null> {\n\tconst session = await getSession();\n\treturn session?.access_token || null;\n}\n\n/**\n * Refresh Session\n *\n * Manually refresh the session to get a new access token.\n * Usually not needed as Supabase handles this automatically.\n */\nasync function refreshSession(): Promise<Session | null> {\n\ttry {\n\t\tconst supabase = await createClient();\n\n\t\tif (!supabase) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { session },\n\t\t\terror,\n\t\t} = await supabase.auth.refreshSession();\n\n\t\tif (error) {\n\t\t\treturn null;\n\t\t}\n\n\t\treturn session;\n\t} catch (_error) {\n\t\treturn null;\n\t}\n}\n"],"names":[],"mappings":"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","ignoreList":[2,3,4,5,6,7,8,9,10,12,13]}