module.exports=[98203,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(63022)},7912,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(64460)},84251,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},70699,a=>{"use strict";var b=a.i(7912),c=a.i(46052),d=a.i(49177),e=a.i(84251);let f=new d.Resend(process.env.RESEND_API_KEY),g=null;async function h(){if(g)return g;if(process.env.RESEND_WAITLIST_AUDIENCE_ID)return g=process.env.RESEND_WAITLIST_AUDIENCE_ID;try{let{data:a,error:b}=await f.audiences.list();if(b)return console.error("Failed to list audiences:",b),null;let c=a?.data?.find(a=>a.name.toLowerCase().includes("waitlist"));if(c)return g=c.id;let{data:d,error:e}=await f.audiences.create({name:"Thorbis Waitlist"});if(e)return console.error("Failed to create waitlist audience:",e),null;return g=d?.id||null,console.log("Created new waitlist audience:",g),g}catch(a){return console.error("Error getting waitlist audience:",a),null}}async function i(){try{let a=await h();if(!a)return console.warn("Could not get or create waitlist audience"),{success:!0,data:{totalSubscribers:0,activeSubscribers:0,unsubscribedCount:0,recentSignups:0,growthRate:0}};let b=await f.contacts.list({audienceId:a});if(b.error)return console.error("Failed to get waitlist stats:",b.error),{success:!1,error:"Failed to get waitlist stats"};let c=b.data?.data||[],d=new Date,e=new Date(d.getTime()-6048e5),g=c.length,i=c.filter(a=>!a.unsubscribed).length,j=c.filter(a=>a.unsubscribed).length,k=c.filter(a=>new Date(a.created_at)>=e).length,l=g>0?parseFloat((k/g*100).toFixed(1)):0;return{success:!0,data:{totalSubscribers:g,activeSubscribers:i,unsubscribedCount:j,recentSignups:k,growthRate:l}}}catch(a){return console.error("Failed to get waitlist stats:",a),{success:!1,error:"Failed to get waitlist stats"}}}async function j(a=1,b=50,c){try{let d=await h();if(!d)return console.warn("Could not get or create waitlist audience"),{success:!0,data:{subscribers:[],total:0,page:a,pageSize:b}};let e=await f.contacts.list({audienceId:d});if(e.error)return console.error("Failed to get waitlist subscribers:",e.error),{success:!1,error:"Failed to get waitlist subscribers"};let g=e.data?.data||[];if(c){let a=c.toLowerCase();g=g.filter(b=>b.email.toLowerCase().includes(a)||b.first_name&&b.first_name.toLowerCase().includes(a)||b.last_name&&b.last_name.toLowerCase().includes(a))}let i=g.length,j=(a-1)*b,k=g.slice(j,j+b).map(a=>({id:a.id,email:a.email,firstName:a.first_name||void 0,lastName:a.last_name||void 0,createdAt:a.created_at,unsubscribed:a.unsubscribed||!1,tags:[],source:"resend"}));return{success:!0,data:{subscribers:k,total:i,page:a,pageSize:b}}}catch(a){return console.error("Failed to get waitlist subscribers:",a),{success:!1,error:"Failed to get waitlist subscribers"}}}async function k(a,b,d,e,g){try{let e=await h();if(!e)return{success:!1,error:"Could not get or create waitlist audience"};let g=await f.contacts.create({email:a,firstName:b,lastName:d,unsubscribed:!1,audienceId:e});if(g.error)return console.error("Failed to add waitlist subscriber:",g.error),{success:!1,error:g.error.message||"Failed to add subscriber"};let i={id:g.data?.id||"",email:a,firstName:b,lastName:d,createdAt:new Date().toISOString(),unsubscribed:!1,tags:[],source:"admin"};return(0,c.revalidatePath)("/dashboard/marketing"),(0,c.revalidatePath)("/dashboard/marketing/campaigns"),{success:!0,data:i}}catch(a){return console.error("Failed to add waitlist subscriber:",a),{success:!1,error:"Failed to add waitlist subscriber"}}}async function l(a){try{let b=await h();if(!b)return{success:!1,error:"Could not get or create waitlist audience"};let d=await f.contacts.remove({id:a,audienceId:b});if(d.error)return console.error("Failed to remove waitlist subscriber:",d.error),{success:!1,error:"Failed to remove subscriber"};return(0,c.revalidatePath)("/dashboard/marketing"),(0,c.revalidatePath)("/dashboard/marketing/campaigns"),{success:!0}}catch(a){return console.error("Failed to remove waitlist subscriber:",a),{success:!1,error:"Failed to remove waitlist subscriber"}}}async function m(a,b){try{let d=await h();if(!d)return{success:!1,error:"Could not get or create waitlist audience"};let e=await f.contacts.update({id:a,audienceId:d,firstName:b.firstName,lastName:b.lastName,unsubscribed:b.unsubscribed});if(e.error)return console.error("Failed to update waitlist subscriber:",e.error),{success:!1,error:"Failed to update subscriber"};return(0,c.revalidatePath)("/dashboard/marketing"),(0,c.revalidatePath)("/dashboard/marketing/campaigns"),{success:!0}}catch(a){return console.error("Failed to update waitlist subscriber:",a),{success:!1,error:"Failed to update waitlist subscriber"}}}async function n(a){try{let b=await h();if(!b)return{success:!1,error:"Could not get or create waitlist audience"};let d=0,e=0,g=[];for(let c=0;c<a.length;c+=100){for(let h of a.slice(c,c+100))try{if(!h.email||!h.email.includes("@")){g.push(`Invalid email: ${h.email}`),e++;continue}let a=await f.contacts.create({email:h.email,firstName:h.firstName,lastName:h.lastName,unsubscribed:!1,audienceId:b});a.error?(e++,a.error.message?.includes("already exists")||g.push(`Failed to import: ${h.email}`)):d++}catch{e++,g.push(`Failed to import: ${h.email}`)}c+100<a.length&&await new Promise(a=>setTimeout(a,100))}return(0,c.revalidatePath)("/dashboard/marketing"),(0,c.revalidatePath)("/dashboard/marketing/campaigns"),{success:!0,data:{imported:d,skipped:e,errors:g.slice(0,10)}}}catch(a){return console.error("Failed to import waitlist subscribers:",a),{success:!1,error:"Failed to import waitlist subscribers"}}}async function o(){try{let a=await h();if(!a)return{success:!1,error:"Could not get or create waitlist audience"};let b=await f.contacts.list({audienceId:a});if(b.error)return console.error("Failed to export waitlist subscribers:",b.error),{success:!1,error:"Failed to export waitlist subscribers"};let c=(b.data?.data||[]).map(a=>[a.email,a.first_name||"",a.last_name||"",a.unsubscribed?"No":"Yes",a.created_at]),d=["Email,First Name,Last Name,Subscribed,Created At",...c.map(a=>a.map(a=>`"${a}"`).join(","))].join("\n"),e=`waitlist-export-${new Date().toISOString().split("T")[0]}.csv`;return{success:!0,data:{csvContent:d,filename:e}}}catch(a){return console.error("Failed to export waitlist subscribers:",a),{success:!1,error:"Failed to export waitlist subscribers"}}}async function p(){try{let a=await h();if(!a)return{success:!0,data:0};let b=await f.contacts.list({audienceId:a});if(b.error)return console.error("Failed to get waitlist campaign ready count:",b.error),{success:!1,error:"Failed to get count"};let c=(b.data?.data||[]).filter(a=>!a.unsubscribed).length;return{success:!0,data:c}}catch(a){return console.error("Failed to get waitlist campaign ready count:",a),{success:!1,error:"Failed to get count"}}}async function q(){try{let a=await h();if(!a)return{success:!0,data:[]};let b=await f.contacts.list({audienceId:a});if(b.error)return console.error("Failed to get waitlist emails:",b.error),{success:!1,error:"Failed to get waitlist emails"};let c=(b.data?.data||[]).filter(a=>!a.unsubscribed).map(a=>({email:a.email,firstName:a.first_name||void 0,lastName:a.last_name||void 0}));return{success:!0,data:c}}catch(a){return console.error("Failed to get waitlist emails:",a),{success:!1,error:"Failed to get waitlist emails"}}}(0,e.ensureServerEntryExports)([i,j,k,l,m,n,o,p,q]),(0,b.registerServerReference)(i,"00f518512cfa2fdb5fb613b4a8aa7154bdcb41f2bb",null),(0,b.registerServerReference)(j,"70d14f4493786e8ca258503b8ddac6a1dfbd2733df",null),(0,b.registerServerReference)(k,"7cce20548fc8b435a91f94f968097b85ab56be7eb1",null),(0,b.registerServerReference)(l,"40d8a80b8f01b7847483b47313f90730235434d559",null),(0,b.registerServerReference)(m,"60ac91a19fa9c4f92442d53704cb36b033d250b562",null),(0,b.registerServerReference)(n,"4003b4c09cec643f626321dade8506445d215ac874",null),(0,b.registerServerReference)(o,"0087a564c77649e05cd630ae364cacf188b9cecfeb",null),(0,b.registerServerReference)(p,"00be6eda3bb71efa7f0796ee773ad36ca42f83a5a3",null),(0,b.registerServerReference)(q,"00766f34e56ac3204b9f1d6cb3f1a089b53a0cc891",null),a.s(["addWaitlistSubscriber",()=>k,"exportWaitlistSubscribers",()=>o,"getWaitlistCampaignReadyCount",()=>p,"getWaitlistEmailsForCampaign",()=>q,"getWaitlistStats",()=>i,"getWaitlistSubscribers",()=>j,"importWaitlistSubscribers",()=>n,"removeWaitlistSubscriber",()=>l,"updateWaitlistSubscriber",()=>m])},97773,a=>{"use strict";var b=a.i(70699);a.s([],2285),a.i(2285),a.s(["00766f34e56ac3204b9f1d6cb3f1a089b53a0cc891",()=>b.getWaitlistEmailsForCampaign,"0087a564c77649e05cd630ae364cacf188b9cecfeb",()=>b.exportWaitlistSubscribers,"00be6eda3bb71efa7f0796ee773ad36ca42f83a5a3",()=>b.getWaitlistCampaignReadyCount,"00f518512cfa2fdb5fb613b4a8aa7154bdcb41f2bb",()=>b.getWaitlistStats,"4003b4c09cec643f626321dade8506445d215ac874",()=>b.importWaitlistSubscribers,"40d8a80b8f01b7847483b47313f90730235434d559",()=>b.removeWaitlistSubscriber,"60ac91a19fa9c4f92442d53704cb36b033d250b562",()=>b.updateWaitlistSubscriber,"70d14f4493786e8ca258503b8ddac6a1dfbd2733df",()=>b.getWaitlistSubscribers,"7cce20548fc8b435a91f94f968097b85ab56be7eb1",()=>b.addWaitlistSubscriber],97773)},42757,a=>{a.v(b=>Promise.all(["server/chunks/ssr/4f84d_next_dist_compiled_react-dom_server_node_b1329454.js","server/chunks/ssr/[root-of-the-server]__2a96e16c._.js"].map(b=>a.l(b))).then(()=>b(49664)))}];

//# sourceMappingURL=_b5883283._.js.map