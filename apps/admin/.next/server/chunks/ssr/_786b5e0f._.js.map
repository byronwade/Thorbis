{"version":3,"sources":["turbopack:///[project]/apps/admin/src/lib/supabase/web-client.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@opentelemetry+api@1.9.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/build/webpack/loaders/next-flight-loader/server-reference.ts","turbopack:///[project]/node_modules/.pnpm/next@16.0.1_@opentelemetry+api@1.9.0_react-dom@19.2.0_react@19.2.0__react@19.2.0/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-validate.ts","turbopack:///[project]/apps/admin/src/actions/support-sessions.ts","turbopack:///[project]/apps/admin/src/lib/admin/audit.ts","turbopack:///[project]/apps/admin/.next-internal/server/app/dashboard/view-as/[companyId]/work/invoices/page/actions.js (server actions loader)"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\n\n/**\n * Web Database Client - Full Admin Access\n *\n * This client connects to the main Thorbis web database with SERVICE ROLE permissions.\n * It bypasses all Row Level Security (RLS) policies and has full read/write access.\n *\n * ⚠️ SECURITY WARNING:\n * - ONLY use this on the server side (Server Components, Server Actions, API Routes)\n * - NEVER expose this client or its credentials to the browser\n * - NEVER use in Client Components\n * - Always log admin actions to admin_audit_logs table\n *\n * Use cases:\n * - View customer data for support tickets\n * - Edit/fix customer records (invoices, jobs, payments)\n * - Issue refunds\n * - Troubleshoot data issues\n * - Migrate/bulk update customer data\n * - Generate reports across all customers\n */\n\nif (!process.env.WEB_SUPABASE_URL) {\n\tthrow new Error(\"Missing WEB_SUPABASE_URL environment variable\");\n}\n\nif (!process.env.WEB_SUPABASE_SERVICE_ROLE_KEY) {\n\tthrow new Error(\"Missing WEB_SUPABASE_SERVICE_ROLE_KEY environment variable\");\n}\n\n/**\n * Create a Supabase client for the web database with service role access.\n *\n * @returns Supabase client with full access to web database (bypasses RLS)\n *\n * @example\n * // Server Action - View customer data\n * \"use server\";\n * import { createWebClient } from \"@/lib/supabase/web-client\";\n *\n * export async function getCustomerData(customerId: string) {\n *   const supabase = createWebClient();\n *   const { data, error } = await supabase\n *     .from(\"customers\")\n *     .select(\"*\")\n *     .eq(\"id\", customerId)\n *     .single();\n *\n *   return data;\n * }\n *\n * @example\n * // Server Action - Issue refund\n * \"use server\";\n * import { createWebClient } from \"@/lib/supabase/web-client\";\n * import { logAdminAction } from \"@/lib/admin/audit\";\n *\n * export async function issueRefund(paymentId: string, amount: number, adminUserId: string) {\n *   const supabase = createWebClient();\n *\n *   // Update payment status\n *   const { error } = await supabase\n *     .from(\"payments\")\n *     .update({\n *       status: \"refunded\",\n *       refund_amount: amount,\n *       refunded_at: new Date().toISOString()\n *     })\n *     .eq(\"id\", paymentId);\n *\n *   // Log the action\n *   await logAdminAction(adminUserId, \"refund_issued\", \"payment\", paymentId, {\n *     amount,\n *     timestamp: new Date().toISOString()\n *   });\n *\n *   return { success: !error };\n * }\n */\nexport const createWebClient = () => {\n\treturn createClient(process.env.WEB_SUPABASE_URL!, process.env.WEB_SUPABASE_SERVICE_ROLE_KEY!, {\n\t\tauth: {\n\t\t\tautoRefreshToken: false,\n\t\t\tpersistSession: false,\n\t\t},\n\t});\n};\n\n/**\n * Type-safe helper to get the web client.\n * Alias for createWebClient() with better semantics.\n */\nexport const getWebDatabaseClient = createWebClient;\n","/* eslint-disable import/no-extraneous-dependencies */\nexport { registerServerReference } from 'react-server-dom-webpack/server'\n","// This function ensures that all the exported values are valid server actions,\n// during the runtime. By definition all actions are required to be async\n// functions, but here we can only check that they are functions.\nexport function ensureServerEntryExports(actions: any[]) {\n  for (let i = 0; i < actions.length; i++) {\n    const action = actions[i]\n    if (typeof action !== 'function') {\n      throw new Error(\n        `A \"use server\" file can only export async functions, found ${typeof action}.\\nRead more: https://nextjs.org/docs/messages/invalid-use-server-value`\n      )\n    }\n  }\n}\n","\"use server\";\n\n/**\n * Support Sessions Management\n *\n * Server actions for managing support access sessions where admins can\n * view and edit customer accounts with customer approval.\n */\n\nimport { createAdminClient } from \"@/lib/supabase/admin-client\";\nimport { createWebClient } from \"@/lib/supabase/web-client\";\nimport { getAdminSession } from \"@/lib/auth/session\";\nimport { logAdminAction, ADMIN_ACTIONS } from \"@/lib/admin/audit\";\nimport { revalidatePath } from \"next/cache\";\n\nexport interface SupportSession {\n\tid: string;\n\tcompany_id: string;\n\tadmin_user_id: string;\n\tticket_id?: string;\n\tstatus: \"pending\" | \"active\" | \"expired\" | \"ended\" | \"rejected\";\n\trequested_at: string;\n\tapproved_at?: string;\n\texpires_at?: string;\n\treason?: string;\n\trequested_permissions: string[];\n}\n\n/**\n * Request a support session to access a customer's account\n */\nexport async function requestSupportSession(companyId: string, ticketId: string | null, reason: string, requestedPermissions: string[] = [\"view\"]) {\n\tconst session = await getAdminSession();\n\tif (!session) {\n\t\treturn { error: \"Unauthorized\" };\n\t}\n\n\tconst adminDb = createAdminClient();\n\n\t// Check if there's already an active session\n\tconst { data: existingSession } = await adminDb.rpc(\"get_active_session_for_company\", {\n\t\tp_company_id: companyId,\n\t});\n\n\tif (existingSession) {\n\t\treturn { error: \"Active session already exists for this company\" };\n\t}\n\n\t// Create new pending session\n\tconst { data: newSession, error: createError } = await adminDb\n\t\t.from(\"support_sessions\")\n\t\t.insert({\n\t\t\tcompany_id: companyId,\n\t\t\tadmin_user_id: session.userId,\n\t\t\tticket_id: ticketId,\n\t\t\tstatus: \"pending\",\n\t\t\treason,\n\t\t\trequested_permissions: requestedPermissions,\n\t\t})\n\t\t.select()\n\t\t.single();\n\n\tif (createError || !newSession) {\n\t\treturn { error: \"Failed to create support session\" };\n\t}\n\n\t// Create permissions entries\n\tif (requestedPermissions.length > 0) {\n\t\tconst permissionsToInsert = requestedPermissions.map((permission) => ({\n\t\t\tsession_id: newSession.id,\n\t\t\taction_type: permission,\n\t\t\tgranted: false, // Will be granted when customer approves\n\t\t}));\n\n\t\tawait adminDb.from(\"support_session_permissions\").insert(permissionsToInsert);\n\t}\n\n\t// Log the request\n\tawait logAdminAction({\n\t\tadminUserId: session.userId,\n\t\tadminEmail: session.email || \"\",\n\t\taction: \"support_session_requested\",\n\t\tresourceType: \"company\",\n\t\tresourceId: companyId,\n\t\tdetails: {\n\t\t\tsession_id: newSession.id,\n\t\t\tticket_id: ticketId,\n\t\t\treason,\n\t\t\tpermissions: requestedPermissions,\n\t\t},\n\t});\n\n\t// TODO: Send notification to customer (will implement in Phase 5)\n\t// await sendSessionRequestNotification(companyId, newSession.id);\n\n\treturn { data: newSession };\n}\n\n/**\n * Approve a support session (called by customer in web app)\n */\nexport async function approveSupportSession(sessionId: string, durationMinutes: number = 60) {\n\t// TODO: Verify customer authorization (will implement with web app integration)\n\t// const webSession = await getWebSession();\n\t// if (!webSession) return { error: \"Unauthorized\" };\n\n\tconst adminDb = createAdminClient();\n\n\t// Get session details\n\tconst { data: session, error: fetchError } = await adminDb.from(\"support_sessions\").select(\"*\").eq(\"id\", sessionId).single();\n\n\tif (fetchError || !session) {\n\t\treturn { error: \"Session not found\" };\n\t}\n\n\tif (session.status !== \"pending\") {\n\t\treturn { error: \"Session is not pending approval\" };\n\t}\n\n\t// Calculate expiration time\n\tconst expiresAt = new Date(Date.now() + durationMinutes * 60 * 1000);\n\n\t// Update session to active\n\tconst { error: updateError } = await adminDb\n\t\t.from(\"support_sessions\")\n\t\t.update({\n\t\t\tstatus: \"active\",\n\t\t\tapproved_at: new Date().toISOString(),\n\t\t\t// approved_by_user_id: webSession.user.id, // TODO: Add when web integration ready\n\t\t\texpires_at: expiresAt.toISOString(),\n\t\t})\n\t\t.eq(\"id\", sessionId);\n\n\tif (updateError) {\n\t\treturn { error: \"Failed to approve session\" };\n\t}\n\n\t// Grant all requested permissions\n\tawait adminDb\n\t\t.from(\"support_session_permissions\")\n\t\t.update({ granted: true, granted_at: new Date().toISOString() })\n\t\t.eq(\"session_id\", sessionId);\n\n\t// TODO: Send confirmation to admin\n\t// await sendSessionApprovedNotification(session.admin_user_id, sessionId);\n\n\trevalidatePath(\"/admin/dashboard/work/companies\");\n\n\treturn { success: true, expiresAt: expiresAt.toISOString() };\n}\n\n/**\n * Reject a support session (called by customer in web app)\n */\nexport async function rejectSupportSession(sessionId: string, reason?: string) {\n\t// TODO: Verify customer authorization\n\tconst adminDb = createAdminClient();\n\n\tconst { error } = await adminDb\n\t\t.from(\"support_sessions\")\n\t\t.update({\n\t\t\tstatus: \"rejected\",\n\t\t\trejected_at: new Date().toISOString(),\n\t\t\trejected_reason: reason,\n\t\t})\n\t\t.eq(\"id\", sessionId);\n\n\tif (error) {\n\t\treturn { error: \"Failed to reject session\" };\n\t}\n\n\treturn { success: true };\n}\n\n/**\n * End a support session (can be called by admin or customer)\n */\nexport async function endSupportSession(sessionId: string, endedBy: \"admin\" | \"customer\" = \"admin\") {\n\tconst session = await getAdminSession();\n\tif (!session && endedBy === \"admin\") {\n\t\treturn { error: \"Unauthorized\" };\n\t}\n\n\tconst adminDb = createAdminClient();\n\n\t// Get session details for logging\n\tconst { data: supportSession } = await adminDb.from(\"support_sessions\").select(\"*\").eq(\"id\", sessionId).single();\n\n\t// Update session to ended\n\tconst { error } = await adminDb\n\t\t.from(\"support_sessions\")\n\t\t.update({\n\t\t\tstatus: \"ended\",\n\t\t\tended_at: new Date().toISOString(),\n\t\t\tended_by: endedBy,\n\t\t})\n\t\t.eq(\"id\", sessionId);\n\n\tif (error) {\n\t\treturn { error: \"Failed to end session\" };\n\t}\n\n\t// Log the action\n\tif (session && supportSession) {\n\t\tawait logAdminAction({\n\t\t\tadminUserId: session.userId,\n\t\t\tadminEmail: session.email || \"\",\n\t\t\taction: \"support_session_ended\",\n\t\t\tresourceType: \"company\",\n\t\t\tresourceId: supportSession.company_id,\n\t\t\tdetails: {\n\t\t\t\tsession_id: sessionId,\n\t\t\t\tended_by: endedBy,\n\t\t\t},\n\t\t});\n\t}\n\n\trevalidatePath(\"/admin/dashboard/work/companies\");\n\n\treturn { success: true };\n}\n\n/**\n * Get support session status\n */\nexport async function getSupportSessionStatus(sessionId: string) {\n\tconst adminDb = createAdminClient();\n\n\tconst { data: session, error } = await adminDb.from(\"support_sessions\").select(\"*, admin_users(email, full_name)\").eq(\"id\", sessionId).single();\n\n\tif (error || !session) {\n\t\treturn { error: \"Session not found\" };\n\t}\n\n\t// Check if session is still active (not expired)\n\tconst isActive = session.status === \"active\" && session.expires_at && new Date(session.expires_at) > new Date();\n\n\treturn {\n\t\tdata: {\n\t\t\t...session,\n\t\t\tisActive,\n\t\t\ttimeRemaining: session.expires_at ? Math.max(0, new Date(session.expires_at).getTime() - Date.now()) : 0,\n\t\t},\n\t};\n}\n\n/**\n * Get active session for a company (if any)\n */\nexport async function getActiveSessionForCompany(companyId: string) {\n\tconst adminDb = createAdminClient();\n\n\tconst { data: sessionId } = await adminDb.rpc(\"get_active_session_for_company\", {\n\t\tp_company_id: companyId,\n\t});\n\n\tif (!sessionId) {\n\t\treturn { data: null };\n\t}\n\n\treturn getSupportSessionStatus(sessionId);\n}\n\n/**\n * Extend a support session (requires customer approval)\n */\nexport async function requestSessionExtension(sessionId: string, additionalMinutes: number = 30) {\n\tconst session = await getAdminSession();\n\tif (!session) {\n\t\treturn { error: \"Unauthorized\" };\n\t}\n\n\tconst adminDb = createAdminClient();\n\n\t// Get current session\n\tconst { data: supportSession } = await adminDb.from(\"support_sessions\").select(\"*\").eq(\"id\", sessionId).single();\n\n\tif (!supportSession || supportSession.status !== \"active\") {\n\t\treturn { error: \"Session is not active\" };\n\t}\n\n\t// TODO: Send extension request notification to customer\n\t// Customer will need to approve via approveSupportSession with new duration\n\n\t// For now, log the extension request\n\tawait logAdminAction({\n\t\tadminUserId: session.userId,\n\t\tadminEmail: session.email || \"\",\n\t\taction: \"support_session_extension_requested\",\n\t\tresourceType: \"company\",\n\t\tresourceId: supportSession.company_id,\n\t\tdetails: {\n\t\t\tsession_id: sessionId,\n\t\t\tadditional_minutes: additionalMinutes,\n\t\t},\n\t});\n\n\treturn { success: true, message: \"Extension request sent to customer\" };\n}\n\n/**\n * Log a support action during an active session\n */\nexport async function logSupportAction(sessionId: string, action: string, resourceType: string, resourceId: string, beforeData?: any, afterData?: any, reason?: string) {\n\tconst session = await getAdminSession();\n\tif (!session) {\n\t\treturn { error: \"Unauthorized\" };\n\t}\n\n\tconst adminDb = createAdminClient();\n\n\t// Verify session is active\n\tconst { data: isActive } = await adminDb.rpc(\"is_session_active\", {\n\t\tp_session_id: sessionId,\n\t});\n\n\tif (!isActive) {\n\t\treturn { error: \"Session is not active\" };\n\t}\n\n\t// Log the action\n\tconst { error } = await adminDb.from(\"support_session_actions\").insert({\n\t\tsession_id: sessionId,\n\t\tadmin_user_id: session.userId,\n\t\taction,\n\t\tresource_type: resourceType,\n\t\tresource_id: resourceId,\n\t\tbefore_data: beforeData,\n\t\tafter_data: afterData,\n\t\treason,\n\t});\n\n\tif (error) {\n\t\treturn { error: \"Failed to log action\" };\n\t}\n\n\treturn { success: true };\n}\n\n/**\n * Get all sessions for a company (for audit trail)\n */\nexport async function getCompanySupportSessions(companyId: string, limit: number = 50) {\n\tconst adminDb = createAdminClient();\n\n\tconst { data: sessions, error } = await adminDb\n\t\t.from(\"support_sessions\")\n\t\t.select(\n\t\t\t`\n      *,\n      admin_users(email, full_name),\n      support_tickets(subject)\n    `\n\t\t)\n\t\t.eq(\"company_id\", companyId)\n\t\t.order(\"created_at\", { ascending: false })\n\t\t.limit(limit);\n\n\tif (error) {\n\t\treturn { error: \"Failed to fetch sessions\" };\n\t}\n\n\treturn { data: sessions };\n}\n\n/**\n * Get all actions for a session (detailed audit trail)\n */\nexport async function getSessionActions(sessionId: string) {\n\tconst adminDb = createAdminClient();\n\n\tconst { data: actions, error } = await adminDb\n\t\t.from(\"support_session_actions\")\n\t\t.select(\n\t\t\t`\n      *,\n      admin_users(email, full_name)\n    `\n\t\t)\n\t\t.eq(\"session_id\", sessionId)\n\t\t.order(\"created_at\", { ascending: false });\n\n\tif (error) {\n\t\treturn { error: \"Failed to fetch session actions\" };\n\t}\n\n\treturn { data: actions };\n}\n\n/**\n * Check if admin has permission for an action in current session\n */\nexport async function hasSessionPermission(sessionId: string, actionType: string): Promise<boolean> {\n\tconst adminDb = createAdminClient();\n\n\tconst { data: permission } = await adminDb.from(\"support_session_permissions\").select(\"granted\").eq(\"session_id\", sessionId).eq(\"action_type\", actionType).single();\n\n\treturn permission?.granted === true;\n}\n","/**\n * Admin Audit Logging\n *\n * All admin actions that modify customer data in the web database\n * MUST be logged to the admin_audit_logs table for compliance and security.\n */\n\nimport { createAdminClient } from \"@/lib/supabase/admin-client\";\n\nexport interface AuditLogEntry {\n\tadminUserId: string;\n\tadminEmail: string;\n\taction: string;\n\tresourceType?: string;\n\tresourceId?: string;\n\tdetails?: Record<string, unknown>;\n\tipAddress?: string;\n\tuserAgent?: string;\n}\n\n/**\n * Log an admin action to the audit trail.\n *\n * @example\n * await logAdminAction({\n *   adminUserId: session.user.id,\n *   adminEmail: session.user.email,\n *   action: \"refund_issued\",\n *   resourceType: \"payment\",\n *   resourceId: paymentId,\n *   details: { amount: 100, reason: \"Customer request\" }\n * });\n */\nexport async function logAdminAction(entry: AuditLogEntry) {\n\tconst supabase = createAdminClient();\n\n\tconst { error } = await supabase.from(\"admin_audit_logs\").insert({\n\t\tadmin_user_id: entry.adminUserId,\n\t\tadmin_email: entry.adminEmail,\n\t\taction: entry.action,\n\t\tresource_type: entry.resourceType,\n\t\tresource_id: entry.resourceId,\n\t\tdetails: entry.details,\n\t\tip_address: entry.ipAddress,\n\t\tuser_agent: entry.userAgent,\n\t});\n\n\tif (error) {\n\t\tconsole.error(\"Failed to log admin action:\", error);\n\t\t// Don't throw - audit logging failures shouldn't break the main operation\n\t}\n}\n\n/**\n * Common admin actions for consistent logging\n */\nexport const ADMIN_ACTIONS = {\n\t// Customer Management\n\tCUSTOMER_VIEWED: \"customer_viewed\",\n\tCUSTOMER_EDITED: \"customer_edited\",\n\tCUSTOMER_DELETED: \"customer_deleted\",\n\tCUSTOMER_RESTORED: \"customer_restored\",\n\n\t// Payment Management\n\tPAYMENT_VIEWED: \"payment_viewed\",\n\tPAYMENT_REFUNDED: \"payment_refunded\",\n\tPAYMENT_EDITED: \"payment_edited\",\n\n\t// Invoice Management\n\tINVOICE_VIEWED: \"invoice_viewed\",\n\tINVOICE_EDITED: \"invoice_edited\",\n\tINVOICE_VOIDED: \"invoice_voided\",\n\tINVOICE_RESENT: \"invoice_resent\",\n\n\t// Job Management\n\tJOB_VIEWED: \"job_viewed\",\n\tJOB_EDITED: \"job_edited\",\n\tJOB_STATUS_CHANGED: \"job_status_changed\",\n\n\t// Subscription Management\n\tSUBSCRIPTION_EDITED: \"subscription_edited\",\n\tSUBSCRIPTION_CANCELED: \"subscription_canceled\",\n\tSUBSCRIPTION_PAUSED: \"subscription_paused\",\n\tSUBSCRIPTION_RESUMED: \"subscription_resumed\",\n\n\t// Support Actions\n\tSUPPORT_TICKET_CREATED: \"support_ticket_created\",\n\tSUPPORT_TICKET_UPDATED: \"support_ticket_updated\",\n\tSUPPORT_MESSAGE_SENT: \"support_message_sent\",\n\n\t// Email Campaigns\n\tCAMPAIGN_CREATED: \"campaign_created\",\n\tCAMPAIGN_SENT: \"campaign_sent\",\n\tCAMPAIGN_PAUSED: \"campaign_paused\",\n\n\t// Company Management\n\tCOMPANY_VIEWED: \"company_viewed\",\n\tCOMPANY_EDITED: \"company_edited\",\n\tCOMPANY_SUSPENDED: \"company_suspended\",\n\tCOMPANY_REACTIVATED: \"company_reactivated\",\n\n\t// Bulk Operations\n\tBULK_EDIT: \"bulk_edit\",\n\tBULK_DELETE: \"bulk_delete\",\n\tDATA_EXPORT: \"data_export\",\n\tDATA_IMPORT: \"data_import\",\n} as const;\n\nexport type AdminAction = (typeof ADMIN_ACTIONS)[keyof typeof ADMIN_ACTIONS];\n","export {endSupportSession as '606de25abb4916d6566917712865287e7e8ed54596'} from 'ACTIONS_MODULE0'\nexport {updateJobStatus as '70308fc60dfcb49fd561d9a392f26c24551b9c6866'} from 'ACTIONS_MODULE1'\nexport {reassignJob as '7052f8dec38dce6649b4ee6bd9f05700897e3994bf'} from 'ACTIONS_MODULE1'\nexport {updateJobSchedule as '780d7d56e146e1315e18c192297602d414cd6fe88d'} from 'ACTIONS_MODULE1'\nexport {updateJobPriority as '7007a7aba2c01fa9dbbb982e8ea92d4910f911eebc'} from 'ACTIONS_MODULE1'\nexport {addJobNote as '706fa5806b4bf1e5b56f4db7f15dfc5751ae255236'} from 'ACTIONS_MODULE1'\nexport {issuePaymentRefund as '70fbd1f9ac343a4c166050bc6c4b40bb6b336ca0d2'} from 'ACTIONS_MODULE2'\nexport {retryFailedPayment as '60a706a70455858be9c82a77305063b6d1eed07dff'} from 'ACTIONS_MODULE2'\nexport {markPaymentCompleted as '604ba7c8ceb3f38f69351b42e003ce361bd4aff32e'} from 'ACTIONS_MODULE2'\nexport {updatePaymentMethod as '70a2125785f2696d0ea0b6b232963ae1e13de52dbf'} from 'ACTIONS_MODULE2'\nexport {resetTeamMemberPassword as '60fa9aadc6ce789db856586be848e2c2a32ffbf675'} from 'ACTIONS_MODULE3'\nexport {changeTeamMemberRole as '70b2f0a88c0954b754c6d35a9e723f23ec7b60c40b'} from 'ACTIONS_MODULE3'\nexport {updateTeamMemberStatus as '70e7f47dcf6462d7b37910597f0b083f9a26a3c169'} from 'ACTIONS_MODULE3'\nexport {updateTeamMemberEmail as '708c208337de72c42f382ad5b4adddd96868c8e47e'} from 'ACTIONS_MODULE3'\nexport {updateInvoiceStatus as '70d877135ed5dd3d33af38b109675ddc54f5071df6'} from 'ACTIONS_MODULE4'\nexport {voidInvoice as '60f8fb1a8dfbca2e62ac9552dc62c206e58f647a15'} from 'ACTIONS_MODULE4'\nexport {updateInvoiceDueDate as '7090f90e20c6adea37ad38112d34e4c3ff9b62443e'} from 'ACTIONS_MODULE4'\nexport {sendInvoiceReminder as '601a68a9482eb2d735b42c7c47deb7923d5a3a607e'} from 'ACTIONS_MODULE4'\n"],"names":["registerServerReference","ensureServerEntryExports","actions","i","length","action","Error"],"mappings":"uCAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAuBA,GAAI,CAAC,QAAQ,GAAG,CAAC,gBAAgB,CAChC,CADkC,KAC5B,AAAI,MAAM,iDAGjB,GAAI,CAAC,QAAQ,GAAG,CAAC,6BAA6B,CAC7C,CAD+C,KACzC,AAAI,MAAM,uFAoDc,IACvB,CAAA,EAAA,EAAA,YAAA,AAAY,EAAC,QAAQ,GAAG,CAAC,gBAAgB,CAAG,QAAQ,GAAG,CAAC,6BAA6B,CAAG,CAC9F,KAAM,CACL,kBAAkB,EAClB,gBAAgB,CACjB,CACD,kCCtFmD,OAAA,cAAA,CAAA,EAAA,aAAA,oCAC3CA,0BAAAA,qCAAAA,EAAAA,uBAAuB,YAAQ,CAAA,CAAA,IAAA,iCCEjC,SAASC,EAAyBC,CAAc,EACrD,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAQE,MAAM,CAAED,IAAK,CACvC,IAAME,EAASH,CAAO,CAACC,EAAE,CACzB,GAAsB,YAAlB,AAA8B,OAAvBE,EACT,MAAM,OAAA,cAEL,CAFK,AAAIC,MACR,CAAC,2DAA2D,EAAE,OAAOD,EAAO;AAAA,oEAAuE,CAAC,EADhJ,oBAAA,OAAA,mBAAA,gBAAA,CAEN,EAEJ,CACF,0EATgBJ,2BAAAA,qCAAAA,6CCMhB,EAAA,EAAA,CAAA,CAAA,OAEA,EAAA,EAAA,CAAA,CAAA,OCsBO,eAAe,EAAe,CAAoB,EACxD,IAAM,EAAW,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE5B,OAAE,CAAK,CAAE,CAAG,MAAM,EAAS,IAAI,CAAC,oBAAoB,MAAM,CAAC,CAChE,cAAe,EAAM,WAAW,CAChC,YAAa,EAAM,UAAU,CAC7B,OAAQ,EAAM,MAAM,CACpB,cAAe,EAAM,YAAY,CACjC,YAAa,EAAM,UAAU,CAC7B,QAAS,EAAM,OAAO,CACtB,WAAY,EAAM,SAAS,CAC3B,WAAY,EAAM,SAAS,AAC5B,GAEI,GACH,IADU,IACF,KAAK,CAAC,8BAA+B,EAG/C,CDtCA,IAAA,EAAA,EAAA,CAAA,CAAA,OAkBO,eAAe,EAAsB,CAAiB,CAAE,CAAuB,CAAE,CAAc,CAAE,EAAiC,CAAC,OAAO,EAChJ,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,eAAA,AAAe,IACrC,GAAI,CAAC,EACJ,MAAO,CADM,AACJ,MAAO,cAAe,EAGhC,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG3B,CAAE,KAAM,CAAe,CAAE,CAAG,MAAM,EAAQ,GAAG,CAAC,iCAAkC,CACrF,aAAc,CACf,GAEA,GAAI,EACH,MAAO,CAAE,MAAO,EADI,8CAC6C,EAIlE,GAAM,CAAE,KAAM,CAAU,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,EACrD,IAAI,CAAC,oBACL,MAAM,CAAC,CACP,WAAY,EACZ,cAAe,EAAQ,MAAM,CAC7B,UAAW,EACX,OAAQ,iBACR,EACA,sBAAuB,CACxB,GACC,MAAM,GACN,MAAM,GAER,GAAI,GAAe,CAAC,EACnB,MAAO,CAAE,GADsB,GACf,kCAAmC,EAIpD,GAAI,EAAqB,MAAM,CAAG,EAAG,CACpC,IAAM,EAAsB,EAAqB,GAAG,CAAC,AAAC,IAAgB,CACrE,QADoE,GACxD,EAAW,EAAE,CACzB,YAAa,EACb,SAAS,EACV,CAAC,CAED,OAAM,EAAQ,IAAI,CAAC,+BAA+B,MAAM,CAAC,EAC1D,CAoBA,OAjBA,MAAM,EAAe,CACpB,YAAa,EAAQ,MAAM,CAC3B,WAAY,EAAQ,KAAK,EAAI,GAC7B,OAAQ,4BACR,aAAc,UACd,WAAY,EACZ,QAAS,CACR,WAAY,EAAW,EAAE,CACzB,UAAW,SACX,EACA,YAAa,CACd,CACD,GAKO,CAAE,KAAM,CAAW,CAC3B,CAKO,eAAe,EAAsB,CAAiB,CAAE,EAA0B,EAAE,EAK1F,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG3B,CAAE,KAAM,CAAO,CAAE,MAAO,CAAU,CAAE,CAAG,MAAM,EAAQ,IAAI,CAAC,oBAAoB,MAAM,CAAC,KAAK,EAAE,CAAC,KAAM,GAAW,MAAM,GAE1H,GAAI,GAAc,CAAC,EAClB,MAAO,CADoB,AAClB,MAAO,mBAAoB,EAGrC,GAAuB,WAAW,CAA9B,EAAQ,MAAM,CACjB,MAAO,CAAE,MAAO,iCAAkC,EAInD,IAAM,EAAY,IAAI,KAAK,KAAK,GAAG,GAAuB,GAAlB,EAAuB,KAGzD,CAAE,MAAO,CAAW,CAAE,CAAG,MAAM,EACnC,IAAI,CAAC,oBACL,MAAM,CAAC,CACP,OAAQ,SACR,YAAa,IAAI,OAAO,WAAW,GAEnC,WAAY,EAAU,WAAW,EAClC,GACC,EAAE,CAAC,KAAM,UAEX,AAAI,EACI,CAAE,MAAO,IADA,uBAC4B,GAI7C,MAAM,EACJ,IAAI,CAAC,+BACL,MAAM,CAAC,CAAE,SAAS,EAAM,WAAY,IAAI,OAAO,WAAW,EAAG,GAC7D,EAAE,CAAC,aAAc,GAKnB,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,mCAER,CAAE,SAAS,EAAM,UAAW,EAAU,WAAW,EAAG,EAC5D,CAKO,eAAe,EAAqB,CAAiB,CAAE,CAAe,EAE5E,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE3B,OAAE,CAAK,CAAE,CAAG,MAAM,EACtB,IAAI,CAAC,oBACL,MAAM,CAAC,CACP,OAAQ,WACR,YAAa,IAAI,OAAO,WAAW,GACnC,gBAAiB,CAClB,GACC,EAAE,CAAC,KAAM,UAEX,AAAI,EACI,CAAE,IADC,EACM,0BAA2B,EAGrC,CAAE,SAAS,CAAK,CACxB,CAKO,eAAe,EAAkB,CAAiB,CAAE,EAAgC,OAAO,EACjG,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,eAAA,AAAe,IACrC,GAAI,CAAC,GAAW,AAAY,SAAS,GACpC,MAAO,CAAE,MAAO,cAAe,EAGhC,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG3B,CAAE,KAAM,CAAc,CAAE,CAAG,MAAM,EAAQ,IAAI,CAAC,oBAAoB,MAAM,CAAC,KAAK,EAAE,CAAC,KAAM,GAAW,MAAM,GAGxG,OAAE,CAAK,CAAE,CAAG,MAAM,EACtB,IAAI,CAAC,oBACL,MAAM,CAAC,CACP,OAAQ,QACR,SAAU,IAAI,OAAO,WAAW,GAChC,SAAU,CACX,GACC,EAAE,CAAC,KAAM,UAEX,AAAI,EACI,CAAE,IADC,EACM,uBAAwB,GAIrC,GAAW,GACd,MAAM,EAAe,CACpB,IAF6B,QAEhB,EAAQ,MAAM,CAC3B,WAAY,EAAQ,KAAK,EAAI,GAC7B,OAAQ,wBACR,aAAc,UACd,WAAY,EAAe,UAAU,CACrC,QAAS,CACR,WAAY,EACZ,SAAU,CACX,CACD,GAGD,CAAA,EAAA,EAAA,cAAA,AAAc,EAAC,mCAER,CAAE,SAAS,CAAK,EACxB,CAKO,eAAe,EAAwB,CAAiB,EAC9D,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE3B,CAAE,KAAM,CAAO,OAAE,CAAK,CAAE,CAAG,MAAM,EAAQ,IAAI,CAAC,oBAAoB,MAAM,CAAC,oCAAoC,EAAE,CAAC,KAAM,GAAW,MAAM,GAE7I,GAAI,GAAS,CAAC,EACb,MAAO,CADe,AACb,MAAO,mBAAoB,EAIrC,IAAM,EAAW,AAAmB,aAAX,MAAM,EAAiB,EAAQ,UAAU,EAAI,IAAI,KAAK,EAAQ,UAAU,EAAI,IAAI,KAEzG,MAAO,CACN,KAAM,CACL,GAAG,CAAO,UACV,EACA,cAAe,EAAQ,UAAU,CAAG,KAAK,GAAG,CAAC,EAAG,IAAI,KAAK,EAAQ,UAAU,EAAE,OAAO,GAAK,KAAK,GAAG,IAAM,CACxG,CACD,CACD,CAKO,eAAe,EAA2B,CAAiB,EACjE,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE3B,CAAE,KAAM,CAAS,CAAE,CAAG,MAAM,EAAQ,GAAG,CAAC,iCAAkC,CAC/E,aAAc,CACf,UAEK,AAAL,EAIO,EAJH,AAI2B,GAHvB,CAAE,GADM,EACA,IAAK,CAItB,CAKO,eAAe,EAAwB,CAAiB,CAAE,EAA4B,EAAE,EAC9F,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,eAAA,AAAe,IACrC,GAAI,CAAC,EACJ,MAAO,CADM,AACJ,MAAO,cAAe,EAGhC,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG3B,CAAE,KAAM,CAAc,CAAE,CAAG,MAAM,EAAQ,IAAI,CAAC,oBAAoB,MAAM,CAAC,KAAK,EAAE,CAAC,KAAM,GAAW,MAAM,UAEzG,AAAD,AAAJ,GAAiD,UAAU,CAApC,EAAe,MAAM,EAQ5C,MAAM,EAAe,CACpB,YAAa,EAAQ,MAAM,CAC3B,WAAY,EAAQ,KAAK,EAAI,GAC7B,OAAQ,sCACR,aAAc,UACd,WAAY,EAAe,UAAU,CACrC,QAAS,CACR,WAAY,EACZ,mBAAoB,CACrB,CACD,GAEO,CAAE,SAAS,EAAM,QAAS,oCAAqC,GAnB9D,CAAE,MAAO,uBAAwB,CAoB1C,CAKO,eAAe,EAAiB,CAAiB,CAAE,CAAc,CAAE,CAAoB,CAAE,CAAkB,CAAE,CAAgB,CAAE,CAAe,CAAE,CAAe,EACrK,IAAM,EAAU,MAAM,CAAA,EAAA,EAAA,eAAA,AAAe,IACrC,GAAI,CAAC,EACJ,MAAO,CADM,AACJ,MAAO,cAAe,EAGhC,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAG3B,CAAE,KAAM,CAAQ,CAAE,CAAG,MAAM,EAAQ,GAAG,CAAC,oBAAqB,CACjE,aAAc,CACf,GAEA,GAAI,CAAC,EACJ,MAAO,CAAE,CADK,KACE,uBAAwB,EAIzC,GAAM,OAAE,CAAK,CAAE,CAAG,MAAM,EAAQ,IAAI,CAAC,2BAA2B,MAAM,CAAC,CACtE,WAAY,EACZ,cAAe,EAAQ,MAAM,QAC7B,EACA,cAAe,EACf,YAAa,EACb,YAAa,EACb,WAAY,SACZ,CACD,UAEI,AAAJ,EACQ,CAAE,IADC,EACM,sBAAuB,EAGjC,CAAE,SAAS,CAAK,CACxB,CAKO,eAAe,EAA0B,CAAiB,CAAE,EAAgB,EAAE,EACpF,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE3B,CAAE,KAAM,CAAQ,OAAE,CAAK,CAAE,CAAG,MAAM,EACtC,IAAI,CAAC,oBACL,MAAM,CACN,CAAC;;;;IAIA,CAAC,EAEF,EAAE,CAAC,aAAc,GACjB,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,GACvC,KAAK,CAAC,UAER,AAAI,EACI,CAAE,IADC,EACM,0BAA2B,EAGrC,CAAE,KAAM,CAAS,CACzB,CAKO,eAAe,EAAkB,CAAiB,EACxD,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE3B,CAAE,KAAM,CAAO,OAAE,CAAK,CAAE,CAAG,MAAM,EACrC,IAAI,CAAC,2BACL,MAAM,CACN,CAAC;;;IAGA,CAAC,EAEF,EAAE,CAAC,aAAc,GACjB,KAAK,CAAC,aAAc,CAAE,WAAW,CAAM,UAEzC,AAAI,EACI,CAAE,IADC,EACM,iCAAkC,EAG5C,CAAE,KAAM,CAAQ,CACxB,CAKO,eAAe,EAAqB,CAAiB,CAAE,CAAkB,EAC/E,IAAM,EAAU,CAAA,EAAA,EAAA,iBAAA,AAAiB,IAE3B,CAAE,KAAM,CAAU,CAAE,CAAG,MAAM,EAAQ,IAAI,CAAC,+BAA+B,MAAM,CAAC,WAAW,EAAE,CAAC,aAAc,GAAW,EAAE,CAAC,cAAe,GAAY,MAAM,GAEjK,OAAO,GAAY,WAAY,CAChC,0CA/WsB,EAsEA,EAqDA,EAuBA,EAgDA,EAwBA,EAiBA,EAqCA,EAuCA,EA0BA,EAwBA,IAzWA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAsEA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqDA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAuBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAgDA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAwBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAiBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAqCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAuCA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MA0BA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,MAwBA,CAAA,EAAA,EAAA,uBAAA,EAAA,EAAA,6CAAA,qEExYtB,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OAKA,EAAA,EAAA,CAAA,CAAA,OAIA,EAAA,EAAA,CAAA,CAAA,OAIA,EAAA,EAAA,CAAA,CAAA","ignoreList":[1,2]}