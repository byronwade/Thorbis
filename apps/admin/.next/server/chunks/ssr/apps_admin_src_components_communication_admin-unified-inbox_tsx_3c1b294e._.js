module.exports=[69689,a=>{"use strict";var b=a.i(45139),c=a.i(47473);a.i(98274);var d=a.i(60272);a.i(29891);var e=a.i(18170);a.i(39683);var f=a.i(22054);a.i(25434);var g=a.i(86990),h=a.i(22471),i=a.i(52168),j=a.i(5034),k=a.i(63758),l=a.i(3431);let m=(0,l.default)("forward",[["path",{d:"m15 17 5-5-5-5",key:"nf172w"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);var n=a.i(89815),o=a.i(28952),p=a.i(94436),q=a.i(98062),r=a.i(46840);let s=(0,l.default)("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]),t=(0,l.default)("reply-all",[["path",{d:"m12 17-5-5 5-5",key:"1s3y5u"}],["path",{d:"M22 18v-2a4 4 0 0 0-4-4H7",key:"1fcyog"}],["path",{d:"m7 17-5-5 5-5",key:"1ed8i2"}]]);var u=a.i(50900);let v=(0,l.default)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var w=a.i(53995),x=a.i(39632);let y=(0,l.default)("voicemail",[["circle",{cx:"6",cy:"12",r:"4",key:"1ehtga"}],["circle",{cx:"18",cy:"12",r:"4",key:"4vafl8"}],["line",{x1:"6",x2:"18",y1:"16",y2:"16",key:"pmt8us"}]]);var z=a.i(298),A=a.i(8292),A=A;a.i(9633);var B=a.i(90125),C=a.i(68507);a.i(47673);var D=a.i(89904);a.i(97977);var E=a.i(82012);a.i(86802);var F=a.i(45250),G=a.i(86233);let H=(0,l.default)("bold",[["path",{d:"M6 12h9a4 4 0 0 1 0 8H7a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1h7a4 4 0 0 1 0 8",key:"mg9rjx"}]]);var I=a.i(87969),J=a.i(66153),K=a.i(90782),L=a.i(24126);let M=(0,l.default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),N=(0,l.default)("italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]),O=(0,l.default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]),P=(0,l.default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]),Q=(0,l.default)("list-ordered",[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]]);var R=a.i(98803);let S=(0,l.default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);var T=a.i(39044),U=a.i(83753);let V=(0,l.default)("underline",[["path",{d:"M6 4v6a6 6 0 0 0 12 0V4",key:"9kb039"}],["line",{x1:"4",x2:"20",y1:"20",y2:"20",key:"nun2al"}]]),W=[{id:"follow-up",label:"Friendly follow-up",body:"Hi there,\n\nJust checking in - let me know if you have any questions or if you'd like to see anything else from my side.\n\nBest,"},{id:"thank-you",label:"Thank you note",body:"Hi there,\n\nThanks again for your patience while we sorted this out. Let me know if there's anything else I can help with.\n\nWarm regards,"},{id:"next-steps",label:"Outline next steps",body:"Hi there,\n\nI've outlined the next steps:\n1. Review the details above.\n2. Confirm when you'd like to move forward.\n3. I'll lock everything in once you reply.\n\nLet me know if you want to adjust anything."},{id:"resolution",label:"Issue resolved",body:"Hi there,\n\nI wanted to let you know that we've resolved the issue you reported. Here's a summary of what was done:\n\n[Summary]\n\nPlease let us know if you experience any further issues.\n\nBest regards,"}],X=[{id:"none",label:"No signature",value:""},{id:"support",label:"Stratos Support",value:"\n\nThanks,\nStratos Support Team"},{id:"admin",label:"Admin Team",value:"\n\nBest regards,\nStratos Admin"}];function Y({mode:a,selectedMessage:d,onClose:g,onSent:i,className:j}){let{toast:k}=(0,G.useToast)(),l=(0,c.useRef)(null),m=(0,c.useRef)(null),[n,o]=(0,c.useState)(""),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!1),[u,v]=(0,c.useState)("support"),[w,y]=(0,c.useState)(!1),[A,C]=(0,c.useState)([]),[Y,Z]=(0,c.useState)([]),[$,_]=(0,c.useState)([]),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)(""),[ag,ah]=(0,c.useState)([]),[ai,aj]=(0,c.useState)(""),[ak,al]=(0,c.useState)(!1),[am,an]=(0,c.useState)(""),[ao,ap]=(0,c.useState)(""),[aq,ar]=(0,c.useState)(!1),[as,at]=(0,c.useState)(5),au=(0,c.useRef)(null),av=(0,c.useRef)(null),aw=(0,c.useMemo)(()=>X.find(a=>a.id===u)??X[0],[u]);(0,c.useEffect)(()=>{if(!d)return;let b=d.subject?.trim()||"No subject",c="forward"===a?"Fwd:":"Re:";af(b.toLowerCase().startsWith(c.toLowerCase())?b:`${c} ${b}`),"forward"!==a&&d.from&&C([{id:`recipient-${d.from}`,name:d.userName||d.companyName||d.from,email:d.from,type:d.companyId?"company":"custom"}])},[a,d]);let ax=(0,c.useCallback)(()=>{let a=l.current;a&&(a.style.height="auto",a.style.height=`${Math.min(a.scrollHeight,200)}px`)},[]);(0,c.useEffect)(()=>{ax()},[n,ax]),(0,c.useEffect)(()=>{setTimeout(()=>l.current?.focus(),100)},[]);let ay=(0,c.useCallback)(()=>{au.current&&(clearTimeout(au.current),au.current=null),av.current&&(clearInterval(av.current),av.current=null),ar(!1),at(5),k.info("Email cancelled")},[k]);(0,c.useEffect)(()=>()=>{au.current&&clearTimeout(au.current),av.current&&clearInterval(av.current)},[]);let az=a=>{let b,c=new Date;switch(a){case"tomorrow_morning":(b=new Date(c)).setDate(b.getDate()+1),b.setHours(8,0,0,0);break;case"tomorrow_afternoon":(b=new Date(c)).setDate(b.getDate()+1),b.setHours(13,0,0,0);break;case"monday_morning":let d=(b=new Date(c)).getDay();b.setDate(b.getDate()+(0===d?1:8-d)),b.setHours(8,0,0,0)}return b},aA=async a=>{d?0===A.length?k.error("Add at least one recipient"):n.trim()?a<=new Date?k.error("Schedule time must be in the future"):(t(!0),setTimeout(()=>{let b=a.toLocaleString("en-US",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});k.success(`Email scheduled - Will be sent ${b}`),i?.({}),g(),t(!1),al(!1)},1e3)):k.error("Please write a message"):k.error("Missing context")},aB=async()=>{if(!d)return void k.error("Missing context");if(0===A.length)return void k.error("Add at least one recipient");if(!n.trim())return void k.error("Please write a message");ar(!0),at(5),k.loading("Sending email...");let a=5;av.current=setInterval(()=>{at(--a),a<=0&&av.current&&(clearInterval(av.current),av.current=null)},1e3),au.current=setTimeout(()=>{av.current&&(clearInterval(av.current),av.current=null),t(!0),ar(!1),setTimeout(()=>{k.success("Email sent successfully"),i?.({}),g(),t(!1)},500)},5e3)},aC=(0,c.useCallback)(async a=>{let b=a.target.files;if(!b||0===b.length)return;let c=[];for(let a of Array.from(b)){if(a.size>0xa00000){k.error(`File "${a.name}" is too large (max 10MB)`);continue}try{let b=await new Promise((b,c)=>{let d=new FileReader;d.onload=()=>{let a=d.result.split(",")[1];b(a)},d.onerror=c,d.readAsDataURL(a)});c.push({filename:a.name,content:b,contentType:a.type,size:a.size})}catch{k.error(`Failed to read file "${a.name}"`)}}c.length>0&&ah(a=>[...a,...c]),m.current&&(m.current.value="")},[k]),aD=(0,c.useCallback)(a=>{ah(b=>b.filter(b=>b.filename!==a))},[]),aE=a=>{a&&a.includes("@")&&(A.some(b=>b.email.toLowerCase()===a.toLowerCase())||(C(b=>[...b,{id:`custom-${a}`,name:a,email:a,type:"custom"}]),aj("")))},aF=(0,c.useMemo)(()=>{if(!d)return"";let a=d.userName||d.companyName||d.from||"Unknown",b=new Date(d.createdAt).toLocaleString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"});return`On ${b}, ${a} wrote:
${d.preview||""}`},[d]),aG=(0,c.useMemo)(()=>{if(!d?.preview&&!d?.subject)return[];let a=`${d.subject||""} ${d.preview||""}`.toLowerCase(),b=[];return(a.includes("?")||a.includes("when")||a.includes("can you"))&&((a.includes("schedule")||a.includes("appointment")||a.includes("when"))&&b.push("Yes, I can schedule that. What time works best for you?"),(a.includes("price")||a.includes("cost")||a.includes("quote"))&&b.push("I'll prepare a quote and send it over shortly.")),(a.includes("thank")||a.includes("thanks"))&&b.push("You're welcome! Let me know if you need anything else."),(a.includes("urgent")||a.includes("asap"))&&b.push("I understand the urgency. I'm on it right now."),(a.includes("issue")||a.includes("problem")||a.includes("error"))&&(b.push("I'll look into this and get back to you shortly."),b.push("Can you provide more details about the issue?")),0===b.length&&(b.push("Thanks for reaching out. I'll get back to you shortly."),b.push("Got it, thanks for the update.")),b.slice(0,3)},[d]);return d?(0,b.jsx)(F.TooltipProvider,{children:(0,b.jsxs)("div",{className:(0,h.cn)("w-full overflow-hidden rounded-xl border border-border bg-background shadow-sm transition-all duration-200","focus-within:border-primary/50 focus-within:shadow-md",j),children:[(0,b.jsxs)("button",{type:"button",onClick:()=>r(!q),className:"flex w-full items-center justify-between gap-2 px-3 py-2 text-left hover:bg-muted/50 transition-colors",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground uppercase tracking-wide shrink-0",children:"forward"===a?"Forward":"reply-all"===a?"Reply All":"Reply"}),(0,b.jsx)("span",{className:"text-sm text-foreground truncate",children:A.length>0?A.map(a=>a.name).join(", "):"Add recipients..."})]}),q?(0,b.jsx)(K.ChevronUp,{className:"h-4 w-4 text-muted-foreground shrink-0"}):(0,b.jsx)(J.ChevronDown,{className:"h-4 w-4 text-muted-foreground shrink-0"})]}),q&&(0,b.jsxs)("div",{className:"border-t border-border/50 px-3 py-2 space-y-2 bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground w-12 pt-2",children:"To:"}),(0,b.jsxs)("div",{className:"flex-1 flex flex-wrap gap-1 items-center",children:[A.map(a=>(0,b.jsxs)("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-primary/10 text-primary text-xs rounded-full",children:[a.name,(0,b.jsx)("button",{type:"button",onClick:()=>{var b;return b=a.email,void C(a=>a.filter(a=>a.email!==b))},className:"hover:text-destructive",children:(0,b.jsx)(z.X,{className:"h-3 w-3"})})]},a.id)),(0,b.jsx)("input",{type:"email",value:ai,onChange:a=>aj(a.target.value),onKeyDown:a=>{("Enter"===a.key||","===a.key)&&(a.preventDefault(),aE(ai.trim()))},onBlur:()=>aE(ai.trim()),placeholder:"Add email...",className:"flex-1 min-w-[120px] bg-transparent text-sm outline-none placeholder:text-muted-foreground"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1 pt-1.5",children:[!aa&&(0,b.jsx)("button",{type:"button",onClick:()=>ab(!0),className:"text-xs text-muted-foreground hover:text-foreground px-1.5 py-0.5 rounded hover:bg-muted transition-colors",children:"Cc"}),!ac&&(0,b.jsx)("button",{type:"button",onClick:()=>ad(!0),className:"text-xs text-muted-foreground hover:text-foreground px-1.5 py-0.5 rounded hover:bg-muted transition-colors",children:"Bcc"})]})]}),aa&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground w-12",children:"Cc:"}),(0,b.jsx)("input",{type:"email",placeholder:"Add Cc recipients...",className:"flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground"}),(0,b.jsx)("button",{type:"button",onClick:()=>{ab(!1),Z([])},className:"text-xs text-muted-foreground hover:text-destructive",children:(0,b.jsx)(z.X,{className:"h-3 w-3"})})]}),ac&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground w-12",children:"Bcc:"}),(0,b.jsx)("input",{type:"email",placeholder:"Add Bcc recipients...",className:"flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground"}),(0,b.jsx)("button",{type:"button",onClick:()=>{ad(!1),_([])},className:"text-xs text-muted-foreground hover:text-destructive",children:(0,b.jsx)(z.X,{className:"h-3 w-3"})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-xs font-medium text-muted-foreground w-12",children:"Subject:"}),(0,b.jsx)("input",{type:"text",value:ae,onChange:a=>af(a.target.value),placeholder:"Subject",className:"flex-1 bg-transparent text-sm outline-none placeholder:text-muted-foreground"})]})]}),aG.length>0&&!n&&(0,b.jsx)("div",{className:"px-3 py-2 border-b border-border/50",children:(0,b.jsxs)("div",{className:"flex items-center gap-1.5 flex-wrap",children:[(0,b.jsx)(U.Sparkles,{className:"h-3.5 w-3.5 text-muted-foreground shrink-0"}),aG.map((a,c)=>(0,b.jsx)("button",{type:"button",onClick:()=>{o(a),l.current?.focus()},className:"text-xs px-2.5 py-1 rounded-full border border-border bg-muted/50 hover:bg-muted hover:border-primary/50 transition-colors truncate max-w-[200px]",title:a,children:a.length>40?`${a.slice(0,40)}...`:a},c))]})}),(0,b.jsxs)("div",{className:"px-3 py-2",children:[(0,b.jsx)("textarea",{ref:l,value:n,onChange:a=>o(a.target.value),onInput:ax,onKeyDown:a=>{"Enter"===a.key&&(a.metaKey||a.ctrlKey)&&(a.preventDefault(),aB())},placeholder:"Write your reply...",className:(0,h.cn)("w-full resize-none bg-transparent outline-none","text-sm","placeholder:text-muted-foreground","min-h-[80px] max-h-[200px]"),rows:3}),aw.value&&(0,b.jsxs)("div",{className:"mt-2 pt-2 border-t border-dashed border-border/50",children:[(0,b.jsxs)("div",{className:"text-xs text-muted-foreground mb-1 flex items-center justify-between",children:[(0,b.jsx)("span",{children:"Signature"}),(0,b.jsx)("button",{type:"button",onClick:()=>v("none"),className:"text-[10px] hover:text-foreground transition-colors",children:"Remove"})]}),(0,b.jsx)("div",{className:"text-sm text-muted-foreground whitespace-pre-wrap",children:aw.value.trim()})]})]}),d.preview&&(0,b.jsxs)("div",{className:"px-3 pb-2",children:[(0,b.jsxs)("button",{type:"button",onClick:()=>y(!w),className:"text-xs text-muted-foreground hover:text-foreground flex items-center gap-1",children:[(0,b.jsx)(p.MoreHorizontal,{className:"h-3 w-3"}),w?"Hide":"Show"," quoted text"]}),w&&(0,b.jsx)("div",{className:"mt-2 pl-3 border-l-2 border-muted text-xs text-muted-foreground whitespace-pre-wrap max-h-[100px] overflow-y-auto",children:aF})]}),ag.length>0&&(0,b.jsx)("div",{className:"px-3 py-2 border-t border-border/50 bg-muted/20",children:(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:ag.map(a=>{var c;return(0,b.jsxs)("div",{className:"flex items-center gap-1.5 px-2 py-1 bg-background border rounded-md text-xs",children:[(0,b.jsx)(S,{className:"h-3 w-3 text-muted-foreground"}),(0,b.jsx)("span",{className:"max-w-[120px] truncate",children:a.filename}),(0,b.jsxs)("span",{className:"text-muted-foreground",children:["(",(c=a.size)<1024?`${c} B`:c<1048576?`${(c/1024).toFixed(1)} KB`:`${(c/1048576).toFixed(1)} MB`,")"]}),(0,b.jsx)("button",{type:"button",onClick:()=>aD(a.filename),className:"ml-1 text-muted-foreground hover:text-destructive",children:(0,b.jsx)(z.X,{className:"h-3 w-3"})})]},a.filename)})})}),(0,b.jsx)("input",{ref:m,type:"file",multiple:!0,className:"hidden",onChange:aC,accept:"*/*"}),(0,b.jsxs)("div",{className:"flex items-center justify-between gap-1 border-t border-border/50 px-2 py-1.5 bg-muted/30",children:[(0,b.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,b.jsxs)(F.Tooltip,{children:[(0,b.jsx)(F.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",onClick:()=>m.current?.click(),children:(0,b.jsx)(S,{className:"h-4 w-4 text-muted-foreground"})})}),(0,b.jsx)(F.TooltipContent,{side:"top",children:"Attach file"})]}),(0,b.jsxs)(F.Tooltip,{children:[(0,b.jsx)(F.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",children:(0,b.jsx)(M,{className:"h-4 w-4 text-muted-foreground"})})}),(0,b.jsx)(F.TooltipContent,{side:"top",children:"Insert image"})]}),(0,b.jsxs)(F.Tooltip,{children:[(0,b.jsx)(F.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0",children:(0,b.jsx)(O,{className:"h-4 w-4 text-muted-foreground"})})}),(0,b.jsx)(F.TooltipContent,{side:"top",children:"Insert link"})]}),(0,b.jsx)("div",{className:"w-px h-4 bg-border mx-1"}),(0,b.jsxs)(B.DropdownMenu,{children:[(0,b.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"h-7 px-2 gap-1",children:[(0,b.jsx)(H,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,b.jsx)(J.ChevronDown,{className:"h-3 w-3 text-muted-foreground"})]})}),(0,b.jsxs)(B.DropdownMenuContent,{align:"start",className:"w-40",children:[(0,b.jsxs)(B.DropdownMenuItem,{children:[(0,b.jsx)(H,{className:"h-4 w-4 mr-2"})," Bold"]}),(0,b.jsxs)(B.DropdownMenuItem,{children:[(0,b.jsx)(N,{className:"h-4 w-4 mr-2"})," Italic"]}),(0,b.jsxs)(B.DropdownMenuItem,{children:[(0,b.jsx)(V,{className:"h-4 w-4 mr-2"})," Underline"]}),(0,b.jsx)(B.DropdownMenuSeparator,{}),(0,b.jsxs)(B.DropdownMenuItem,{children:[(0,b.jsx)(P,{className:"h-4 w-4 mr-2"})," Bullet list"]}),(0,b.jsxs)(B.DropdownMenuItem,{children:[(0,b.jsx)(Q,{className:"h-4 w-4 mr-2"})," Numbered list"]})]})]}),(0,b.jsxs)(B.DropdownMenu,{children:[(0,b.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"h-7 px-2 gap-1",children:[(0,b.jsx)(U.Sparkles,{className:"h-3.5 w-3.5 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground hidden sm:inline",children:"Templates"})]})}),(0,b.jsxs)(B.DropdownMenuContent,{align:"start",className:"w-48",children:[W.map(a=>(0,b.jsx)(B.DropdownMenuItem,{onClick:()=>{var b;let c;return b=a.id,void((c=W.find(a=>a.id===b))&&o(c.body))},children:a.label},a.id)),(0,b.jsx)(B.DropdownMenuSeparator,{}),(0,b.jsxs)(B.DropdownMenuItem,{className:"text-muted-foreground text-xs",children:["Signature: ",aw.label]}),X.map(a=>(0,b.jsx)(B.DropdownMenuItem,{onClick:()=>v(a.id),className:(0,h.cn)("pl-6",u===a.id&&"font-medium text-primary"),children:a.label},a.id))]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsxs)(F.Tooltip,{children:[(0,b.jsx)(F.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-7 w-7 p-0 text-muted-foreground hover:text-destructive",onClick:g,children:(0,b.jsx)(x.Trash2,{className:"h-4 w-4"})})}),(0,b.jsx)(F.TooltipContent,{side:"top",children:"Discard"})]}),aq?(0,b.jsx)(e.Button,{size:"sm",className:"h-7 px-3 gap-1.5 rounded-full bg-amber-500 hover:bg-amber-600",onClick:ay,children:(0,b.jsxs)("span",{className:"text-xs font-medium",children:["Undo (",as,"s)"]})}):(0,b.jsxs)("div",{className:"flex items-center",children:[(0,b.jsxs)(e.Button,{size:"sm",className:"h-7 px-3 gap-1.5 rounded-l-full rounded-r-none",onClick:aB,disabled:s||!n.trim(),children:[s?(0,b.jsx)(R.Loader2,{className:"h-3.5 w-3.5 animate-spin"}):(0,b.jsx)(T.Send,{className:"h-3.5 w-3.5"}),(0,b.jsx)("span",{className:"text-xs font-medium",children:"Send"})]}),(0,b.jsxs)(D.Popover,{open:ak,onOpenChange:al,children:[(0,b.jsx)(D.PopoverTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{size:"sm",className:"h-7 px-1.5 rounded-l-none rounded-r-full border-l border-primary-foreground/20",disabled:s||!n.trim(),children:(0,b.jsx)(J.ChevronDown,{className:"h-3.5 w-3.5"})})}),(0,b.jsx)(D.PopoverContent,{className:"w-72 p-2",align:"end",children:(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground px-2 py-1",children:"Schedule send"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"w-full justify-start h-8 text-xs",onClick:()=>aA(az("tomorrow_morning")),children:[(0,b.jsx)(L.Clock,{className:"h-3.5 w-3.5 mr-2"}),"Tomorrow morning (8:00 AM)"]}),(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"w-full justify-start h-8 text-xs",onClick:()=>aA(az("tomorrow_afternoon")),children:[(0,b.jsx)(L.Clock,{className:"h-3.5 w-3.5 mr-2"}),"Tomorrow afternoon (1:00 PM)"]}),(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",className:"w-full justify-start h-8 text-xs",onClick:()=>aA(az("monday_morning")),children:[(0,b.jsx)(I.Calendar,{className:"h-3.5 w-3.5 mr-2"}),"Monday morning (8:00 AM)"]})]}),(0,b.jsxs)("div",{className:"border-t border-border pt-2",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground px-2 py-1",children:"Pick date & time"}),(0,b.jsxs)("div",{className:"flex gap-2 px-2",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(E.Label,{htmlFor:"schedule-date",className:"sr-only",children:"Date"}),(0,b.jsx)(f.Input,{id:"schedule-date",type:"date",value:am,onChange:a=>an(a.target.value),min:new Date().toISOString().split("T")[0],className:"h-8 text-xs"})]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(E.Label,{htmlFor:"schedule-time",className:"sr-only",children:"Time"}),(0,b.jsx)(f.Input,{id:"schedule-time",type:"time",value:ao,onChange:a=>ap(a.target.value),className:"h-8 text-xs"})]})]}),(0,b.jsxs)(e.Button,{size:"sm",className:"w-full mt-2 h-8 text-xs",onClick:()=>{am&&ao?aA(new Date(`${am}T${ao}`)):k.error("Please select both date and time")},disabled:!am||!ao,children:[(0,b.jsx)(L.Clock,{className:"h-3.5 w-3.5 mr-2"}),"Schedule"]})]})]})})]})]})]})]}),(0,b.jsx)("div",{className:"px-3 pb-1.5 text-[10px] text-muted-foreground/60 text-right",children:"Cmd/Ctrl + Enter to send"})]})}):null}var Z=a.i(50292);function $({className:a,children:c,...d}){return(0,b.jsxs)(Z.Root,{className:(0,h.cn)("relative overflow-hidden",a),"data-slot":"scroll-area",...d,children:[(0,b.jsx)(Z.Viewport,{className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1","data-slot":"scroll-area-viewport",children:c}),(0,b.jsx)(_,{}),(0,b.jsx)(Z.Corner,{})]})}function _({className:a,orientation:c="vertical",...d}){return(0,b.jsx)(Z.ScrollAreaScrollbar,{className:(0,h.cn)("flex touch-none p-px transition-colors select-none","vertical"===c&&"h-full w-2.5 border-l border-l-transparent","horizontal"===c&&"h-2.5 flex-col border-t border-t-transparent",a),"data-slot":"scroll-area-scrollbar",orientation:c,...d,children:(0,b.jsx)(Z.ScrollAreaThumb,{className:"bg-border relative flex-1 rounded-full","data-slot":"scroll-area-thumb"})})}var aa=a.i(73608),ab=a.i(88839);function ac(a){return(0,ab.constructFrom)(a,Date.now())}var ad=a.i(65990),ae=a.i(65791),af=a.i(38446);let ag=(0,l.default)("check-check",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);var ah=a.i(97997),ai=a.i(20091);function aj(a){var b;let c=new Date(a);return(0,ad.isSameDay)((0,ab.constructFrom)(c,c),ac(c))?"Today":(0,ad.isSameDay)((0,ab.constructFrom)(c,c),(b=ac(c),(0,ae.addDays)(b,-1,void 0)))?"Yesterday":(0,aa.format)(c,"EEEE, MMMM d")}function ak({message:a,isFirst:c,isLast:e,showAvatar:f}){let g="outbound"===a.direction;return(0,b.jsxs)("div",{className:(0,h.cn)("flex gap-2",g?"flex-row-reverse":"flex-row",!c&&"mt-0.5"),children:[!g&&(0,b.jsx)("div",{className:"w-7 shrink-0",children:f&&(0,b.jsx)(d.Avatar,{className:"size-7",children:(0,b.jsx)(d.AvatarFallback,{className:"bg-muted text-[10px]",children:a.senderName?.charAt(0)||"?"})})}),(0,b.jsx)("div",{className:(0,h.cn)("max-w-[75%] px-3 py-2 text-sm",g?"bg-primary text-primary-foreground":"bg-muted text-foreground",c&&e&&"rounded-2xl",c&&!e&&(g?"rounded-2xl rounded-br-md":"rounded-2xl rounded-bl-md"),!c&&!e&&(g?"rounded-2xl rounded-r-md":"rounded-2xl rounded-l-md"),!c&&e&&(g?"rounded-2xl rounded-tr-md":"rounded-2xl rounded-tl-md")),children:(0,b.jsx)("p",{className:"whitespace-pre-wrap break-words leading-relaxed",children:a.content})}),g&&(0,b.jsx)("div",{className:"w-7 shrink-0"})]})}function al({messages:a,showDateDivider:c,dateLabel:d}){let e,f=a[0]?.direction==="outbound",g=a[a.length-1];return(0,b.jsxs)("div",{className:"space-y-0.5",children:[c&&(0,b.jsx)("div",{className:"flex justify-center py-3",children:(0,b.jsx)("span",{className:"rounded-full bg-muted px-3 py-1 text-[10px] font-medium text-muted-foreground",children:d})}),a.map((c,d)=>(0,b.jsx)(ak,{message:c,isFirst:0===d,isLast:d===a.length-1,showAvatar:!f&&d===a.length-1},c.id)),(0,b.jsxs)("div",{className:(0,h.cn)("flex items-center gap-1 px-9 pt-1",f?"justify-end":"justify-start"),children:[(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:(e=new Date(g?.timestamp||""),(0,aa.format)(e,"h:mm a"))}),f&&function(a){switch(a){case"sending":return(0,b.jsx)(L.Clock,{className:"size-3 text-muted-foreground"});case"sent":return(0,b.jsx)(af.Check,{className:"size-3 text-muted-foreground"});case"delivered":return(0,b.jsx)(ag,{className:"size-3 text-muted-foreground"});case"read":return(0,b.jsx)(ag,{className:"size-3 text-primary"});case"failed":return(0,b.jsx)(ah.AlertCircle,{className:"size-3 text-destructive"});default:return null}}(g?.status)]})]})}function am(){return(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:"w-7 shrink-0",children:(0,b.jsx)(d.Avatar,{className:"size-7",children:(0,b.jsx)(d.AvatarFallback,{className:"bg-muted text-[10px]",children:"..."})})}),(0,b.jsx)("div",{className:"rounded-2xl rounded-bl-md bg-muted px-4 py-3",children:(0,b.jsxs)("div",{className:"flex gap-1",children:[(0,b.jsx)("span",{className:"size-2 animate-bounce rounded-full bg-muted-foreground/50 [animation-delay:-0.3s]"}),(0,b.jsx)("span",{className:"size-2 animate-bounce rounded-full bg-muted-foreground/50 [animation-delay:-0.15s]"}),(0,b.jsx)("span",{className:"size-2 animate-bounce rounded-full bg-muted-foreground/50"})]})})]})}function an({conversation:a,className:e}){let f=(0,c.useRef)(null),i=(0,c.useRef)(null);(0,c.useEffect)(()=>{i.current?.scrollIntoView({behavior:"smooth"})},[a.messages.length,a.isTyping]);let j=[],l=[],m=null;return a.messages.forEach((b,c)=>{let d=new Date(b.timestamp),e=a.messages[c-1],f=!m||!(0,ad.isSameDay)(d,m);(!e||e.direction!==b.direction||d.getTime()-new Date(e.timestamp).getTime()>12e4||f)&&l.length>0&&(j.push({messages:l,showDateDivider:!m||!(0,ad.isSameDay)(new Date(l[0]?.timestamp||""),m),dateLabel:aj(l[0]?.timestamp||"")}),m=new Date(l[0]?.timestamp||""),l=[]),l.push(b)}),l.length>0&&j.push({messages:l,showDateDivider:!m||!(0,ad.isSameDay)(new Date(l[0]?.timestamp||""),m),dateLabel:aj(l[0]?.timestamp||"")}),(0,b.jsxs)("div",{className:(0,h.cn)("flex h-full flex-col",e),children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 border-b border-border/50 bg-card px-4 py-3",children:[(0,b.jsx)(d.Avatar,{className:"size-10",children:(0,b.jsx)(d.AvatarFallback,{className:"bg-primary/10 text-primary",children:a.contactName.split(" ").map(a=>a[0]).join("").substring(0,2)})}),(0,b.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("h3",{className:"truncate font-semibold",children:a.contactName}),a.companyName&&(0,b.jsxs)(g.Badge,{variant:"outline",className:"shrink-0 gap-1 text-[10px]",children:[(0,b.jsx)(k.Building2,{className:"size-2.5"}),a.companyName]})]}),(0,b.jsx)("p",{className:"truncate text-xs text-muted-foreground",children:a.contactPhone})]})]}),(0,b.jsx)($,{ref:f,className:"flex-1",children:(0,b.jsxs)("div",{className:"space-y-4 p-4",children:[0===j.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,b.jsx)("div",{className:"mb-3 rounded-full bg-muted p-4",children:(0,b.jsx)(ai.User,{className:"size-8 text-muted-foreground"})}),(0,b.jsx)("h4",{className:"font-medium",children:"No messages yet"}),(0,b.jsx)("p",{className:"mt-1 text-sm text-muted-foreground",children:"Start the conversation by sending a message below"})]}):j.map((a,c)=>(0,b.jsx)(al,{messages:a.messages,showDateDivider:a.showDateDivider,dateLabel:a.dateLabel},`group-${c}`)),a.isTyping&&(0,b.jsx)("div",{className:"pt-2",children:(0,b.jsx)(am,{})}),(0,b.jsx)("div",{ref:i})]})})]})}var ao=a.i(55519);let ap=(0,l.default)("message-square-text",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]]),aq=(0,l.default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),ar=[{id:"follow-up",label:"Follow Up",preview:"Service follow-up request",text:"Hi, just following up on our recent communication. Is there anything else I can help you with?"},{id:"thank-you",label:"Thank You",preview:"Thank you message",text:"Thank you for reaching out! We appreciate your business and are here to help."},{id:"escalated",label:"Escalated",preview:"Issue escalation notice",text:"I've escalated your issue to our senior support team. Someone will be in touch shortly."},{id:"resolved",label:"Issue Resolved",preview:"Resolution confirmation",text:"Great news - the issue has been resolved. Please let us know if you experience any further problems."}],as=[{name:"Frequently Used",emojis:["ğŸ˜€","ğŸ˜‚","ğŸ˜","ğŸ¥°","ğŸ˜˜","ğŸ˜Š","ğŸ˜‰","ğŸ˜","ğŸ¤”","ğŸ˜","ğŸ‘","ğŸ‘‹","ğŸ™","â¤ï¸","âœ…","ğŸ‰"]},{name:"Smileys",emojis:["ğŸ˜€","ğŸ˜ƒ","ğŸ˜„","ğŸ˜","ğŸ˜†","ğŸ˜…","ğŸ¤£","ğŸ˜‚","ğŸ™‚","ğŸ˜‰","ğŸ˜Š","ğŸ˜‡","ğŸ¥°","ğŸ˜","ğŸ˜˜","ğŸ˜—"]},{name:"Gestures",emojis:["ğŸ‘‹","ğŸ¤š","ğŸ–","âœ‹","ğŸ‘Œ","ğŸ¤","âœŒï¸","ğŸ¤","ğŸ¤Ÿ","ğŸ¤˜","ğŸ¤™","ğŸ‘ˆ","ğŸ‘‰","ğŸ‘","ğŸ‘","âœŠ"]},{name:"Symbols",emojis:["â¤ï¸","ğŸ§¡","ğŸ’›","ğŸ’š","ğŸ’™","ğŸ’œ","ğŸ–¤","ğŸ¤","âœ…","âŒ","â­","ğŸŒŸ","ğŸ’¯","ğŸ”¥","ğŸ’ª","ğŸ™Œ"]}];function at({value:a,onChange:d,onSend:f,sending:g=!1,disabled:i=!1,placeholder:j="Type a message..."}){let[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),o=(0,c.useRef)(null),p=function(a){if(!a)return{segments:0,charsPerSegment:160,isUnicode:!1};let b=!/^[@Â£$Â¥Ã¨Ã©Ã¹Ã¬Ã²Ã‡\nÃ˜Ã¸\rÃ…Ã¥Î”_Î¦Î“Î›Î©Î Î¨Î£Î˜Î\x1B !"#Â¤%&'()*+,\-./0-9:;<=>?Â¡A-ZÃ„Ã–Ã‘Ü§Â¿a-zÃ¤Ã¶Ã±Ã¼Ã ]*$/.test(a),c=b?70:160,d=b?67:153;return a.length<=c?{segments:1,charsPerSegment:c,isUnicode:b}:{segments:Math.ceil(a.length/d),charsPerSegment:d,isUnicode:b}}(a),q=a.length>0&&(m||a.length>100);(0,c.useEffect)(()=>{o.current&&(o.current.style.height="auto",o.current.style.height=`${Math.min(o.current.scrollHeight,120)}px`)},[a]);let r=(0,c.useCallback)(b=>{let c=o.current;if(c){let e=c.selectionStart,f=c.selectionEnd;d(a.substring(0,e)+b+a.substring(f)),setTimeout(()=>{c.selectionStart=e+b.length,c.selectionEnd=e+b.length,c.focus()},0)}else d(a+b);l(!1)},[a,d]),s=(0,c.useCallback)(a=>{d(a.text),o.current?.focus()},[d]),t=(0,c.useCallback)(()=>{!a.trim()||g||i||f()},[a,g,i,f]),u=(0,c.useCallback)(a=>{"Enter"!==a.key||a.shiftKey||(a.preventDefault(),t())},[t]);return(0,b.jsxs)("div",{className:"bg-card border-t border-border/50",children:[q&&(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2 px-3 pt-2 pb-1",children:[(0,b.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[a.length," chars"]}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Â·"}),(0,b.jsxs)("span",{className:(0,h.cn)("text-[10px] font-medium",p.segments>1?"text-amber-500":"text-muted-foreground"),children:[p.segments," segment",1!==p.segments?"s":""]}),p.isUnicode&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Â·"}),(0,b.jsx)("span",{className:"text-[10px] text-amber-500",children:"Unicode"})]})]}),(0,b.jsxs)("div",{className:"flex items-end gap-1.5 p-2",children:[(0,b.jsxs)(B.DropdownMenu,{children:[(0,b.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{type:"button",variant:"ghost",size:"icon",className:"mb-0.5 size-10 md:size-8 shrink-0 rounded-full hover:bg-muted",disabled:i,title:"Quick replies",children:(0,b.jsx)(ap,{className:"size-5 md:size-4 text-muted-foreground"})})}),(0,b.jsxs)(B.DropdownMenuContent,{align:"start",side:"top",className:"w-56",children:[(0,b.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Quick Replies"}),ar.map(a=>(0,b.jsxs)(B.DropdownMenuItem,{onClick:()=>s(a),className:"flex-col items-start gap-0.5",children:[(0,b.jsx)("span",{className:"font-medium",children:a.label}),(0,b.jsx)("span",{className:"line-clamp-1 text-xs text-muted-foreground",children:a.preview})]},a.id))]})]}),(0,b.jsx)("div",{className:"relative min-w-0 flex-1",children:(0,b.jsxs)("div",{className:(0,h.cn)("flex w-full items-center overflow-y-auto rounded-[18px] border border-border bg-muted/50 pl-3 pr-1 py-1 transition-colors","min-h-[44px] md:min-h-[36px] max-h-[120px]","focus-within:border-primary/30 focus-within:bg-background focus-within:ring-1 focus-within:ring-primary/20",(i||g)&&"cursor-not-allowed opacity-50"),children:[(0,b.jsx)("textarea",{ref:o,value:a,onChange:a=>d(a.target.value),onKeyDown:u,onFocus:()=>n(!0),onBlur:()=>n(!1),placeholder:j,disabled:i||g,rows:1,className:(0,h.cn)("w-full min-w-0 resize-none bg-transparent py-1 leading-5 outline-none","text-base md:text-sm","placeholder:text-muted-foreground/60",(i||g)&&"pointer-events-none")}),(0,b.jsxs)("div",{className:"flex shrink-0 items-center gap-0.5 pl-1",children:[(0,b.jsxs)(D.Popover,{open:k,onOpenChange:l,children:[(0,b.jsx)(D.PopoverTrigger,{asChild:!0,children:(0,b.jsx)("button",{type:"button",className:(0,h.cn)("flex size-9 md:size-7 items-center justify-center rounded-full transition-colors","hover:bg-muted/80",k&&"bg-muted"),disabled:i,title:"Add emoji",children:(0,b.jsx)(aq,{className:"size-5 md:size-4 text-muted-foreground"})})}),(0,b.jsx)(D.PopoverContent,{side:"top",align:"end",className:"w-[300px] p-0",children:(0,b.jsx)($,{className:"h-[220px]",children:(0,b.jsx)("div",{className:"p-2",children:as.map((a,c)=>(0,b.jsxs)("div",{className:c>0?"mt-3":"",children:[(0,b.jsx)("h4",{className:"mb-1.5 px-1 text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:a.name}),(0,b.jsx)("div",{className:"grid grid-cols-8 gap-0.5",children:a.emojis.map((a,c)=>(0,b.jsx)("button",{type:"button",className:"flex size-8 items-center justify-center rounded-lg text-lg transition-colors hover:bg-muted",onClick:()=>r(a),children:a},`${a}-${c}`))})]},a.name))})})})]}),(0,b.jsx)("button",{type:"button",onClick:t,disabled:!a.trim()||g||i,className:(0,h.cn)("flex size-9 md:size-7 items-center justify-center rounded-full transition-all duration-200",a.trim()?"bg-primary hover:bg-primary/90 scale-100 active:scale-95":"bg-muted/50 scale-90"),children:g?(0,b.jsx)(R.Loader2,{className:(0,h.cn)("size-5 md:size-4 animate-spin",a.trim()?"text-primary-foreground":"text-muted-foreground")}):(0,b.jsx)(ao.ArrowUp,{className:(0,h.cn)("size-5 md:size-4",a.trim()?"text-primary-foreground":"text-muted-foreground")})})]})]})})]})]})}let au=(0,a.i(27228).create)((a,b)=>({activeFilter:"all",setActiveFilter:b=>a({activeFilter:b}),selectedMessageId:null,setSelectedMessageId:b=>a({selectedMessageId:b}),isDetailView:!1,setIsDetailView:b=>a({isDetailView:b}),activeThreadId:null,setActiveThreadId:b=>a({activeThreadId:b}),composer:{isOpen:!1,type:null,mode:"new"},openComposer:(b,c="new",d)=>{a({composer:{isOpen:!0,type:b,mode:c,context:d}})},closeComposer:()=>a({composer:{isOpen:!1,type:null,mode:"new"}}),replyMode:null,setReplyMode:b=>a({replyMode:b}),pendingMessages:{},addPendingMessage:b=>a(a=>{let c=a.pendingMessages[b.conversationId]??[];return{pendingMessages:{...a.pendingMessages,[b.conversationId]:[...c,b]}}}),resolvePendingMessage:(b,c,d)=>a(a=>{let e=(a.pendingMessages[b]??[]).filter(a=>a.id!==c);return d&&e.push(d),{pendingMessages:e.length>0?{...a.pendingMessages,[b]:e}:Object.fromEntries(Object.entries(a.pendingMessages).filter(([a])=>a!==b))}}),resetPendingMessages:b=>a(a=>a.pendingMessages[b]?{pendingMessages:Object.fromEntries(Object.entries(a.pendingMessages).filter(([a])=>a!==b))}:{pendingMessages:a.pendingMessages}),undoSend:{messageId:null,timeoutId:null,secondsRemaining:5},setUndoSend:(b,c=null)=>a({undoSend:{messageId:b,timeoutId:c,secondsRemaining:5}}),decrementUndoTimer:()=>a(a=>({undoSend:{...a.undoSend,secondsRemaining:Math.max(0,a.undoSend.secondsRemaining-1)}})),cancelUndoSend:()=>{let{undoSend:c}=b();c.timeoutId&&clearTimeout(c.timeoutId),a({undoSend:{messageId:null,timeoutId:null,secondsRemaining:5}})}}));function av({communication:a,onMessageSent:d,className:e}){let f,[g,i]=(0,c.useState)(""),[j,k]=(0,c.useTransition)(),[l,m]=(0,c.useState)([]),{addPendingMessage:n,resolvePendingMessage:o}=au(),p=(f=[{id:a.id,direction:a.direction,content:a.preview||"",timestamp:a.createdAt,status:"outbound"===a.direction?"delivered":void 0,senderName:"inbound"===a.direction?a.userName:"You"}],{id:a.id,contactName:a.userName||a.from||"Unknown",contactPhone:"inbound"===a.direction?a.from||"":a.to||"",companyName:a.companyName,companyId:a.companyId,messages:f,isTyping:!1}),q={...p,messages:[...p.messages,...l]},r=(0,c.useCallback)(()=>{if(!g.trim()||j)return;let b=`temp_${Date.now()}`,c={id:b,direction:"outbound",content:g.trim(),timestamp:new Date().toISOString(),status:"sending",senderName:"You"};m(a=>[...a,c]),i(""),n({id:b,conversationId:a.id,direction:"outbound",content:c.content,timestamp:c.timestamp,status:"sending",contactName:q.contactName,contactPhone:q.contactPhone,companyId:a.companyId}),k(async()=>{try{await new Promise(a=>setTimeout(a,1e3)),m(a=>a.map(a=>a.id===b?{...a,status:"sent"}:a)),await new Promise(a=>setTimeout(a,500)),m(a=>a.map(a=>a.id===b?{...a,status:"delivered"}:a)),o(a.id,b),d?.(c)}catch{m(a=>a.map(a=>a.id===b?{...a,status:"failed"}:a))}})},[g,j,a.id,q.contactName,q.contactPhone,a.companyId,n,o,d]);return(0,b.jsxs)("div",{className:(0,h.cn)("flex h-full flex-col",e),children:[(0,b.jsx)("div",{className:"min-h-0 flex-1",children:(0,b.jsx)(an,{conversation:q})}),(0,b.jsx)(at,{value:g,onChange:i,onSend:r,sending:j,placeholder:`Message ${q.contactName}...`})]})}let aw={email:{icon:n.Mail,color:"text-blue-500",bg:"bg-blue-500/10",label:"Email"},sms:{icon:o.MessageSquare,color:"text-green-500",bg:"bg-green-500/10",label:"SMS"},call:{icon:q.Phone,color:"text-purple-500",bg:"bg-purple-500/10",label:"Call"},voicemail:{icon:y,color:"text-orange-500",bg:"bg-orange-500/10",label:"Voicemail"},ticket:{icon:w.Ticket,color:"text-amber-500",bg:"bg-amber-500/10",label:"Ticket"}},ax=[{type:"all",label:"All"},{type:"email",label:"Email"},{type:"sms",label:"SMS"},{type:"call",label:"Calls"},{type:"voicemail",label:"Voicemail"},{type:"ticket",label:"Tickets"}];function ay({communications:a,onRefresh:l}){let o,q,{toggleSidebar:w}=(0,C.useSidebar)(),[y,D]=(0,c.useState)(""),[E,F]=(0,c.useState)("all"),[G,H]=(0,c.useState)(null),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(null),M=a.filter(a=>{if("all"!==E&&a.type!==E)return!1;if(y){let b=y.toLowerCase(),c=a.subject?.toLowerCase().includes(b),d=a.preview?.toLowerCase().includes(b),e=a.from?.toLowerCase().includes(b),f=a.to?.toLowerCase().includes(b),g=a.companyName?.toLowerCase().includes(b);return c||d||e||f||g}return!0}),N=a.reduce((a,b)=>(a[b.type]=(a[b.type]||0)+1,a),{}),O=(0,c.useCallback)(()=>{J(!0),l?.(),setTimeout(()=>J(!1),1e3)},[l]),P=(0,c.useCallback)(a=>{H(a),L(null)},[]),Q=(0,c.useCallback)(()=>{H(null),L(null)},[]),R=(0,c.useCallback)(()=>{L(null)},[]),S=(0,c.useCallback)(()=>{L(null)},[]),T=a=>aw[a]||aw.email,U=a=>new Date(a).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),V=!G;return(0,b.jsx)("div",{className:"flex h-full w-full flex-col overflow-hidden bg-sidebar",children:(0,b.jsxs)("div",{className:"flex flex-1 overflow-hidden min-h-0 md:gap-2",children:[(0,b.jsx)("div",{className:(0,h.cn)("bg-card mb-1 shadow-sm flex flex-col overflow-hidden","w-full h-full","md:w-[400px] lg:w-[480px] md:rounded-tr-2xl",V?"flex":"hidden md:flex"),children:(0,b.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-15 flex flex-col gap-2 p-2 pb-0 transition-colors bg-card",children:[(0,b.jsx)("div",{className:"grid grid-cols-12 gap-2 mt-1",children:(0,b.jsxs)("div",{className:"col-span-12 flex gap-2",children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:w,className:"h-10 w-10 p-0 md:h-8 md:w-8 shrink-0",title:"Toggle sidebar",children:(0,b.jsx)(A.default,{className:"h-5 w-5 md:h-4 md:w-4 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"relative flex-1",children:[(0,b.jsx)(f.Input,{type:"search",placeholder:"Search communications...",value:y,onChange:a=>D(a.target.value),className:"h-10 md:h-8 pl-9 pr-8 text-base md:text-sm border-input bg-background"}),(0,b.jsx)(u.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),y&&(0,b.jsx)("button",{onClick:()=>D(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:(0,b.jsx)(z.X,{className:"h-3 w-3"})})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",onClick:O,disabled:I,className:"h-10 w-10 p-0 md:h-8 md:w-8",title:"Refresh",children:(0,b.jsx)(r.RefreshCw,{className:`h-5 w-5 md:h-4 md:w-4 text-muted-foreground ${I?"animate-spin":""}`})})]})}),(0,b.jsx)("div",{className:"flex gap-1 overflow-x-auto pb-2 scrollbar-none",children:ax.map(({type:c,label:d})=>{let f="all"===c?a.length:N[c]||0;return(0,b.jsxs)(e.Button,{variant:E===c?"default":"ghost",size:"sm",onClick:()=>F(c),className:"h-7 gap-1 whitespace-nowrap text-xs shrink-0",children:[d,f>0&&(0,b.jsx)(g.Badge,{variant:E===c?"secondary":"outline",className:"ml-0.5 h-4 px-1 text-[10px]",children:f})]},c)})})]}),(0,b.jsx)("div",{className:(0,h.cn)("bg-primary relative z-5 h-0.5 w-full transition-opacity",I?"opacity-100 animate-pulse":"opacity-0")}),(0,b.jsx)("div",{className:"relative z-1 flex-1 overflow-y-auto pt-0 min-h-0",children:(0,b.jsx)("div",{className:"flex h-full w-full",children:(0,b.jsx)("div",{className:"flex flex-1 flex-col",children:M.length>0?(0,b.jsx)("div",{className:"min-h-[200px] px-2",children:M.map(a=>{let c=G?.id===a.id,f="unread"===a.status||"new"===a.status,g=T(a.type),j=g.icon;return(0,b.jsx)("div",{className:"select-none md:my-1",children:(0,b.jsxs)("div",{className:(0,h.cn)("hover:bg-accent group flex cursor-pointer flex-col items-start rounded-lg py-2 text-left text-sm transition-all hover:opacity-100 relative",c?"bg-accent opacity-100":"",f?"opacity-100":"opacity-60"),onClick:()=>P(a),children:[(0,b.jsxs)("div",{className:"absolute right-2 z-25 flex -translate-y-1/2 items-center gap-1 rounded-xl border bg-popover p-1 opacity-0 shadow-sm group-hover:opacity-100 top-[-1] transition-opacity duration-200",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 overflow-visible p-0 hover:bg-accent group/star",title:"Star",children:(0,b.jsx)(v,{className:"h-4 w-4 text-muted-foreground transition-colors group-hover/star:text-yellow-500"})}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-accent group/archive",title:"Archive",children:(0,b.jsx)(i.Archive,{className:"h-4 w-4 text-muted-foreground transition-colors group-hover/archive:text-blue-500"})})]}),(0,b.jsxs)("div",{className:"relative flex w-full items-center justify-between gap-4 px-2",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(d.Avatar,{className:"h-8 w-8 shrink-0 rounded-full",children:(0,b.jsx)(d.AvatarFallback,{className:"bg-primary/10 text-primary font-bold text-xs",children:(a=>{if(!a)return"?";let b=a.split("@")[0];return b.includes(".")?b.split(".").map(a=>a[0]).join("").toUpperCase().slice(0,2):b.substring(0,2).toUpperCase()})("inbound"===a.direction?a.from:a.to)})}),(0,b.jsx)("div",{className:(0,h.cn)("absolute -bottom-1 -right-1 rounded-full p-0.5 border border-background",g.bg),children:(0,b.jsx)(j,{className:(0,h.cn)("h-2.5 w-2.5",g.color)})})]}),(0,b.jsx)("div",{className:"flex w-full justify-between",children:(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("div",{className:"flex w-full flex-row items-center justify-between",children:[(0,b.jsx)("div",{className:"flex flex-row items-center gap-[4px]",children:(0,b.jsx)("span",{className:"font-bold text-md flex items-baseline gap-1 group-hover:opacity-100",children:(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)("span",{className:"line-clamp-1 overflow-hidden text-sm",children:"outbound"===a.direction?a.to||"Unknown recipient":a.from||"Unknown sender"}),f&&(0,b.jsx)("span",{className:"ml-0.5 size-2 rounded-full bg-primary"})]})})}),(0,b.jsx)("p",{className:"text-muted-foreground text-nowrap text-xs font-normal opacity-70 transition-opacity group-hover:opacity-100",children:U(a.createdAt)})]}),(0,b.jsxs)("div",{className:"flex justify-between items-center gap-2",children:[(0,b.jsx)("p",{className:"mt-1 line-clamp-1 min-w-0 overflow-hidden text-sm text-muted-foreground flex-1",children:a.subject||a.preview||"No content"}),a.companyName&&(0,b.jsxs)("span",{className:"px-1.5 py-0.5 rounded text-[10px] bg-muted text-muted-foreground flex items-center gap-0.5 shrink-0",children:[(0,b.jsx)(k.Building2,{className:"h-2.5 w-2.5"}),a.companyName]})]})]})})]})]})},a.id)})}):(0,b.jsx)("div",{className:"flex items-center justify-center p-8 h-full",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(n.Mail,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"No communications found"}),y&&(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Try adjusting your search"})]})})})})})]})}),G?(0,b.jsx)("div",{className:(0,h.cn)("bg-card mb-1 shadow-sm flex flex-col min-w-0 overflow-hidden","w-full h-full","md:rounded-tl-2xl md:flex-1",G?"flex":"hidden md:flex"),children:(0,b.jsx)("div",{className:"relative flex-1 min-h-0 flex flex-col",children:(0,b.jsxs)("div",{className:"bg-card relative flex flex-col overflow-hidden transition-all duration-300 h-full flex-1 min-h-0",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-15 flex shrink-0 items-center justify-between gap-1.5 p-2 pb-0 transition-colors bg-card",children:[(0,b.jsx)("div",{className:"flex flex-1 items-center gap-2",children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",onClick:Q,className:"h-10 w-10 p-0 md:h-8 md:w-8",title:"Back to list",children:[(0,b.jsx)(j.ArrowLeft,{className:"h-5 w-5 md:hidden text-muted-foreground"}),(0,b.jsx)(z.X,{className:"h-4 w-4 hidden md:block text-muted-foreground"})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[("email"===G.type||"sms"===G.type||"ticket"===G.type)&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)(e.Button,{variant:"reply"===K?"default":"ghost",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-auto md:px-2",title:"Reply",onClick:()=>L("reply"===K?null:"reply"),children:[(0,b.jsx)(s,{className:"h-5 w-5 md:h-4 md:w-4 md:mr-1.5 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm leading-none font-medium hidden md:inline",children:"Reply"})]}),(0,b.jsxs)(B.DropdownMenu,{children:[(0,b.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-8",title:"More reply options",children:(0,b.jsx)(t,{className:"h-5 w-5 md:h-4 md:w-4 text-muted-foreground"})})}),(0,b.jsxs)(B.DropdownMenuContent,{align:"end",className:"w-40",children:[(0,b.jsxs)(B.DropdownMenuItem,{onClick:()=>L("reply"),children:[(0,b.jsx)(s,{className:"h-4 w-4 mr-2"}),"Reply"]}),(0,b.jsxs)(B.DropdownMenuItem,{onClick:()=>L("reply-all"),children:[(0,b.jsx)(t,{className:"h-4 w-4 mr-2"}),"Reply All"]}),(0,b.jsx)(B.DropdownMenuSeparator,{}),(0,b.jsxs)(B.DropdownMenuItem,{onClick:()=>L("forward"),children:[(0,b.jsx)(m,{className:"h-4 w-4 mr-2"}),"Forward"]})]})]})]}),(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-8 group/star",title:"Star",children:(0,b.jsx)(v,{className:"h-5 w-5 md:h-4 md:w-4 text-muted-foreground transition-colors group-hover/star:text-yellow-500"})}),(0,b.jsx)(e.Button,{variant:"destructive",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-8",title:"Archive",children:(0,b.jsx)(i.Archive,{className:"h-5 w-5 md:h-4 md:w-4"})}),(0,b.jsxs)(B.DropdownMenu,{children:[(0,b.jsx)(B.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(e.Button,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-8",title:"More",children:(0,b.jsx)(p.MoreHorizontal,{className:"h-5 w-5 md:h-4 md:w-4 text-muted-foreground"})})}),(0,b.jsx)(B.DropdownMenuContent,{align:"end",className:"w-48",children:(0,b.jsxs)(B.DropdownMenuItem,{className:"text-destructive focus:text-destructive",children:[(0,b.jsx)(x.Trash2,{className:"h-4 w-4 mr-2"}),"Delete"]})})]})]})]}),(0,b.jsx)("div",{className:"flex min-h-0 flex-1 flex-col overflow-y-auto",children:"sms"===G.type?(0,b.jsx)(av,{communication:G,className:"flex-1"}):(0,b.jsxs)("div",{className:"relative overflow-hidden flex-1 h-full min-h-0 flex flex-col",children:[(0,b.jsxs)("div",{className:"border-b border-border/50 px-4 py-4 space-y-3",children:[(0,b.jsx)("h1",{className:"text-base font-semibold text-foreground",children:G.subject||"No Subject"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(d.Avatar,{className:"h-9 w-9 shrink-0 rounded-md cursor-pointer",children:(0,b.jsx)(d.AvatarFallback,{className:"bg-muted text-muted-foreground font-semibold text-sm rounded-md",children:("inbound"===G.direction?G.from?.[0]:G.to?.[0])?.toUpperCase()||"?"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-semibold text-sm text-foreground",children:"inbound"===G.direction?G.from||"Unknown":G.to||"Unknown"}),("unread"===G.status||"new"===G.status)&&(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[(0,b.jsx)("span",{children:"inbound"===G.direction?`from ${G.from?.split("@")[0]||"unknown"}`:`to ${G.to?.split("@")[0]||"unknown"}`}),G.companyName&&(0,b.jsxs)(g.Badge,{variant:"outline",className:"gap-1",children:[(0,b.jsx)(k.Building2,{className:"h-2.5 w-2.5"}),G.companyName]})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsxs)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:[(o=new Date(G.createdAt),0===(q=Math.floor((new Date().getTime()-o.getTime())/864e5))?"Today":1===q?"Yesterday":q<7?o.toLocaleDateString([],{weekday:"short"}):o.toLocaleDateString([],{month:"short",day:"numeric"}))," at"," ",U(G.createdAt)]})})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[G.type&&(0,b.jsx)(g.Badge,{variant:"outline",className:"gap-1",children:T(G.type).label}),G.status&&(0,b.jsx)(g.Badge,{variant:"outline",className:"gap-1",children:G.status})]})]}),(0,b.jsx)("div",{className:"flex-1 px-4 py-4 overflow-y-auto",children:(0,b.jsx)("div",{className:"prose prose-sm max-w-none dark:prose-invert",children:(0,b.jsx)("p",{className:"whitespace-pre-wrap",children:G.preview||"No content"})})}),K&&("email"===G.type||"ticket"===G.type)&&(0,b.jsx)("div",{className:"border-t border-border/50 p-4",children:(0,b.jsx)(Y,{mode:K,selectedMessage:G,onClose:R,onSent:S})})]})})]})})}):(0,b.jsxs)("div",{className:(0,h.cn)("bg-card mb-1 shadow-sm hidden md:flex md:flex-col md:items-center md:justify-center md:rounded-tl-2xl md:flex-1"),children:[(0,b.jsx)(n.Mail,{className:"h-16 w-16 text-muted-foreground mb-4"}),(0,b.jsx)("h3",{className:"text-lg font-semibold",children:"No communication selected"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select a communication from the list to view details"})]})]})})}a.s(["AdminUnifiedInbox",()=>ay],69689)}];

//# sourceMappingURL=apps_admin_src_components_communication_admin-unified-inbox_tsx_3c1b294e._.js.map