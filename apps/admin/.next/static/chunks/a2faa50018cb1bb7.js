(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,80902,(e,s,a)=>{"use strict";Object.defineProperty(a,"__esModule",{value:!0});var t={callServer:function(){return l.callServer},createServerReference:function(){return n.createServerReference},findSourceMapURL:function(){return r.findSourceMapURL}};for(var i in t)Object.defineProperty(a,i,{enumerable:!0,get:t[i]});let l=e.r(41354),r=e.r(45714),n=e.r(2405)},10685,79254,e=>{"use strict";var s=e.i(83206);let a=(0,s.default)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);e.s(["ArrowLeft",()=>a],10685);let t=(0,s.default)("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);e.s(["Check",()=>t],79254)},36764,e=>{"use strict";let s=(0,e.i(83206).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>s],36764)},41304,e=>{"use strict";let s=(0,e.i(83206).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],41304)},54115,e=>{"use strict";let s=(0,e.i(83206).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>s],54115)},99168,e=>{"use strict";var s=e.i(5005);let a=e=>{let s,a=new Set,t=(e,t)=>{let i="function"==typeof e?e(s):e;if(!Object.is(i,s)){let e=s;s=(null!=t?t:"object"!=typeof i||null===i)?i:Object.assign({},s,i),a.forEach(a=>a(s,e))}},i=()=>s,l={setState:t,getState:i,getInitialState:()=>r,subscribe:e=>(a.add(e),()=>a.delete(e))},r=s=e(t,i,l);return l},t=e=>{let t=e?a(e):a,i=e=>(function(e,a=e=>e){let t=s.default.useSyncExternalStore(e.subscribe,s.default.useCallback(()=>a(e.getState()),[e,a]),s.default.useCallback(()=>a(e.getInitialState()),[e,a]));return s.default.useDebugValue(t),t})(t,e);return Object.assign(i,t),i},i=e=>e?t(e):t;e.s(["create",()=>i],99168)},67571,e=>{"use strict";let s=(0,e.i(83206).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>s],67571)},80063,e=>{"use strict";var s=e.i(15573),a=e.i(69962),t=e.i(5005),i=e.i(10685),l=e.i(73706);e.i(16233);var r=e.i(77607),n=e.i(83206);let c=(0,n.default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var d=e.i(79254),o=e.i(6661),m=e.i(41304),u=e.i(59586),x=e.i(54115),p=e.i(2424),h=e.i(67571),g=e.i(76389),j=e.i(36764),b=e.i(35613),f=e.i(80177),v=e.i(10120),N=e.i(89239),y=e.i(99168);let C={name:"",subject:"",previewText:"",audienceType:"waitlist",audienceFilter:{excludeUnsubscribed:!0,excludeBounced:!0,excludeComplained:!0},fromName:"Thorbis",fromEmail:"noreply@thorbis.com",tags:[]},S=(0,y.create)((e,s)=>({campaigns:[],setCampaigns:s=>e({campaigns:s}),addCampaign:s=>e(e=>({campaigns:[s,...e.campaigns]})),updateCampaign:(s,a)=>e(e=>({campaigns:e.campaigns.map(e=>e.id===s?{...e,...a}:e)})),removeCampaign:s=>e(e=>({campaigns:e.campaigns.filter(e=>e.id!==s),selectedCampaignId:e.selectedCampaignId===s?null:e.selectedCampaignId})),isLoading:!1,setIsLoading:s=>e({isLoading:s}),error:null,setError:s=>e({error:s}),selectedCampaignId:null,setSelectedCampaignId:s=>e({selectedCampaignId:s}),filters:{},setFilters:s=>e(e=>({filters:{...e.filters,...s}})),resetFilters:()=>e({filters:{}}),sortField:"createdAt",sortDirection:"desc",setSort:(s,a)=>e(e=>({sortField:s,sortDirection:a??(e.sortField===s&&"asc"===e.sortDirection?"desc":"asc")})),builder:{isOpen:!1,currentStep:"details",draft:{...C},isDirty:!1,validationErrors:{}},openBuilder:a=>{let{campaigns:t}=s(),i=a?t.find(e=>e.id===a):null;i?e({builder:{isOpen:!0,currentStep:"details",editingCampaignId:a,isDirty:!1,validationErrors:{},draft:{name:i.name,subject:i.subject,previewText:i.previewText||"",templateId:i.templateId,templateData:i.templateData,htmlContent:i.htmlContent,plainTextContent:i.plainTextContent,audienceType:i.audienceType,audienceFilter:i.audienceFilter||C.audienceFilter,fromName:i.fromName,fromEmail:i.fromEmail,replyTo:i.replyTo,tags:i.tags,notes:i.notes,scheduledFor:i.scheduledFor}}}):e({builder:{isOpen:!0,currentStep:"details",draft:{...C},isDirty:!1,validationErrors:{}}})},closeBuilder:()=>e({builder:{isOpen:!1,currentStep:"details",draft:{...C},isDirty:!1,validationErrors:{}}}),setBuilderStep:s=>e(e=>({builder:{...e.builder,currentStep:s}})),updateDraft:s=>e(e=>({builder:{...e.builder,draft:{...e.builder.draft,...s},isDirty:!0}})),setValidationErrors:s=>e(e=>({builder:{...e.builder,validationErrors:s}})),clearValidationError:s=>e(e=>{let{[s]:a,...t}=e.builder.validationErrors;return{builder:{...e.builder,validationErrors:t}}}),resetBuilder:()=>e({builder:{isOpen:!1,currentStep:"details",draft:{...C},isDirty:!1,validationErrors:{}}}),audiencePreview:{isLoading:!1,estimatedCount:0,sampleRecipients:[]},setAudiencePreview:s=>e(e=>({audiencePreview:{...e.audiencePreview,...s}})),resetAudiencePreview:()=>e({audiencePreview:{isLoading:!1,estimatedCount:0,sampleRecipients:[]}}),sendingProgress:null,setSendingProgress:s=>e({sendingProgress:s}),updateSendingProgress:s=>e(e=>({sendingProgress:e.sendingProgress?{...e.sendingProgress,...s}:null})),waitlistStats:null,setWaitlistStats:s=>e({waitlistStats:s}),activeTab:"campaigns",setActiveTab:s=>e({activeTab:s}),previewCampaignId:null,setPreviewCampaignId:s=>e({previewCampaignId:s}),deletingCampaignId:null,setDeletingCampaignId:s=>e({deletingCampaignId:s})}));var w=e.i(63942);let k=(0,n.default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);var T=e.i(1414);let L=[{id:"waitlist",label:"Waitlist Subscribers",description:"Send to everyone who signed up for the waitlist",icon:j.Clock,iconColor:"text-emerald-600",bgColor:"bg-emerald-500/10"},{id:"all_users",label:"All Platform Users",description:"Send to all registered users across all companies",icon:p.Users,iconColor:"text-blue-600",bgColor:"bg-blue-500/10"},{id:"all_companies",label:"All Companies",description:"Send to company owners/admins only",icon:w.Building2,iconColor:"text-purple-600",bgColor:"bg-purple-500/10"},{id:"segment",label:"Custom Segment",description:"Filter users or companies by specific criteria",icon:k,iconColor:"text-amber-600",bgColor:"bg-amber-500/10"},{id:"custom",label:"Custom Email List",description:"Enter specific email addresses manually",icon:u.Mail,iconColor:"text-gray-600",bgColor:"bg-gray-500/10"}];function E({value:e,filter:a,onChange:i,error:l}){let[r,n]=(0,t.useState)(a||{excludeUnsubscribed:!0,excludeBounced:!0,excludeComplained:!0}),[c,o]=(0,t.useState)(a?.customEmails?.join("\n")||""),{audiencePreview:x,setAudiencePreview:h}=S();(0,t.useEffect)(()=>{h({isLoading:!0});let s=setTimeout(()=>{h({isLoading:!1,estimatedCount:{waitlist:2156,all_users:8432,all_companies:342,segment:0,custom:c.split("\n").filter(e=>e.trim()).length}[e]||0,sampleRecipients:[{email:"john@example.com",name:"John Doe",type:e},{email:"jane@example.com",name:"Jane Smith",type:e},{email:"mike@example.com",name:"Mike Johnson",type:e}],lastUpdated:new Date().toISOString()})},500);return()=>clearTimeout(s)},[e,c,h]);let g=s=>{let a={...r,...s};n(a),i(e,a)};return(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"grid gap-3",children:L.map(a=>{let t=e===a.id,l=a.icon;return(0,s.jsxs)("button",{type:"button",className:(0,N.cn)("flex items-start gap-4 rounded-lg border p-4 text-left transition-colors",t?"border-primary bg-primary/5 ring-1 ring-primary":"hover:border-primary/50 hover:bg-muted/50"),onClick:()=>{i(a.id,r)},children:[(0,s.jsx)("div",{className:(0,N.cn)("rounded-lg p-2",a.bgColor),children:(0,s.jsx)(l,{className:(0,N.cn)("size-5",a.iconColor)})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("p",{className:"font-medium",children:a.label}),t&&(0,s.jsx)("div",{className:"rounded-full bg-primary p-0.5",children:(0,s.jsx)(d.Check,{className:"size-3 text-primary-foreground"})})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:a.description})]})]},a.id)})}),l&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:l}),"segment"===e&&(0,s.jsxs)("div",{className:"rounded-lg border p-4 space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Segment Filters"}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{className:"text-sm",children:"User Roles"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["owner","admin","manager","technician"].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2 rounded border px-3 py-1.5 text-sm cursor-pointer hover:bg-muted",children:[(0,s.jsx)(T.Checkbox,{checked:r.userRoles?.includes(e)||!1,onCheckedChange:s=>{let a=r.userRoles||[],t=s?[...a,e]:a.filter(s=>s!==e);g({userRoles:t.length>0?t:void 0})}}),(0,s.jsx)("span",{className:"capitalize",children:e})]},e))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{className:"text-sm",children:"Company Plans"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["starter","professional","enterprise"].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2 rounded border px-3 py-1.5 text-sm cursor-pointer hover:bg-muted",children:[(0,s.jsx)(T.Checkbox,{checked:r.companyPlans?.includes(e)||!1,onCheckedChange:s=>{let a=r.companyPlans||[],t=s?[...a,e]:a.filter(s=>s!==e);g({companyPlans:t.length>0?t:void 0})}}),(0,s.jsx)("span",{className:"capitalize",children:e})]},e))})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{className:"text-sm",children:"Company Status"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:["active","trial","suspended"].map(e=>(0,s.jsxs)("label",{className:"flex items-center gap-2 rounded border px-3 py-1.5 text-sm cursor-pointer hover:bg-muted",children:[(0,s.jsx)(T.Checkbox,{checked:r.companyStatuses?.includes(e)||!1,onCheckedChange:s=>{let a=r.companyStatuses||[],t=s?[...a,e]:a.filter(s=>s!==e);g({companyStatuses:t.length>0?t:void 0})}}),(0,s.jsx)("span",{className:"capitalize",children:e})]},e))})]})]})]}),"custom"===e&&(0,s.jsxs)("div",{className:"rounded-lg border p-4 space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Custom Email List"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enter email addresses, one per line"}),(0,s.jsx)("textarea",{className:"w-full min-h-[150px] rounded-md border bg-background px-3 py-2 text-sm font-mono",placeholder:"john@example.com\njane@example.com\nmike@example.com",value:c,onChange:e=>{var s;o(s=e.target.value),g({customEmails:s.split("\n").map(e=>e.trim()).filter(e=>e&&e.includes("@"))})}})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4 space-y-4",children:[(0,s.jsx)("h4",{className:"font-medium",children:"Exclusions"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)(T.Checkbox,{checked:!1!==r.excludeUnsubscribed,onCheckedChange:e=>g({excludeUnsubscribed:!0===e})}),(0,s.jsx)("span",{className:"text-sm",children:"Exclude unsubscribed contacts"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)(T.Checkbox,{checked:!1!==r.excludeBounced,onCheckedChange:e=>g({excludeBounced:!0===e})}),(0,s.jsx)("span",{className:"text-sm",children:"Exclude bounced emails"})]}),(0,s.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,s.jsx)(T.Checkbox,{checked:!1!==r.excludeComplained,onCheckedChange:e=>g({excludeComplained:!0===e})}),(0,s.jsx)("span",{className:"text-sm",children:"Exclude spam complaints"})]})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border bg-muted/30 p-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(p.Users,{className:"size-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm font-medium",children:"Estimated Recipients"})]}),x.isLoading?(0,s.jsx)(m.Loader2,{className:"size-4 animate-spin text-muted-foreground"}):(0,s.jsx)("span",{className:"text-lg font-bold",children:x.estimatedCount.toLocaleString()})]}),!x.isLoading&&x.sampleRecipients.length>0&&(0,s.jsxs)("div",{className:"mt-3 pt-3 border-t",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-2",children:"Sample recipients:"}),(0,s.jsx)("div",{className:"space-y-1",children:x.sampleRecipients.slice(0,3).map((e,a)=>(0,s.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,s.jsx)(u.Mail,{className:"size-3 text-muted-foreground"}),(0,s.jsx)("span",{children:e.email}),e.name&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:["(",e.name,")"]})]},a))})]})]})]})}let F=[{id:"details",label:"Details",icon:o.FileText},{id:"content",label:"Content",icon:u.Mail},{id:"audience",label:"Audience",icon:p.Users},{id:"review",label:"Review",icon:h.Eye}];function I({onSave:e,onSend:a,onSchedule:l,onCancel:n,isSubmitting:o=!1}){let{builder:u,setBuilderStep:p,updateDraft:h,setValidationErrors:j,clearValidationError:b}=S(),[f,v]=(0,t.useState)(""),[y,C]=(0,t.useState)("09:00"),{currentStep:w,draft:k,validationErrors:T,editingCampaignId:L}=u,E=F.findIndex(e=>e.id===w),I=(0,t.useCallback)(e=>{let s={};switch(e){case"details":k.name.trim()||(s.name="Campaign name is required"),k.subject.trim()||(s.subject="Subject line is required");break;case"content":k.htmlContent?.trim()||k.templateId||(s.content="Email content or template is required");break;case"audience":k.audienceType||(s.audienceType="Audience type is required")}return!(Object.keys(s).length>0)||(j(s),!1)},[k,j]),A=(0,t.useCallback)(()=>{if(!I(w))return;let e=E+1;e<F.length&&p(F[e].id)},[w,E,I,p]),M=(0,t.useCallback)(()=>{let e=E-1;e>=0&&p(F[e].id)},[E,p]),B=(0,t.useCallback)(e=>{F.findIndex(s=>s.id===e)<=E&&p(e)},[E,p]),U=(0,t.useCallback)(async()=>{e&&await e(k)},[k,e]),O=(0,t.useCallback)(async()=>{I("details")&&I("content")&&I("audience")&&a&&await a(k)},[k,a,I]),H=(0,t.useCallback)(async()=>{if(!I("details")||!I("content")||!I("audience"))return;if(!f)return void j({schedule:"Please select a date"});let e=`${f}T${y}:00.000Z`;l&&await l(k,e)},[k,l,f,y,I,j]);return(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[(0,s.jsx)("div",{className:"border-b px-6 py-4",children:(0,s.jsx)("div",{className:"flex items-center justify-between",children:F.map((e,a)=>{let t=e.id===w,i=a<E,l=a<=E,r=e.icon;return(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("button",{type:"button",className:(0,N.cn)("flex items-center gap-2 rounded-lg px-3 py-2 text-sm font-medium transition-colors",t&&"bg-primary text-primary-foreground",i&&!t&&"bg-emerald-100 text-emerald-700",!t&&!i&&"text-muted-foreground",l&&!t&&"hover:bg-muted cursor-pointer"),onClick:()=>B(e.id),disabled:!l,children:[i&&!t?(0,s.jsx)(d.Check,{className:"size-4"}):(0,s.jsx)(r,{className:"size-4"}),(0,s.jsx)("span",{className:"hidden sm:inline",children:e.label}),(0,s.jsx)("span",{className:"sm:hidden",children:a+1})]}),a<F.length-1&&(0,s.jsx)("div",{className:(0,N.cn)("mx-2 h-px w-8 sm:w-12",a<E?"bg-emerald-500":"bg-border")})]},e.id)})})}),(0,s.jsxs)("div",{className:"flex-1 overflow-auto p-6",children:["details"===w&&(0,s.jsx)(P,{draft:k,errors:T,onChange:h,onClearError:b}),"content"===w&&(0,s.jsx)(z,{draft:k,errors:T,onChange:h,onClearError:b}),"audience"===w&&(0,s.jsx)(R,{draft:k,errors:T,onChange:h,onClearError:b}),"review"===w&&(0,s.jsx)(D,{draft:k,scheduleDate:f,scheduleTime:y,onScheduleDateChange:v,onScheduleTimeChange:C,errors:T})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between border-t px-6 py-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[E>0&&(0,s.jsxs)(r.Button,{variant:"outline",onClick:M,disabled:o,children:[(0,s.jsx)(i.ArrowLeft,{className:"mr-2 size-4"}),"Back"]}),n&&(0,s.jsx)(r.Button,{variant:"ghost",onClick:n,disabled:o,children:"Cancel"})]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[e&&(0,s.jsxs)(r.Button,{variant:"outline",onClick:U,disabled:o,children:[o?(0,s.jsx)(m.Loader2,{className:"mr-2 size-4 animate-spin"}):null,"Save Draft"]}),"review"!==w?(0,s.jsxs)(r.Button,{onClick:A,disabled:o,children:["Next",(0,s.jsx)(c,{className:"ml-2 size-4"})]}):(0,s.jsxs)("div",{className:"flex gap-2",children:[l&&f&&(0,s.jsxs)(r.Button,{variant:"secondary",onClick:H,disabled:o,children:[o?(0,s.jsx)(m.Loader2,{className:"mr-2 size-4 animate-spin"}):(0,s.jsx)(g.Calendar,{className:"mr-2 size-4"}),"Schedule"]}),a&&(0,s.jsxs)(r.Button,{onClick:O,disabled:o,children:[o?(0,s.jsx)(m.Loader2,{className:"mr-2 size-4 animate-spin"}):(0,s.jsx)(x.Send,{className:"mr-2 size-4"}),"Send Now"]})]})]})]})]})}function P({draft:e,errors:a,onChange:t,onClearError:i}){return(0,s.jsxs)("div",{className:"mx-auto max-w-2xl space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Campaign Details"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set up the basic information for your campaign"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"name",children:"Campaign Name *"}),(0,s.jsx)(b.Input,{id:"name",placeholder:"e.g., Holiday Promotion 2024",value:e.name,onChange:e=>{t({name:e.target.value}),i("name")},className:a.name?"border-destructive":""}),a.name&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:a.name}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Internal name for organization (not shown to recipients)"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"subject",children:"Subject Line *"}),(0,s.jsx)(b.Input,{id:"subject",placeholder:"e.g., Special Holiday Offer Inside!",value:e.subject,onChange:e=>{t({subject:e.target.value}),i("subject")},className:a.subject?"border-destructive":""}),a.subject&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:a.subject}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[e.subject.length,"/60 characters recommended"]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"previewText",children:"Preview Text"}),(0,s.jsx)(b.Input,{id:"previewText",placeholder:"e.g., Get 20% off your next purchase...",value:e.previewText,onChange:e=>t({previewText:e.target.value})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Text shown after the subject in the inbox preview"})]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"fromName",children:"From Name"}),(0,s.jsx)(b.Input,{id:"fromName",placeholder:"Thorbis",value:e.fromName,onChange:e=>t({fromName:e.target.value})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"fromEmail",children:"From Email"}),(0,s.jsx)(b.Input,{id:"fromEmail",type:"email",placeholder:"hello@thorbis.com",value:e.fromEmail,onChange:e=>t({fromEmail:e.target.value})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"replyTo",children:"Reply-To Email"}),(0,s.jsx)(b.Input,{id:"replyTo",type:"email",placeholder:"support@thorbis.com (optional)",value:e.replyTo||"",onChange:e=>t({replyTo:e.target.value||void 0})})]})]})]})}function z({draft:e,errors:a,onChange:t,onClearError:i}){return(0,s.jsxs)("div",{className:"mx-auto max-w-3xl space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Email Content"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create your email content using HTML or select a template"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"rounded-lg border bg-muted/50 p-4",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Template library coming soon. For now, enter HTML content directly."})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"htmlContent",children:"HTML Content *"}),(0,s.jsx)(v.Textarea,{id:"htmlContent",placeholder:"<html><body><h1>Hello!</h1><p>Your email content here...</p></body></html>",value:e.htmlContent||"",onChange:e=>{t({htmlContent:e.target.value}),i("content")},className:(0,N.cn)("min-h-[300px] font-mono text-sm",a.content&&"border-destructive")}),a.content&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:a.content})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"plainTextContent",children:"Plain Text Version (optional)"}),(0,s.jsx)(v.Textarea,{id:"plainTextContent",placeholder:"Hello! Your email content here...",value:e.plainTextContent||"",onChange:e=>t({plainTextContent:e.target.value}),className:"min-h-[150px]"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Fallback for email clients that don't support HTML"})]})]})]})}function R({draft:e,errors:a,onChange:t,onClearError:i}){return(0,s.jsxs)("div",{className:"mx-auto max-w-2xl space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Select Audience"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose who will receive this campaign"})]}),(0,s.jsx)(E,{value:e.audienceType,filter:e.audienceFilter,onChange:(e,s)=>{t({audienceType:e,audienceFilter:s}),i("audienceType")},error:a.audienceType})]})}function D({draft:e,scheduleDate:a,scheduleTime:t,onScheduleDateChange:i,onScheduleTimeChange:l,errors:r}){return(0,s.jsxs)("div",{className:"mx-auto max-w-2xl space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Review & Send"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Review your campaign before sending"})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4 space-y-4",children:[(0,s.jsx)("h3",{className:"font-medium",children:"Campaign Summary"}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Campaign Name"}),(0,s.jsx)("p",{className:"font-medium",children:e.name||"—"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"From"}),(0,s.jsxs)("p",{className:"font-medium",children:[e.fromName," <",e.fromEmail,">"]})]}),(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Subject Line"}),(0,s.jsx)("p",{className:"font-medium",children:e.subject||"—"})]}),e.previewText&&(0,s.jsxs)("div",{className:"sm:col-span-2",children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Preview Text"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.previewText})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Audience"}),(0,s.jsx)("p",{className:"font-medium",children:{all_users:"All Users",all_companies:"All Companies",waitlist:"Waitlist Subscribers",segment:"Custom Segment",custom:"Custom List"}[e.audienceType]})]})]})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4 space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(j.Clock,{className:"size-4 text-muted-foreground"}),(0,s.jsx)("h3",{className:"font-medium",children:"Schedule (Optional)"})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Schedule this campaign for later, or send it immediately"}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"scheduleDate",children:"Date"}),(0,s.jsx)(b.Input,{id:"scheduleDate",type:"date",value:a,onChange:e=>i(e.target.value),min:new Date().toISOString().split("T")[0]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(f.Label,{htmlFor:"scheduleTime",children:"Time (UTC)"}),(0,s.jsx)(b.Input,{id:"scheduleTime",type:"time",value:t,onChange:e=>l(e.target.value)})]})]}),r.schedule&&(0,s.jsx)("p",{className:"text-sm text-destructive",children:r.schedule})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4 space-y-4",children:[(0,s.jsx)("h3",{className:"font-medium",children:"Email Preview"}),e.htmlContent?(0,s.jsx)("div",{className:"rounded border bg-white p-4",children:(0,s.jsx)("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.htmlContent}})}):(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"No content to preview"})]})]})}var A=e.i(80902),M=(0,A.createServerReference)("400403bb450c59f3dc1281ec17ff5b405bf16f0803",A.callServer,void 0,A.findSourceMapURL,"createCampaign"),B=(0,A.createServerReference)("406d12cccc4bf8889af742b3bed928745802a14be8",A.callServer,void 0,A.findSourceMapURL,"sendCampaign"),U=(0,A.createServerReference)("60ebdc09048a2877f279f11960034ee53b27f6c669",A.callServer,void 0,A.findSourceMapURL,"scheduleCampaign");function O(){let e=(0,a.useRouter)(),[n,c]=(0,t.useState)(!1),[d,o]=(0,t.useState)(null),{openBuilder:m,closeBuilder:u}=S();(0,t.useEffect)(()=>(m(),()=>u()),[m,u]);let x=(0,t.useCallback)(async s=>{c(!0),o(null);try{let a=await M(s);if(!a.success)return void o(a.error||"Failed to create campaign");a.data&&e.push(`/dashboard/marketing/campaigns/${a.data.id}`)}catch(e){console.error("Failed to save campaign:",e),o("An unexpected error occurred")}finally{c(!1)}},[e]),p=(0,t.useCallback)(async s=>{c(!0),o(null);try{let a=await M(s);if(!a.success||!a.data)return void o(a.error||"Failed to create campaign");let t=await B(a.data.id);if(!t.success){o(t.error||"Failed to send campaign"),e.push(`/dashboard/marketing/campaigns/${a.data.id}`);return}e.push(`/dashboard/marketing/campaigns/${a.data.id}`)}catch(e){console.error("Failed to send campaign:",e),o("An unexpected error occurred")}finally{c(!1)}},[e]),h=(0,t.useCallback)(async(s,a)=>{c(!0),o(null);try{let t=await M(s);if(!t.success||!t.data)return void o(t.error||"Failed to create campaign");let i=await U(t.data.id,a);if(!i.success){o(i.error||"Failed to schedule campaign"),e.push(`/dashboard/marketing/campaigns/${t.data.id}`);return}e.push(`/dashboard/marketing/campaigns/${t.data.id}`)}catch(e){console.error("Failed to schedule campaign:",e),o("An unexpected error occurred")}finally{c(!1)}},[e]),g=(0,t.useCallback)(()=>{e.push("/dashboard/marketing/campaigns")},[e]);return(0,s.jsxs)("div",{className:"flex h-full flex-col",children:[(0,s.jsxs)("div",{className:"flex items-center gap-4 border-b px-6 py-4",children:[(0,s.jsx)(r.Button,{variant:"ghost",size:"icon",asChild:!0,children:(0,s.jsx)(l.default,{href:"/dashboard/marketing/campaigns",children:(0,s.jsx)(i.ArrowLeft,{className:"size-4"})})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-lg font-semibold",children:"Create Campaign"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Build a new email marketing campaign"})]})]}),d&&(0,s.jsx)("div",{className:"mx-6 mt-4 rounded-lg border border-destructive/50 bg-destructive/10 p-4",children:(0,s.jsx)("p",{className:"text-sm text-destructive",children:d})}),(0,s.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,s.jsx)(I,{onSave:x,onSend:p,onSchedule:h,onCancel:g,isSubmitting:n})})]})}e.s(["default",()=>O],80063)}]);