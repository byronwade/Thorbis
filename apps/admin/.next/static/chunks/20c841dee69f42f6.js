(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,26359,e=>{"use strict";e.i(16233),e.s([])},69219,e=>{"use strict";let s=(0,e.i(83206).default)("ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);e.s(["Ticket",()=>s],69219)},54934,e=>{"use strict";e.i(16233),e.s([])},36764,e=>{"use strict";let s=(0,e.i(83206).default)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);e.s(["Clock",()=>s],36764)},41304,e=>{"use strict";let s=(0,e.i(83206).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>s],41304)},30754,7,e=>{"use strict";var s=e.i(83206);let t=(0,s.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],30754);let r=(0,s.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>r],7)},23202,e=>{"use strict";e.i(16233),e.s([])},65543,e=>{"use strict";var s=e.i(15573),t=e.i(5005),r=e.i(69962),a=e.i(36764),i=e.i(10575),l=e.i(69219),c=e.i(41304),n=e.i(30754),d=e.i(7);e.i(23202);var o=e.i(5278);e.i(26359);var m=e.i(63712);e.i(54934);var u=e.i(77607),x=e.i(96320),h=e.i(37947);function p({sessionId:e,companyId:p,companyName:f,ticketId:j,reason:g,requestedAt:v}){let b=(0,r.useRouter)(),[N,y]=(0,t.useState)("pending"),[k,w]=(0,t.useState)(""),[C,T]=(0,t.useState)(0);return((0,t.useEffect)(()=>{let e=()=>{let e=new Date,s=new Date(v),t=e.getTime()-s.getTime(),r=Math.floor(t/1e3/60),a=Math.floor(t/1e3%60);r>0?w(`${r}m ${a}s`):w(`${a}s`)};e();let s=setInterval(e,1e3);return()=>clearInterval(s)},[v]),(0,t.useEffect)(()=>{let s=async()=>{try{let s=function(){let e=x.default.env.ADMIN_SUPABASE_SERVICE_ROLE_KEY;if(!e)throw Error("Missing ADMIN_SUPABASE_SERVICE_ROLE_KEY environment variable. Get this from Supabase dashboard -> Settings -> API -> service_role key");return(0,h.createClient)("https://iwudmixxoozwskgolqlz.supabase.co",e,{auth:{autoRefreshToken:!1,persistSession:!1}})}(),{data:t,error:r}=await s.from("support_sessions").select("status, rejection_reason").eq("id",e).single();if(r)return void console.error("Error checking session status:",r);if(!t)return;T(e=>e+1),"active"===t.status&&(y("active"),setTimeout(()=>{b.push(`/admin/dashboard/view-as/${p}/work/jobs`)},1500)),"rejected"===t.status&&(y("rejected"),setTimeout(()=>{b.refresh()},1500))}catch(e){console.error("Error polling session status:",e)}};s();let t=setInterval(s,5e3);return()=>clearInterval(t)},[e,p,b]),"active"===N)?(0,s.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center space-y-4 animate-in fade-in zoom-in",children:[(0,s.jsx)("div",{className:"rounded-full bg-green-100 dark:bg-green-900/20 w-20 h-20 flex items-center justify-center mx-auto",children:(0,s.jsx)(n.CheckCircle,{className:"h-10 w-10 text-green-600 dark:text-green-400"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Access Approved!"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Redirecting to customer view..."})]})}):"rejected"===N?(0,s.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center space-y-4 animate-in fade-in zoom-in",children:[(0,s.jsx)("div",{className:"rounded-full bg-red-100 dark:bg-red-900/20 w-20 h-20 flex items-center justify-center mx-auto",children:(0,s.jsx)(d.XCircle,{className:"h-10 w-10 text-red-600 dark:text-red-400"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold",children:"Access Denied"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Customer declined the request..."})]})}):(0,s.jsx)("div",{className:"flex h-screen items-center justify-center p-6 bg-gradient-to-br from-background to-muted/20",children:(0,s.jsxs)(o.Card,{className:"max-w-2xl w-full shadow-lg",children:[(0,s.jsxs)(o.CardHeader,{className:"text-center space-y-4",children:[(0,s.jsxs)("div",{className:"mx-auto rounded-full bg-orange-100 dark:bg-orange-900/20 w-20 h-20 flex items-center justify-center relative",children:[(0,s.jsx)(i.Shield,{className:"h-10 w-10 text-orange-600 dark:text-orange-400"}),(0,s.jsx)("div",{className:"absolute inset-0 rounded-full border-2 border-orange-300 dark:border-orange-700 animate-ping"}),(0,s.jsx)("div",{className:"absolute inset-0 rounded-full border-2 border-orange-400 dark:border-orange-600 animate-pulse"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(o.CardTitle,{className:"text-3xl",children:"Waiting for Customer Approval"}),(0,s.jsx)(o.CardDescription,{className:"text-base",children:"The customer will see a notification in their account to approve or deny your access request."})]})]}),(0,s.jsxs)(o.CardContent,{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-6 space-y-4",children:[(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Company"}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:f})]}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Time Waiting"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(a.Clock,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("p",{className:"text-lg font-semibold font-mono",children:k})]})]})]}),j&&(0,s.jsxs)("div",{className:"flex items-center gap-2 pt-4 border-t",children:[(0,s.jsx)(l.Ticket,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Support Ticket:"}),(0,s.jsx)(m.Badge,{variant:"outline",className:"font-mono",children:j})]}),(0,s.jsxs)("div",{className:"space-y-2 pt-4 border-t",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Reason for Access"}),(0,s.jsx)("p",{className:"text-sm rounded-md border bg-background p-3",children:g})]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[(0,s.jsx)(c.Loader2,{className:"h-4 w-4 animate-spin"}),(0,s.jsxs)("span",{children:["Checking for approval... (",C," ",1===C?"check":"checks",")"]})]}),(0,s.jsxs)("div",{className:"rounded-lg border border-blue-200 dark:border-blue-800 bg-blue-50 dark:bg-blue-950/20 p-4 space-y-2",children:[(0,s.jsxs)("h3",{className:"font-medium text-blue-900 dark:text-blue-100 flex items-center gap-2",children:[(0,s.jsx)(i.Shield,{className:"h-4 w-4"}),"What Happens Next"]}),(0,s.jsxs)("ul",{className:"text-sm text-blue-800 dark:text-blue-200 space-y-1 list-disc list-inside",children:[(0,s.jsx)("li",{children:"The customer will see an approval modal in their dashboard"}),(0,s.jsx)("li",{children:"They can approve access for 30 minutes to 4 hours"}),(0,s.jsx)("li",{children:"Once approved, you'll be redirected automatically"}),(0,s.jsx)("li",{children:"If denied, you'll see the rejection reason"}),(0,s.jsx)("li",{children:"The session will expire if not approved within 24 hours"})]})]}),(0,s.jsx)("div",{className:"flex justify-center pt-4",children:(0,s.jsx)(u.Button,{variant:"outline",onClick:()=>b.push("/admin/dashboard/view-as"),className:"w-full sm:w-auto",children:"Cancel & Return to Companies"})})]})]})})}e.s(["PendingSessionClient",()=>p],65543)}]);