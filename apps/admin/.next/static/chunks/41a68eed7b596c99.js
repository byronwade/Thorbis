(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59586,e=>{"use strict";let t=(0,e.i(83206).default)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]]);e.s(["Mail",()=>t],59586)},76389,e=>{"use strict";let t=(0,e.i(83206).default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["Calendar",()=>t],76389)},8693,e=>{"use strict";var t=e.i(7284),r=e.i(23191);function a(...e){return(0,r.twMerge)((0,t.clsx)(e))}e.s(["cn",()=>a])},39397,e=>{"use strict";let t=(0,e.i(83206).default)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]]);e.s(["Phone",()=>t],39397)},9759,e=>{"use strict";var t=e.i(95403);function r(){return{toast:{success:(e,r)=>t.toast.success(e,{duration:3e3,...r}),error:(e,r)=>t.toast.error(e,{duration:5e3,...r}),loading:(e,r)=>t.toast.loading(e,r),info:(e,r)=>t.toast.info(e,{duration:3e3,...r}),warning:(e,r)=>t.toast.warning(e,{duration:4e3,...r}),promise:(e,r)=>t.toast.promise(e,r),dismiss:e=>{t.toast.dismiss(e)},fromActionResult:e=>{e.success?t.toast.success(e.message||"Operation completed successfully"):t.toast.error(e.error||"Operation failed")}}}}e.s(["useToast",()=>r])},11268,e=>{"use strict";e.i(16233),e.s([])},14435,e=>{"use strict";let t=(0,e.i(83206).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["User",()=>t],14435)},7205,e=>{"use strict";let t=(0,e.i(83206).default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);e.s(["ArrowUp",()=>t],7205)},60424,87268,e=>{"use strict";var t=e.i(83206);let r=(0,t.default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>r],60424);let a=(0,t.default)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]]);e.s(["Search",()=>a],87268)},18796,e=>{"use strict";let t=(0,e.i(83206).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["AlertCircle",()=>t],18796)},41304,e=>{"use strict";let t=(0,e.i(83206).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["Loader2",()=>t],41304)},99168,e=>{"use strict";var t=e.i(5005);let r=e=>{let t,r=new Set,a=(e,a)=>{let i="function"==typeof e?e(t):e;if(!Object.is(i,t)){let e=t;t=(null!=a?a:"object"!=typeof i||null===i)?i:Object.assign({},t,i),r.forEach(r=>r(t,e))}},i=()=>t,s={setState:a,getState:i,getInitialState:()=>n,subscribe:e=>(r.add(e),()=>r.delete(e))},n=t=e(a,i,s);return s},a=e=>{let a=e?r(e):r,i=e=>(function(e,r=e=>e){let a=t.default.useSyncExternalStore(e.subscribe,t.default.useCallback(()=>r(e.getState()),[e,r]),t.default.useCallback(()=>r(e.getInitialState()),[e,r]));return t.default.useDebugValue(a),a})(a,e);return Object.assign(i,a),i},i=e=>e?a(e):a;e.s(["create",()=>i],99168)},54115,e=>{"use strict";let t=(0,e.i(83206).default)("send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);e.s(["Send",()=>t],54115)},46672,e=>{"use strict";let t=(0,e.i(83206).default)("archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);e.s(["Archive",()=>t],46672)},64136,e=>{"use strict";let t=(0,e.i(83206).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["Edit",()=>t],64136)},67571,e=>{"use strict";let t=(0,e.i(83206).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["Eye",()=>t],67571)},30754,7,e=>{"use strict";var t=e.i(83206);let r=(0,t.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>r],30754);let a=(0,t.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>a],7)},71526,e=>{"use strict";let t=(0,e.i(83206).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],71526)},10267,e=>{"use strict";var t=e.i(15573),r=e.i(83206);let a=(0,r.default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),i=(0,r.default)("briefcase-business",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),s=(0,r.default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]),n=(0,r.default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);var l=e.i(73706),d=e.i(5005);e.i(26359);var o=e.i(63712);e.i(54934);var c=e.i(77607);e.i(16233);var u=e.i(999),m=e.i(91225),h=e.i(13532),x=e.i(5278),p=e.i(75308),f=e.i(89239);let g=(0,d.createContext)(null),b=(0,d.createContext)(null),y="kanban-column-";function v(e,t,r){let a=Object.fromEntries(e.map(e=>[e.id,[]]));return t.reduce((e,t)=>{let a=r(t);return e[a]||(e[a]=[]),e[a]=[...e[a],t],e},a)}function j({columns:e,data:r,onDataChange:a,onItemMove:i,getColumnId:s,children:n,className:l,pointerSensorOptions:o,renderDragOverlay:c}){let h=(0,d.useCallback)(s??(e=>e.columnId),[]),[p,b]=(0,d.useState)(()=>v(e,r,h)),[j,k]=(0,d.useState)(null),w=(0,d.useRef)(e);(0,d.useEffect)(()=>{w.current=e},[e]),(0,d.useEffect)(()=>{b(v(e,r,h))},[e,r,h]);let N=(0,u.useSensors)((0,u.useSensor)(u.PointerSensor,{activationConstraint:{distance:6},...o}),(0,u.useSensor)(u.KeyboardSensor,{coordinateGetter:m.sortableKeyboardCoordinates})),C=(0,d.useCallback)(e=>{for(let t of w.current){let r=p[t.id]??[],a=r.findIndex(t=>t.id===e);if(-1!==a)return{columnId:t.id,item:r[a],index:a}}return null},[p]),A=(0,d.useCallback)(e=>{let t=C(e.active.id);t&&k({item:t.item,columnId:t.columnId})},[C]),S=(0,d.useCallback)(e=>{var t;let{active:r,over:s}=e;if(k(null),!s)return;let n=C(r.id);if(!n)return;let l=null,d=null;if("string"==typeof s.id&&s.id.startsWith(y))d=(p[l=s.id.replace(y,"")]??[]).length;else{let e=C(s.id);e&&(l=e.columnId,d=(p[e.columnId]??[]).findIndex(t=>t.id===e.item.id))}if(null===l||null===d||l===n.columnId&&d===n.index)return;let o=Object.fromEntries(Object.entries(p).map(([e,t])=>[e,t.slice()])),c=o[n.columnId]??[],[u]=c.splice(n.index,1);o[n.columnId]=c;let m=o[l]??[],h=n.columnId===l&&n.index<d?d-1:d,x={...u,columnId:l};m.splice(h,0,x),o[l]=m,b(o);let f=(t=w.current,t.flatMap(e=>o[e.id]??[]));a?.(f),i&&i({item:x,fromColumnId:n.columnId,toColumnId:l,toIndex:h})},[C,p,a,i]),M=(0,d.useMemo)(()=>({columns:e,getItems:e=>p[e]??[],findItem:C,activeItem:j}),[e,p,C,j]);return(0,t.jsx)(g.Provider,{value:M,children:(0,t.jsxs)(u.DndContext,{collisionDetection:u.closestCorners,onDragCancel:()=>k(null),onDragEnd:S,onDragStart:A,sensors:N,children:[(0,t.jsx)("div",{className:(0,f.cn)("flex w-full gap-4 overflow-x-auto px-6 py-4 md:px-8 lg:px-10",l),children:n}),(0,t.jsx)(u.DragOverlay,{children:j?c?c(j.item):(0,t.jsx)(x.Card,{className:"border-border/70 bg-background/95 w-[280px] max-w-[320px] border p-3 shadow-lg",children:(0,t.jsx)("p",{className:"text-sm font-medium",children:String(j.item.id)})}):null})]})})}function k({column:e,children:r,className:a}){return(0,t.jsx)(b.Provider,{value:e,children:(0,t.jsx)("section",{"aria-label":`${e.name} column`,className:(0,f.cn)("kanban-column border-border/60 from-background via-background/60 to-muted/40 flex h-full min-w-[320px] flex-1 flex-col rounded-2xl border bg-gradient-to-b shadow-sm ring-1 ring-black/5 backdrop-blur-sm transition hover:shadow-md",a),children:r})})}function w({children:e,className:r}){return(0,t.jsx)("header",{className:(0,f.cn)("bg-background/90 sticky top-0 z-10 flex items-center justify-between gap-2 rounded-t-2xl px-4 py-3 backdrop-blur-sm",r),children:e})}function N({columnId:e,children:r,emptyState:a,className:i,height:s="28rem"}){let{getItems:n}=function(){let e=(0,d.useContext)(g);if(!e)throw Error("useKanbanContext must be used within a KanbanProvider");return e}(),l=n(e),{setNodeRef:o,isOver:c}=(0,u.useDroppable)({id:`${y}${e}`});return(0,t.jsx)(m.SortableContext,{items:l.map(e=>e.id),strategy:m.verticalListSortingStrategy,children:(0,t.jsx)(p.ScrollArea,{className:"kanban-scroll flex-1",children:(0,t.jsxs)("div",{className:(0,f.cn)("kanban-column-cards bg-muted/30 flex min-h-[120px] flex-col gap-3 rounded-2xl p-3 transition",c&&"ring-primary/60 ring-2 ring-offset-2",i),"data-drop-state":c?"active":"inactive",ref:o,style:{minHeight:s},children:[0===l.length&&a,l.map((e,t)=>r(e,t))]})})})}function C({itemId:e,children:r,className:a}){let{attributes:i,listeners:s,setNodeRef:n,transform:l,transition:d,isDragging:o}=(0,m.useSortable)({id:e}),c={transform:h.CSS.Transform.toString(l),transition:d};return(0,t.jsx)(x.Card,{className:(0,f.cn)("border-border/70 bg-background/95 focus-visible:ring-ring grid gap-3 rounded-xl border p-4 text-left shadow-sm ring-0 transition-all outline-none hover:-translate-y-0.5 hover:shadow-md focus-visible:ring-2",o&&"border-primary/60 scale-[1.01] opacity-80 shadow-lg",a),"data-dragging":o?"":void 0,ref:n,style:c,...s,...i,children:r})}function A({data:e,columns:r,mapToKanbanItem:a,updateEntityStatus:i,renderCard:s,renderDragOverlay:n,calculateColumnMeta:l,onItemMove:c,entityName:u="items",emptyStateMessage:m,showTotals:h=!1,formatTotal:x}){let[p,f]=(0,d.useState)(()=>e.map(a)),g=l||((e,t)=>({count:t.filter(t=>t.columnId===e).length})),b=(0,d.useMemo)(()=>{let e={};return r.forEach(t=>{e[t.id]=g(t.id,p)}),e},[r,p,g]),y=(0,d.useMemo)(()=>r.map(e=>({id:e.id,name:e.name,accentColor:e.accentColor})),[r]),v=m||(e=>`No ${u} in ${e}`);return(0,t.jsx)(j,{className:"pb-4",columns:y,data:p,onDataChange:e=>{i?f(e.map(e=>({...e,entity:i(e.entity,e.columnId)}))):f(e)},onItemMove:c,renderDragOverlay:n||(e=>(0,t.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg",children:s(e)})),children:r.map(e=>{let r=b[e.id]??{count:0};return(0,t.jsxs)(k,{className:"min-h-[300px] flex-1",column:y.find(t=>t.id===e.id),children:[(0,t.jsx)(w,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{"aria-hidden":"true",className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:e.accentColor}}),(0,t.jsx)("span",{className:"text-foreground text-sm font-semibold",children:e.name}),(0,t.jsxs)(o.Badge,{className:"bg-muted text-muted-foreground rounded-full px-2 py-0 text-xs font-medium",variant:"secondary",children:[r.count," ",u]}),h&&void 0!==r.total&&x&&(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:x(r.total)}),h&&void 0!==r.value&&x&&(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:x(r.value)})]})}),(0,t.jsx)(N,{className:"min-h-[200px]",columnId:e.id,emptyState:(0,t.jsx)("div",{className:"border-border/60 bg-background/60 text-muted-foreground rounded-xl border border-dashed p-4 text-center text-xs",children:v(e.name)}),children:e=>(0,t.jsx)(C,{itemId:e.id,children:s(e)},e.id)})]},e.id)})})}var S=e.i(9759);e.i(38717);var M=e.i(71509),I=e.i(8693);let D=[{id:"quoted",name:"Quoted",accentColor:"#6B7280"},{id:"scheduled",name:"Scheduled",accentColor:"#2563EB"},{id:"in_progress",name:"In Progress",accentColor:"#F97316"},{id:"on_hold",name:"On Hold",accentColor:"#F59E0B"},{id:"completed",name:"Completed",accentColor:"#22C55E"},{id:"cancelled",name:"Cancelled",accentColor:"#EF4444"}],P=new Map(D.map(e=>[e.id,e.name])),z="quoted";function _({priority:e}){let{label:r,className:a}={low:{label:"Low",className:"border-primary/60 bg-primary/60 text-primary dark:border-primary/40 dark:bg-primary/40 dark:text-primary"},medium:{label:"Medium",className:"border-warning/60 bg-warning/60 text-warning dark:border-warning/40 dark:bg-warning/40 dark:text-warning"},high:{label:"High",className:"border-warning/60 bg-warning/60 text-warning dark:border-warning/40 dark:bg-warning/40 dark:text-warning"},urgent:{label:"Urgent",className:"border-destructive/60 bg-destructive/60 text-destructive dark:border-destructive/40 dark:bg-destructive/40 dark:text-destructive"}}[e??"medium"];return(0,t.jsx)(o.Badge,{className:(0,I.cn)("text-xs font-medium",a),variant:"outline",children:r})}function T({item:e}){let r=e.entity,d=e.columnId,u=r.scheduledStart?(0,M.formatDateRange)(r.scheduledStart,r.scheduledEnd??void 0):null,m=function(e){let t=e.properties;if(!t)return null;let r=[t.address],a=[t.city,t.state].filter(Boolean).join(", ");return a&&r.push(a),r.filter(Boolean).join(" • ")}(r);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)(l.default,{className:"text-muted-foreground hover:text-primary block text-xs font-semibold tracking-wide uppercase",href:`/dashboard/work/${r.id}`,children:String(r.jobNumber??"—")}),(0,t.jsx)("h3",{className:"text-foreground text-sm leading-snug font-semibold",children:r.title??"Untitled Job"}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[r.jobType&&(0,t.jsx)(o.Badge,{className:"bg-primary/10 text-primary",variant:"secondary",children:r.jobType}),(0,t.jsx)(_,{priority:r.priority??"medium"}),"number"==typeof r.aiPriorityScore&&(0,t.jsxs)(o.Badge,{className:"border-primary/40 bg-primary/5 text-primary border-dashed",variant:"outline",children:["AI Score ",r.aiPriorityScore]})]})]}),(0,t.jsx)("span",{className:"text-foreground text-sm font-semibold",children:(0,M.formatCurrency)(r.totalAmount)})]}),r.description&&(0,t.jsx)("p",{className:"text-muted-foreground line-clamp-3 text-xs",children:r.description}),(0,t.jsxs)("div",{className:"text-muted-foreground space-y-2 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(i,{className:"text-primary size-4"}),(0,t.jsx)("span",{className:"text-foreground font-medium",children:function(e){let t=e.customers;if(!t)return"Unassigned customer";if(t.display_name)return t.display_name;let r=[t.first_name,t.last_name].filter(Boolean);return r.length>0?r.join(" "):t.company_name||"Unassigned customer"}(r)})]}),m&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n,{className:"text-primary size-4"}),(0,t.jsx)("span",{children:m})]}),u&&(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(s,{className:"text-primary size-4"}),(0,t.jsx)("span",{children:u})]})]}),(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center justify-between pt-2 text-[11px] tracking-wide",children:[(0,t.jsxs)("span",{children:["Updated ",(0,M.formatDate)(r.updatedAt,{preset:"short"})]}),(0,t.jsx)("span",{className:"uppercase",children:d?P.get(d)??d:"—"})]}),(0,t.jsx)("div",{className:"flex items-center justify-end pt-1",children:(0,t.jsx)(c.Button,{asChild:!0,className:"text-primary gap-1 text-xs",size:"sm",variant:"ghost",children:(0,t.jsxs)(l.default,{href:`/dashboard/work/${r.id}`,children:["View",(0,t.jsx)(a,{className:"size-3.5"})]})})})]})}function E({jobs:r}){let{toast:a}=(0,S.useToast)(),[i,s]=(0,d.useTransition)(),n=async({item:t,fromColumnId:r,toColumnId:i})=>{r!==i&&s(()=>{(async()=>{let{updateJobStatus:r}=await e.A(80931),s=await r(t.entity.id,i);if(!s.success)return a.error("Unable to move job",{description:s.error});a.success(`Job ${t.entity.jobNumber} moved to ${P.get(i)}`)})()})};return(0,t.jsx)(A,{calculateColumnMeta:(e,t)=>{let r=t.filter(t=>t.columnId===e),a=r.reduce((e,t)=>e+(t.entity.totalAmount??0),0);return{count:r.length,total:a}},columns:D,data:r,entityName:"jobs",formatTotal:e=>(0,M.formatCurrency)(e),mapToKanbanItem:e=>{var t;return{id:e.id,columnId:(t=e.status)&&P.has(t)?t:z,entity:e}},onItemMove:n,renderCard:e=>(0,t.jsx)(T,{item:e}),renderDragOverlay:e=>(0,t.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-md border p-3 shadow-lg",children:(0,t.jsx)(T,{item:e})}),showTotals:!0,updateEntityStatus:(e,t)=>({...e,status:t})})}e.s(["JobsKanban",()=>E],10267)},55029,e=>{"use strict";var t=e.i(15573),r=e.i(46672),a=e.i(83206);let i=(0,a.default)("briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);var s=e.i(64136),n=e.i(67571),l=e.i(6661),d=e.i(71526),o=e.i(73706),c=e.i(5005);let u=(0,a.default)("info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var m=e.i(59586),h=e.i(39397),x=e.i(14435);e.i(54934);var p=e.i(77607);e.i(16233);var f=e.i(22608);e.i(11268);var g=e.i(71056);function b(e,t){if(!e)return t||"Unknown Customer";if(e.display_name)return e.display_name;let r=e.first_name?.trim(),a=e.last_name?.trim();return r&&a?`${r} ${a}`:r||a||(e.company_name?e.company_name:e.email?e.email:t||"Unknown Customer")}function y({customer:e}){let r=b(e);return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"bg-primary/10 flex h-10 w-10 items-center justify-center rounded-full shrink-0",children:(0,t.jsx)(x.User,{className:"text-primary h-5 w-5"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"font-semibold text-sm",children:r}),e.company_name&&(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:e.company_name})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[e.email&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)(m.Mail,{className:"h-3.5 w-3.5 text-muted-foreground shrink-0"}),(0,t.jsx)("a",{href:`mailto:${e.email}`,className:"text-primary hover:underline truncate",onClick:e=>e.stopPropagation(),children:e.email})]}),e.phone&&(0,t.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,t.jsx)(h.Phone,{className:"h-3.5 w-3.5 text-muted-foreground shrink-0"}),(0,t.jsx)("a",{href:`tel:${e.phone}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:e.phone})]})]})]})}function v({customer:e,className:r}){let[a,i]=(0,c.useState)(!1),s=b(e);return(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(f.HoverCard,{children:[(0,t.jsx)(f.HoverCardTrigger,{asChild:!0,children:(0,t.jsxs)(o.default,{href:`/dashboard/customers/${e.id}`,onClick:e=>e.stopPropagation(),className:"text-sm hover:underline hover:text-primary flex items-center gap-1.5 truncate",children:[(0,t.jsx)(x.User,{className:"h-3.5 w-3.5 shrink-0 text-muted-foreground"}),(0,t.jsx)("span",{className:"truncate",children:s})]})}),(0,t.jsx)(f.HoverCardContent,{className:"w-80",align:"start",children:(0,t.jsx)(y,{customer:e})})]}),(0,t.jsxs)(g.Popover,{open:a,onOpenChange:i,children:[(0,t.jsx)(g.PopoverTrigger,{asChild:!0,children:(0,t.jsx)(p.Button,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 shrink-0","aria-label":`View ${s} contact information`,onClick:e=>e.stopPropagation(),children:(0,t.jsx)(u,{className:"h-3.5 w-3.5 text-muted-foreground"})})}),(0,t.jsx)(g.PopoverContent,{className:"w-80",align:"start",children:(0,t.jsx)(y,{customer:e})})]})]})}var j=e.i(60648),k=e.i(16199),w=e.i(22942);e.i(76820);var N=e.i(94712);e.i(38717);var C=e.i(71509),A=e.i(99168),S=e.i(81403);let M={team_members:"active",customers:"active",jobs:"active",equipment:"active",materials:"active",payments:"active",invoices:"active",estimates:"active",contracts:"active",purchase_orders:"active",service_agreements:"active",maintenance_plans:"active",appointments:"active",properties:"active"},I=(0,A.create)()((0,S.devtools)((0,S.persist)((e,t)=>({filters:{...M},setFilter:(t,r)=>e(e=>({filters:{...e.filters,[t]:r}})),getFilter:e=>t().filters[e]||"active",resetFilter:t=>e(e=>({filters:{...e.filters,[t]:"active"}})),resetAllFilters:()=>e({filters:{...M}})}),{name:"archive-filters",skipHydration:!0,partialize:e=>({filters:e.filters})}),{name:"ArchiveStore"}));function D({jobs:a,itemsPerPage:u=50,totalCount:m,currentPage:h=1,onJobClick:x,showRefresh:f=!1,initialSearchQuery:g=""}){let y=I(e=>e.filters.jobs),[A,S]=(0,c.useState)(!1),[M,D]=(0,c.useState)(null),[P,z]=(0,c.useState)(!1),[_,T]=(0,c.useState)(new Set),E=a.filter(e=>{let t=!!(e.archived_at??e.deleted_at);return"active"===y?!t:"archived"!==y||t}),O=[{key:"jobNumber",header:"Job Number",width:"w-36",shrink:!0,render:e=>(0,t.jsx)(o.default,{className:"text-foreground hover:text-primary text-sm font-medium transition-colors hover:underline",href:`/dashboard/work/${e.id}`,onClick:e=>e.stopPropagation(),children:e.jobNumber??"—"})},{key:"title",header:"Title",width:"flex-1",render:e=>(0,t.jsxs)(o.default,{className:"block min-w-0",href:`/dashboard/work/${e.id}`,onClick:e=>e.stopPropagation(),children:[(0,t.jsx)("div",{className:"truncate text-sm leading-tight font-medium hover:underline",children:e.title??"Untitled Job"}),e.description?(0,t.jsx)("div",{className:"text-muted-foreground mt-0.5 truncate text-xs leading-tight",children:e.description}):null]})},{key:"customer",header:"Customer",width:"w-48",shrink:!0,hideOnMobile:!0,hideable:!0,render:e=>{let r=e.customer||e.customers;return r?(b(r),(0,t.jsx)(v,{customer:r})):(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"—"})}},{key:"status",header:"Status",width:"w-32",shrink:!0,hideable:!1,render:e=>(0,t.jsx)(N.JobStatusBadge,{status:e.status??"quoted"})},{key:"priority",header:"Priority",width:"w-28",shrink:!0,hideOnMobile:!0,hideable:!0,render:e=>(0,t.jsx)(N.PriorityBadge,{priority:e.priority??"medium"})},{key:"scheduledStart",header:"Scheduled",width:"w-32",shrink:!0,hideOnMobile:!0,hideable:!0,render:e=>(0,t.jsx)("span",{className:"text-muted-foreground text-sm tabular-nums",children:(0,C.formatDate)(e.scheduledStart??null,"short")})},{key:"totalAmount",header:"Amount",width:"w-32",shrink:!0,align:"right",hideable:!1,render:e=>(0,t.jsx)("span",{className:"font-semibold tabular-nums",children:(0,C.formatCurrency)(e.totalAmount||0,{decimals:2})})},{key:"actions",header:"",width:"w-10",shrink:!0,render:e=>(0,t.jsx)(w.RowActionsDropdown,{actions:[{label:"View Details",icon:n.Eye,href:`/dashboard/work/${e.id}`},{label:"Edit Job",icon:s.Edit,href:`/dashboard/work/${e.id}/edit`},{label:"Create Invoice",icon:l.FileText,href:`/dashboard/work/invoices/new?jobId=${e.id}`,separatorBefore:!0},{label:"Archive Job",icon:r.Archive,variant:"destructive",separatorBefore:!0,onClick:()=>{D(e.id),S(!0)}}]})}],$=[{label:"Archive Selected",icon:(0,t.jsx)(r.Archive,{className:"h-4 w-4"}),onClick:e=>{T(e),z(!0)},variant:"destructive"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.FullWidthDataTable,{bulkActions:$,columns:O,data:E,totalCount:m,currentPageFromServer:h,initialSearchQuery:g,serverPagination:!0,emptyAction:(0,t.jsxs)(p.Button,{onClick:()=>{window.location.href="/dashboard/work/new"},size:"sm",children:[(0,t.jsx)(d.Plus,{className:"mr-2 size-4"}),"Add Job"]}),emptyIcon:(0,t.jsx)(i,{className:"text-muted-foreground h-8 w-8"}),emptyMessage:"No jobs found",enableSelection:!0,entity:"jobs",getItemId:e=>e.id,isArchived:e=>!!(e.archived_at??e.deleted_at),itemsPerPage:u,onRefresh:()=>{window.location.reload()},onRowClick:e=>{x?x(e):window.location.href=`/dashboard/work/${e.id}`},serverSearch:!0,searchParamKey:"search",searchPlaceholder:"Search jobs by customer, category, equipment, service type...",showArchived:"active"!==y,showRefresh:f}),(0,t.jsx)(j.AlertDialog,{onOpenChange:S,open:A,children:(0,t.jsxs)(j.AlertDialogContent,{children:[(0,t.jsxs)(j.AlertDialogHeader,{children:[(0,t.jsx)(j.AlertDialogTitle,{children:"Archive Job?"}),(0,t.jsx)(j.AlertDialogDescription,{children:"This job will be archived and can be restored within 90 days."})]}),(0,t.jsxs)(j.AlertDialogFooter,{children:[(0,t.jsx)(j.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(j.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{if(M){let{archiveJob:t}=await e.A(80931);(await t(M)).success&&window.location.reload()}},children:"Archive"})]})]})}),(0,t.jsx)(j.AlertDialog,{onOpenChange:z,open:P,children:(0,t.jsxs)(j.AlertDialogContent,{children:[(0,t.jsxs)(j.AlertDialogHeader,{children:[(0,t.jsxs)(j.AlertDialogTitle,{children:["Archive ",_.size," Job(s)?"]}),(0,t.jsxs)(j.AlertDialogDescription,{children:[_.size," job(s) will be archived and can be restored within 90 days."]})]}),(0,t.jsxs)(j.AlertDialogFooter,{children:[(0,t.jsx)(j.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(j.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{let{archiveJob:t}=await e.A(80931),r=0;for(let e of _)(await t(e)).success&&r++;r>0&&window.location.reload()},children:"Archive"})]})]})})]})}e.s(["JobsTable",()=>D],55029)},87156,e=>{"use strict";var t=e.i(15573),r=e.i(5005),a=e.i(99168),i=e.i(81403);let s={jobs:"table",appointments:"table",payments:"table",estimates:"table",invoices:"table",contracts:"table",maintenancePlans:"table",materials:"table",purchaseOrders:"table",serviceAgreements:"table",equipment:"table",teams:"table",customers:"table",vendors:"table"},n=(0,a.create)()((0,i.devtools)((0,i.persist)((e,t)=>({...{views:{...s},setView:()=>{},getView:()=>"table",reset:()=>{}},setView:(t,r)=>e(e=>({views:{...e.views,[t]:r}})),getView:e=>t().views[e]??"table",reset:()=>e({views:{...s}})}),{name:"work-view-preferences",partialize:e=>({views:e.views}),skipHydration:!0}),{name:"WorkViewStore"}));function l({section:e,table:a,kanban:i,fallback:s=null,forceView:l}){let d,o=n(t=>t.views[e]??"table"),c=(d=n(e=>e.setView),t=>d(e,t)),u=l??o;return((0,r.useEffect)(()=>{l&&o!==l&&c(l)},[l]),"kanban"===u)?(0,t.jsx)(t.Fragment,{children:i??s}):(0,t.jsx)(t.Fragment,{children:a??s})}e.s(["WorkDataView",()=>l],87156)},80931,e=>{e.v(t=>Promise.all(["static/chunks/849552c5d5e9040e.js"].map(t=>e.l(t))).then(()=>t(47756)))}]);