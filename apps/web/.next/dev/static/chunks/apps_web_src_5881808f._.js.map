{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/ui/alert.tsx"],"sourcesContent":["// Re-export from @stratos/ui package\nexport * from \"@stratos/ui\";\n"],"names":[],"mappings":"AAAA,qCAAqC;;AACrC"}},
    {"offset": {"line": 15, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/hooks/use-schedule-keyboard-shortcuts.ts"],"sourcesContent":["\"use client\";\n\nimport { useRouter } from \"next/navigation\";\nimport { useEffect } from \"react\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\n\n/**\n * Keyboard shortcuts for the schedule view:\n * - T: Go to today\n * - N: New job (navigates to /dashboard/work/new)\n * - [: Previous period\n * - ]: Next period\n * - 1: Timeline/Day view\n * - 2: Monthly view\n * - 3: Kanban/Status board view\n */\nexport function useScheduleKeyboardShortcuts() {\n\tconst router = useRouter();\n\tconst { goToToday, navigatePrevious, navigateNext, setViewMode } =\n\t\tuseScheduleViewStore();\n\n\tuseEffect(() => {\n\t\tconst handleKeyDown = (event: KeyboardEvent) => {\n\t\t\t// Ignore if user is typing in an input, textarea, or contenteditable\n\t\t\tconst target = event.target as HTMLElement;\n\t\t\tif (\n\t\t\t\ttarget.tagName === \"INPUT\" ||\n\t\t\t\ttarget.tagName === \"TEXTAREA\" ||\n\t\t\t\ttarget.isContentEditable\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Ignore if any modifier keys are pressed (except shift for some cases)\n\t\t\tif (event.ctrlKey || event.metaKey || event.altKey) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (event.key.toLowerCase()) {\n\t\t\t\tcase \"t\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tgoToToday();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"n\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\trouter.push(\"/dashboard/work/new\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"[\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tnavigatePrevious();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"]\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tnavigateNext();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"1\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetViewMode(\"day\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"2\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetViewMode(\"month\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"3\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetViewMode(\"week\"); // week = kanban view\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener(\"keydown\", handleKeyDown);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"keydown\", handleKeyDown);\n\t\t};\n\t}, [goToToday, navigatePrevious, navigateNext, setViewMode, router]);\n}\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;AAJA;;;;AAgBO,SAAS;;IACf,MAAM,SAAS,IAAA,yTAAS;IACxB,MAAM,EAAE,SAAS,EAAE,gBAAgB,EAAE,YAAY,EAAE,WAAW,EAAE,GAC/D,IAAA,2LAAoB;IAErB,IAAA,iVAAS;kDAAC;YACT,MAAM;wEAAgB,CAAC;oBACtB,qEAAqE;oBACrE,MAAM,SAAS,MAAM,MAAM;oBAC3B,IACC,OAAO,OAAO,KAAK,WACnB,OAAO,OAAO,KAAK,cACnB,OAAO,iBAAiB,EACvB;wBACD;oBACD;oBAEA,wEAAwE;oBACxE,IAAI,MAAM,OAAO,IAAI,MAAM,OAAO,IAAI,MAAM,MAAM,EAAE;wBACnD;oBACD;oBAEA,OAAQ,MAAM,GAAG,CAAC,WAAW;wBAC5B,KAAK;4BACJ,MAAM,cAAc;4BACpB;4BACA;wBAED,KAAK;4BACJ,MAAM,cAAc;4BACpB,OAAO,IAAI,CAAC;4BACZ;wBAED,KAAK;4BACJ,MAAM,cAAc;4BACpB;4BACA;wBAED,KAAK;4BACJ,MAAM,cAAc;4BACpB;4BACA;wBAED,KAAK;4BACJ,MAAM,cAAc;4BACpB,YAAY;4BACZ;wBAED,KAAK;4BACJ,MAAM,cAAc;4BACpB,YAAY;4BACZ;wBAED,KAAK;4BACJ,MAAM,cAAc;4BACpB,YAAY,SAAS,qBAAqB;4BAC1C;wBAED;4BACC;oBACF;gBACD;;YAEA,SAAS,gBAAgB,CAAC,WAAW;YAErC;0DAAO;oBACN,SAAS,mBAAmB,CAAC,WAAW;gBACzC;;QACD;iDAAG;QAAC;QAAW;QAAkB;QAAc;QAAa;KAAO;AACpE;GArEgB;;QACA,yTAAS;QAEvB,2LAAoB"}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/lib/schedule-bootstrap.ts"],"sourcesContent":["import type {\n\tCustomer,\n\tJob,\n\tRecurrenceRule,\n\tTechnician,\n\tTechnicianSchedule,\n} from \"@/components/schedule/schedule-types\";\nimport type { UnassignedJobsMeta } from \"@/lib/schedule/types\";\n\nexport type SerializedRecurrenceRule = Omit<RecurrenceRule, \"endDate\"> & {\n\tendDate?: string;\n};\n\nexport type SerializedCustomer = Omit<Customer, \"createdAt\" | \"updatedAt\"> & {\n\tcreatedAt: string;\n\tupdatedAt: string;\n};\n\nexport type SerializedTechnicianSchedule = Omit<\n\tTechnicianSchedule,\n\t\"daysOff\"\n> & {\n\tdaysOff: string[];\n};\n\nexport type SerializedTechnician = Omit<\n\tTechnician,\n\t\"createdAt\" | \"updatedAt\" | \"schedule\"\n> & {\n\tcreatedAt: string;\n\tupdatedAt: string;\n\tschedule: SerializedTechnicianSchedule;\n};\n\nexport type SerializedJob = Omit<\n\tJob,\n\t| \"startTime\"\n\t| \"endTime\"\n\t| \"createdAt\"\n\t| \"updatedAt\"\n\t| \"customer\"\n\t| \"recurrence\"\n> & {\n\tstartTime: string;\n\tendTime: string;\n\tcreatedAt: string;\n\tupdatedAt: string;\n\tcustomer: SerializedCustomer;\n\trecurrence?: SerializedRecurrenceRule;\n};\n\nexport type ScheduleBootstrapSerialized = {\n\tcompanyId: string;\n\trange: {\n\t\tstart: string;\n\t\tend: string;\n\t};\n\tlastSync: string;\n\tjobs: SerializedJob[];\n\ttechnicians: SerializedTechnician[];\n\tunassignedMeta?: UnassignedJobsMeta;\n};\n\nexport type ScheduleHydrationPayload = {\n\tcompanyId: string;\n\trange: {\n\t\tstart: Date;\n\t\tend: Date;\n\t};\n\tlastSync: Date;\n\tjobs: Job[];\n\ttechnicians: Technician[];\n\tunassignedMeta?: UnassignedJobsMeta;\n};\n\nexport function serializeScheduleBootstrap(\n\tpayload: ScheduleHydrationPayload,\n): ScheduleBootstrapSerialized {\n\treturn {\n\t\tcompanyId: payload.companyId,\n\t\trange: {\n\t\t\tstart: payload.range.start.toISOString(),\n\t\t\tend: payload.range.end.toISOString(),\n\t\t},\n\t\tlastSync: payload.lastSync.toISOString(),\n\t\tjobs: payload.jobs.map(serializeJob),\n\t\ttechnicians: payload.technicians.map(serializeTechnician),\n\t\tunassignedMeta: payload.unassignedMeta,\n\t};\n}\n\nexport function deserializeScheduleBootstrap(\n\tpayload: ScheduleBootstrapSerialized,\n): ScheduleHydrationPayload {\n\treturn {\n\t\tcompanyId: payload.companyId,\n\t\trange: {\n\t\t\tstart: new Date(payload.range.start),\n\t\t\tend: new Date(payload.range.end),\n\t\t},\n\t\tlastSync: new Date(payload.lastSync),\n\t\tjobs: payload.jobs.map(deserializeJob),\n\t\ttechnicians: payload.technicians.map(deserializeTechnician),\n\t\tunassignedMeta: payload.unassignedMeta,\n\t};\n}\n\nexport function serializeJob(job: Job): SerializedJob {\n\treturn {\n\t\t...job,\n\t\tstartTime: job.startTime.toISOString(),\n\t\tendTime: job.endTime.toISOString(),\n\t\tcreatedAt: job.createdAt.toISOString(),\n\t\tupdatedAt: job.updatedAt.toISOString(),\n\t\tcustomer: {\n\t\t\t...job.customer,\n\t\t\tcreatedAt: job.customer.createdAt.toISOString(),\n\t\t\tupdatedAt: job.customer.updatedAt.toISOString(),\n\t\t},\n\t\trecurrence: job.recurrence\n\t\t\t? serializeRecurrence(job.recurrence)\n\t\t\t: undefined,\n\t};\n}\n\nexport function deserializeJob(job: SerializedJob): Job {\n\treturn {\n\t\t...job,\n\t\tstartTime: new Date(job.startTime),\n\t\tendTime: new Date(job.endTime),\n\t\tcreatedAt: new Date(job.createdAt),\n\t\tupdatedAt: new Date(job.updatedAt),\n\t\tcustomer: {\n\t\t\t...job.customer,\n\t\t\tcreatedAt: new Date(job.customer.createdAt),\n\t\t\tupdatedAt: new Date(job.customer.updatedAt),\n\t\t},\n\t\trecurrence: job.recurrence\n\t\t\t? deserializeRecurrence(job.recurrence)\n\t\t\t: undefined,\n\t};\n}\n\nfunction serializeTechnician(technician: Technician): SerializedTechnician {\n\treturn {\n\t\t...technician,\n\t\tcreatedAt: technician.createdAt.toISOString(),\n\t\tupdatedAt: technician.updatedAt.toISOString(),\n\t\tschedule: serializeTechnicianSchedule(technician.schedule),\n\t};\n}\n\nfunction deserializeTechnician(technician: SerializedTechnician): Technician {\n\treturn {\n\t\t...technician,\n\t\tcreatedAt: new Date(technician.createdAt),\n\t\tupdatedAt: new Date(technician.updatedAt),\n\t\tschedule: deserializeTechnicianSchedule(technician.schedule),\n\t};\n}\n\nfunction serializeTechnicianSchedule(\n\tschedule: TechnicianSchedule,\n): SerializedTechnicianSchedule {\n\treturn {\n\t\t...schedule,\n\t\tdaysOff: schedule.daysOff.map((date) => date.toISOString()),\n\t};\n}\n\nfunction deserializeTechnicianSchedule(\n\tschedule: SerializedTechnicianSchedule,\n): TechnicianSchedule {\n\treturn {\n\t\t...schedule,\n\t\tdaysOff: schedule.daysOff.map((value) => new Date(value)),\n\t};\n}\n\nfunction serializeRecurrence(\n\trecurrence: RecurrenceRule,\n): SerializedRecurrenceRule {\n\treturn {\n\t\t...recurrence,\n\t\tendDate: recurrence.endDate ? recurrence.endDate.toISOString() : undefined,\n\t};\n}\n\nfunction deserializeRecurrence(\n\trecurrence: SerializedRecurrenceRule,\n): RecurrenceRule {\n\treturn {\n\t\t...recurrence,\n\t\tendDate: recurrence.endDate ? new Date(recurrence.endDate) : undefined,\n\t};\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 219, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/schedule-types.ts"],"sourcesContent":["// ============================================\n// CORE DATA TYPES\n// ============================================\n\nexport type Address = {\n\tstreet: string;\n\tcity: string;\n\tstate: string;\n\tzip: string;\n\tcountry: string;\n};\n\nexport type Location = {\n\taddress: Address;\n\tcoordinates: {\n\t\tlat: number;\n\t\tlng: number;\n\t};\n\tplaceId?: string; // Google Places ID\n};\n\nexport type Customer = {\n\tid: string;\n\tname: string;\n\temail?: string;\n\tphone?: string;\n\tcompany?: string;\n\tlocation: Location;\n\tnotes?: string;\n\tcreatedAt: Date;\n\tupdatedAt: Date;\n};\n\nexport type RecurrenceRule = {\n\tfrequency: \"daily\" | \"weekly\" | \"monthly\" | \"yearly\";\n\tinterval: number; // Every N days/weeks/months/years\n\tendDate?: Date;\n\tcount?: number; // Stop after N occurrences\n\tdaysOfWeek?: number[]; // 0-6 (Sunday-Saturday)\n\tdayOfMonth?: number; // 1-31\n\tmonthOfYear?: number; // 1-12\n};\n\nexport type JobMetadata = {\n\testimatedDuration?: number; // minutes\n\tactualDuration?: number; // minutes\n\tmaterials?: string[];\n\tnotes?: string;\n\tinternalNotes?: string;\n\tattachments?: string[]; // URLs\n\ttags?: string[];\n\tcustomFields?: Record<string, any>;\n};\n\nexport type JobAssignmentRole = \"primary\" | \"assistant\" | \"crew\" | \"supervisor\";\n\nexport type JobAssignment = {\n\ttechnicianId: string | null;\n\tteamMemberId?: string | null;\n\tdisplayName: string;\n\tavatar?: string | null;\n\trole: JobAssignmentRole;\n\tstatus?: Technician[\"status\"];\n\tisActive: boolean;\n};\n\nexport type JobType =\n\t| \"service\"\n\t| \"service_call\"\n\t| \"repair\"\n\t| \"installation\"\n\t| \"maintenance\"\n\t| \"premium_maintenance\"\n\t| \"inspection\"\n\t| \"emergency\"\n\t| \"estimate\"\n\t| \"callback\"\n\t| \"other\";\n\n// Appointment category for visual differentiation (meeting vs job vs event)\nexport type AppointmentCategory = \"job\" | \"meeting\" | \"event\";\n\n// Maps database appointment types to display categories\nexport function getAppointmentCategory(\n\ttype?: string | null,\n\tallDay?: boolean,\n): AppointmentCategory {\n\t// All-day appointments are events\n\tif (allDay) return \"event\";\n\n\tswitch (type?.toLowerCase()) {\n\t\tcase \"meeting\":\n\t\tcase \"appointment\":\n\t\tcase \"follow_up\":\n\t\tcase \"consultation\":\n\t\tcase \"call\":\n\t\t\treturn \"meeting\";\n\t\tcase \"event\":\n\t\tcase \"training\":\n\t\tcase \"conference\":\n\t\tcase \"holiday\":\n\t\t\treturn \"event\";\n\t\tcase \"job\":\n\t\tcase \"service\":\n\t\tcase \"repair\":\n\t\tcase \"installation\":\n\t\tcase \"maintenance\":\n\t\tcase \"inspection\":\n\t\tcase \"estimate\":\n\t\tcase \"callback\":\n\t\tdefault:\n\t\t\treturn \"job\";\n\t}\n}\n\nexport type Job = {\n\tid: string; // Schedule ID\n\tjobId?: string; // Actual job ID (for linking to job details)\n\ttechnicianId: string; // Primary technician id (falls back to first assignment or empty string)\n\tassignments: JobAssignment[];\n\tisUnassigned: boolean;\n\n\t// Job details\n\ttitle: string;\n\tdescription?: string;\n\tjobType?: JobType;\n\tappointmentType?: string; // Raw type from appointments table (job, appointment, meeting, etc.)\n\tappointmentCategory?: AppointmentCategory; // Derived: job | meeting | event\n\tcustomer: Customer;\n\tlocation: Location;\n\n\t// Scheduling\n\tstartTime: Date;\n\tendTime: Date;\n\tallDay?: boolean; // For meetings, events\n\n\t// Status\n\tstatus:\n\t\t| \"scheduled\"\n\t\t| \"dispatched\"\n\t\t| \"arrived\"\n\t\t| \"in-progress\"\n\t\t| \"closed\"\n\t\t| \"completed\"\n\t\t| \"cancelled\";\n\tpriority: \"low\" | \"medium\" | \"high\" | \"urgent\";\n\n\t// Recurrence\n\trecurrence?: RecurrenceRule;\n\tparentJobId?: string; // For recurring job instances\n\n\t// Metadata\n\tmetadata: JobMetadata;\n\n\t// Audit\n\tcreatedAt: Date;\n\tupdatedAt: Date;\n\tcreatedBy?: string;\n\tupdatedBy?: string;\n};\n\nexport type TechnicianSchedule = {\n\tavailableHours: {\n\t\tstart: number; // 0-23\n\t\tend: number; // 0-23\n\t};\n\tdaysOff: Date[];\n\tbreakTimes?: Array<{\n\t\tstart: number; // minutes from day start\n\t\tend: number;\n\t}>;\n};\n\nexport type Technician = {\n\tid: string;\n\tuserId?: string;\n\tteamMemberId?: string;\n\tname: string;\n\temail?: string;\n\tphone?: string;\n\tavatar?: string;\n\tcolor?: string;\n\n\t// Employment\n\trole: string;\n\tdepartment?: string;\n\tskills?: string[];\n\tcertifications?: string[];\n\n\t// Status\n\tstatus: \"available\" | \"on-job\" | \"on-break\" | \"offline\";\n\tisActive?: boolean;\n\tcurrentLocation?: Location;\n\n\t// Schedule\n\tschedule: TechnicianSchedule;\n\n\t// Audit\n\tcreatedAt: Date;\n\tupdatedAt: Date;\n};\n\n// ============================================\n// LEGACY COMPATIBILITY (for migration)\n// ============================================\n\n/** @deprecated Use Job with Date objects instead */\nexport type LegacyJob = {\n\tid: string;\n\ttitle: string;\n\tcustomer: string;\n\tstartTime: string; // HH:MM format\n\tendTime: string; // HH:MM format\n\tstatus: \"scheduled\" | \"in-progress\" | \"completed\" | \"cancelled\";\n\tpriority: \"low\" | \"medium\" | \"high\" | \"urgent\";\n\tlocation: string;\n\taddress: string;\n\tlat: number;\n\tlng: number;\n\tdescription?: string;\n\testimatedDuration?: string;\n};\n\n"],"names":[],"mappings":"AAAA,+CAA+C;AAC/C,kBAAkB;AAClB,+CAA+C;;;;;AAiFxC,SAAS,uBACf,IAAoB,EACpB,MAAgB;IAEhB,kCAAkC;IAClC,IAAI,QAAQ,OAAO;IAEnB,OAAQ,MAAM;QACb,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACJ,OAAO;QACR,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACJ,OAAO;QACR,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL;YACC,OAAO;IACT;AACD"}},
    {"offset": {"line": 260, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/lib/schedule-data.ts"],"sourcesContent":["import { cache } from \"react\";\nimport type { SupabaseClient } from \"@supabase/supabase-js\";\nimport { addDays, subDays } from \"date-fns\";\nimport {\n\ttype Job,\n\ttype JobAssignment,\n\ttype Technician,\n\tgetAppointmentCategory,\n} from \"@/components/schedule/schedule-types\";\nimport type { UnassignedJobsMeta } from \"@/lib/schedule/types\";\nimport type { ScheduleHydrationPayload } from \"@/lib/schedule-bootstrap\";\nimport type { Database } from \"@/types/supabase\";\n\ntype Tables = Database[\"public\"][\"Tables\"];\n\ntype ScheduleRow = Tables[\"appointments\"][\"Row\"];\ntype CustomerRow = Tables[\"customers\"][\"Row\"];\ntype PropertyRow = Tables[\"properties\"][\"Row\"];\ntype JobRow = Tables[\"jobs\"][\"Row\"];\ntype TeamMemberRow = Tables[\"team_members\"][\"Row\"];\ntype JobTeamAssignmentRow = Tables[\"job_team_assignments\"][\"Row\"];\ntype JobRecord = Tables[\"jobs\"][\"Row\"];\n\ntype JobCustomer = Pick<\n\tCustomerRow,\n\t| \"id\"\n\t| \"first_name\"\n\t| \"last_name\"\n\t| \"email\"\n\t| \"phone\"\n\t| \"created_at\"\n\t| \"updated_at\"\n>;\n\ntype JobRowWithRelations = JobRecord & {\n\tcustomer?: JobCustomer | JobCustomer[] | null;\n\tproperty?: ScheduleProperty | ScheduleProperty[] | null;\n\tjob_team_assignments?: Array<\n\t\tJobTeamAssignmentRow & {\n\t\t\tteam_member: TeamMemberRow | null;\n\t\t}\n\t> | null;\n};\n\nexport type ScheduleRecord = ScheduleRow & {\n\tcustomer: Pick<\n\t\tCustomerRow,\n\t\t\"id\" | \"first_name\" | \"last_name\" | \"email\" | \"phone\"\n\t> | null;\n\tjob:\n\t\t| (JobRow & {\n\t\t\t\tjob_team_assignments: Array<\n\t\t\t\t\tJobTeamAssignmentRow & {\n\t\t\t\t\t\tteam_member: TeamMemberRow | null;\n\t\t\t\t\t}\n\t\t\t\t> | null;\n\t\t  })\n\t\t| null;\n};\n\ntype ScheduleProperty = Pick<\n\tPropertyRow,\n\t| \"id\"\n\t| \"name\"\n\t| \"address\"\n\t| \"address2\"\n\t| \"city\"\n\t| \"state\"\n\t| \"zip_code\"\n\t| \"country\"\n\t| \"lat\"\n\t| \"lon\"\n>;\n\ntype Range = {\n\tstart: Date;\n\tend: Date;\n};\n\ntype LoadParams = {\n\tsupabase: SupabaseClient<Database>;\n\tcompanyId: string;\n\trange?: Range;\n\tunscheduledLimit?: number;\n\tunscheduledOffset?: number;\n\tunscheduledSearch?: string;\n};\n\ntype TeamMemberRecord = TeamMemberRow & {\n\tusers: {\n\t\tid: string;\n\t\tname: string | null;\n\t\temail: string | null;\n\t\tphone: string | null;\n\t\tavatar: string | null;\n\t} | null;\n};\n\nexport type TechniciansLookup = {\n\ttechnicians: Technician[];\n\tbyId: Map<string, Technician>;\n\tbyUserId: Map<string, Technician>;\n\tbyTeamMemberId: Map<string, Technician>;\n};\n\nconst UNASSIGNED_TECHNICIAN_ID = \"__unassigned\";\n\n// Retry utility with exponential backoff for resilient data fetching\ntype RetryOptions = {\n\tmaxRetries?: number;\n\tinitialDelay?: number;\n\tmaxDelay?: number;\n\tbackoffFactor?: number;\n\tshouldRetry?: (error: unknown) => boolean;\n};\n\nconst DEFAULT_RETRY_OPTIONS: Required<RetryOptions> = {\n\tmaxRetries: 3,\n\tinitialDelay: 500,\n\tmaxDelay: 5000,\n\tbackoffFactor: 2,\n\tshouldRetry: (error) => {\n\t\t// Retry on network errors, timeouts, and server errors (5xx)\n\t\tif (error instanceof Error) {\n\t\t\tconst message = error.message.toLowerCase();\n\t\t\treturn (\n\t\t\t\tmessage.includes(\"network\") ||\n\t\t\t\tmessage.includes(\"timeout\") ||\n\t\t\t\tmessage.includes(\"connection\") ||\n\t\t\t\tmessage.includes(\"fetch failed\") ||\n\t\t\t\tmessage.includes(\"econnreset\") ||\n\t\t\t\tmessage.includes(\"500\") ||\n\t\t\t\tmessage.includes(\"502\") ||\n\t\t\t\tmessage.includes(\"503\") ||\n\t\t\t\tmessage.includes(\"504\")\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t},\n};\n\nasync function withRetry<T>(\n\tfn: () => Promise<T>,\n\tcontext: string,\n\toptions: RetryOptions = {},\n): Promise<T> {\n\tconst opts = { ...DEFAULT_RETRY_OPTIONS, ...options };\n\tlet lastError: unknown;\n\tlet delay = opts.initialDelay;\n\n\tfor (let attempt = 0; attempt <= opts.maxRetries; attempt++) {\n\t\ttry {\n\t\t\treturn await fn();\n\t\t} catch (error) {\n\t\t\tlastError = error;\n\n\t\t\tif (attempt === opts.maxRetries || !opts.shouldRetry(error)) {\n\t\t\t\tconsole.error(\n\t\t\t\t\t`[Schedule] ${context} failed after ${attempt + 1} attempt(s):`,\n\t\t\t\t\terror instanceof Error ? error.message : String(error),\n\t\t\t\t);\n\t\t\t\tthrow error;\n\t\t\t}\n\n\t\t\tconsole.warn(\n\t\t\t\t`[Schedule] ${context} attempt ${attempt + 1} failed, retrying in ${delay}ms...`,\n\t\t\t\terror instanceof Error ? error.message : String(error),\n\t\t\t);\n\n\t\t\tawait new Promise((resolve) => setTimeout(resolve, delay));\n\t\t\tdelay = Math.min(delay * opts.backoffFactor, opts.maxDelay);\n\t\t}\n\t}\n\n\tthrow lastError;\n}\n\nconst scheduleSelect = `\n  *,\n  customer:customers(\n    id,\n    first_name,\n    last_name,\n    email,\n    phone\n  ),\n  job:jobs(\n    id,\n    job_number,\n    title,\n    job_type,\n    company_id,\n    job_team_assignments:job_team_assignments!job_team_assignments_job_id_fkey(\n      id,\n      role,\n      team_member_id,\n      removed_at,\n      team_member:team_members(\n        id,\n        company_id,\n        status,\n        job_title,\n        department,\n        archived_at,\n        user_id,\n        phone,\n        email,\n        invited_name,\n        created_at,\n        updated_at\n      )\n    )\n  )\n`;\n\nconst UNSCHEDULED_JOBS_SELECT = `\n  *,\n  customer:customers!customer_id(\n    id,\n    first_name,\n    last_name,\n    email,\n    phone,\n    created_at,\n    updated_at\n  ),\n  property:properties!property_id(\n    id,\n    name,\n    address,\n    address2,\n    city,\n    state,\n    zip_code,\n    country,\n    lat,\n    lon\n  ),\n  job_team_assignments:job_team_assignments!job_team_assignments_job_id_fkey(\n    id,\n    role,\n    team_member_id,\n    removed_at,\n    team_member:team_members(\n      id,\n      company_id,\n      status,\n      job_title,\n      department,\n      archived_at,\n      user_id,\n      phone,\n      email,\n      invited_name,\n      created_at,\n      updated_at\n    )\n  )\n`;\n\nconst DEFAULT_TECHNICIAN_COLOR = \"#3B82F6\";\n\nconst DEFAULT_SCHEDULE = {\n\tworkingHours: { start: \"08:00\", end: \"17:00\" },\n\tdaysOff: [] as Date[],\n\tavailableHours: { start: 0, end: 40 },\n};\n\nconst DEFAULT_LOCATION = {\n\taddress: {\n\t\tstreet: \"\",\n\t\tcity: \"\",\n\t\tstate: \"\",\n\t\tzip: \"\",\n\t\tcountry: \"\",\n\t},\n\tcoordinates: {\n\t\tlat: 0,\n\t\tlng: 0,\n\t},\n};\n\nconst DEFAULT_UNSCHEDULED_DURATION_MINUTES = 60;\nconst DEFAULT_UNSCHEDULED_PAGE_SIZE = 50;\n\ntype UnscheduledQueryOptions = {\n\tlimit?: number;\n\toffset?: number;\n\tsearch?: string;\n};\n\nexport async function fetchScheduleData({\n\tsupabase,\n\tcompanyId,\n\trange,\n\tunscheduledLimit = DEFAULT_UNSCHEDULED_PAGE_SIZE,\n\tunscheduledOffset = 0,\n\tunscheduledSearch = \"\",\n}: LoadParams): Promise<{\n\tjobs: Job[];\n\ttechnicians: Technician[];\n\tunassignedMeta: UnassignedJobsMeta;\n}> {\n\tconst scheduleQuery = supabase\n\t\t.from(\"appointments\")\n\t\t.select(scheduleSelect)\n\t\t.eq(\"company_id\", companyId)\n\t\t.is(\"deleted_at\", null)\n\t\t.is(\"archived_at\", null)\n\t\t.order(\"start_time\", { ascending: true });\n\n\tif (range) {\n\t\tscheduleQuery.lte(\"start_time\", range.end.toISOString());\n\t\tscheduleQuery.gte(\"end_time\", range.start.toISOString());\n\t}\n\n\t// Fetch all three queries in parallel with retry logic (eliminates waterfall)\n\tlet scheduleResult;\n\tlet teamMembers;\n\tlet unscheduledResult;\n\n\ttry {\n\t\t[scheduleResult, teamMembers, unscheduledResult] = await withRetry(\n\t\t\t() =>\n\t\t\t\tPromise.all([\n\t\t\t\t\tscheduleQuery,\n\t\t\t\t\tfetchTeamMembersWithUsers(supabase, companyId),\n\t\t\t\t\tfetchUnscheduledJobs(supabase, companyId, {\n\t\t\t\t\t\tlimit: unscheduledLimit,\n\t\t\t\t\t\toffset: unscheduledOffset,\n\t\t\t\t\t\tsearch: unscheduledSearch,\n\t\t\t\t\t}),\n\t\t\t\t]),\n\t\t\t\"fetchScheduleData parallel queries\",\n\t\t);\n\t} catch (error) {\n\t\tconsole.error(\"[Schedule] Failed to fetch schedule data:\", error);\n\t\tthrow new Error(\n\t\t\t`Schedule data query failed: ${error instanceof Error ? error.message : String(error)}`,\n\t\t);\n\t}\n\n\tconst scheduleRows = scheduleResult.data ?? [];\n\tconst scheduleError = scheduleResult.error;\n\n\tif (scheduleError) {\n\t\tconsole.error(\"Appointments query error:\", scheduleError);\n\t\tthrow new Error(`Appointments query failed: ${scheduleError.message}`);\n\t}\n\n\tconst scheduledJobIds = new Set(\n\t\tscheduleRows\n\t\t\t.map((row) => (row as ScheduleRow).job_id)\n\t\t\t.filter((id): id is string => Boolean(id)),\n\t);\n\n\tconst unscheduledJobRows = unscheduledResult.rows.filter(\n\t\t(row) => !scheduledJobIds.has(row.id),\n\t);\n\tconst unscheduledMeta = {\n\t\ttotalCount: unscheduledResult.totalCount,\n\t\thasMore: unscheduledResult.hasMore,\n\t\tfetchedCount: unscheduledResult.rows.length,\n\t};\n\n\tlet propertyMap;\n\ttry {\n\t\tpropertyMap = await withRetry(\n\t\t\t() =>\n\t\t\t\tfetchPropertiesByIds(\n\t\t\t\t\tsupabase,\n\t\t\t\t\tcollectPropertyIds(scheduleRows as ScheduleRow[], unscheduledJobRows),\n\t\t\t\t),\n\t\t\t\"fetchPropertiesByIds\",\n\t\t);\n\t} catch (error) {\n\t\tconsole.error(\"[Schedule] Failed to fetch properties:\", error);\n\t\t// Return empty map as fallback - jobs will still work but without property details\n\t\tpropertyMap = new Map<string, ScheduleProperty>();\n\t}\n\n\tconst technicianLookups = mapTeamMembersToTechnicians(teamMembers);\n\n\tconst normalizedSchedules = scheduleRows as unknown as ScheduleRecord[];\n\n\tconst scheduledJobs = normalizedSchedules.map((schedule) =>\n\t\tmapScheduleToJob(\n\t\t\tschedule,\n\t\t\ttechnicianLookups,\n\t\t\tpropertyMap.get(schedule.property_id ?? \"\") ?? null,\n\t\t),\n\t);\n\n\tconst unscheduledJobs = unscheduledJobRows.map((jobRow) =>\n\t\tmapJobRowToUnscheduledJob(\n\t\t\tjobRow,\n\t\t\ttechnicianLookups,\n\t\t\tpropertyMap.get(jobRow.property_id ?? \"\") ?? null,\n\t\t),\n\t);\n\n\tconst jobs = [...scheduledJobs, ...unscheduledJobs];\n\n\treturn {\n\t\tjobs,\n\t\ttechnicians: technicianLookups.technicians,\n\t\tunassignedMeta: {\n\t\t\tlimit: unscheduledLimit,\n\t\t\tnextOffset: unscheduledOffset + unscheduledMeta.fetchedCount,\n\t\t\thasMore: unscheduledMeta.hasMore,\n\t\t\tsearch: unscheduledSearch,\n\t\t\ttotalCount: unscheduledMeta.totalCount,\n\t\t},\n\t};\n}\n\nfunction resolveScheduleRange(\n\trange?: Range,\n\tanchor: Date = new Date(),\n): Range {\n\tif (range) {\n\t\treturn range;\n\t}\n\n\tconst start = subDays(anchor, 7);\n\tconst end = addDays(anchor, 30);\n\treturn { start, end };\n}\n\nasync function loadScheduleSnapshot(\n\tparams: LoadParams & { range?: Range },\n): Promise<ScheduleHydrationPayload> {\n\tconst resolvedRange = resolveScheduleRange(params.range);\n\tconst { jobs, technicians, unassignedMeta } = await fetchScheduleData({\n\t\t...params,\n\t\trange: resolvedRange,\n\t});\n\n\treturn {\n\t\tcompanyId: params.companyId,\n\t\trange: resolvedRange,\n\t\tlastSync: new Date(),\n\t\tjobs,\n\t\ttechnicians,\n\t\tunassignedMeta,\n\t};\n}\n\nfunction createTechnicianJobMap(jobs: Job[]): Record<string, Job[]> {\n\treturn jobs.reduce<Record<string, Job[]>>((acc, job) => {\n\t\tconst key = job.technicianId || UNASSIGNED_TECHNICIAN_ID;\n\t\tif (!acc[key]) {\n\t\t\tacc[key] = [];\n\t\t}\n\t\tacc[key].push(job);\n\t\treturn acc;\n\t}, {});\n}\n\n// Optimized: Single query with join instead of N+1 pattern\nasync function fetchTeamMembersWithUsers(\n\tsupabase: SupabaseClient<Database>,\n\tcompanyId: string,\n): Promise<TeamMemberRecord[]> {\n\t// Use a single query with left join to profiles via user_id\n\tconst { data: membersWithUsers, error } = await supabase\n\t\t.from(\"company_memberships\")\n\t\t.select(`\n\t\t\t*,\n\t\t\tusers:profiles!company_memberships_profile_id_fkey(\n\t\t\t\tid,\n\t\t\t\tfull_name,\n\t\t\t\temail,\n\t\t\t\tphone,\n\t\t\t\tavatar_url\n\t\t\t)\n\t\t`)\n\t\t.eq(\"company_id\", companyId)\n\t\t.eq(\"status\", \"active\")\n\t\t.is(\"archived_at\", null);\n\n\tif (error) {\n\t\t// Fallback to the old two-query approach if join fails\n\t\tconsole.warn(\"Join query failed, falling back to sequential queries:\", error.message);\n\t\treturn fetchTeamMembersWithUsersFallback(supabase, companyId);\n\t}\n\n\treturn (membersWithUsers ?? []).map((member) => ({\n\t\t...member,\n\t\tusers: member.users ? {\n\t\t\tid: member.users.id,\n\t\t\tname: member.users.full_name,\n\t\t\temail: member.users.email,\n\t\t\tphone: member.users.phone,\n\t\t\tavatar: member.users.avatar_url,\n\t\t} : null,\n\t})) as TeamMemberRecord[];\n}\n\n// Fallback function if the join doesn't work\nasync function fetchTeamMembersWithUsersFallback(\n\tsupabase: SupabaseClient<Database>,\n\tcompanyId: string,\n): Promise<TeamMemberRecord[]> {\n\tconst { data: bareMembers, error: bareError } = await supabase\n\t\t.from(\"company_memberships\")\n\t\t.select(\"*\")\n\t\t.eq(\"company_id\", companyId)\n\t\t.eq(\"status\", \"active\")\n\t\t.is(\"archived_at\", null);\n\n\tif (bareError) {\n\t\tthrow bareError;\n\t}\n\n\tconst userIds = Array.from(\n\t\tnew Set(\n\t\t\t(bareMembers ?? [])\n\t\t\t\t.map((member) => member.user_id)\n\t\t\t\t.filter((id): id is string => Boolean(id)),\n\t\t),\n\t);\n\n\tconst usersById = new Map<string, TeamMemberRecord[\"users\"]>();\n\tif (userIds.length > 0) {\n\t\tconst { data: users, error: userError } = await supabase\n\t\t\t.from(\"profiles\")\n\t\t\t.select(\"id, full_name, email, phone, avatar_url\")\n\t\t\t.in(\"id\", userIds);\n\t\tif (userError) {\n\t\t\tthrow userError;\n\t\t}\n\t\t(users ?? []).forEach((user) => {\n\t\t\tusersById.set(user.id, user);\n\t\t});\n\t}\n\n\treturn (bareMembers ?? []).map((member) => ({\n\t\t...member,\n\t\tusers: member.user_id ? (usersById.get(member.user_id) ?? null) : null,\n\t})) as TeamMemberRecord[];\n}\n\nasync function fetchUnscheduledJobs(\n\tsupabase: SupabaseClient<Database>,\n\tcompanyId: string,\n\toptions: UnscheduledQueryOptions,\n): Promise<{\n\trows: JobRowWithRelations[];\n\ttotalCount: number;\n\thasMore: boolean;\n}> {\n\tconst limit = options.limit ?? DEFAULT_UNSCHEDULED_PAGE_SIZE;\n\tconst offset = options.offset ?? 0;\n\n\tlet query = supabase\n\t\t.from(\"jobs\")\n\t\t.select(UNSCHEDULED_JOBS_SELECT, { count: \"exact\" })\n\t\t.eq(\"company_id\", companyId)\n\t\t.is(\"deleted_at\", null)\n\t\t.is(\"archived_at\", null)\n\t\t.is(\"scheduled_start\", null)\n\t\t.is(\"scheduled_end\", null)\n\t\t.not(\"status\", \"in\", '(\"completed\",\"cancelled\")')\n\t\t.order(\"created_at\", { ascending: false })\n\t\t.range(offset, offset + limit - 1);\n\n\tif (options.search?.trim()) {\n\t\tconst sanitized = options.search.trim().replace(/,/g, \"\\\\,\");\n\t\tconst term = `%${sanitized}%`;\n\t\tquery = query.or(\n\t\t\t`title.ilike.${term},job_number.ilike.${term},description.ilike.${term}`,\n\t\t);\n\t}\n\n\tlet data;\n\tlet count;\n\tlet error;\n\n\ttry {\n\t\tconst result = await query;\n\t\tdata = result.data;\n\t\tcount = result.count;\n\t\terror = result.error;\n\t} catch (fetchError) {\n\t\tconsole.error(\"[Schedule] Unscheduled jobs fetch failed:\", fetchError);\n\t\t// Return empty result instead of throwing - allows schedule to still load with scheduled jobs\n\t\treturn { rows: [], totalCount: 0, hasMore: false };\n\t}\n\n\tif (error) {\n\t\tconsole.error(\"[Schedule] Unscheduled jobs query error:\", error);\n\t\t// Return empty result as fallback\n\t\treturn { rows: [], totalCount: 0, hasMore: false };\n\t}\n\n\tconst rows = (data ?? []) as JobRowWithRelations[];\n\tconst totalCount = typeof count === \"number\" ? count : rows.length;\n\tconst hasMore = offset + rows.length < totalCount;\n\n\treturn { rows, totalCount, hasMore };\n}\n\nasync function fetchPropertiesByIds(\n\tsupabase: SupabaseClient<Database>,\n\tpropertyIds: string[],\n): Promise<Map<string, ScheduleProperty>> {\n\tconst map = new Map<string, ScheduleProperty>();\n\tif (propertyIds.length === 0) {\n\t\treturn map;\n\t}\n\n\tconst chunkSize = 100;\n\tfor (let i = 0; i < propertyIds.length; i += chunkSize) {\n\t\tconst chunk = propertyIds.slice(i, i + chunkSize);\n\t\ttry {\n\t\t\tconst { data, error } = await supabase\n\t\t\t\t.from(\"properties\")\n\t\t\t\t.select(\n\t\t\t\t\t\"id, name, address, address2, city, state, zip_code, country, lat, lon\",\n\t\t\t\t)\n\t\t\t\t.in(\"id\", chunk);\n\n\t\t\tif (error) {\n\t\t\t\tconsole.error(\"[Schedule] Properties query error:\", error);\n\t\t\t\t// Continue with next chunk instead of failing completely\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t(data ?? []).forEach((property) => map.set(property.id, property));\n\t\t} catch (chunkError) {\n\t\t\tconsole.error(`[Schedule] Failed to fetch properties chunk ${i / chunkSize + 1}:`, chunkError);\n\t\t\t// Continue with next chunk - graceful degradation\n\t\t\tcontinue;\n\t\t}\n\t}\n\treturn map;\n}\n\nfunction mapTeamMembersToTechnicians(\n\tteamMembers: TeamMemberRecord[],\n): TechniciansLookup {\n\tconst technicians: Technician[] = [];\n\tconst byId = new Map<string, Technician>();\n\tconst byUserId = new Map<string, Technician>();\n\tconst byTeamMemberId = new Map<string, Technician>();\n\n\tteamMembers.forEach((member) => {\n\t\tconst technicianId = member.user_id ?? member.id;\n\t\tif (!technicianId) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst user = member.users;\n\t\tconst technician: Technician = {\n\t\t\tid: technicianId,\n\t\t\tuserId: member.user_id ?? undefined,\n\t\t\tteamMemberId: member.id,\n\t\t\tname:\n\t\t\t\tuser?.name || member.invited_name || member.job_title || \"Team Member\",\n\t\t\temail: user?.email || member.email || undefined,\n\t\t\tphone: user?.phone || member.phone || undefined,\n\t\t\tavatar: user?.avatar || undefined,\n\t\t\trole: member.job_title || member.role || \"Team Member\",\n\t\t\tdepartment: member.department || undefined,\n\t\t\tstatus: member.status === \"active\" ? \"available\" : \"offline\",\n\t\t\tisActive: member.status === \"active\" && !member.archived_at,\n\t\t\tschedule: { ...DEFAULT_SCHEDULE },\n\t\t\tcolor: DEFAULT_TECHNICIAN_COLOR,\n\t\t\tcreatedAt: new Date(member.created_at),\n\t\t\tupdatedAt: new Date(member.updated_at),\n\t\t};\n\n\t\ttechnicians.push(technician);\n\t\tbyId.set(technician.id, technician);\n\t\tif (technician.userId) {\n\t\t\tbyUserId.set(technician.userId, technician);\n\t\t}\n\t\tif (technician.teamMemberId) {\n\t\t\tbyTeamMemberId.set(technician.teamMemberId, technician);\n\t\t}\n\t});\n\n\treturn { technicians, byId, byUserId, byTeamMemberId };\n}\n\nfunction collectPropertyIds(\n\tschedules: ScheduleRow[],\n\tunscheduledJobs: JobRowWithRelations[],\n): string[] {\n\tconst ids = new Set<string>();\n\tschedules.forEach((row) => {\n\t\tif (row.property_id) {\n\t\t\tids.add(row.property_id);\n\t\t}\n\t});\n\tunscheduledJobs.forEach((job) => {\n\t\tif (job.property_id) {\n\t\t\tids.add(job.property_id);\n\t\t}\n\t});\n\treturn Array.from(ids);\n}\n\nfunction normalizeSingleRecord<T>(value: T | T[] | null | undefined): T | null {\n\tif (Array.isArray(value)) {\n\t\treturn value[0] ?? null;\n\t}\n\treturn value ?? null;\n}\n\nfunction mapJobRowToUnscheduledJob(\n\tjob: JobRowWithRelations,\n\tlookups: TechniciansLookup,\n\tproperty: ScheduleProperty | null,\n): Job {\n\tconst location = buildLocation(property);\n\tconst customer = buildJobCustomer(job, location.address.street);\n\tconst assignments = buildAssignmentsFromJobRow(job, lookups);\n\tconst startTime = job.scheduled_start\n\t\t? new Date(job.scheduled_start)\n\t\t: new Date(job.created_at);\n\tconst endTime = job.scheduled_end\n\t\t? new Date(job.scheduled_end)\n\t\t: new Date(\n\t\t\t\tstartTime.getTime() + DEFAULT_UNSCHEDULED_DURATION_MINUTES * 60 * 1000,\n\t\t\t);\n\n\treturn {\n\t\tid: job.id,\n\t\tjobId: job.id,\n\t\ttechnicianId: \"\",\n\t\tassignments,\n\t\tisUnassigned: true,\n\t\ttitle: job.title || job.job_number || \"Job\",\n\t\tdescription: job.description || undefined,\n\t\tjobType: (job.job_type as Job[\"jobType\"]) || undefined,\n\t\tcustomer,\n\t\tlocation,\n\t\tstartTime,\n\t\tendTime,\n\t\tstatus: mapJobStatus(job.status),\n\t\tpriority: mapJobPriority(job.priority),\n\t\tmetadata: buildJobMetadata(job),\n\t\tcreatedAt: new Date(job.created_at),\n\t\tupdatedAt: new Date(job.updated_at),\n\t};\n}\n\nfunction buildAssignmentsFromJobRow(\n\tjob: JobRowWithRelations,\n\tlookups: TechniciansLookup,\n): JobAssignment[] {\n\tconst assignments: JobAssignment[] = [];\n\n\tif (job.assigned_to) {\n\t\tconst technician =\n\t\t\tlookups.byUserId.get(job.assigned_to) ||\n\t\t\tlookups.byId.get(job.assigned_to);\n\t\tassignments.push({\n\t\t\ttechnicianId: null,\n\t\t\tteamMemberId: technician?.teamMemberId,\n\t\t\tdisplayName: technician?.name || \"Primary Technician\",\n\t\t\tavatar: technician?.avatar ?? null,\n\t\t\trole: \"primary\",\n\t\t\tstatus: technician?.status ?? \"available\",\n\t\t\tisActive: technician?.isActive ?? true,\n\t\t});\n\t}\n\n\tconst crewAssignments = Array.isArray(job.job_team_assignments)\n\t\t? job.job_team_assignments\n\t\t: job.job_team_assignments\n\t\t\t? [job.job_team_assignments]\n\t\t\t: [];\n\n\tcrewAssignments\n\t\t.filter((assignment) => !assignment.removed_at)\n\t\t.forEach((assignment) => {\n\t\t\tconst teamMember = assignment.team_member;\n\t\t\tif (!teamMember) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst technician =\n\t\t\t\t(teamMember.user_id && lookups.byUserId.get(teamMember.user_id)) ||\n\t\t\t\tlookups.byTeamMemberId.get(teamMember.id);\n\n\t\t\tassignments.push({\n\t\t\t\ttechnicianId: null,\n\t\t\t\tteamMemberId: teamMember.id,\n\t\t\t\tdisplayName:\n\t\t\t\t\ttechnician?.name ||\n\t\t\t\t\tteamMember.invited_name ||\n\t\t\t\t\tteamMember.job_title ||\n\t\t\t\t\t\"Crew Member\",\n\t\t\t\tavatar: technician?.avatar ?? null,\n\t\t\t\trole: (assignment.role as JobAssignment[\"role\"]) || \"crew\",\n\t\t\t\tstatus: technician?.status ?? deriveTechnicianStatus(teamMember.status),\n\t\t\t\tisActive: technician?.isActive ?? teamMember.status === \"active\",\n\t\t\t});\n\t\t});\n\n\treturn dedupeAssignments(assignments);\n}\n\nfunction buildJobCustomer(\n\tjob: JobRowWithRelations,\n\tfallbackStreet: string,\n): Job[\"customer\"] {\n\tconst customerRecord = normalizeSingleRecord(job.customer);\n\tconst name = [\n\t\tcustomerRecord?.first_name?.trim() ?? \"\",\n\t\tcustomerRecord?.last_name?.trim() ?? \"\",\n\t]\n\t\t.filter(Boolean)\n\t\t.join(\" \")\n\t\t.trim();\n\n\treturn {\n\t\tid: customerRecord?.id || job.customer_id || `customer-${job.id}`,\n\t\tname: name || job.title || \"Unspecified Customer\",\n\t\temail: customerRecord?.email || undefined,\n\t\tphone: customerRecord?.phone || undefined,\n\t\tlocation: {\n\t\t\t...DEFAULT_LOCATION,\n\t\t\taddress: {\n\t\t\t\t...DEFAULT_LOCATION.address,\n\t\t\t\tstreet: fallbackStreet,\n\t\t\t},\n\t\t},\n\t\tcreatedAt: new Date(customerRecord?.created_at ?? job.created_at),\n\t\tupdatedAt: new Date(customerRecord?.updated_at ?? job.updated_at),\n\t};\n}\n\nfunction buildJobMetadata(job: JobRowWithRelations): Job[\"metadata\"] {\n\tconst baseMetadata =\n\t\tjob.metadata && typeof job.metadata === \"object\"\n\t\t\t? (job.metadata as Job[\"metadata\"])\n\t\t\t: {};\n\tconst metadata = { ...baseMetadata };\n\tif (job.notes) {\n\t\tmetadata.notes = job.notes;\n\t}\n\treturn metadata;\n}\n\nfunction mapJobPriority(value?: string | null): Job[\"priority\"] {\n\tif (!value) {\n\t\treturn \"medium\";\n\t}\n\tconst normalized = value.toLowerCase();\n\tswitch (normalized) {\n\t\tcase \"low\":\n\t\tcase \"medium\":\n\t\tcase \"high\":\n\t\tcase \"urgent\":\n\t\t\treturn normalized as Job[\"priority\"];\n\t\tcase \"critical\":\n\t\tcase \"emergency\":\n\t\t\treturn \"urgent\";\n\t\tdefault:\n\t\t\treturn \"medium\";\n\t}\n}\n\nfunction mapJobStatus(value?: string | null): Job[\"status\"] {\n\tif (!value) {\n\t\treturn \"scheduled\";\n\t}\n\tconst normalized = value.toLowerCase();\n\tswitch (normalized) {\n\t\tcase \"scheduled\":\n\t\tcase \"dispatched\":\n\t\tcase \"arrived\":\n\t\tcase \"closed\":\n\t\tcase \"cancelled\":\n\t\t\treturn normalized as Job[\"status\"];\n\t\tcase \"in-progress\":\n\t\tcase \"in_progress\":\n\t\t\treturn \"in-progress\";\n\t\tcase \"completed\":\n\t\tcase \"complete\":\n\t\tcase \"done\":\n\t\t\treturn \"completed\";\n\t\tcase \"inprogress\":\n\t\t\treturn \"in-progress\";\n\t\tcase \"open\":\n\t\tcase \"pending\":\n\t\tcase \"draft\":\n\t\tdefault:\n\t\t\treturn \"scheduled\";\n\t}\n}\n\nfunction mapScheduleToJob(\n\tschedule: ScheduleRecord,\n\tlookups: TechniciansLookup,\n\tproperty: ScheduleProperty | null,\n): Job {\n\tconst location = buildLocation(property);\n\tconst customer = buildCustomer(schedule, location.address.street);\n\tconst assignments = buildAssignments(schedule, lookups);\n\n\tconst primaryAssignment = assignments.find(\n\t\t(assignment) => assignment.role === \"primary\",\n\t);\n\tconst technicianId = primaryAssignment?.technicianId ?? \"\";\n\n\treturn {\n\t\tid: schedule.id,\n\t\tjobId: schedule.job_id || undefined,\n\t\ttechnicianId,\n\t\tassignments,\n\t\tisUnassigned: assignments.length === 0,\n\t\ttitle: schedule.title || schedule.job?.title || \"Appointment\",\n\t\tdescription: schedule.description || undefined,\n\t\tjobType: (schedule.job?.job_type as Job[\"jobType\"]) || undefined,\n\t\tappointmentType: schedule.type || undefined,\n\t\tappointmentCategory: getAppointmentCategory(schedule.type, schedule.all_day ?? false),\n\t\tcustomer,\n\t\tlocation,\n\t\tstartTime: new Date(schedule.start_time),\n\t\tendTime: new Date(schedule.end_time),\n\t\tallDay: schedule.all_day,\n\t\tstatus:\n\t\t\t(schedule.status as Job[\"status\"]) && isJobStatus(schedule.status)\n\t\t\t\t? (schedule.status as Job[\"status\"])\n\t\t\t\t: \"scheduled\",\n\t\tpriority: \"medium\",\n\t\trecurrence: schedule.is_recurring\n\t\t\t? {\n\t\t\t\t\tfrequency: \"weekly\",\n\t\t\t\t\tinterval: 1,\n\t\t\t\t\tendDate: schedule.recurrence_end_date\n\t\t\t\t\t\t? new Date(schedule.recurrence_end_date)\n\t\t\t\t\t\t: undefined,\n\t\t\t\t}\n\t\t\t: undefined,\n\t\tmetadata: {\n\t\t\testimatedDuration: schedule.duration,\n\t\t\tnotes: schedule.notes || undefined,\n\t\t},\n\t\tcreatedAt: new Date(schedule.created_at),\n\t\tupdatedAt: new Date(schedule.updated_at),\n\t};\n}\n\nfunction buildAssignments(\n\tschedule: ScheduleRecord,\n\tlookups: TechniciansLookup,\n): JobAssignment[] {\n\tconst assignments: JobAssignment[] = [];\n\n\tif (schedule.assigned_to) {\n\t\tconst technician =\n\t\t\tlookups.byUserId.get(schedule.assigned_to) ||\n\t\t\tlookups.byId.get(schedule.assigned_to);\n\t\tassignments.push({\n\t\t\ttechnicianId: technician?.id ?? schedule.assigned_to,\n\t\t\tteamMemberId: technician?.teamMemberId,\n\t\t\tdisplayName: technician?.name || \"Primary Technician\",\n\t\t\tavatar: technician?.avatar || null,\n\t\t\trole: \"primary\",\n\t\t\tstatus: technician?.status ?? \"available\",\n\t\t\tisActive: technician?.isActive ?? true,\n\t\t});\n\t}\n\n\tconst crewAssignments =\n\t\tschedule.job?.job_team_assignments?.filter(\n\t\t\t(assignment) => !assignment.removed_at,\n\t\t) ?? [];\n\n\tcrewAssignments.forEach((assignment) => {\n\t\tconst teamMember = assignment.team_member;\n\t\tif (!teamMember) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst technician =\n\t\t\t(teamMember.user_id && lookups.byUserId.get(teamMember.user_id)) ||\n\t\t\tlookups.byTeamMemberId.get(teamMember.id);\n\n\t\tconst displayName =\n\t\t\ttechnician?.name ||\n\t\t\tteamMember.invited_name ||\n\t\t\tteamMember.job_title ||\n\t\t\t\"Crew Member\";\n\n\t\tassignments.push({\n\t\t\ttechnicianId: technician?.id ?? teamMember.user_id ?? teamMember.id,\n\t\t\tteamMemberId: teamMember.id,\n\t\t\tdisplayName,\n\t\t\tavatar: technician?.avatar || null,\n\t\t\trole: (assignment.role as JobAssignment[\"role\"]) || \"crew\",\n\t\t\tstatus: technician?.status ?? deriveTechnicianStatus(teamMember.status),\n\t\t\tisActive: technician?.isActive ?? teamMember.status === \"active\",\n\t\t});\n\t});\n\n\treturn dedupeAssignments(assignments);\n}\n\nfunction dedupeAssignments(assignments: JobAssignment[]): JobAssignment[] {\n\tconst seen = new Set<string>();\n\n\treturn assignments.filter((assignment) => {\n\t\tconst key = `${assignment.role}-${assignment.technicianId ?? assignment.teamMemberId ?? \"\"}`;\n\t\tif (seen.has(key)) {\n\t\t\treturn false;\n\t\t}\n\t\tseen.add(key);\n\t\treturn true;\n\t});\n}\n\nfunction buildCustomer(\n\tschedule: ScheduleRecord,\n\tfallbackStreet: string,\n): Job[\"customer\"] {\n\tconst customerRecord = schedule.customer;\n\tconst name =\n\t\tcustomerRecord &&\n\t\t`${customerRecord.first_name ?? \"\"} ${customerRecord.last_name ?? \"\"}`.trim();\n\n\treturn {\n\t\tid: customerRecord?.id || schedule.customer_id || `customer-${schedule.id}`,\n\t\tname: name && name.length > 0 ? name : \"Unspecified Customer\",\n\t\temail: customerRecord?.email || undefined,\n\t\tphone: customerRecord?.phone || undefined,\n\t\tlocation: {\n\t\t\t...DEFAULT_LOCATION,\n\t\t\taddress: {\n\t\t\t\t...DEFAULT_LOCATION.address,\n\t\t\t\tstreet: fallbackStreet,\n\t\t\t},\n\t\t},\n\t\tcreatedAt: new Date(schedule.created_at),\n\t\tupdatedAt: new Date(schedule.updated_at),\n\t};\n}\n\nfunction buildLocation(property: ScheduleProperty | null): Job[\"location\"] {\n\tif (!property) {\n\t\treturn { ...DEFAULT_LOCATION };\n\t}\n\n\treturn {\n\t\taddress: {\n\t\t\tstreet: property.address || property.address2 || property.name || \"\",\n\t\t\tcity: property.city || \"\",\n\t\t\tstate: property.state || \"\",\n\t\t\tzip: property.zip_code || \"\",\n\t\t\tcountry: property.country || \"\",\n\t\t},\n\t\tcoordinates: {\n\t\t\tlat: property.lat || 0,\n\t\t\tlng: property.lon || 0,\n\t\t},\n\t};\n}\n\nfunction deriveTechnicianStatus(status?: string | null): Technician[\"status\"] {\n\treturn status === \"active\" ? \"available\" : \"offline\";\n}\n\nfunction isJobStatus(value: string): value is Job[\"status\"] {\n\treturn [\n\t\t\"scheduled\",\n\t\t\"dispatched\",\n\t\t\"arrived\",\n\t\t\"in-progress\",\n\t\t\"closed\",\n\t\t\"completed\",\n\t\t\"cancelled\",\n\t].includes(value);\n}\n\nexport async function fetchAdditionalUnscheduledJobs({\n\tsupabase,\n\tcompanyId,\n\tlimit = DEFAULT_UNSCHEDULED_PAGE_SIZE,\n\toffset = 0,\n\tsearch = \"\",\n}: {\n\tsupabase: SupabaseClient<Database>;\n\tcompanyId: string;\n\tlimit?: number;\n\toffset?: number;\n\tsearch?: string;\n}): Promise<{ jobs: Job[]; meta: UnassignedJobsMeta }> {\n\tconst teamMembers = await fetchTeamMembersWithUsers(supabase, companyId);\n\tconst technicianLookups = mapTeamMembersToTechnicians(teamMembers);\n\tconst { rows, totalCount, hasMore } = await fetchUnscheduledJobs(\n\t\tsupabase,\n\t\tcompanyId,\n\t\t{\n\t\t\tlimit,\n\t\t\toffset,\n\t\t\tsearch,\n\t\t},\n\t);\n\n\tconst propertyMap = await fetchPropertiesByIds(\n\t\tsupabase,\n\t\tcollectPropertyIds([], rows),\n\t);\n\tconst jobs = rows.map((row) =>\n\t\tmapJobRowToUnscheduledJob(\n\t\t\trow,\n\t\t\ttechnicianLookups,\n\t\t\tpropertyMap.get(row.property_id ?? \"\") ?? null,\n\t\t),\n\t);\n\n\treturn {\n\t\tjobs,\n\t\tmeta: {\n\t\t\tlimit,\n\t\t\tnextOffset: offset + rows.length,\n\t\t\thasMore,\n\t\t\tsearch,\n\t\t\ttotalCount,\n\t\t},\n\t};\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1009, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/lib/stores/schedule-store.ts"],"sourcesContent":["import { create } from \"zustand\";\nimport { devtools, persist } from \"zustand/middleware\";\nimport type { Job, Technician } from \"@/components/schedule/schedule-types\";\nimport type { UnassignedJobsMeta } from \"@/lib/schedule/types\";\nimport type { ScheduleHydrationPayload } from \"@/lib/schedule-bootstrap\";\nimport { deserializeJob } from \"@/lib/schedule-bootstrap\";\nimport { fetchScheduleData } from \"@/lib/schedule-data\";\nimport { createClient } from \"@/lib/supabase/client\";\n\nconst DEFAULT_UNASSIGNED_LIMIT = 50;\n\ntype ScheduleState = {\n\t// Data\n\ttechnicians: Map<string, Technician>;\n\tjobs: Map<string, Job>;\n\tcompanyId: string | null;\n\tlastFetchedRange: { start: Date; end: Date } | null;\n\n\t// Loading states\n\tisLoading: boolean;\n\terror: string | null;\n\tlastSync: Date | null;\n\tisLoadingUnassigned: boolean;\n\n\t// Selection\n\tselectedJobId: string | null;\n\tselectedTechnicianId: string | null;\n\n\t// Unassigned jobs state\n\tunassignedSearch: string;\n\tunassignedHasMore: boolean;\n\tunassignedNextOffset: number;\n\tunassignedLimit: number;\n\tunassignedTotalCount: number;\n\n\t// Actions - Technicians\n\tsetTechnicians: (technicians: Technician[]) => void;\n\taddTechnician: (technician: Technician) => void;\n\tupdateTechnician: (id: string, updates: Partial<Technician>) => void;\n\tremoveTechnician: (id: string) => void;\n\n\t// Actions - Jobs\n\tsetJobs: (jobs: Job[]) => void;\n\taddJob: (job: Job) => void;\n\tupdateJob: (jobId: string, updates: Partial<Job>) => void;\n\tmoveJob: (\n\t\tjobId: string,\n\t\tnewTechnicianId: string,\n\t\tnewStartTime: Date,\n\t\tnewEndTime: Date,\n\t) => void;\n\tdeleteJob: (jobId: string) => void;\n\tduplicateJob: (jobId: string, newStartTime: Date) => void;\n\n\t// Actions - Selection\n\tselectJob: (jobId: string | null) => void;\n\tselectTechnician: (technicianId: string | null) => void;\n\n\t// Actions - Bulk operations\n\tbulkUpdateJobs: (\n\t\tupdates: Array<{ jobId: string; updates: Partial<Job> }>,\n\t) => void;\n\tbulkDeleteJobs: (jobIds: string[]) => void;\n\n\t// Actions - Sync\n\tsyncWithServer: () => Promise<void>;\n\tsetLoading: (loading: boolean) => void;\n\tsetError: (error: string | null) => void;\n\tsetLastSync: (timestamp: Date | null) => void;\n\tsetCompanyId: (companyId: string | null) => void;\n\tsetLastFetchedRange: (range: { start: Date; end: Date } | null) => void;\n\tsetUnassignedMeta: (\n\t\tmeta?: UnassignedJobsMeta,\n\t\tfallbackCount?: number,\n\t) => void;\n\tloadMoreUnassignedJobs: (options?: {\n\t\treset?: boolean;\n\t\tsearch?: string;\n\t}) => Promise<void>;\n\n\t// Helpers\n\tgetJobsByTechnician: (technicianId: string) => Job[];\n\tgetJobsByDateRange: (startDate: Date, endDate: Date) => Job[];\n\tgetTechnicianById: (id: string) => Technician | undefined;\n\tgetJobById: (id: string) => Job | undefined;\n\thasConflict: (\n\t\ttechnicianId: string,\n\t\tstartTime: Date,\n\t\tendTime: Date,\n\t\texcludeJobId?: string,\n\t) => boolean;\n\tgetUnassignedJobs: () => Job[];\n\tgetJobsGroupedByTechnician: () => Record<string, Job[]>;\n\thydrateFromServer: (payload: ScheduleHydrationPayload) => void;\n};\n\nexport const useScheduleStore = create<ScheduleState>()(\n\tdevtools(\n\t\tpersist(\n\t\t\t(set, get) => ({\n\t\t\t\t// Initial state\n\t\t\t\ttechnicians: new Map(),\n\t\t\t\tjobs: new Map(),\n\t\t\t\tcompanyId: null,\n\t\t\t\tlastFetchedRange: null,\n\t\t\t\tisLoading: false,\n\t\t\t\terror: null,\n\t\t\t\tlastSync: null,\n\t\t\t\tisLoadingUnassigned: false,\n\t\t\t\tunassignedSearch: \"\",\n\t\t\t\tunassignedHasMore: false,\n\t\t\t\tunassignedNextOffset: 0,\n\t\t\t\tunassignedLimit: DEFAULT_UNASSIGNED_LIMIT,\n\t\t\t\tunassignedTotalCount: 0,\n\t\t\t\tselectedJobId: null,\n\t\t\t\tselectedTechnicianId: null,\n\n\t\t\t\t// Technician actions\n\t\t\t\tsetTechnicians: (technicians) => {\n\t\t\t\t\tconst techMap = new Map(technicians.map((t) => [t.id, t]));\n\t\t\t\t\tset({ technicians: techMap });\n\t\t\t\t},\n\n\t\t\t\taddTechnician: (technician) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newTechnicians = new Map(state.technicians);\n\t\t\t\t\t\tnewTechnicians.set(technician.id, technician);\n\t\t\t\t\t\treturn { technicians: newTechnicians };\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tupdateTechnician: (id, updates) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newTechnicians = new Map(state.technicians);\n\t\t\t\t\t\tconst existing = newTechnicians.get(id);\n\t\t\t\t\t\tif (existing) {\n\t\t\t\t\t\t\tnewTechnicians.set(id, { ...existing, ...updates });\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn { technicians: newTechnicians };\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tremoveTechnician: (id) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newTechnicians = new Map(state.technicians);\n\t\t\t\t\t\tnewTechnicians.delete(id);\n\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tfor (const [jobId, job] of newJobs) {\n\t\t\t\t\t\t\tconst filteredAssignments = job.assignments.filter(\n\t\t\t\t\t\t\t\t(assignment) => assignment.technicianId !== id,\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tif (filteredAssignments.length !== job.assignments.length) {\n\t\t\t\t\t\t\t\tnewJobs.set(jobId, {\n\t\t\t\t\t\t\t\t\t...job,\n\t\t\t\t\t\t\t\t\tassignments: filteredAssignments,\n\t\t\t\t\t\t\t\t\ttechnicianId:\n\t\t\t\t\t\t\t\t\t\tfilteredAssignments.find(\n\t\t\t\t\t\t\t\t\t\t\t(assignment) => assignment.role === \"primary\",\n\t\t\t\t\t\t\t\t\t\t)?.technicianId ?? \"\",\n\t\t\t\t\t\t\t\t\tisUnassigned: filteredAssignments.length === 0,\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\ttechnicians: newTechnicians,\n\t\t\t\t\t\t\tjobs: newJobs,\n\t\t\t\t\t\t\tselectedTechnicianId:\n\t\t\t\t\t\t\t\tstate.selectedTechnicianId === id\n\t\t\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t\t\t: state.selectedTechnicianId,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\t// Job actions\n\t\t\t\tsetJobs: (jobs) => {\n\t\t\t\t\tconst jobMap = new Map(jobs.map((j) => [j.id, j]));\n\t\t\t\t\tset({ jobs: jobMap });\n\t\t\t\t},\n\n\t\t\t\taddJob: (job) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tnewJobs.set(job.id, job);\n\t\t\t\t\t\treturn { jobs: newJobs };\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tupdateJob: (jobId, updates) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tconst existing = newJobs.get(jobId);\n\t\t\t\t\t\tif (existing) {\n\t\t\t\t\t\t\tnewJobs.set(jobId, { ...existing, ...updates });\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn { jobs: newJobs };\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tmoveJob: (jobId, newTechnicianId, newStartTime, newEndTime) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tconst existing = newJobs.get(jobId);\n\t\t\t\t\t\tif (existing) {\n\t\t\t\t\t\t\tconst technician = state.technicians.get(newTechnicianId);\n\t\t\t\t\t\t\tconst updatedAssignments =\n\t\t\t\t\t\t\t\texisting.assignments.length > 0\n\t\t\t\t\t\t\t\t\t? existing.assignments.map((assignment) =>\n\t\t\t\t\t\t\t\t\t\t\tassignment.role === \"primary\"\n\t\t\t\t\t\t\t\t\t\t\t\t? {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t...assignment,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\ttechnicianId: newTechnicianId,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tteamMemberId: technician?.teamMemberId,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdisplayName:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttechnician?.name || assignment.displayName,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar:\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttechnician?.avatar ?? assignment.avatar ?? null,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstatus: technician?.status ?? assignment.status,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tisActive: technician?.isActive ?? true,\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t: assignment,\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t: [\n\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\ttechnicianId: newTechnicianId,\n\t\t\t\t\t\t\t\t\t\t\t\tteamMemberId: technician?.teamMemberId,\n\t\t\t\t\t\t\t\t\t\t\t\tdisplayName: technician?.name || \"Primary Technician\",\n\t\t\t\t\t\t\t\t\t\t\t\tavatar: technician?.avatar ?? null,\n\t\t\t\t\t\t\t\t\t\t\t\trole: \"primary\" as const,\n\t\t\t\t\t\t\t\t\t\t\t\tstatus: technician?.status ?? \"available\",\n\t\t\t\t\t\t\t\t\t\t\t\tisActive: true,\n\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t];\n\n\t\t\t\t\t\t\tnewJobs.set(jobId, {\n\t\t\t\t\t\t\t\t...existing,\n\t\t\t\t\t\t\t\ttechnicianId: newTechnicianId,\n\t\t\t\t\t\t\t\tassignments: updatedAssignments,\n\t\t\t\t\t\t\t\tisUnassigned: updatedAssignments.length === 0,\n\t\t\t\t\t\t\t\tstartTime: newStartTime,\n\t\t\t\t\t\t\t\tendTime: newEndTime,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn { jobs: newJobs };\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tdeleteJob: (jobId) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tnewJobs.delete(jobId);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tjobs: newJobs,\n\t\t\t\t\t\t\tselectedJobId:\n\t\t\t\t\t\t\t\tstate.selectedJobId === jobId ? null : state.selectedJobId,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tduplicateJob: (jobId, newStartTime) => {\n\t\t\t\t\tconst job = get().jobs.get(jobId);\n\t\t\t\t\tif (!job) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst duration = job.endTime.getTime() - job.startTime.getTime();\n\t\t\t\t\tconst newEndTime = new Date(newStartTime.getTime() + duration);\n\n\t\t\t\t\tconst newJob: Job = {\n\t\t\t\t\t\t...job,\n\t\t\t\t\t\tid: `${job.id}-copy-${Date.now()}`,\n\t\t\t\t\t\tstartTime: newStartTime,\n\t\t\t\t\t\tendTime: newEndTime,\n\t\t\t\t\t\tstatus: \"scheduled\",\n\t\t\t\t\t\tassignments: job.assignments.map((assignment) => ({\n\t\t\t\t\t\t\t...assignment,\n\t\t\t\t\t\t})),\n\t\t\t\t\t\tcreatedAt: new Date(),\n\t\t\t\t\t\tupdatedAt: new Date(),\n\t\t\t\t\t};\n\n\t\t\t\t\tget().addJob(newJob);\n\t\t\t\t},\n\n\t\t\t\t// Selection actions\n\t\t\t\tselectJob: (jobId) => set({ selectedJobId: jobId }),\n\t\t\t\tselectTechnician: (technicianId) =>\n\t\t\t\t\tset({ selectedTechnicianId: technicianId }),\n\n\t\t\t\t// Bulk operations\n\t\t\t\tbulkUpdateJobs: (updates) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tupdates.forEach(({ jobId, updates: jobUpdates }) => {\n\t\t\t\t\t\t\tconst existing = newJobs.get(jobId);\n\t\t\t\t\t\t\tif (existing) {\n\t\t\t\t\t\t\t\tnewJobs.set(jobId, { ...existing, ...jobUpdates });\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\treturn { jobs: newJobs };\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tbulkDeleteJobs: (jobIds) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst newJobs = new Map(state.jobs);\n\t\t\t\t\t\tjobIds.forEach((id) => newJobs.delete(id));\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tjobs: newJobs,\n\t\t\t\t\t\t\tselectedJobId: jobIds.includes(state.selectedJobId || \"\")\n\t\t\t\t\t\t\t\t? null\n\t\t\t\t\t\t\t\t: state.selectedJobId,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\thydrateFromServer: (payload) => {\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst jobMap = new Map(payload.jobs.map((job) => [job.id, job]));\n\t\t\t\t\t\tconst technicianMap = new Map(\n\t\t\t\t\t\t\tpayload.technicians.map((tech) => [tech.id, tech]),\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...state,\n\t\t\t\t\t\t\tcompanyId: payload.companyId,\n\t\t\t\t\t\t\tjobs: jobMap,\n\t\t\t\t\t\t\ttechnicians: technicianMap,\n\t\t\t\t\t\t\tlastFetchedRange: {\n\t\t\t\t\t\t\t\tstart: payload.range.start,\n\t\t\t\t\t\t\t\tend: payload.range.end,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tlastSync: payload.lastSync,\n\t\t\t\t\t\t\tisLoading: false,\n\t\t\t\t\t\t\terror: null,\n\t\t\t\t\t\t\tselectedTechnicianId: null,\n\t\t\t\t\t\t\tselectedJobId: null,\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tconst unassignedCount = payload.jobs.filter(\n\t\t\t\t\t\t(job) => job.isUnassigned,\n\t\t\t\t\t).length;\n\t\t\t\t\tget().setUnassignedMeta(payload.unassignedMeta, unassignedCount);\n\t\t\t\t},\n\n\t\t\t\t// Sync\n\t\t\t\tsyncWithServer: async () => {\n\t\t\t\t\tset({ isLoading: true, error: null });\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst supabase = createClient();\n\n\t\t\t\t\t\tif (!supabase) {\n\t\t\t\t\t\t\tthrow new Error(\"Database connection not available\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst companyId = get().companyId;\n\n\t\t\t\t\t\tif (!companyId) {\n\t\t\t\t\t\t\tthrow new Error(\"Company context is missing\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst range =\n\t\t\t\t\t\t\tget().lastFetchedRange ??\n\t\t\t\t\t\t\t({\n\t\t\t\t\t\t\t\tstart: new Date(Date.now() - 1000 * 60 * 60 * 24 * 30),\n\t\t\t\t\t\t\t\tend: new Date(Date.now() + 1000 * 60 * 60 * 24 * 30),\n\t\t\t\t\t\t\t} as { start: Date; end: Date });\n\n\t\t\t\t\t\tconst { unassignedLimit, unassignedSearch } = get();\n\n\t\t\t\t\t\tconst { jobs, technicians, unassignedMeta } =\n\t\t\t\t\t\t\tawait fetchScheduleData({\n\t\t\t\t\t\t\t\tsupabase,\n\t\t\t\t\t\t\t\tcompanyId,\n\t\t\t\t\t\t\t\trange,\n\t\t\t\t\t\t\t\tunscheduledLimit: unassignedLimit,\n\t\t\t\t\t\t\t\tunscheduledOffset: 0,\n\t\t\t\t\t\t\t\tunscheduledSearch: unassignedSearch,\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\tget().setTechnicians(technicians);\n\t\t\t\t\t\tget().setJobs(jobs);\n\t\t\t\t\t\tset({\n\t\t\t\t\t\t\tlastSync: new Date(),\n\t\t\t\t\t\t\tlastFetchedRange: {\n\t\t\t\t\t\t\t\tstart: new Date(range.start),\n\t\t\t\t\t\t\t\tend: new Date(range.end),\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst unassignedCount = jobs.filter(\n\t\t\t\t\t\t\t(job) => job.isUnassigned,\n\t\t\t\t\t\t).length;\n\t\t\t\t\t\tget().setUnassignedMeta(unassignedMeta, unassignedCount);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tset({\n\t\t\t\t\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t\t\t\t\t});\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tset({ isLoading: false });\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tsetLoading: (loading) => set({ isLoading: loading }),\n\t\t\t\tsetError: (error) => set({ error }),\n\t\t\t\tsetLastSync: (timestamp) => set({ lastSync: timestamp }),\n\t\t\t\tsetCompanyId: (companyId) => set({ companyId }),\n\t\t\t\tsetLastFetchedRange: (range) => set({ lastFetchedRange: range }),\n\t\t\t\tsetUnassignedMeta: (meta, fallbackCount = 0) =>\n\t\t\t\t\tset((state) => {\n\t\t\t\t\t\tconst currentUnassigned = Array.from(state.jobs.values()).filter(\n\t\t\t\t\t\t\t(job) => job.isUnassigned,\n\t\t\t\t\t\t).length;\n\t\t\t\t\t\tconst derivedCount = Math.max(fallbackCount, currentUnassigned);\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\tunassignedSearch:\n\t\t\t\t\t\t\t\tmeta && typeof meta.search === \"string\"\n\t\t\t\t\t\t\t\t\t? meta.search\n\t\t\t\t\t\t\t\t\t: (state.unassignedSearch ?? \"\"),\n\t\t\t\t\t\t\tunassignedHasMore:\n\t\t\t\t\t\t\t\ttypeof meta?.hasMore === \"boolean\"\n\t\t\t\t\t\t\t\t\t? meta.hasMore\n\t\t\t\t\t\t\t\t\t: (state.unassignedHasMore ?? false),\n\t\t\t\t\t\t\tunassignedNextOffset: meta?.nextOffset ?? derivedCount,\n\t\t\t\t\t\t\tunassignedLimit:\n\t\t\t\t\t\t\t\tmeta?.limit ??\n\t\t\t\t\t\t\t\tstate.unassignedLimit ??\n\t\t\t\t\t\t\t\tDEFAULT_UNASSIGNED_LIMIT,\n\t\t\t\t\t\t\tunassignedTotalCount: meta?.totalCount ?? derivedCount,\n\t\t\t\t\t\t\tisLoadingUnassigned: false,\n\t\t\t\t\t\t};\n\t\t\t\t\t}),\n\t\t\t\tloadMoreUnassignedJobs: async ({\n\t\t\t\t\treset = false,\n\t\t\t\t\tsearch,\n\t\t\t\t}: {\n\t\t\t\t\treset?: boolean;\n\t\t\t\t\tsearch?: string;\n\t\t\t\t} = {}) => {\n\t\t\t\t\tconst { unassignedLimit } = get();\n\t\t\t\t\tconst searchTerm =\n\t\t\t\t\t\ttypeof search === \"string\" ? search : get().unassignedSearch;\n\t\t\t\t\tconst offset = reset ? 0 : get().unassignedNextOffset;\n\n\t\t\t\t\tset({\n\t\t\t\t\t\tisLoadingUnassigned: true,\n\t\t\t\t\t\terror: null,\n\t\t\t\t\t\tunassignedSearch: searchTerm,\n\t\t\t\t\t});\n\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst response = await fetch(\"/api/schedule/unscheduled\", {\n\t\t\t\t\t\t\tmethod: \"POST\",\n\t\t\t\t\t\t\theaders: { \"Content-Type\": \"application/json\" },\n\t\t\t\t\t\t\tbody: JSON.stringify({\n\t\t\t\t\t\t\t\tsearch: searchTerm,\n\t\t\t\t\t\t\t\toffset,\n\t\t\t\t\t\t\t\tlimit: unassignedLimit,\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tconst payload = await response.json();\n\t\t\t\t\t\tif (!response.ok) {\n\t\t\t\t\t\t\tthrow new Error(\n\t\t\t\t\t\t\t\tpayload?.error || \"Failed to load unscheduled jobs\",\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst newJobs = Array.isArray(payload?.jobs)\n\t\t\t\t\t\t\t? payload.jobs.map(deserializeJob)\n\t\t\t\t\t\t\t: [];\n\t\t\t\t\t\tconst meta: UnassignedJobsMeta | undefined = payload?.meta;\n\n\t\t\t\t\t\tset((state) => {\n\t\t\t\t\t\t\tconst jobMap = new Map(state.jobs);\n\t\t\t\t\t\t\tif (reset) {\n\t\t\t\t\t\t\t\tfor (const [id, job] of jobMap) {\n\t\t\t\t\t\t\t\t\tif (job.isUnassigned) {\n\t\t\t\t\t\t\t\t\t\tjobMap.delete(id);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tnewJobs.forEach((job) => {\n\t\t\t\t\t\t\t\tjobMap.set(job.id, job);\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\tjobs: jobMap,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst unassignedCount = Array.from(get().jobs.values()).filter(\n\t\t\t\t\t\t\t(job) => job.isUnassigned,\n\t\t\t\t\t\t).length;\n\t\t\t\t\t\tget().setUnassignedMeta(meta, unassignedCount);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tset({\n\t\t\t\t\t\t\terror:\n\t\t\t\t\t\t\t\terror instanceof Error\n\t\t\t\t\t\t\t\t\t? error.message\n\t\t\t\t\t\t\t\t\t: \"Failed to load unscheduled jobs\",\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthrow error;\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tset({ isLoadingUnassigned: false });\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\t// Helpers\n\t\t\t\tgetJobsByTechnician: (technicianId) =>\n\t\t\t\t\tArray.from(get().jobs.values()).filter((job) =>\n\t\t\t\t\t\tjob.assignments.some(\n\t\t\t\t\t\t\t(assignment) => assignment.technicianId === technicianId,\n\t\t\t\t\t\t),\n\t\t\t\t\t),\n\n\t\t\t\tgetJobsByDateRange: (startDate, endDate) =>\n\t\t\t\t\tArray.from(get().jobs.values()).filter(\n\t\t\t\t\t\t(job) => job.startTime <= endDate && job.endTime >= startDate,\n\t\t\t\t\t),\n\n\t\t\t\tgetTechnicianById: (id) => get().technicians.get(id),\n\n\t\t\t\tgetJobById: (id) => get().jobs.get(id),\n\n\t\t\t\thasConflict: (technicianId, startTime, endTime, excludeJobId) => {\n\t\t\t\t\tconst techJobs = get().getJobsByTechnician(technicianId);\n\n\t\t\t\t\treturn techJobs.some((job) => {\n\t\t\t\t\t\tif (excludeJobId && job.id === excludeJobId) {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t// Check for overlap\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t(startTime >= job.startTime && startTime < job.endTime) ||\n\t\t\t\t\t\t\t(endTime > job.startTime && endTime <= job.endTime) ||\n\t\t\t\t\t\t\t(startTime <= job.startTime && endTime >= job.endTime)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tgetUnassignedJobs: () =>\n\t\t\t\t\tArray.from(get().jobs.values()).filter((job) => job.isUnassigned),\n\n\t\t\t\tgetJobsGroupedByTechnician: () => {\n\t\t\t\t\tconst grouped: Record<string, Job[]> = {};\n\t\t\t\t\tfor (const job of get().jobs.values()) {\n\t\t\t\t\t\tjob.assignments.forEach((assignment) => {\n\t\t\t\t\t\t\tif (!assignment.technicianId) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (!grouped[assignment.technicianId]) {\n\t\t\t\t\t\t\t\tgrouped[assignment.technicianId] = [];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tgrouped[assignment.technicianId].push(job);\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\treturn grouped;\n\t\t\t\t},\n\t\t\t}),\n\t\t\t{\n\t\t\t\tname: \"schedule-storage\",\n\t\t\t\tskipHydration: true, // CRITICAL: Prevents hydration mismatch with Next.js 16\n\t\t\t\t// Don't persist the Maps directly, convert to arrays\n\t\t\t\tpartialize: (state) => ({\n\t\t\t\t\ttechnicians: Array.from(state.technicians.values()),\n\t\t\t\t\tjobs: Array.from(state.jobs.values()),\n\t\t\t\t\tlastSync: state.lastSync,\n\t\t\t\t}),\n\t\t\t\t// Rehydrate arrays back to Maps\n\t\t\t\tmerge: (persistedState: any, currentState) => {\n\t\t\t\t\tconst technicians = persistedState?.technicians\n\t\t\t\t\t\t? new Map(\n\t\t\t\t\t\t\t\tpersistedState.technicians.map((t: Technician) => [t.id, t]),\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t: currentState.technicians;\n\n\t\t\t\t\tconst jobs = persistedState?.jobs\n\t\t\t\t\t\t? new Map(persistedState.jobs.map((j: Job) => [j.id, j]))\n\t\t\t\t\t\t: currentState.jobs;\n\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...currentState,\n\t\t\t\t\t\t...persistedState,\n\t\t\t\t\t\ttechnicians,\n\t\t\t\t\t\tjobs,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t},\n\t\t),\n\t),\n);\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1463, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/ui/skeleton.tsx"],"sourcesContent":["// Re-export from @stratos/ui package\nexport * from \"@stratos/ui\";\n"],"names":[],"mappings":"AAAA,qCAAqC;;AACrC"}},
    {"offset": {"line": 1474, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/dispatch-timeline-lazy.tsx"],"sourcesContent":["/**\n * DispatchTimeline - Lazy Loaded Wrapper\n *\n * Performance optimization:\n * - Dynamically imports the full 1638-line dispatch timeline component (~35KB)\n * - Only loads when user switches to \"Day\" view mode\n * - Shows skeleton loading state while importing\n * - Reduces initial schedule page bundle significantly\n */\n\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst DispatchTimeline = dynamic(\n\t() =>\n\t\timport(\"./dispatch-timeline\").then((mod) => ({\n\t\t\tdefault: mod.DispatchTimeline,\n\t\t})),\n\t{\n\t\tloading: () => (\n\t\t\t<div className=\"flex h-full w-full flex-col gap-4 p-4\">\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<Skeleton className=\"h-10 w-32\" />\n\t\t\t\t\t<Skeleton className=\"h-10 w-32\" />\n\t\t\t\t\t<Skeleton className=\"h-10 flex-1\" />\n\t\t\t\t</div>\n\t\t\t\t<Skeleton className=\"h-full w-full\" />\n\t\t\t</div>\n\t\t),\n\t\tssr: false, // Complex timeline requires browser environment\n\t},\n);\n\nexport function DispatchTimelineLazy() {\n\treturn <DispatchTimeline />;\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;CAQC;;;;;AAID;AACA;AAAA;;AAHA;;;;AAKA,MAAM,mBAAmB,IAAA,oVAAO,EAC/B,IACC,wJAA8B,IAAI,CAAC,CAAC,MAAQ,CAAC;YAC5C,SAAS,IAAI,gBAAgB;QAC9B,CAAC;;;;;;IAED,SAAS,kBACR,oWAAC;YAAI,WAAU;;8BACd,oWAAC;oBAAI,WAAU;;sCACd,oWAAC,iJAAQ;4BAAC,WAAU;;;;;;sCACpB,oWAAC,iJAAQ;4BAAC,WAAU;;;;;;sCACpB,oWAAC,iJAAQ;4BAAC,WAAU;;;;;;;;;;;;8BAErB,oWAAC,iJAAQ;oBAAC,WAAU;;;;;;;;;;;;IAGtB,KAAK;;KAhBD;AAoBC,SAAS;IACf,qBAAO,oWAAC;;;;;AACT;MAFgB"}},
    {"offset": {"line": 1570, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/kanban-view-lazy.tsx"],"sourcesContent":["/**\n * KanbanView - Lazy Loaded Wrapper\n *\n * Performance optimization:\n * - Dynamically imports the full kanban view component (~15KB)\n * - Only loads when user switches to \"Week\" view mode\n * - Shows skeleton loading state while importing\n * - Reduces initial schedule page bundle\n */\n\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst KanbanView = dynamic(\n\t() => import(\"./kanban-view\").then((mod) => ({ default: mod.KanbanView })),\n\t{\n\t\tloading: () => (\n\t\t\t<div className=\"flex h-full w-full gap-4 p-4\">\n\t\t\t\t{Array.from({ length: 7 }).map((_, i) => (\n\t\t\t\t\t<div key={i} className=\"flex flex-1 flex-col gap-2\">\n\t\t\t\t\t\t<Skeleton className=\"h-8 w-full\" />\n\t\t\t\t\t\t<Skeleton className=\"h-32 w-full\" />\n\t\t\t\t\t\t<Skeleton className=\"h-32 w-full\" />\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t),\n\t\tssr: false, // Kanban DnD requires browser environment\n\t},\n);\n\nexport function KanbanViewLazy() {\n\treturn <KanbanView />;\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;CAQC;;;;;AAID;AACA;AAAA;;AAHA;;;;AAKA,MAAM,aAAa,IAAA,oVAAO,EACzB,IAAM,kJAAwB,IAAI,CAAC,CAAC,MAAQ,CAAC;YAAE,SAAS,IAAI,UAAU;QAAC,CAAC;;;;;;IAEvE,SAAS,kBACR,oWAAC;YAAI,WAAU;sBACb,MAAM,IAAI,CAAC;gBAAE,QAAQ;YAAE,GAAG,GAAG,CAAC,CAAC,GAAG,kBAClC,oWAAC;oBAAY,WAAU;;sCACtB,oWAAC,iJAAQ;4BAAC,WAAU;;;;;;sCACpB,oWAAC,iJAAQ;4BAAC,WAAU;;;;;;sCACpB,oWAAC,iJAAQ;4BAAC,WAAU;;;;;;;mBAHX;;;;;;;;;;IAQb,KAAK;;KAdD;AAkBC,SAAS;IACf,qBAAO,oWAAC;;;;;AACT;MAFgB"}},
    {"offset": {"line": 1659, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/empty-state-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { Calendar, Search, Users } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * EmptyStateMobile - Mobile-optimized empty state component\n *\n * Shows helpful messages and CTAs when:\n * - No jobs scheduled\n * - No search/filter results\n * - No unassigned jobs\n * - Technician has no jobs today\n *\n * Design:\n * - Icon illustration\n * - Helpful message\n * - Call-to-action button(s)\n * - Centered layout\n * - Compact for mobile screens\n */\n\nexport type EmptyStateVariant =\n\t| \"no_jobs\"\n\t| \"no_results\"\n\t| \"no_unassigned\"\n\t| \"no_jobs_today\";\n\ntype EmptyStateMobileProps = {\n\tvariant: EmptyStateVariant;\n\tonAction?: () => void;\n\tactionLabel?: string;\n\tclassName?: string;\n};\n\nconst emptyStateConfig: Record<\n\tEmptyStateVariant,\n\t{\n\t\ticon: React.ElementType;\n\t\ttitle: string;\n\t\tdescription: string;\n\t\tdefaultActionLabel: string;\n\t}\n> = {\n\tno_jobs: {\n\t\ticon: Calendar,\n\t\ttitle: \"No jobs scheduled\",\n\t\tdescription: \"Get started by scheduling your first appointment\",\n\t\tdefaultActionLabel: \"Schedule Appointment\",\n\t},\n\tno_results: {\n\t\ticon: Search,\n\t\ttitle: \"No jobs found\",\n\t\tdescription: \"Try adjusting your search or filters\",\n\t\tdefaultActionLabel: \"Clear Filters\",\n\t},\n\tno_unassigned: {\n\t\ticon: Users,\n\t\ttitle: \"All jobs assigned\",\n\t\tdescription: \"Great! All jobs have been assigned to technicians\",\n\t\tdefaultActionLabel: \"View Schedule\",\n\t},\n\tno_jobs_today: {\n\t\ticon: Calendar,\n\t\ttitle: \"No jobs today\",\n\t\tdescription: \"This technician has no scheduled jobs for today\",\n\t\tdefaultActionLabel: \"View Full Schedule\",\n\t},\n};\n\nexport function EmptyStateMobile({\n\tvariant,\n\tonAction,\n\tactionLabel,\n\tclassName,\n}: EmptyStateMobileProps) {\n\tconst config = emptyStateConfig[variant];\n\tconst Icon = config.icon;\n\tconst finalActionLabel = actionLabel || config.defaultActionLabel;\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t\"flex flex-col items-center justify-center gap-4 px-6 py-12 text-center\",\n\t\t\t\tclassName\n\t\t\t)}\n\t\t>\n\t\t\t{/* Icon */}\n\t\t\t<div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-muted\">\n\t\t\t\t<Icon className=\"h-8 w-8 text-muted-foreground\" />\n\t\t\t</div>\n\n\t\t\t{/* Title */}\n\t\t\t<div className=\"space-y-2\">\n\t\t\t\t<h3 className=\"text-lg font-semibold\">{config.title}</h3>\n\t\t\t\t<p className=\"text-sm text-muted-foreground max-w-sm\">\n\t\t\t\t\t{config.description}\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t{/* Action button (if provided) */}\n\t\t\t{onAction && (\n\t\t\t\t<Button className=\"mt-2\" onClick={onAction}>\n\t\t\t\t\t{finalActionLabel}\n\t\t\t\t</Button>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AAAA;AACA;AAAA;AACA;AAJA;;;;;AAoCA,MAAM,mBAQF;IACH,SAAS;QACR,MAAM,6SAAQ;QACd,OAAO;QACP,aAAa;QACb,oBAAoB;IACrB;IACA,YAAY;QACX,MAAM,uSAAM;QACZ,OAAO;QACP,aAAa;QACb,oBAAoB;IACrB;IACA,eAAe;QACd,MAAM,oSAAK;QACX,OAAO;QACP,aAAa;QACb,oBAAoB;IACrB;IACA,eAAe;QACd,MAAM,6SAAQ;QACd,OAAO;QACP,aAAa;QACb,oBAAoB;IACrB;AACD;AAEO,SAAS,iBAAiB,EAChC,OAAO,EACP,QAAQ,EACR,WAAW,EACX,SAAS,EACc;IACvB,MAAM,SAAS,gBAAgB,CAAC,QAAQ;IACxC,MAAM,OAAO,OAAO,IAAI;IACxB,MAAM,mBAAmB,eAAe,OAAO,kBAAkB;IAEjE,qBACC,oWAAC;QACA,WAAW,IAAA,2IAAE,EACZ,0EACA;;0BAID,oWAAC;gBAAI,WAAU;0BACd,cAAA,oWAAC;oBAAK,WAAU;;;;;;;;;;;0BAIjB,oWAAC;gBAAI,WAAU;;kCACd,oWAAC;wBAAG,WAAU;kCAAyB,OAAO,KAAK;;;;;;kCACnD,oWAAC;wBAAE,WAAU;kCACX,OAAO,WAAW;;;;;;;;;;;;YAKpB,0BACA,oWAAC,6IAAM;gBAAC,WAAU;gBAAO,SAAS;0BAChC;;;;;;;;;;;;AAKN;KAtCgB"}},
    {"offset": {"line": 1773, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/reschedule-picker-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { format, addDays, startOfDay, setHours, setMinutes } from \"date-fns\";\nimport { Calendar as CalendarIcon, Clock, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Label } from \"@/components/ui/label\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * ReschedulePickerSheet - Date and time picker for rescheduling jobs\n *\n * Features:\n * - Calendar date picker\n * - Time slot selection (30-minute intervals)\n * - Duration estimation based on job type\n * - Visual feedback for selected date/time\n * - Touch-friendly 56px+ buttons\n */\n\ntype ReschedulePickerSheetProps = {\n\tjob: Job | null;\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonConfirm: (job: Job, newStart: Date, newEnd: Date) => void;\n};\n\n// Generate time slots in 30-minute intervals\nconst generateTimeSlots = () => {\n\tconst slots: { label: string; time: string }[] = [];\n\tfor (let hour = 0; hour < 24; hour++) {\n\t\tfor (let minute = 0; minute < 60; minute += 30) {\n\t\t\tconst date = new Date();\n\t\t\tdate.setHours(hour, minute, 0, 0);\n\t\t\tslots.push({\n\t\t\t\tlabel: format(date, \"h:mm a\"),\n\t\t\t\ttime: `${String(hour).padStart(2, \"0\")}:${String(minute).padStart(2, \"0\")}`,\n\t\t\t});\n\t\t}\n\t}\n\treturn slots;\n};\n\nconst TIME_SLOTS = generateTimeSlots();\n\n// Business hours shortcuts (6am - 6pm)\nconst BUSINESS_HOURS = TIME_SLOTS.filter((slot) => {\n\tconst [hour] = slot.time.split(\":\").map(Number);\n\treturn hour >= 6 && hour < 18;\n});\n\nexport function ReschedulePickerSheet({\n\tjob,\n\tisOpen,\n\tonClose,\n\tonConfirm,\n}: ReschedulePickerSheetProps) {\n\tconst [selectedDate, setSelectedDate] = useState<Date | undefined>(\n\t\tjob?.scheduled_start ? new Date(job.scheduled_start) : new Date()\n\t);\n\tconst [selectedTime, setSelectedTime] = useState<string>(\n\t\tjob?.scheduled_start ? format(new Date(job.scheduled_start), \"HH:mm\") : \"09:00\"\n\t);\n\tconst [showAllHours, setShowAllHours] = useState(false);\n\n\t// Estimate duration based on job type or use actual duration\n\tconst estimatedDuration = useMemo(() => {\n\t\tif (job?.scheduled_start && job?.scheduled_end) {\n\t\t\tconst start = new Date(job.scheduled_start);\n\t\t\tconst end = new Date(job.scheduled_end);\n\t\t\treturn (end.getTime() - start.getTime()) / (1000 * 60 * 60); // hours\n\t\t}\n\n\t\t// Default estimates based on job title keywords\n\t\tconst title = job?.title?.toLowerCase() || \"\";\n\t\tif (title.includes(\"emergency\")) return 3;\n\t\tif (title.includes(\"install\")) return 4;\n\t\tif (title.includes(\"inspection\")) return 1;\n\t\tif (title.includes(\"maintenance\")) return 2;\n\t\treturn 2; // Default 2 hours\n\t}, [job]);\n\n\t// Calculate new end time\n\tconst newEndTime = useMemo(() => {\n\t\tif (!selectedDate || !selectedTime) return null;\n\n\t\tconst [hours, minutes] = selectedTime.split(\":\").map(Number);\n\t\tconst newStart = startOfDay(selectedDate);\n\t\tsetHours(newStart, hours);\n\t\tsetMinutes(newStart, minutes);\n\n\t\tconst newEnd = new Date(newStart);\n\t\tnewEnd.setHours(newStart.getHours() + Math.floor(estimatedDuration));\n\t\tnewEnd.setMinutes(newStart.getMinutes() + (estimatedDuration % 1) * 60);\n\n\t\treturn newEnd;\n\t}, [selectedDate, selectedTime, estimatedDuration]);\n\n\tconst handleConfirm = () => {\n\t\tif (!job || !selectedDate || !selectedTime || !newEndTime) return;\n\n\t\tconst [hours, minutes] = selectedTime.split(\":\").map(Number);\n\t\tconst newStart = startOfDay(selectedDate);\n\t\tsetHours(newStart, hours);\n\t\tsetMinutes(newStart, minutes);\n\n\t\tonConfirm(job, newStart, newEndTime);\n\t\tonClose();\n\t};\n\n\tif (!job) return null;\n\n\tconst displaySlots = showAllHours ? TIME_SLOTS : BUSINESS_HOURS;\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"90vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold mb-1\">Reschedule Appointment</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{job.customer?.name || \"Unknown Customer\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\tCurrent: {job.scheduled_start ? format(new Date(job.scheduled_start), \"MMM d, h:mm a\") : \"Not scheduled\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Content */}\n\t\t\t\t<ScrollArea className=\"flex-1\" style={{ maxHeight: \"calc(90vh - 240px)\" }}>\n\t\t\t\t\t<div className=\"p-4 space-y-6\">\n\t\t\t\t\t\t{/* Calendar */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<CalendarIcon className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\tSelect Date\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t<div className=\"flex justify-center\">\n\t\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\t\tdisabled={(date) => date < startOfDay(new Date())}\n\t\t\t\t\t\t\t\t\tmode=\"single\"\n\t\t\t\t\t\t\t\t\tonSelect={setSelectedDate}\n\t\t\t\t\t\t\t\t\tselected={selectedDate}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Time Slots */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between mb-2\">\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<Clock className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\tSelect Time\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => setShowAllHours(!showAllHours)}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{showAllHours ? \"Business Hours\" : \"All Hours\"}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 gap-2\">\n\t\t\t\t\t\t\t\t{displaySlots.map((slot) => (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"h-12 text-sm font-medium\",\n\t\t\t\t\t\t\t\t\t\t\tselectedTime === slot.time &&\n\t\t\t\t\t\t\t\t\t\t\t\t\"bg-primary text-primary-foreground hover:bg-primary/90\"\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={slot.time}\n\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedTime(slot.time)}\n\t\t\t\t\t\t\t\t\t\tvariant={selectedTime === slot.time ? \"default\" : \"outline\"}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{slot.label}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Preview */}\n\t\t\t\t\t\t{selectedDate && selectedTime && newEndTime && (\n\t\t\t\t\t\t\t<div className=\"bg-muted/50 rounded-lg p-4 space-y-2\">\n\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium\">New Schedule Preview</p>\n\t\t\t\t\t\t\t\t<div className=\"space-y-1 text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>Date:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{format(selectedDate, \"EEEE, MMMM d, yyyy\")}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>Start:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{format(setHours(setMinutes(selectedDate, parseInt(selectedTime.split(\":\")[1])), parseInt(selectedTime.split(\":\")[0])), \"h:mm a\")}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>End:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{format(newEndTime, \"h:mm a\")}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>Duration:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{estimatedDuration}h\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tdisabled={!selectedDate || !selectedTime}\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tConfirm Reschedule\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2291, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/technician-picker-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { Check, Search, UserCircle, X } from \"lucide-react\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport type { Job, Technician } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * TechnicianPickerSheet - Technician selection for job assignment\n *\n * Features:\n * - Search technicians by name\n * - Shows current workload (jobs assigned)\n * - Visual feedback for selected technician\n * - Touch-friendly 56px+ buttons\n * - Unassign option to remove technician\n */\n\ntype TechnicianPickerSheetProps = {\n\tjob: Job | null;\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonConfirm: (job: Job, technicianId: string | null) => void;\n};\n\nexport function TechnicianPickerSheet({\n\tjob,\n\tisOpen,\n\tonClose,\n\tonConfirm,\n}: TechnicianPickerSheetProps) {\n\t// Get Maps from store (stable references)\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Convert Maps to arrays once (memoized)\n\tconst technicians = useMemo(() => Array.from(techniciansMap.values()), [techniciansMap]);\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst [selectedTechId, setSelectedTechId] = useState<string | null>(\n\t\tjob?.assignedTechnicianId || null\n\t);\n\n\t// Calculate workload for each technician\n\tconst techniciansWithWorkload = useMemo(() => {\n\t\treturn technicians.map((tech) => {\n\t\t\tconst assignedJobs = jobs.filter((j) => j.assignedTechnicianId === tech.id);\n\t\t\tconst activeJobs = assignedJobs.filter(\n\t\t\t\t(j) => ![\"completed\", \"cancelled\", \"closed\"].includes(j.status?.toLowerCase() || \"\")\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...tech,\n\t\t\t\ttotalJobs: assignedJobs.length,\n\t\t\t\tactiveJobs: activeJobs.length,\n\t\t\t};\n\t\t});\n\t}, [technicians, jobs]);\n\n\t// Filter technicians by search query\n\tconst filteredTechnicians = useMemo(() => {\n\t\tif (!searchQuery.trim()) return techniciansWithWorkload;\n\n\t\tconst query = searchQuery.toLowerCase();\n\t\treturn techniciansWithWorkload.filter((tech) =>\n\t\t\ttech.name.toLowerCase().includes(query)\n\t\t);\n\t}, [techniciansWithWorkload, searchQuery]);\n\n\t// Sort: Current assignee first, then by active jobs (least busy first)\n\tconst sortedTechnicians = useMemo(() => {\n\t\treturn [...filteredTechnicians].sort((a, b) => {\n\t\t\t// Current assignee always first\n\t\t\tif (a.id === job?.assignedTechnicianId) return -1;\n\t\t\tif (b.id === job?.assignedTechnicianId) return 1;\n\n\t\t\t// Then sort by active jobs (least busy first)\n\t\t\treturn a.activeJobs - b.activeJobs;\n\t\t});\n\t}, [filteredTechnicians, job]);\n\n\tconst handleConfirm = () => {\n\t\tif (!job) return;\n\t\tonConfirm(job, selectedTechId);\n\t\tonClose();\n\t};\n\n\tif (!job) return null;\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"85vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold mb-1\">Assign Technician</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{job.customer?.name || \"Unknown Customer\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">{job.title}</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Search */}\n\t\t\t\t<div className=\"px-4 pt-4\">\n\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tclassName=\"h-11 pl-10 text-base\"\n\t\t\t\t\t\t\tonChange={(e) => setSearchQuery(e.target.value)}\n\t\t\t\t\t\t\tplaceholder=\"Search technicians...\"\n\t\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\t\tvalue={searchQuery}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Unassign Option */}\n\t\t\t\t{job.assignedTechnicianId && (\n\t\t\t\t\t<div className=\"px-4 pt-3\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-orange-500/50 active:scale-98\",\n\t\t\t\t\t\t\t\tselectedTechId === null\n\t\t\t\t\t\t\t\t\t? \"border-orange-500 bg-orange-50 dark:bg-orange-950/20\"\n\t\t\t\t\t\t\t\t\t: \"border-border\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={() => setSelectedTechId(null)}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"flex h-12 w-12 items-center justify-center rounded-full bg-orange-100 dark:bg-orange-900\">\n\t\t\t\t\t\t\t\t<UserCircle className=\"h-6 w-6 text-orange-600 dark:text-orange-400\" />\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"flex-1 text-left\">\n\t\t\t\t\t\t\t\t<p className=\"text-base font-semibold\">Unassign Technician</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tRemove technician from this job\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{selectedTechId === null && (\n\t\t\t\t\t\t\t\t<Check className=\"h-5 w-5 text-orange-600 shrink-0\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t{/* Technician List */}\n\t\t\t\t<ScrollArea className=\"flex-1\" style={{ maxHeight: \"calc(85vh - 280px)\" }}>\n\t\t\t\t\t<div className=\"p-4 space-y-2\">\n\t\t\t\t\t\t{sortedTechnicians.length === 0 ? (\n\t\t\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t\t\t<UserCircle className=\"h-12 w-12 text-muted-foreground/50 mb-3\" />\n\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium mb-1\">No technicians found</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tTry a different search term\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tsortedTechnicians.map((tech) => {\n\t\t\t\t\t\t\t\tconst isSelected = selectedTechId === tech.id;\n\t\t\t\t\t\t\t\tconst isCurrentAssignee = job.assignedTechnicianId === tech.id;\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-primary/50 active:scale-98\",\n\t\t\t\t\t\t\t\t\t\t\tisSelected\n\t\t\t\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"border-border\"\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedTechId(tech.id)}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Avatar className=\"h-12 w-12\">\n\t\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tech.name.split(\" \").map((n) => n[0]).join(\"\").toUpperCase().slice(0, 2)}\n\t\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t\t</Avatar>\n\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 text-left\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-base font-semibold\">{tech.name}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t{isCurrentAssignee && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge className=\"h-5 px-2 text-[9px]\" variant=\"secondary\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCurrent\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span>{tech.activeJobs} active</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span>{tech.totalJobs} total</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t{/* Workload indicator */}\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-col items-end\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"h-2 w-16 rounded-full bg-muted overflow-hidden\"\n\t\t\t\t\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"h-full transition-all\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs === 0 && \"bg-green-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs > 0 && tech.activeJobs <= 3 && \"bg-blue-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs > 3 && tech.activeJobs <= 6 && \"bg-yellow-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs > 6 && \"bg-red-500\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{ width: `${Math.min((tech.activeJobs / 10) * 100, 100)}%` }}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t{isSelected && (\n\t\t\t\t\t\t\t\t\t\t\t\t<Check className=\"h-5 w-5 text-primary\" />\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tdisabled={selectedTechId === job.assignedTechnicianId}\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{selectedTechId === null ? \"Unassign\" : \"Assign Technician\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2862, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/status-picker-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport {\n\tCalendar,\n\tCheckCircle,\n\tCheckCircle2,\n\tClock,\n\tMapPin,\n\tNavigation,\n\tTruck,\n\tX,\n\tXCircle,\n} from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * StatusPickerSheet - Status selection for job workflow\n *\n * Features:\n * - Visual status options with icons and colors\n * - Status descriptions for clarity\n * - Workflow suggestions (next logical status)\n * - Touch-friendly 64px+ buttons\n * - Disabled states for invalid transitions\n */\n\ntype StatusPickerSheetProps = {\n\tjob: Job | null;\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonConfirm: (job: Job, newStatus: string) => void;\n};\n\n// Status configuration\nconst STATUS_OPTIONS = [\n\t{\n\t\tid: \"unscheduled\",\n\t\tlabel: \"Unscheduled\",\n\t\ticon: Clock,\n\t\tcolor: \"bg-gray-500\",\n\t\tborderColor: \"border-gray-500\",\n\t\tdescription: \"No date/time assigned\",\n\t},\n\t{\n\t\tid: \"scheduled\",\n\t\tlabel: \"Scheduled\",\n\t\ticon: Calendar,\n\t\tcolor: \"bg-blue-500\",\n\t\tborderColor: \"border-blue-500\",\n\t\tdescription: \"Date and time confirmed\",\n\t},\n\t{\n\t\tid: \"dispatched\",\n\t\tlabel: \"Dispatched\",\n\t\ticon: Truck,\n\t\tcolor: \"bg-sky-500\",\n\t\tborderColor: \"border-sky-500\",\n\t\tdescription: \"Technician on the way\",\n\t},\n\t{\n\t\tid: \"arrived\",\n\t\tlabel: \"Arrived\",\n\t\ticon: MapPin,\n\t\tcolor: \"bg-emerald-400\",\n\t\tborderColor: \"border-emerald-400\",\n\t\tdescription: \"Technician at location\",\n\t},\n\t{\n\t\tid: \"in_progress\",\n\t\tlabel: \"In Progress\",\n\t\ticon: Navigation,\n\t\tcolor: \"bg-amber-500 animate-pulse\",\n\t\tborderColor: \"border-amber-500\",\n\t\tdescription: \"Work actively underway\",\n\t},\n\t{\n\t\tid: \"closed\",\n\t\tlabel: \"Closed\",\n\t\ticon: CheckCircle,\n\t\tcolor: \"bg-emerald-600\",\n\t\tborderColor: \"border-emerald-600\",\n\t\tdescription: \"Work completed, awaiting review\",\n\t},\n\t{\n\t\tid: \"completed\",\n\t\tlabel: \"Completed\",\n\t\ticon: CheckCircle2,\n\t\tcolor: \"bg-green-700\",\n\t\tborderColor: \"border-green-700\",\n\t\tdescription: \"Fully complete and approved\",\n\t},\n\t{\n\t\tid: \"cancelled\",\n\t\tlabel: \"Cancelled\",\n\t\ticon: XCircle,\n\t\tcolor: \"bg-red-500\",\n\t\tborderColor: \"border-red-500\",\n\t\tdescription: \"Job cancelled or abandoned\",\n\t},\n] as const;\n\n// Workflow logic: what statuses make sense from current status\nconst getValidTransitions = (currentStatus?: string): string[] => {\n\tconst status = currentStatus?.toLowerCase() || \"unscheduled\";\n\n\tswitch (status) {\n\t\tcase \"unscheduled\":\n\t\t\treturn [\"scheduled\"];\n\t\tcase \"scheduled\":\n\t\t\treturn [\"dispatched\", \"cancelled\"];\n\t\tcase \"dispatched\":\n\t\t\treturn [\"arrived\", \"scheduled\", \"cancelled\"];\n\t\tcase \"arrived\":\n\t\t\treturn [\"in_progress\", \"dispatched\", \"cancelled\"];\n\t\tcase \"in_progress\":\n\t\t\treturn [\"closed\", \"arrived\"];\n\t\tcase \"closed\":\n\t\t\treturn [\"completed\", \"in_progress\"];\n\t\tcase \"completed\":\n\t\t\treturn []; // Terminal state\n\t\tcase \"cancelled\":\n\t\t\treturn [\"scheduled\"]; // Can re-schedule\n\t\tdefault:\n\t\t\treturn [\"scheduled\"];\n\t}\n};\n\nexport function StatusPickerSheet({\n\tjob,\n\tisOpen,\n\tonClose,\n\tonConfirm,\n}: StatusPickerSheetProps) {\n\tconst [selectedStatus, setSelectedStatus] = useState<string | null>(\n\t\tjob?.status?.toLowerCase() || null\n\t);\n\n\tconst currentStatus = job?.status?.toLowerCase() || \"unscheduled\";\n\tconst validTransitions = getValidTransitions(currentStatus);\n\n\tconst handleConfirm = () => {\n\t\tif (!job || !selectedStatus) return;\n\t\tonConfirm(job, selectedStatus);\n\t\tonClose();\n\t};\n\n\tif (!job) return null;\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"85vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold mb-1\">Change Status</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{job.customer?.name || \"Unknown Customer\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground capitalize\">\n\t\t\t\t\t\t\tCurrent: {currentStatus.replace(/_/g, \" \")}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Status Options */}\n\t\t\t\t<ScrollArea className=\"flex-1\" style={{ maxHeight: \"calc(85vh - 220px)\" }}>\n\t\t\t\t\t<div className=\"p-4 space-y-3\">\n\t\t\t\t\t\t{/* Suggested next statuses */}\n\t\t\t\t\t\t{validTransitions.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"mb-4\">\n\t\t\t\t\t\t\t\t<p className=\"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\tSuggested Next Steps\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{STATUS_OPTIONS.map((statusOption) => {\n\t\t\t\t\t\t\tconst isSelected = selectedStatus === statusOption.id;\n\t\t\t\t\t\t\tconst isCurrent = currentStatus === statusOption.id;\n\t\t\t\t\t\t\tconst isValid = validTransitions.includes(statusOption.id);\n\t\t\t\t\t\t\tconst isSuggested = isValid && !isCurrent;\n\t\t\t\t\t\t\tconst isDisabled = isCurrent || (!isValid && validTransitions.length > 0);\n\n\t\t\t\t\t\t\tconst StatusIcon = statusOption.icon;\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"flex w-full items-start gap-3 rounded-lg border-2 p-4 transition-all text-left\",\n\t\t\t\t\t\t\t\t\t\tisDisabled\n\t\t\t\t\t\t\t\t\t\t\t? \"opacity-50 cursor-not-allowed\"\n\t\t\t\t\t\t\t\t\t\t\t: \"hover:border-primary/50 active:scale-98\",\n\t\t\t\t\t\t\t\t\t\tisSelected && !isDisabled && \"border-primary bg-primary/5\",\n\t\t\t\t\t\t\t\t\t\tisSuggested && !isSelected && \"border-green-500/30 bg-green-50 dark:bg-green-950/20\",\n\t\t\t\t\t\t\t\t\t\tisCurrent && \"border-muted-foreground bg-muted\",\n\t\t\t\t\t\t\t\t\t\t!isSelected && !isSuggested && !isCurrent && \"border-border\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\t\t\t\t\tkey={statusOption.id}\n\t\t\t\t\t\t\t\t\tonClick={() => !isDisabled && setSelectedStatus(statusOption.id)}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{/* Icon */}\n\t\t\t\t\t\t\t\t\t<div className={cn(\n\t\t\t\t\t\t\t\t\t\t\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full\",\n\t\t\t\t\t\t\t\t\t\tstatusOption.color,\n\t\t\t\t\t\t\t\t\t\tisDisabled && \"opacity-50\"\n\t\t\t\t\t\t\t\t\t)}>\n\t\t\t\t\t\t\t\t\t\t<StatusIcon className=\"h-6 w-6 text-white\" />\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Content */}\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-base font-semibold\">\n\t\t\t\t\t\t\t\t\t\t\t\t{statusOption.label}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t{isCurrent && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-[10px] px-2 py-0.5 bg-muted-foreground/20 rounded-full font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tCurrent\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{isSuggested && !isSelected && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-[10px] px-2 py-0.5 bg-green-500 text-white rounded-full font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tRecommended\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{statusOption.description}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Selection indicator */}\n\t\t\t\t\t\t\t\t\t{isSelected && !isDisabled && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex shrink-0 items-center justify-center h-6 w-6 rounded-full bg-primary\">\n\t\t\t\t\t\t\t\t\t\t\t<CheckCircle className=\"h-4 w-4 text-primary-foreground\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\n\t\t\t\t\t\t{/* All other statuses */}\n\t\t\t\t\t\t{validTransitions.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"pt-4 border-t\">\n\t\t\t\t\t\t\t\t<p className=\"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\tOther Statuses\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mb-3\">\n\t\t\t\t\t\t\t\t\tThese transitions may not be typical for the current workflow\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tdisabled={!selectedStatus || selectedStatus === currentStatus}\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tUpdate Status\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3333, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/job-actions-bottom-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { format } from \"date-fns\";\nimport {\n\tArrowRight,\n\tCalendar,\n\tCheckCircle2,\n\tClock,\n\tMapPin,\n\tNavigation,\n\tRepeat,\n\tTrash2,\n\tUser,\n\tUsers,\n\tX,\n} from \"lucide-react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { ReschedulePickerSheet } from \"./reschedule-picker-sheet\";\nimport { TechnicianPickerSheet } from \"./technician-picker-sheet\";\nimport { StatusPickerSheet } from \"./status-picker-sheet\";\n\n/**\n * JobActionsBottomSheet - Mobile bottom drawer for job actions\n *\n * Replaces desktop context menus and drag-and-drop interactions.\n * Provides large touch-friendly buttons for all job actions.\n *\n * Design:\n * - Slides up from bottom (native iOS/Android pattern)\n * - Backdrop dims background\n * - Swipe down to dismiss\n * - Large action buttons (56px height minimum)\n * - Context-aware actions (only show relevant actions based on status)\n * - Nested pickers for reschedule/reassign/status changes\n *\n * Actions:\n * - View Details: Navigate to full job page\n * - Dispatch: Change status to dispatched\n * - Arrive: Change status to arrived\n * - Start: Change status to in progress\n * - Complete: Change status to completed\n * - Reschedule: Open date/time picker (nested)\n * - Reassign: Open technician picker (nested)\n * - Move to Status: Open status picker (nested)\n * - Cancel Job: Confirmation modal + change to cancelled\n *\n * Props:\n * - isOpen: Controls visibility\n * - onClose: Callback to close sheet\n * - job: Job data to display\n * - onAction: Callback when action is selected\n */\n\ntype JobAction =\n\t| \"view_details\"\n\t| \"dispatch\"\n\t| \"arrive\"\n\t| \"start\"\n\t| \"complete\"\n\t| \"reschedule\"\n\t| \"reassign\"\n\t| \"move_to_status\"\n\t| \"cancel\";\n\ntype JobActionsBottomSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tjob: Job | null;\n\tonAction: (action: string, job: Job, ...args: any[]) => void;\n};\n\n// Animation duration (must match CSS transition)\nconst ANIMATION_DURATION = 300;\n\nexport function JobActionsBottomSheet({\n\tisOpen,\n\tonClose,\n\tjob,\n\tonAction,\n}: JobActionsBottomSheetProps) {\n\tconst [isClosing, setIsClosing] = useState(false);\n\tconst [activePickerJob, setActivePickerJob] = useState<Job | null>(null);\n\tconst [activePicker, setActivePicker] = useState<\"reschedule\" | \"reassign\" | \"status\" | null>(null);\n\tconst sheetRef = useRef<HTMLDivElement>(null);\n\n\t// Handle closing animation\n\tconst handleClose = useCallback(() => {\n\t\tsetIsClosing(true);\n\t\tsetTimeout(() => {\n\t\t\tonClose();\n\t\t\tsetIsClosing(false);\n\t\t}, ANIMATION_DURATION);\n\t}, [onClose]);\n\n\t// Close on backdrop click\n\tuseEffect(() => {\n\t\tconst handleBackdropClick = (event: MouseEvent) => {\n\t\t\tif (sheetRef.current && !sheetRef.current.contains(event.target as Node)) {\n\t\t\t\thandleClose();\n\t\t\t}\n\t\t};\n\n\t\tif (isOpen) {\n\t\t\tdocument.addEventListener(\"mousedown\", handleBackdropClick);\n\t\t}\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"mousedown\", handleBackdropClick);\n\t\t};\n\t}, [isOpen, handleClose]);\n\n\t// Close on escape key\n\tuseEffect(() => {\n\t\tconst handleEscape = (event: KeyboardEvent) => {\n\t\t\tif (event.key === \"Escape\") {\n\t\t\t\thandleClose();\n\t\t\t}\n\t\t};\n\n\t\tif (isOpen) {\n\t\t\tdocument.addEventListener(\"keydown\", handleEscape);\n\t\t}\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"keydown\", handleEscape);\n\t\t};\n\t}, [isOpen, handleClose]);\n\n\t// Reset picker state when main sheet opens/closes\n\tuseEffect(() => {\n\t\tif (!isOpen) {\n\t\t\tsetActivePicker(null);\n\t\t\tsetActivePickerJob(null);\n\t\t}\n\t}, [isOpen]);\n\n\t// Handle action button clicks\n\tconst handleActionClick = useCallback((action: JobAction, currentJob: Job) => {\n\t\t// For actions that need a picker, open the picker instead of directly calling onAction\n\t\tif (action === \"reschedule\") {\n\t\t\tsetActivePickerJob(currentJob);\n\t\t\tsetActivePicker(\"reschedule\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === \"reassign\") {\n\t\t\tsetActivePickerJob(currentJob);\n\t\t\tsetActivePicker(\"reassign\");\n\t\t\treturn;\n\t\t}\n\n\t\tif (action === \"move_to_status\") {\n\t\t\tsetActivePickerJob(currentJob);\n\t\t\tsetActivePicker(\"status\");\n\t\t\treturn;\n\t\t}\n\n\t\t// For direct actions, call onAction immediately\n\t\tonAction(action, currentJob);\n\t\thandleClose();\n\t}, [onAction, handleClose]);\n\n\t// Handle picker confirmations\n\tconst handleRescheduleConfirm = useCallback((currentJob: Job, newStart: Date, newEnd: Date) => {\n\t\tonAction(\"reschedule\", currentJob, newStart, newEnd);\n\t\tsetActivePicker(null);\n\t\tsetActivePickerJob(null);\n\t\thandleClose();\n\t}, [onAction, handleClose]);\n\n\tconst handleReassignConfirm = useCallback((currentJob: Job, technicianId: string | null) => {\n\t\tonAction(\"reassign\", currentJob, technicianId);\n\t\tsetActivePicker(null);\n\t\tsetActivePickerJob(null);\n\t\thandleClose();\n\t}, [onAction, handleClose]);\n\n\tconst handleStatusConfirm = useCallback((currentJob: Job, newStatus: string) => {\n\t\tonAction(\"move_to_status\", currentJob, newStatus);\n\t\tsetActivePicker(null);\n\t\tsetActivePickerJob(null);\n\t\thandleClose();\n\t}, [onAction, handleClose]);\n\n\tconst handlePickerClose = useCallback(() => {\n\t\tsetActivePicker(null);\n\t\tsetActivePickerJob(null);\n\t}, []);\n\n\tif (!isOpen && !isClosing) {\n\t\treturn null;\n\t}\n\n\tif (!job) {\n\t\treturn null;\n\t}\n\n\t// Get current status\n\tconst status = (job.status?.toLowerCase().replace(/ /g, \"_\") || \"unscheduled\") as string;\n\n\t// Determine which actions to show based on current status\n\tconst availableActions: JobAction[] = [];\n\n\t// Status-specific actions\n\tif (status === \"scheduled\") {\n\t\tavailableActions.push(\"dispatch\");\n\t}\n\tif (status === \"dispatched\") {\n\t\tavailableActions.push(\"arrive\");\n\t}\n\tif (status === \"arrived\") {\n\t\tavailableActions.push(\"start\");\n\t}\n\tif (status === \"in_progress\") {\n\t\tavailableActions.push(\"complete\");\n\t}\n\n\t// Always available actions\n\tavailableActions.push(\"reschedule\", \"reassign\", \"move_to_status\");\n\n\t// Cancel action (always last)\n\tif (status !== \"cancelled\" && status !== \"completed\") {\n\t\tavailableActions.push(\"cancel\");\n\t}\n\n\t// Always show view details\n\tavailableActions.unshift(\"view_details\");\n\n\t// Format job details\n\tconst customerName = job.customer?.name || \"No Customer\";\n\tconst propertyAddress = job.location?.address?.street || \"No location\";\n\tconst startTime = job.startTime\n\t\t? format(new Date(job.startTime), \"MMM d, h:mm a\")\n\t\t: \"Not scheduled\";\n\tconst endTime = job.endTime\n\t\t? format(new Date(job.endTime), \"h:mm a\")\n\t\t: \"\";\n\tconst timeDisplay = endTime ? `${startTime} - ${endTime}` : startTime;\n\n\t// Get primary technician from assignments\n\tconst primaryAssignment = job.assignments.find(a => a.role === 'primary');\n\tconst techInitials = primaryAssignment?.displayName\n\t\t? primaryAssignment.displayName.split(\" \").map(n => n[0]).join(\"\").toUpperCase().slice(0, 2)\n\t\t: \"?\";\n\n\t// Calculate duration\n\tconst duration = job.startTime && job.endTime\n\t\t? Math.round(\n\t\t\t\t(new Date(job.endTime).getTime() -\n\t\t\t\t\tnew Date(job.startTime).getTime()) /\n\t\t\t\t\t(1000 * 60 * 60)\n\t\t  )\n\t\t: 0;\n\n\t// Action button configuration\n\tconst actionConfig: Record<\n\t\tJobAction,\n\t\t{ icon: React.ElementType; label: string; variant?: \"default\" | \"destructive\" }\n\t> = {\n\t\tview_details: { icon: ArrowRight, label: \"View Full Details\" },\n\t\tdispatch: { icon: Navigation, label: \"Dispatch Job\" },\n\t\tarrive: { icon: MapPin, label: \"Mark as Arrived\" },\n\t\tstart: { icon: Clock, label: \"Start Job\" },\n\t\tcomplete: { icon: CheckCircle2, label: \"Mark as Complete\" },\n\t\treschedule: { icon: Calendar, label: \"Reschedule\" },\n\t\treassign: { icon: Users, label: \"Reassign Technician\" },\n\t\tmove_to_status: { icon: Repeat, label: \"Move to Status...\" },\n\t\tcancel: { icon: Trash2, label: \"Cancel Job\", variant: \"destructive\" },\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm\",\n\t\t\t\t\tisClosing ? \"animate-out fade-out duration-300\" : \"animate-in fade-in duration-300\"\n\t\t\t\t)}\n\t\t\t/>\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"safe-bottom fixed bottom-0 left-0 right-0 z-50 rounded-t-3xl border-t border-border bg-background shadow-2xl\",\n\t\t\t\t\tisClosing\n\t\t\t\t\t\t? \"animate-out slide-out-to-bottom duration-300\"\n\t\t\t\t\t\t: \"animate-in slide-in-from-bottom duration-300\"\n\t\t\t\t)}\n\t\t\t\tref={sheetRef}\n\t\t\t>\n\t\t\t\t{/* Handle indicator */}\n\t\t\t\t<div className=\"flex justify-center py-4\">\n\t\t\t\t\t<div className=\"h-1.5 w-10 rounded-full bg-muted\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Scrollable content */}\n\t\t\t\t<div className=\"max-h-[80vh] overflow-y-auto px-6 pb-6\">\n\t\t\t\t\t{/* Header: Close button */}\n\t\t\t\t\t<div className=\"flex items-center justify-between mb-4\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold\">Job Actions</h2>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\t\tonClick={handleClose}\n\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Job Summary */}\n\t\t\t\t\t<div className=\"mb-6 space-y-3 rounded-lg border bg-muted/50 p-4\">\n\t\t\t\t\t\t{/* Customer & Title */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 className=\"text-base font-medium leading-tight\">{customerName}</h3>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mt-0.5\">\n\t\t\t\t\t\t\t\t{job.title || \"Untitled Job\"}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Details grid */}\n\t\t\t\t\t\t<div className=\"space-y-2 text-sm\">\n\t\t\t\t\t\t\t{/* Time */}\n\t\t\t\t\t\t\t<div className=\"flex items-start gap-2\">\n\t\t\t\t\t\t\t\t<Clock className=\"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">{timeDisplay}</p>\n\t\t\t\t\t\t\t\t\t{duration > 0 && (\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{duration} {duration === 1 ? \"hour\" : \"hours\"}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* Location */}\n\t\t\t\t\t\t\t{propertyAddress !== \"No location\" && (\n\t\t\t\t\t\t\t\t<div className=\"flex items-start gap-2\">\n\t\t\t\t\t\t\t\t\t<MapPin className=\"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t<p>{propertyAddress}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{/* Assigned Technician */}\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<User className=\"h-4 w-4 shrink-0 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<Avatar className=\"h-6 w-6\">\n\t\t\t\t\t\t\t\t\t\t<AvatarImage\n\t\t\t\t\t\t\t\t\t\t\talt={primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t\t\t\t\t\tsrc={primaryAssignment?.avatar || undefined}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t{techInitials}\n\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t{primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* Status Badge */}\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<Badge variant=\"secondary\" className=\"capitalize\">\n\t\t\t\t\t\t\t\t\t{job.status || \"Unscheduled\"}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Description (if exists) */}\n\t\t\t\t\t\t{job.description && (\n\t\t\t\t\t\t\t<div className=\"pt-2 border-t\">\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground line-clamp-2\">\n\t\t\t\t\t\t\t\t\t{job.description}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Action Buttons */}\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-muted-foreground mb-3\">\n\t\t\t\t\t\t\tActions\n\t\t\t\t\t\t</h3>\n\n\t\t\t\t\t\t{availableActions.map((action) => {\n\t\t\t\t\t\t\tconst config = actionConfig[action];\n\t\t\t\t\t\t\tconst Icon = config.icon;\n\t\t\t\t\t\t\tconst isDestructive = config.variant === \"destructive\";\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"h-14 w-full justify-start gap-3 text-base font-medium\",\n\t\t\t\t\t\t\t\t\t\tisDestructive && \"text-destructive hover:text-destructive\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tkey={action}\n\t\t\t\t\t\t\t\t\tonClick={() => handleActionClick(action, job)}\n\t\t\t\t\t\t\t\t\tvariant={isDestructive ? \"ghost\" : \"outline\"}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Icon className=\"h-5 w-5\" />\n\t\t\t\t\t\t\t\t\t{config.label}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Nested Picker Sheets */}\n\t\t\t<ReschedulePickerSheet\n\t\t\t\tisOpen={activePicker === \"reschedule\"}\n\t\t\t\tjob={activePickerJob}\n\t\t\t\tonClose={handlePickerClose}\n\t\t\t\tonConfirm={handleRescheduleConfirm}\n\t\t\t/>\n\n\t\t\t<TechnicianPickerSheet\n\t\t\t\tisOpen={activePicker === \"reassign\"}\n\t\t\t\tjob={activePickerJob}\n\t\t\t\tonClose={handlePickerClose}\n\t\t\t\tonConfirm={handleReassignConfirm}\n\t\t\t/>\n\n\t\t\t<StatusPickerSheet\n\t\t\t\tisOpen={activePicker === \"status\"}\n\t\t\t\tjob={activePickerJob}\n\t\t\t\tonClose={handlePickerClose}\n\t\t\t\tonConfirm={handleStatusConfirm}\n\t\t\t/>\n\t\t</>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 3971, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/job-card-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { Clock, MapPin, User } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { cn } from \"@/lib/utils\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\n\n/**\n * JobCardMobile - Mobile-optimized job card component\n *\n * Design specifications:\n * - Height: 80px (comfortable touch target, 44px+ recommended)\n * - Full-width layout with clear visual hierarchy\n * - Large touch targets for tap interactions\n * - Displays: customer, time, location, technician, status\n * - Optimized for vertical list scrolling\n *\n * Usage:\n * - List view: Primary job card in vertical scrolling list\n * - Day view: Job card in technician timeline slots\n * - Week view: Job card in kanban columns\n *\n * Interactions:\n * - Tap card: Opens bottom sheet with job details and actions\n * - Long-press: Enters selection mode (future)\n * - Swipe: Quick actions like dispatch/unassign (future)\n */\n\ntype JobStatus =\n\t| \"unscheduled\"\n\t| \"scheduled\"\n\t| \"dispatched\"\n\t| \"arrived\"\n\t| \"in_progress\"\n\t| \"closed\"\n\t| \"completed\"\n\t| \"cancelled\";\n\ntype JobCardMobileProps = {\n\tjob: Job;\n\tonClick?: () => void;\n\tclassName?: string;\n\tshowTechnician?: boolean; // Hide technician info in day view (already grouped by tech)\n\tshowDate?: boolean; // Show date in list/week views, hide in day view (already grouped by date)\n};\n\n// Status badge styles (consistent with desktop)\nconst statusStyles: Record<JobStatus, { bg: string; text: string; label: string }> = {\n\tunscheduled: { bg: \"bg-gray-100 dark:bg-gray-800\", text: \"text-gray-700 dark:text-gray-300\", label: \"Unscheduled\" },\n\tscheduled: { bg: \"bg-blue-100 dark:bg-blue-900/30\", text: \"text-blue-700 dark:text-blue-300\", label: \"Scheduled\" },\n\tdispatched: { bg: \"bg-yellow-100 dark:bg-yellow-900/30\", text: \"text-yellow-700 dark:text-yellow-300\", label: \"Dispatched\" },\n\tarrived: { bg: \"bg-purple-100 dark:bg-purple-900/30\", text: \"text-purple-700 dark:text-purple-300\", label: \"Arrived\" },\n\tin_progress: { bg: \"bg-orange-100 dark:bg-orange-900/30\", text: \"text-orange-700 dark:text-orange-300\", label: \"In Progress\" },\n\tclosed: { bg: \"bg-green-100 dark:bg-green-900/30\", text: \"text-green-700 dark:text-green-300\", label: \"Closed\" },\n\tcompleted: { bg: \"bg-emerald-100 dark:bg-emerald-900/30\", text: \"text-emerald-700 dark:text-emerald-300\", label: \"Completed\" },\n\tcancelled: { bg: \"bg-red-100 dark:bg-red-900/30\", text: \"text-red-700 dark:text-red-300\", label: \"Cancelled\" },\n};\n\nexport function JobCardMobile({\n\tjob,\n\tonClick,\n\tclassName,\n\tshowTechnician = true,\n\tshowDate = true,\n}: JobCardMobileProps) {\n\tconst status = (job.status?.toLowerCase().replace(/ /g, \"_\") || \"unscheduled\") as JobStatus;\n\tconst statusStyle = statusStyles[status] || statusStyles.unscheduled;\n\n\t// Format time (9:00 AM - 10:30 AM)\n\tconst startTime = job.startTime ? format(new Date(job.startTime), \"h:mm a\") : \"Not scheduled\";\n\tconst endTime = job.endTime ? format(new Date(job.endTime), \"h:mm a\") : \"\";\n\tconst timeRange = endTime ? `${startTime} - ${endTime}` : startTime;\n\n\t// Format date (Jan 15)\n\tconst dateDisplay = job.startTime ? format(new Date(job.startTime), \"MMM d\") : \"\";\n\n\t// Get primary technician from assignments\n\tconst primaryAssignment = job.assignments.find(a => a.role === 'primary');\n\tconst techInitials = primaryAssignment?.displayName\n\t\t? primaryAssignment.displayName.split(\" \").map(n => n[0]).join(\"\").toUpperCase().slice(0, 2)\n\t\t: \"?\";\n\n\t// Customer/property info\n\tconst customerName = job.customer?.name || \"No Customer\";\n\tconst locationDisplay = job.location?.address?.street || \"No location\";\n\n\treturn (\n\t\t<button\n\t\t\tclassName={cn(\n\t\t\t\t// Base styles - more compact, full width\n\t\t\t\t\"group relative flex w-full items-center gap-3 rounded-lg border bg-card p-3 text-left transition-all\",\n\t\t\t\t// Reduced height for compact design\n\t\t\t\t\"min-h-[64px]\",\n\t\t\t\t// Hover/active states\n\t\t\t\t\"hover:border-primary/30 hover:bg-primary/5 hover:shadow-sm\",\n\t\t\t\t\"active:scale-[0.99]\",\n\t\t\t\t// Focus states for accessibility\n\t\t\t\t\"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n\t\t\t\tclassName\n\t\t\t)}\n\t\t\tonClick={onClick}\n\t\t\ttype=\"button\"\n\t\t>\n\t\t\t{/* Left: Time */}\n\t\t\t<div className=\"flex flex-col items-center justify-center shrink-0 w-16 text-center\">\n\t\t\t\t<span className=\"text-sm font-semibold leading-tight\">\n\t\t\t\t\t{startTime === \"Not scheduled\" ? \"--:--\" : format(new Date(job.startTime), \"h:mm\")}\n\t\t\t\t</span>\n\t\t\t\t<span className=\"text-[0.65rem] text-muted-foreground uppercase\">\n\t\t\t\t\t{startTime === \"Not scheduled\" ? \"\" : format(new Date(job.startTime), \"a\")}\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t{/* Center: Job info */}\n\t\t\t<div className=\"flex-1 min-w-0 space-y-0.5\">\n\t\t\t\t{/* Customer name */}\n\t\t\t\t<h3 className=\"text-sm font-semibold leading-tight truncate\">\n\t\t\t\t\t{customerName}\n\t\t\t\t</h3>\n\t\t\t\t{/* Job title */}\n\t\t\t\t<p className=\"text-xs text-muted-foreground truncate\">\n\t\t\t\t\t{job.title || \"Untitled Job\"}\n\t\t\t\t</p>\n\t\t\t\t{/* Location - only on mobile, very compact */}\n\t\t\t\t{locationDisplay !== \"No location\" && (\n\t\t\t\t\t<div className=\"flex items-center gap-1 text-[0.65rem] text-muted-foreground\">\n\t\t\t\t\t\t<MapPin className=\"h-2.5 w-2.5\" />\n\t\t\t\t\t\t<span className=\"truncate\">{locationDisplay}</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Right: Status badge + Technician */}\n\t\t\t<div className=\"flex flex-col items-end gap-1.5 shrink-0\">\n\t\t\t\t{/* Status badge - smaller */}\n\t\t\t\t<Badge\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"text-[0.65rem] font-medium h-4 px-1.5\",\n\t\t\t\t\t\tstatusStyle.bg,\n\t\t\t\t\t\tstatusStyle.text\n\t\t\t\t\t)}\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t>\n\t\t\t\t\t{statusStyle.label}\n\t\t\t\t</Badge>\n\n\t\t\t\t{/* Technician avatar - only if showing */}\n\t\t\t\t{showTechnician && (\n\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t<Avatar className=\"h-4 w-4\">\n\t\t\t\t\t\t\t<AvatarImage\n\t\t\t\t\t\t\t\talt={primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t\t\tsrc={primaryAssignment?.avatar || undefined}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<AvatarFallback className=\"text-[0.5rem] font-medium\">\n\t\t\t\t\t\t\t\t{techInitials}\n\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t<span className=\"text-[0.65rem] text-muted-foreground max-w-[60px] truncate\">\n\t\t\t\t\t\t\t{primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</button>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4208, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/search-jobs-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { Search, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n} from \"@/components/ui/sheet\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { JobCardMobile } from \"./job-card-mobile\";\n\n/**\n * SearchJobsSheet - Mobile search interface for jobs\n *\n * Features:\n * - Real-time search as you type\n * - Searches customer name, job title, location\n * - Shows matching jobs in scrollable list\n * - Tap job to view details\n * - Clear search button\n */\n\ntype SearchJobsSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonJobSelect: (job: Job) => void;\n};\n\nexport function SearchJobsSheet({\n\tisOpen,\n\tonClose,\n\tonJobSelect,\n}: SearchJobsSheetProps) {\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Get all jobs as array\n\tconst allJobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\t// Filter jobs by search query\n\tconst filteredJobs = useMemo(() => {\n\t\tif (!searchQuery.trim()) return [];\n\n\t\tconst query = searchQuery.toLowerCase();\n\n\t\treturn allJobs.filter((job) => {\n\t\t\t// Search customer name\n\t\t\tconst customerName = job.customer?.name?.toLowerCase() || \"\";\n\t\t\tif (customerName.includes(query)) return true;\n\n\t\t\t// Search job title\n\t\t\tconst jobTitle = job.title?.toLowerCase() || \"\";\n\t\t\tif (jobTitle.includes(query)) return true;\n\n\t\t\t// Search location\n\t\t\tconst location = job.location?.address?.street?.toLowerCase() || \"\";\n\t\t\tif (location.includes(query)) return true;\n\n\t\t\t// Search job number\n\t\t\tconst jobNumber = job.jobNumber?.toString().toLowerCase() || \"\";\n\t\t\tif (jobNumber.includes(query)) return true;\n\n\t\t\treturn false;\n\t\t});\n\t}, [allJobs, searchQuery]);\n\n\tconst handleJobClick = (job: Job) => {\n\t\tonJobSelect(job);\n\t\tonClose();\n\t};\n\n\tconst handleClearSearch = () => {\n\t\tsetSearchQuery(\"\");\n\t};\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={onClose}>\n\t\t\t<SheetContent side=\"top\" className=\"h-[90vh] flex flex-col\">\n\t\t\t\t<SheetHeader>\n\t\t\t\t\t<SheetTitle>Search Jobs</SheetTitle>\n\t\t\t\t</SheetHeader>\n\n\t\t\t\t{/* Search Input */}\n\t\t\t\t<div className=\"relative mt-4\">\n\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n\t\t\t\t\t<Input\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tclassName=\"pl-9 pr-9\"\n\t\t\t\t\t\tonChange={(e) => setSearchQuery(e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Search by customer, job title, location...\"\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tvalue={searchQuery}\n\t\t\t\t\t/>\n\t\t\t\t\t{searchQuery && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0\"\n\t\t\t\t\t\t\tonClick={handleClearSearch}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t<span className=\"sr-only\">Clear search</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Results */}\n\t\t\t\t<div className=\"flex-1 overflow-y-auto mt-4\">\n\t\t\t\t\t{!searchQuery.trim() ? (\n\t\t\t\t\t\t<div className=\"flex h-full items-center justify-center\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<Search className=\"mx-auto h-12 w-12 text-muted-foreground opacity-20\" />\n\t\t\t\t\t\t\t\t<p className=\"mt-4 text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tStart typing to search jobs\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : filteredJobs.length === 0 ? (\n\t\t\t\t\t\t<div className=\"flex h-full items-center justify-center\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<Search className=\"mx-auto h-12 w-12 text-muted-foreground opacity-20\" />\n\t\t\t\t\t\t\t\t<p className=\"mt-4 text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tNo jobs found for &quot;{searchQuery}&quot;\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mb-3\">\n\t\t\t\t\t\t\t\t{filteredJobs.length} {filteredJobs.length === 1 ? \"job\" : \"jobs\"} found\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t{filteredJobs.map((job) => (\n\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\tonClick={() => handleJobClick(job)}\n\t\t\t\t\t\t\t\t\tshowDate={true}\n\t\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4485, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/filter-jobs-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState, useMemo } from \"react\";\nimport { Filter, X, Check } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n} from \"@/components/ui/sheet\";\nimport { Label } from \"@/components/ui/label\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * FilterJobsSheet - Mobile filter interface for jobs\n *\n * Features:\n * - Filter by status (scheduled, dispatched, in progress, etc.)\n * - Filter by technician\n * - Filter by date range\n * - Show unassigned jobs\n * - Apply/Clear filters\n * - Visual indicators for active filters\n */\n\ntype FilterJobsSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tactiveFilters: {\n\t\tstatuses: string[];\n\t\ttechnicianIds: string[];\n\t\tshowUnassignedOnly: boolean;\n\t};\n\tonApplyFilters: (filters: {\n\t\tstatuses: string[];\n\t\ttechnicianIds: string[];\n\t\tshowUnassignedOnly: boolean;\n\t}) => void;\n};\n\nconst STATUS_OPTIONS = [\n\t{ value: \"scheduled\", label: \"Scheduled\", color: \"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300\" },\n\t{ value: \"dispatched\", label: \"Dispatched\", color: \"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300\" },\n\t{ value: \"arrived\", label: \"Arrived\", color: \"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300\" },\n\t{ value: \"in_progress\", label: \"In Progress\", color: \"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300\" },\n\t{ value: \"completed\", label: \"Completed\", color: \"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300\" },\n\t{ value: \"cancelled\", label: \"Cancelled\", color: \"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300\" },\n];\n\nexport function FilterJobsSheet({\n\tisOpen,\n\tonClose,\n\tactiveFilters,\n\tonApplyFilters,\n}: FilterJobsSheetProps) {\n\tconst [selectedStatuses, setSelectedStatuses] = useState<string[]>(activeFilters.statuses);\n\tconst [selectedTechnicianIds, setSelectedTechnicianIds] = useState<string[]>(activeFilters.technicianIds);\n\tconst [showUnassignedOnly, setShowUnassignedOnly] = useState(activeFilters.showUnassignedOnly);\n\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\tconst technicians = useMemo(() => Array.from(techniciansMap.values()), [techniciansMap]);\n\n\tconst toggleStatus = (status: string) => {\n\t\tsetSelectedStatuses((prev) =>\n\t\t\tprev.includes(status)\n\t\t\t\t? prev.filter((s) => s !== status)\n\t\t\t\t: [...prev, status]\n\t\t);\n\t};\n\n\tconst toggleTechnician = (techId: string) => {\n\t\tsetSelectedTechnicianIds((prev) =>\n\t\t\tprev.includes(techId)\n\t\t\t\t? prev.filter((id) => id !== techId)\n\t\t\t\t: [...prev, techId]\n\t\t);\n\t};\n\n\tconst handleApply = () => {\n\t\tonApplyFilters({\n\t\t\tstatuses: selectedStatuses,\n\t\t\ttechnicianIds: selectedTechnicianIds,\n\t\t\tshowUnassignedOnly,\n\t\t});\n\t\tonClose();\n\t};\n\n\tconst handleClear = () => {\n\t\tsetSelectedStatuses([]);\n\t\tsetSelectedTechnicianIds([]);\n\t\tsetShowUnassignedOnly(false);\n\t};\n\n\tconst hasActiveFilters =\n\t\tselectedStatuses.length > 0 ||\n\t\tselectedTechnicianIds.length > 0 ||\n\t\tshowUnassignedOnly;\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={onClose}>\n\t\t\t<SheetContent side=\"right\" className=\"w-[300px] sm:w-[400px] flex flex-col\">\n\t\t\t\t<SheetHeader>\n\t\t\t\t\t<SheetTitle className=\"flex items-center justify-between\">\n\t\t\t\t\t\t<span>Filter Jobs</span>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"h-8 w-8 p-0\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</SheetTitle>\n\t\t\t\t</SheetHeader>\n\n\t\t\t\t<div className=\"flex-1 overflow-y-auto py-6 space-y-6\">\n\t\t\t\t\t{/* Status Filters */}\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t<Label className=\"text-sm font-semibold\">Status</Label>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t{STATUS_OPTIONS.map((status) => (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors\",\n\t\t\t\t\t\t\t\t\t\tselectedStatuses.includes(status.value)\n\t\t\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5\"\n\t\t\t\t\t\t\t\t\t\t\t: \"border-border hover:bg-muted/50\"\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tkey={status.value}\n\t\t\t\t\t\t\t\t\tonClick={() => toggleStatus(status.value)}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\"text-xs\", status.color)}\n\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{status.label}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t{selectedStatuses.includes(status.value) && (\n\t\t\t\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Technician Filters */}\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t<Label className=\"text-sm font-semibold\">Technician</Label>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t{technicians.map((tech) => {\n\t\t\t\t\t\t\t\tconst initials = tech.name\n\t\t\t\t\t\t\t\t\t.split(\" \")\n\t\t\t\t\t\t\t\t\t.map((n) => n[0])\n\t\t\t\t\t\t\t\t\t.join(\"\")\n\t\t\t\t\t\t\t\t\t.toUpperCase()\n\t\t\t\t\t\t\t\t\t.slice(0, 2);\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors\",\n\t\t\t\t\t\t\t\t\t\t\tselectedTechnicianIds.includes(tech.id)\n\t\t\t\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"border-border hover:bg-muted/50\"\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\t\t\tonClick={() => toggleTechnician(tech.id)}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t<Avatar className=\"h-8 w-8\">\n\t\t\t\t\t\t\t\t\t\t\t\t<AvatarImage alt={tech.name} src={tech.avatar || undefined} />\n\t\t\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{initials}\n\t\t\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium\">{tech.name}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{selectedTechnicianIds.includes(tech.id) && (\n\t\t\t\t\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Unassigned Filter */}\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t<Label className=\"text-sm font-semibold\">Special Filters</Label>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors\",\n\t\t\t\t\t\t\t\tshowUnassignedOnly\n\t\t\t\t\t\t\t\t\t? \"border-yellow-500 bg-yellow-50 dark:bg-yellow-950/20\"\n\t\t\t\t\t\t\t\t\t: \"border-border hover:bg-muted/50\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={() => setShowUnassignedOnly(!showUnassignedOnly)}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"text-sm font-medium\">Show unassigned only</span>\n\t\t\t\t\t\t\t{showUnassignedOnly && (\n\t\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-yellow-600 dark:text-yellow-400\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Footer Actions */}\n\t\t\t\t<div className=\"shrink-0 space-y-2 border-t pt-4\">\n\t\t\t\t\t{hasActiveFilters && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t\tonClick={handleClear}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tClear All Filters\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\tonClick={handleApply}\n\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t>\n\t\t\t\t\t\tApply Filters\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 4881, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/mobile-schedule-header.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n\tFilter,\n\tSearch,\n\tPlus,\n\tBarChart3,\n\tLayoutGrid,\n\tList,\n\tCalendar\n} from \"lucide-react\";\nimport { useState, useMemo } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n\tSheetTrigger,\n} from \"@/components/ui/sheet\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { SearchJobsSheet } from \"./search-jobs-sheet\";\nimport { FilterJobsSheet } from \"./filter-jobs-sheet\";\n\n/**\n * MobileScheduleHeader - Feature-rich mobile toolbar\n *\n * Features:\n * - View mode switcher (Day/Week/List)\n * - Quick stats (Total/Completed/In Progress/Unassigned)\n * - Search jobs\n * - Filter options\n * - Create new job\n */\n\ntype ViewMode = \"day\" | \"week\" | \"list\";\n\ntype MobileScheduleHeaderProps = {\n\tonJobSelect?: (job: Job) => void;\n};\n\nexport function MobileScheduleHeader({ onJobSelect }: MobileScheduleHeaderProps) {\n\tconst router = useRouter();\n\tconst { viewMode, setViewMode } = useScheduleViewStore();\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Local state for sheets\n\tconst [showSearch, setShowSearch] = useState(false);\n\tconst [showFilter, setShowFilter] = useState(false);\n\tconst [activeFilters, setActiveFilters] = useState<{\n\t\tstatuses: string[];\n\t\ttechnicianIds: string[];\n\t\tshowUnassignedOnly: boolean;\n\t}>({\n\t\tstatuses: [],\n\t\ttechnicianIds: [],\n\t\tshowUnassignedOnly: false,\n\t});\n\n\t// Calculate stats\n\tconst stats = useMemo(() => {\n\t\tconst jobs = Array.from(jobsMap.values());\n\t\tconst today = new Date();\n\t\ttoday.setHours(0, 0, 0, 0);\n\n\t\tconst todaysJobs = jobs.filter(job => {\n\t\t\tconst jobDate = new Date(job.startTime);\n\t\t\tjobDate.setHours(0, 0, 0, 0);\n\t\t\treturn jobDate.getTime() === today.getTime();\n\t\t});\n\n\t\treturn {\n\t\t\ttotal: todaysJobs.length,\n\t\t\tcompleted: todaysJobs.filter(j => j.status === \"completed\").length,\n\t\t\tinProgress: todaysJobs.filter(j => j.status === \"in_progress\" || j.status === \"in-progress\").length,\n\t\t\tunassigned: todaysJobs.filter(j => j.isUnassigned).length,\n\t\t};\n\t}, [jobsMap]);\n\n\tconst handleViewModeChange = (mode: ViewMode) => {\n\t\tsetViewMode(mode);\n\t};\n\n\tconst handleCreateJob = () => {\n\t\trouter.push(\"/dashboard/work/jobs/new\");\n\t};\n\n\tconst handleJobSelect = (job: Job) => {\n\t\tif (onJobSelect) {\n\t\t\tonJobSelect(job);\n\t\t}\n\t};\n\n\tconst handleApplyFilters = (filters: typeof activeFilters) => {\n\t\tsetActiveFilters(filters);\n\t\t// TODO: Apply filters to job list\n\t};\n\n\tconst activeFilterCount = activeFilters.statuses.length + activeFilters.technicianIds.length + (activeFilters.showUnassignedOnly ? 1 : 0);\n\n\treturn (\n\t\t<div className=\"safe-top sticky top-0 z-35 border-b bg-background/95 backdrop-blur-sm supports-[backdrop-filter]:bg-background/80\">\n\t\t\t{/* Top row: Actions */}\n\t\t\t<div className=\"flex items-center justify-between gap-2 px-4 py-2.5\">\n\t\t\t\t{/* View mode switcher */}\n\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-lg border p-1\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => handleViewModeChange(\"day\")}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant={viewMode === \"day\" ? \"secondary\" : \"ghost\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Calendar className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Day view</span>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => handleViewModeChange(\"week\")}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant={viewMode === \"week\" ? \"secondary\" : \"ghost\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t<LayoutGrid className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Week view</span>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => handleViewModeChange(\"list\")}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant={viewMode === \"list\" ? \"secondary\" : \"ghost\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t<List className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">List view</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Action buttons */}\n\t\t\t\t<div className=\"flex items-center gap-1.5\">\n\t\t\t\t\t{/* Stats sheet */}\n\t\t\t\t\t<Sheet>\n\t\t\t\t\t\t<SheetTrigger asChild>\n\t\t\t\t\t\t\t<Button className=\"h-9 w-9 p-0\" size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t\t\t<BarChart3 className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t<span className=\"sr-only\">View stats</span>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</SheetTrigger>\n\t\t\t\t\t\t<SheetContent side=\"bottom\" className=\"h-[300px]\">\n\t\t\t\t\t\t\t<SheetHeader>\n\t\t\t\t\t\t\t\t<SheetTitle>Today's Stats</SheetTitle>\n\t\t\t\t\t\t\t</SheetHeader>\n\t\t\t\t\t\t\t<div className=\"mt-6 grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold\">{stats.total}</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Total Jobs</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-green-600\">{stats.completed}</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Completed</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-orange-600\">{stats.inProgress}</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">In Progress</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-yellow-600\">{stats.unassigned}</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Unassigned</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</SheetContent>\n\t\t\t\t\t</Sheet>\n\n\t\t\t\t\t{/* Search button */}\n\t\t\t\t\t<Button className=\"h-9 w-9 p-0\" onClick={() => setShowSearch(true)} size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t<Search className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Search jobs</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Filter button */}\n\t\t\t\t\t<Button className=\"h-9 w-9 p-0 relative\" onClick={() => setShowFilter(true)} size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t<Filter className=\"h-4 w-4\" />\n\t\t\t\t\t\t{(activeFilterCount > 0) && (\n\t\t\t\t\t\t\t<Badge className=\"absolute -top-1 -right-1 h-4 min-w-4 p-0 text-[0.6rem]\" variant=\"destructive\">\n\t\t\t\t\t\t\t\t{activeFilterCount}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<span className=\"sr-only\">Filter jobs</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Create job button */}\n\t\t\t\t\t<Button className=\"h-9 w-9 p-0\" onClick={handleCreateJob} size=\"sm\" variant=\"default\">\n\t\t\t\t\t\t<Plus className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Create job</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Bottom row: Quick stats pills */}\n\t\t\t<div className=\"flex items-center gap-2 overflow-x-auto px-4 pb-2 scrollbar-none\">\n\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border bg-muted/50 px-3 py-1 text-xs whitespace-nowrap\">\n\t\t\t\t\t<span className=\"font-semibold\">{stats.total}</span>\n\t\t\t\t\t<span className=\"text-muted-foreground\">Total</span>\n\t\t\t\t</div>\n\t\t\t\t{stats.completed > 0 && (\n\t\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border border-green-200 bg-green-50 px-3 py-1 text-xs whitespace-nowrap dark:border-green-900 dark:bg-green-950\">\n\t\t\t\t\t\t<span className=\"font-semibold text-green-700 dark:text-green-300\">{stats.completed}</span>\n\t\t\t\t\t\t<span className=\"text-green-600 dark:text-green-400\">Done</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{stats.inProgress > 0 && (\n\t\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border border-orange-200 bg-orange-50 px-3 py-1 text-xs whitespace-nowrap dark:border-orange-900 dark:bg-orange-950\">\n\t\t\t\t\t\t<span className=\"font-semibold text-orange-700 dark:text-orange-300\">{stats.inProgress}</span>\n\t\t\t\t\t\t<span className=\"text-orange-600 dark:text-orange-400\">Active</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{stats.unassigned > 0 && (\n\t\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border border-yellow-200 bg-yellow-50 px-3 py-1 text-xs whitespace-nowrap dark:border-yellow-900 dark:bg-yellow-950\">\n\t\t\t\t\t\t<span className=\"font-semibold text-yellow-700 dark:text-yellow-300\">{stats.unassigned}</span>\n\t\t\t\t\t\t<span className=\"text-yellow-600 dark:text-yellow-400\">Unassigned</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Search Sheet */}\n\t\t\t<SearchJobsSheet\n\t\t\t\tisOpen={showSearch}\n\t\t\t\tonClose={() => setShowSearch(false)}\n\t\t\t\tonJobSelect={handleJobSelect}\n\t\t\t/>\n\n\t\t\t{/* Filter Sheet */}\n\t\t\t<FilterJobsSheet\n\t\t\t\tactiveFilters={activeFilters}\n\t\t\t\tisOpen={showFilter}\n\t\t\t\tonApplyFilters={handleApplyFilters}\n\t\t\t\tonClose={() => setShowFilter(false)}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 5504, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/date-picker-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { Calendar as CalendarIcon, X } from \"lucide-react\";\nimport { format } from \"date-fns\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n} from \"@/components/ui/sheet\";\n\n/**\n * DatePickerSheet - Mobile date picker for schedule\n *\n * Features:\n * - Full calendar view\n * - Quick date selection\n * - Today button for quick reset\n * - Visual indicator for selected date\n * - Swipe to dismiss\n */\n\ntype DatePickerSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tcurrentDate: Date;\n\tonDateSelect: (date: Date) => void;\n};\n\nexport function DatePickerSheet({\n\tisOpen,\n\tonClose,\n\tcurrentDate,\n\tonDateSelect,\n}: DatePickerSheetProps) {\n\tconst [selectedDate, setSelectedDate] = useState<Date>(currentDate);\n\n\tconst handleDateSelect = (date: Date | undefined) => {\n\t\tif (date) {\n\t\t\tsetSelectedDate(date);\n\t\t}\n\t};\n\n\tconst handleConfirm = () => {\n\t\tonDateSelect(selectedDate);\n\t\tonClose();\n\t};\n\n\tconst handleToday = () => {\n\t\tconst today = new Date();\n\t\tsetSelectedDate(today);\n\t\tonDateSelect(today);\n\t\tonClose();\n\t};\n\n\tconst handleCancel = () => {\n\t\tsetSelectedDate(currentDate); // Reset to original\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={handleCancel}>\n\t\t\t<SheetContent side=\"bottom\" className=\"h-[500px] flex flex-col\">\n\t\t\t\t<SheetHeader>\n\t\t\t\t\t<SheetTitle className=\"flex items-center justify-between\">\n\t\t\t\t\t\t<span className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t<CalendarIcon className=\"h-5 w-5\" />\n\t\t\t\t\t\t\tSelect Date\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"h-8 w-8 p-0\"\n\t\t\t\t\t\t\tonClick={handleCancel}\n\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</SheetTitle>\n\t\t\t\t</SheetHeader>\n\n\t\t\t\t{/* Calendar */}\n\t\t\t\t<div className=\"flex-1 flex items-center justify-center overflow-y-auto py-4\">\n\t\t\t\t\t<Calendar\n\t\t\t\t\t\tclassName=\"rounded-md border\"\n\t\t\t\t\t\tmode=\"single\"\n\t\t\t\t\t\tonSelect={handleDateSelect}\n\t\t\t\t\t\tselected={selectedDate}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Footer Actions */}\n\t\t\t\t<div className=\"shrink-0 space-y-2 border-t pt-4\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\tonClick={handleToday}\n\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tToday\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tGo to {format(selectedDate, \"MMM d, yyyy\")}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;;;AAPA;;;;;;;AAgCO,SAAS,gBAAgB,EAC/B,MAAM,EACN,OAAO,EACP,WAAW,EACX,YAAY,EACU;;IACtB,MAAM,CAAC,cAAc,gBAAgB,GAAG,IAAA,gVAAQ,EAAO;IAEvD,MAAM,mBAAmB,CAAC;QACzB,IAAI,MAAM;YACT,gBAAgB;QACjB;IACD;IAEA,MAAM,gBAAgB;QACrB,aAAa;QACb;IACD;IAEA,MAAM,cAAc;QACnB,MAAM,QAAQ,IAAI;QAClB,gBAAgB;QAChB,aAAa;QACb;IACD;IAEA,MAAM,eAAe;QACpB,gBAAgB,cAAc,oBAAoB;QAClD;IACD;IAEA,qBACC,oWAAC,2IAAK;QAAC,MAAM;QAAQ,cAAc;kBAClC,cAAA,oWAAC,kJAAY;YAAC,MAAK;YAAS,WAAU;;8BACrC,oWAAC,iJAAW;8BACX,cAAA,oWAAC,gJAAU;wBAAC,WAAU;;0CACrB,oWAAC;gCAAK,WAAU;;kDACf,oWAAC,6SAAY;wCAAC,WAAU;;;;;;oCAAY;;;;;;;0CAGrC,oWAAC,6IAAM;gCACN,WAAU;gCACV,SAAS;gCACT,MAAK;gCACL,SAAQ;;kDAER,oWAAC,wRAAC;wCAAC,WAAU;;;;;;kDACb,oWAAC;wCAAK,WAAU;kDAAU;;;;;;;;;;;;;;;;;;;;;;;8BAM7B,oWAAC;oBAAI,WAAU;8BACd,cAAA,oWAAC,iJAAQ;wBACR,WAAU;wBACV,MAAK;wBACL,UAAU;wBACV,UAAU;;;;;;;;;;;8BAKZ,oWAAC;oBAAI,WAAU;8BACd,cAAA,oWAAC;wBAAI,WAAU;;0CACd,oWAAC,6IAAM;gCACN,WAAU;gCACV,SAAS;gCACT,MAAK;gCACL,SAAQ;0CACR;;;;;;0CAGD,oWAAC,6IAAM;gCACN,WAAU;gCACV,SAAS;gCACT,MAAK;;oCACL;oCACO,IAAA,0NAAM,EAAC,cAAc;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAOnC;GArFgB;KAAA"}},
    {"offset": {"line": 5696, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/day-view-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useMemo, useState } from \"react\";\nimport { format, isSameDay } from \"date-fns\";\nimport { ChevronDown, ChevronRight, ChevronLeft, ChevronRight as ChevronRightIcon } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport type { Job, Technician } from \"@/lib/stores/schedule-store\";\nimport { EmptyStateMobile } from \"./empty-state-mobile\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { JobCardMobile } from \"./job-card-mobile\";\nimport { MobileScheduleHeader } from \"./mobile-schedule-header\";\nimport { DatePickerSheet } from \"./date-picker-sheet\";\nimport { toast } from \"sonner\";\n\n/**\n * DayViewMobile - Mobile-optimized day view with vertical timeline\n *\n * Completely different from desktop dispatch timeline:\n * - NO horizontal 1,920px scroll\n * - Vertical scrolling (natural mobile pattern)\n * - Time slots stacked vertically (8am, 9am, 10am, etc.)\n * - Collapsible technician sections\n * - Unassigned jobs panel at bottom\n * - Tap job card  bottom sheet (no drag & drop)\n * - Date navigation with arrows or swipe\n *\n * Layout:\n * \n *   Jan 15, 2025   [Today]       Date nav\n * \n *  Mike Johnson (4 jobs)           Collapsible\n *   \n *   8:00 AM - Job card           \n *   10:00 AM - Job card          \n *   \n * \n *  Sarah Williams (2 jobs)        \n *  ... jobs ...                    \n * \n *   Unassigned (8)               Collapsible\n * \n */\n\nexport function DayViewMobile() {\n\t// Get Maps from store (stable references)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\tconst { currentDate, goToToday, navigatePrevious, navigateNext, setCurrentDate } = useScheduleViewStore();\n\n\t// Convert Maps to arrays once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\tconst technicians = useMemo(() => Array.from(techniciansMap.values()), [techniciansMap]);\n\n\t// Local state\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\tconst [expandedTechs, setExpandedTechs] = useState<Set<string>>(new Set()); // Collapsed by default for better mobile UX\n\tconst [showUnassigned, setShowUnassigned] = useState(false);\n\tconst [showDatePicker, setShowDatePicker] = useState(false);\n\n\t// Filter jobs for current date\n\tconst todaysJobs = useMemo(() => {\n\t\treturn jobs.filter((job) => {\n\t\t\tif (!job.startTime) return false;\n\t\t\t// Handle both ISO string and Date object\n\t\t\tconst jobDate = typeof job.startTime === 'string'\n\t\t\t\t? new Date(job.startTime)\n\t\t\t\t: job.startTime;\n\t\t\treturn isSameDay(jobDate, currentDate);\n\t\t});\n\t}, [jobs, currentDate]);\n\n\t// Group jobs by technician\n\tconst jobsByTechnician = useMemo(() => {\n\t\tconst grouped = new Map<string, Job[]>();\n\n\t\t// Initialize map with all technicians (including those with no jobs)\n\t\ttechnicians.forEach((tech) => {\n\t\t\tgrouped.set(tech.id, []);\n\t\t});\n\n\t\t// Group jobs by assigned technician\n\t\ttodaysJobs.forEach((job) => {\n\t\t\tif (job.technicianId) {\n\t\t\t\tconst techJobs = grouped.get(job.technicianId) || [];\n\t\t\t\ttechJobs.push(job);\n\t\t\t\tgrouped.set(job.technicianId, techJobs);\n\t\t\t}\n\t\t});\n\n\t\t// Sort jobs within each technician by start time\n\t\tgrouped.forEach((jobs) => {\n\t\t\tjobs.sort((a, b) => {\n\t\t\t\tif (!a.startTime) return 1;\n\t\t\t\tif (!b.startTime) return -1;\n\t\t\t\treturn new Date(a.startTime).getTime() - new Date(b.startTime).getTime();\n\t\t\t});\n\t\t});\n\n\t\treturn grouped;\n\t}, [todaysJobs, technicians]);\n\n\t// Get unassigned jobs for today\n\tconst unassignedJobs = useMemo(() => {\n\t\treturn todaysJobs.filter((job) => job.isUnassigned);\n\t}, [todaysJobs]);\n\n\t// Toggle technician section\n\tconst toggleTechnician = useCallback((techId: string) => {\n\t\tsetExpandedTechs((prev) => {\n\t\t\tconst next = new Set(prev);\n\t\t\tif (next.has(techId)) {\n\t\t\t\tnext.delete(techId);\n\t\t\t} else {\n\t\t\t\tnext.add(techId);\n\t\t\t}\n\t\t\treturn next;\n\t\t});\n\t}, []);\n\n\t// Job action handler\n\tconst handleJobAction = useCallback(async (action: string, job: Job, ...args: unknown[]) => {\n\t\tconsole.log(\"Job action:\", action, job, args);\n\t\tsetSelectedJob(null);\n\n\t\ttry {\n\t\t\tswitch (action) {\n\t\t\t\tcase \"view_details\":\n\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dispatch\":\n\t\t\t\tcase \"arrive\":\n\t\t\t\tcase \"start\":\n\t\t\t\tcase \"complete\":\n\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst newStatus = action === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t};\n\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`);\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reassign\": {\n\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"cancel\": {\n\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\ttoast.error(\"An error occurred\");\n\t\t}\n\t}, []);\n\n\t// Format date display\n\tconst dateDisplay = format(currentDate, \"EEEE, MMM d, yyyy\");\n\tconst isToday = isSameDay(currentDate, new Date());\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Mobile Header with view switcher, stats, and actions */}\n\t\t\t<MobileScheduleHeader onJobSelect={setSelectedJob} />\n\n\t\t\t{/* Date navigation */}\n\t\t\t<div className=\"shrink-0 border-b bg-background\">\n\t\t\t\t<div className=\"flex items-center justify-between p-4\">\n\t\t\t\t\t{/* Previous day */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigatePrevious}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Previous day</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Current date - Clickable */}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"flex flex-col items-center transition-colors hover:text-primary active:scale-95\"\n\t\t\t\t\t\tonClick={() => setShowDatePicker(true)}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<h2 className=\"text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t\t\t{format(currentDate, \"EEEE\")}\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<p className=\"text-lg font-semibold\">\n\t\t\t\t\t\t\t{format(currentDate, \"MMM d, yyyy\")}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{/* Next day */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigateNext}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronRightIcon className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Next day</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Today button (only show when not on today) */}\n\t\t\t\t{!isToday && (\n\t\t\t\t\t<div className=\"px-4 pb-3\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t\tonClick={goToToday}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tGo to Today\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Scrollable content */}\n\t\t\t<div className=\"flex-1 overflow-y-auto\">\n\t\t\t\t{todaysJobs.length === 0 ? (\n\t\t\t\t\t<EmptyStateMobile\n\t\t\t\t\t\tactionLabel=\"View Full Schedule\"\n\t\t\t\t\t\tonAction={() => {\n\t\t\t\t\t\t\twindow.location.href = \"/dashboard/schedule\";\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvariant=\"no_jobs_today\"\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-0\">\n\t\t\t\t\t\t{/* Technician sections */}\n\t\t\t\t\t\t{technicians.map((tech) => {\n\t\t\t\t\t\t\tconst techJobs = jobsByTechnician.get(tech.id) || [];\n\t\t\t\t\t\t\tconst isExpanded = expandedTechs.has(tech.id);\n\t\t\t\t\t\t\tconst hasJobs = techJobs.length > 0;\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName=\"border-b last:border-b-0\"\n\t\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{/* Technician header (collapsible) */}\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex w-full items-center justify-between bg-muted/30 p-4 text-left transition-colors hover:bg-muted/50 active:bg-muted\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => toggleTechnician(tech.id)}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t{isExpanded ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium\">{tech.name}</h3>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.length} {techJobs.length === 1 ? \"job\" : \"jobs\"}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t{/* Job count badge */}\n\t\t\t\t\t\t\t\t\t\t{hasJobs && (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex h-6 min-w-6 items-center justify-center rounded-full bg-primary/10 px-2 text-xs font-semibold text-primary\">\n\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.length}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t{/* Job cards (only show when expanded) */}\n\t\t\t\t\t\t\t\t\t{isExpanded && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-background px-4 pb-4\">\n\t\t\t\t\t\t\t\t\t\t\t{techJobs.length === 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"py-8 text-center text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tNo jobs scheduled for today\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.map((job) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowDate={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowTechnician={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\n\t\t\t\t\t\t{/* Unassigned jobs section */}\n\t\t\t\t\t\t{unassignedJobs.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"border-t\">\n\t\t\t\t\t\t\t\t{/* Unassigned header (collapsible) */}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"flex w-full items-center justify-between bg-yellow-50 dark:bg-yellow-950/20 p-4 text-left transition-colors hover:bg-yellow-100 dark:hover:bg-yellow-950/30 active:bg-yellow-100 dark:active:bg-yellow-950/30\"\n\t\t\t\t\t\t\t\t\tonClick={() => setShowUnassigned(!showUnassigned)}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t{showUnassigned ? (\n\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium\"> Unassigned</h3>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t{unassignedJobs.length} {unassignedJobs.length === 1 ? \"job\" : \"jobs\"} need assignment\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Count badge */}\n\t\t\t\t\t\t\t\t\t<div className=\"flex h-6 min-w-6 items-center justify-center rounded-full bg-yellow-500 dark:bg-yellow-600 px-2 text-xs font-semibold text-white\">\n\t\t\t\t\t\t\t\t\t\t{unassignedJobs.length}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t{/* Unassigned job cards */}\n\t\t\t\t\t\t\t\t{showUnassigned && (\n\t\t\t\t\t\t\t\t\t<div className=\"bg-background px-4 pb-4\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1.5\">\n\t\t\t\t\t\t\t\t\t\t\t{unassignedJobs.map((job) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowDate={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\n\t\t\t{/* Date Picker Sheet */}\n\t\t\t<DatePickerSheet\n\t\t\t\tcurrentDate={currentDate}\n\t\t\t\tisOpen={showDatePicker}\n\t\t\t\tonClose={() => setShowDatePicker(false)}\n\t\t\t\tonDateSelect={(date) => {\n\t\t\t\t\tsetCurrentDate(date);\n\t\t\t\t\tsetShowDatePicker(false);\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6347, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/kanban-view-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useMemo, useState } from \"react\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { EmptyStateMobile } from \"./empty-state-mobile\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { JobCardMobile } from \"./job-card-mobile\";\nimport { toast } from \"sonner\";\n\n/**\n * KanbanViewMobile - Mobile-optimized kanban view with single column\n *\n * Completely different from desktop 8-column kanban:\n * - ONE status column at a time (full screen width)\n * - Horizontal swipe to navigate between statuses\n * - Status indicator dots at top\n * - Full-width job cards (better readability)\n * - Tap card  bottom sheet with \"Move to...\" action\n * - NO drag & drop (use bottom sheet to change status)\n *\n * Layout:\n * \n *                          Status dots\n *   \n *      Dispatched                 Current status\n * \n *   \n *   Job card (full width)        \n *   \n *   \n *   Job card                     \n *   \n *                                  \n *  12 jobs                          Count\n * \n *\n * Swipe left/right changes status column\n */\n\nconst STATUS_COLUMNS = [\n\t{ id: \"unscheduled\", label: \"Unscheduled\", color: \"bg-gray-500\" },\n\t{ id: \"scheduled\", label: \"Scheduled\", color: \"bg-blue-500\" },\n\t{ id: \"dispatched\", label: \"Dispatched\", color: \"bg-yellow-500\" },\n\t{ id: \"arrived\", label: \"Arrived\", color: \"bg-purple-500\" },\n\t{ id: \"in_progress\", label: \"In Progress\", color: \"bg-orange-500\" },\n\t{ id: \"closed\", label: \"Closed\", color: \"bg-green-500\" },\n\t{ id: \"completed\", label: \"Completed\", color: \"bg-emerald-500\" },\n\t{ id: \"cancelled\", label: \"Cancelled\", color: \"bg-red-500\" },\n] as const;\n\nexport function KanbanViewMobile() {\n\t// Get Map from store (stable reference)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Convert Map to array once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\t// Local state\n\tconst [currentStatusIndex, setCurrentStatusIndex] = useState(2); // Start at \"dispatched\"\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\n\tconst currentStatus = STATUS_COLUMNS[currentStatusIndex];\n\n\t// Filter jobs by current status\n\tconst statusJobs = useMemo(() => {\n\t\treturn jobs.filter((job) => {\n\t\t\tconst jobStatus = (job.status || \"unscheduled\").toLowerCase().replace(/ /g, \"_\");\n\t\t\treturn jobStatus === currentStatus.id;\n\t\t});\n\t}, [jobs, currentStatus.id]);\n\n\t// Sort by scheduled start time\n\tconst sortedJobs = useMemo(() => {\n\t\treturn [...statusJobs].sort((a, b) => {\n\t\t\tif (!a.scheduled_start) return 1;\n\t\t\tif (!b.scheduled_start) return -1;\n\t\t\treturn new Date(a.scheduled_start).getTime() - new Date(b.scheduled_start).getTime();\n\t\t});\n\t}, [statusJobs]);\n\n\t// Navigation handlers\n\tconst handlePrevious = useCallback(() => {\n\t\tsetCurrentStatusIndex((prev) => Math.max(0, prev - 1));\n\t}, []);\n\n\tconst handleNext = useCallback(() => {\n\t\tsetCurrentStatusIndex((prev) => Math.min(STATUS_COLUMNS.length - 1, prev + 1));\n\t}, []);\n\n\tconst handleJumpToStatus = useCallback((index: number) => {\n\t\tsetCurrentStatusIndex(index);\n\t}, []);\n\n\t// Job action handler\n\tconst handleJobAction = useCallback(async (action: string, job: Job, ...args: unknown[]) => {\n\t\tconsole.log(\"Job action:\", action, job, args);\n\t\tsetSelectedJob(null);\n\n\t\ttry {\n\t\t\tswitch (action) {\n\t\t\t\tcase \"view_details\":\n\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dispatch\":\n\t\t\t\tcase \"arrive\":\n\t\t\t\tcase \"start\":\n\t\t\t\tcase \"complete\":\n\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst newStatus = action === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t};\n\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`);\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reassign\": {\n\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"cancel\": {\n\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\ttoast.error(\"An error occurred\");\n\t\t}\n\t}, []);\n\n\tconst canGoPrevious = currentStatusIndex > 0;\n\tconst canGoNext = currentStatusIndex < STATUS_COLUMNS.length - 1;\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Header: Status indicator dots */}\n\t\t\t<div className=\"shrink-0 border-b bg-background p-4\">\n\t\t\t\t{/* Dots */}\n\t\t\t\t<div className=\"mb-4 flex items-center justify-center gap-2\">\n\t\t\t\t\t{STATUS_COLUMNS.map((status, index) => {\n\t\t\t\t\t\tconst isActive = index === currentStatusIndex;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclassName=\"transition-transform hover:scale-125 active:scale-110\"\n\t\t\t\t\t\t\t\tkey={status.id}\n\t\t\t\t\t\t\t\tonClick={() => handleJumpToStatus(index)}\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={`h-2 w-2 rounded-full transition-all ${\n\t\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t\t? `${status.color} scale-125`\n\t\t\t\t\t\t\t\t\t\t\t: \"bg-muted-foreground/30\"\n\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<span className=\"sr-only\">{status.label}</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Current status with navigation */}\n\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t{/* Previous button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tdisabled={!canGoPrevious}\n\t\t\t\t\t\tonClick={handlePrevious}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Previous status</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Current status */}\n\t\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t\t<div className={`mb-1 h-1 w-16 rounded-full ${currentStatus.color}`} />\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold\">{currentStatus.label}</h2>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t{sortedJobs.length} {sortedJobs.length === 1 ? \"job\" : \"jobs\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Next button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tdisabled={!canGoNext}\n\t\t\t\t\t\tonClick={handleNext}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Next status</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Scrollable job list */}\n\t\t\t<div className=\"flex-1 overflow-y-auto\">\n\t\t\t\t{sortedJobs.length === 0 ? (\n\t\t\t\t\t<div className=\"flex h-full items-center justify-center p-6\">\n\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\tNo jobs with status \"{currentStatus.label}\"\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t{canGoNext && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName=\"mt-4\"\n\t\t\t\t\t\t\t\t\tonClick={handleNext}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tView {STATUS_COLUMNS[currentStatusIndex + 1].label}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-2 p-4\">\n\t\t\t\t\t\t{sortedJobs.map((job) => (\n\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\tshowDate={true}\n\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 6844, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/schedule-filters-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { Filter, X } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * ScheduleFiltersMobile - Mobile filter chips component\n *\n * Provides horizontal scrolling filter chips for:\n * - Status filtering (scheduled, dispatched, completed, etc.)\n * - Technician filtering\n * - Date range filtering\n *\n * Design:\n * - Horizontal scrolling chip container\n * - Active filters highlighted with primary color\n * - Clear all button when filters active\n * - Touch-friendly 36px height chips\n *\n * Usage:\n * - List view: Primary filtering UI\n * - Day/Week/Month views: Quick filter options\n */\n\nexport type FilterOption = {\n\tid: string;\n\tlabel: string;\n\tcount?: number; // Optional count badge (e.g., \"Dispatched (5)\")\n};\n\nexport type ActiveFilters = {\n\tstatuses: string[];\n\ttechnicians: string[];\n\tdateRange?: { start: Date; end: Date };\n};\n\ntype ScheduleFiltersMobileProps = {\n\tstatusOptions: FilterOption[];\n\ttechnicianOptions: FilterOption[];\n\tactiveFilters: ActiveFilters;\n\tonToggleStatus: (statusId: string) => void;\n\tonToggleTechnician: (techId: string) => void;\n\tonClearAll: () => void;\n\tonOpenFilters?: () => void; // Opens full filter modal\n\tclassName?: string;\n};\n\nexport function ScheduleFiltersMobile({\n\tstatusOptions,\n\ttechnicianOptions,\n\tactiveFilters,\n\tonToggleStatus,\n\tonToggleTechnician,\n\tonClearAll,\n\tonOpenFilters,\n\tclassName,\n}: ScheduleFiltersMobileProps) {\n\tconst hasActiveFilters =\n\t\tactiveFilters.statuses.length > 0 ||\n\t\tactiveFilters.technicians.length > 0 ||\n\t\tactiveFilters.dateRange;\n\n\tconst activeFilterCount =\n\t\tactiveFilters.statuses.length +\n\t\tactiveFilters.technicians.length +\n\t\t(activeFilters.dateRange ? 1 : 0);\n\n\treturn (\n\t\t<div className={cn(\"flex items-center gap-2 overflow-x-auto pb-2\", className)}>\n\t\t\t{/* Filter button (opens full filter modal) */}\n\t\t\t{onOpenFilters && (\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"h-9 shrink-0 gap-2\"\n\t\t\t\t\tonClick={onOpenFilters}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t>\n\t\t\t\t\t<Filter className=\"h-4 w-4\" />\n\t\t\t\t\t<span>Filters</span>\n\t\t\t\t\t{activeFilterCount > 0 && (\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\tclassName=\"ml-1 h-5 min-w-5 px-1.5 text-xs\"\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{activeFilterCount}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t)}\n\t\t\t\t</Button>\n\t\t\t)}\n\n\t\t\t{/* Status filter chips */}\n\t\t\t{statusOptions.map((status) => {\n\t\t\t\tconst isActive = activeFilters.statuses.includes(status.id);\n\t\t\t\treturn (\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all\",\n\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t? \"bg-primary text-primary-foreground hover:bg-primary/90\"\n\t\t\t\t\t\t\t\t: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\"\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tkey={status.id}\n\t\t\t\t\t\tonClick={() => onToggleStatus(status.id)}\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{status.label}</span>\n\t\t\t\t\t\t{status.count !== undefined && (\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"rounded-full px-1.5 py-0.5 text-xs font-semibold\",\n\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary-foreground/20 text-primary-foreground\"\n\t\t\t\t\t\t\t\t\t\t: \"bg-muted text-muted-foreground\"\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{status.count}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Badge>\n\t\t\t\t);\n\t\t\t})}\n\n\t\t\t{/* Technician filter chips */}\n\t\t\t{technicianOptions.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t{/* Separator */}\n\t\t\t\t\t<div className=\"h-6 w-px bg-border shrink-0\" />\n\n\t\t\t\t\t{technicianOptions.map((tech) => {\n\t\t\t\t\t\tconst isActive = activeFilters.technicians.includes(tech.id);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all\",\n\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary text-primary-foreground hover:bg-primary/90\"\n\t\t\t\t\t\t\t\t\t\t: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\"\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\tonClick={() => onToggleTechnician(tech.id)}\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span>{tech.label}</span>\n\t\t\t\t\t\t\t\t{tech.count !== undefined && (\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"rounded-full px-1.5 py-0.5 text-xs font-semibold\",\n\t\t\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-foreground/20 text-primary-foreground\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-muted text-muted-foreground\"\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{tech.count}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{/* Clear all button (only show when filters active) */}\n\t\t\t{hasActiveFilters && (\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"h-9 shrink-0 gap-2\"\n\t\t\t\t\tonClick={onClearAll}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t>\n\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t<span>Clear</span>\n\t\t\t\t</Button>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AALA;;;;;;AAiDO,SAAS,sBAAsB,EACrC,aAAa,EACb,iBAAiB,EACjB,aAAa,EACb,cAAc,EACd,kBAAkB,EAClB,UAAU,EACV,aAAa,EACb,SAAS,EACmB;IAC5B,MAAM,mBACL,cAAc,QAAQ,CAAC,MAAM,GAAG,KAChC,cAAc,WAAW,CAAC,MAAM,GAAG,KACnC,cAAc,SAAS;IAExB,MAAM,oBACL,cAAc,QAAQ,CAAC,MAAM,GAC7B,cAAc,WAAW,CAAC,MAAM,GAChC,CAAC,cAAc,SAAS,GAAG,IAAI,CAAC;IAEjC,qBACC,oWAAC;QAAI,WAAW,IAAA,2IAAE,EAAC,gDAAgD;;YAEjE,+BACA,oWAAC,6IAAM;gBACN,WAAU;gBACV,SAAS;gBACT,MAAK;gBACL,SAAQ;;kCAER,oWAAC,uSAAM;wBAAC,WAAU;;;;;;kCAClB,oWAAC;kCAAK;;;;;;oBACL,oBAAoB,mBACpB,oWAAC,2IAAK;wBACL,WAAU;wBACV,SAAQ;kCAEP;;;;;;;;;;;;YAOJ,cAAc,GAAG,CAAC,CAAC;gBACnB,MAAM,WAAW,cAAc,QAAQ,CAAC,QAAQ,CAAC,OAAO,EAAE;gBAC1D,qBACC,oWAAC,2IAAK;oBACL,WAAW,IAAA,2IAAE,EACZ,+EACA,WACG,2DACA;oBAGJ,SAAS,IAAM,eAAe,OAAO,EAAE;oBACvC,SAAQ;;sCAER,oWAAC;sCAAM,OAAO,KAAK;;;;;;wBAClB,OAAO,KAAK,KAAK,2BACjB,oWAAC;4BACA,WAAW,IAAA,2IAAE,EACZ,oDACA,WACG,qDACA;sCAGH,OAAO,KAAK;;;;;;;mBAdV,OAAO,EAAE;;;;;YAmBjB;YAGC,kBAAkB,MAAM,GAAG,mBAC3B;;kCAEC,oWAAC;wBAAI,WAAU;;;;;;oBAEd,kBAAkB,GAAG,CAAC,CAAC;wBACvB,MAAM,WAAW,cAAc,WAAW,CAAC,QAAQ,CAAC,KAAK,EAAE;wBAC3D,qBACC,oWAAC,2IAAK;4BACL,WAAW,IAAA,2IAAE,EACZ,+EACA,WACG,2DACA;4BAGJ,SAAS,IAAM,mBAAmB,KAAK,EAAE;4BACzC,SAAQ;;8CAER,oWAAC;8CAAM,KAAK,KAAK;;;;;;gCAChB,KAAK,KAAK,KAAK,2BACf,oWAAC;oCACA,WAAW,IAAA,2IAAE,EACZ,oDACA,WACG,qDACA;8CAGH,KAAK,KAAK;;;;;;;2BAdR,KAAK,EAAE;;;;;oBAmBf;;;YAKD,kCACA,oWAAC,6IAAM;gBACN,WAAU;gBACV,SAAS;gBACT,MAAK;gBACL,SAAQ;;kCAER,oWAAC,wRAAC;wBAAC,WAAU;;;;;;kCACb,oWAAC;kCAAK;;;;;;;;;;;;;;;;;;AAKX;KAhIgB"}},
    {"offset": {"line": 7015, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/list-view-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { useCallback, useMemo, useState } from \"react\";\nimport { format, isToday, isTomorrow, parseISO } from \"date-fns\";\nimport { Plus, Search } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n\tSelect,\n\tSelectContent,\n\tSelectItem,\n\tSelectTrigger,\n\tSelectValue,\n} from \"@/components/ui/select\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { EmptyStateMobile } from \"./empty-state-mobile\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { JobCardMobile } from \"./job-card-mobile\";\nimport type { ActiveFilters, FilterOption } from \"./schedule-filters-mobile\";\nimport { ScheduleFiltersMobile } from \"./schedule-filters-mobile\";\nimport { toast } from \"sonner\";\n\n/**\n * ListViewMobile - Primary mobile schedule view\n *\n * Features:\n * - Vertical scrolling list of all jobs\n * - Search bar at top (full-text search)\n * - Filter chips (status, technician)\n * - Group by: Date, Technician, Status, Customer\n * - Sort by: Start Time, Priority, Customer\n * - Tap job card  bottom sheet with actions\n * - Pull to refresh (future)\n * - Floating Action Button (FAB) for new appointments\n * - Infinite scroll with lazy loading (future)\n *\n * This is the DEFAULT mobile view as it provides the best\n * mobile experience with vertical scrolling and easy filtering.\n */\n\ntype GroupByOption = \"date\" | \"technician\" | \"status\" | \"customer\";\ntype SortByOption = \"start_time\" | \"priority\" | \"customer\" | \"status\";\n\nexport function ListViewMobile() {\n\t// Get Maps from store (stable references)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\n\t// Convert Maps to arrays once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\tconst technicians = useMemo(() => Array.from(techniciansMap.values()), [techniciansMap]);\n\n\t// Local state\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst [groupBy, setGroupBy] = useState<GroupByOption>(\"date\");\n\tconst [sortBy, setSortBy] = useState<SortByOption>(\"start_time\");\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\tconst [activeFilters, setActiveFilters] = useState<ActiveFilters>({\n\t\tstatuses: [],\n\t\ttechnicians: [],\n\t});\n\n\t// Filter options\n\tconst statusOptions: FilterOption[] = useMemo(() => {\n\t\tconst statusCounts = jobs.reduce((acc, job) => {\n\t\t\tconst status = job.status || \"unscheduled\";\n\t\t\tacc[status] = (acc[status] || 0) + 1;\n\t\t\treturn acc;\n\t\t}, {} as Record<string, number>);\n\n\t\treturn [\n\t\t\t{ id: \"scheduled\", label: \"Scheduled\", count: statusCounts.scheduled || 0 },\n\t\t\t{ id: \"dispatched\", label: \"Dispatched\", count: statusCounts.dispatched || 0 },\n\t\t\t{ id: \"arrived\", label: \"Arrived\", count: statusCounts.arrived || 0 },\n\t\t\t{ id: \"in_progress\", label: \"In Progress\", count: statusCounts.in_progress || 0 },\n\t\t\t{ id: \"completed\", label: \"Completed\", count: statusCounts.completed || 0 },\n\t\t];\n\t}, [jobs]);\n\n\tconst technicianOptions: FilterOption[] = useMemo(() => {\n\t\treturn technicians.map((tech) => {\n\t\t\tconst jobCount = jobs.filter((job) => job.assignedTechnicianId === tech.id).length;\n\t\t\treturn {\n\t\t\t\tid: tech.id,\n\t\t\t\tlabel: tech.name,\n\t\t\t\tcount: jobCount,\n\t\t\t};\n\t\t});\n\t}, [technicians, jobs]);\n\n\t// Filter jobs based on search and filters\n\tconst filteredJobs = useMemo(() => {\n\t\tlet filtered = [...jobs];\n\n\t\t// Search filter\n\t\tif (searchQuery.trim()) {\n\t\t\tconst query = searchQuery.toLowerCase();\n\t\t\tfiltered = filtered.filter(\n\t\t\t\t(job) =>\n\t\t\t\t\tjob.customer?.name.toLowerCase().includes(query) ||\n\t\t\t\t\tjob.title?.toLowerCase().includes(query) ||\n\t\t\t\t\tjob.property?.address?.toLowerCase().includes(query) ||\n\t\t\t\t\tjob.description?.toLowerCase().includes(query)\n\t\t\t);\n\t\t}\n\n\t\t// Status filter\n\t\tif (activeFilters.statuses.length > 0) {\n\t\t\tfiltered = filtered.filter((job) =>\n\t\t\t\tactiveFilters.statuses.includes(job.status?.toLowerCase() || \"unscheduled\")\n\t\t\t);\n\t\t}\n\n\t\t// Technician filter\n\t\tif (activeFilters.technicians.length > 0) {\n\t\t\tfiltered = filtered.filter((job) =>\n\t\t\t\tjob.assignedTechnicianId\n\t\t\t\t\t? activeFilters.technicians.includes(job.assignedTechnicianId)\n\t\t\t\t\t: false\n\t\t\t);\n\t\t}\n\n\t\treturn filtered;\n\t}, [jobs, searchQuery, activeFilters]);\n\n\t// Sort jobs\n\tconst sortedJobs = useMemo(() => {\n\t\tconst sorted = [...filteredJobs];\n\n\t\tswitch (sortBy) {\n\t\t\tcase \"start_time\":\n\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\tif (!a.scheduled_start) return 1;\n\t\t\t\t\tif (!b.scheduled_start) return -1;\n\t\t\t\t\treturn (\n\t\t\t\t\t\tnew Date(a.scheduled_start).getTime() - new Date(b.scheduled_start).getTime()\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"customer\":\n\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\tconst nameA = a.customer?.name || \"\";\n\t\t\t\t\tconst nameB = b.customer?.name || \"\";\n\t\t\t\t\treturn nameA.localeCompare(nameB);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"status\":\n\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\tconst statusA = a.status || \"unscheduled\";\n\t\t\t\t\tconst statusB = b.status || \"unscheduled\";\n\t\t\t\t\treturn statusA.localeCompare(statusB);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn sorted;\n\t}, [filteredJobs, sortBy]);\n\n\t// Group jobs\n\tconst groupedJobs = useMemo(() => {\n\t\tconst groups: Record<string, Job[]> = {};\n\n\t\tsortedJobs.forEach((job) => {\n\t\t\tlet groupKey = \"\";\n\n\t\t\tswitch (groupBy) {\n\t\t\t\tcase \"date\": {\n\t\t\t\t\tif (!job.scheduled_start) {\n\t\t\t\t\t\tgroupKey = \"Unscheduled\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Handle both ISO string and Date object\n\t\t\t\t\t\tconst date = typeof job.scheduled_start === 'string'\n\t\t\t\t\t\t\t? parseISO(job.scheduled_start)\n\t\t\t\t\t\t\t: new Date(job.scheduled_start);\n\n\t\t\t\t\t\tif (isToday(date)) {\n\t\t\t\t\t\t\tgroupKey = \"Today\";\n\t\t\t\t\t\t} else if (isTomorrow(date)) {\n\t\t\t\t\t\t\tgroupKey = \"Tomorrow\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgroupKey = format(date, \"EEEE, MMM d\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"technician\":\n\t\t\t\t\tgroupKey = job.assignedTechnician?.name || \"Unassigned\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"status\":\n\t\t\t\t\tgroupKey = job.status || \"Unscheduled\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"customer\":\n\t\t\t\t\tgroupKey = job.customer?.name || \"No Customer\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tgroupKey = \"All Jobs\";\n\t\t\t}\n\n\t\t\tif (!groups[groupKey]) {\n\t\t\t\tgroups[groupKey] = [];\n\t\t\t}\n\t\t\tgroups[groupKey].push(job);\n\t\t});\n\n\t\treturn groups;\n\t}, [sortedJobs, groupBy]);\n\n\t// Filter handlers\n\tconst handleToggleStatus = useCallback((statusId: string) => {\n\t\tsetActiveFilters((prev) => ({\n\t\t\t...prev,\n\t\t\tstatuses: prev.statuses.includes(statusId)\n\t\t\t\t? prev.statuses.filter((s) => s !== statusId)\n\t\t\t\t: [...prev.statuses, statusId],\n\t\t}));\n\t}, []);\n\n\tconst handleToggleTechnician = useCallback((techId: string) => {\n\t\tsetActiveFilters((prev) => ({\n\t\t\t...prev,\n\t\t\ttechnicians: prev.technicians.includes(techId)\n\t\t\t\t? prev.technicians.filter((t) => t !== techId)\n\t\t\t\t: [...prev.technicians, techId],\n\t\t}));\n\t}, []);\n\n\tconst handleClearFilters = useCallback(() => {\n\t\tsetActiveFilters({ statuses: [], technicians: [] });\n\t\tsetSearchQuery(\"\");\n\t}, []);\n\n\t// Job action handler\n\tconst handleJobAction = useCallback(async (action: string, job: Job, ...args: unknown[]) => {\n\t\tconsole.log(\"Job action:\", action, job, args);\n\t\tsetSelectedJob(null);\n\n\t\ttry {\n\t\t\tswitch (action) {\n\t\t\t\tcase \"view_details\":\n\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dispatch\":\n\t\t\t\tcase \"arrive\":\n\t\t\t\tcase \"start\":\n\t\t\t\tcase \"complete\":\n\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst newStatus = action === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t};\n\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`);\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reassign\": {\n\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"cancel\": {\n\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\ttoast.error(\"An error occurred\");\n\t\t}\n\t}, []);\n\n\t// Empty state\n\tif (filteredJobs.length === 0 && !searchQuery && activeFilters.statuses.length === 0) {\n\t\treturn (\n\t\t\t<div className=\"flex h-full flex-col\">\n\t\t\t\t<EmptyStateMobile\n\t\t\t\t\tonAction={() => {\n\t\t\t\t\t\twindow.location.href = \"/dashboard/work/jobs/new\";\n\t\t\t\t\t}}\n\t\t\t\t\tvariant=\"no_jobs\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Header: Search */}\n\t\t\t<div className=\"shrink-0 space-y-3 border-b bg-background p-4\">\n\t\t\t\t{/* Search input */}\n\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n\t\t\t\t\t<Input\n\t\t\t\t\t\tclassName=\"h-11 pl-10 text-base\"\n\t\t\t\t\t\tonChange={(e) => setSearchQuery(e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Search jobs, customers, or locations...\"\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tvalue={searchQuery}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Filters */}\n\t\t\t\t<ScheduleFiltersMobile\n\t\t\t\t\tactiveFilters={activeFilters}\n\t\t\t\t\tonClearAll={handleClearFilters}\n\t\t\t\t\tonToggleStatus={handleToggleStatus}\n\t\t\t\t\tonToggleTechnician={handleToggleTechnician}\n\t\t\t\t\tstatusOptions={statusOptions}\n\t\t\t\t\ttechnicianOptions={technicianOptions}\n\t\t\t\t/>\n\n\t\t\t\t{/* Group by / Sort by controls */}\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<Select onValueChange={(value) => setGroupBy(value as GroupByOption)} value={groupBy}>\n\t\t\t\t\t\t<SelectTrigger className=\"h-9 w-[140px] text-sm\">\n\t\t\t\t\t\t\t<SelectValue placeholder=\"Group by\" />\n\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t<SelectItem value=\"date\">Group by Date</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"technician\">Group by Tech</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"status\">Group by Status</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"customer\">Group by Customer</SelectItem>\n\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t</Select>\n\n\t\t\t\t\t<Select onValueChange={(value) => setSortBy(value as SortByOption)} value={sortBy}>\n\t\t\t\t\t\t<SelectTrigger className=\"h-9 w-[140px] text-sm\">\n\t\t\t\t\t\t\t<SelectValue placeholder=\"Sort by\" />\n\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t<SelectItem value=\"start_time\">Sort by Time</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"customer\">Sort by Customer</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"status\">Sort by Status</SelectItem>\n\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t</Select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Scrollable job list */}\n\t\t\t<div className=\"flex-1 overflow-y-auto\">\n\t\t\t\t{filteredJobs.length === 0 ? (\n\t\t\t\t\t<EmptyStateMobile\n\t\t\t\t\t\tactionLabel=\"Clear Filters\"\n\t\t\t\t\t\tonAction={handleClearFilters}\n\t\t\t\t\t\tvariant=\"no_results\"\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-6 p-4\">\n\t\t\t\t\t\t{Object.entries(groupedJobs).map(([groupName, groupJobs]) => (\n\t\t\t\t\t\t\t<div key={groupName}>\n\t\t\t\t\t\t\t\t{/* Section header */}\n\t\t\t\t\t\t\t\t<div className=\"mb-3 flex items-center justify-between\">\n\t\t\t\t\t\t\t\t\t<h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\t\t{groupName}\n\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t{groupJobs.length} {groupJobs.length === 1 ? \"job\" : \"jobs\"}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* Job cards */}\n\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t{groupJobs.map((job) => (\n\t\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\t\t\t\tshowDate={groupBy !== \"date\"}\n\t\t\t\t\t\t\t\t\t\t\tshowTechnician={groupBy !== \"technician\"}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Floating Action Button (FAB) - Create new job */}\n\t\t\t<Button\n\t\t\t\tclassName=\"fixed right-4 bottom-20 lg:bottom-4 h-14 w-14 rounded-full shadow-lg\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\twindow.location.href = \"/dashboard/work/jobs/new\";\n\t\t\t\t}}\n\t\t\t\tsize=\"icon\"\n\t\t\t>\n\t\t\t\t<Plus className=\"h-6 w-6\" />\n\t\t\t\t<span className=\"sr-only\">Create new job</span>\n\t\t\t</Button>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 7733, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/day-detail-bottom-sheet.tsx"],"sourcesContent":["\"use client\";\n\nimport { format, isToday, isTomorrow } from \"date-fns\";\nimport { Calendar, Plus, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\nimport { JobCardMobile } from \"./job-card-mobile\";\n\n/**\n * DayDetailBottomSheet - Shows all jobs for a specific day\n *\n * Triggered by tapping a day cell in the month view.\n * Displays:\n * - Day header with date\n * - All jobs for that day\n * - Actions: Create appointment, View day schedule\n */\n\ntype DayDetailBottomSheetProps = {\n\tdate: Date | null;\n\tjobs: Job[];\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonJobTap: (job: Job) => void;\n\tonAction: (action: string, date: Date) => void;\n};\n\nexport function DayDetailBottomSheet({\n\tdate,\n\tjobs,\n\tisOpen,\n\tonClose,\n\tonJobTap,\n\tonAction,\n}: DayDetailBottomSheetProps) {\n\tif (!date) return null;\n\n\t// Format date display\n\tconst dateDisplay = (() => {\n\t\tif (isToday(date)) return \"Today\";\n\t\tif (isTomorrow(date)) return \"Tomorrow\";\n\t\treturn format(date, \"EEEE, MMMM d\");\n\t})();\n\n\tconst totalHours = jobs.reduce((sum, job) => {\n\t\tif (!job.scheduled_start || !job.scheduled_end) return sum;\n\t\tconst start = new Date(job.scheduled_start);\n\t\tconst end = new Date(job.scheduled_end);\n\t\treturn sum + (end.getTime() - start.getTime()) / (1000 * 60 * 60);\n\t}, 0);\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"85vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t<Calendar className=\"h-5 w-5 text-primary\" />\n\t\t\t\t\t\t\t<h2 className=\"text-lg font-semibold\">{dateDisplay}</h2>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{format(date, \"MMMM d, yyyy\")}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{jobs.length > 0 && (\n\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mt-1\">\n\t\t\t\t\t\t\t\t{jobs.length} {jobs.length === 1 ? \"job\" : \"jobs\"}  {totalHours.toFixed(1)}h total\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Content */}\n\t\t\t\t<ScrollArea className=\"flex-1\" style={{ maxHeight: \"calc(85vh - 200px)\" }}>\n\t\t\t\t\t<div className=\"p-4\">\n\t\t\t\t\t\t{jobs.length === 0 ? (\n\t\t\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t\t\t<Calendar className=\"h-12 w-12 text-muted-foreground/50 mb-3\" />\n\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium mb-1\">No jobs scheduled</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mb-4\">\n\t\t\t\t\t\t\t\t\tSchedule an appointment for this day\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tonAction(\"create_appointment\", date);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\tNew Appointment\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t{jobs.map((job) => (\n\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\tonClick={() => onJobTap(job)}\n\t\t\t\t\t\t\t\t\t\tshowDate={false}\n\t\t\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t{jobs.length > 0 && (\n\t\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tonAction(\"create_appointment\", date);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\tNew Appointment\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tonAction(\"view_day\", date);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Calendar className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\tView Day Schedule\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8059, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/mobile/monthly-view-mobile.tsx"],"sourcesContent":["\"use client\";\n\nimport { useMemo, useState, useCallback } from \"react\";\nimport {\n\tformat,\n\tstartOfMonth,\n\tendOfMonth,\n\tstartOfWeek,\n\tendOfWeek,\n\taddDays,\n\tisSameMonth,\n\tisSameDay,\n\tisToday,\n} from \"date-fns\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { DayDetailBottomSheet } from \"./day-detail-bottom-sheet\";\nimport { toast } from \"sonner\";\n\n/**\n * MonthlyViewMobile - Mobile-optimized calendar month view\n *\n * Differences from desktop:\n * - Larger touch-friendly cells (100px+ height)\n * - Tap day  bottom sheet with day details\n * - Tap job  job actions bottom sheet\n * - NO drag & drop (use bottom sheet to reschedule)\n * - NO context menus or tooltips\n * - Simplified job indicators (dots + count)\n * - Week view toggle for very small screens\n */\n\nconst WEEKDAYS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\nconst WEEKDAYS_SHORT = [\"S\", \"M\", \"T\", \"W\", \"T\", \"F\", \"S\"];\n\n// Job status color mapping\nconst getStatusColor = (status?: string) => {\n\tswitch (status?.toLowerCase()) {\n\t\tcase \"scheduled\":\n\t\t\treturn \"bg-blue-500\";\n\t\tcase \"dispatched\":\n\t\t\treturn \"bg-sky-500\";\n\t\tcase \"arrived\":\n\t\t\treturn \"bg-emerald-400\";\n\t\tcase \"in_progress\":\n\t\t\treturn \"bg-amber-500\";\n\t\tcase \"closed\":\n\t\tcase \"completed\":\n\t\t\treturn \"bg-emerald-600\";\n\t\tcase \"cancelled\":\n\t\t\treturn \"bg-slate-400\";\n\t\tdefault:\n\t\t\treturn \"bg-slate-500\";\n\t}\n};\n\ntype DayCellProps = {\n\tdate: Date;\n\tjobs: Job[];\n\tisCurrentMonth: boolean;\n\tonDayTap: (date: Date, jobs: Job[]) => void;\n\tonJobTap: (job: Job) => void;\n};\n\nfunction DayCell({ date, jobs, isCurrentMonth, onDayTap, onJobTap }: DayCellProps) {\n\tconst isCurrentDay = isToday(date);\n\tconst hasJobs = jobs.length > 0;\n\tconst isWeekend = date.getDay() === 0 || date.getDay() === 6;\n\n\t// Group jobs by status for colored dots\n\tconst statusCounts = useMemo(() => {\n\t\treturn jobs.reduce((acc, job) => {\n\t\t\tconst status = job.status?.toLowerCase() || \"scheduled\";\n\t\t\tacc[status] = (acc[status] || 0) + 1;\n\t\t\treturn acc;\n\t\t}, {} as Record<string, number>);\n\t}, [jobs]);\n\n\t// Get top 3 statuses to show\n\tconst topStatuses = useMemo(() => {\n\t\treturn Object.entries(statusCounts)\n\t\t\t.sort(([, a], [, b]) => b - a)\n\t\t\t.slice(0, 3);\n\t}, [statusCounts]);\n\n\treturn (\n\t\t<button\n\t\t\tclassName={cn(\n\t\t\t\t\"flex h-24 sm:h-28 flex-col border-r border-b p-1.5 sm:p-2 text-left transition-all active:scale-95\",\n\t\t\t\t!isCurrentMonth && \"bg-muted/50 opacity-60\",\n\t\t\t\tisCurrentDay && \"bg-blue-50 ring-2 ring-inset ring-blue-500/50 dark:bg-blue-950/30\",\n\t\t\t\tisWeekend && !isCurrentDay && \"bg-slate-100/80 dark:bg-slate-800/30\",\n\t\t\t)}\n\t\t\tonClick={() => onDayTap(date, jobs)}\n\t\t\ttype=\"button\"\n\t\t>\n\t\t\t{/* Date Number */}\n\t\t\t<div className=\"flex items-center justify-between gap-1 mb-1\">\n\t\t\t\t<span\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"flex h-6 w-6 sm:h-7 sm:w-7 items-center justify-center rounded-full text-xs sm:text-sm font-bold\",\n\t\t\t\t\t\tisCurrentDay && \"bg-blue-500 text-white shadow-md\",\n\t\t\t\t\t\t!isCurrentDay && !isCurrentMonth && \"text-muted-foreground/60\",\n\t\t\t\t\t\t!isCurrentDay && isCurrentMonth && \"text-foreground\",\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{format(date, \"d\")}\n\t\t\t\t</span>\n\n\t\t\t\t{/* Job count badge */}\n\t\t\t\t{hasJobs && (\n\t\t\t\t\t<Badge className=\"h-4 px-1.5 text-[9px] sm:text-[10px] font-semibold\" variant=\"secondary\">\n\t\t\t\t\t\t{jobs.length}\n\t\t\t\t\t</Badge>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Status indicators - Small colored dots */}\n\t\t\t{hasJobs && (\n\t\t\t\t<div className=\"flex flex-wrap gap-0.5\">\n\t\t\t\t\t{topStatuses.map(([status, count]) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"flex items-center gap-0.5\"\n\t\t\t\t\t\t\tkey={status}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className={cn(\"h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full\", getStatusColor(status))} />\n\t\t\t\t\t\t\t{count > 1 && (\n\t\t\t\t\t\t\t\t<span className=\"text-[8px] sm:text-[9px] text-muted-foreground font-medium\">\n\t\t\t\t\t\t\t\t\t{count}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* First few jobs as mini pills (only on larger mobile screens) */}\n\t\t\t{hasJobs && (\n\t\t\t\t<div className=\"hidden xs:flex flex-col gap-0.5 mt-1 overflow-hidden\">\n\t\t\t\t\t{jobs.slice(0, 2).map((job) => (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex items-center gap-1 rounded px-1 py-0.5 text-[8px] sm:text-[9px] font-medium transition-colors hover:opacity-80\",\n\t\t\t\t\t\t\t\tgetStatusColor(job.status),\n\t\t\t\t\t\t\t\t\"text-white truncate\"\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tonJobTap(job);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"truncate\">{job.customer?.name || job.title}</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t))}\n\t\t\t\t\t{jobs.length > 2 && (\n\t\t\t\t\t\t<span className=\"text-[8px] text-muted-foreground ml-1\">\n\t\t\t\t\t\t\t+{jobs.length - 2} more\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</button>\n\t);\n}\n\nexport function MonthlyViewMobile() {\n\t// Get Map from store (stable reference)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\tconst { currentDate, goToToday, navigatePrevious, navigateNext } = useScheduleViewStore();\n\n\t// Convert Map to array once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\t// Local state\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\tconst [selectedDay, setSelectedDay] = useState<{ date: Date; jobs: Job[] } | null>(null);\n\tconst [showWeekView, setShowWeekView] = useState(false);\n\n\tconst dateObj = useMemo(\n\t\t() => (currentDate instanceof Date ? currentDate : new Date(currentDate)),\n\t\t[currentDate],\n\t);\n\n\t// Generate calendar grid\n\tconst calendarDays = useMemo(() => {\n\t\tconst monthStart = startOfMonth(dateObj);\n\t\tconst monthEnd = endOfMonth(dateObj);\n\t\tconst calendarStart = startOfWeek(monthStart);\n\t\tconst calendarEnd = endOfWeek(monthEnd);\n\n\t\tconst days: Date[] = [];\n\t\tlet currentDay = calendarStart;\n\n\t\twhile (currentDay <= calendarEnd) {\n\t\t\tdays.push(currentDay);\n\t\t\tcurrentDay = addDays(currentDay, 1);\n\t\t}\n\n\t\treturn days;\n\t}, [dateObj]);\n\n\t// Get jobs for the current week if in week view mode\n\tconst weekDays = useMemo(() => {\n\t\tif (!showWeekView) return calendarDays;\n\n\t\t// Find the week containing currentDate\n\t\tconst weekStart = startOfWeek(dateObj);\n\t\tconst days: Date[] = [];\n\t\tfor (let i = 0; i < 7; i++) {\n\t\t\tdays.push(addDays(weekStart, i));\n\t\t}\n\t\treturn days;\n\t}, [showWeekView, dateObj, calendarDays]);\n\n\t// Group jobs by date\n\tconst jobsByDate = useMemo(() => {\n\t\tconst grouped = new Map<string, Job[]>();\n\n\t\tjobs.forEach((job) => {\n\t\t\tif (!job.scheduled_start) return;\n\n\t\t\tconst startTime = new Date(job.scheduled_start);\n\t\t\tconst dateKey = format(startTime, \"yyyy-MM-dd\");\n\n\t\t\tif (!grouped.has(dateKey)) {\n\t\t\t\tgrouped.set(dateKey, []);\n\t\t\t}\n\t\t\tgrouped.get(dateKey)?.push(job);\n\t\t});\n\n\t\t// Sort jobs within each day by start time\n\t\tgrouped.forEach((jobList) => {\n\t\t\tjobList.sort((a, b) => {\n\t\t\t\tif (!a.scheduled_start) return 1;\n\t\t\t\tif (!b.scheduled_start) return -1;\n\t\t\t\treturn new Date(a.scheduled_start).getTime() - new Date(b.scheduled_start).getTime();\n\t\t\t});\n\t\t});\n\n\t\treturn grouped;\n\t}, [jobs]);\n\n\t// Handlers\n\tconst handleDayTap = useCallback((date: Date, dayJobs: Job[]) => {\n\t\tsetSelectedDay({ date, jobs: dayJobs });\n\t}, []);\n\n\tconst handleJobTap = useCallback((job: Job) => {\n\t\tsetSelectedJob(job);\n\t}, []);\n\n\tconst handleJobAction = useCallback(async (action: string, job: Job, ...args: unknown[]) => {\n\t\tconsole.log(\"Job action:\", action, job, args);\n\t\tsetSelectedJob(null);\n\n\t\ttry {\n\t\t\tswitch (action) {\n\t\t\t\tcase \"view_details\":\n\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"dispatch\":\n\t\t\t\tcase \"arrive\":\n\t\t\t\tcase \"start\":\n\t\t\t\tcase \"complete\":\n\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst newStatus = action === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t};\n\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`);\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t});\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"reassign\": {\n\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tcase \"cancel\": {\n\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\"@/actions/schedule-assignments\");\n\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tdefault:\n\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\ttoast.error(\"An error occurred\");\n\t\t}\n\t}, []);\n\n\tconst handleDayAction = useCallback((action: string, date: Date) => {\n\t\tconsole.log(\"Day action:\", action, date);\n\t\tsetSelectedDay(null);\n\n\t\tswitch (action) {\n\t\t\tcase \"view_day\":\n\t\t\t\t// Navigate to day view with this date selected\n\t\t\t\twindow.location.href = `/dashboard/schedule?view=day&date=${format(date, \"yyyy-MM-dd\")}`;\n\t\t\t\tbreak;\n\t\t\tcase \"create_appointment\":\n\t\t\t\t// Navigate to new appointment page with date pre-filled\n\t\t\t\twindow.location.href = `/dashboard/work/appointments/new?date=${format(date, \"yyyy-MM-dd\")}`;\n\t\t\t\tbreak;\n\t\t\tcase \"create_job\":\n\t\t\t\t// Navigate to new job page with date pre-filled\n\t\t\t\twindow.location.href = `/dashboard/work/jobs/new?date=${format(date, \"yyyy-MM-dd\")}`;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn(\"Unknown day action:\", action);\n\t\t}\n\t}, []);\n\n\tconst isToday = isSameDay(dateObj, new Date());\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Header: Month navigation */}\n\t\t\t<div className=\"shrink-0 border-b bg-background\">\n\t\t\t\t<div className=\"flex items-center justify-between p-3 sm:p-4\">\n\t\t\t\t\t{/* Previous month */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigatePrevious}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Previous month</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Current month/year */}\n\t\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t\t<h2 className=\"text-base sm:text-lg font-semibold\">\n\t\t\t\t\t\t\t{format(dateObj, showWeekView ? \"MMM d - \" : \"MMMM yyyy\")}\n\t\t\t\t\t\t\t{showWeekView && format(addDays(startOfWeek(dateObj), 6), \"MMM d, yyyy\")}\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t{jobsByDate.size} days with jobs\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Next month */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigateNext}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Next month</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* View toggle + Today button */}\n\t\t\t\t<div className=\"flex gap-2 px-3 sm:px-4 pb-3\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"flex-1 h-8 text-xs\"\n\t\t\t\t\t\tonClick={() => setShowWeekView(!showWeekView)}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{showWeekView ? \"Show Month\" : \"Show Week\"}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{!isToday && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-8 text-xs\"\n\t\t\t\t\t\t\tonClick={goToToday}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tToday\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Calendar Grid */}\n\t\t\t<div className=\"flex-1 overflow-auto\">\n\t\t\t\t<div className=\"grid grid-cols-7 h-full\">\n\t\t\t\t\t{/* Weekday Headers */}\n\t\t\t\t\t{WEEKDAYS.map((day, idx) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"sticky top-0 z-10 bg-muted/80 backdrop-blur-sm border-r border-b px-1 py-2 text-center text-[10px] sm:text-xs font-bold uppercase\",\n\t\t\t\t\t\t\t\t(idx === 0 || idx === 6) && \"bg-slate-200/80 dark:bg-slate-700/50\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tkey={day}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"hidden xs:inline\">{day}</span>\n\t\t\t\t\t\t\t<span className=\"xs:hidden\">{WEEKDAYS_SHORT[idx]}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\n\t\t\t\t\t{/* Day Cells */}\n\t\t\t\t\t{weekDays.map((date) => {\n\t\t\t\t\t\tconst dateKey = format(date, \"yyyy-MM-dd\");\n\t\t\t\t\t\tconst dayJobs = jobsByDate.get(dateKey) || [];\n\t\t\t\t\t\tconst isCurrentMonth = isSameMonth(date, dateObj);\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<DayCell\n\t\t\t\t\t\t\t\tdate={date}\n\t\t\t\t\t\t\t\tisCurrentMonth={isCurrentMonth}\n\t\t\t\t\t\t\t\tjobs={dayJobs}\n\t\t\t\t\t\t\t\tkey={date.toISOString()}\n\t\t\t\t\t\t\t\tonDayTap={handleDayTap}\n\t\t\t\t\t\t\t\tonJobTap={handleJobTap}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\n\t\t\t{/* Day Detail Bottom Sheet */}\n\t\t\t<DayDetailBottomSheet\n\t\t\t\tdate={selectedDay?.date || null}\n\t\t\t\tisOpen={selectedDay !== null}\n\t\t\t\tjobs={selectedDay?.jobs || []}\n\t\t\t\tonAction={handleDayAction}\n\t\t\t\tonClose={() => setSelectedDay(null)}\n\t\t\t\tonJobTap={handleJobTap}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 8744, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/monthly-view-lazy.tsx"],"sourcesContent":["/**\n * MonthlyView - Lazy Loaded Wrapper\n *\n * Performance optimization:\n * - Dynamically imports the full 882-line monthly calendar view (~20KB)\n * - Only loads when user switches to \"Month\" view mode\n * - Shows skeleton loading state while importing\n * - Reduces initial schedule page bundle\n */\n\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst MonthlyView = dynamic(\n\t() => import(\"./monthly-view\").then((mod) => ({ default: mod.MonthlyView })),\n\t{\n\t\tloading: () => (\n\t\t\t<div className=\"flex h-full w-full flex-col gap-4 p-4\">\n\t\t\t\t<div className=\"grid grid-cols-7 gap-2\">\n\t\t\t\t\t{Array.from({ length: 35 }).map((_, i) => (\n\t\t\t\t\t\t<Skeleton key={i} className=\"aspect-square w-full\" />\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t),\n\t\tssr: false, // Calendar view requires browser environment\n\t},\n);\n\nexport function MonthlyViewLazy() {\n\treturn <MonthlyView />;\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;CAQC;;;;;AAID;AACA;AAAA;;AAHA;;;;AAKA,MAAM,cAAc,IAAA,oVAAO,EAC1B,IAAM,mJAAyB,IAAI,CAAC,CAAC,MAAQ,CAAC;YAAE,SAAS,IAAI,WAAW;QAAC,CAAC;;;;;;IAEzE,SAAS,kBACR,oWAAC;YAAI,WAAU;sBACd,cAAA,oWAAC;gBAAI,WAAU;0BACb,MAAM,IAAI,CAAC;oBAAE,QAAQ;gBAAG,GAAG,GAAG,CAAC,CAAC,GAAG,kBACnC,oWAAC,iJAAQ;wBAAS,WAAU;uBAAb;;;;;;;;;;;;;;;IAKnB,KAAK;;KAZD;AAgBC,SAAS;IACf,qBAAO,oWAAC;;;;;AACT;MAFgB"}},
    {"offset": {"line": 8817, "column": 0}, "map": {"version":3,"sources":["file:///Users/byronwade/Stratos/apps/web/src/components/schedule/schedule-page-client.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo } from \"react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\nimport { useScheduleKeyboardShortcuts } from \"@/hooks/use-schedule-keyboard-shortcuts\";\nimport type { ScheduleBootstrapSerialized } from \"@/lib/schedule-bootstrap\";\nimport { deserializeScheduleBootstrap } from \"@/lib/schedule-bootstrap\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport { DispatchTimelineLazy as DispatchTimeline } from \"./dispatch-timeline-lazy\";\nimport { KanbanViewLazy as KanbanView } from \"./kanban-view-lazy\";\nimport { DayViewMobile } from \"./mobile/day-view-mobile\";\nimport { KanbanViewMobile } from \"./mobile/kanban-view-mobile\";\nimport { ListViewMobile } from \"./mobile/list-view-mobile\";\nimport { MonthlyViewMobile } from \"./mobile/monthly-view-mobile\";\nimport { MonthlyViewLazy as MonthlyView } from \"./monthly-view-lazy\";\n\ntype SchedulePageClientProps = {\n\tinitialData?: ScheduleBootstrapSerialized;\n\tbootstrapError?: string | null;\n};\n\nexport function SchedulePageClient({\n\tinitialData,\n\tbootstrapError,\n}: SchedulePageClientProps) {\n\tconst hydrateFromServer = useScheduleStore(\n\t\t(state) => state.hydrateFromServer,\n\t);\n\tconst { viewMode } = useScheduleViewStore();\n\tconst isMobile = useIsMobile(); // Detect mobile viewport (<768px)\n\tconst payload = useMemo(\n\t\t() => (initialData ? deserializeScheduleBootstrap(initialData) : null),\n\t\t[initialData],\n\t);\n\n\t// Enable keyboard shortcuts (T=today, N=new, [/]=nav, 1/2/3=views)\n\tuseScheduleKeyboardShortcuts();\n\n\tuseEffect(() => {\n\t\tif (payload) {\n\t\t\thydrateFromServer(payload);\n\t\t}\n\t}, [hydrateFromServer, payload]);\n\n\treturn (\n\t\t<div className=\"m-0 flex h-full w-full flex-1 flex-col overflow-hidden p-0\">\n\t\t\t{bootstrapError && (\n\t\t\t\t<Alert\n\t\t\t\t\tclassName=\"mx-3 md:mx-4 mt-2 mb-3 md:mb-4 max-w-2xl self-center\"\n\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t>\n\t\t\t\t\t<AlertTitle>Live schedule data unavailable</AlertTitle>\n\t\t\t\t\t<AlertDescription>\n\t\t\t\t\t\t{bootstrapError}. Showing the scheduler without preloaded jobsuse\n\t\t\t\t\t\tthe refresh controls after fixing the issue.\n\t\t\t\t\t</AlertDescription>\n\t\t\t\t</Alert>\n\t\t\t)}\n\n\t\t\t{/*\n\t\t\t\tMobile vs Desktop Routing:\n\t\t\t\t- Mobile (<768px): Use mobile-optimized views with vertical scrolling, tap actions\n\t\t\t\t- Desktop (768px): Use existing drag & drop timeline/kanban/month views\n\n\t\t\t\tMobile views:\n\t\t\t\t- List view:  Primary mobile view (vertical scrolling, search/filter)\n\t\t\t\t- Day view:  Vertical timeline with collapsible tech sections\n\t\t\t\t- Week view:  Single-column kanban with swipe navigation\n\t\t\t\t- Month view:  Touch-friendly calendar grid with day detail bottom sheets\n\t\t\t*/}\n\t\t\t{isMobile ? (\n\t\t\t\t<>\n\t\t\t\t\t{viewMode === \"list\" ? (\n\t\t\t\t\t\t<ListViewMobile />\n\t\t\t\t\t) : viewMode === \"day\" ? (\n\t\t\t\t\t\t<DayViewMobile />\n\t\t\t\t\t) : viewMode === \"week\" ? (\n\t\t\t\t\t\t<KanbanViewMobile />\n\t\t\t\t\t) : viewMode === \"month\" ? (\n\t\t\t\t\t\t<MonthlyViewMobile />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t// Fallback: Use list view for unknown modes\n\t\t\t\t\t\t<ListViewMobile />\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t{/* Desktop views (unchanged) */}\n\t\t\t\t\t{viewMode === \"month\" ? (\n\t\t\t\t\t\t<MonthlyView />\n\t\t\t\t\t) : viewMode === \"week\" ? (\n\t\t\t\t\t\t<KanbanView />\n\t\t\t\t\t) : viewMode === \"list\" ? (\n\t\t\t\t\t\t// Desktop users can access list view too\n\t\t\t\t\t\t<ListViewMobile />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<DispatchTimeline />\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AAAA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAhBA;;;;;;;;;;;;;;;AAuBO,SAAS,mBAAmB,EAClC,WAAW,EACX,cAAc,EACW;;IACzB,MAAM,oBAAoB,IAAA,+KAAgB;kEACzC,CAAC,QAAU,MAAM,iBAAiB;;IAEnC,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAA,2LAAoB;IACzC,MAAM,WAAW,IAAA,8JAAW,KAAI,kCAAkC;IAClE,MAAM,UAAU,IAAA,+UAAO;+CACtB,IAAO,cAAc,IAAA,qLAA4B,EAAC,eAAe;8CACjE;QAAC;KAAY;IAGd,mEAAmE;IACnE,IAAA,0MAA4B;IAE5B,IAAA,iVAAS;wCAAC;YACT,IAAI,SAAS;gBACZ,kBAAkB;YACnB;QACD;uCAAG;QAAC;QAAmB;KAAQ;IAE/B,qBACC,oWAAC;QAAI,WAAU;;YACb,gCACA,oWAAC,2IAAK;gBACL,WAAU;gBACV,SAAQ;;kCAER,oWAAC,gJAAU;kCAAC;;;;;;kCACZ,oWAAC,sJAAgB;;4BACf;4BAAe;;;;;;;;;;;;;YAiBlB,yBACA;0BACE,aAAa,uBACb,oWAAC,sMAAc;;;;2BACZ,aAAa,sBAChB,oWAAC,oMAAa;;;;2BACX,aAAa,uBAChB,oWAAC,0MAAgB;;;;2BACd,aAAa,wBAChB,oWAAC,4MAAiB;;;;2BAElB,4CAA4C;8BAC5C,oWAAC,sMAAc;;;;;8CAIjB;0BAEE,aAAa,wBACb,oWAAC,8LAAW;;;;2BACT,aAAa,uBAChB,oWAAC,4LAAU;;;;2BACR,aAAa,SAChB,yCAAyC;8BACzC,oWAAC,sMAAc;;;;yCAEf,oWAAC,wMAAgB;;;;;;;;;;;;AAMvB;GAjFgB;;QAIW,+KAAgB;QAGrB,2LAAoB;QACxB,8JAAW;QAO5B,0MAA4B;;;KAfb"}}]
}