module.exports=[918622,(e,r,t)=>{r.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,r,t)=>{r.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,r,t)=>{r.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},254799,(e,r,t)=>{r.exports=e.x("crypto",()=>require("crypto"))},666680,(e,r,t)=>{r.exports=e.x("node:crypto",()=>require("node:crypto"))},664598,(e,r,t)=>{"use strict";r.exports=e.r(918622)},849614,(e,r,t)=>{"use strict";r.exports=e.r(664598).vendored["react-rsc"].React},848347,(e,r,t)=>{"use strict";var o=Object.defineProperty,i=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a={},l={RequestCookies:()=>g,ResponseCookies:()=>m,parseCookie:()=>p,parseSetCookie:()=>d,stringifyCookie:()=>c};for(var u in l)o(a,u,{get:l[u],enumerable:!0});function c(e){var r;let t=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),o=`${e.name}=${encodeURIComponent(null!=(r=e.value)?r:"")}`;return 0===t.length?o:`${o}; ${t.join("; ")}`}function p(e){let r=new Map;for(let t of e.split(/; */)){if(!t)continue;let e=t.indexOf("=");if(-1===e){r.set(t,"true");continue}let[o,i]=[t.slice(0,e),t.slice(e+1)];try{r.set(o,decodeURIComponent(null!=i?i:"true"))}catch{}}return r}function d(e){if(!e)return;let[[r,t],...o]=p(e),{domain:i,expires:n,httponly:s,maxage:a,path:l,samesite:u,secure:c,partitioned:d,priority:g}=Object.fromEntries(o.map(([e,r])=>[e.toLowerCase().replace(/-/g,""),r]));{var m,y,_={name:r,value:decodeURIComponent(t),domain:i,...n&&{expires:new Date(n)},...s&&{httpOnly:!0},..."string"==typeof a&&{maxAge:Number(a)},path:l,...u&&{sameSite:f.includes(m=(m=u).toLowerCase())?m:void 0},...c&&{secure:!0},...g&&{priority:h.includes(y=(y=g).toLowerCase())?y:void 0},...d&&{partitioned:!0}};let e={};for(let r in _)_[r]&&(e[r]=_[r]);return e}}r.exports=((e,r,t,a)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let t of n(r))s.call(e,t)||void 0===t||o(e,t,{get:()=>r[t],enumerable:!(a=i(r,t))||a.enumerable});return e})(o({},"__esModule",{value:!0}),a);var f=["strict","lax","none"],h=["low","medium","high"],g=class{constructor(e){this._parsed=new Map,this._headers=e;const r=e.get("cookie");if(r)for(const[e,t]of p(r))this._parsed.set(e,{name:e,value:t})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let r="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(r)}getAll(...e){var r;let t=Array.from(this._parsed);if(!e.length)return t.map(([e,r])=>r);let o="string"==typeof e[0]?e[0]:null==(r=e[0])?void 0:r.name;return t.filter(([e])=>e===o).map(([e,r])=>r)}has(e){return this._parsed.has(e)}set(...e){let[r,t]=1===e.length?[e[0].name,e[0].value]:e,o=this._parsed;return o.set(r,{name:r,value:t}),this._headers.set("cookie",Array.from(o).map(([e,r])=>c(r)).join("; ")),this}delete(e){let r=this._parsed,t=Array.isArray(e)?e.map(e=>r.delete(e)):r.delete(e);return this._headers.set("cookie",Array.from(r).map(([e,r])=>c(r)).join("; ")),t}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},m=class{constructor(e){var r,t,o;this._parsed=new Map,this._headers=e;const i=null!=(o=null!=(t=null==(r=e.getSetCookie)?void 0:r.call(e))?t:e.get("set-cookie"))?o:[];for(const e of Array.isArray(i)?i:function(e){if(!e)return[];var r,t,o,i,n,s=[],a=0;function l(){for(;a<e.length&&/\s/.test(e.charAt(a));)a+=1;return a<e.length}for(;a<e.length;){for(r=a,n=!1;l();)if(","===(t=e.charAt(a))){for(o=a,a+=1,l(),i=a;a<e.length&&"="!==(t=e.charAt(a))&&";"!==t&&","!==t;)a+=1;a<e.length&&"="===e.charAt(a)?(n=!0,a=i,s.push(e.substring(r,o)),r=a):a=o+1}else a+=1;(!n||a>=e.length)&&s.push(e.substring(r,e.length))}return s}(i)){const r=d(e);r&&this._parsed.set(r.name,r)}}get(...e){let r="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(r)}getAll(...e){var r;let t=Array.from(this._parsed.values());if(!e.length)return t;let o="string"==typeof e[0]?e[0]:null==(r=e[0])?void 0:r.name;return t.filter(e=>e.name===o)}has(e){return this._parsed.has(e)}set(...e){let[r,t,o]=1===e.length?[e[0].name,e[0].value,e[0]]:e,i=this._parsed;return i.set(r,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:r,value:t,...o})),function(e,r){for(let[,t]of(r.delete("set-cookie"),e)){let e=c(t);r.append("set-cookie",e)}}(i,this._headers),this}delete(...e){let[r,t]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0]];return this.set({...t,name:r,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(c).join("; ")}}},335014,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ReflectAdapter",{enumerable:!0,get:function(){return o}});class o{static get(e,r,t){let o=Reflect.get(e,r,t);return"function"==typeof o?o.bind(e):o}static set(e,r,t,o){return Reflect.set(e,r,t,o)}static has(e,r){return Reflect.has(e,r)}static deleteProperty(e,r){return Reflect.deleteProperty(e,r)}}},52773,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={isRequestAPICallableInsideAfter:function(){return u},throwForSearchParamsAccessInUseCache:function(){return l},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return a}};for(var i in o)Object.defineProperty(t,i,{enumerable:!0,get:o[i]});let n=e.r(797518),s=e.r(324725);function a(e,r){throw Object.defineProperty(new n.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${r}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function l(e,r){let t=Object.defineProperty(Error(`Route ${e.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(t,r),e.invalidDynamicUsageError??=t,t}function u(){let e=s.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},479404,(e,r,t)=>{"use strict";r.exports=e.r(664598).vendored["react-rsc"].ReactServerDOMTurbopackServer},471312,(e,r,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"registerServerReference",{enumerable:!0,get:function(){return o.registerServerReference}});let o=e.r(479404)},798348,(e,r,t)=>{"use strict";function o(e){for(let r=0;r<e.length;r++){let t=e[r];if("function"!=typeof t)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof t}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"ensureServerEntryExports",{enumerable:!0,get:function(){return o}})},273568,e=>{"use strict";var r=e.i(471312),t=e.i(381259);async function o(){let e=process.env.SUPABASE_POOLER_URL||"https://togejqdwggezkxahomeh.supabase.co",r=process.env.SUPABASE_SERVICE_ROLE_KEY;return e&&r?(0,t.createClient)(e,r,{auth:{persistSession:!1,autoRefreshToken:!1},db:{schema:"public"},global:{headers:{"x-my-custom-header":"service-role"}}}):null}(0,e.i(798348).ensureServerEntryExports)([o]),(0,r.registerServerReference)(o,"00a13dbd00149949fc1367d3e76ae7d789e07f5321",null),e.s(["createServiceSupabaseClient",()=>o])},244284,e=>{"use strict";var r=e.i(895811);function t(e){let r=e.toLowerCase();return r.includes("localhost")||r.includes("127.0.0.1")||r.includes("0.0.0.0")||r.endsWith(".local")||r.includes("://local")}function o(){let e=[],o=[],i={apiKey:!1,connectionId:!1,messagingProfileId:!1,webhookSecret:!1,publicKey:!1,siteUrl:!1};r.TELNYX_CONFIG.apiKey&&""!==r.TELNYX_CONFIG.apiKey.trim()?r.TELNYX_CONFIG.apiKey.length<20?e.push("TELNYX_API_KEY appears to be invalid (too short). Get your API key from https://portal.telnyx.com"):i.apiKey=!0:e.push("TELNYX_API_KEY is not set. This is required for all Telnyx operations."),r.TELNYX_CONFIG.connectionId&&""!==r.TELNYX_CONFIG.connectionId.trim()?i.connectionId=!0:e.push("NEXT_PUBLIC_TELNYX_CONNECTION_ID is not set. This is required for phone calls. Get it from Telnyx Portal → Mission Control → Connections."),r.TELNYX_CONFIG.messagingProfileId&&""!==r.TELNYX_CONFIG.messagingProfileId.trim()?i.messagingProfileId=!0:e.push("TELNYX_DEFAULT_MESSAGING_PROFILE_ID or NEXT_PUBLIC_TELNYX_MESSAGING_PROFILE_ID is not set. This is required for SMS/MMS. Run getDefaultMessagingProfile() to fetch it automatically from Telnyx."),r.TELNYX_CONFIG.webhookSecret&&""!==r.TELNYX_CONFIG.webhookSecret.trim()?i.webhookSecret=!0:o.push("TELNYX_WEBHOOK_SECRET is not set. Webhook signature verification will be disabled. Set this in production for security."),r.TELNYX_CONFIG.publicKey&&""!==r.TELNYX_CONFIG.publicKey.trim()?i.publicKey=!0:o.push("TELNYX_PUBLIC_KEY is not set. Webhook signature verification may not work correctly. Get it from Telnyx Portal → API Keys.");let n=function(){for(let e of["http://localhost:3000",process.env.SITE_URL,"http://localhost:3000",process.env.APP_URL])if(e&&e.trim()){let r=e.trim();if(!t(r))return r.startsWith("http")?r:`https://${r}`}let e=process.env.VERCEL_URL;if(e&&!t(e))return e.startsWith("http")?e:`https://${e}`}();return n?t(n)?"production"===process.env.VERCEL_ENV||"production"===process.env.DEPLOYMENT_ENV?e.push(`Site URL is set to localhost (${n}) but you're in production. Set NEXT_PUBLIC_SITE_URL to your production domain.`):o.push(`Site URL is set to localhost (${n}). This will not work in production.`):i.siteUrl=!0:e.push("NEXT_PUBLIC_SITE_URL or SITE_URL is not set to a valid production URL. This is required for webhook callbacks. Set it to your production domain (e.g., https://thorbis.co)."),{valid:0===e.length,errors:e,warnings:o,config:i}}async function i(){let r=o();if(!r.config.apiKey)return{valid:!1,error:"TELNYX_API_KEY is required for SMS operations"};if(!r.config.messagingProfileId){try{let{getDefaultMessagingProfile:r}=await e.A(989318),t=await r();if(t.success&&t.profile)return{valid:!1,error:"TELNYX_DEFAULT_MESSAGING_PROFILE_ID is required for SMS operations.",suggestedProfileId:t.profile.id}}catch{}return{valid:!1,error:"TELNYX_DEFAULT_MESSAGING_PROFILE_ID is required for SMS operations. Run getDefaultMessagingProfile() to fetch it automatically from Telnyx."}}return r.config.siteUrl?{valid:!0}:{valid:!1,error:"NEXT_PUBLIC_SITE_URL must be set to a valid production URL for SMS webhooks."}}function n(){let e=o();return e.config.apiKey?e.config.connectionId?e.config.siteUrl?{valid:!0}:{valid:!1,error:"NEXT_PUBLIC_SITE_URL must be set to a valid production URL for call webhooks."}:{valid:!1,error:"NEXT_PUBLIC_TELNYX_CONNECTION_ID is required for phone calls. Get it from Telnyx Portal → Mission Control → Connections."}:{valid:!1,error:"TELNYX_API_KEY is required for phone calls"}}e.s(["validateCallConfig",()=>n,"validateSmsConfig",()=>i,"validateTelnyxConfig",()=>o])},394972,e=>{"use strict";var r=e.i(895811);async function t(){try{let e=((await r.telnyxClient.messagingProfiles.list()).data||[]).map(e=>({id:e.id,name:e.name||"Unnamed Profile",enabled:!1!==e.enabled,webhook_url:e.webhook_url||null,webhook_failover_url:e.webhook_failover_url||null,webhook_api_version:e.webhook_api_version||null}));return{success:!0,profiles:e}}catch(e){return{success:!1,error:e?.message||"Failed to list messaging profiles"}}}async function o(){let e,r=await t();if(!r.success||!r.profiles)return{success:!1,error:r.error||"Failed to fetch messaging profiles"};if(0===r.profiles.length)return{success:!1,error:"No messaging profiles found in Telnyx account",recommendation:"Create a messaging profile in Telnyx Portal → Messaging → Profiles"};let o=r.profiles.filter(e=>e.enabled),i=o.length>0?o[0]:r.profiles[0];return r.profiles.length>1&&(e=`Found ${r.profiles.length} messaging profiles. Using "${i.name}" (ID: ${i.id}). To use a different profile, set TELNYX_DEFAULT_MESSAGING_PROFILE_ID to the desired profile ID.`),{success:!0,profile:i,recommendation:e}}e.s(["getDefaultMessagingProfile",()=>o])},160505,e=>{"use strict";var r=e.i(895811);function t(){for(let e of["http://localhost:3000",process.env.SITE_URL,"http://localhost:3000",process.env.APP_URL])if(e&&e.trim()){let r=e.trim();if(!(r.includes("localhost")||r.includes("127.0.0.1")||r.includes("0.0.0.0"))){let e=r.startsWith("http")?r:`https://${r}`;return`${e.replace(/\/+$/,"")}/api/webhooks/telnyx`}}}async function o(e){let o=e||r.TELNYX_CONFIG.connectionId,i={exists:!1,isActive:!1,hasWebhookUrl:!1,webhookUrl:null,webhookFailoverUrl:null,webhookApiVersion:null,connectionType:null,supportsVoice:!1,needsFix:!1,issues:[]};if(!o||""===o.trim())return i.issues.push("Connection ID is not configured"),i.needsFix=!0,i;try{let e=(await r.telnyxClient.callControlApplications.retrieve(o)).data;if(!e)return i.issues.push(`Connection ${o} not found in Telnyx`),i.needsFix=!0,i;i.exists=!0,i.isActive=!1!==e.active,i.webhookUrl=e.webhook_event_url||null,i.webhookFailoverUrl=e.webhook_event_failover_url||null,i.webhookApiVersion=e.webhook_api_version||null,i.connectionType=e.type||null,i.supportsVoice=!0;let n=t();if(n)if(i.webhookUrl){let e=i.webhookUrl.split("?")[0];e===n||i.webhookUrl===n?i.hasWebhookUrl=!0:(i.issues.push(`Webhook URL base is not set correctly. Expected: ${n}, Current: ${e}`),i.needsFix=!0)}else i.issues.push(`Webhook URL is not set. Expected: ${n} (with optional ?company=... for multi-tenant)`),i.needsFix=!0;else i.issues.push("NEXT_PUBLIC_SITE_URL is not set to a valid production URL"),i.needsFix=!0;return"2"!==i.webhookApiVersion&&(i.issues.push(`Webhook API version should be "2", but is "${i.webhookApiVersion||"not set"}"`),i.needsFix=!0),i.isActive||(i.issues.push("Connection is not active"),i.needsFix=!0),i}catch(e){return e?.statusCode===404?i.issues.push(`Connection ${o} not found in Telnyx`):i.issues.push(e?.message||"Failed to retrieve connection"),i.needsFix=!0,i}}async function i(e,i){let n=e||r.TELNYX_CONFIG.connectionId,s=[];if(!n||""===n.trim())return{success:!1,fixed:!1,error:"Connection ID is not configured",changes:[]};try{let e=await o(n);if(!e.needsFix)return{success:!0,fixed:!1,changes:[]};let a=i?.webhookUrl||t();if(!a)return{success:!1,fixed:!1,error:"NEXT_PUBLIC_SITE_URL must be set to a valid production URL to configure webhooks",changes:[]};let l={};e.webhookUrl!==a&&(l.webhook_event_url=a,s.push(`Updated webhook URL to ${a}`));let u=i?.webhookFailoverUrl||process.env.TELNYX_WEBHOOK_FAILOVER_URL||null;return e.webhookFailoverUrl!==u&&(l.webhook_event_failover_url=u,u?s.push(`Updated webhook failover URL to ${u}`):s.push("Removed webhook failover URL")),"2"!==e.webhookApiVersion&&(l.webhook_api_version="2",s.push("Updated webhook API version to 2")),e.isActive||(l.active=!0,s.push("Activated connection")),Object.keys(l).length>0&&await r.telnyxClient.callControlApplications.update(n,l),{success:!0,fixed:s.length>0,changes:s}}catch(e){return{success:!1,fixed:!1,error:e?.message||"Failed to update connection",changes:s}}}e.s(["fixConnection",()=>i,"verifyConnection",()=>o])},70110,e=>{"use strict";var r=e.i(666680),t=e.i(895811),o=e.i(786348);e.i(408305),e.i(692837);var i=e.i(273568);let n={maxTimestampAgeSeconds:300,minTimestampAgeFutureSeconds:60,dedupWindowMinutes:5,logLevel:process.env.TELNYX_WEBHOOK_LOG_LEVEL||"info"},s=new Map,a=60*n.dedupWindowMinutes*1e3;function l(e){let i=e.correlationId||"unknown";try{let n=t.TELNYX_CONFIG.publicKey;if(!n)return o.telnyxLogger.error("SECURITY: Webhook rejected - TELNYX_PUBLIC_KEY not configured in production",{correlationId:i}),{valid:!1,error:"TELNYX_PUBLIC_KEY is required in production - webhook rejected"};if(!e.signature)return o.telnyxLogger.warn("Webhook missing signature header",{correlationId:i}),{valid:!1,error:"Missing telnyx-signature-ed25519 header"};if(!e.timestamp)return o.telnyxLogger.warn("Webhook missing timestamp header",{correlationId:i}),{valid:!1,error:"Missing telnyx-timestamp header"};let s=Buffer.isBuffer(e.payload)?e.payload:Buffer.from(e.payload),a=Buffer.concat([Buffer.from(e.timestamp),Buffer.from("|"),s]),l=r.default.createPublicKey({key:Buffer.from(n,"base64"),format:"der",type:"spki"});if(!r.default.verify(null,a,l,Buffer.from(e.signature,"base64")))return o.telnyxLogger.warn("Webhook signature verification failed - invalid signature",{correlationId:i}),{valid:!1,error:"Invalid signature"};return o.telnyxLogger.debug("Webhook signature verified successfully",{correlationId:i}),{valid:!0}}catch(e){return o.telnyxLogger.error("Webhook signature verification error",{correlationId:i,error:e instanceof Error?e.message:"Unknown error"}),{valid:!1,error:e instanceof Error?e.message:"Signature verification failed"}}}function u(e){try{let r="string"==typeof e?JSON.parse(e):JSON.parse(e.toString());if(!(r.data?.event_type&&r.data.payload))return null;return r}catch{return null}}function c(e){return e.data.event_type}function p(e){return e.startsWith("call.")}function d(e){return e.startsWith("message.")}function f(e,r){return{success:e,message:r||(e?"Webhook processed successfully":"Webhook processing failed")}}function h(e,r=n.maxTimestampAgeSeconds){try{let t;if(!e)return{valid:!1,error:"Missing timestamp"};let o=Number(e);if(Number.isFinite(o))t=1e3*o;else{let r=new Date(e).getTime();if(Number.isNaN(r))return{valid:!1,error:"Invalid timestamp format"};t=r}let i=(Date.now()-t)/1e3;if(i>r)return{valid:!1,error:`Timestamp too old: ${Math.round(i)}s (max ${r}s)`,ageSeconds:i};if(i<-n.minTimestampAgeFutureSeconds)return{valid:!1,error:`Timestamp too far in future: ${Math.round(-i)}s`,ageSeconds:i};return{valid:!0,ageSeconds:i}}catch(e){return{valid:!1,error:e instanceof Error?e.message:"Timestamp validation failed"}}}async function g(e,r,t="telnyx"){try{let l=await (0,i.createServiceSupabaseClient)();if(!l){var n;return o.telnyxLogger.warn("Database not available, using in-memory deduplication"),n=r,function(){let e=Date.now()-a;for(let[r,t]of s.entries())t<e&&s.delete(r)}(),s.has(n)}let{data:u,error:c}=await l.from("webhook_dedup_cache").select("id").eq("company_id",e).eq("webhook_id",r).eq("source",t).gt("expires_at",new Date().toISOString()).maybeSingle();if(c)return o.telnyxLogger.error("Database dedup check failed",{error:c.message,webhookId:r}),!1;return null!==u}catch(e){return o.telnyxLogger.error("Deduplication check error",{error:e instanceof Error?e.message:"Unknown error",webhookId:r}),!1}}async function m(e,r,t="telnyx"){try{let l=await (0,i.createServiceSupabaseClient)();if(!l){var n;return void(n=r,s.set(n,Date.now()))}let u=new Date(Date.now()+a).toISOString(),{error:c}=await l.from("webhook_dedup_cache").upsert({company_id:e,webhook_id:r,source:t,processed_at:new Date().toISOString(),expires_at:u},{onConflict:"company_id,webhook_id,source",ignoreDuplicates:!1});c&&o.telnyxLogger.error("Failed to mark webhook as processed",{error:c.message,webhookId:r})}catch(e){o.telnyxLogger.error("Mark webhook processed error",{error:e instanceof Error?e.message:"Unknown error",webhookId:r})}}e.s(["createWebhookResponse",()=>f,"getEventType",()=>c,"isCallEvent",()=>p,"isMessageEvent",()=>d,"isWebhookDuplicateAsync",()=>g,"isWebhookTimestampValid",()=>h,"markWebhookProcessedAsync",()=>m,"parseWebhookPayload",()=>u,"verifyWebhookSignature",()=>l])},989318,e=>{e.v(e=>Promise.resolve().then(()=>e(394972)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__f69b5785._.js.map