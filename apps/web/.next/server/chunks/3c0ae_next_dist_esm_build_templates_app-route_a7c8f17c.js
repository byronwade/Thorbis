module.exports=[466687,e=>{"use strict";var t=e.i(755535),o=e.i(377233),r=e.i(490003),a=e.i(492991),n=e.i(241970),i=e.i(357699),s=e.i(212454),l=e.i(48717),p=e.i(798301),c=e.i(986366),u=e.i(983537),d=e.i(147475),m=e.i(561930),h=e.i(803747),g=e.i(368557),z=e.i(42037),f=e.i(193695);e.i(432036);var b=e.i(573881);e.i(715051);var y=e.i(511368),R=e.i(297676),w=e.i(443608);let v=new class{apiKey;baseUrl="https://maps.googleapis.com/maps/api/staticmap";constructor(){this.apiKey=process.env.GOOGLE_API_KEY||process.env.GOOGLE_MAPS_API_KEY}formatLocation(e){return"string"==typeof e?encodeURIComponent(e):`${e.lat},${e.lng}`}generateMapUrl(e){if(!this.apiKey)return console.warn("Google Maps Static API key not configured"),null;let t=new URLSearchParams;if(t.append("key",this.apiKey),t.append("size",`${e.size.width}x${e.size.height}`),e.center&&t.append("center",this.formatLocation(e.center)),void 0!==e.zoom&&t.append("zoom",e.zoom.toString()),e.scale&&t.append("scale",e.scale.toString()),e.format&&t.append("format",e.format),e.maptype&&t.append("maptype",e.maptype),e.language&&t.append("language",e.language),e.region&&t.append("region",e.region),e.markers&&e.markers.length>0)for(let o of e.markers){let e=[];o.color&&e.push(`color:${o.color}`),o.size&&e.push(`size:${o.size}`),o.label&&e.push(`label:${o.label}`),o.icon&&e.push(`icon:${encodeURIComponent(o.icon)}`),e.push(this.formatLocation(o.location)),t.append("markers",e.join("|"))}if(e.path){let o=[];for(let t of(e.path.color&&o.push(`color:${e.path.color}`),e.path.weight&&o.push(`weight:${e.path.weight}`),e.path.fillcolor&&o.push(`fillcolor:${e.path.fillcolor}`),e.path.geodesic&&o.push("geodesic:true"),e.path.points))o.push(this.formatLocation(t));t.append("path",o.join("|"))}if(e.visible&&e.visible.length>0&&t.append("visible",e.visible.map(e=>encodeURIComponent(e)).join("|")),e.styles&&e.styles.length>0)for(let o of e.styles){let e=[];for(let[t,r]of(o.feature&&e.push(`feature:${o.feature}`),o.element&&e.push(`element:${o.element}`),Object.entries(o.rules)))void 0!==r&&e.push(`${t}:${r}`);t.append("style",e.join("|"))}return{url:`${this.baseUrl}?${t.toString()}`,width:e.size.width*(e.scale||1),height:e.size.height*(e.scale||1),scale:e.scale||1}}getPropertyMap(e){let t=e.coordinates?e.coordinates:e.address,o={center:t,zoom:e.zoom||17,size:e.size||{width:600,height:400},maptype:e.maptype||"hybrid",scale:2};return!1!==e.showMarker&&(o.markers=[{location:t,color:e.markerColor||"red"}]),this.generateMapUrl(o)}getRouteMap(e){let t=[e.origin,...e.waypoints||[],e.destination],o={size:e.size||{width:600,height:400},scale:2,path:{points:t,color:e.pathColor||"0x4285F4",weight:e.pathWeight||4}};return!1!==e.showMarkers&&(o.markers=[{location:e.origin,color:"green",label:"A"},{location:e.destination,color:"red",label:"B"}],e.waypoints&&e.waypoints.forEach((e,t)=>{o.markers?.push({location:e,color:"blue",label:String.fromCharCode(67+t)})})),this.generateMapUrl(o)}getServiceAreaMap(e){let t=1.60934*(e.radius||25),o=[],r="string"==typeof e.center?0:e.center.lat,a="string"==typeof e.center?0:e.center.lng;if("string"!=typeof e.center)for(let e=0;e<=36;e++){let n=e/36*2*Math.PI,i=r+t/111*Math.cos(n),s=a+t/(111*Math.cos(Math.PI/180*r))*Math.sin(n);o.push({lat:i,lng:s})}let n={center:e.center,zoom:e.zoom||10,size:e.size||{width:600,height:400},scale:2,maptype:"roadmap"};return o.length>0&&(n.path={points:o,color:e.borderColor||"0x4285F4",weight:2,fillcolor:e.fillColor||"0x4285F440"}),n.markers=[{location:e.center,color:"red"}],this.generateMapUrl(n)}getMultiLocationMap(e,t={}){let o={size:t.size||{width:600,height:400},scale:2,maptype:t.maptype||"roadmap",markers:e.map((e,t)=>({location:e.location,label:e.label||String.fromCharCode(65+t),color:e.color||"red"}))};return this.generateMapUrl(o)}getJobRouteMap(e,t={}){if(e.length<2)return null;let o={size:t.size||{width:800,height:500},scale:2,path:{points:e.map(e=>e.address),color:t.pathColor||"0x4285F4",weight:4},markers:e.map((t,o)=>({location:t.address,label:t.jobNumber?t.jobNumber.slice(-1):String.fromCharCode(65+o),color:0===o?"green":o===e.length-1?"red":"blue"}))};return this.generateMapUrl(o)}getThumbnailMap(e,t={}){return this.generateMapUrl({center:e,zoom:t.zoom||15,size:t.size||{width:150,height:150},scale:2,maptype:"roadmap",markers:[{location:e,size:"small"}]})}getDarkModeMap(e,t={}){return this.generateMapUrl({center:e,zoom:t.zoom||15,size:t.size||{width:600,height:400},scale:2,maptype:"roadmap",styles:[{feature:"all",element:"geometry",rules:{color:"#242f3e"}},{feature:"all",element:"labels.text.stroke",rules:{color:"#242f3e"}},{feature:"all",element:"labels.text.fill",rules:{color:"#746855"}},{feature:"administrative.locality",element:"labels.text.fill",rules:{color:"#d59563"}},{feature:"road",element:"geometry",rules:{color:"#38414e"}},{feature:"road",element:"geometry.stroke",rules:{color:"#212a37"}},{feature:"road",element:"labels.text.fill",rules:{color:"#9ca5b3"}},{feature:"road.highway",element:"geometry",rules:{color:"#746855"}},{feature:"road.highway",element:"geometry.stroke",rules:{color:"#1f2835"}},{feature:"water",element:"geometry",rules:{color:"#17263c"}},{feature:"water",element:"labels.text.fill",rules:{color:"#515c6d"}}],markers:[{location:e,color:"0xFF5722"}]})}isConfigured(){return!!this.apiKey}},C=w.z.union([w.z.string(),w.z.object({lat:w.z.number(),lng:w.z.number()})]),x=w.z.object({width:w.z.number().min(1).max(640),height:w.z.number().min(1).max(640)}),M=w.z.object({location:C,color:w.z.string().optional(),label:w.z.string().optional(),size:w.z.enum(["tiny","small","mid"]).optional(),icon:w.z.string().optional()}),j=w.z.object({action:w.z.literal("generate"),center:C.optional(),zoom:w.z.number().min(0).max(21).optional(),size:x,scale:w.z.union([w.z.literal(1),w.z.literal(2),w.z.literal(4)]).optional(),maptype:w.z.enum(["roadmap","satellite","terrain","hybrid"]).optional(),markers:w.z.array(M).optional()}),k=w.z.object({action:w.z.literal("property"),address:w.z.string(),coordinates:w.z.object({lat:w.z.number(),lng:w.z.number()}).optional(),size:x.optional(),zoom:w.z.number().optional(),maptype:w.z.enum(["roadmap","satellite","terrain","hybrid"]).optional(),showMarker:w.z.boolean().optional(),markerColor:w.z.string().optional()}),E=w.z.object({action:w.z.literal("route"),origin:C,destination:C,waypoints:w.z.array(C).optional(),size:x.optional(),pathColor:w.z.string().optional(),pathWeight:w.z.number().optional(),showMarkers:w.z.boolean().optional()}),N=w.z.object({action:w.z.literal("service-area"),center:C,radius:w.z.number().optional(),size:x.optional(),fillColor:w.z.string().optional(),borderColor:w.z.string().optional(),zoom:w.z.number().optional()}),A=w.z.object({action:w.z.literal("multi"),locations:w.z.array(w.z.object({location:C,label:w.z.string().optional(),color:w.z.string().optional()})),size:x.optional(),maptype:w.z.enum(["roadmap","satellite","terrain","hybrid"]).optional()}),U=w.z.object({action:w.z.literal("thumbnail"),location:C,size:x.optional(),zoom:w.z.number().optional()}),P=w.z.object({action:w.z.literal("job-route"),stops:w.z.array(w.z.object({address:w.z.string(),jobNumber:w.z.string().optional()})).min(2),size:x.optional(),pathColor:w.z.string().optional()}),S=w.z.object({action:w.z.literal("dark-mode"),location:C,size:x.optional(),zoom:w.z.number().optional()}),O=w.z.discriminatedUnion("action",[j,k,E,N,A,U,P,S]);async function I(e){try{let t=await (0,y.createClient)(),{data:{user:o}}=await t.auth.getUser();if(!o)return R.NextResponse.json({error:"Unauthorized"},{status:401});if(!v.isConfigured())return R.NextResponse.json({error:"Maps Static service is not configured. Set GOOGLE_API_KEY environment variable."},{status:503});let r=await e.json(),a=O.parse(r);switch(a.action){case"generate":{let e=v.generateMapUrl({center:a.center,zoom:a.zoom,size:a.size,scale:a.scale,maptype:a.maptype,markers:a.markers});if(!e)return R.NextResponse.json({error:"Failed to generate map URL"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"property":{let e=v.getPropertyMap({address:a.address,coordinates:a.coordinates,size:a.size,zoom:a.zoom,maptype:a.maptype,showMarker:a.showMarker,markerColor:a.markerColor});if(!e)return R.NextResponse.json({error:"Failed to generate property map"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"route":{let e=v.getRouteMap({origin:a.origin,destination:a.destination,waypoints:a.waypoints,size:a.size,pathColor:a.pathColor,pathWeight:a.pathWeight,showMarkers:a.showMarkers});if(!e)return R.NextResponse.json({error:"Failed to generate route map"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"service-area":{let e=v.getServiceAreaMap({center:a.center,radius:a.radius,size:a.size,fillColor:a.fillColor,borderColor:a.borderColor,zoom:a.zoom});if(!e)return R.NextResponse.json({error:"Failed to generate service area map"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"multi":{let e=v.getMultiLocationMap(a.locations,{size:a.size,maptype:a.maptype});if(!e)return R.NextResponse.json({error:"Failed to generate multi-location map"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"thumbnail":{let e=v.getThumbnailMap(a.location,{size:a.size,zoom:a.zoom});if(!e)return R.NextResponse.json({error:"Failed to generate thumbnail map"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"job-route":{let e=v.getJobRouteMap(a.stops,{size:a.size,pathColor:a.pathColor});if(!e)return R.NextResponse.json({error:"Failed to generate job route map"},{status:500});return R.NextResponse.json({success:!0,data:e})}case"dark-mode":{let e=v.getDarkModeMap(a.location,{size:a.size,zoom:a.zoom});if(!e)return R.NextResponse.json({error:"Failed to generate dark mode map"},{status:500});return R.NextResponse.json({success:!0,data:e})}default:return R.NextResponse.json({error:"Invalid action"},{status:400})}}catch(e){if(console.error("Maps Static API error:",e),e instanceof w.z.ZodError)return R.NextResponse.json({error:"Invalid request data",details:e.errors},{status:400});return R.NextResponse.json({error:"Failed to process maps static request",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}e.s(["POST",()=>I],632761);var T=e.i(632761);let _=new t.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/maps-static/route",pathname:"/api/maps-static",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/maps-static/route.ts",nextConfigOutput:"",userland:T}),{workAsyncStorage:$,workUnitAsyncStorage:F,serverHooks:H}=_;function q(){return(0,r.patchFetch)({workAsyncStorage:$,workUnitAsyncStorage:F})}async function K(e,t,r){_.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let y="/api/maps-static/route";y=y.replace(/\/index$/,"")||"/";let R=await _.prepare(e,t,{srcPage:y,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:w,params:v,nextConfig:C,parsedUrl:x,isDraftMode:M,prerenderManifest:j,routerServerContext:k,isOnDemandRevalidate:E,revalidateOnlyGenerated:N,resolvedPathname:A,clientReferenceManifest:U,serverActionsManifest:P}=R,S=(0,l.normalizeAppPath)(y),O=!!(j.dynamicRoutes[S]||j.routes[A]),I=async()=>((null==k?void 0:k.render404)?await k.render404(e,t,x,!1):t.end("This page could not be found"),null);if(O&&!M){let e=!!j.routes[A],t=j.dynamicRoutes[S];if(t&&!1===t.fallback&&!e){if(C.experimental.adapterPath)return await I();throw new f.NoFallbackError}}let T=null;!O||_.isDev||M||(T="/index"===(T=A)?"/":T);let $=!0===_.isDev||!O,F=O&&!$;P&&U&&(0,i.setReferenceManifestsSingleton)({page:y,clientReferenceManifest:U,serverActionsManifest:P,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:P})});let H=e.method||"GET",q=(0,n.getTracer)(),K=q.getActiveScopeSpan(),L={params:v,prerenderManifest:j,renderOpts:{experimental:{authInterrupts:!!C.experimental.authInterrupts},cacheComponents:!!C.cacheComponents,supportsDynamicResponse:$,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:C.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,o,r)=>_.onRequestError(e,t,r,k)},sharedContext:{buildId:w}},D=new p.NodeNextRequest(e),G=new p.NodeNextResponse(t),B=c.NextRequestAdapter.fromNodeNextRequest(D,(0,c.signalFromNodeResponse)(t));try{let i=async e=>_.handle(B,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let o=q.getRootSpanAttributes();if(!o)return;if(o.get("next.span_type")!==u.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${o.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=o.get("next.route");if(r){let t=`${H} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${H} ${y}`)}),s=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var n,l;let p=async({previousCacheEntry:o})=>{try{if(!s&&E&&N&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(a);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let p=L.renderOpts.collectedTags;if(!O)return await (0,m.sendResponse)(D,G,n,L.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(n.headers);p&&(t[z.NEXT_CACHE_TAGS_HEADER]=p),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let o=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=z.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,r=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=z.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:o,expire:r}}}}catch(t){throw(null==o?void 0:o.isStale)&&await _.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:E})},k),t}},c=await _.handleResponse({req:e,nextConfig:C,cacheKey:T,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:j,isRoutePPREnabled:!1,isOnDemandRevalidate:E,revalidateOnlyGenerated:N,responseGenerator:p,waitUntil:r.waitUntil,isMinimalMode:s});if(!O)return null;if((null==c||null==(n=c.value)?void 0:n.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==c||null==(l=c.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",E?"REVALIDATED":c.isMiss?"MISS":c.isStale?"STALE":"HIT"),M&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let u=(0,h.fromNodeOutgoingHttpHeaders)(c.value.headers);return s&&O||u.delete(z.NEXT_CACHE_TAGS_HEADER),!c.cacheControl||t.getHeader("Cache-Control")||u.get("Cache-Control")||u.set("Cache-Control",(0,g.getCacheControlHeader)(c.cacheControl)),await (0,m.sendResponse)(D,G,new Response(c.value.body,{headers:u,status:c.value.status||200})),null};K?await l(K):await q.withPropagatedContext(e.headers,()=>q.trace(u.BaseServerSpan.handleRequest,{spanName:`${H} ${y}`,kind:n.SpanKind.SERVER,attributes:{"http.method":H,"http.target":e.url}},l))}catch(t){if(t instanceof f.NoFallbackError||await _.onRequestError(e,t,{routerKind:"App Router",routePath:S,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:F,isOnDemandRevalidate:E})}),O)throw t;return await (0,m.sendResponse)(D,G,new Response(null,{status:500})),null}}e.s(["handler",()=>K,"patchFetch",()=>q,"routeModule",()=>_,"serverHooks",()=>H,"workAsyncStorage",()=>$,"workUnitAsyncStorage",()=>F],466687)}];

//# sourceMappingURL=3c0ae_next_dist_esm_build_templates_app-route_a7c8f17c.js.map