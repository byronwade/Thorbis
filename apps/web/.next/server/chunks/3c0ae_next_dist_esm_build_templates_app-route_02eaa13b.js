module.exports=[940163,e=>{"use strict";var t=e.i(755535),n=e.i(377233),r=e.i(490003),a=e.i(492991),s=e.i(241970),i=e.i(357699),o=e.i(212454),l=e.i(48717),u=e.i(798301),p=e.i(986366),d=e.i(983537),c=e.i(147475),h=e.i(561930),m=e.i(803747),g=e.i(368557),y=e.i(42037),b=e.i(193695);e.i(432036);var f=e.i(573881),v=e.i(297676),R=e.i(443608);e.i(715051);var I=e.i(511368);let T="Stratos-FMS/1.0 (support@stratos.app)";class w{apiKey;baseUrl="https://www.googleapis.com/youtube/v3";cache=new Map;cacheTTL=18e5;constructor(){this.apiKey=process.env.GOOGLE_YOUTUBE_API_KEY||process.env.GOOGLE_API_KEY}generateCacheKey(e,t){return`youtube:${e}:${JSON.stringify(t)}`}getFromCache(e){let t=this.cache.get(e);return t&&Date.now()-t.timestamp<this.cacheTTL?t.data:null}setInCache(e,t){this.cache.set(e,{data:t,timestamp:Date.now()})}parseDuration(e){let t=e.match(/PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/);return t?3600*Number.parseInt(t[1]||"0",10)+60*Number.parseInt(t[2]||"0",10)+Number.parseInt(t[3]||"0",10):0}async search(e,t={}){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;let n=this.generateCacheKey("search",{query:e,options:t}),r=this.getFromCache(n);if(r)return r;try{let r=new URLSearchParams({key:this.apiKey,part:"snippet",q:e,maxResults:(t.maxResults||25).toString()});t.pageToken&&r.append("pageToken",t.pageToken),t.order&&r.append("order",t.order),t.type&&r.append("type",t.type.join(",")),t.publishedAfter&&r.append("publishedAfter",t.publishedAfter),t.publishedBefore&&r.append("publishedBefore",t.publishedBefore),t.regionCode&&r.append("regionCode",t.regionCode),t.videoDuration&&r.append("videoDuration",t.videoDuration),t.videoDefinition&&r.append("videoDefinition",t.videoDefinition),t.videoType&&r.append("videoType",t.videoType),t.channelId&&r.append("channelId",t.channelId),t.relatedToVideoId&&r.append("relatedToVideoId",t.relatedToVideoId),t.safeSearch&&r.append("safeSearch",t.safeSearch);let a=`${this.baseUrl}/search?${r.toString()}`,s=await fetch(a,{headers:{"User-Agent":T}});if(!s.ok)return console.error("YouTube search error:",s.status),null;let i=await s.json(),o={results:(i.items||[]).map(e=>{let t=e.snippet,n=e.id;return{id:n.videoId||n.channelId||n.playlistId||"",type:n.videoId?"video":n.channelId?"channel":"playlist",title:t.title,description:t.description,publishedAt:t.publishedAt,channelId:t.channelId,channelTitle:t.channelTitle,thumbnails:t.thumbnails}}),nextPageToken:i.nextPageToken,totalResults:i.pageInfo?.totalResults||0};return this.setInCache(n,o),o}catch(e){return console.error("YouTube search error:",e),null}}async getVideo(e){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;let t=this.generateCacheKey("video",{videoId:e}),n=this.getFromCache(t);if(n)return n;try{let n=new URLSearchParams({key:this.apiKey,part:"snippet,contentDetails,statistics,player",id:e}),r=`${this.baseUrl}/videos?${n.toString()}`,a=await fetch(r,{headers:{"User-Agent":T}});if(!a.ok)return console.error("YouTube get video error:",a.status),null;let s=await a.json();if(!s.items||0===s.items.length)return null;let i=s.items[0],o={id:i.id,title:i.snippet.title,description:i.snippet.description,publishedAt:i.snippet.publishedAt,channelId:i.snippet.channelId,channelTitle:i.snippet.channelTitle,thumbnails:i.snippet.thumbnails,tags:i.snippet.tags,categoryId:i.snippet.categoryId,duration:i.contentDetails?.duration,viewCount:Number.parseInt(i.statistics?.viewCount||"0",10),likeCount:Number.parseInt(i.statistics?.likeCount||"0",10),commentCount:Number.parseInt(i.statistics?.commentCount||"0",10),embedHtml:i.player?.embedHtml};return this.setInCache(t,o),o}catch(e){return console.error("YouTube get video error:",e),null}}async getVideos(e){if(!this.apiKey||0===e.length)return null;let t=[];for(let n=0;n<e.length;n+=50){let r=e.slice(n,n+50);try{let e=new URLSearchParams({key:this.apiKey,part:"snippet,contentDetails,statistics",id:r.join(",")}),n=`${this.baseUrl}/videos?${e.toString()}`,a=await fetch(n,{headers:{"User-Agent":T}});if(!a.ok)continue;for(let e of(await a.json()).items||[])t.push({id:e.id,title:e.snippet.title,description:e.snippet.description,publishedAt:e.snippet.publishedAt,channelId:e.snippet.channelId,channelTitle:e.snippet.channelTitle,thumbnails:e.snippet.thumbnails,tags:e.snippet.tags,categoryId:e.snippet.categoryId,duration:e.contentDetails?.duration,viewCount:Number.parseInt(e.statistics?.viewCount||"0",10),likeCount:Number.parseInt(e.statistics?.likeCount||"0",10),commentCount:Number.parseInt(e.statistics?.commentCount||"0",10)})}catch(e){console.error("YouTube batch get videos error:",e)}}return t}async getChannel(e){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;let t=this.generateCacheKey("channel",{channelId:e}),n=this.getFromCache(t);if(n)return n;try{let n=new URLSearchParams({key:this.apiKey,part:"snippet,statistics",id:e}),r=`${this.baseUrl}/channels?${n.toString()}`,a=await fetch(r,{headers:{"User-Agent":T}});if(!a.ok)return console.error("YouTube get channel error:",a.status),null;let s=await a.json();if(!s.items||0===s.items.length)return null;let i=s.items[0],o={id:i.id,title:i.snippet.title,description:i.snippet.description,customUrl:i.snippet.customUrl,publishedAt:i.snippet.publishedAt,thumbnails:i.snippet.thumbnails,subscriberCount:Number.parseInt(i.statistics?.subscriberCount||"0",10),videoCount:Number.parseInt(i.statistics?.videoCount||"0",10),viewCount:Number.parseInt(i.statistics?.viewCount||"0",10)};return this.setInCache(t,o),o}catch(e){return console.error("YouTube get channel error:",e),null}}async getPlaylist(e){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;let t=this.generateCacheKey("playlist",{playlistId:e}),n=this.getFromCache(t);if(n)return n;try{let n=new URLSearchParams({key:this.apiKey,part:"snippet,contentDetails",id:e}),r=`${this.baseUrl}/playlists?${n.toString()}`,a=await fetch(r,{headers:{"User-Agent":T}});if(!a.ok)return console.error("YouTube get playlist error:",a.status),null;let s=await a.json();if(!s.items||0===s.items.length)return null;let i=s.items[0],o={id:i.id,title:i.snippet.title,description:i.snippet.description,publishedAt:i.snippet.publishedAt,channelId:i.snippet.channelId,channelTitle:i.snippet.channelTitle,thumbnails:i.snippet.thumbnails,itemCount:i.contentDetails?.itemCount||0};return this.setInCache(t,o),o}catch(e){return console.error("YouTube get playlist error:",e),null}}async getPlaylistItems(e,t={}){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;try{let n=new URLSearchParams({key:this.apiKey,part:"snippet,contentDetails",playlistId:e,maxResults:(t.maxResults||50).toString()});t.pageToken&&n.append("pageToken",t.pageToken);let r=`${this.baseUrl}/playlistItems?${n.toString()}`,a=await fetch(r,{headers:{"User-Agent":T}});if(!a.ok)return console.error("YouTube get playlist items error:",a.status),null;let s=await a.json();return{items:(s.items||[]).map(e=>{let t=e.snippet;return{id:e.id,playlistId:t.playlistId,position:t.position,videoId:t.resourceId?.videoId||"",title:t.title,description:t.description,thumbnails:t.thumbnails,channelId:t.channelId,channelTitle:t.channelTitle}}),nextPageToken:s.nextPageToken,totalResults:s.pageInfo?.totalResults||0}}catch(e){return console.error("YouTube get playlist items error:",e),null}}async getComments(e,t={}){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;try{let n=new URLSearchParams({key:this.apiKey,part:"snippet",videoId:e,maxResults:(t.maxResults||100).toString(),order:t.order||"relevance"});t.pageToken&&n.append("pageToken",t.pageToken);let r=`${this.baseUrl}/commentThreads?${n.toString()}`,a=await fetch(r,{headers:{"User-Agent":T}});if(!a.ok)return console.error("YouTube get comments error:",a.status),null;let s=await a.json();return{comments:(s.items||[]).map(e=>{let t=e.snippet.topLevelComment.snippet;return{id:e.id,videoId:t.videoId,authorDisplayName:t.authorDisplayName,authorProfileImageUrl:t.authorProfileImageUrl,authorChannelId:t.authorChannelId?.value||"",textDisplay:t.textDisplay,textOriginal:t.textOriginal,likeCount:t.likeCount,publishedAt:t.publishedAt,updatedAt:t.updatedAt,totalReplyCount:e.snippet?.totalReplyCount}}),nextPageToken:s.nextPageToken,totalResults:s.pageInfo?.totalResults||0}}catch(e){return console.error("YouTube get comments error:",e),null}}async getCategories(e="US"){if(!this.apiKey)return console.warn("YouTube API key not configured"),null;let t=this.generateCacheKey("categories",{regionCode:e}),n=this.getFromCache(t);if(n)return n;try{let n=new URLSearchParams({key:this.apiKey,part:"snippet",regionCode:e}),r=`${this.baseUrl}/videoCategories?${n.toString()}`,a=await fetch(r,{headers:{"User-Agent":T}});if(!a.ok)return console.error("YouTube get categories error:",a.status),null;let s=((await a.json()).items||[]).map(e=>({id:e.id,title:e.snippet.title}));return this.setInCache(t,s),s}catch(e){return console.error("YouTube get categories error:",e),null}}async searchTutorials(e,t={}){let n=`${e} tutorial how to field service HVAC plumbing electrical`,r=await this.search(n,{maxResults:t.maxResults||10,type:["video"],order:"relevance",videoDuration:"medium",safeSearch:"strict"});return r?.results||null}getEmbedUrl(e,t={}){let n=new URLSearchParams;t.autoplay&&n.append("autoplay","1"),t.mute&&n.append("mute","1"),t.loop&&n.append("loop","1");let r=n.toString();return`https://www.youtube.com/embed/${e}${r?`?${r}`:""}`}getThumbnailUrl(e,t="high"){return`https://img.youtube.com/vi/${e}/${({default:"default",medium:"mqdefault",high:"hqdefault",standard:"sddefault",maxres:"maxresdefault"})[t]}.jpg`}isConfigured(){return!!this.apiKey}clearCache(){this.cache.clear()}}let C=new w,x=R.z.object({maxResults:R.z.number().min(1).max(50).optional(),pageToken:R.z.string().optional(),order:R.z.enum(["date","rating","relevance","title","videoCount","viewCount"]).optional(),type:R.z.array(R.z.enum(["video","channel","playlist"])).optional(),publishedAfter:R.z.string().optional(),publishedBefore:R.z.string().optional(),regionCode:R.z.string().optional(),videoDuration:R.z.enum(["any","short","medium","long"]).optional(),videoDefinition:R.z.enum(["any","high","standard"]).optional(),videoType:R.z.enum(["any","episode","movie"]).optional(),channelId:R.z.string().optional(),relatedToVideoId:R.z.string().optional(),safeSearch:R.z.enum(["moderate","none","strict"]).optional()}).optional(),A=R.z.object({action:R.z.literal("search"),query:R.z.string().min(1),options:x}),k=R.z.object({action:R.z.literal("video"),videoId:R.z.string()}),z=R.z.object({action:R.z.literal("videos"),videoIds:R.z.array(R.z.string()).min(1).max(50)}),N=R.z.object({action:R.z.literal("channel"),channelId:R.z.string()}),P=R.z.object({action:R.z.literal("playlist"),playlistId:R.z.string()}),U=R.z.object({action:R.z.literal("playlist-items"),playlistId:R.z.string(),maxResults:R.z.number().min(1).max(50).optional(),pageToken:R.z.string().optional()}),j=R.z.object({action:R.z.literal("comments"),videoId:R.z.string(),maxResults:R.z.number().min(1).max(100).optional(),pageToken:R.z.string().optional(),order:R.z.enum(["time","relevance"]).optional()}),E=R.z.object({action:R.z.literal("categories"),regionCode:R.z.string().optional()}),S=R.z.object({action:R.z.literal("tutorials"),topic:R.z.string(),maxResults:R.z.number().min(1).max(25).optional()}),K=R.z.object({action:R.z.literal("embed-url"),videoId:R.z.string(),autoplay:R.z.boolean().optional(),mute:R.z.boolean().optional(),loop:R.z.boolean().optional()}),D=R.z.object({action:R.z.literal("thumbnail-url"),videoId:R.z.string(),quality:R.z.enum(["default","medium","high","standard","maxres"]).optional()}),O=R.z.discriminatedUnion("action",[A,k,z,N,P,U,j,E,S,K,D]);async function $(e){try{let t=await (0,I.createClient)(),{data:{user:n}}=await t.auth.getUser();if(!n)return v.NextResponse.json({error:"Unauthorized"},{status:401});if(!C.isConfigured())return v.NextResponse.json({error:"YouTube service is not configured. Set GOOGLE_YOUTUBE_API_KEY or GOOGLE_API_KEY environment variable."},{status:503});let r=await e.json(),a=O.parse(r);switch(a.action){case"search":{let e=await C.search(a.query,a.options||{});if(!e)return v.NextResponse.json({error:"Failed to search YouTube"},{status:500});return v.NextResponse.json({success:!0,data:e})}case"video":{let e=await C.getVideo(a.videoId);if(!e)return v.NextResponse.json({error:"Video not found"},{status:404});return v.NextResponse.json({success:!0,data:e})}case"videos":{let e=await C.getVideos(a.videoIds);if(!e)return v.NextResponse.json({error:"Failed to get videos"},{status:500});return v.NextResponse.json({success:!0,data:{videos:e,count:e.length}})}case"channel":{let e=await C.getChannel(a.channelId);if(!e)return v.NextResponse.json({error:"Channel not found"},{status:404});return v.NextResponse.json({success:!0,data:e})}case"playlist":{let e=await C.getPlaylist(a.playlistId);if(!e)return v.NextResponse.json({error:"Playlist not found"},{status:404});return v.NextResponse.json({success:!0,data:e})}case"playlist-items":{let e=await C.getPlaylistItems(a.playlistId,{maxResults:a.maxResults,pageToken:a.pageToken});if(!e)return v.NextResponse.json({error:"Failed to get playlist items"},{status:500});return v.NextResponse.json({success:!0,data:e})}case"comments":{let e=await C.getComments(a.videoId,{maxResults:a.maxResults,pageToken:a.pageToken,order:a.order});if(!e)return v.NextResponse.json({error:"Failed to get comments"},{status:500});return v.NextResponse.json({success:!0,data:e})}case"categories":{let e=await C.getCategories(a.regionCode);if(!e)return v.NextResponse.json({error:"Failed to get categories"},{status:500});return v.NextResponse.json({success:!0,data:{categories:e}})}case"tutorials":{let e=await C.searchTutorials(a.topic,{maxResults:a.maxResults});if(!e)return v.NextResponse.json({error:"Failed to search tutorials"},{status:500});return v.NextResponse.json({success:!0,data:{tutorials:e,count:e.length}})}case"embed-url":{let e=C.getEmbedUrl(a.videoId,{autoplay:a.autoplay,mute:a.mute,loop:a.loop});return v.NextResponse.json({success:!0,data:{url:e}})}case"thumbnail-url":{let e=C.getThumbnailUrl(a.videoId,a.quality);return v.NextResponse.json({success:!0,data:{url:e}})}default:return v.NextResponse.json({error:"Invalid action"},{status:400})}}catch(e){if(console.error("YouTube API error:",e),e instanceof R.z.ZodError)return v.NextResponse.json({error:"Invalid request data",details:e.errors},{status:400});return v.NextResponse.json({error:"Failed to process YouTube request",message:e instanceof Error?e.message:"Unknown error"},{status:500})}}e.s(["POST",()=>$],747124);var Y=e.i(747124);let _=new t.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/youtube/route",pathname:"/api/youtube",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/youtube/route.ts",nextConfigOutput:"",userland:Y}),{workAsyncStorage:q,workUnitAsyncStorage:F,serverHooks:H}=_;function L(){return(0,r.patchFetch)({workAsyncStorage:q,workUnitAsyncStorage:F})}async function M(e,t,r){_.isDev&&(0,a.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let v="/api/youtube/route";v=v.replace(/\/index$/,"")||"/";let R=await _.prepare(e,t,{srcPage:v,multiZoneDraftMode:!1});if(!R)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:I,params:T,nextConfig:w,parsedUrl:C,isDraftMode:x,prerenderManifest:A,routerServerContext:k,isOnDemandRevalidate:z,revalidateOnlyGenerated:N,resolvedPathname:P,clientReferenceManifest:U,serverActionsManifest:j}=R,E=(0,l.normalizeAppPath)(v),S=!!(A.dynamicRoutes[E]||A.routes[P]),K=async()=>((null==k?void 0:k.render404)?await k.render404(e,t,C,!1):t.end("This page could not be found"),null);if(S&&!x){let e=!!A.routes[P],t=A.dynamicRoutes[E];if(t&&!1===t.fallback&&!e){if(w.experimental.adapterPath)return await K();throw new b.NoFallbackError}}let D=null;!S||_.isDev||x||(D="/index"===(D=P)?"/":D);let O=!0===_.isDev||!S,$=S&&!O;j&&U&&(0,i.setReferenceManifestsSingleton)({page:v,clientReferenceManifest:U,serverActionsManifest:j,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:j})});let Y=e.method||"GET",q=(0,s.getTracer)(),F=q.getActiveScopeSpan(),H={params:T,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:O,incrementalCache:(0,a.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,r)=>_.onRequestError(e,t,r,k)},sharedContext:{buildId:I}},L=new u.NodeNextRequest(e),M=new u.NodeNextResponse(t),V=p.NextRequestAdapter.fromNodeNextRequest(L,(0,p.signalFromNodeResponse)(t));try{let i=async e=>_.handle(V,H).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=q.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let r=n.get("next.route");if(r){let t=`${Y} ${r}`;e.setAttributes({"next.route":r,"http.route":r,"next.span_name":t}),e.updateName(t)}else e.updateName(`${Y} ${v}`)}),o=!!(0,a.getRequestMeta)(e,"minimalMode"),l=async a=>{var s,l;let u=async({previousCacheEntry:n})=>{try{if(!o&&z&&N&&!n)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let s=await i(a);e.fetchMetrics=H.renderOpts.fetchMetrics;let l=H.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let u=H.renderOpts.collectedTags;if(!S)return await (0,h.sendResponse)(L,M,s,H.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),t=(0,m.toNodeOutgoingHttpHeaders)(s.headers);u&&(t[y.NEXT_CACHE_TAGS_HEADER]=u),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==H.renderOpts.collectedRevalidate&&!(H.renderOpts.collectedRevalidate>=y.INFINITE_CACHE)&&H.renderOpts.collectedRevalidate,r=void 0===H.renderOpts.collectedExpire||H.renderOpts.collectedExpire>=y.INFINITE_CACHE?void 0:H.renderOpts.collectedExpire;return{value:{kind:f.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:r}}}}catch(t){throw(null==n?void 0:n.isStale)&&await _.onRequestError(e,t,{routerKind:"App Router",routePath:v,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:z})},k),t}},p=await _.handleResponse({req:e,nextConfig:w,cacheKey:D,routeKind:n.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:z,revalidateOnlyGenerated:N,responseGenerator:u,waitUntil:r.waitUntil,isMinimalMode:o});if(!S)return null;if((null==p||null==(s=p.value)?void 0:s.kind)!==f.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==p||null==(l=p.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",z?"REVALIDATED":p.isMiss?"MISS":p.isStale?"STALE":"HIT"),x&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,m.fromNodeOutgoingHttpHeaders)(p.value.headers);return o&&S||d.delete(y.NEXT_CACHE_TAGS_HEADER),!p.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(p.cacheControl)),await (0,h.sendResponse)(L,M,new Response(p.value.body,{headers:d,status:p.value.status||200})),null};F?await l(F):await q.withPropagatedContext(e.headers,()=>q.trace(d.BaseServerSpan.handleRequest,{spanName:`${Y} ${v}`,kind:s.SpanKind.SERVER,attributes:{"http.method":Y,"http.target":e.url}},l))}catch(t){if(t instanceof b.NoFallbackError||await _.onRequestError(e,t,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,c.getRevalidateReason)({isStaticGeneration:$,isOnDemandRevalidate:z})}),S)throw t;return await (0,h.sendResponse)(L,M,new Response(null,{status:500})),null}}e.s(["handler",()=>M,"patchFetch",()=>L,"routeModule",()=>_,"serverHooks",()=>H,"workAsyncStorage",()=>q,"workUnitAsyncStorage",()=>F],940163)}];

//# sourceMappingURL=3c0ae_next_dist_esm_build_templates_app-route_02eaa13b.js.map