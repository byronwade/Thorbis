module.exports=[780328,e=>{"use strict";var t=e.i(479404);let s=(0,t.registerClientReference)(function(){throw Error("Attempted to call StratosChatProvider() from the server but StratosChatProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","StratosChatProvider"),r=(0,t.registerClientReference)(function(){throw Error("Attempted to call createStratosChatStore() from the server but createStratosChatStore is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","createStratosChatStore"),o=(0,t.registerClientReference)(function(){throw Error("Attempted to call useAgentHandoff() from the server but useAgentHandoff is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useAgentHandoff"),n=(0,t.registerClientReference)(function(){throw Error("Attempted to call useAgentStatus() from the server but useAgentStatus is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useAgentStatus"),a=(0,t.registerClientReference)(function(){throw Error("Attempted to call useArtifacts() from the server but useArtifacts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useArtifacts"),i=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatActions() from the server but useChatActions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatActions"),c=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatError() from the server but useChatError is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatError"),l=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatId() from the server but useChatId is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatId"),u=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatMessages() from the server but useChatMessages is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatMessages"),p=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatReset() from the server but useChatReset is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatReset"),d=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatStatus() from the server but useChatStatus is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatStatus"),h=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatStore() from the server but useChatStore is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useChatStore"),m=(0,t.registerClientReference)(function(){throw Error("Attempted to call useDataPart() from the server but useDataPart is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useDataPart"),f=(0,t.registerClientReference)(function(){throw Error("Attempted to call useDataParts() from the server but useDataParts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useDataParts"),g=(0,t.registerClientReference)(function(){throw Error("Attempted to call useIsStreaming() from the server but useIsStreaming is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useIsStreaming"),b=(0,t.registerClientReference)(function(){throw Error("Attempted to call useLastAssistantMessage() from the server but useLastAssistantMessage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useLastAssistantMessage"),C=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageById() from the server but useMessageById is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useMessageById"),y=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageCount() from the server but useMessageCount is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useMessageCount"),v=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageCountByRole() from the server but useMessageCountByRole is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useMessageCountByRole"),w=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageIds() from the server but useMessageIds is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useMessageIds"),R=(0,t.registerClientReference)(function(){throw Error("Attempted to call useRateLimit() from the server but useRateLimit is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useRateLimit"),A=(0,t.registerClientReference)(function(){throw Error("Attempted to call useSelector() from the server but useSelector is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useSelector"),x=(0,t.registerClientReference)(function(){throw Error("Attempted to call useSuggestions() from the server but useSuggestions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useSuggestions"),S=(0,t.registerClientReference)(function(){throw Error("Attempted to call useVirtualMessages() from the server but useVirtualMessages is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx <module evaluation>","useVirtualMessages");e.s(["StratosChatProvider",0,s,"createStratosChatStore",0,r,"useAgentHandoff",0,o,"useAgentStatus",0,n,"useArtifacts",0,a,"useChatActions",0,i,"useChatError",0,c,"useChatId",0,l,"useChatMessages",0,u,"useChatReset",0,p,"useChatStatus",0,d,"useChatStore",0,h,"useDataPart",0,m,"useDataParts",0,f,"useIsStreaming",0,g,"useLastAssistantMessage",0,b,"useMessageById",0,C,"useMessageCount",0,y,"useMessageCountByRole",0,v,"useMessageIds",0,w,"useRateLimit",0,R,"useSelector",0,A,"useSuggestions",0,x,"useVirtualMessages",0,S])},951992,e=>{"use strict";var t=e.i(479404);let s=(0,t.registerClientReference)(function(){throw Error("Attempted to call StratosChatProvider() from the server but StratosChatProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","StratosChatProvider"),r=(0,t.registerClientReference)(function(){throw Error("Attempted to call createStratosChatStore() from the server but createStratosChatStore is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","createStratosChatStore"),o=(0,t.registerClientReference)(function(){throw Error("Attempted to call useAgentHandoff() from the server but useAgentHandoff is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useAgentHandoff"),n=(0,t.registerClientReference)(function(){throw Error("Attempted to call useAgentStatus() from the server but useAgentStatus is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useAgentStatus"),a=(0,t.registerClientReference)(function(){throw Error("Attempted to call useArtifacts() from the server but useArtifacts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useArtifacts"),i=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatActions() from the server but useChatActions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatActions"),c=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatError() from the server but useChatError is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatError"),l=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatId() from the server but useChatId is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatId"),u=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatMessages() from the server but useChatMessages is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatMessages"),p=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatReset() from the server but useChatReset is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatReset"),d=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatStatus() from the server but useChatStatus is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatStatus"),h=(0,t.registerClientReference)(function(){throw Error("Attempted to call useChatStore() from the server but useChatStore is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useChatStore"),m=(0,t.registerClientReference)(function(){throw Error("Attempted to call useDataPart() from the server but useDataPart is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useDataPart"),f=(0,t.registerClientReference)(function(){throw Error("Attempted to call useDataParts() from the server but useDataParts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useDataParts"),g=(0,t.registerClientReference)(function(){throw Error("Attempted to call useIsStreaming() from the server but useIsStreaming is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useIsStreaming"),b=(0,t.registerClientReference)(function(){throw Error("Attempted to call useLastAssistantMessage() from the server but useLastAssistantMessage is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useLastAssistantMessage"),C=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageById() from the server but useMessageById is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useMessageById"),y=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageCount() from the server but useMessageCount is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useMessageCount"),v=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageCountByRole() from the server but useMessageCountByRole is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useMessageCountByRole"),w=(0,t.registerClientReference)(function(){throw Error("Attempted to call useMessageIds() from the server but useMessageIds is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useMessageIds"),R=(0,t.registerClientReference)(function(){throw Error("Attempted to call useRateLimit() from the server but useRateLimit is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useRateLimit"),A=(0,t.registerClientReference)(function(){throw Error("Attempted to call useSelector() from the server but useSelector is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useSelector"),x=(0,t.registerClientReference)(function(){throw Error("Attempted to call useSuggestions() from the server but useSuggestions is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useSuggestions"),S=(0,t.registerClientReference)(function(){throw Error("Attempted to call useVirtualMessages() from the server but useVirtualMessages is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/lib/ai/store.tsx","useVirtualMessages");e.s(["StratosChatProvider",0,s,"createStratosChatStore",0,r,"useAgentHandoff",0,o,"useAgentStatus",0,n,"useArtifacts",0,a,"useChatActions",0,i,"useChatError",0,c,"useChatId",0,l,"useChatMessages",0,u,"useChatReset",0,p,"useChatStatus",0,d,"useChatStore",0,h,"useDataPart",0,m,"useDataParts",0,f,"useIsStreaming",0,g,"useLastAssistantMessage",0,b,"useMessageById",0,C,"useMessageCount",0,y,"useMessageCountByRole",0,v,"useMessageIds",0,w,"useRateLimit",0,R,"useSelector",0,A,"useSuggestions",0,x,"useVirtualMessages",0,S])},549214,e=>{"use strict";e.i(780328);var t=e.i(951992);e.n(t)},208885,e=>{"use strict";let t,s,r,o;var n,a,i,c=e.i(755535),l=e.i(377233),u=e.i(490003),p=e.i(492991),d=e.i(241970),h=e.i(357699),m=e.i(212454),f=e.i(48717),g=e.i(798301),b=e.i(986366),C=e.i(983537),y=e.i(147475),v=e.i(561930),w=e.i(803747),R=e.i(368557),A=e.i(42037),x=e.i(193695);e.i(432036);var S=e.i(573881),z=e.i(928624),E=e.i(679774),I=e.i(443608);e.i(536804),e.i(254799),e.i(273568);var k=e.i(893214);e.i(247731),e.i(477902);var $=e.i(611981),M=Object.defineProperty,j=Object.getOwnPropertyNames,D={},T={createExecutionContext:()=>O,getContext:()=>N};for(var P in T)M(D,P,{get:T[P],enumerable:!0});function O(e){return{...e.context,writer:e.writer,metadata:{startTime:new Date,...e.metadata}}}function N(e){return e?.experimental_context}var L=(t={"src/context.ts"(){}},function(){return t&&(s=(0,t[j(t)[0]])(t=0)),s}),_="true"===process.env.DEBUG_AGENTS,H="\x1b[0m",B="\x1b[90m",U="\x1b[36m",q=()=>new Date().toISOString().slice(11,23);function K(e){return _?{debug:(t,s)=>{let r=`${B}[${q()}]${H}`,o=`\x1b[34mDEBUG${H}`,n=`${U}[${e}]${H}`,a=s?` ${B}${JSON.stringify(s)}${H}`:"";console.log(`${r} ${o} ${n} ${t}${a}`)},info:(t,s)=>{let r=`${B}[${q()}]${H}`,o=`\x1b[32mINFO${H}`,n=`${U}[${e}]${H}`,a=s?` ${B}${JSON.stringify(s)}${H}`:"";console.log(`${r} ${o} ${n} ${t}${a}`)},warn:(t,s)=>{let r=`${B}[${q()}]${H}`,o=`\x1b[33mWARN${H}`,n=`${U}[${e}]${H}`,a=s?` ${B}${JSON.stringify(s)}${H}`:"";console.warn(`${r} ${o} ${n} ${t}${a}`)},error:(t,s)=>{let r=`${B}[${q()}]${H}`,o=`\x1b[31mERROR${H}`,n=`${U}[${e}]${H}`,a=s?` ${B}${JSON.stringify(s)}${H}`:"";console.error(`${r} ${o} ${n} ${t}${a}`)}}:{debug:()=>{},info:()=>{},warn:()=>{},error:()=>{}}}L(),K("TOOL_EXTRACTOR"),K("AGENT"),L(),K("ROUTING"),(0,$.createGroq)()("llama-3.3-70b-versatile");var F=class{constructor(e,t,s){this.config=e,this.instance=t,this.writer=s,this.stream()}get data(){return this.instance.payload}get id(){return this.instance.id}get progress(){return this.instance.progress}set progress(e){this.instance.progress=e,this.instance.updatedAt=Date.now(),this.stream()}async update(e){"progress"in e&&(this.instance.progress=e.progress,delete e.progress),this.instance.payload={...this.instance.payload,...e},this.instance.status="streaming",this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}async complete(e){e&&(this.instance.payload=e),this.instance.status="complete",this.instance.progress=1,this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}async error(e){this.instance.status="error",this.instance.error=e,this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}async cancel(){this.instance.status="error",this.instance.error="Artifact was cancelled",this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}timeout(e){setTimeout(()=>{("loading"===this.instance.status||"streaming"===this.instance.status)&&this.error(`Artifact timed out after ${e}ms`)},e)}stream(){this.writer.write({type:`data-artifact-${this.config.id}`,id:this.instance.id,data:this.instance})}};function V(e,t){let s={id:e,schema:t};return{id:e,schema:t,create(s={}){let r=function(e){try{return e.parse({})}catch{return{}}}(t),o=t.parse({...r,...s});return{id:`artifact_${Date.now()}_${(0,E.generateId)()}`,type:e,status:"idle",payload:o,version:1,createdAt:Date.now(),updatedAt:Date.now()}},stream(e,t){let r=this.create(e);return r.status="loading",new F(s,r,t)},validate:e=>t.parse(e),isValid(e){try{return t.parse(e),!0}catch{return!1}}}}let G=I.z.object({id:I.z.string(),name:I.z.string(),email:I.z.string().optional(),phone:I.z.string().optional(),address:I.z.string().optional(),totalJobs:I.z.number().default(0),totalRevenue:I.z.number().default(0),lastServiceDate:I.z.string().optional(),status:I.z.enum(["active","inactive","lead"]).default("active")}),J=I.z.object({id:I.z.string(),title:I.z.string(),status:I.z.enum(["scheduled","in_progress","completed","cancelled","on_hold"]),customerId:I.z.string(),customerName:I.z.string(),scheduledDate:I.z.string().optional(),scheduledTime:I.z.string().optional(),assignedTechnician:I.z.string().optional(),estimatedDuration:I.z.number().optional(),address:I.z.string().optional()}),W=I.z.object({id:I.z.string(),invoiceNumber:I.z.string(),customerId:I.z.string(),customerName:I.z.string(),status:I.z.enum(["draft","sent","viewed","paid","overdue","cancelled"]),subtotal:I.z.number(),tax:I.z.number(),total:I.z.number(),dueDate:I.z.string().optional(),lineItems:I.z.array(I.z.object({description:I.z.string(),quantity:I.z.number(),unitPrice:I.z.number(),total:I.z.number()}))}),X=I.z.object({date:I.z.string(),jobs:I.z.array(I.z.object({id:I.z.string(),title:I.z.string(),time:I.z.string(),duration:I.z.number(),technician:I.z.string(),customer:I.z.string(),address:I.z.string().optional(),status:I.z.enum(["scheduled","in_progress","completed"])})),availableSlots:I.z.array(I.z.object({time:I.z.string(),duration:I.z.number(),technicians:I.z.array(I.z.string())}))}),Z=I.z.object({title:I.z.string(),type:I.z.enum(["bar","line","pie","area"]),data:I.z.array(I.z.object({label:I.z.string(),value:I.z.number(),color:I.z.string().optional()})),xAxisLabel:I.z.string().optional(),yAxisLabel:I.z.string().optional()}),Q=I.z.object({title:I.z.string(),columns:I.z.array(I.z.object({key:I.z.string(),label:I.z.string(),type:I.z.enum(["string","number","date","currency","badge"]).default("string")})),rows:I.z.array(I.z.record(I.z.unknown())),totalRows:I.z.number().optional()}),Y=I.z.object({id:I.z.string(),estimateNumber:I.z.string(),customerId:I.z.string(),customerName:I.z.string(),status:I.z.enum(["draft","sent","accepted","declined","expired"]),subtotal:I.z.number(),tax:I.z.number(),total:I.z.number(),validUntil:I.z.string().optional(),lineItems:I.z.array(I.z.object({description:I.z.string(),quantity:I.z.number(),unitPrice:I.z.number(),total:I.z.number()}))});V({id:"customer-card",displayName:"Customer Card",description:"Display a customer profile card with key information",schema:G}),V({id:"job-summary",displayName:"Job Summary",description:"Display a job summary card",schema:J}),V({id:"invoice",displayName:"Invoice",description:"Display an invoice with line items",schema:W}),V({id:"schedule-view",displayName:"Schedule View",description:"Display a day's schedule with jobs and availability",schema:X}),V({id:"chart",displayName:"Chart",description:"Display a data visualization chart",schema:Z}),V({id:"table",displayName:"Data Table",description:"Display tabular data with columns and rows",schema:Q}),V({id:"estimate",displayName:"Estimate",description:"Display an estimate/quote with line items",schema:Y});var ee=Object.defineProperty,et=Object.getOwnPropertyNames,es={},er={ArtifactError:()=>i,StreamingArtifact:()=>a,artifact:()=>en,getWriter:()=>ea};for(var eo in er)ee(es,eo,{get:er[eo],enumerable:!0});function en(e,t){let s={id:e,schema:t};return{id:e,schema:t,create(s={}){let r=function(e){try{return e.parse({})}catch{return{}}}(t),o=t.parse({...r,...s});return{id:`artifact_${Date.now()}_${(0,E.generateId)()}`,type:e,status:"idle",payload:o,version:1,createdAt:Date.now(),updatedAt:Date.now()}},stream(e,t){let r=this.create(e);return r.status="loading",new a(s,r,t)},validate:e=>t.parse(e),isValid(e){try{return t.parse(e),!0}catch{return!1}}}}function ea(e){let t=e?.experimental_context?.writer;if(!t)throw Error("Writer not available. Make sure you're passing executionOptions: getWriter(executionOptions)");return t}var ei=(r={"../artifacts/dist/index.mjs"(){a=class{constructor(e,t,s){this.config=e,this.instance=t,this.writer=s,this.stream()}get data(){return this.instance.payload}get id(){return this.instance.id}get progress(){return this.instance.progress}set progress(e){this.instance.progress=e,this.instance.updatedAt=Date.now(),this.stream()}async update(e){"progress"in e&&(this.instance.progress=e.progress,delete e.progress),this.instance.payload={...this.instance.payload,...e},this.instance.status="streaming",this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}async complete(e){e&&(this.instance.payload=e),this.instance.status="complete",this.instance.progress=1,this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}async error(e){this.instance.status="error",this.instance.error=e,this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}async cancel(){this.instance.status="error",this.instance.error="Artifact was cancelled",this.instance.version++,this.instance.updatedAt=Date.now(),this.stream()}timeout(e){setTimeout(()=>{("loading"===this.instance.status||"streaming"===this.instance.status)&&this.error(`Artifact timed out after ${e}ms`)},e)}stream(){this.writer.write({type:`data-artifact-${this.config.id}`,id:this.instance.id,data:this.instance})}},i=class extends Error{constructor(e,t){super(t),this.code=e,this.name="ArtifactError"}}}},function(){return r&&(o=(0,r[et(r)[0]])(r=0)),o}),ec=class{constructor(e=1e3){this.cache=new Map,this.maxSize=e}get(e){let t=this.cache.get(e);return t&&(this.cache.delete(e),this.cache.set(e,t)),t}set(e,t){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxSize){let e=this.cache.keys().next().value;e&&this.cache.delete(e)}this.cache.set(e,t)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}has(e){return this.cache.has(e)}size(){return this.cache.size}keys(){return Array.from(this.cache.keys())}getDefaultTTL(){}},el=class{constructor(e=1e3){this.cache=new Map,this.maxSize=e}get(e){return this.cache.get(e)}set(e,t){this.cache.size>=this.maxSize&&this.cache.clear(),this.cache.set(e,t)}delete(e){return this.cache.delete(e)}clear(){this.cache.clear()}has(e){return this.cache.has(e)}size(){return this.cache.size}keys(){return Array.from(this.cache.keys())}getDefaultTTL(){}},eu=class{constructor(e=1e3){this.cache=new Map,this.accessOrder=new Map,this.accessCounter=0,this.maxSize=e}get(e){let t=this.cache.get(e);return t&&this.accessOrder.set(e,++this.accessCounter),t}set(e,t){if(this.cache.has(e)){this.cache.set(e,t),this.accessOrder.set(e,++this.accessCounter);return}this.cache.size>=this.maxSize&&this.evictLRU(),this.cache.set(e,t),this.accessOrder.set(e,++this.accessCounter)}delete(e){let t=this.cache.delete(e);return t&&this.accessOrder.delete(e),t}clear(){this.cache.clear(),this.accessOrder.clear(),this.accessCounter=0}has(e){return this.cache.has(e)}size(){return this.cache.size}keys(){return Array.from(this.cache.keys())}getDefaultTTL(){}evictLRU(){let e,t=1/0;for(let[s,r]of this.accessOrder)r<t&&(t=r,e=s);e&&(this.cache.delete(e),this.accessOrder.delete(e))}getStats(){return{size:this.cache.size,maxSize:this.maxSize,utilization:this.cache.size/this.maxSize}}cleanup(e){let t=Date.now(),s=0;for(let[r,o]of this.cache)t-o.timestamp>e&&(this.cache.delete(r),this.accessOrder.delete(r),s++);return s}},ep=class{constructor(e,t="ai-tools-cache:"){this.redis=e,this.keyPrefix=t}getKey(e){return`${this.keyPrefix}${e}`}async get(e){try{let t,s=await this.redis.get(this.getKey(e));if(!s)return;if("string"==typeof s)t=s;else{if("object"==typeof s)return{result:s.result,timestamp:s.timestamp,key:s.key};t=String(s)}let r=JSON.parse(t);return{result:r.result,timestamp:r.timestamp,key:r.key}}catch(t){console.warn(`Redis cache get error for key ${e}:`,t);return}}async set(e,t){try{let s=JSON.stringify({result:t.result,timestamp:t.timestamp,key:t.key});await this.redis.set(this.getKey(e),s)}catch(t){console.warn(`Redis cache set error for key ${e}:`,t)}}async setWithTTL(e,t,s){try{let r=JSON.stringify({result:t.result,timestamp:t.timestamp,key:t.key});await this.redis.setex(this.getKey(e),s,r)}catch(t){console.warn(`Redis cache setex error for key ${e}:`,t)}}async delete(e){try{return await this.redis.del(this.getKey(e))>0}catch(t){return console.warn(`Redis cache delete error for key ${e}:`,t),!1}}async clear(){try{let e=await this.redis.keys(`${this.keyPrefix}*`);e.length>0&&await this.redis.del(...e)}catch(e){console.warn("Redis cache clear error:",e)}}async has(e){try{return await this.redis.exists(this.getKey(e))>0}catch(t){return console.warn(`Redis cache exists error for key ${e}:`,t),!1}}async size(){try{return(await this.redis.keys(`${this.keyPrefix}*`)).length}catch(e){return console.warn("Redis cache size error:",e),0}}async keys(){try{return(await this.redis.keys(`${this.keyPrefix}*`)).map(e=>e.replace(this.keyPrefix,""))}catch(e){return console.warn("Redis cache keys error:",e),[]}}getDefaultTTL(){}};function ed(e){let t;switch(e.type){case"memory":t=new eu(e.maxSize);break;case"lru":t=new ec(e.maxSize);break;case"simple":t=new el(e.maxSize);break;case"redis":if(!e.redis?.client)throw Error("Redis client is required for redis cache backend");t=new ep(e.redis.client,e.redis.keyPrefix);break;default:throw Error(`Unknown cache backend type: ${e.type}`)}return e.defaultTTL&&(t.getDefaultTTL=()=>e.defaultTTL),t}function eh(e,t){let s=function e(t){if(null==t)return"null";if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return String(t);if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return`[${t.map(e).join(",")}]`;if("object"==typeof t){let s=Object.keys(t).sort().map(s=>`${s}:${e(t[s])}`);return`{${s.join(",")}}`}return String(t)}(e);return t?`${s}|${t}`:s}function em(e,t={}){return(s,r={})=>(function(e,t){if(e.execute?.constructor?.name==="AsyncGeneratorFunction")return function(e,t){let{ttl:s=3e5,maxSize:r=1e3,store:o,keyGenerator:n=eh,cacheKey:a,shouldCache:i=()=>!0,onHit:c,onMiss:l,debug:u=!1}=t,p=o||new ec(r),d=0,h=0;return{...e,execute:async function*(...t){let o,[m,f]=t,g=n(m,a?.()),b=Date.now(),C=await p.get(g);if(C&&b-C.timestamp<s){d++,c?.(g);let e=C.result;if(u){let t=e?.streamResults?.length||0,s=e?.messages?.length||0,r=e?.returnValue!==void 0;console.log(`
\u{1F3AF} Cache HIT - Streaming Tool`),console.log(`\u250C\u2500 Key: ${g.slice(0,60)}${g.length>60?"...":""}`),console.log(`\u251C\u2500 Streaming yields: ${t}`),console.log(`\u251C\u2500 Artifact messages: ${s}`),console.log(`\u251C\u2500 Return value: ${r?"yes":"no"}`),console.log(`\u2514\u2500 Restoring cached results...
`)}if(e?.messages?.length>0){let t=f?.writer||f?.experimental_context?.writer;if(!t)try{let{getWriter:e}=await Promise.resolve().then(()=>(ei(),es));t=e(f)}catch{}if(t){for(let s of(u&&console.log(`   Replaying ${e.messages.length} artifact messages...`),e.messages))t.write(s);u&&console.log("   Artifacts restored")}}if(e?.streamResults){for(let t of(u&&console.log(`   Replaying ${e.streamResults.length} streaming yields...`),e.streamResults))yield t;u&&console.log("   Streaming content restored")}return e.returnValue}h++,l?.(g),u&&(console.log(`
\u{1F504} Cache MISS - Streaming Tool`),console.log(`\u250C\u2500 Key: ${g.slice(0,60)}${g.length>60?"...":""}`),console.log(`\u251C\u2500 Will capture: streaming yields + artifact messages + return value`),console.log(`\u2514\u2500 Executing tool and capturing results...
`));let y=f?.writer||f?.experimental_context?.writer;if(!y)try{let{getWriter:e}=await Promise.resolve().then(()=>(ei(),es));y=e(f)}catch{}let v=[];if(y){let e=y.write;y.write=t=>(v.push(t),e.call(y,t))}let w=await e.execute?.(m,f),R=null,A=0;if(w&&"function"==typeof w[Symbol.asyncIterator]){let e=w[Symbol.asyncIterator](),t=await e.next();for(;!t.done;)R=t.value,A++,u&&A<=3&&console.log(`   Capturing yield #${A}:`,`${R?.text?.slice(0,40)}...`),yield t.value,t=await e.next();o=t.value}return queueMicrotask(()=>{queueMicrotask(async()=>{try{let e={streamResults:R?[R]:[],messages:v,returnValue:o,type:"streaming"};if(i(m,e)&&(await p.set(g,{result:e,timestamp:b,key:g}),u)){let t="function"==typeof p.size?await p.size():"unknown",s=JSON.stringify(e).length,n=Math.round(s/1024*100)/100;console.log(`
\u{1F4BE} Cache STORED - Streaming Tool`),console.log(`\u250C\u2500 Streaming yields: ${A}`),console.log(`\u251C\u2500 Artifact messages: ${v.length}`),console.log(`\u251C\u2500 Return value: ${void 0!==o?"yes":"no"}`),console.log(`\u251C\u2500 Entry size: ~${n}KB`),console.log(`\u251C\u2500 Cache items: ${t}/${r}`),console.log(`\u2514\u2500 Ready for instant replay!
`)}}catch(e){u&&console.log("[Cache] Microtask caching failed:",e)}})}),o},getStats(){let e=d+h;return{hits:d,misses:h,hitRate:e>0?d/e:0,size:"function"==typeof p.size?p.size():0,maxSize:r}},clearCache(e){e?p.delete(e):p.clear()},async isCached(e){let t=n(e,a?.()),r=await p.get(t);return!!r&&(Date.now()-r.timestamp<s||(await p.delete(t),!1))},getCacheKey:e=>n(e,a?.())}}(e,t||{});let{ttl:s=3e5,maxSize:r=1e3,store:o,keyGenerator:n=eh,cacheKey:a,shouldCache:i=()=>!0,onHit:c,onMiss:l,debug:u=!1}=t||{},p=o||new ec(r),d=s??p.getDefaultTTL?.()??3e5,h=0,m=0,f=u?console.log:()=>{},g={getStats(){let e=h+m;return{hits:h,misses:m,hitRate:e>0?h/e:0,size:"function"==typeof p.size?p.size():0,maxSize:r}},clearCache(e){e?p.delete(e):p.clear()},async isCached(e){let t=n(e,a?.()),s=await p.get(t);return!!s&&(Date.now()-s.timestamp<d||(await p.delete(t),!1))},getCacheKey:e=>n(e,a?.())};return new Proxy(e,{get(e,t){if("execute"===t)if(e.execute?.constructor?.name==="AsyncGeneratorFunction")return async function*(...t){let[s,r]=t,o=n(s,a?.()),u=Date.now(),g=await p.get(o);if(g&&u-g.timestamp<d){h++,c?.(o),f("[Cache] HIT");let t=g.result;if(e.execute?.constructor?.name==="AsyncGeneratorFunction"){if(t?.messages?.length>0){let e=r?.writer||r?.experimental_context?.writer;if(e)for(let s of(f(`[Cache] Replaying ${t.messages.length} messages`),t.messages))e.write(s)}return async function*(){if(t?.streamResults)for(let e of t.streamResults)yield e;else if(Array.isArray(t))for(let e of t)yield e;else yield t}()}return t}m++,l?.(o),f("[Cache] MISS");let b=r?.writer||r?.experimental_context?.writer,C=[];if(b){let e=b.write;b.write=t=>(C.push(t),e.call(b,t))}let y=await e.execute?.(s,r);if(y&&"function"==typeof y[Symbol.asyncIterator]){let e=null;return async function*(){for await(let t of y)e=t,yield t;queueMicrotask(async()=>{let t={streamResults:e?[e]:[],messages:C,type:"streaming"};i(s,t)&&(await p.set(o,{result:t,timestamp:u,key:o}),f(`[Cache] STORED streaming result with ${C.length} messages`))})}()}return i(s,y)&&(await p.set(o,{result:y,timestamp:u,key:o}),f("[Cache] STORED result")),y};else return async(...t)=>{let[s,r]=t,o=n(s,a?.()),u=Date.now(),g=await p.get(o);if(g&&u-g.timestamp<d)return h++,c?.(o),f("[Cache] HIT"),g.result;m++,l?.(o),f("[Cache] MISS");let b=await e.execute?.(s,r);return i(s,b)&&(await p.set(o,{result:b,timestamp:u,key:o}),f("[Cache] STORED result")),b};return t in g?g[t]:e[t]}})})(s,{...t,...r,store:e})}let ef={ttl:3e5,maxSize:1e3,debug:!1};n={keyPrefix:"stratos:ai:",ttl:ef.ttl,debug:ef.debug,onHit:e=>{},onMiss:e=>{}},function(e={}){e.cache?em(ed({type:"redis",defaultTTL:e.ttl||18e5,redis:{client:e.cache,keyPrefix:e.keyPrefix||"ai-tools-cache:"}}),{debug:e.debug||!1,cacheKey:e.cacheKey,onHit:e.onHit,onMiss:e.onMiss}):em(ed({type:"lru",maxSize:100,defaultTTL:e.ttl||6e5}),{debug:e.debug||!1,cacheKey:e.cacheKey,onHit:e.onHit,onMiss:e.onMiss})}({...ef,...n}),e.i(549214),e.i(28881);let eg=(0,E.tool)({description:"Get the current weather for a location",inputSchema:I.z.object({location:I.z.string().describe("The city and state, e.g. San Francisco, CA")}),execute:async({location:e})=>({location:e,temperature:72,conditions:"Sunny",humidity:45})}),eb=(0,E.tool)({description:"Create a new document (code, text, or other artifact)",inputSchema:I.z.object({title:I.z.string().describe("The title of the document"),content:I.z.string().describe("The content of the document"),kind:I.z.enum(["text","code","image","sheet"]).describe("The type of document")}),execute:async({title:e,content:t,kind:s})=>({id:`doc-${Date.now()}`,title:e,content:t,kind:s,createdAt:new Date().toISOString()})});async function eC(e){try{let{messages:t,model:s="llama-3.3-70b-versatile"}=await e.json(),r=(0,k.createAIProvider)({provider:"groq",model:s}),o=(0,z.convertToModelMessages)(t);return(await (0,z.streamText)({model:r,messages:o,tools:{getWeather:eg,createDocument:eb},temperature:.7})).toUIMessageStreamResponse()}catch(e){return new Response(JSON.stringify({error:e instanceof Error?e.message:"An error occurred"}),{status:500,headers:{"Content-Type":"application/json"}})}}e.s(["POST",()=>eC,"maxDuration",0,30],251407);var ey=e.i(251407);let ev=new c.AppRouteRouteModule({definition:{kind:l.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/chat/route.ts",nextConfigOutput:"",userland:ey}),{workAsyncStorage:ew,workUnitAsyncStorage:eR,serverHooks:eA}=ev;function ex(){return(0,u.patchFetch)({workAsyncStorage:ew,workUnitAsyncStorage:eR})}async function eS(e,t,s){ev.isDev&&(0,p.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let r="/api/chat/route";r=r.replace(/\/index$/,"")||"/";let o=await ev.prepare(e,t,{srcPage:r,multiZoneDraftMode:!1});if(!o)return t.statusCode=400,t.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve()),null;let{buildId:n,params:a,nextConfig:i,parsedUrl:c,isDraftMode:u,prerenderManifest:z,routerServerContext:E,isOnDemandRevalidate:I,revalidateOnlyGenerated:k,resolvedPathname:$,clientReferenceManifest:M,serverActionsManifest:j}=o,D=(0,f.normalizeAppPath)(r),T=!!(z.dynamicRoutes[D]||z.routes[$]),P=async()=>((null==E?void 0:E.render404)?await E.render404(e,t,c,!1):t.end("This page could not be found"),null);if(T&&!u){let e=!!z.routes[$],t=z.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(i.experimental.adapterPath)return await P();throw new x.NoFallbackError}}let O=null;!T||ev.isDev||u||(O="/index"===(O=$)?"/":O);let N=!0===ev.isDev||!T,L=T&&!N;j&&M&&(0,h.setReferenceManifestsSingleton)({page:r,clientReferenceManifest:M,serverActionsManifest:j,serverModuleMap:(0,m.createServerModuleMap)({serverActionsManifest:j})});let _=e.method||"GET",H=(0,d.getTracer)(),B=H.getActiveScopeSpan(),U={params:a,prerenderManifest:z,renderOpts:{experimental:{authInterrupts:!!i.experimental.authInterrupts},cacheComponents:!!i.cacheComponents,supportsDynamicResponse:N,incrementalCache:(0,p.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:i.cacheLife,waitUntil:s.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,s,r)=>ev.onRequestError(e,t,r,E)},sharedContext:{buildId:n}},q=new g.NodeNextRequest(e),K=new g.NodeNextResponse(t),F=b.NextRequestAdapter.fromNodeNextRequest(q,(0,b.signalFromNodeResponse)(t));try{let o=async e=>ev.handle(F,U).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let s=H.getRootSpanAttributes();if(!s)return;if(s.get("next.span_type")!==C.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${s.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=s.get("next.route");if(o){let t=`${_} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${_} ${r}`)}),n=!!(0,p.getRequestMeta)(e,"minimalMode"),a=async a=>{var c,p;let d=async({previousCacheEntry:i})=>{try{if(!n&&I&&k&&!i)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await o(a);e.fetchMetrics=U.renderOpts.fetchMetrics;let c=U.renderOpts.pendingWaitUntil;c&&s.waitUntil&&(s.waitUntil(c),c=void 0);let l=U.renderOpts.collectedTags;if(!T)return await (0,v.sendResponse)(q,K,r,U.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,w.toNodeOutgoingHttpHeaders)(r.headers);l&&(t[A.NEXT_CACHE_TAGS_HEADER]=l),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let s=void 0!==U.renderOpts.collectedRevalidate&&!(U.renderOpts.collectedRevalidate>=A.INFINITE_CACHE)&&U.renderOpts.collectedRevalidate,o=void 0===U.renderOpts.collectedExpire||U.renderOpts.collectedExpire>=A.INFINITE_CACHE?void 0:U.renderOpts.collectedExpire;return{value:{kind:S.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:s,expire:o}}}}catch(t){throw(null==i?void 0:i.isStale)&&await ev.onRequestError(e,t,{routerKind:"App Router",routePath:r,routeType:"route",revalidateReason:(0,y.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:I})},E),t}},h=await ev.handleResponse({req:e,nextConfig:i,cacheKey:O,routeKind:l.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:I,revalidateOnlyGenerated:k,responseGenerator:d,waitUntil:s.waitUntil,isMinimalMode:n});if(!T)return null;if((null==h||null==(c=h.value)?void 0:c.kind)!==S.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==h||null==(p=h.value)?void 0:p.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});n||t.setHeader("x-nextjs-cache",I?"REVALIDATED":h.isMiss?"MISS":h.isStale?"STALE":"HIT"),u&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,w.fromNodeOutgoingHttpHeaders)(h.value.headers);return n&&T||m.delete(A.NEXT_CACHE_TAGS_HEADER),!h.cacheControl||t.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,R.getCacheControlHeader)(h.cacheControl)),await (0,v.sendResponse)(q,K,new Response(h.value.body,{headers:m,status:h.value.status||200})),null};B?await a(B):await H.withPropagatedContext(e.headers,()=>H.trace(C.BaseServerSpan.handleRequest,{spanName:`${_} ${r}`,kind:d.SpanKind.SERVER,attributes:{"http.method":_,"http.target":e.url}},a))}catch(t){if(t instanceof x.NoFallbackError||await ev.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,y.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:I})}),T)throw t;return await (0,v.sendResponse)(q,K,new Response(null,{status:500})),null}}e.s(["handler",()=>eS,"patchFetch",()=>ex,"routeModule",()=>ev,"serverHooks",()=>eA,"workAsyncStorage",()=>ew,"workUnitAsyncStorage",()=>eR],208885)}];

//# sourceMappingURL=_1cc71ace._.js.map