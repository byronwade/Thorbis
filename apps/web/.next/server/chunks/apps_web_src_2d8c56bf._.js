module.exports=[291546,e=>{"use strict";var t=e.i(471312),s=e.i(717899),n=e.i(511368),r=e.i(893099),i=e.i(798348);let a=process.env.TELNYX_DEFAULT_MESSAGING_PROFILE_ID||process.env.NEXT_PUBLIC_TELNYX_MESSAGING_PROFILE_ID||"",o=/\s+/;function l(e){if(!e)return null;let t=e.replace(/\D/g,"");return t?11===t.length&&t.startsWith("1")?`+${t}`:10===t.length?`+1${t}`:e.startsWith("+")?e:`+${t}`:null}async function u(e,t){let{data:s}=await e.from("messaging_brands").select("id").eq("company_id",t.company_id).maybeSingle();s?await e.from("messaging_brands").update({...t,updated_at:new Date().toISOString()}).eq("id",s.id):await e.from("messaging_brands").insert(t)}async function c(e,t){let{data:s}=await e.from("messaging_campaigns").select("id").eq("messaging_brand_id",t.messaging_brand_id).eq("usecase",t.usecase).maybeSingle();if(s)return await e.from("messaging_campaigns").update({...t,updated_at:new Date().toISOString()}).eq("id",s.id),s.id;let{data:n}=await e.from("messaging_campaigns").insert(t).select("id").single();return n?.id??null}async function d(e,t){let i=t?.supabase??await (0,n.createClient)();if(!i)return{success:!1,error:"Supabase unavailable"};let{data:a,error:c}=await i.from("companies").select("id, name, legal_name, doing_business_as, phone, support_email, support_phone, website, website_url, brand_color, industry, address, city, state, zip_code, owner_id, ein, tax_id").eq("id",e).single();if(c||!a)return{success:!1,error:c?.message||"Company not found"};let{data:d}=await i.from("profiles").select("full_name, email, phone").eq("id",a.owner_id).maybeSingle(),m=function(e){if(!e)return{first:"Support",last:"Team"};let t=e.trim().split(o);return 1===t.length?{first:t[0],last:"Team"}:{first:t[0],last:t.slice(1).join(" ")}}(d?.full_name),p=d?.email||a.support_email||"support@example.com",g=l(d?.phone)||l(a.support_phone)||l(a.phone)||"+18314280176",{data:f}=await i.from("messaging_brands").select("*").eq("company_id",e).maybeSingle();if(f?.telnyx_brand_id){let e=await (0,r.getTenDlcBrand)(f.telnyx_brand_id);e.success&&e.data&&await i.from("messaging_brands").update({status:e.data.status,updated_at:new Date().toISOString()}).eq("id",f.id)}if(!f?.telnyx_brand_id){let t={customer_reference:e,brand_name:a.legal_name||a.name,ein:a.ein||a.tax_id||process.env.FALLBACK_TEST_EIN||"00-0000000",ein_issuing_country:"US",vertical:function(e){if(!e)return"PROFESSIONAL";let t=e.toLowerCase();return t.includes("plumb")||t.includes("hvac")||t.includes("electric")?"HOME_SERVICES":(t.includes("clean"),"PROFESSIONAL")}(a.industry),website:a.website||a.website_url||null,company_type:"PRIVATE_PROFIT",address:{line1:a.address||"115 Flintlock Lane",city:a.city||"Ben Lomond",state:a.state||"CA",postal_code:a.zip_code||"95005",country:"US"},contact:{first_name:m.first,last_name:m.last,email:p,phone:g},optional_attributes:{doing_business_as:a.doing_business_as||a.name}},s=await (0,r.createTenDlcBrand)(t);if(!(s.success&&s.data))return{success:!1,error:s.error||"Failed to create 10DLC brand"};await u(i,{company_id:e,telnyx_brand_id:s.data.id,status:"submitted",legal_name:t.brand_name,doing_business_as:a.doing_business_as||a.name,ein:t.ein,vertical:t.vertical,website:t.website,support_email:p,support_phone:g,address_line1:t.address.line1,city:t.address.city,state:t.address.state,postal_code:t.address.postal_code,brand_color:a.brand_color})}return(0,s.revalidatePath)("/dashboard/settings/communications/brand"),{success:!0}}async function m(e,t,i){let o=i?.supabase??await (0,n.createClient)();if(!o)return{success:!1,error:"Supabase unavailable"};let{data:l}=await o.from("messaging_brands").select("*").eq("company_id",e).maybeSingle();if(!l?.telnyx_brand_id){let s=await d(e,{supabase:o});return s.success?m(e,t):s}let u="CUSTOMER_CARE",{data:p}=await o.from("messaging_campaigns").select("*").eq("messaging_brand_id",l.id).eq("usecase",u).maybeSingle();if(p?.telnyx_campaign_id){let e=await (0,r.getTenDlcCampaign)(p.telnyx_campaign_id);e.success&&e.data&&await o.from("messaging_campaigns").update({status:e.data.status,updated_at:new Date().toISOString()}).eq("id",p.id)}let g=p?.id??null,f=p?.telnyx_campaign_id??null;if(!p?.telnyx_campaign_id){if(!a)return{success:!1,error:"TELNYX_DEFAULT_MESSAGING_PROFILE_ID not configured"};let t=`${l.doing_business_as||l.legal_name} provides appointment updates, reminders, and service notifications to existing customers.`,s=`Hi {{customer_name}}, this is ${l.doing_business_as||l.legal_name} confirming your upcoming appointment. Reply HELP for assistance or STOP to opt out.`,n={brand_id:l.telnyx_brand_id,campaign_alias:`${e}-customer-care`,usecase:u,description:t,sample_messages:[s],message_flow:"Customers opt in during onboarding or by texting our business line. They receive service updates and can opt out by replying STOP.",terms_and_conditions:"Msg & data rates may apply. Reply STOP to opt out, HELP for help.",help_message:`Thanks for contacting ${l.doing_business_as||l.legal_name}. Reply STOP to unsubscribe.`,help_phone_number:l.support_phone||"+18314280176",help_email:l.support_email||"support@example.com",auto_renewal:!0,message_fee_credits:0,opt_in_keywords:["START","YES"],opt_out_keywords:["STOP","UNSUBSCRIBE"],opt_in_message:"Thanks for opting in to receive messages from us. Reply STOP to opt out.",opt_out_message:"You have successfully been unsubscribed and will no longer receive messages. Reply START to opt in again."},i=await (0,r.createTenDlcCampaign)(n);if(!(i.success&&i.data))return{success:!1,error:i.error||"Failed to create 10DLC campaign"};g=await c(o,{messaging_brand_id:l.id,telnyx_campaign_id:i.data.id,status:"submitted",usecase:u,description:t,sample_messages:n.sample_messages,messaging_profile_id:a})||p?.id||null,f=i.data.id}if(!(g&&f))return{success:!1,error:"Campaign not ready"};let{data:h}=await o.from("messaging_campaign_phone_numbers").select("*").eq("messaging_campaign_id",g).eq("phone_number_id",t.id).maybeSingle();if(!h?.telnyx_relationship_id){let e=await (0,r.attachNumberToCampaign)(f,t.e164);if(!(e.success&&e.data))return{success:!1,error:e.error||"Failed to link number to campaign"};h?await o.from("messaging_campaign_phone_numbers").update({telnyx_relationship_id:e.data.id,status:"submitted"}).eq("id",h.id):await o.from("messaging_campaign_phone_numbers").insert({messaging_campaign_id:g,phone_number_id:t.id,telnyx_relationship_id:e.data.id,status:"submitted"})}return await o.from("phone_numbers").update({telnyx_messaging_profile_id:a,metadata:{ten_dlc_campaign_id:f}}).eq("id",t.id),(0,s.revalidatePath)("/dashboard/settings/communications/phone-numbers"),{success:!0}}(0,i.ensureServerEntryExports)([d,m]),(0,t.registerServerReference)(d,"606753f8910b46d5792f4bdeb457cdf29d1a8bbadc",null),(0,t.registerServerReference)(m,"70a648f43fa62ae3dcf2070eb90413e96e81591e77",null),e.s(["ensureMessagingBranding",()=>d,"ensureMessagingCampaign",()=>m])},155611,841937,267706,e=>{"use strict";var t=e.i(895811);function s(){let e=["http://localhost:3000",process.env.SITE_URL,"http://localhost:3000",process.env.APP_URL],t="production"!==process.env.VERCEL_ENV||"production"!==process.env.DEPLOYMENT_ENV;for(let s of e)if(s&&s.trim()){let e=s.trim();if((e.includes("localhost")||e.includes("127.0.0.1")||e.includes("0.0.0.0"))&&!t)continue;let n=e.startsWith("http")?e:`https://${e}`;return`${n.replace(/\/+$/,"")}/api/webhooks/telnyx`}}async function n(e){let n=e||t.TELNYX_CONFIG.messagingProfileId,r={exists:!1,isActive:!1,hasWebhookUrl:!1,webhookUrl:null,webhookFailoverUrl:null,webhookApiVersion:null,needsFix:!1,issues:[]};if(!n||""===n.trim())return r.issues.push("Messaging profile ID is not configured"),r.needsFix=!0,r;try{let e=(await t.telnyxClient.messagingProfiles.retrieve(n)).data;if(!e)return r.issues.push(`Messaging profile ${n} not found in Telnyx`),r.needsFix=!0,r;r.exists=!0,r.isActive=!1!==e.enabled,r.webhookUrl=e.webhook_url||null,r.webhookFailoverUrl=e.webhook_failover_url||null,r.webhookApiVersion=e.webhook_api_version||null;let i=s();if(i)if(r.webhookUrl){let e=r.webhookUrl.split("?")[0];e===i||r.webhookUrl===i?r.hasWebhookUrl=!0:(r.issues.push(`Webhook URL base is not set correctly. Expected: ${i}, Current: ${e}`),r.needsFix=!0)}else r.issues.push(`Webhook URL is not set. Expected: ${i} (with optional ?company=... for multi-tenant)`),r.needsFix=!0;else"production"!==process.env.VERCEL_ENV||"production"!==process.env.DEPLOYMENT_ENV?r.issues.push("NEXT_PUBLIC_SITE_URL is not set. Set it to your production URL (e.g., https://yourdomain.com) or use a tool like ngrok for local testing."):r.issues.push("NEXT_PUBLIC_SITE_URL is not set to a valid production URL. Set it to your production domain (e.g., https://yourdomain.com) in your environment variables."),r.needsFix=!0;return"2"!==r.webhookApiVersion&&(r.issues.push(`Webhook API version should be "2", but is "${r.webhookApiVersion||"not set"}"`),r.needsFix=!0),r.isActive||(r.issues.push("Messaging profile is not enabled"),r.needsFix=!0),r}catch(e){return e?.statusCode===404?r.issues.push(`Messaging profile ${n} not found in Telnyx`):r.issues.push(e?.message||"Failed to retrieve messaging profile"),r.needsFix=!0,r}}async function r(e,r){let i=e||t.TELNYX_CONFIG.messagingProfileId,a=[];if(!i||""===i.trim())return{success:!1,fixed:!1,error:"Messaging profile ID is not configured",changes:[]};try{let e=await n(i);if(!e.needsFix)return{success:!0,fixed:!1,changes:[]};let o=r?.webhookUrl||s();if(!o)return{success:!1,fixed:!1,error:"NEXT_PUBLIC_SITE_URL must be set to a valid production URL to configure webhooks",changes:[]};let l={};e.webhookUrl!==o&&(l.webhook_url=o,a.push(`Updated webhook URL to ${o}`));let u=r?.webhookFailoverUrl||process.env.TELNYX_WEBHOOK_FAILOVER_URL||null;return e.webhookFailoverUrl!==u&&(l.webhook_failover_url=u,u?a.push(`Updated webhook failover URL to ${u}`):a.push("Removed webhook failover URL")),"2"!==e.webhookApiVersion&&(l.webhook_api_version="2",a.push("Updated webhook API version to 2")),e.isActive||(l.enabled=!0,a.push("Enabled messaging profile")),Object.keys(l).length>0&&await t.telnyxClient.messagingProfiles.update(i,l),{success:!0,fixed:a.length>0,changes:a}}catch(e){return{success:!1,fixed:!1,error:e?.message||"Failed to update messaging profile",changes:a}}}async function i(e){try{let s=await t.telnyxClient.availablePhoneNumbers.list({filter:{country_code:e.countryCode||"US",national_destination_code:e.areaCode,features:e.features,limit:e.limit||10,starts_with:e.startsWith,ends_with:e.endsWith,contains:e.contains}});return{success:!0,data:s.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to search numbers"}}}async function a(e){try{let s=await t.telnyxClient.numberOrders.create({phone_numbers:[{phone_number:e.phoneNumber}],messaging_profile_id:e.messagingProfileId,connection_id:e.connectionId,billing_group_id:e.billingGroupId,customer_reference:e.customerReference});return{success:!0,orderId:s.data?.id,data:s.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to purchase number"}}}async function o(e){try{let s=await t.telnyxClient.phoneNumbers.list({page:{size:e?.pageSize||20,number:e?.pageNumber||1},filter:{tag:e?.filterTag,status:e?.filterStatus}});return{success:!0,data:s.data,meta:s.meta}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to list numbers"}}}async function l(e){try{let s=await t.telnyxClient.phoneNumbers.retrieve(e);return{success:!0,data:s.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to retrieve number"}}}async function u(e){try{let s=await t.telnyxClient.phoneNumbers.update(e.phoneNumberId,{connection_id:e.connectionId,messaging_profile_id:e.messagingProfileId,billing_group_id:e.billingGroupId,tags:e.tags,customer_reference:e.customerReference});return{success:!0,data:s.data}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to update number"}}}async function c(e){try{return await t.telnyxClient.phoneNumbers.del(e),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to release number"}}}async function d(e){try{let t=e.replace(/\D/g,""),s=t.startsWith("+")?e:t.startsWith("1")&&11===t.length?`+${t}`:`+1${t}`,n=await o({pageSize:100});if(!n.success||!n.data)return{success:!1,error:"Failed to list phone numbers from Telnyx"};let r=(Array.isArray(n.data)?n.data:[n.data]).find(n=>n.phone_number===s||n.phone_number===e||n.phone_number?.replace(/\D/g,"")===t);if(!r)return{success:!1,error:`Phone number ${e} not found in Telnyx account`};return{success:!0,phoneNumberId:r.id}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Failed to find phone number"}}}async function m(e){let t={exists:!1,hasMessagingProfile:!1,hasConnection:!1,capabilities:{sms:!1,voice:!1,mms:!1},needsFix:!1,issues:[]};try{let s=await d(e);if(!s.success||!s.phoneNumberId)return t.issues.push(s.error||"Phone number not found in Telnyx"),t.needsFix=!0,t;t.exists=!0;let n=await l(s.phoneNumberId);if(!n.success||!n.data)return t.issues.push("Failed to retrieve phone number details"),t.needsFix=!0,t;let r=n.data;r.messaging_profile_id?t.hasMessagingProfile=!0:(t.issues.push("Phone number is not associated with a messaging profile"),t.needsFix=!0),r.connection_id?t.hasConnection=!0:(t.issues.push("Phone number is not associated with a connection"),t.needsFix=!0);let i=r.features||[],a=i.includes("sms"),o=i.includes("voice"),u=i.includes("mms"),c=!1;try{let e=process.env.TELNYX_API_KEY;if(e){let t=await fetch(`https://api.telnyx.com/v2/phone_numbers/${s.phoneNumberId}/messaging`,{headers:{Authorization:`Bearer ${e}`}});if(t.ok){let e=await t.json(),s=e?.data?.features;(s?.sms?.domestic_two_way||s?.mms?.domestic_two_way)&&(c=!0)}}}catch{}return t.capabilities.sms=a||c,t.capabilities.voice=o,t.capabilities.mms=u||c,t.capabilities.sms||t.issues.push("Phone number does not have SMS capability"),t.capabilities.voice||t.issues.push("Phone number does not have voice capability"),t}catch(e){return t.issues.push(e instanceof Error?e.message:"Unknown error"),t.needsFix=!0,t}}async function p(e,s){let n=[];try{let r=await d(e);if(!r.success||!r.phoneNumberId)return{success:!1,fixed:!1,error:r.error||"Phone number not found",changes:[]};let i=await m(e);if(!i.needsFix)return{success:!0,fixed:!1,changes:[]};let a={phoneNumberId:r.phoneNumberId};if(!i.hasMessagingProfile){let e=s?.messagingProfileId||t.TELNYX_CONFIG.messagingProfileId;if(!e)return{success:!1,fixed:!1,error:"Messaging profile ID is required but not configured. Set TELNYX_DEFAULT_MESSAGING_PROFILE_ID.",changes:[]};a.messagingProfileId=e,n.push(`Assigned messaging profile ${e} to phone number`)}if(!i.hasConnection){let e=s?.connectionId||t.TELNYX_CONFIG.connectionId;if(!e)return{success:!1,fixed:!1,error:"Connection ID is required but not configured. Set NEXT_PUBLIC_TELNYX_CONNECTION_ID.",changes:[]};a.connectionId=e,n.push(`Assigned connection ${e} to phone number`)}if(a.messagingProfileId||a.connectionId){let e=await u(a);if(!e.success)return{success:!1,fixed:!1,error:e.error||"Failed to update phone number",changes:n}}return{success:!0,fixed:n.length>0,changes:n}}catch(e){return{success:!1,fixed:!1,error:e instanceof Error?e.message:"Unknown error",changes:n}}}async function g(e){let t=await m(e);return t.exists?t.capabilities.sms?t.hasMessagingProfile?{hasSms:!0}:{hasSms:!1,error:"Phone number is not associated with a messaging profile"}:{hasSms:!1,error:"Phone number does not have SMS capability"}:{hasSms:!1,error:"Phone number not found in Telnyx"}}async function f(e){let t=await m(e);return t.exists?t.capabilities.voice?t.hasConnection?{hasVoice:!0}:{hasVoice:!1,error:"Phone number is not associated with a connection"}:{hasVoice:!1,error:"Phone number does not have voice capability"}:{hasVoice:!1,error:"Phone number not found in Telnyx"}}e.s(["fixMessagingProfile",()=>r,"verifyMessagingProfile",()=>n],155611),e.s(["getNumberDetails",()=>l,"listOwnedNumbers",()=>o,"purchaseNumber",()=>a,"releaseNumber",()=>c,"searchAvailableNumbers",()=>i,"updateNumber",()=>u],841937),e.s(["fixPhoneNumber",()=>p,"verifySmsCapability",()=>g,"verifyVoiceCapability",()=>f],267706)},306024,e=>{"use strict";e.i(618874);var t=e.i(786348),s=e.i(628123);let n={default:{maxTokens:100,refillRate:100/60,refillInterval:1e3},sms:{maxTokens:60,refillRate:1,refillInterval:1e3},voice:{maxTokens:30,refillRate:.5,refillInterval:1e3},lookup:{maxTokens:200,refillRate:200/60,refillInterval:1e3},webhook:{maxTokens:1e3,refillRate:100,refillInterval:1e3}};class r{buckets=new Map;processingQueue=new Map;getBucket(e,t){return this.buckets.has(e)||this.buckets.set(e,{tokens:t.maxTokens,lastRefill:Date.now(),queue:[]}),this.buckets.get(e)}refillTokens(e,t){let s=Date.now(),n=Math.floor((s-e.lastRefill)/t.refillInterval);if(n>0){let r=n*t.refillRate;e.tokens=Math.min(t.maxTokens,e.tokens+r),e.lastRefill=s}}async processQueue(e,t){if(this.processingQueue.get(e))return;this.processingQueue.set(e,!0);let n=this.getBucket(e,t);for(;n.queue.length>0;)if(this.refillTokens(n,t),n.tokens>=1){let e=n.queue.shift();if(e){n.tokens-=1;let t=Date.now()-e.requestedAt;e.resolve({allowed:!0,remainingTokens:n.tokens,waitTime:t})}}else{let e=t.refillInterval/t.refillRate;await (0,s.sleep)(Math.ceil(e))}this.processingQueue.set(e,!1)}tryAcquire(e,t=n.default){let s=this.getBucket(e,t);return(this.refillTokens(s,t),s.tokens>=1)?(s.tokens-=1,{allowed:!0,remainingTokens:s.tokens}):{allowed:!1,remainingTokens:0,retryAfterMs:Math.ceil(t.refillInterval/t.refillRate)}}async acquire(e,t=n.default,s=3e4){let r=this.tryAcquire(e,t);if(r.allowed)return r;let i=this.getBucket(e,t);return new Promise((n,r)=>{let a=Date.now(),o=setTimeout(()=>{let e=i.queue.findIndex(e=>e.requestedAt===a);-1!==e&&i.queue.splice(e,1),n({allowed:!1,remainingTokens:0,retryAfterMs:s})},s);i.queue.push({resolve:e=>{clearTimeout(o),n(e)},requestedAt:a}),this.processQueue(e,t)})}getStatus(e,t=n.default){let s=this.getBucket(e,t);return this.refillTokens(s,t),{tokens:Math.floor(s.tokens),maxTokens:t.maxTokens,queueLength:s.queue.length,utilizationPercent:Math.round((t.maxTokens-s.tokens)/t.maxTokens*100)}}reset(e){this.buckets.delete(e)}resetAll(){this.buckets.clear()}}let i=new r,a=new Map;async function o(e="default",t,s=3e4){let l=n[e]||n.default,u=`global:${e}`,c=await i.acquire(u,l,s);if(!c.allowed)return c;if(t){let n=(a.has(t)||a.set(t,new r),a.get(t)),i=await n.acquire(e,l,s);return i.allowed?{...i,waitTime:Math.max(c.waitTime||0,i.waitTime||0)}:i}return c}var l=e.i(408305),u=e.i(692837);let c={default:3e4,sms:1e4,voice:3e4,lookup:5e3,webhook:2e3,balance:5e3};async function d(e,n={}){let{method:r="GET",body:i,timeout:a,timeoutType:m="default",rateLimitEndpoint:p="default",companyId:g,correlationId:f=(0,s.generateCorrelationId)(),skipRetry:h=!1,skipRateLimit:_=!1,retryOptions:b={}}=n,y=process.env.TELNYX_API_KEY;if(!y)return{success:!1,error:"TELNYX_API_KEY is not configured",errorCode:"CONFIG_ERROR",correlationId:f};let w=/^https?:\/\//i.test(e),x=w||e.startsWith("/")?e:`/${e}`,T=w?x:x.startsWith("/public/")?`https://api.telnyx.com${x}`:`https://api.telnyx.com/v2${x}`,E=a||c[m];t.telnyxLogger.debug("API request started",{correlationId:f,endpoint:e,method:r,companyId:g});let k=(0,u.startRequestTimer)(e,r,g,f),v=async()=>{let s=Date.now(),n=new AbortController,a=setTimeout(()=>n.abort(),E);try{let o=await fetch(T,{method:r,headers:{Authorization:`Bearer ${y}`,"Content-Type":"application/json","X-Correlation-ID":f},body:i?JSON.stringify(i):void 0,signal:n.signal,keepalive:!0});clearTimeout(a);let u=Date.now()-s,c=await o.json().catch(()=>({}));if(!o.ok){k.end(o.status,!1);let s=(0,l.createErrorFromResponse)(o.status,c,{correlationId:f,endpoint:e,method:r,companyId:g});if(t.telnyxLogger.warn("API request failed",{correlationId:f,endpoint:e,statusCode:o.status,error:s.message,latencyMs:u}),s.retryable)throw s;return{success:!1,error:s.message,errorCode:s.code,correlationId:f,latencyMs:u}}k.end(o.status,!0);let d=c?.data||c;return t.telnyxLogger.debug("API request completed",{correlationId:f,endpoint:e,statusCode:o.status,latencyMs:u}),{success:!0,data:d,correlationId:f,latencyMs:u}}catch(o){clearTimeout(a);let n=Date.now()-s;if(o instanceof Error&&"AbortError"===o.name){k.end(0,!1);let s=new l.TelnyxTimeoutError(`Request timed out after ${E}ms`,E,{correlationId:f,endpoint:e,method:r});throw t.telnyxLogger.error("API request timed out",{correlationId:f,endpoint:e,timeoutMs:E,latencyMs:n}),s}if(o instanceof l.TelnyxError)throw o;k.end(0,!1);let i=(0,l.createErrorFromException)(o,{correlationId:f,endpoint:e,method:r});throw t.telnyxLogger.error("API request error",{correlationId:f,endpoint:e,error:i.message,latencyMs:n}),i}};try{let n=v;if(!h){let r=n;n=()=>(0,s.withRetry)(r,{endpoint:e,correlationId:f,config:b.config,onRetry:(s,n,r)=>{t.telnyxLogger.info("Retrying request",{correlationId:f,endpoint:e,attempt:s,delayMs:r,error:n.message})}})}if(!_){let e=n;n=()=>(function(e,s={}){let{endpoint:n="default",companyId:r,maxWaitMs:i=3e4,correlationId:a}=s;return new Promise(async(s,l)=>{try{let u=await o(n,r,i);if(!u.allowed){let e=Error(`Rate limit exceeded. Retry after ${u.retryAfterMs}ms`);e.code="RATE_LIMIT_EXCEEDED",e.retryAfterMs=u.retryAfterMs,l(e);return}u.waitTime&&u.waitTime>100&&t.telnyxLogger.debug("Request waited for rate limit",{endpoint:n,companyId:r,waitTime:u.waitTime,correlationId:a});let c=await e();s(c)}catch(e){l(e)}})})(e,{endpoint:p,companyId:g,correlationId:f})}return await n()}catch(e){if(e instanceof l.TelnyxError)return{success:!1,error:e.message,errorCode:e.code,correlationId:f};return{success:!1,error:e instanceof Error?e.message:"Unknown error",correlationId:f}}}e.s(["telnyxRequest",()=>d],306024)},893099,e=>{"use strict";e.i(618874);var t=e.i(306024);async function s(e){return(0,t.telnyxRequest)("/10dlc/brand",{method:"POST",body:e})}async function n(e){return(0,t.telnyxRequest)(`/10dlc/brand/${e}`)}async function r(e){return(0,t.telnyxRequest)("/10dlc/campaignBuilder",{method:"POST",body:e})}async function i(e){return(0,t.telnyxRequest)(`/10dlc/campaign/${e}`)}async function a(e,s){return(0,t.telnyxRequest)(`/10dlc/campaigns/${e}/phone_numbers`,{method:"POST",body:{phone_numbers:[{phone_number:s}]}})}e.s(["attachNumberToCampaign",()=>a,"createTenDlcBrand",()=>s,"createTenDlcCampaign",()=>r,"getTenDlcBrand",()=>n,"getTenDlcCampaign",()=>i])}];

//# sourceMappingURL=apps_web_src_2d8c56bf._.js.map