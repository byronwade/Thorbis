module.exports=[254799,(e,r,t)=>{r.exports=e.x("crypto",()=>require("crypto"))},22387,e=>{"use strict";var r=e.i(254799);class t{config;apiUrl;constructor(e){this.config=e,this.apiUrl="production"===e.environment?"https://production.plaid.com":"development"===e.environment?"https://development.plaid.com":"https://sandbox.plaid.com"}getSupportedChannels(){return["ach"]}async processPayment(e){try{if(!e.paymentMethodId)return{success:!1,status:"failed",error:"Payment method (bank account) is required for ACH payments"};return{success:!1,status:"failed",error:"ACH processing via Plaid requires integration with ACH processor (Adyen/ProfitStars)"}}catch(e){return{success:!1,status:"failed",error:e instanceof Error?e.message:"Payment processing failed"}}}async refundPayment(e){return{success:!1,status:"failed",error:"ACH refunds must be processed through ACH processor (Adyen/ProfitStars)"}}async getPaymentStatus(e){throw Error("Payment status must be retrieved from ACH processor")}verifyWebhook(e,t){if(!t)return console.error("[Plaid] No webhook signature provided"),!1;try{let[o,n,i]=t.split(".");if(!o||!n||!i)return console.error("[Plaid] Invalid JWT format in webhook signature"),!1;let s=JSON.parse(Buffer.from(n,"base64url").toString("utf8")),a=s.iat,c=Math.floor(Date.now()/1e3);if(Math.abs(c-a)>300)return console.error("[Plaid] Webhook signature too old or from future"),!1;let u=r.default.createHash("sha256").update(e).digest("hex");if(s.request_body_sha256!==u)return console.error("[Plaid] Webhook body hash mismatch"),!1;if(this.config.webhookVerificationKey){let e=`${o}.${n}`,t=r.default.createVerify("RSA-SHA256");if(t.update(e),!t.verify(this.config.webhookVerificationKey,Buffer.from(i,"base64url")))return console.error("[Plaid] JWT signature verification failed"),!1}else console.warn("[Plaid] No webhook verification key configured - verifying body hash only");return!0}catch(e){return console.error("[Plaid] Webhook verification error:",e),!1}}async createLinkToken(e){try{let r=await fetch(`${this.apiUrl}/link/token/create`,{method:"POST",headers:{"Content-Type":"application/json","PLAID-CLIENT-ID":this.config.clientId,"PLAID-SECRET":this.config.secret},body:JSON.stringify({client_name:"Thorbis",user:{client_user_id:e},products:["auth","transactions"],country_codes:["US"],language:"en"})}),t=await r.json();if(!r.ok)return null;return{linkToken:t.link_token}}catch(e){return null}}async exchangePublicToken(e){try{let r=await fetch(`${this.apiUrl}/item/public_token/exchange`,{method:"POST",headers:{"Content-Type":"application/json","PLAID-CLIENT-ID":this.config.clientId,"PLAID-SECRET":this.config.secret},body:JSON.stringify({public_token:e})}),t=await r.json();if(!r.ok)return null;return{accessToken:t.access_token}}catch(e){return null}}}e.s(["PlaidProcessor",()=>t])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b04b9e7d._.js.map