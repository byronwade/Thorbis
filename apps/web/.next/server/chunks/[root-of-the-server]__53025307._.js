module.exports=[254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},349941,e=>{"use strict";var t=e.i(254799);class r{config;apiUrl="https://api.profitstars.com";constructor(e){this.config=e}getSupportedChannels(){return["ach","check"]}async processPayment(e){try{if(!e.paymentMethodId)return{success:!1,status:"failed",error:"Payment method (bank account) is required for ACH payments"};let t={merchant_id:this.config.merchantId,transaction_type:"ACH_DEBIT",amount:e.amount/100,account_number:e.paymentMethodId,routing_number:this.config.routingNumber,reference_number:e.invoiceId||`invoice-${Date.now()}`,description:e.description||"Invoice payment",metadata:{company_id:this.config.companyId,customer_id:e.customerId,invoice_id:e.invoiceId,...e.metadata}},r=await fetch(`${this.apiUrl}/v1/payments/ach`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`,"X-Merchant-ID":this.config.merchantId},body:JSON.stringify(t)}),a=await r.json();if(!r.ok)return{success:!1,status:"failed",error:a.message||"ACH payment processing failed",failureCode:a.error_code,failureMessage:a.message};return{success:!0,transactionId:a.transaction_id,processorTransactionId:a.transaction_id,status:"processed"===a.status?"succeeded":"processing",processorMetadata:a}}catch(e){return{success:!1,status:"failed",error:e instanceof Error?e.message:"Payment processing failed"}}}async refundPayment(e){try{let t={merchant_id:this.config.merchantId,original_transaction_id:e.transactionId,amount:e.amount?e.amount/100:void 0,reason:e.reason},r=await fetch(`${this.apiUrl}/v1/payments/refund`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`,"X-Merchant-ID":this.config.merchantId},body:JSON.stringify(t)}),a=await r.json();if(!r.ok)return{success:!1,status:"failed",error:a.message||"Refund failed"};return{success:!0,refundId:a.refund_id,processorRefundId:a.refund_id,status:"processed"===a.status?"succeeded":"processing"}}catch(e){return{success:!1,status:"failed",error:e instanceof Error?e.message:"Refund failed"}}}async getPaymentStatus(e){let t=await fetch(`${this.apiUrl}/v1/payments/${e}`,{method:"GET",headers:{Authorization:`Bearer ${this.config.apiKey}`,"X-Merchant-ID":this.config.merchantId}}),r=await t.json();if(!t.ok)throw Error(r.message||"Failed to get payment status");return{status:r.status||"unknown",amount:100*(r.amount||0),metadata:r}}verifyWebhook(e,r){if(!this.config.webhookSecret)return console.warn("[ProfitStars] No webhook secret configured - skipping verification"),!1;if(!r)return console.error("[ProfitStars] No webhook signature provided"),!1;try{let a=t.default.createHmac("sha256",this.config.webhookSecret).update(e,"utf8").digest("hex"),o=r.startsWith("sha256=")?r.slice(7):r,s=Buffer.from(a,"hex"),i=Buffer.from(o,"hex");if(s.length!==i.length)return console.error("[ProfitStars] Webhook signature length mismatch"),!1;if(!t.default.timingSafeEqual(s,i))return console.error("[ProfitStars] Webhook signature verification failed"),!1;try{let t=JSON.parse(e);if(t.timestamp){let e=new Date(t.timestamp).getTime(),r=Date.now();if(Math.abs(r-e)>3e5)return console.error("[ProfitStars] Webhook timestamp too old"),!1}}catch{}return!0}catch(e){return console.error("[ProfitStars] Webhook verification error:",e),!1}}}e.s(["ProfitStarsProcessor",()=>r])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__53025307._.js.map