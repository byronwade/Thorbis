{"version":3,"sources":["../../../../../../apps/web/src/actions/email-folders.ts","../../../../../../apps/web/src/lib/validations/database-schemas.ts","../../../../../../apps/web/src/actions/vendors.ts"],"sourcesContent":["\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { getActiveCompanyId } from \"@/lib/auth/company-context\";\nimport { z } from \"zod\";\n\nconst createFolderSchema = z.object({\n\tname: z.string().min(1).max(100),\n\tdescription: z.string().max(500).optional(),\n\tcolor: z.string().regex(/^#[0-9A-Fa-f]{6}$/).optional(),\n\ticon: z.string().optional(),\n});\n\nconst updateFolderSchema = createFolderSchema.partial().extend({\n\tid: z.string().uuid(),\n\tsort_order: z.number().int().optional(),\n});\n\nconst deleteFolderSchema = z.object({\n\tid: z.string().uuid(),\n});\n\nexport type EmailFolder = {\n\tid: string;\n\tcompany_id: string;\n\tname: string;\n\tslug: string;\n\tdescription: string | null;\n\tcolor: string | null;\n\ticon: string | null;\n\tsort_order: number;\n\tis_system: boolean;\n\tis_active: boolean;\n\tcreated_by: string | null;\n\tcreated_at: string;\n\tupdated_at: string;\n\tdeleted_at: string | null;\n};\n\n/**\n * Get all email folders for the active company\n */\nexport async function getEmailFoldersAction(): Promise<{\n\tsuccess: boolean;\n\tfolders?: EmailFolder[];\n\terror?: string;\n}> {\n\ttry {\n\t\tconst companyId = await getActiveCompanyId();\n\t\tif (!companyId) {\n\t\t\treturn { success: false, error: \"No active company found\" };\n\t\t}\n\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\treturn { success: false, error: \"Database connection failed\" };\n\t\t}\n\n\t\tconst { data, error } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.select(\"*\")\n\t\t\t.eq(\"company_id\", companyId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.eq(\"is_active\", true)\n\t\t\t.order(\"sort_order\", { ascending: true })\n\t\t\t.order(\"name\", { ascending: true });\n\n\t\tif (error) {\n\t\t\treturn { success: false, error: error.message };\n\t\t}\n\n\t\treturn { success: true, folders: data || [] };\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t};\n\t}\n}\n\n/**\n * Create a new email folder\n */\nexport async function createEmailFolderAction(\n\tinput: z.infer<typeof createFolderSchema>\n): Promise<{\n\tsuccess: boolean;\n\tfolder?: EmailFolder;\n\terror?: string;\n}> {\n\ttry {\n\t\tconst validated = createFolderSchema.parse(input);\n\t\tconst companyId = await getActiveCompanyId();\n\t\tif (!companyId) {\n\t\t\treturn { success: false, error: \"No active company found\" };\n\t\t}\n\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\treturn { success: false, error: \"Database connection failed\" };\n\t\t}\n\n\t\tconst { data: { user } } = await supabase.auth.getUser();\n\t\tif (!user) {\n\t\t\treturn { success: false, error: \"Not authenticated\" };\n\t\t}\n\n\t\t// Generate slug from name\n\t\tconst slug = validated.name\n\t\t\t.toLowerCase()\n\t\t\t.trim()\n\t\t\t.replace(/[^a-z0-9]+/g, \"-\")\n\t\t\t.replace(/^-+|-+$/g, \"\");\n\n\t\t// Check if slug already exists\n\t\tconst { data: existing } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.select(\"id\")\n\t\t\t.eq(\"company_id\", companyId)\n\t\t\t.eq(\"slug\", slug)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tif (existing) {\n\t\t\treturn { success: false, error: \"A folder with this name already exists\" };\n\t\t}\n\n\t\t// Get max sort_order\n\t\tconst { data: maxOrder } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.select(\"sort_order\")\n\t\t\t.eq(\"company_id\", companyId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.order(\"sort_order\", { ascending: false })\n\t\t\t.limit(1)\n\t\t\t.single();\n\n\t\tconst { data, error } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.insert({\n\t\t\t\tcompany_id: companyId,\n\t\t\t\tname: validated.name,\n\t\t\t\tslug,\n\t\t\t\tdescription: validated.description || null,\n\t\t\t\tcolor: validated.color || null,\n\t\t\t\ticon: validated.icon || null,\n\t\t\t\tsort_order: (maxOrder?.sort_order || 0) + 1,\n\t\t\t\tcreated_by: user.id,\n\t\t\t})\n\t\t\t.select()\n\t\t\t.single();\n\n\t\tif (error) {\n\t\t\treturn { success: false, error: error.message };\n\t\t}\n\n\t\treturn { success: true, folder: data };\n\t} catch (error) {\n\t\tif (error instanceof z.ZodError) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\terror: error.errors.map((e) => `${e.path.join(\".\")}: ${e.message}`).join(\", \"),\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t};\n\t}\n}\n\n/**\n * Update an email folder\n * @deprecated Unused\n */\nasync function updateEmailFolderAction(\n\tinput: z.infer<typeof updateFolderSchema>\n): Promise<{\n\tsuccess: boolean;\n\tfolder?: EmailFolder;\n\terror?: string;\n}> {\n\ttry {\n\t\tconst validated = updateFolderSchema.parse(input);\n\t\tconst companyId = await getActiveCompanyId();\n\t\tif (!companyId) {\n\t\t\treturn { success: false, error: \"No active company found\" };\n\t\t}\n\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\treturn { success: false, error: \"Database connection failed\" };\n\t\t}\n\n\t\t// Check folder exists and belongs to company\n\t\tconst { data: existing, error: fetchError } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.select(\"id, is_system\")\n\t\t\t.eq(\"id\", validated.id)\n\t\t\t.eq(\"company_id\", companyId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tif (fetchError || !existing) {\n\t\t\treturn { success: false, error: \"Folder not found\" };\n\t\t}\n\n\t\tif (existing.is_system) {\n\t\t\treturn { success: false, error: \"Cannot update system folders\" };\n\t\t}\n\n\t\t// If name is being updated, regenerate slug\n\t\tconst updateData: Record<string, unknown> = {};\n\t\tif (validated.name) {\n\t\t\tupdateData.name = validated.name;\n\t\t\tupdateData.slug = validated.name\n\t\t\t\t.toLowerCase()\n\t\t\t\t.trim()\n\t\t\t\t.replace(/[^a-z0-9]+/g, \"-\")\n\t\t\t\t.replace(/^-+|-+$/g, \"\");\n\t\t}\n\t\tif (validated.description !== undefined) updateData.description = validated.description;\n\t\tif (validated.color !== undefined) updateData.color = validated.color;\n\t\tif (validated.icon !== undefined) updateData.icon = validated.icon;\n\t\tif (validated.sort_order !== undefined) updateData.sort_order = validated.sort_order;\n\n\t\tconst { data, error } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.update(updateData)\n\t\t\t.eq(\"id\", validated.id)\n\t\t\t.eq(\"company_id\", companyId)\n\t\t\t.select()\n\t\t\t.single();\n\n\t\tif (error) {\n\t\t\treturn { success: false, error: error.message };\n\t\t}\n\n\t\treturn { success: true, folder: data };\n\t} catch (error) {\n\t\tif (error instanceof z.ZodError) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\terror: error.errors.map((e) => `${e.path.join(\".\")}: ${e.message}`).join(\", \"),\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t};\n\t}\n}\n\n/**\n * Delete an email folder (soft delete)\n */\nexport async function deleteEmailFolderAction(\n\tinput: z.infer<typeof deleteFolderSchema>\n): Promise<{\n\tsuccess: boolean;\n\terror?: string;\n}> {\n\ttry {\n\t\tconst validated = deleteFolderSchema.parse(input);\n\t\tconst companyId = await getActiveCompanyId();\n\t\tif (!companyId) {\n\t\t\treturn { success: false, error: \"No active company found\" };\n\t\t}\n\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\treturn { success: false, error: \"Database connection failed\" };\n\t\t}\n\n\t\tconst { data: { user } } = await supabase.auth.getUser();\n\t\tif (!user) {\n\t\t\treturn { success: false, error: \"Not authenticated\" };\n\t\t}\n\n\t\t// Check folder exists and belongs to company\n\t\tconst { data: existing, error: fetchError } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.select(\"id, is_system\")\n\t\t\t.eq(\"id\", validated.id)\n\t\t\t.eq(\"company_id\", companyId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tif (fetchError || !existing) {\n\t\t\treturn { success: false, error: \"Folder not found\" };\n\t\t}\n\n\t\tif (existing.is_system) {\n\t\t\treturn { success: false, error: \"Cannot delete system folders\" };\n\t\t}\n\n\t\t// Soft delete\n\t\tconst { error } = await supabase\n\t\t\t.from(\"email_folders\")\n\t\t\t.update({\n\t\t\t\tdeleted_at: new Date().toISOString(),\n\t\t\t\tdeleted_by: user.id,\n\t\t\t\tis_active: false,\n\t\t\t})\n\t\t\t.eq(\"id\", validated.id)\n\t\t\t.eq(\"company_id\", companyId);\n\n\t\tif (error) {\n\t\t\treturn { success: false, error: error.message };\n\t\t}\n\n\t\treturn { success: true };\n\t} catch (error) {\n\t\tif (error instanceof z.ZodError) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\terror: error.errors.map((e) => `${e.path.join(\".\")}: ${e.message}`).join(\", \"),\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t};\n\t}\n}\n\n","/**\n * Zod Validation Schemas for Database Tables\n *\n * Provides type-safe validation for all database operations.\n * Use these schemas to validate user input before database operations.\n *\n * Usage:\n * ```typescript\n * import { customerInsertSchema } from \"@/lib/validations/database-schemas\";\n *\n * const result = customerInsertSchema.safeParse(formData);\n * if (!result.success) {\n *   console.error(result.error);\n * }\n * ```\n */\n\nimport { z } from \"zod\";\n\n// ============================================================================\n// CUSTOMERS\n// ============================================================================\n\nconst customerInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tuser_id: z.string().uuid().optional().nullable(),\n\ttype: z\n\t\t.enum([\"residential\", \"commercial\", \"industrial\"])\n\t\t.default(\"residential\"),\n\tfirst_name: z.string().min(1, \"First name is required\").max(100),\n\tlast_name: z.string().min(1, \"Last name is required\").max(100),\n\tcompany_name: z.string().max(200).optional().nullable(),\n\temail: z.string().email(\"Invalid email address\").optional().nullable(),\n\tphone: z.string().max(20).optional().nullable(),\n\talternate_phone: z.string().max(20).optional().nullable(),\n\taddress: z.string().max(500).optional().nullable(),\n\tcity: z.string().max(100).optional().nullable(),\n\tstate: z.string().max(2).optional().nullable(),\n\tzip: z.string().max(10).optional().nullable(),\n\tlatitude: z.number().optional().nullable(),\n\tlongitude: z.number().optional().nullable(),\n\tstatus: z.enum([\"active\", \"inactive\", \"blocked\"]).default(\"active\"),\n\tsource: z.string().max(100).optional().nullable(),\n\treferred_by: z.string().uuid().optional().nullable(),\n\tnotes: z.string().optional().nullable(),\n\ttags: z.array(z.string()).optional().nullable(),\n\ttotal_revenue: z.number().int().default(0),\n\ttotal_jobs: z.number().int().default(0),\n\toutstanding_balance: z.number().int().default(0),\n\tlifetime_value: z.number().int().default(0),\n\taverage_job_value: z.number().int().default(0),\n\tlast_job_date: z.date().optional().nullable(),\n\tnext_service_due: z.date().optional().nullable(),\n\tportal_enabled: z.boolean().default(false),\n\tportal_invited_at: z.date().optional().nullable(),\n\tportal_last_login: z.date().optional().nullable(),\n\tbilling_same_as_service: z.boolean().default(true),\n\tbilling_address: z.string().max(500).optional().nullable(),\n\tbilling_city: z.string().max(100).optional().nullable(),\n\tbilling_state: z.string().max(2).optional().nullable(),\n\tbilling_zip: z.string().max(10).optional().nullable(),\n\ttax_exempt: z.boolean().default(false),\n\ttax_id: z.string().max(50).optional().nullable(),\n\tpreferred_contact_method: z\n\t\t.enum([\"email\", \"phone\", \"sms\", \"any\"])\n\t\t.optional()\n\t\t.nullable(),\n\tdo_not_disturb: z.boolean().default(false),\n\tmarketing_opt_in: z.boolean().default(true),\n});\n\nconst customerUpdateSchema = customerInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst customerSelectSchema = customerInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tdeleted_by: z.string().uuid().nullable(),\n});\n\n// ============================================================================\n// COMMUNICATIONS\n// ============================================================================\n\nconst communicationInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tcustomer_id: z.string().uuid().optional().nullable(),\n\tjob_id: z.string().uuid().optional().nullable(),\n\tinvoice_id: z.string().uuid().optional().nullable(),\n\tuser_id: z.string().uuid().optional().nullable(),\n\ttype: z.enum([\"email\", \"sms\", \"phone\", \"chat\", \"note\"]),\n\tdirection: z.enum([\"inbound\", \"outbound\"]),\n\tstatus: z\n\t\t.enum([\"draft\", \"queued\", \"sending\", \"sent\", \"delivered\", \"failed\", \"read\"])\n\t\t.default(\"draft\"),\n\tsubject: z.string().max(500).optional().nullable(),\n\tbody: z.string().optional().nullable(),\n\tfrom_email: z.string().email().optional().nullable(),\n\tto_email: z.string().email().optional().nullable(),\n\tfrom_phone: z.string().max(20).optional().nullable(),\n\tto_phone: z.string().max(20).optional().nullable(),\n\tcc: z.array(z.string().email()).optional().nullable(),\n\tbcc: z.array(z.string().email()).optional().nullable(),\n\tthread_id: z.string().uuid().optional().nullable(),\n\tparent_id: z.string().uuid().optional().nullable(),\n\tscheduled_for: z.date().optional().nullable(),\n\tsent_at: z.date().optional().nullable(),\n\tdelivered_at: z.date().optional().nullable(),\n\tread_at: z.date().optional().nullable(),\n\tfailed_at: z.date().optional().nullable(),\n\tfailure_reason: z.string().optional().nullable(),\n\tretry_count: z.number().int().default(0),\n\topen_count: z.number().int().default(0),\n\tclick_count: z.number().int().default(0),\n\tcall_duration: z.number().int().optional().nullable(),\n\tcall_recording_url: z.string().url().optional().nullable(),\n\tcall_transcription: z.string().optional().nullable(),\n\tinternal_note: z.boolean().default(false),\n\tpinned: z.boolean().default(false),\n\ttags: z.array(z.string()).optional().nullable(),\n\tmetadata: z.record(z.string(), z.unknown()).optional().nullable(),\n});\n\nconst communicationUpdateSchema = communicationInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst communicationSelectSchema = communicationInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tdeleted_by: z.string().uuid().nullable(),\n});\n\n// ============================================================================\n// PAYMENTS\n// ============================================================================\n\nexport const paymentInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tcustomer_id: z.string().uuid(),\n\tinvoice_id: z.string().uuid().optional().nullable(),\n\tjob_id: z.string().uuid().optional().nullable(),\n\tpayment_number: z.string().min(1, \"Payment number is required\").max(50),\n\tamount: z.number().int().min(1, \"Amount must be greater than 0\"), // In cents\n\tcurrency: z.string().length(3).default(\"USD\"),\n\tpayment_method: z.enum([\n\t\t\"cash\",\n\t\t\"check\",\n\t\t\"credit_card\",\n\t\t\"debit_card\",\n\t\t\"ach\",\n\t\t\"wire\",\n\t\t\"venmo\",\n\t\t\"paypal\",\n\t\t\"other\",\n\t]),\n\tpayment_type: z.enum([\"payment\", \"refund\", \"credit\"]).default(\"payment\"),\n\tstatus: z\n\t\t.enum([\n\t\t\t\"pending\",\n\t\t\t\"processing\",\n\t\t\t\"completed\",\n\t\t\t\"failed\",\n\t\t\t\"refunded\",\n\t\t\t\"partially_refunded\",\n\t\t\t\"cancelled\",\n\t\t])\n\t\t.default(\"pending\"),\n\tcard_brand: z\n\t\t.enum([\"visa\", \"mastercard\", \"amex\", \"discover\"])\n\t\t.optional()\n\t\t.nullable(),\n\tcard_last4: z.string().length(4).optional().nullable(),\n\tcard_exp_month: z.number().int().min(1).max(12).optional().nullable(),\n\tcard_exp_year: z.number().int().min(2024).optional().nullable(),\n\tcheck_number: z.string().max(50).optional().nullable(),\n\ttransaction_id: z.string().max(200).optional().nullable(),\n\tprocessor: z.string().max(50).optional().nullable(),\n\tprocessor_name: z.string().max(50).optional().nullable(),\n\tprocessor_transaction_id: z.string().max(200).optional().nullable(),\n\tprocessor_fee: z.number().int().default(0),\n\tnet_amount: z.number().int().default(0),\n\tprocessor_metadata: z.record(z.string(), z.unknown()).optional().nullable(),\n\tprocessor_response: z.record(z.string(), z.unknown()).optional().nullable(),\n\trefunded_amount: z.number().int().default(0),\n\toriginal_payment_id: z.string().uuid().optional().nullable(),\n\trefund_reason: z.string().optional().nullable(),\n\tnotes: z.string().optional().nullable(),\n\tis_reconciled: z.boolean().default(false),\n\treconciled_at: z.date().optional().nullable(),\n\treconciled_by: z.string().uuid().optional().nullable(),\n\tdeposit_date: z.date().optional().nullable(),\n\tbank_account_id: z.string().uuid().optional().nullable(),\n\tprocessed_at: z.date().optional().nullable(),\n\tprocessed_by: z.string().uuid().optional().nullable(),\n});\n\nexport const paymentUpdateSchema = paymentInsertSchema\n\t.partial()\n\t.omit({ company_id: true, payment_number: true });\n\nconst paymentSelectSchema = paymentInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tdeleted_by: z.string().uuid().nullable(),\n});\n\n// ============================================================================\n// EQUIPMENT\n// ============================================================================\n\nconst equipmentInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tcustomer_id: z.string().uuid(),\n\tproperty_id: z.string().uuid().optional().nullable(),\n\tequipment_number: z.string().min(1, \"Equipment number is required\").max(50),\n\ttype: z.enum([\"hvac\", \"plumbing\", \"electrical\", \"appliance\", \"other\"]),\n\tcategory: z.string().max(100).optional().nullable(),\n\tmanufacturer: z.string().max(100).optional().nullable(),\n\tmodel: z.string().max(100).optional().nullable(),\n\tserial_number: z.string().max(100).optional().nullable(),\n\tyear: z.number().int().min(1900).max(2100).optional().nullable(),\n\tinstall_date: z.date().optional().nullable(),\n\tlocation: z.string().max(200).optional().nullable(),\n\tsize: z.string().max(50).optional().nullable(),\n\tcapacity: z.string().max(50).optional().nullable(),\n\tfuel_type: z.string().max(50).optional().nullable(),\n\tefficiency_rating: z.string().max(50).optional().nullable(),\n\twarranty_expiration: z.date().optional().nullable(),\n\tis_under_warranty: z.boolean().default(false),\n\twarranty_provider: z.string().max(100).optional().nullable(),\n\twarranty_notes: z.string().optional().nullable(),\n\tpurchase_price: z.number().int().optional().nullable(),\n\tcurrent_value: z.number().int().optional().nullable(),\n\tstatus: z\n\t\t.enum([\"active\", \"inactive\", \"retired\", \"warranty\", \"needs_service\"])\n\t\t.default(\"active\"),\n\tcondition: z\n\t\t.enum([\"excellent\", \"good\", \"fair\", \"poor\"])\n\t\t.optional()\n\t\t.nullable(),\n\tlast_service_date: z.date().optional().nullable(),\n\tnext_service_due: z.date().optional().nullable(),\n\tservice_interval_months: z.number().int().optional().nullable(),\n\tservice_plan_id: z.string().uuid().optional().nullable(),\n\tnotes: z.string().optional().nullable(),\n\ttags: z.array(z.string()).optional().nullable(),\n\tmetadata: z.record(z.string(), z.unknown()).optional().nullable(),\n});\n\nconst equipmentUpdateSchema = equipmentInsertSchema\n\t.partial()\n\t.omit({ company_id: true, equipment_number: true });\n\nconst equipmentSelectSchema = equipmentInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tdeleted_by: z.string().uuid().nullable(),\n});\n\n// ============================================================================\n// SCHEDULES\n// ============================================================================\n\nconst scheduleInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tcustomer_id: z.string().uuid().optional().nullable(),\n\tjob_id: z.string().uuid().optional().nullable(),\n\tassigned_to: z.string().uuid().optional().nullable(),\n\ttype: z\n\t\t.enum([\"appointment\", \"task\", \"event\", \"block\", \"callback\"])\n\t\t.default(\"appointment\"),\n\ttitle: z.string().min(1, \"Title is required\").max(200),\n\tdescription: z.string().optional().nullable(),\n\tstart_time: z.date(),\n\tend_time: z.date(),\n\tduration: z.number().int().min(15), // In minutes\n\tall_day: z.boolean().default(false),\n\tstatus: z\n\t\t.enum([\n\t\t\t\"scheduled\",\n\t\t\t\"confirmed\",\n\t\t\t\"in_progress\",\n\t\t\t\"completed\",\n\t\t\t\"cancelled\",\n\t\t\t\"no_show\",\n\t\t])\n\t\t.default(\"scheduled\"),\n\tpriority: z.enum([\"low\", \"normal\", \"high\", \"urgent\"]).default(\"normal\"),\n\tlocation: z.string().max(500).optional().nullable(),\n\tlatitude: z.number().optional().nullable(),\n\tlongitude: z.number().optional().nullable(),\n\tis_recurring: z.boolean().default(false),\n\trecurrence_rule: z.record(z.string(), z.unknown()).optional().nullable(),\n\tparent_schedule_id: z.string().uuid().optional().nullable(),\n\tcolor: z.string().max(7).optional().nullable(),\n\treminder_enabled: z.boolean().default(true),\n\treminder_sent: z.boolean().default(false),\n\treminder_hours_before: z.number().int().default(24),\n\tnotes: z.string().optional().nullable(),\n\ttags: z.array(z.string()).optional().nullable(),\n\tmetadata: z.record(z.string(), z.unknown()).optional().nullable(),\n\t// Dispatch and completion tracking\n\tdispatch_time: z.union([z.date(), z.string()]).optional().nullable(),\n\tactual_start_time: z.union([z.date(), z.string()]).optional().nullable(),\n\tactual_end_time: z.union([z.date(), z.string()]).optional().nullable(),\n\tactual_duration: z.number().int().optional().nullable(),\n});\n\nconst scheduleUpdateSchema = scheduleInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst scheduleSelectSchema = scheduleInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tdeleted_by: z.string().uuid().nullable(),\n});\n\n// ============================================================================\n// TAGS\n// ============================================================================\n\nconst tagInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tname: z.string().min(1, \"Tag name is required\").max(50),\n\tslug: z.string().min(1).max(60),\n\tdescription: z.string().max(500).optional().nullable(),\n\tcategory: z\n\t\t.enum([\"customer\", \"job\", \"equipment\", \"communication\", \"general\"])\n\t\t.optional()\n\t\t.nullable(),\n\tcolor: z\n\t\t.string()\n\t\t.regex(/^#[0-9A-Fa-f]{6}$/, \"Invalid hex color\")\n\t\t.optional()\n\t\t.nullable(),\n\ticon: z.string().max(50).optional().nullable(),\n\tusage_count: z.number().int().default(0),\n\tis_system: z.boolean().default(false),\n\tis_active: z.boolean().default(true),\n});\n\nconst tagUpdateSchema = tagInsertSchema\n\t.partial()\n\t.omit({ company_id: true, slug: true });\n\nconst tagSelectSchema = tagInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n});\n\n// ============================================================================\n// ATTACHMENTS\n// ============================================================================\n\nconst attachmentInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tentity_type: z.enum([\n\t\t\"job\",\n\t\t\"customer\",\n\t\t\"invoice\",\n\t\t\"equipment\",\n\t\t\"communication\",\n\t\t\"estimate\",\n\t\t\"other\",\n\t]),\n\tentity_id: z.string().uuid(),\n\tfile_name: z.string().min(1, \"File name is required\").max(255),\n\tfile_size: z.number().int().min(1, \"File size must be greater than 0\"),\n\tmime_type: z.string().min(1, \"MIME type is required\").max(100),\n\tstorage_url: z.string().url(\"Invalid storage URL\"),\n\tstorage_path: z.string().max(500).optional().nullable(),\n\tbucket: z.string().max(100).optional().nullable(),\n\tis_image: z.boolean().default(false),\n\tis_document: z.boolean().default(false),\n\tis_public: z.boolean().default(false),\n\tthumbnail_url: z.string().url().optional().nullable(),\n\twidth: z.number().int().optional().nullable(),\n\theight: z.number().int().optional().nullable(),\n\talt_text: z.string().max(200).optional().nullable(),\n\tdescription: z.string().max(500).optional().nullable(),\n\ttags: z.array(z.string()).optional().nullable(),\n\tuploaded_by: z.string().uuid().optional().nullable(),\n\tuploaded_at: z.date().optional().nullable(),\n});\n\nconst attachmentUpdateSchema = attachmentInsertSchema\n\t.partial()\n\t.omit({ company_id: true, entity_type: true, entity_id: true });\n\nconst attachmentSelectSchema = attachmentInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tdeleted_by: z.string().uuid().nullable(),\n});\n\n// ============================================================================\n// HELPER TYPES\n// ============================================================================\n\nexport type CustomerInsert = z.infer<typeof customerInsertSchema>;\nexport type CustomerUpdate = z.infer<typeof customerUpdateSchema>;\nexport type CustomerSelect = z.infer<typeof customerSelectSchema>;\n\nexport type CommunicationInsert = z.infer<typeof communicationInsertSchema>;\nexport type CommunicationUpdate = z.infer<typeof communicationUpdateSchema>;\nexport type CommunicationSelect = z.infer<typeof communicationSelectSchema>;\n\nexport type PaymentInsert = z.infer<typeof paymentInsertSchema>;\nexport type PaymentUpdate = z.infer<typeof paymentUpdateSchema>;\nexport type PaymentSelect = z.infer<typeof paymentSelectSchema>;\n\nexport type EquipmentInsert = z.infer<typeof equipmentInsertSchema>;\nexport type EquipmentUpdate = z.infer<typeof equipmentUpdateSchema>;\nexport type EquipmentSelect = z.infer<typeof equipmentSelectSchema>;\n\nexport type ScheduleInsert = z.infer<typeof scheduleInsertSchema>;\nexport type ScheduleUpdate = z.infer<typeof scheduleUpdateSchema>;\nexport type ScheduleSelect = z.infer<typeof scheduleSelectSchema>;\n\nexport type TagInsert = z.infer<typeof tagInsertSchema>;\nexport type TagUpdate = z.infer<typeof tagUpdateSchema>;\nexport type TagSelect = z.infer<typeof tagSelectSchema>;\n\nexport type AttachmentInsert = z.infer<typeof attachmentInsertSchema>;\nexport type AttachmentUpdate = z.infer<typeof attachmentUpdateSchema>;\nexport type AttachmentSelect = z.infer<typeof attachmentSelectSchema>;\n\n// ============================================================================\n// JOB TIME ENTRIES\n// ============================================================================\n\nconst jobTimeEntryInsertSchema = z.object({\n\tjob_id: z.string().uuid(),\n\tcompany_id: z.string().uuid(),\n\tuser_id: z.string().uuid(),\n\tclock_in: z.date(),\n\tclock_out: z.date().optional().nullable(),\n\tbreak_minutes: z.number().int().min(0).max(1439).default(0),\n\tclock_in_location: z\n\t\t.object({\n\t\t\tlat: z.number(),\n\t\t\tlng: z.number(),\n\t\t\taccuracy: z.number().optional(),\n\t\t\taddress: z.string().optional(),\n\t\t})\n\t\t.optional()\n\t\t.nullable(),\n\tclock_out_location: z\n\t\t.object({\n\t\t\tlat: z.number(),\n\t\t\tlng: z.number(),\n\t\t\taccuracy: z.number().optional(),\n\t\t\taddress: z.string().optional(),\n\t\t})\n\t\t.optional()\n\t\t.nullable(),\n\tgps_verified: z.boolean().default(false),\n\tentry_type: z.enum([\"manual\", \"auto\", \"gps\"]).default(\"manual\"),\n\tnotes: z.string().optional().nullable(),\n\tis_overtime: z.boolean().default(false),\n\tis_billable: z.boolean().default(true),\n\thourly_rate: z.number().int().optional().nullable(),\n\tmetadata: z.any().optional().nullable(),\n});\n\nconst jobTimeEntryUpdateSchema = jobTimeEntryInsertSchema\n\t.partial()\n\t.omit({ job_id: true, company_id: true, user_id: true });\n\nconst jobTimeEntrySelectSchema = jobTimeEntryInsertSchema.extend({\n\tid: z.string().uuid(),\n\ttotal_hours: z.number().optional().nullable(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n});\n\n// ============================================================================\n// JOB PHOTOS\n// ============================================================================\n\nconst jobPhotoInsertSchema = z.object({\n\tjob_id: z.string().uuid(),\n\tcompany_id: z.string().uuid(),\n\tuploaded_by: z.string().uuid(),\n\tstorage_path: z.string().min(1, \"Storage path is required\"),\n\tthumbnail_path: z.string().optional().nullable(),\n\tfile_name: z.string().min(1, \"File name is required\").max(255),\n\tfile_size: z.number().int().min(1).max(52_428_800), // 50MB max\n\tmime_type: z.string().optional().nullable(),\n\tcategory: z.enum([\n\t\t\"before\",\n\t\t\"during\",\n\t\t\"after\",\n\t\t\"issue\",\n\t\t\"equipment\",\n\t\t\"completion\",\n\t\t\"other\",\n\t]),\n\tsubcategory: z.string().max(100).optional().nullable(),\n\ttitle: z.string().max(200).optional().nullable(),\n\tdescription: z.string().optional().nullable(),\n\tis_customer_visible: z.boolean().default(true),\n\tis_required_photo: z.boolean().default(false),\n\tphoto_location: z\n\t\t.object({\n\t\t\tlat: z.number(),\n\t\t\tlng: z.number(),\n\t\t\taccuracy: z.number().optional(),\n\t\t\taddress: z.string().optional(),\n\t\t})\n\t\t.optional()\n\t\t.nullable(),\n\ttaken_at: z.date().optional().nullable(),\n\tdevice_info: z.any().optional().nullable(),\n\texif_data: z.any().optional().nullable(),\n\tannotations: z.array(z.any()).optional().nullable(),\n\ttags: z.array(z.string()).optional().nullable(),\n\tdisplay_order: z.number().int().default(0),\n\tmetadata: z.any().optional().nullable(),\n});\n\nconst jobPhotoUpdateSchema = jobPhotoInsertSchema\n\t.partial()\n\t.omit({ job_id: true, company_id: true, uploaded_by: true });\n\nconst jobPhotoSelectSchema = jobPhotoInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n});\n\n// ============================================================================\n// JOB WORKFLOW STAGES\n// ============================================================================\n\nconst jobWorkflowStageInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tstage_name: z.string().min(1, \"Stage name is required\").max(100),\n\tstage_key: z.string().min(1, \"Stage key is required\").max(100),\n\tdisplay_order: z.number().int().min(0).default(0),\n\tstage_color: z.string().max(20).optional().nullable(),\n\tstage_icon: z.string().max(50).optional().nullable(),\n\tis_start_stage: z.boolean().default(false),\n\tis_end_stage: z.boolean().default(false),\n\trequires_approval: z.boolean().default(false),\n\tapproval_roles: z.array(z.any()).optional().nullable(),\n\trequired_fields: z.array(z.string()).optional().nullable(),\n\trequired_photos_count: z.number().int().min(0).default(0),\n\trequired_time_entry: z.boolean().default(false),\n\tauto_send_email: z.boolean().default(false),\n\temail_template_id: z.string().uuid().optional().nullable(),\n\tauto_send_sms: z.boolean().default(false),\n\tsms_template_id: z.string().uuid().optional().nullable(),\n\tauto_create_invoice: z.boolean().default(false),\n\tallowed_next_stages: z.array(z.string()).optional().nullable(),\n\tindustry_type: z.string().max(50).optional().nullable(),\n\tis_active: z.boolean().default(true),\n\tmetadata: z.any().optional().nullable(),\n});\n\nconst jobWorkflowStageUpdateSchema = jobWorkflowStageInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst jobWorkflowStageSelectSchema = jobWorkflowStageInsertSchema.extend(\n\t{\n\t\tid: z.string().uuid(),\n\t\tcreated_at: z.date(),\n\t\tupdated_at: z.date(),\n\t},\n);\n\n// ============================================================================\n// JOB SIGNATURES\n// ============================================================================\n\nconst jobSignatureInsertSchema = z.object({\n\tjob_id: z.string().uuid(),\n\tcompany_id: z.string().uuid(),\n\tsignature_type: z.enum([\n\t\t\"customer\",\n\t\t\"technician\",\n\t\t\"inspector\",\n\t\t\"supervisor\",\n\t\t\"other\",\n\t]),\n\tsigner_name: z.string().min(1, \"Signer name is required\").max(200),\n\tsigner_email: z.string().email().optional().nullable(),\n\tsigner_phone: z.string().max(20).optional().nullable(),\n\tsigner_role: z.string().max(100).optional().nullable(),\n\tsignature_data_url: z.string().min(1, \"Signature data is required\"),\n\tsignature_hash: z.string().optional().nullable(),\n\tsigned_at: z.date().default(() => new Date()),\n\tsigned_location: z\n\t\t.object({\n\t\t\tlat: z.number(),\n\t\t\tlng: z.number(),\n\t\t\taccuracy: z.number().optional(),\n\t\t\taddress: z.string().optional(),\n\t\t})\n\t\t.optional()\n\t\t.nullable(),\n\tip_address: z.string().max(45).optional().nullable(),\n\tuser_agent: z.string().optional().nullable(),\n\tdevice_info: z.any().optional().nullable(),\n\tdocument_type: z.enum([\n\t\t\"job_completion\",\n\t\t\"estimate\",\n\t\t\"change_order\",\n\t\t\"work_authorization\",\n\t\t\"inspection\",\n\t\t\"other\",\n\t]),\n\tdocument_content: z.any().optional().nullable(),\n\tagreement_text: z.string().optional().nullable(),\n\tis_verified: z.boolean().default(false),\n\tverified_at: z.date().optional().nullable(),\n\tverified_by: z.string().uuid().optional().nullable(),\n\tmetadata: z.any().optional().nullable(),\n});\n\nconst jobSignatureUpdateSchema = jobSignatureInsertSchema\n\t.partial()\n\t.omit({ job_id: true, company_id: true });\n\nconst jobSignatureSelectSchema = jobSignatureInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n});\n\n// ============================================================================\n// ENHANCED JOBS SCHEMA\n// ============================================================================\n\n/**\n * Job Insert Schema - REFACTORED\n *\n * After domain table refactoring, this schema only includes core job fields.\n * Domain-specific fields have been moved to separate tables and schemas:\n * - job_financial - Financial data\n * - job_workflow - Workflow/template data\n * - job_time_tracking - Time tracking data\n * - job_customer_approval - Customer signatures/approval\n * - job_equipment_service - Equipment service tracking\n * - job_dispatch - Dispatch/routing data\n * - job_quality - Quality metrics\n * - job_safety - Safety/compliance data\n * - job_ai_enrichment - AI analysis\n * - job_multi_entity - Multi-customer/property support\n *\n * See /src/lib/validations/job-domain-schemas.ts for domain schemas\n */\nconst jobInsertSchema = z.object({\n\t// Core identity\n\tcompany_id: z.string().uuid(),\n\tjob_number: z.string().min(1, \"Job number is required\").max(50),\n\ttitle: z.string().min(1, \"Title is required\").max(200),\n\tdescription: z.string().optional().nullable(),\n\n\t// Classification\n\tstatus: z\n\t\t.enum([\n\t\t\t\"quoted\",\n\t\t\t\"scheduled\",\n\t\t\t\"in_progress\",\n\t\t\t\"on_hold\",\n\t\t\t\"completed\",\n\t\t\t\"cancelled\",\n\t\t\t\"archived\",\n\t\t])\n\t\t.default(\"quoted\"),\n\tpriority: z.enum([\"low\", \"medium\", \"high\", \"urgent\"]).default(\"medium\"),\n\tjob_type: z.string().max(100).optional().nullable(),\n\tservice_type: z.string().max(100).optional().nullable(),\n\n\t// Primary relationships\n\tproperty_id: z.string().uuid().optional().nullable(),\n\tcustomer_id: z.string().uuid().optional().nullable(),\n\tassigned_to: z.string().uuid().optional().nullable(),\n\n\t// Scheduling (core scheduling only - actual times moved to job_time_tracking)\n\tscheduled_start: z.date().optional().nullable(),\n\tscheduled_end: z.date().optional().nullable(),\n\n\t// Flexible data\n\tnotes: z.string().optional().nullable(),\n\tmetadata: z.any().optional().nullable(),\n});\n\nconst jobUpdateSchema = jobInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst jobSelectSchema = jobInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().nullable(),\n\tarchived_at: z.date().nullable(),\n\tsearch_vector: z.any().nullable(),\n});\n\n// ============================================================================\n// HELPER TYPES\n// ============================================================================\n\nexport type JobTimeEntryInsert = z.infer<typeof jobTimeEntryInsertSchema>;\nexport type JobTimeEntryUpdate = z.infer<typeof jobTimeEntryUpdateSchema>;\nexport type JobTimeEntrySelect = z.infer<typeof jobTimeEntrySelectSchema>;\n\nexport type JobPhotoInsert = z.infer<typeof jobPhotoInsertSchema>;\nexport type JobPhotoUpdate = z.infer<typeof jobPhotoUpdateSchema>;\nexport type JobPhotoSelect = z.infer<typeof jobPhotoSelectSchema>;\n\nexport type JobWorkflowStageInsert = z.infer<\n\ttypeof jobWorkflowStageInsertSchema\n>;\nexport type JobWorkflowStageUpdate = z.infer<\n\ttypeof jobWorkflowStageUpdateSchema\n>;\nexport type JobWorkflowStageSelect = z.infer<\n\ttypeof jobWorkflowStageSelectSchema\n>;\n\nexport type JobSignatureInsert = z.infer<typeof jobSignatureInsertSchema>;\nexport type JobSignatureUpdate = z.infer<typeof jobSignatureUpdateSchema>;\nexport type JobSignatureSelect = z.infer<typeof jobSignatureSelectSchema>;\n\nexport type JobInsert = z.infer<typeof jobInsertSchema>;\nexport type JobUpdate = z.infer<typeof jobUpdateSchema>;\nexport type JobSelect = z.infer<typeof jobSelectSchema>;\n\n// ============================================================================\n// VENDORS\n// ============================================================================\n\nexport const vendorInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tname: z.string().min(1, \"Vendor name is required\").max(200),\n\tdisplay_name: z.string().min(1, \"Display name is required\").max(200),\n\tvendor_number: z.string().min(1, \"Vendor number is required\").max(50),\n\temail: z.string().email(\"Invalid email address\").optional().nullable(),\n\tphone: z.string().max(20).optional().nullable(),\n\tsecondary_phone: z.string().max(20).optional().nullable(),\n\twebsite: z.string().url(\"Invalid URL\").optional().nullable(),\n\taddress: z.string().max(500).optional().nullable(),\n\taddress2: z.string().max(500).optional().nullable(),\n\tcity: z.string().max(100).optional().nullable(),\n\tstate: z.string().max(100).optional().nullable(),\n\tzip_code: z.string().max(20).optional().nullable(),\n\tcountry: z.string().max(100).default(\"USA\"),\n\ttax_id: z.string().max(50).optional().nullable(),\n\tpayment_terms: z\n\t\t.enum([\"net_15\", \"net_30\", \"net_60\", \"due_on_receipt\", \"custom\"])\n\t\t.default(\"net_30\"),\n\tcredit_limit: z.number().int().min(0).default(0), // In cents\n\tpreferred_payment_method: z\n\t\t.enum([\"check\", \"ach\", \"credit_card\", \"wire\"])\n\t\t.optional()\n\t\t.nullable(),\n\tcategory: z\n\t\t.enum([\n\t\t\t\"supplier\",\n\t\t\t\"distributor\",\n\t\t\t\"manufacturer\",\n\t\t\t\"service_provider\",\n\t\t\t\"other\",\n\t\t])\n\t\t.optional()\n\t\t.nullable(),\n\ttags: z.array(z.string()).optional().nullable(),\n\tstatus: z.enum([\"active\", \"inactive\"]).default(\"active\"),\n\tnotes: z.string().optional().nullable(),\n\tinternal_notes: z.string().optional().nullable(),\n\tcustom_fields: z.record(z.string(), z.any()).optional().nullable(),\n});\n\nexport const vendorUpdateSchema = vendorInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst vendorSelectSchema = vendorInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tdeleted_at: z.date().optional().nullable(),\n\tdeleted_by: z.string().uuid().optional().nullable(),\n});\n\n// ============================================================================\n// PURCHASE ORDERS\n// ============================================================================\n\nconst purchaseOrderLineItemSchema = z.object({\n\tid: z.string().uuid().optional(),\n\tdescription: z.string().min(1, \"Description is required\"),\n\tquantity: z.number().positive(\"Quantity must be positive\"),\n\tunit_price: z.number().nonnegative(\"Unit price must be non-negative\"), // In cents\n\ttotal: z.number().nonnegative(\"Total must be non-negative\"), // In cents\n});\n\nexport const purchaseOrderInsertSchema = z.object({\n\tcompany_id: z.string().uuid(),\n\tjob_id: z.string().uuid().optional().nullable(),\n\testimate_id: z.string().uuid().optional().nullable(),\n\tinvoice_id: z.string().uuid().optional().nullable(),\n\trequested_by: z.string().uuid(),\n\tapproved_by: z.string().uuid().optional().nullable(),\n\tvendor_id: z.string().uuid().optional().nullable(),\n\tvendor: z.string().min(1, \"Vendor name is required\").max(200),\n\tvendor_email: z.string().email(\"Invalid email address\").optional().nullable(),\n\tvendor_phone: z.string().max(20).optional().nullable(),\n\tpo_number: z.string().min(1, \"PO number is required\").max(100),\n\ttitle: z.string().min(1, \"Title is required\").max(200),\n\tdescription: z.string().optional().nullable(),\n\tstatus: z\n\t\t.enum([\n\t\t\t\"draft\",\n\t\t\t\"pending_approval\",\n\t\t\t\"approved\",\n\t\t\t\"ordered\",\n\t\t\t\"partially_received\",\n\t\t\t\"received\",\n\t\t\t\"cancelled\",\n\t\t])\n\t\t.default(\"draft\"),\n\tpriority: z.enum([\"low\", \"normal\", \"high\", \"urgent\"]).default(\"normal\"),\n\tline_items: z\n\t\t.array(purchaseOrderLineItemSchema)\n\t\t.min(1, \"At least one line item is required\"),\n\tsubtotal: z.number().int().nonnegative().default(0), // In cents\n\ttax_amount: z.number().int().nonnegative().default(0), // In cents\n\tshipping_amount: z.number().int().nonnegative().default(0), // In cents\n\ttotal_amount: z.number().int().nonnegative().default(0), // In cents\n\texpected_delivery: z.date().optional().nullable(),\n\tactual_delivery: z.date().optional().nullable(),\n\tdelivery_address: z.string().max(500).optional().nullable(),\n\tnotes: z.string().optional().nullable(),\n\tinternal_notes: z.string().optional().nullable(),\n\tauto_generated: z.boolean().default(false),\n});\n\nconst purchaseOrderUpdateSchema = purchaseOrderInsertSchema\n\t.partial()\n\t.omit({ company_id: true });\n\nconst purchaseOrderSelectSchema = purchaseOrderInsertSchema.extend({\n\tid: z.string().uuid(),\n\tcreated_at: z.date(),\n\tupdated_at: z.date(),\n\tapproved_at: z.date().optional().nullable(),\n\tordered_at: z.date().optional().nullable(),\n\treceived_at: z.date().optional().nullable(),\n});\n\n// ============================================================================\n// HELPER TYPES\n// ============================================================================\n\nexport type VendorInsert = z.infer<typeof vendorInsertSchema>;\nexport type VendorUpdate = z.infer<typeof vendorUpdateSchema>;\nexport type VendorSelect = z.infer<typeof vendorSelectSchema>;\n\nexport type PurchaseOrderLineItem = z.infer<typeof purchaseOrderLineItemSchema>;\nexport type PurchaseOrderInsert = z.infer<typeof purchaseOrderInsertSchema>;\nexport type PurchaseOrderUpdate = z.infer<typeof purchaseOrderUpdateSchema>;\nexport type PurchaseOrderSelect = z.infer<typeof purchaseOrderSelectSchema>;\n","/**\n * Vendors Server Actions\n *\n * Handles vendor management with CRUD operations, search, and vendor selection.\n */\n\n\"use server\";\n\nimport {\n    ActionError,\n    ERROR_CODES,\n    ERROR_MESSAGES,\n} from \"@/lib/errors/action-error\";\nimport { revalidatePath } from \"next/cache\";\n\n// Regex constants\nconst VENDOR_NUMBER_REGEX = /VND-\\d{4}-(\\d+)/;\n\nimport {\n    type ActionResult,\n    assertAuthenticated,\n    assertExists,\n    withErrorHandling,\n} from \"@/lib/errors/with-error-handling\";\nimport { createClient } from \"@/lib/supabase/server\";\nimport {\n    type VendorUpdate,\n    vendorInsertSchema,\n    vendorUpdateSchema,\n} from \"@/lib/validations/database-schemas\";\n\n/**\n * Generate unique vendor number\n */\nasync function generateVendorNumber(\n\tsupabase: any,\n\tcompanyId: string,\n): Promise<string> {\n\tconst { data: latestVendor } = await supabase\n\t\t.from(\"vendors\")\n\t\t.select(\"vendor_number\")\n\t\t.eq(\"company_id\", companyId)\n\t\t.is(\"deleted_at\", null)\n\t\t.order(\"created_at\", { ascending: false })\n\t\t.limit(1)\n\t\t.single();\n\n\tif (!latestVendor) {\n\t\treturn `VND-${new Date().getFullYear()}-001`;\n\t}\n\n\tconst match = latestVendor.vendor_number.match(VENDOR_NUMBER_REGEX);\n\tif (match) {\n\t\tconst nextNumber = Number.parseInt(match[1], 10) + 1;\n\t\treturn `VND-${new Date().getFullYear()}-${nextNumber.toString().padStart(3, \"0\")}`;\n\t}\n\n\treturn `VND-${new Date().getFullYear()}-${Date.now().toString().slice(-3)}`;\n}\n\n/**\n * Create a new vendor\n */\nasync function createVendor(\n\tformData: FormData,\n): Promise<ActionResult<string>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.single();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You must be part of a company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Generate vendor number if not provided\n\t\tconst vendorNumber =\n\t\t\tformData.get(\"vendor_number\")?.toString() ||\n\t\t\t(await generateVendorNumber(supabase, teamMember.company_id));\n\n\t\t// Validate input\n\t\tconst data = vendorInsertSchema.parse({\n\t\t\tcompany_id: teamMember.company_id,\n\t\t\tname: formData.get(\"name\"),\n\t\t\tdisplay_name: formData.get(\"display_name\") || formData.get(\"name\"),\n\t\t\tvendor_number: vendorNumber,\n\t\t\temail: formData.get(\"email\") || undefined,\n\t\t\tphone: formData.get(\"phone\") || undefined,\n\t\t\tsecondary_phone: formData.get(\"secondary_phone\") || undefined,\n\t\t\twebsite: formData.get(\"website\") || undefined,\n\t\t\taddress: formData.get(\"address\") || undefined,\n\t\t\taddress2: formData.get(\"address2\") || undefined,\n\t\t\tcity: formData.get(\"city\") || undefined,\n\t\t\tstate: formData.get(\"state\") || undefined,\n\t\t\tzip_code: formData.get(\"zip_code\") || undefined,\n\t\t\tcountry: formData.get(\"country\") || \"USA\",\n\t\t\ttax_id: formData.get(\"tax_id\") || undefined,\n\t\t\tpayment_terms: formData.get(\"payment_terms\") || \"net_30\",\n\t\t\tcredit_limit: formData.get(\"credit_limit\")\n\t\t\t\t? Number.parseInt(formData.get(\"credit_limit\") as string, 10) * 100\n\t\t\t\t: 0,\n\t\t\tpreferred_payment_method:\n\t\t\t\tformData.get(\"preferred_payment_method\") || undefined,\n\t\t\tcategory: formData.get(\"category\") || undefined,\n\t\t\ttags: formData.get(\"tags\")\n\t\t\t\t? JSON.parse(formData.get(\"tags\") as string)\n\t\t\t\t: undefined,\n\t\t\tstatus: formData.get(\"status\") || \"active\",\n\t\t\tnotes: formData.get(\"notes\") || undefined,\n\t\t\tinternal_notes: formData.get(\"internal_notes\") || undefined,\n\t\t\tcustom_fields: formData.get(\"custom_fields\")\n\t\t\t\t? JSON.parse(formData.get(\"custom_fields\") as string)\n\t\t\t\t: undefined,\n\t\t});\n\n\t\t// Check if vendor number already exists\n\t\tconst { data: existingVendor } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"id\")\n\t\t\t.eq(\"company_id\", teamMember.company_id)\n\t\t\t.eq(\"vendor_number\", data.vendor_number)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tif (existingVendor) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Vendor number already exists\",\n\t\t\t\tERROR_CODES.VALIDATION_FAILED,\n\t\t\t);\n\t\t}\n\n\t\t// Insert vendor\n\t\tconst { data: vendor, error } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.insert({\n\t\t\t\tcompany_id: data.company_id,\n\t\t\t\tname: data.name,\n\t\t\t\tdisplay_name: data.display_name,\n\t\t\t\tvendor_number: data.vendor_number,\n\t\t\t\temail: data.email,\n\t\t\t\tphone: data.phone,\n\t\t\t\tsecondary_phone: data.secondary_phone,\n\t\t\t\twebsite: data.website,\n\t\t\t\taddress: data.address,\n\t\t\t\taddress2: data.address2,\n\t\t\t\tcity: data.city,\n\t\t\t\tstate: data.state,\n\t\t\t\tzip_code: data.zip_code,\n\t\t\t\tcountry: data.country,\n\t\t\t\ttax_id: data.tax_id,\n\t\t\t\tpayment_terms: data.payment_terms,\n\t\t\t\tcredit_limit: data.credit_limit,\n\t\t\t\tpreferred_payment_method: data.preferred_payment_method,\n\t\t\t\tcategory: data.category,\n\t\t\t\ttags: data.tags || [],\n\t\t\t\tstatus: data.status,\n\t\t\t\tnotes: data.notes,\n\t\t\t\tinternal_notes: data.internal_notes,\n\t\t\t\tcustom_fields: data.custom_fields || {},\n\t\t\t})\n\t\t\t.select(\"id\")\n\t\t\t.single();\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to create vendor\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tassertExists(vendor, \"Vendor\");\n\n\t\trevalidatePath(\"/dashboard/inventory/vendors\");\n\t\trevalidatePath(`/dashboard/inventory/vendors/${vendor.id}`);\n\n\t\treturn vendor.id;\n\t});\n}\n\n/**\n * Update an existing vendor\n */\nexport async function updateVendor(\n\tvendorId: string,\n\tformData: FormData,\n): Promise<ActionResult<void>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.single();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You must be part of a company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Verify vendor exists and belongs to company\n\t\tconst { data: existingVendor } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"id, company_id, vendor_number\")\n\t\t\t.eq(\"id\", vendorId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tassertExists(existingVendor, \"Vendor\");\n\n\t\tif (existingVendor.company_id !== teamMember.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\tERROR_MESSAGES.forbidden(\"vendor\"),\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Build update object from form data\n\t\tconst updateData: Partial<VendorUpdate> = {};\n\n\t\tif (formData.has(\"name\")) {\n\t\t\tupdateData.name = formData.get(\"name\") as string;\n\t\t}\n\t\tif (formData.has(\"display_name\")) {\n\t\t\tupdateData.display_name = formData.get(\"display_name\") as string;\n\t\t}\n\t\tif (formData.has(\"vendor_number\")) {\n\t\t\tupdateData.vendor_number = formData.get(\"vendor_number\") as string;\n\t\t}\n\t\tif (formData.has(\"email\")) {\n\t\t\tupdateData.email = (formData.get(\"email\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"phone\")) {\n\t\t\tupdateData.phone = (formData.get(\"phone\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"secondary_phone\")) {\n\t\t\tupdateData.secondary_phone =\n\t\t\t\t(formData.get(\"secondary_phone\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"website\")) {\n\t\t\tupdateData.website = (formData.get(\"website\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"address\")) {\n\t\t\tupdateData.address = (formData.get(\"address\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"address2\")) {\n\t\t\tupdateData.address2 = (formData.get(\"address2\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"city\")) {\n\t\t\tupdateData.city = (formData.get(\"city\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"state\")) {\n\t\t\tupdateData.state = (formData.get(\"state\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"zip_code\")) {\n\t\t\tupdateData.zip_code = (formData.get(\"zip_code\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"country\")) {\n\t\t\tupdateData.country = formData.get(\"country\") as string;\n\t\t}\n\t\tif (formData.has(\"tax_id\")) {\n\t\t\tupdateData.tax_id = (formData.get(\"tax_id\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"payment_terms\")) {\n\t\t\tupdateData.payment_terms = formData.get(\"payment_terms\") as any;\n\t\t}\n\t\tif (formData.has(\"credit_limit\")) {\n\t\t\tupdateData.credit_limit =\n\t\t\t\tNumber.parseInt(formData.get(\"credit_limit\") as string, 10) * 100;\n\t\t}\n\t\tif (formData.has(\"preferred_payment_method\")) {\n\t\t\tupdateData.preferred_payment_method = formData.get(\n\t\t\t\t\"preferred_payment_method\",\n\t\t\t) as any;\n\t\t}\n\t\tif (formData.has(\"category\")) {\n\t\t\tupdateData.category = formData.get(\"category\") as any;\n\t\t}\n\t\tif (formData.has(\"tags\")) {\n\t\t\tupdateData.tags = JSON.parse(formData.get(\"tags\") as string);\n\t\t}\n\t\tif (formData.has(\"status\")) {\n\t\t\tupdateData.status = formData.get(\"status\") as \"active\" | \"inactive\";\n\t\t}\n\t\tif (formData.has(\"notes\")) {\n\t\t\tupdateData.notes = (formData.get(\"notes\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"internal_notes\")) {\n\t\t\tupdateData.internal_notes =\n\t\t\t\t(formData.get(\"internal_notes\") as string) || undefined;\n\t\t}\n\t\tif (formData.has(\"custom_fields\")) {\n\t\t\tupdateData.custom_fields = JSON.parse(\n\t\t\t\tformData.get(\"custom_fields\") as string,\n\t\t\t);\n\t\t}\n\n\t\t// Validate update data\n\t\tconst validated = vendorUpdateSchema.parse(updateData);\n\n\t\t// Check vendor number uniqueness if changed\n\t\tif (\n\t\t\tvalidated.vendor_number &&\n\t\t\tvalidated.vendor_number !== existingVendor.vendor_number\n\t\t) {\n\t\t\tconst { data: duplicate } = await supabase\n\t\t\t\t.from(\"vendors\")\n\t\t\t\t.select(\"id\")\n\t\t\t\t.eq(\"company_id\", teamMember.company_id)\n\t\t\t\t.eq(\"vendor_number\", validated.vendor_number)\n\t\t\t\t.neq(\"id\", vendorId)\n\t\t\t\t.is(\"deleted_at\", null)\n\t\t\t\t.single();\n\n\t\t\tif (duplicate) {\n\t\t\t\tthrow new ActionError(\n\t\t\t\t\t\"Vendor number already exists\",\n\t\t\t\t\tERROR_CODES.VALIDATION_FAILED,\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// Update vendor\n\t\tconst { error } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.update(validated)\n\t\t\t.eq(\"id\", vendorId);\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to update vendor\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\trevalidatePath(\"/dashboard/inventory/vendors\");\n\t\trevalidatePath(`/dashboard/inventory/vendors/${vendorId}`);\n\t});\n}\n\n/**\n * Delete (soft delete) a vendor\n */\nasync function deleteVendor(\n\tvendorId: string,\n): Promise<ActionResult<void>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.single();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You must be part of a company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Verify vendor exists and belongs to company\n\t\tconst { data: vendor } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"id, company_id\")\n\t\t\t.eq(\"id\", vendorId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tassertExists(vendor, \"Vendor\");\n\n\t\tif (vendor.company_id !== teamMember.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\tERROR_MESSAGES.forbidden(\"vendor\"),\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Soft delete vendor\n\t\tconst { error } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.update({\n\t\t\t\tdeleted_at: new Date().toISOString(),\n\t\t\t\tdeleted_by: user.id,\n\t\t\t})\n\t\t\t.eq(\"id\", vendorId);\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to delete vendor\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\trevalidatePath(\"/dashboard/inventory/vendors\");\n\t});\n}\n\n/**\n * Get a single vendor by ID\n */\nasync function getVendor(vendorId: string): Promise<ActionResult<any>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.single();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You must be part of a company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\tconst { data: vendor, error } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"*\")\n\t\t\t.eq(\"id\", vendorId)\n\t\t\t.eq(\"company_id\", teamMember.company_id)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to fetch vendor\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tassertExists(vendor, \"Vendor\");\n\n\t\treturn vendor;\n\t});\n}\n\n/**\n * List all vendors for the company\n */\nasync function listVendors(options?: {\n\tstatus?: \"active\" | \"inactive\";\n\tcategory?: string;\n\tsearch?: string;\n}): Promise<ActionResult<any[]>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.single();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You must be part of a company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\tlet query = supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"*\")\n\t\t\t.eq(\"company_id\", teamMember.company_id)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.order(\"name\", { ascending: true });\n\n\t\tif (options?.status) {\n\t\t\tquery = query.eq(\"status\", options.status);\n\t\t}\n\n\t\tif (options?.category) {\n\t\t\tquery = query.eq(\"category\", options.category);\n\t\t}\n\n\t\tif (options?.search) {\n\t\t\tquery = query.or(\n\t\t\t\t`name.ilike.%${options.search}%,display_name.ilike.%${options.search}%,vendor_number.ilike.%${options.search}%,email.ilike.%${options.search}%`,\n\t\t\t);\n\t\t}\n\n\t\tconst { data: vendors, error } = await query;\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to fetch vendors\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\treturn vendors || [];\n\t});\n}\n\n/**\n * Search vendors by query string\n */\nexport async function searchVendors(\n\tquery: string,\n): Promise<ActionResult<any[]>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\t// Use the same approach as searchCustomers\n\t\tconst { getActiveCompanyId } = await import(\"@/lib/auth/company-context\");\n\t\tconst activeCompanyId = await getActiveCompanyId();\n\t\t\n\t\tif (!activeCompanyId) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"No active company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Verify user has access to the active company\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.maybeSingle();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You don't have access to this company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\tconst { data: vendors, error } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"id, name, display_name, vendor_number, email, phone, status\")\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.or(\n\t\t\t\t`name.ilike.%${query}%,display_name.ilike.%${query}%,vendor_number.ilike.%${query}%,email.ilike.%${query}%`,\n\t\t\t)\n\t\t\t.limit(20);\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to search vendors\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\treturn vendors || [];\n\t});\n}\n\n/**\n * Link a purchase order to a vendor\n */\nexport async function linkPurchaseOrderToVendor(\n\tpurchaseOrderId: string,\n\tvendorId: string,\n): Promise<ActionResult<void>> {\n\treturn withErrorHandling(async () => {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Database connection failed\",\n\t\t\t\tERROR_CODES.DB_CONNECTION_ERROR,\n\t\t\t);\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tassertAuthenticated(user?.id);\n\n\t\tconst { data: teamMember } = await supabase\n\t\t\t.from(\"company_memberships\")\n\t\t\t.select(\"company_id\")\n\t\t\t.eq(\"user_id\", user.id)\n\t\t\t.eq(\"status\", \"active\")\n\t\t\t.single();\n\n\t\tif (!teamMember?.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"You must be part of a company\",\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Verify purchase order exists and belongs to company\n\t\tconst { data: po } = await supabase\n\t\t\t.from(\"purchase_orders\")\n\t\t\t.select(\"id, company_id\")\n\t\t\t.eq(\"id\", purchaseOrderId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tassertExists(po, \"Purchase Order\");\n\n\t\tif (po.company_id !== teamMember.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\tERROR_MESSAGES.forbidden(\"purchase order\"),\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Verify vendor exists and belongs to company\n\t\tconst { data: vendor } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.select(\"id, company_id\")\n\t\t\t.eq(\"id\", vendorId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.single();\n\n\t\tassertExists(vendor, \"Vendor\");\n\n\t\tif (vendor.company_id !== teamMember.company_id) {\n\t\t\tthrow new ActionError(\n\t\t\t\tERROR_MESSAGES.forbidden(\"vendor\"),\n\t\t\t\tERROR_CODES.AUTH_FORBIDDEN,\n\t\t\t\t403,\n\t\t\t);\n\t\t}\n\n\t\t// Link purchase order to vendor\n\t\tconst { error } = await supabase\n\t\t\t.from(\"purchase_orders\")\n\t\t\t.update({ vendor_id: vendorId })\n\t\t\t.eq(\"id\", purchaseOrderId);\n\n\t\tif (error) {\n\t\t\tthrow new ActionError(\n\t\t\t\t\"Failed to link purchase order\",\n\t\t\t\tERROR_CODES.DB_QUERY_ERROR,\n\t\t\t);\n\t\t}\n\n\t\trevalidatePath(\"/dashboard/work/vendors\");\n\t\trevalidatePath(`/dashboard/work/vendors/${vendorId}`);\n\t\trevalidatePath(\"/dashboard/work/purchase-orders\");\n\t\trevalidatePath(`/dashboard/work/purchase-orders/${purchaseOrderId}`);\n\t});\n}\n\n/**\n * Archive a vendor (soft delete)\n */\nexport async function archiveVendor(\n\tvendorId: string,\n): Promise<{ success: boolean; error?: string }> {\n\ttry {\n\t\tconst supabase = await createClient();\n\t\tif (!supabase) {\n\t\t\treturn { success: false, error: \"Database connection not available\" };\n\t\t}\n\n\t\tconst {\n\t\t\tdata: { user },\n\t\t} = await supabase.auth.getUser();\n\t\tif (!user) {\n\t\t\treturn { success: false, error: \"Unauthorized\" };\n\t\t}\n\n\t\tconst { error } = await supabase\n\t\t\t.from(\"vendors\")\n\t\t\t.update({\n\t\t\t\tdeleted_at: new Date().toISOString(),\n\t\t\t})\n\t\t\t.eq(\"id\", vendorId);\n\n\t\tif (error) {\n\t\t\treturn { success: false, error: error.message };\n\t\t}\n\n\t\trevalidatePath(\"/dashboard/work/vendors\");\n\t\treturn { success: true };\n\t} catch (_error) {\n\t\treturn { success: false, error: \"Failed to archive vendor\" };\n\t}\n}\n"],"names":[],"mappings":"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"}