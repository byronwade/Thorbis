module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},997868,a=>{a.n(a.i(884849))},592581,a=>{a.n(a.i(596565))},134005,a=>{a.n(a.i(977930))},565165,a=>{a.n(a.i(728209))},147941,a=>{a.n(a.i(484103))},304434,a=>{a.n(a.i(632684))},407521,a=>{a.n(a.i(693094))},797797,a=>{a.n(a.i(977207))},290022,a=>{a.n(a.i(362735))},729157,a=>{a.n(a.i(470009))},543474,a=>{"use strict";var b=a.i(429969);let c=a=>{let b=a.replace(/^([A-Z])|[\s-_]+(\w)/g,(a,b,c)=>c?c.toUpperCase():b.toLowerCase());return b.charAt(0).toUpperCase()+b.slice(1)},d=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var e={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let f=(0,b.forwardRef)(({color:a="currentColor",size:c=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...e,width:c,height:c,stroke:a,strokeWidth:g?24*Number(f)/Number(c):f,className:d("lucide",h),...!i&&!(a=>{for(let b in a)if(b.startsWith("aria-")||"role"===b||"title"===b)return!0})(k)&&{"aria-hidden":"true"},...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),g=(a,e)=>{let g=(0,b.forwardRef)(({className:g,...h},i)=>(0,b.createElement)(f,{ref:i,iconNode:e,className:d(`lucide-${c(a).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${a}`,g),...h}));return g.displayName=c(a),g};a.s(["default",()=>g],543474)},174010,a=>{"use strict";a.i(730154),a.s([])},150644,a=>{"use strict";a.i(730154),a.s([])},481136,a=>{"use strict";let b=(0,a.i(543474).default)("users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]]);a.s(["Users",()=>b],481136)},549121,a=>{"use strict";a.i(730154);var b=a.i(563914),c=a.i(369637),d=a.i(861107),e=a.i(475976),f=a.i(836326),g=a.i(726954),h=a.i(236028),i=a.i(376977),j=a.i(868553),k=a.i(36705),l=a.i(396149),m=a.i(705991),n=a.i(102193),o=a.i(293107),p=a.i(525708),q=a.i(280558),r=a.i(27632),s=a.i(523762),t=a.i(533742),u=a.i(777394),v=a.i(30104),w=a.i(588159),x=a.i(851374),y=a.i(591888),z=a.i(968073),A=a.i(925834),B=a.i(946108),C=a.i(561203),D=a.i(228811),E=a.i(950872),F=a.i(297053),G=a.i(758289),H=a.i(919187),I=a.i(463683),J=a.i(274749),K=a.i(420235),L=a.i(90965),M=a.i(468335),N=a.i(571631),O=a.i(439724),P=a.i(109483),Q=a.i(709027),R=a.i(643953),S=a.i(920224),T=a.i(776419),U=a.i(920334),V=a.i(838239),W=a.i(490199),X=a.i(38825),Y=a.i(465296),Z=a.i(409604),$=a.i(892054),_=a.i(233387),aa=a.i(438468),ab=a.i(852495);a.i(422792);var ac=a.i(299049),ad=a.i(474235),ae=a.i(359004),af=a.i(171288);a.s(["Alert",()=>c.Alert,"AlertDescription",()=>c.AlertDescription,"AlertTitle",()=>c.AlertTitle,"Badge",()=>h.Badge,"Breadcrumb",()=>i.Breadcrumb,"BreadcrumbItem",()=>i.BreadcrumbItem,"BreadcrumbLink",()=>i.BreadcrumbLink,"BreadcrumbList",()=>i.BreadcrumbList,"BreadcrumbPage",()=>i.BreadcrumbPage,"BreadcrumbSeparator",()=>i.BreadcrumbSeparator,"Button",()=>j.Button,"ButtonGroup",()=>k.ButtonGroup,"ButtonGroupText",()=>k.ButtonGroupText,"Card",()=>m.Card,"CardContent",()=>m.CardContent,"CardDescription",()=>m.CardDescription,"CardFooter",()=>m.CardFooter,"CardHeader",()=>m.CardHeader,"CardListSkeleton",()=>Q.CardListSkeleton,"CardTitle",()=>m.CardTitle,"ChartSkeleton",()=>Q.ChartSkeleton,"ComingSoonShell",()=>q.ComingSoonShell,"DashboardSkeleton",()=>Q.DashboardSkeleton,"DataTableListSkeleton",()=>Q.DataTableListSkeleton,"FormSkeleton",()=>Q.FormSkeleton,"GenericStatusBadge",()=>y.GenericStatusBadge,"Input",()=>A.Input,"KPICardSkeleton",()=>Q.KPICardSkeleton,"PageHeaderSkeleton",()=>Q.PageHeaderSkeleton,"RowActionsDropdown",()=>J.RowActionsDropdown,"Skeleton",()=>P.Skeleton,"StatsCardsSkeleton",()=>S.StatsCardsSkeleton,"TableSkeleton",()=>Q.TableSkeleton,"Textarea",()=>X.Textarea,"WorkDetailSkeleton",()=>Q.WorkDetailSkeleton,"WorkflowTimeline",()=>af.WorkflowTimeline,"buttonVariants",()=>j.buttonVariants,"cn",()=>ad.cn]),a.j(b),a.j(d),a.j(e),a.j(f),a.j(g),a.j(l),a.j(n),a.j(o),a.j(p),a.j(r),a.j(s),a.j(t),a.j(u),a.j(v),a.j(w),a.j(x),a.j(z),a.j(B),a.j(C),a.j(D),a.j(E),a.j(F),a.j(G),a.j(H),a.j(I),a.j(K),a.j(L),a.j(M),a.j(N),a.j(O),a.j(R),a.j(T),a.j(U),a.j(V),a.j(W),a.j(Y),a.j(Z),a.j($),a.j(_),a.j(aa),a.j(ab),a.j(ac),a.j(ae)},52502,a=>{"use strict";let b=(0,a.i(543474).default)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);a.s(["Shield",()=>b],52502)},142969,a=>{"use strict";let b=(0,a.i(543474).default)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]]);a.s(["TrendingUp",()=>b],142969)},862875,a=>{"use strict";let b=(0,a.i(543474).default)("dollar-sign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);a.s(["DollarSign",()=>b],862875)},634332,a=>{"use strict";let b=(0,a.i(543474).default)("triangle-alert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);a.s(["AlertTriangle",()=>b],634332)},856222,a=>{a.n(a.i(371029))},842417,a=>{a.n(a.i(213663))},502549,236433,a=>{"use strict";a.i(730154),a.s([],502549),a.i(502549);var b=a.i(549121);a.s([],236433),a.j(b,236433)},584220,429007,a=>{"use strict";a.i(730154),a.s([],584220),a.i(584220);var b=a.i(549121);a.s([],429007),a.j(b,429007)},752695,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call ExportButton() from the server but ExportButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/reports/export-button.tsx <module evaluation>","ExportButton");a.s(["ExportButton",0,b])},689828,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call ExportButton() from the server but ExportButton is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/reports/export-button.tsx","ExportButton");a.s(["ExportButton",0,b])},519741,a=>{"use strict";a.i(752695);var b=a.i(689828);a.n(b)},730616,a=>{"use strict";var b=a.i(504348),c=a.i(429969),d=a.i(634332),e=a.i(862875),f=a.i(52502),g=a.i(142969);let h=(0,a.i(543474).default)("user-plus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);var i=a.i(481136),j=a.i(519741);a.i(150644);var k=a.i(236028);a.i(174010);var l=a.i(705991);a.i(502549);var m=a.i(236433);a.i(584220);var n=a.i(429007);a.i(467361);var o=a.i(445074),p=a.i(54214);function q(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(a)}function r(a){return`${a.toFixed(1)}%`}async function s(){let a=await (0,o.getActiveCompanyId)();if(!a)return(0,b.jsx)("div",{className:"flex min-h-[400px] items-center justify-center",children:(0,b.jsx)("p",{className:"text-muted-foreground",children:"Please select a company to view reports"})});let c=await (0,p.getCustomerAnalytics)(a,365);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:"Customer Analytics"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Retention, segmentation, and lifetime value analysis"})]}),(0,b.jsx)(j.ExportButton,{reportType:"customers",days:365})]}),(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsx)(t,{title:"Total Customers",value:c.summary.totalCustomers.toString(),subtitle:`${c.summary.repeatCustomers} repeat`,icon:(0,b.jsx)(i.Users,{className:"size-4 text-blue-500"})}),(0,b.jsx)(t,{title:"New Customers",value:c.summary.newCustomers.toString(),subtitle:"Last 30 days",icon:(0,b.jsx)(h,{className:"size-4 text-green-500"}),trend:"positive"}),(0,b.jsx)(t,{title:"Retention Rate",value:r(c.summary.retentionRate),subtitle:`${c.summary.churnedCustomers} churned`,icon:(0,b.jsx)(f.Shield,{className:"size-4 text-emerald-500"}),trend:c.summary.retentionRate>=90?"positive":c.summary.retentionRate>=80?"neutral":"negative"}),(0,b.jsx)(t,{title:"Avg Lifetime Value",value:q(c.summary.avgLifetimeValue),icon:(0,b.jsx)(e.DollarSign,{className:"size-4 text-purple-500"})})]}),(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(d.AlertTriangle,{className:"size-5"}),"Churn Risk Distribution"]}),(0,b.jsx)(l.CardDescription,{children:"Customer health by risk level"})]}),(0,b.jsx)(l.CardContent,{children:(0,b.jsxs)("div",{className:"grid gap-6 md:grid-cols-3",children:[(0,b.jsx)(u,{label:"Low Risk",count:c.riskDistribution.low,total:c.summary.totalCustomers,color:"bg-green-500",description:"Healthy customers with regular engagement"}),(0,b.jsx)(u,{label:"Medium Risk",count:c.riskDistribution.medium,total:c.summary.totalCustomers,color:"bg-yellow-500",description:"Customers showing some disengagement"}),(0,b.jsx)(u,{label:"High Risk",count:c.riskDistribution.high,total:c.summary.totalCustomers,color:"bg-red-500",description:"Customers at risk of churning"})]})})]}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-2",children:[(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Revenue by Segment"}),(0,b.jsx)(l.CardDescription,{children:"Customer type breakdown"})]}),(0,b.jsx)(l.CardContent,{children:0===c.bySegment.length?(0,b.jsx)("p",{className:"text-muted-foreground py-8 text-center",children:"No segment data available"}):(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Segment"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Customers"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Revenue"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Avg Ticket"})]})}),(0,b.jsx)(n.TableBody,{children:c.bySegment.map(a=>(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"font-medium capitalize",children:a.segment}),(0,b.jsx)(n.TableCell,{className:"text-right",children:a.count}),(0,b.jsx)(n.TableCell,{className:"text-right",children:q(a.revenue)}),(0,b.jsx)(n.TableCell,{className:"text-right",children:q(a.avgTicket)})]},a.segment))})]})})]}),(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsxs)(l.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(g.TrendingUp,{className:"size-5"}),"Acquisition Trends"]}),(0,b.jsx)(l.CardDescription,{children:"New customers by month"})]}),(0,b.jsx)(l.CardContent,{children:0===c.acquisitionTrend.length?(0,b.jsx)("p",{className:"text-muted-foreground py-8 text-center",children:"No trend data available"}):(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Month"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"New"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Churned"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Net"})]})}),(0,b.jsx)(n.TableBody,{children:c.acquisitionTrend.slice(-12).map(a=>(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{className:"font-medium",children:new Date(a.month+"-01").toLocaleDateString("en-US",{month:"short",year:"numeric"})}),(0,b.jsxs)(n.TableCell,{className:"text-right text-green-600",children:["+",a.newCustomers]}),(0,b.jsxs)(n.TableCell,{className:"text-right text-red-600",children:["-",a.churned]}),(0,b.jsx)(n.TableCell,{className:"text-right",children:(0,b.jsxs)("span",{className:a.net>=0?"text-green-600 font-medium":"text-red-600 font-medium",children:[a.net>=0?"+":"",a.net]})})]},a.month))})]})})]})]}),(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{children:[(0,b.jsx)(l.CardTitle,{children:"Top Customers by Revenue"}),(0,b.jsx)(l.CardDescription,{children:"Your most valuable customers this year"})]}),(0,b.jsx)(l.CardContent,{children:0===c.topCustomers.length?(0,b.jsx)("p",{className:"text-muted-foreground py-8 text-center",children:"No customer data available"}):(0,b.jsxs)(n.Table,{children:[(0,b.jsx)(n.TableHeader,{children:(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableHead,{children:"Customer"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Revenue"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Jobs"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Lifetime Value"}),(0,b.jsx)(n.TableHead,{className:"text-right",children:"Last Service"})]})}),(0,b.jsx)(n.TableBody,{children:c.topCustomers.map((a,c)=>{var d;return(0,b.jsxs)(n.TableRow,{children:[(0,b.jsx)(n.TableCell,{children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[c<3&&(0,b.jsxs)(k.Badge,{variant:0===c?"default":"secondary",className:"text-xs",children:["#",c+1]}),(0,b.jsx)("span",{className:"font-medium",children:a.name})]})}),(0,b.jsx)(n.TableCell,{className:"text-right",children:q(a.totalRevenue)}),(0,b.jsx)(n.TableCell,{className:"text-right",children:a.jobCount}),(0,b.jsx)(n.TableCell,{className:"text-right",children:q(a.lifetimeValue)}),(0,b.jsx)(n.TableCell,{className:"text-right text-muted-foreground",children:(d=a.lastServiceDate)?new Date(d).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):"Never"})]},a.id)})})]})})]})]})}function t({title:a,value:c,subtitle:d,icon:e,trend:f}){return(0,b.jsxs)(l.Card,{children:[(0,b.jsxs)(l.CardHeader,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,b.jsx)(l.CardTitle,{className:"text-sm font-medium",children:a}),e]}),(0,b.jsxs)(l.CardContent,{children:[(0,b.jsx)("div",{className:"text-2xl font-bold",children:c}),d&&(0,b.jsx)("p",{className:`text-xs ${"positive"===f?"text-green-600":"negative"===f?"text-red-600":"text-muted-foreground"}`,children:d})]})]})}function u({label:a,count:c,total:d,color:e,description:f}){let g=d>0?c/d*100:0;return(0,b.jsxs)("div",{className:"space-y-3 p-4 rounded-lg border bg-card/50",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{className:"font-medium",children:a}),(0,b.jsx)(k.Badge,{variant:"outline",children:c})]}),(0,b.jsx)(m.Progress,{value:g,className:`h-2 [&>div]:${e}`}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:f}),(0,b.jsxs)("p",{className:"text-sm font-semibold",children:[r(g)," of customers"]})]})}function v(){return(0,b.jsxs)("div",{className:"relative space-y-10 py-8 md:py-12",children:[(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("div",{className:"bg-muted h-9 w-32 animate-pulse rounded-full"})}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("div",{className:"bg-muted size-24 animate-pulse rounded-full"})}),(0,b.jsxs)("div",{className:"mx-auto max-w-3xl space-y-3 text-center",children:[(0,b.jsx)("div",{className:"bg-muted mx-auto h-12 w-96 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted mx-auto h-6 w-full max-w-2xl animate-pulse rounded"})]})]})}function w(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(v,{}),children:(0,b.jsx)(s,{})})}a.s(["default",()=>w],730616)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__70f5dcab._.js.map