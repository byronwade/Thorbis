module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},997868,a=>{a.n(a.i(884849))},592581,a=>{a.n(a.i(596565))},134005,a=>{a.n(a.i(977930))},565165,a=>{a.n(a.i(728209))},147941,a=>{a.n(a.i(484103))},304434,a=>{a.n(a.i(632684))},407521,a=>{a.n(a.i(693094))},797797,a=>{a.n(a.i(977207))},290022,a=>{a.n(a.i(362735))},729157,a=>{a.n(a.i(470009))},468729,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call WorkDataView() from the server but WorkDataView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/work-data-view.tsx <module evaluation>","WorkDataView");a.s(["WorkDataView",0,b])},750692,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call WorkDataView() from the server but WorkDataView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/work-data-view.tsx","WorkDataView");a.s(["WorkDataView",0,b])},310669,a=>{"use strict";a.i(468729);var b=a.i(750692);a.n(b)},87409,a=>{a.n(a.i(19130))},691264,a=>{a.n(a.i(135502))},457221,a=>{a.n(a.i(245204))},490775,a=>{"use strict";var b=a.i(429969);a.i(467361);var c=a.i(445074),d=a.i(933427);async function e(a,b=50,f,g,h="display_name",i="ASC"){let j=await (0,c.getActiveCompanyId)();if(!j)return{customers:[],totalCount:0};let k=await (0,d.createServiceSupabaseClient)();if(!k)throw Error("Supabase client not configured");let l=(Math.max(a,1)-1)*b,{data:m,error:n}=await k.rpc("get_enriched_customers_rpc",{p_company_id:j,p_limit:b,p_offset:l,p_search_query:f||null,p_status_filter:g||null,p_order_by:h,p_order_direction:i});if(n)throw Error(`Failed to load customers: ${n.message}`);let{count:o}=await k.from("customers").select("*",{count:"exact",head:!0}).eq("company_id",j).is("deleted_at",null);return{customers:m??[],totalCount:o??0}}(0,b.cache)(async()=>{let a=await (0,c.getActiveCompanyId)();if(!a)return null;let b=await (0,d.createServiceSupabaseClient)();if(!b)throw Error("Supabase client not configured");let{data:e,error:f,count:g}=await b.from("customers").select("status, archived_at, total_revenue",{count:"exact"}).eq("company_id",a).is("deleted_at",null).limit(5e4);if(f)throw Error(`Failed to load customer stats: ${f.message}`);let h={active:0,inactive:0,prospect:0},i=0;for(let a of e??[]){if(!a.archived_at){let b=a.status||"prospect";b in h&&h[b]++}i+=a.total_revenue||0}return{total:g??0,active:h.active,inactive:h.inactive,prospect:h.prospect,totalRevenueCents:i}});let f=(0,b.cache)(async(a,b)=>{let c=await (0,d.createServiceSupabaseClient)();if(!c)throw Error("Supabase client not configured");let{data:e,error:f}=await c.rpc("get_customer_complete",{p_customer_id:a,p_company_id:b});return f?(console.error("Error fetching customer:",f),null):e?.[0]?.customer_data||null});a.s(["CUSTOMERS_PAGE_SIZE",0,50,"getCustomerComplete",0,f,"getCustomersPageData",()=>e])},299480,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call CustomersKanban() from the server but CustomersKanban is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/customers/customers-kanban.tsx <module evaluation>","CustomersKanban");a.s(["CustomersKanban",0,b])},978465,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call CustomersKanban() from the server but CustomersKanban is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/customers/customers-kanban.tsx","CustomersKanban");a.s(["CustomersKanban",0,b])},366575,a=>{"use strict";a.i(299480);var b=a.i(978465);a.n(b)},552302,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call CustomersTable() from the server but CustomersTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/customers/customers-table.tsx <module evaluation>","CustomersTable");a.s(["CustomersTable",0,b])},700787,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call CustomersTable() from the server but CustomersTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/customers/customers-table.tsx","CustomersTable");a.s(["CustomersTable",0,b])},624089,a=>{"use strict";a.i(552302);var b=a.i(700787);a.n(b)},630862,a=>{"use strict";var b=a.i(504348),c=a.i(429969);a.i(692167);var d=a.i(852596),e=a.i(366575),f=a.i(624089),g=a.i(310669),h=a.i(490775);async function i({searchParams:a}){let c=Number(a?.page)||1,{customers:i,totalCount:j}=await (0,h.getCustomersPageData)(c,h.CUSTOMERS_PAGE_SIZE);if(!i)return(0,d.notFound)();let k=i.map(a=>({id:a.id,name:a.display_name,contact:`${a.first_name} ${a.last_name}`,email:a.email,phone:a.phone,address:a.address,city:a.city,state:a.state,zipCode:a.zip_code,status:"active"===a.status?"active":"inactive"===a.status?"inactive":"prospect",lastService:a.last_job_date?new Date(a.last_job_date).toLocaleDateString():"None",nextService:"TBD",totalValue:a.total_revenue||0,archived_at:a.archived_at,deleted_at:a.deleted_at}));return(0,b.jsx)(g.WorkDataView,{kanban:(0,b.jsx)(e.CustomersKanban,{customers:k}),section:"customers",table:(0,b.jsx)(f.CustomersTable,{customers:k,itemsPerPage:h.CUSTOMERS_PAGE_SIZE,totalCount:j,currentPage:c})})}a.i(250202);var j=a.i(709027);function k(){return(0,b.jsx)(j.DataTableListSkeleton,{})}async function l({searchParams:a}){let d=await a;return(0,b.jsx)(b.Fragment,{children:(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(k,{}),children:(0,b.jsx)(i,{searchParams:d})})})}a.s(["default",()=>l],630862)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__38bcb8eb._.js.map