module.exports=[726458,a=>{"use strict";var b=a.i(861467),c=a.i(783281);a.i(857463);var d=a.i(161367),e=a.i(77323),f=a.i(337241),g=a.i(563491),h=a.i(157282),i=a.i(827033),j=a.i(226559);a.i(129112);var k=a.i(256003);let l=(0,j.default)(async()=>{},{loadableGenerated:{modules:[915024]},loading:()=>(0,b.jsxs)("div",{className:"flex h-full w-full flex-col gap-4 p-4",children:[(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(k.Skeleton,{className:"h-10 w-32"}),(0,b.jsx)(k.Skeleton,{className:"h-10 w-32"}),(0,b.jsx)(k.Skeleton,{className:"h-10 flex-1"})]}),(0,b.jsx)(k.Skeleton,{className:"h-full w-full"})]}),ssr:!1});function m(){return(0,b.jsx)(l,{})}let n=(0,j.default)(async()=>{},{loadableGenerated:{modules:[823591]},loading:()=>(0,b.jsx)("div",{className:"flex h-full w-full gap-4 p-4",children:Array.from({length:7}).map((a,c)=>(0,b.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,b.jsx)(k.Skeleton,{className:"h-8 w-full"}),(0,b.jsx)(k.Skeleton,{className:"h-32 w-full"}),(0,b.jsx)(k.Skeleton,{className:"h-32 w-full"})]},c))}),ssr:!1});function o(){return(0,b.jsx)(n,{})}var p=a.i(773608),q=a.i(165990),r=a.i(766153),s=a.i(779184),t=a.i(337850),u=a.i(156916);a.i(445255);var v=a.i(18170),w=a.i(587969),x=a.i(300298);a.i(708402);var y=a.i(442458);a.i(799390);var z=a.i(985943);function A({isOpen:a,onClose:d,currentDate:e,onDateSelect:f}){let[g,h]=(0,c.useState)(e),i=()=>{h(e),d()};return(0,b.jsx)(z.Sheet,{open:a,onOpenChange:i,children:(0,b.jsxs)(z.SheetContent,{side:"bottom",className:"h-[500px] flex flex-col",children:[(0,b.jsx)(z.SheetHeader,{children:(0,b.jsxs)(z.SheetTitle,{className:"flex items-center justify-between",children:[(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(w.Calendar,{className:"h-5 w-5"}),"Select Date"]}),(0,b.jsxs)(v.Button,{className:"h-8 w-8 p-0",onClick:i,size:"icon",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]})}),(0,b.jsx)("div",{className:"flex-1 flex items-center justify-center overflow-y-auto py-4",children:(0,b.jsx)(y.Calendar,{className:"rounded-md border",mode:"single",onSelect:a=>{a&&h(a)},selected:g})}),(0,b.jsx)("div",{className:"shrink-0 space-y-2 border-t pt-4",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(v.Button,{className:"flex-1",onClick:()=>{let a=new Date;h(a),f(a),d()},size:"default",variant:"outline",children:"Today"}),(0,b.jsxs)(v.Button,{className:"flex-1",onClick:()=>{f(g),d()},size:"default",children:["Go to ",(0,p.format)(g,"MMM d, yyyy")]})]})})]})})}var B=a.i(50900),C=a.i(101482),D=a.i(700760);let E={no_jobs:{icon:w.Calendar,title:"No jobs scheduled",description:"Get started by scheduling your first appointment",defaultActionLabel:"Schedule Appointment"},no_results:{icon:B.Search,title:"No jobs found",description:"Try adjusting your search or filters",defaultActionLabel:"Clear Filters"},no_unassigned:{icon:C.Users,title:"All jobs assigned",description:"Great! All jobs have been assigned to technicians",defaultActionLabel:"View Schedule"},no_jobs_today:{icon:w.Calendar,title:"No jobs today",description:"This technician has no scheduled jobs for today",defaultActionLabel:"View Full Schedule"}};function F({variant:a,onAction:c,actionLabel:d,className:e}){let f=E[a],g=f.icon,h=d||f.defaultActionLabel;return(0,b.jsxs)("div",{className:(0,D.cn)("flex flex-col items-center justify-center gap-4 px-6 py-12 text-center",e),children:[(0,b.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:(0,b.jsx)(g,{className:"h-8 w-8 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold",children:f.title}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm",children:f.description})]}),c&&(0,b.jsx)(v.Button,{className:"mt-2",onClick:c,children:h})]})}var G=a.i(90083),H=a.i(96250),I=a.i(624126),J=a.i(824124),K=a.i(699756),L=a.i(217547),M=a.i(339632),N=a.i(320091);a.i(516775);var O=a.i(560272);a.i(288007);var P=a.i(986990),Q=a.i(939968);function R(a,b,c){let d=(0,Q.toDate)(a,c?.in);return d.setHours(b),d}function S(a,b,c){let d=(0,Q.toDate)(a,c?.in);return d.setMinutes(b),d}var T=a.i(42881);a.i(458393);var U=a.i(82012);a.i(413309);var V=a.i(54210);let W=(()=>{let a=[];for(let b=0;b<24;b++)for(let c=0;c<60;c+=30){let d=new Date;d.setHours(b,c,0,0),a.push({label:(0,p.format)(d,"h:mm a"),time:`${String(b).padStart(2,"0")}:${String(c).padStart(2,"0")}`})}return a})(),X=W.filter(a=>{let[b]=a.time.split(":").map(Number);return b>=6&&b<18});function Y({job:a,isOpen:d,onClose:e,onConfirm:f}){let[g,h]=(0,c.useState)(a?.scheduled_start?new Date(a.scheduled_start):new Date),[i,j]=(0,c.useState)(a?.scheduled_start?(0,p.format)(new Date(a.scheduled_start),"HH:mm"):"09:00"),[k,l]=(0,c.useState)(!1),m=(0,c.useMemo)(()=>{if(a?.scheduled_start&&a?.scheduled_end){let b=new Date(a.scheduled_start);return(new Date(a.scheduled_end).getTime()-b.getTime())/36e5}let b=a?.title?.toLowerCase()||"";return b.includes("emergency")?3:b.includes("install")?4:b.includes("inspection")?1:(b.includes("maintenance"),2)},[a]),n=(0,c.useMemo)(()=>{if(!g||!i)return null;let[a,b]=i.split(":").map(Number),c=(0,T.startOfDay)(g);R(c,a),S(c,b);let d=new Date(c);return d.setHours(c.getHours()+Math.floor(m)),d.setMinutes(c.getMinutes()+m%1*60),d},[g,i,m]);if(!a)return null;let o=k?W:X;return(0,b.jsxs)(b.Fragment,{children:[d&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:e}),(0,b.jsxs)("div",{className:(0,D.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",d?"translate-y-0":"translate-y-full"),style:{maxHeight:"90vh"},children:[(0,b.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,b.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Reschedule Appointment"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.customer?.name||"Unknown Customer"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Current:"," ",a.scheduled_start?(0,p.format)(new Date(a.scheduled_start),"MMM d, h:mm a"):"Not scheduled"]})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:e,size:"icon",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,b.jsx)(V.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(90vh - 240px)"},children:(0,b.jsxs)("div",{className:"p-4 space-y-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(U.Label,{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[(0,b.jsx)(w.Calendar,{className:"h-4 w-4"}),"Select Date"]}),(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)(y.Calendar,{disabled:a=>a<(0,T.startOfDay)(new Date),mode:"single",onSelect:h,selected:g})})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsxs)(U.Label,{className:"text-sm font-medium flex items-center gap-2",children:[(0,b.jsx)(I.Clock,{className:"h-4 w-4"}),"Select Time"]}),(0,b.jsx)(v.Button,{onClick:()=>l(!k),size:"sm",variant:"ghost",children:k?"Business Hours":"All Hours"})]}),(0,b.jsx)("div",{className:"grid grid-cols-3 gap-2",children:o.map(a=>(0,b.jsx)(v.Button,{className:(0,D.cn)("h-12 text-sm font-medium",i===a.time&&"bg-primary text-primary-foreground hover:bg-primary/90"),onClick:()=>j(a.time),variant:i===a.time?"default":"outline",children:a.label},a.time))})]}),g&&i&&n&&(0,b.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"New Schedule Preview"}),(0,b.jsxs)("div",{className:"space-y-1 text-sm text-muted-foreground",children:[(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Date:"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:(0,p.format)(g,"EEEE, MMMM d, yyyy")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Start:"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:(0,p.format)(R(S(g,parseInt(i.split(":")[1])),parseInt(i.split(":")[0])),"h:mm a")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"End:"}),(0,b.jsx)("span",{className:"font-medium text-foreground",children:(0,p.format)(n,"h:mm a")})]}),(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("span",{children:"Duration:"}),(0,b.jsxs)("span",{className:"font-medium text-foreground",children:[m,"h"]})]})]})]})]})}),(0,b.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(v.Button,{className:"flex-1 h-12",onClick:e,size:"lg",variant:"outline",children:"Cancel"}),(0,b.jsx)(v.Button,{className:"flex-1 h-12",disabled:!g||!i,onClick:()=>{if(!a||!g||!i||!n)return;let[b,c]=i.split(":").map(Number),d=(0,T.startOfDay)(g);R(d,b),S(d,c),f(a,d,n),e()},size:"lg",variant:"default",children:"Confirm Reschedule"})]})})]})]})}var Z=a.i(253520),$=a.i(976803),_=a.i(240716);let aa=[{id:"unscheduled",label:"Unscheduled",icon:I.Clock,color:"bg-gray-500",borderColor:"border-gray-500",description:"No date/time assigned"},{id:"scheduled",label:"Scheduled",icon:w.Calendar,color:"bg-blue-500",borderColor:"border-blue-500",description:"Date and time confirmed"},{id:"dispatched",label:"Dispatched",icon:$.Truck,color:"bg-sky-500",borderColor:"border-sky-500",description:"Technician on the way"},{id:"arrived",label:"Arrived",icon:J.MapPin,color:"bg-emerald-400",borderColor:"border-emerald-400",description:"Technician at location"},{id:"in_progress",label:"In Progress",icon:K.Navigation,color:"bg-amber-500 animate-pulse",borderColor:"border-amber-500",description:"Work actively underway"},{id:"closed",label:"Closed",icon:Z.CheckCircle,color:"bg-emerald-600",borderColor:"border-emerald-600",description:"Work completed, awaiting review"},{id:"completed",label:"Completed",icon:H.CheckCircle2,color:"bg-green-700",borderColor:"border-green-700",description:"Fully complete and approved"},{id:"cancelled",label:"Cancelled",icon:_.XCircle,color:"bg-red-500",borderColor:"border-red-500",description:"Job cancelled or abandoned"}];function ab({job:a,isOpen:d,onClose:e,onConfirm:f}){let[g,h]=(0,c.useState)(a?.status?.toLowerCase()||null),i=a?.status?.toLowerCase()||"unscheduled",j=(a=>{switch(a?.toLowerCase()||"unscheduled"){case"unscheduled":case"cancelled":default:return["scheduled"];case"scheduled":return["dispatched","cancelled"];case"dispatched":return["arrived","scheduled","cancelled"];case"arrived":return["in_progress","dispatched","cancelled"];case"in_progress":return["closed","arrived"];case"closed":return["completed","in_progress"];case"completed":return[]}})(i);return a?(0,b.jsxs)(b.Fragment,{children:[d&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:e}),(0,b.jsxs)("div",{className:(0,D.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",d?"translate-y-0":"translate-y-full"),style:{maxHeight:"85vh"},children:[(0,b.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,b.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Change Status"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.customer?.name||"Unknown Customer"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:["Current: ",i.replace(/_/g," ")]})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:e,size:"icon",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,b.jsx)(V.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(85vh - 220px)"},children:(0,b.jsxs)("div",{className:"p-4 space-y-3",children:[j.length>0&&(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",children:"Suggested Next Steps"})}),aa.map(a=>{let c=g===a.id,d=i===a.id,e=j.includes(a.id),f=e&&!d,k=d||!e&&j.length>0,l=a.icon;return(0,b.jsxs)("button",{className:(0,D.cn)("flex w-full items-start gap-3 rounded-lg border-2 p-4 transition-all text-left",k?"opacity-50 cursor-not-allowed":"hover:border-primary/50 active:scale-98",c&&!k&&"border-primary bg-primary/5",f&&!c&&"border-green-500/30 bg-green-50 dark:bg-green-950/20",d&&"border-muted-foreground bg-muted",!c&&!f&&!d&&"border-border"),disabled:k,onClick:()=>!k&&h(a.id),type:"button",children:[(0,b.jsx)("div",{className:(0,D.cn)("flex h-12 w-12 shrink-0 items-center justify-center rounded-full",a.color,k&&"opacity-50"),children:(0,b.jsx)(l,{className:"h-6 w-6 text-white"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("p",{className:"text-base font-semibold",children:a.label}),d&&(0,b.jsx)("span",{className:"text-[10px] px-2 py-0.5 bg-muted-foreground/20 rounded-full font-medium",children:"Current"}),f&&!c&&(0,b.jsx)("span",{className:"text-[10px] px-2 py-0.5 bg-green-500 text-white rounded-full font-medium",children:"Recommended"})]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.description})]}),c&&!k&&(0,b.jsx)("div",{className:"flex shrink-0 items-center justify-center h-6 w-6 rounded-full bg-primary",children:(0,b.jsx)(Z.CheckCircle,{className:"h-4 w-4 text-primary-foreground"})})]},a.id)}),j.length>0&&(0,b.jsxs)("div",{className:"pt-4 border-t",children:[(0,b.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",children:"Other Statuses"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"These transitions may not be typical for the current workflow"})]})]})}),(0,b.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(v.Button,{className:"flex-1 h-12",onClick:e,size:"lg",variant:"outline",children:"Cancel"}),(0,b.jsx)(v.Button,{className:"flex-1 h-12",disabled:!g||g===i,onClick:()=>{a&&g&&(f(a,g),e())},size:"lg",variant:"default",children:"Update Status"})]})})]})]}):null}var ac=a.i(638446),ad=a.i(612658),ad=ad;a.i(839984);var ae=a.i(372712);function af({job:a,isOpen:d,onClose:e,onConfirm:f}){let g=(0,i.useScheduleStore)(a=>a.technicians),h=(0,i.useScheduleStore)(a=>a.jobs),j=(0,c.useMemo)(()=>Array.from(g.values()),[g]),k=(0,c.useMemo)(()=>Array.from(h.values()),[h]),[l,m]=(0,c.useState)(""),[n,o]=(0,c.useState)(a?.assignedTechnicianId||null),p=(0,c.useMemo)(()=>j.map(a=>{let b=k.filter(b=>b.assignedTechnicianId===a.id),c=b.filter(a=>!["completed","cancelled","closed"].includes(a.status?.toLowerCase()||""));return{...a,totalJobs:b.length,activeJobs:c.length}}),[j,k]),q=(0,c.useMemo)(()=>{if(!l.trim())return p;let a=l.toLowerCase();return p.filter(b=>b.name.toLowerCase().includes(a))},[p,l]),r=(0,c.useMemo)(()=>[...q].sort((b,c)=>b.id===a?.assignedTechnicianId?-1:c.id===a?.assignedTechnicianId?1:b.activeJobs-c.activeJobs),[q,a]);return a?(0,b.jsxs)(b.Fragment,{children:[d&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:e}),(0,b.jsxs)("div",{className:(0,D.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",d?"translate-y-0":"translate-y-full"),style:{maxHeight:"85vh"},children:[(0,b.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,b.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Assign Technician"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:a.customer?.name||"Unknown Customer"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:a.title})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:e,size:"icon",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,b.jsx)("div",{className:"px-4 pt-4",children:(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(B.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(ae.Input,{className:"h-11 pl-10 text-base",onChange:a=>m(a.target.value),placeholder:"Search technicians...",type:"search",value:l})]})}),a.assignedTechnicianId&&(0,b.jsx)("div",{className:"px-4 pt-3",children:(0,b.jsxs)("button",{className:(0,D.cn)("flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-orange-500/50 active:scale-98",null===n?"border-orange-500 bg-orange-50 dark:bg-orange-950/20":"border-border"),onClick:()=>o(null),type:"button",children:[(0,b.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-orange-100 dark:bg-orange-900",children:(0,b.jsx)(ad.default,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})}),(0,b.jsxs)("div",{className:"flex-1 text-left",children:[(0,b.jsx)("p",{className:"text-base font-semibold",children:"Unassign Technician"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Remove technician from this job"})]}),null===n&&(0,b.jsx)(ac.Check,{className:"h-5 w-5 text-orange-600 shrink-0"})]})}),(0,b.jsx)(V.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(85vh - 280px)"},children:(0,b.jsx)("div",{className:"p-4 space-y-2",children:0===r.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,b.jsx)(ad.default,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,b.jsx)("p",{className:"text-sm font-medium mb-1",children:"No technicians found"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Try a different search term"})]}):r.map(c=>{let d=n===c.id,e=a.assignedTechnicianId===c.id;return(0,b.jsxs)("button",{className:(0,D.cn)("flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-primary/50 active:scale-98",d?"border-primary bg-primary/5":"border-border"),onClick:()=>o(c.id),type:"button",children:[(0,b.jsx)(O.Avatar,{className:"h-12 w-12",children:(0,b.jsx)(O.AvatarFallback,{className:"text-sm font-medium",children:c.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2)})}),(0,b.jsxs)("div",{className:"flex-1 text-left",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("p",{className:"text-base font-semibold",children:c.name}),e&&(0,b.jsx)(P.Badge,{className:"h-5 px-2 text-[9px]",variant:"secondary",children:"Current"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,b.jsxs)("span",{children:[c.activeJobs," active"]}),(0,b.jsx)("span",{children:"â€¢"}),(0,b.jsxs)("span",{children:[c.totalJobs," total"]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,b.jsx)("div",{className:"flex flex-col items-end",children:(0,b.jsx)("div",{className:(0,D.cn)("h-2 w-16 rounded-full bg-muted overflow-hidden"),children:(0,b.jsx)("div",{className:(0,D.cn)("h-full transition-all",0===c.activeJobs&&"bg-green-500",c.activeJobs>0&&c.activeJobs<=3&&"bg-blue-500",c.activeJobs>3&&c.activeJobs<=6&&"bg-yellow-500",c.activeJobs>6&&"bg-red-500"),style:{width:`${Math.min(c.activeJobs/10*100,100)}%`}})})}),d&&(0,b.jsx)(ac.Check,{className:"h-5 w-5 text-primary"})]})]},c.id)})})}),(0,b.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(v.Button,{className:"flex-1 h-12",onClick:e,size:"lg",variant:"outline",children:"Cancel"}),(0,b.jsx)(v.Button,{className:"flex-1 h-12",disabled:n===a.assignedTechnicianId,onClick:()=>{a&&(f(a,n),e())},size:"lg",variant:"default",children:null===n?"Unassign":"Assign Technician"})]})})]})]}):null}function ag({isOpen:a,onClose:d,job:e,onAction:f}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(null),m=(0,c.useRef)(null),n=(0,c.useCallback)(()=>{h(!0),setTimeout(()=>{d(),h(!1)},300)},[d]);(0,c.useEffect)(()=>{let b=a=>{m.current&&!m.current.contains(a.target)&&n()};return a&&document.addEventListener("mousedown",b),()=>{document.removeEventListener("mousedown",b)}},[a,n]),(0,c.useEffect)(()=>{let b=a=>{"Escape"===a.key&&n()};return a&&document.addEventListener("keydown",b),()=>{document.removeEventListener("keydown",b)}},[a,n]),(0,c.useEffect)(()=>{a||(l(null),j(null))},[a]);let o=(0,c.useCallback)((a,b)=>{if("reschedule"===a){j(b),l("reschedule");return}if("reassign"===a){j(b),l("reassign");return}if("move_to_status"===a){j(b),l("status");return}f(a,b),n()},[f,n]),q=(0,c.useCallback)((a,b,c)=>{f("reschedule",a,b,c),l(null),j(null),n()},[f,n]),r=(0,c.useCallback)((a,b)=>{f("reassign",a,b),l(null),j(null),n()},[f,n]),s=(0,c.useCallback)((a,b)=>{f("move_to_status",a,b),l(null),j(null),n()},[f,n]),t=(0,c.useCallback)(()=>{l(null),j(null)},[]);if(!a&&!g||!e)return null;let u=e.status?.toLowerCase().replace(/ /g,"_")||"unscheduled",y=[];"scheduled"===u&&y.push("dispatch"),"dispatched"===u&&y.push("arrive"),"arrived"===u&&y.push("start"),"in_progress"===u&&y.push("complete"),y.push("reschedule","reassign","move_to_status"),"cancelled"!==u&&"completed"!==u&&y.push("cancel"),y.unshift("view_details");let z=e.customer?.name||"No Customer",A=e.location?.address?.street||"No location",B=e.startTime?(0,p.format)(new Date(e.startTime),"MMM d, h:mm a"):"Not scheduled",E=e.endTime?(0,p.format)(new Date(e.endTime),"h:mm a"):"",F=E?`${B} - ${E}`:B,Q=e.assignments.find(a=>"primary"===a.role),R=Q?.displayName?Q.displayName.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"?",S=e.startTime&&e.endTime?Math.round((new Date(e.endTime).getTime()-new Date(e.startTime).getTime())/36e5):0,T={view_details:{icon:G.ArrowRight,label:"View Full Details"},dispatch:{icon:K.Navigation,label:"Dispatch Job"},arrive:{icon:J.MapPin,label:"Mark as Arrived"},start:{icon:I.Clock,label:"Start Job"},complete:{icon:H.CheckCircle2,label:"Mark as Complete"},reschedule:{icon:w.Calendar,label:"Reschedule"},reassign:{icon:C.Users,label:"Reassign Technician"},move_to_status:{icon:L.Repeat,label:"Move to Status..."},cancel:{icon:M.Trash2,label:"Cancel Job",variant:"destructive"}};return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:(0,D.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",g?"animate-out fade-out duration-300":"animate-in fade-in duration-300")}),(0,b.jsxs)("div",{className:(0,D.cn)("safe-bottom fixed bottom-0 left-0 right-0 z-50 rounded-t-3xl border-t border-border bg-background shadow-2xl",g?"animate-out slide-out-to-bottom duration-300":"animate-in slide-in-from-bottom duration-300"),ref:m,children:[(0,b.jsx)("div",{className:"flex justify-center py-4",children:(0,b.jsx)("div",{className:"h-1.5 w-10 rounded-full bg-muted"})}),(0,b.jsxs)("div",{className:"max-h-[80vh] overflow-y-auto px-6 pb-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold",children:"Job Actions"}),(0,b.jsxs)(v.Button,{className:"h-9 w-9",onClick:n,size:"icon",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,b.jsxs)("div",{className:"mb-6 space-y-3 rounded-lg border bg-muted/50 p-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"text-base font-medium leading-tight",children:z}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:e.title||"Untitled Job"})]}),(0,b.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(I.Clock,{className:"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:F}),S>0&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[S," ",1===S?"hour":"hours"]})]})]}),"No location"!==A&&(0,b.jsxs)("div",{className:"flex items-start gap-2",children:[(0,b.jsx)(J.MapPin,{className:"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground"}),(0,b.jsx)("p",{children:A})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(N.User,{className:"h-4 w-4 shrink-0 text-muted-foreground"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(O.Avatar,{className:"h-6 w-6",children:[(0,b.jsx)(O.AvatarImage,{alt:Q?.displayName||"Unassigned",src:Q?.avatar||void 0}),(0,b.jsx)(O.AvatarFallback,{className:"text-xs",children:R})]}),(0,b.jsx)("span",{className:"font-medium",children:Q?.displayName||"Unassigned"})]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)(P.Badge,{variant:"secondary",className:"capitalize",children:e.status||"Unscheduled"})})]}),e.description&&(0,b.jsx)("div",{className:"pt-2 border-t",children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Actions"}),y.map(a=>{let c=T[a],d=c.icon,f="destructive"===c.variant;return(0,b.jsxs)(v.Button,{className:(0,D.cn)("h-14 w-full justify-start gap-3 text-base font-medium",f&&"text-destructive hover:text-destructive"),onClick:()=>o(a,e),variant:f?"ghost":"outline",children:[(0,b.jsx)(d,{className:"h-5 w-5"}),c.label]},a)})]})]})]}),(0,b.jsx)(Y,{isOpen:"reschedule"===k,job:i,onClose:t,onConfirm:q}),(0,b.jsx)(af,{isOpen:"reassign"===k,job:i,onClose:t,onConfirm:r}),(0,b.jsx)(ab,{isOpen:"status"===k,job:i,onClose:t,onConfirm:s})]})}let ah={unscheduled:{bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-700 dark:text-gray-300",label:"Unscheduled"},scheduled:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",label:"Scheduled"},dispatched:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-300",label:"Dispatched"},arrived:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",label:"Arrived"},in_progress:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-300",label:"In Progress"},closed:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-300",label:"Closed"},completed:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-300",label:"Completed"},cancelled:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-300",label:"Cancelled"}};function ai({job:a,onClick:c,className:d,showTechnician:e=!0,showDate:f=!0}){let g=ah[a.status?.toLowerCase().replace(/ /g,"_")||"unscheduled"]||ah.unscheduled,h=a.startTime?(0,p.format)(new Date(a.startTime),"h:mm a"):"Not scheduled";a.endTime&&(0,p.format)(new Date(a.endTime),"h:mm a"),a.startTime&&(0,p.format)(new Date(a.startTime),"MMM d");let i=a.assignments.find(a=>"primary"===a.role),j=i?.displayName?i.displayName.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"?",k=a.customer?.name||"No Customer",l=a.location?.address?.street||"No location";return(0,b.jsxs)("button",{className:(0,D.cn)("group relative flex w-full items-center gap-3 rounded-lg border bg-card p-3 text-left transition-all","min-h-[64px]","hover:border-primary/30 hover:bg-primary/5 hover:shadow-sm","active:scale-[0.99]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",d),onClick:c,type:"button",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center shrink-0 w-16 text-center",children:[(0,b.jsx)("span",{className:"text-sm font-semibold leading-tight",children:"Not scheduled"===h?"--:--":(0,p.format)(new Date(a.startTime),"h:mm")}),(0,b.jsx)("span",{className:"text-[0.65rem] text-muted-foreground uppercase",children:"Not scheduled"===h?"":(0,p.format)(new Date(a.startTime),"a")})]}),(0,b.jsxs)("div",{className:"flex-1 min-w-0 space-y-0.5",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold leading-tight truncate",children:k}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:a.title||"Untitled Job"}),"No location"!==l&&(0,b.jsxs)("div",{className:"flex items-center gap-1 text-[0.65rem] text-muted-foreground",children:[(0,b.jsx)(J.MapPin,{className:"h-2.5 w-2.5"}),(0,b.jsx)("span",{className:"truncate",children:l})]})]}),(0,b.jsxs)("div",{className:"flex flex-col items-end gap-1.5 shrink-0",children:[(0,b.jsx)(P.Badge,{className:(0,D.cn)("text-[0.65rem] font-medium h-4 px-1.5",g.bg,g.text),variant:"secondary",children:g.label}),e&&(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsxs)(O.Avatar,{className:"h-4 w-4",children:[(0,b.jsx)(O.AvatarImage,{alt:i?.displayName||"Unassigned",src:i?.avatar||void 0}),(0,b.jsx)(O.AvatarFallback,{className:"text-[0.5rem] font-medium",children:j})]}),(0,b.jsx)("span",{className:"text-[0.65rem] text-muted-foreground max-w-[60px] truncate",children:i?.displayName||"Unassigned"})]})]})]})}var aj=a.i(556253),ak=a.i(349669),al=a.i(856856),am=a.i(220578),an=a.i(638727);let ao=[{value:"scheduled",label:"Scheduled",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"},{value:"dispatched",label:"Dispatched",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"},{value:"arrived",label:"Arrived",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300"},{value:"in_progress",label:"In Progress",color:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300"},{value:"completed",label:"Completed",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}];function ap({isOpen:a,onClose:d,activeFilters:e,onApplyFilters:f}){let[g,h]=(0,c.useState)(e.statuses),[j,k]=(0,c.useState)(e.technicianIds),[l,m]=(0,c.useState)(e.showUnassignedOnly),n=(0,i.useScheduleStore)(a=>a.technicians),o=(0,c.useMemo)(()=>Array.from(n.values()),[n]),p=g.length>0||j.length>0||l;return(0,b.jsx)(z.Sheet,{open:a,onOpenChange:d,children:(0,b.jsxs)(z.SheetContent,{side:"right",className:"w-[300px] sm:w-[400px] flex flex-col",children:[(0,b.jsx)(z.SheetHeader,{children:(0,b.jsxs)(z.SheetTitle,{className:"flex items-center justify-between",children:[(0,b.jsx)("span",{children:"Filter Jobs"}),(0,b.jsx)(v.Button,{className:"h-8 w-8 p-0",onClick:d,size:"icon",variant:"ghost",children:(0,b.jsx)(x.X,{className:"h-4 w-4"})})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-y-auto py-6 space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(U.Label,{className:"text-sm font-semibold",children:"Status"}),(0,b.jsx)("div",{className:"space-y-2",children:ao.map(a=>(0,b.jsxs)("button",{className:(0,D.cn)("flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors",g.includes(a.value)?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),onClick:()=>{var b;return b=a.value,void h(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},type:"button",children:[(0,b.jsx)(P.Badge,{className:(0,D.cn)("text-xs",a.color),variant:"secondary",children:a.label}),g.includes(a.value)&&(0,b.jsx)(ac.Check,{className:"h-4 w-4 text-primary"})]},a.value))})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(U.Label,{className:"text-sm font-semibold",children:"Technician"}),(0,b.jsx)("div",{className:"space-y-2",children:o.map(a=>{let c=a.name.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2);return(0,b.jsxs)("button",{className:(0,D.cn)("flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors",j.includes(a.id)?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),onClick:()=>{var b;return b=a.id,void k(a=>a.includes(b)?a.filter(a=>a!==b):[...a,b])},type:"button",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(O.Avatar,{className:"h-8 w-8",children:[(0,b.jsx)(O.AvatarImage,{alt:a.name,src:a.avatar||void 0}),(0,b.jsx)(O.AvatarFallback,{className:"text-xs",children:c})]}),(0,b.jsx)("span",{className:"text-sm font-medium",children:a.name})]}),j.includes(a.id)&&(0,b.jsx)(ac.Check,{className:"h-4 w-4 text-primary"})]},a.id)})})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)(U.Label,{className:"text-sm font-semibold",children:"Special Filters"}),(0,b.jsxs)("button",{className:(0,D.cn)("flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors",l?"border-yellow-500 bg-yellow-50 dark:bg-yellow-950/20":"border-border hover:bg-muted/50"),onClick:()=>m(!l),type:"button",children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:"Show unassigned only"}),l&&(0,b.jsx)(ac.Check,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})]})]})]}),(0,b.jsxs)("div",{className:"shrink-0 space-y-2 border-t pt-4",children:[p&&(0,b.jsx)(v.Button,{className:"w-full",onClick:()=>{h([]),k([]),m(!1)},size:"sm",variant:"outline",children:"Clear All Filters"}),(0,b.jsx)(v.Button,{className:"w-full",onClick:()=>{f({statuses:g,technicianIds:j,showUnassignedOnly:l}),d()},size:"default",children:"Apply Filters"})]})]})})}function aq({isOpen:a,onClose:d,onJobSelect:e}){let[f,g]=(0,c.useState)(""),h=(0,i.useScheduleStore)(a=>a.jobs),j=(0,c.useMemo)(()=>Array.from(h.values()),[h]),k=(0,c.useMemo)(()=>{if(!f.trim())return[];let a=f.toLowerCase();return j.filter(b=>!!((b.customer?.name?.toLowerCase()||"").includes(a)||(b.title?.toLowerCase()||"").includes(a)||(b.location?.address?.street?.toLowerCase()||"").includes(a)||(b.jobNumber?.toString().toLowerCase()||"").includes(a)))},[j,f]);return(0,b.jsx)(z.Sheet,{open:a,onOpenChange:d,children:(0,b.jsxs)(z.SheetContent,{side:"top",className:"h-[90vh] flex flex-col",children:[(0,b.jsx)(z.SheetHeader,{children:(0,b.jsx)(z.SheetTitle,{children:"Search Jobs"})}),(0,b.jsxs)("div",{className:"relative mt-4",children:[(0,b.jsx)(B.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(ae.Input,{autoFocus:!0,className:"pl-9 pr-9",onChange:a=>g(a.target.value),placeholder:"Search by customer, job title, location...",type:"search",value:f}),f&&(0,b.jsxs)(v.Button,{className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0",onClick:()=>{g("")},size:"sm",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Clear search"})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto mt-4",children:f.trim()?0===k.length?(0,b.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(B.Search,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-20"}),(0,b.jsxs)("p",{className:"mt-4 text-sm text-muted-foreground",children:['No jobs found for "',f,'"']})]})}):(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:[k.length," ",1===k.length?"job":"jobs"," found"]}),k.map(a=>(0,b.jsx)(ai,{job:a,onClick:()=>{e(a),d()},showDate:!0,showTechnician:!0},a.id))]}):(0,b.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(B.Search,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-20"}),(0,b.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Start typing to search jobs"})]})})})]})})}function ar({onJobSelect:a}){let d=(0,f.useRouter)(),{viewMode:e,setViewMode:h}=(0,g.useScheduleViewStore)(),j=(0,i.useScheduleStore)(a=>a.jobs),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(!1),[o,p]=(0,c.useState)({statuses:[],technicianIds:[],showUnassignedOnly:!1}),q=(0,c.useMemo)(()=>{let a=Array.from(j.values()),b=new Date;b.setHours(0,0,0,0);let c=a.filter(a=>{let c=new Date(a.startTime);return c.setHours(0,0,0,0),c.getTime()===b.getTime()});return{total:c.length,completed:c.filter(a=>"completed"===a.status).length,inProgress:c.filter(a=>"in_progress"===a.status||"in-progress"===a.status).length,unassigned:c.filter(a=>a.isUnassigned).length}},[j]),r=a=>{h(a)},s=o.statuses.length+o.technicianIds.length+ +!!o.showUnassignedOnly;return(0,b.jsxs)("div",{className:"safe-top sticky top-0 z-35 border-b bg-background/95 backdrop-blur-sm supports-[backdrop-filter]:bg-background/80",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 px-4 py-2.5",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 rounded-lg border p-1",children:[(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>r("day"),size:"sm",variant:"day"===e?"secondary":"ghost",children:[(0,b.jsx)(w.Calendar,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Day view"})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>r("week"),size:"sm",variant:"week"===e?"secondary":"ghost",children:[(0,b.jsx)(al.LayoutGrid,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Week view"})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>r("list"),size:"sm",variant:"list"===e?"secondary":"ghost",children:[(0,b.jsx)(am.List,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"List view"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,b.jsxs)(z.Sheet,{children:[(0,b.jsx)(z.SheetTrigger,{asChild:!0,children:(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0",size:"sm",variant:"ghost",children:[(0,b.jsx)(aj.BarChart3,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"View stats"})]})}),(0,b.jsxs)(z.SheetContent,{side:"bottom",className:"h-[300px]",children:[(0,b.jsx)(z.SheetHeader,{children:(0,b.jsx)(z.SheetTitle,{children:"Today's Stats"})}),(0,b.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("p",{className:"text-2xl font-bold",children:q.total}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Jobs"})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-green-600",children:q.completed}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Completed"})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:q.inProgress}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"In Progress"})]}),(0,b.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,b.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:q.unassigned}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unassigned"})]})]})]})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>l(!0),size:"sm",variant:"ghost",children:[(0,b.jsx)(B.Search,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Search jobs"})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0 relative",onClick:()=>n(!0),size:"sm",variant:"ghost",children:[(0,b.jsx)(ak.Filter,{className:"h-4 w-4"}),s>0&&(0,b.jsx)(P.Badge,{className:"absolute -top-1 -right-1 h-4 min-w-4 p-0 text-[0.6rem]",variant:"destructive",children:s}),(0,b.jsx)("span",{className:"sr-only",children:"Filter jobs"})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>{d.push("/dashboard/work/jobs/new")},size:"sm",variant:"default",children:[(0,b.jsx)(an.Plus,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Create job"})]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto px-4 pb-2 scrollbar-none",children:[(0,b.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border bg-muted/50 px-3 py-1 text-xs whitespace-nowrap",children:[(0,b.jsx)("span",{className:"font-semibold",children:q.total}),(0,b.jsx)("span",{className:"text-muted-foreground",children:"Total"})]}),q.completed>0&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border border-green-200 bg-green-50 px-3 py-1 text-xs whitespace-nowrap dark:border-green-900 dark:bg-green-950",children:[(0,b.jsx)("span",{className:"font-semibold text-green-700 dark:text-green-300",children:q.completed}),(0,b.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"Done"})]}),q.inProgress>0&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border border-orange-200 bg-orange-50 px-3 py-1 text-xs whitespace-nowrap dark:border-orange-900 dark:bg-orange-950",children:[(0,b.jsx)("span",{className:"font-semibold text-orange-700 dark:text-orange-300",children:q.inProgress}),(0,b.jsx)("span",{className:"text-orange-600 dark:text-orange-400",children:"Active"})]}),q.unassigned>0&&(0,b.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border border-yellow-200 bg-yellow-50 px-3 py-1 text-xs whitespace-nowrap dark:border-yellow-900 dark:bg-yellow-950",children:[(0,b.jsx)("span",{className:"font-semibold text-yellow-700 dark:text-yellow-300",children:q.unassigned}),(0,b.jsx)("span",{className:"text-yellow-600 dark:text-yellow-400",children:"Unassigned"})]})]}),(0,b.jsx)(aq,{isOpen:k,onClose:()=>l(!1),onJobSelect:b=>{a&&a(b)}}),(0,b.jsx)(ap,{activeFilters:o,isOpen:m,onApplyFilters:a=>{p(a)},onClose:()=>n(!1)})]})}function as(){let d=(0,i.useScheduleStore)(a=>a.jobs),e=(0,i.useScheduleStore)(a=>a.technicians),{currentDate:f,goToToday:h,navigatePrevious:j,navigateNext:k,setCurrentDate:l}=(0,g.useScheduleViewStore)(),m=(0,c.useMemo)(()=>Array.from(d.values()),[d]),n=(0,c.useMemo)(()=>Array.from(e.values()),[e]),[o,w]=(0,c.useState)(null),[x,y]=(0,c.useState)(new Set),[z,B]=(0,c.useState)(!1),[C,D]=(0,c.useState)(!1),[E,G]=(0,c.useState)(!1),H=(0,c.useMemo)(()=>m.filter(a=>{if(!a.startTime)return!1;let b="string"==typeof a.startTime?new Date(a.startTime):a.startTime;return(0,q.isSameDay)(b,f)}),[m,f]),I=(0,c.useMemo)(()=>{let a=new Map;return n.forEach(b=>{a.set(b.id,[])}),H.forEach(b=>{if(b.technicianId){let c=a.get(b.technicianId)||[];c.push(b),a.set(b.technicianId,c)}}),a.forEach(a=>{a.sort((a,b)=>a.startTime?b.startTime?new Date(a.startTime).getTime()-new Date(b.startTime).getTime():-1:1)}),a},[H,n]),J=(0,c.useMemo)(()=>H.filter(a=>a.isUnassigned),[H]);(0,c.useEffect)(()=>{if(E||0===I.size)return;let a=new Set;I.forEach((b,c)=>{b.length>0&&a.add(c)}),a.size>0&&(y(a),G(!0))},[I,E]),(0,c.useEffect)(()=>{G(!1)},[f]);let K=(0,c.useCallback)(a=>{y(b=>{let c=new Set(b);return c.has(a)?c.delete(a):c.add(a),c})},[]),L=(0,c.useCallback)(async(b,c,...d)=>{w(null);try{switch(b){case"view_details":window.location.href=`/dashboard/work/jobs/${c.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:e}=await a.A(965863),f="move_to_status"===b?d[0]:b,g=await e(c.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[b]||f);g.success?(u.toast.success(`Job ${"move_to_status"===b?"moved to "+f:b+"ed"}`),window.location.reload()):u.toast.error(g.error||"Failed to update job status");break}case"reschedule":{let[b,e]=d,{updateJob:f}=await a.A(965863),g=await f({jobId:c.id,scheduled_start:b.toISOString(),scheduled_end:e.toISOString()});g.success?(u.toast.success("Job rescheduled"),window.location.reload()):u.toast.error(g.error||"Failed to reschedule job");break}case"reassign":{let b=d[0];if(b){let{assignJobToTechnician:d}=await a.A(959763),e=await d(c.id,b);e.success?(u.toast.success("Job reassigned"),window.location.reload()):u.toast.error(e.error||"Failed to reassign job")}else u.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:b}=await a.A(959763),d=await b(c.id);d.success?(u.toast.success("Job cancelled"),window.location.reload()):u.toast.error(d.error||"Failed to cancel job");break}default:console.warn("Unknown action:",b)}}catch(a){console.error("Job action error:",a),u.toast.error("An error occurred")}},[]);(0,p.format)(f,"EEEE, MMM d, yyyy");let M=(0,q.isSameDay)(f,new Date);return(0,b.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,b.jsx)(ar,{onJobSelect:w}),(0,b.jsxs)("div",{className:"shrink-0 border-b bg-background",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,b.jsxs)(v.Button,{className:"h-9 w-9",onClick:j,size:"icon",variant:"ghost",children:[(0,b.jsx)(s.ChevronLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Previous day"})]}),(0,b.jsxs)("button",{className:"flex flex-col items-center transition-colors hover:text-primary active:scale-95",onClick:()=>D(!0),type:"button",children:[(0,b.jsx)("h2",{className:"text-sm font-medium text-muted-foreground",children:(0,p.format)(f,"EEEE")}),(0,b.jsx)("p",{className:"text-lg font-semibold",children:(0,p.format)(f,"MMM d, yyyy")})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9",onClick:k,size:"icon",variant:"ghost",children:[(0,b.jsx)(t.ChevronRight,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Next day"})]})]}),!M&&(0,b.jsx)("div",{className:"px-4 pb-3",children:(0,b.jsx)(v.Button,{className:"w-full",onClick:h,size:"sm",variant:"outline",children:"Go to Today"})})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===H.length?(0,b.jsx)(F,{actionLabel:"View Full Schedule",onAction:()=>{window.location.href="/dashboard/schedule"},variant:"no_jobs_today"}):(0,b.jsxs)("div",{className:"space-y-0",children:[n.map(a=>{let c=I.get(a.id)||[],d=x.has(a.id),e=c.length>0;return(0,b.jsxs)("div",{className:"border-b last:border-b-0",children:[(0,b.jsxs)("button",{className:"flex w-full items-center justify-between bg-muted/30 p-4 text-left transition-colors hover:bg-muted/50 active:bg-muted",onClick:()=>K(a.id),type:"button",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[d?(0,b.jsx)(r.ChevronDown,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(t.ChevronRight,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium",children:a.name}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[c.length," ",1===c.length?"job":"jobs"]})]})]}),e&&(0,b.jsx)("div",{className:"flex h-6 min-w-6 items-center justify-center rounded-full bg-primary/10 px-2 text-xs font-semibold text-primary",children:c.length})]}),d&&(0,b.jsx)("div",{className:"bg-background px-4 pb-4",children:0===c.length?(0,b.jsx)("p",{className:"py-8 text-center text-sm text-muted-foreground",children:"No jobs scheduled for today"}):(0,b.jsx)("div",{className:"space-y-1.5",children:c.map(a=>(0,b.jsx)(ai,{job:a,onClick:()=>w(a),showDate:!1,showTechnician:!1},a.id))})})]},a.id)}),J.length>0&&(0,b.jsxs)("div",{className:"border-t",children:[(0,b.jsxs)("button",{className:"flex w-full items-center justify-between bg-yellow-50 dark:bg-yellow-950/20 p-4 text-left transition-colors hover:bg-yellow-100 dark:hover:bg-yellow-950/30 active:bg-yellow-100 dark:active:bg-yellow-950/30",onClick:()=>B(!z),type:"button",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[z?(0,b.jsx)(r.ChevronDown,{className:"h-4 w-4 text-muted-foreground"}):(0,b.jsx)(t.ChevronRight,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-medium",children:"ðŸ“‹ Unassigned"}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[J.length," ",1===J.length?"job":"jobs"," need assignment"]})]})]}),(0,b.jsx)("div",{className:"flex h-6 min-w-6 items-center justify-center rounded-full bg-yellow-500 dark:bg-yellow-600 px-2 text-xs font-semibold text-white",children:J.length})]}),z&&(0,b.jsx)("div",{className:"bg-background px-4 pb-4",children:(0,b.jsx)("div",{className:"space-y-1.5",children:J.map(a=>(0,b.jsx)(ai,{job:a,onClick:()=>w(a),showDate:!1,showTechnician:!0},a.id))})})]})]})}),(0,b.jsx)(ag,{isOpen:null!==o,job:o,onAction:L,onClose:()=>w(null)}),(0,b.jsx)(A,{currentDate:f,isOpen:C,onClose:()=>D(!1),onDateSelect:a=>{l(a),D(!1)}})]})}let at=[{id:"unscheduled",label:"Unscheduled",color:"bg-gray-500"},{id:"scheduled",label:"Scheduled",color:"bg-blue-500"},{id:"dispatched",label:"Dispatched",color:"bg-yellow-500"},{id:"arrived",label:"Arrived",color:"bg-purple-500"},{id:"in_progress",label:"In Progress",color:"bg-orange-500"},{id:"closed",label:"Closed",color:"bg-green-500"},{id:"completed",label:"Completed",color:"bg-emerald-500"},{id:"cancelled",label:"Cancelled",color:"bg-red-500"}];function au(){let d=(0,i.useScheduleStore)(a=>a.jobs),e=(0,c.useMemo)(()=>Array.from(d.values()),[d]),[f,g]=(0,c.useState)(2),[h,j]=(0,c.useState)(null),k=at[f],l=(0,c.useMemo)(()=>e.filter(a=>(a.status||"unscheduled").toLowerCase().replace(/ /g,"_")===k.id),[e,k.id]),m=(0,c.useMemo)(()=>[...l].sort((a,b)=>a.scheduled_start?b.scheduled_start?new Date(a.scheduled_start).getTime()-new Date(b.scheduled_start).getTime():-1:1),[l]),n=(0,c.useCallback)(()=>{g(a=>Math.max(0,a-1))},[]),o=(0,c.useCallback)(()=>{g(a=>Math.min(at.length-1,a+1))},[]),p=(0,c.useCallback)(a=>{g(a)},[]),q=(0,c.useCallback)(async(b,c,...d)=>{j(null);try{switch(b){case"view_details":window.location.href=`/dashboard/work/jobs/${c.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:e}=await a.A(965863),f="move_to_status"===b?d[0]:b,g=await e(c.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[b]||f);g.success?(u.toast.success(`Job ${"move_to_status"===b?"moved to "+f:b+"ed"}`),window.location.reload()):u.toast.error(g.error||"Failed to update job status");break}case"reschedule":{let[b,e]=d,{updateJob:f}=await a.A(965863),g=await f({jobId:c.id,scheduled_start:b.toISOString(),scheduled_end:e.toISOString()});g.success?(u.toast.success("Job rescheduled"),window.location.reload()):u.toast.error(g.error||"Failed to reschedule job");break}case"reassign":{let b=d[0];if(b){let{assignJobToTechnician:d}=await a.A(959763),e=await d(c.id,b);e.success?(u.toast.success("Job reassigned"),window.location.reload()):u.toast.error(e.error||"Failed to reassign job")}else u.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:b}=await a.A(959763),d=await b(c.id);d.success?(u.toast.success("Job cancelled"),window.location.reload()):u.toast.error(d.error||"Failed to cancel job");break}default:console.warn("Unknown action:",b)}}catch(a){console.error("Job action error:",a),u.toast.error("An error occurred")}},[]),r=f<at.length-1;return(0,b.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,b.jsxs)("div",{className:"shrink-0 border-b bg-background p-4",children:[(0,b.jsx)("div",{className:"mb-4 flex items-center justify-center gap-2",children:at.map((a,c)=>{let d=c===f;return(0,b.jsxs)("button",{className:"transition-transform hover:scale-125 active:scale-110",onClick:()=>p(c),type:"button",children:[(0,b.jsx)("div",{className:`h-2 w-2 rounded-full transition-all ${d?`${a.color} scale-125`:"bg-muted-foreground/30"}`}),(0,b.jsx)("span",{className:"sr-only",children:a.label})]},a.id)})}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(v.Button,{className:"h-9 w-9",disabled:!(f>0),onClick:n,size:"icon",variant:"ghost",children:[(0,b.jsx)(s.ChevronLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Previous status"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsx)("div",{className:`mb-1 h-1 w-16 rounded-full ${k.color}`}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:k.label}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m.length," ",1===m.length?"job":"jobs"]})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9",disabled:!r,onClick:o,size:"icon",variant:"ghost",children:[(0,b.jsx)(t.ChevronRight,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Next status"})]})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===m.length?(0,b.jsx)("div",{className:"flex h-full items-center justify-center p-6",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:['No jobs with status "',k.label,'"']}),r&&(0,b.jsxs)(v.Button,{className:"mt-4",onClick:o,size:"sm",variant:"outline",children:["View ",at[f+1].label]})]})}):(0,b.jsx)("div",{className:"space-y-2 p-4",children:m.map(a=>(0,b.jsx)(ai,{job:a,onClick:()=>j(a),showDate:!0,showTechnician:!0},a.id))})}),(0,b.jsx)(ag,{isOpen:null!==h,job:h,onAction:q,onClose:()=>j(null)})]})}var av=a.i(696922),aw=a.i(665791),ax=a.i(520821);function ay(a,b){return(0,q.isSameDay)(a,(0,aw.addDays)((0,ax.constructNow)(b?.in||a),1),b)}var az=a.i(769739),aA=a.i(788839);let aB=/[T ]/,aC=/[Z ]/i,aD=/([Z+-].*)$/,aE=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,aF=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,aG=/^([+-])(\d{2})(?::?(\d{2}))?$/;function aH(a){return a?parseInt(a):1}function aI(a){return a&&parseFloat(a.replace(",","."))||0}let aJ=[31,null,31,30,31,30,31,31,30,31,30,31];function aK(a){return a%400==0||a%4==0&&a%100!=0}a.i(40744);var aL=a.i(419573);function aM({statusOptions:a,technicianOptions:c,activeFilters:d,onToggleStatus:e,onToggleTechnician:f,onClearAll:g,onOpenFilters:h,className:i}){let j=d.statuses.length>0||d.technicians.length>0||d.dateRange,k=d.statuses.length+d.technicians.length+ +!!d.dateRange;return(0,b.jsxs)("div",{className:(0,D.cn)("flex items-center gap-2 overflow-x-auto pb-2",i),children:[h&&(0,b.jsxs)(v.Button,{className:"h-9 shrink-0 gap-2",onClick:h,size:"sm",variant:"outline",children:[(0,b.jsx)(ak.Filter,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Filters"}),k>0&&(0,b.jsx)(P.Badge,{className:"ml-1 h-5 min-w-5 px-1.5 text-xs",variant:"secondary",children:k})]}),a.map(a=>{let c=d.statuses.includes(a.id);return(0,b.jsxs)(P.Badge,{className:(0,D.cn)("h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all",c?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),onClick:()=>e(a.id),variant:"secondary",children:[(0,b.jsx)("span",{children:a.label}),void 0!==a.count&&(0,b.jsx)("span",{className:(0,D.cn)("rounded-full px-1.5 py-0.5 text-xs font-semibold",c?"bg-primary-foreground/20 text-primary-foreground":"bg-muted text-muted-foreground"),children:a.count})]},a.id)}),c.length>0&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"h-6 w-px bg-border shrink-0"}),c.map(a=>{let c=d.technicians.includes(a.id);return(0,b.jsxs)(P.Badge,{className:(0,D.cn)("h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all",c?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),onClick:()=>f(a.id),variant:"secondary",children:[(0,b.jsx)("span",{children:a.label}),void 0!==a.count&&(0,b.jsx)("span",{className:(0,D.cn)("rounded-full px-1.5 py-0.5 text-xs font-semibold",c?"bg-primary-foreground/20 text-primary-foreground":"bg-muted text-muted-foreground"),children:a.count})]},a.id)})]}),j&&(0,b.jsxs)(v.Button,{className:"h-9 shrink-0 gap-2",onClick:g,size:"sm",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:"Clear"})]})]})}function aN(){let d=(0,i.useScheduleStore)(a=>a.jobs),e=(0,i.useScheduleStore)(a=>a.technicians),f=(0,c.useMemo)(()=>Array.from(d.values()),[d]),g=(0,c.useMemo)(()=>Array.from(e.values()),[e]),[h,j]=(0,c.useState)(""),[k,l]=(0,c.useState)("date"),[m,n]=(0,c.useState)("start_time"),[o,q]=(0,c.useState)(null),[r,s]=(0,c.useState)({statuses:[],technicians:[]}),t=(0,c.useMemo)(()=>{let a=f.reduce((a,b)=>{let c=b.status||"unscheduled";return a[c]=(a[c]||0)+1,a},{});return[{id:"scheduled",label:"Scheduled",count:a.scheduled||0},{id:"dispatched",label:"Dispatched",count:a.dispatched||0},{id:"arrived",label:"Arrived",count:a.arrived||0},{id:"in_progress",label:"In Progress",count:a.in_progress||0},{id:"completed",label:"Completed",count:a.completed||0}]},[f]),w=(0,c.useMemo)(()=>g.map(a=>{let b=f.filter(b=>b.assignedTechnicianId===a.id).length;return{id:a.id,label:a.name,count:b}}),[g,f]),x=(0,c.useMemo)(()=>{let a=[...f];if(h.trim()){let b=h.toLowerCase();a=a.filter(a=>a.customer?.name.toLowerCase().includes(b)||a.title?.toLowerCase().includes(b)||a.property?.address?.toLowerCase().includes(b)||a.description?.toLowerCase().includes(b))}return r.statuses.length>0&&(a=a.filter(a=>r.statuses.includes(a.status?.toLowerCase()||"unscheduled"))),r.technicians.length>0&&(a=a.filter(a=>!!a.assignedTechnicianId&&r.technicians.includes(a.assignedTechnicianId))),a},[f,h,r]),y=(0,c.useMemo)(()=>{let a=[...x];switch(m){case"start_time":a.sort((a,b)=>a.scheduled_start?b.scheduled_start?new Date(a.scheduled_start).getTime()-new Date(b.scheduled_start).getTime():-1:1);break;case"customer":a.sort((a,b)=>{let c=a.customer?.name||"",d=b.customer?.name||"";return c.localeCompare(d)});break;case"status":a.sort((a,b)=>{let c=a.status||"unscheduled",d=b.status||"unscheduled";return c.localeCompare(d)})}return a},[x,m]),z=(0,c.useMemo)(()=>{let a={};return y.forEach(b=>{let c="";switch(k){case"date":if(b.scheduled_start){let a="string"==typeof b.scheduled_start?function(a,b){let c,d,e=()=>(0,aA.constructFrom)(void 0,NaN),f=function(a){let b,c={},d=a.split(aB);if(d.length>2)return c;if(/:/.test(d[0])?b=d[0]:(c.date=d[0],b=d[1],aC.test(c.date)&&(c.date=a.split(aC)[0],b=a.substr(c.date.length,a.length))),b){let a=aD.exec(b);a?(c.time=b.replace(a[1],""),c.timezone=a[1]):c.time=b}return c}(a);if(f.date){let a=function(a,b){let c=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+b)+"})|(\\d{2}|[+-]\\d{"+(2+b)+"})$)"),d=a.match(c);if(!d)return{year:NaN,restDateString:""};let e=d[1]?parseInt(d[1]):null,f=d[2]?parseInt(d[2]):null;return{year:null===f?e:100*f,restDateString:a.slice((d[1]||d[2]).length)}}(f.date,(void 0)??2);c=function(a,b){var c,d,e,f,g,h,i,j,k,l;if(null===b)return new Date(NaN);let m=a.match(aE);if(!m)return new Date(NaN);let n=!!m[4],o=aH(m[1]),p=aH(m[2])-1,q=aH(m[3]),r=aH(m[4]),s=aH(m[5])-1;if(n){let a,h;return(c=r,d=s,c>=1&&c<=53&&d>=0&&d<=6)?(e=b,f=r,g=s,(a=new Date(0)).setUTCFullYear(e,0,4),h=a.getUTCDay()||7,a.setUTCDate(a.getUTCDate()+((f-1)*7+g+1-h)),a):new Date(NaN)}{let a=new Date(0);return(h=b,i=p,j=q,i>=0&&i<=11&&j>=1&&j<=(aJ[i]||(aK(h)?29:28))&&(k=b,(l=o)>=1&&l<=(aK(k)?366:365)))?(a.setUTCFullYear(b,p,Math.max(o,q)),a):new Date(NaN)}}(a.restDateString,a.year)}if(!c||isNaN(+c))return e();let g=+c,h=0;if(f.time&&isNaN(h=function(a){var b,c,d;let e=a.match(aF);if(!e)return NaN;let f=aI(e[1]),g=aI(e[2]),h=aI(e[3]);return(b=f,c=g,d=h,24===b?0===c&&0===d:d>=0&&d<60&&c>=0&&c<60&&b>=0&&b<25)?f*az.millisecondsInHour+g*az.millisecondsInMinute+1e3*h:NaN}(f.time)))return e();if(f.timezone){if(isNaN(d=function(a){var b;if("Z"===a)return 0;let c=a.match(aG);if(!c)return 0;let d="+"===c[1]?-1:1,e=parseInt(c[2]),f=c[3]&&parseInt(c[3])||0;return(b=f)>=0&&b<=59?d*(e*az.millisecondsInHour+f*az.millisecondsInMinute):NaN}(f.timezone)))return e()}else{let a=new Date(g+h),b=(0,Q.toDate)(0,void 0);return b.setFullYear(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()),b.setHours(a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds(),a.getUTCMilliseconds()),b}return(0,Q.toDate)(g+h+d,void 0)}(b.scheduled_start):new Date(b.scheduled_start);c=(0,av.isToday)(a)?"Today":ay(a)?"Tomorrow":(0,p.format)(a,"EEEE, MMM d")}else c="Unscheduled";break;case"technician":c=b.assignedTechnician?.name||"Unassigned";break;case"status":c=b.status||"Unscheduled";break;case"customer":c=b.customer?.name||"No Customer";break;default:c="All Jobs"}a[c]||(a[c]=[]),a[c].push(b)}),a},[y,k]),A=(0,c.useCallback)(a=>{s(b=>({...b,statuses:b.statuses.includes(a)?b.statuses.filter(b=>b!==a):[...b.statuses,a]}))},[]),C=(0,c.useCallback)(a=>{s(b=>({...b,technicians:b.technicians.includes(a)?b.technicians.filter(b=>b!==a):[...b.technicians,a]}))},[]),D=(0,c.useCallback)(()=>{s({statuses:[],technicians:[]}),j("")},[]),E=(0,c.useCallback)(async(b,c,...d)=>{q(null);try{switch(b){case"view_details":window.location.href=`/dashboard/work/jobs/${c.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:e}=await a.A(965863),f="move_to_status"===b?d[0]:b,g=await e(c.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[b]||f);g.success?(u.toast.success(`Job ${"move_to_status"===b?"moved to "+f:b+"ed"}`),window.location.reload()):u.toast.error(g.error||"Failed to update job status");break}case"reschedule":{let[b,e]=d,{updateJob:f}=await a.A(965863),g=await f({jobId:c.id,scheduled_start:b.toISOString(),scheduled_end:e.toISOString()});g.success?(u.toast.success("Job rescheduled"),window.location.reload()):u.toast.error(g.error||"Failed to reschedule job");break}case"reassign":{let b=d[0];if(b){let{assignJobToTechnician:d}=await a.A(959763),e=await d(c.id,b);e.success?(u.toast.success("Job reassigned"),window.location.reload()):u.toast.error(e.error||"Failed to reassign job")}else u.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:b}=await a.A(959763),d=await b(c.id);d.success?(u.toast.success("Job cancelled"),window.location.reload()):u.toast.error(d.error||"Failed to cancel job");break}default:console.warn("Unknown action:",b)}}catch(a){console.error("Job action error:",a),u.toast.error("An error occurred")}},[]);return 0!==x.length||h||0!==r.statuses.length?(0,b.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,b.jsxs)("div",{className:"shrink-0 space-y-3 border-b bg-background p-4",children:[(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(B.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,b.jsx)(ae.Input,{className:"h-11 pl-10 text-base",onChange:a=>j(a.target.value),placeholder:"Search jobs, customers, or locations...",type:"search",value:h})]}),(0,b.jsx)(aM,{activeFilters:r,onClearAll:D,onToggleStatus:A,onToggleTechnician:C,statusOptions:t,technicianOptions:w}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(aL.Select,{onValueChange:a=>l(a),value:k,children:[(0,b.jsx)(aL.SelectTrigger,{className:"h-9 w-[140px] text-sm",children:(0,b.jsx)(aL.SelectValue,{placeholder:"Group by"})}),(0,b.jsxs)(aL.SelectContent,{children:[(0,b.jsx)(aL.SelectItem,{value:"date",children:"Group by Date"}),(0,b.jsx)(aL.SelectItem,{value:"technician",children:"Group by Tech"}),(0,b.jsx)(aL.SelectItem,{value:"status",children:"Group by Status"}),(0,b.jsx)(aL.SelectItem,{value:"customer",children:"Group by Customer"})]})]}),(0,b.jsxs)(aL.Select,{onValueChange:a=>n(a),value:m,children:[(0,b.jsx)(aL.SelectTrigger,{className:"h-9 w-[140px] text-sm",children:(0,b.jsx)(aL.SelectValue,{placeholder:"Sort by"})}),(0,b.jsxs)(aL.SelectContent,{children:[(0,b.jsx)(aL.SelectItem,{value:"start_time",children:"Sort by Time"}),(0,b.jsx)(aL.SelectItem,{value:"customer",children:"Sort by Customer"}),(0,b.jsx)(aL.SelectItem,{value:"status",children:"Sort by Status"})]})]})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===x.length?(0,b.jsx)(F,{actionLabel:"Clear Filters",onAction:D,variant:"no_results"}):(0,b.jsx)("div",{className:"space-y-6 p-4",children:Object.entries(z).map(([a,c])=>(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,b.jsx)("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:a}),(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[c.length," ",1===c.length?"job":"jobs"]})]}),(0,b.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,b.jsx)(ai,{job:a,onClick:()=>q(a),showDate:"date"!==k,showTechnician:"technician"!==k},a.id))})]},a))})}),(0,b.jsxs)(v.Button,{className:"fixed right-4 bottom-20 lg:bottom-4 h-14 w-14 rounded-full shadow-lg",onClick:()=>{window.location.href="/dashboard/work/jobs/new"},size:"icon",children:[(0,b.jsx)(an.Plus,{className:"h-6 w-6"}),(0,b.jsx)("span",{className:"sr-only",children:"Create new job"})]}),(0,b.jsx)(ag,{isOpen:null!==o,job:o,onAction:E,onClose:()=>q(null)})]}):(0,b.jsx)("div",{className:"flex h-full flex-col",children:(0,b.jsx)(F,{onAction:()=>{window.location.href="/dashboard/work/jobs/new"},variant:"no_jobs"})})}var aO=a.i(788568),aP=a.i(591065),aQ=a.i(90617),aR=a.i(838441),aS=a.i(238221);function aT({date:a,jobs:c,isOpen:d,onClose:e,onJobTap:f,onAction:g}){if(!a)return null;let h=(0,av.isToday)(a)?"Today":ay(a)?"Tomorrow":(0,p.format)(a,"EEEE, MMMM d"),i=c.reduce((a,b)=>{if(!b.scheduled_start||!b.scheduled_end)return a;let c=new Date(b.scheduled_start);return a+(new Date(b.scheduled_end).getTime()-c.getTime())/36e5},0);return(0,b.jsxs)(b.Fragment,{children:[d&&(0,b.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:e}),(0,b.jsxs)("div",{className:(0,D.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",d?"translate-y-0":"translate-y-full"),style:{maxHeight:"85vh"},children:[(0,b.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,b.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)(w.Calendar,{className:"h-5 w-5 text-primary"}),(0,b.jsx)("h2",{className:"text-lg font-semibold",children:h})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,p.format)(a,"MMMM d, yyyy")}),c.length>0&&(0,b.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[c.length," ",1===c.length?"job":"jobs"," Â·"," ",i.toFixed(1),"h total"]})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:e,size:"icon",variant:"ghost",children:[(0,b.jsx)(x.X,{className:"h-5 w-5"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,b.jsx)(V.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(85vh - 200px)"},children:(0,b.jsx)("div",{className:"p-4",children:0===c.length?(0,b.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,b.jsx)(w.Calendar,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,b.jsx)("p",{className:"text-sm font-medium mb-1",children:"No jobs scheduled"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:"Schedule an appointment for this day"}),(0,b.jsxs)(v.Button,{onClick:()=>{g("create_appointment",a)},size:"sm",variant:"default",children:[(0,b.jsx)(an.Plus,{className:"h-4 w-4 mr-2"}),"New Appointment"]})]}):(0,b.jsx)("div",{className:"space-y-2",children:c.map(a=>(0,b.jsx)(ai,{job:a,onClick:()=>f(a),showDate:!1,showTechnician:!0},a.id))})})}),c.length>0&&(0,b.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(v.Button,{className:"flex-1",onClick:()=>{g("create_appointment",a)},size:"default",variant:"outline",children:[(0,b.jsx)(an.Plus,{className:"h-4 w-4 mr-2"}),"New Appointment"]}),(0,b.jsxs)(v.Button,{className:"flex-1",onClick:()=>{g("view_day",a)},size:"default",variant:"default",children:[(0,b.jsx)(w.Calendar,{className:"h-4 w-4 mr-2"}),"View Day Schedule"]})]})})]})]})}let aU=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],aV=["S","M","T","W","T","F","S"],aW=a=>{switch(a?.toLowerCase()){case"scheduled":return"bg-blue-500";case"dispatched":return"bg-sky-500";case"arrived":return"bg-emerald-400";case"in_progress":return"bg-amber-500";case"closed":case"completed":return"bg-emerald-600";case"cancelled":return"bg-slate-400";default:return"bg-slate-500"}};function aX({date:a,jobs:d,isCurrentMonth:e,onDayTap:f,onJobTap:g}){let h=(0,av.isToday)(a),i=d.length>0,j=0===a.getDay()||6===a.getDay(),k=(0,c.useMemo)(()=>d.reduce((a,b)=>{let c=b.status?.toLowerCase()||"scheduled";return a[c]=(a[c]||0)+1,a},{}),[d]),l=(0,c.useMemo)(()=>Object.entries(k).sort(([,a],[,b])=>b-a).slice(0,3),[k]);return(0,b.jsxs)("button",{className:(0,D.cn)("flex h-24 sm:h-28 flex-col border-r border-b p-1.5 sm:p-2 text-left transition-all active:scale-95",!e&&"bg-muted/50 opacity-60",h&&"bg-blue-50 ring-2 ring-inset ring-blue-500/50 dark:bg-blue-950/30",j&&!h&&"bg-slate-100/80 dark:bg-slate-800/30"),onClick:()=>f(a,d),type:"button",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-1 mb-1",children:[(0,b.jsx)("span",{className:(0,D.cn)("flex h-6 w-6 sm:h-7 sm:w-7 items-center justify-center rounded-full text-xs sm:text-sm font-bold",h&&"bg-blue-500 text-white shadow-md",!h&&!e&&"text-muted-foreground/60",!h&&e&&"text-foreground"),children:(0,p.format)(a,"d")}),i&&(0,b.jsx)(P.Badge,{className:"h-4 px-1.5 text-[9px] sm:text-[10px] font-semibold",variant:"secondary",children:d.length})]}),i&&(0,b.jsx)("div",{className:"flex flex-wrap gap-0.5",children:l.map(([a,c])=>(0,b.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,b.jsx)("div",{className:(0,D.cn)("h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full",aW(a))}),c>1&&(0,b.jsx)("span",{className:"text-[8px] sm:text-[9px] text-muted-foreground font-medium",children:c})]},a))}),i&&(0,b.jsxs)("div",{className:"hidden xs:flex flex-col gap-0.5 mt-1 overflow-hidden",children:[d.slice(0,2).map(a=>(0,b.jsx)("button",{className:(0,D.cn)("flex items-center gap-1 rounded px-1 py-0.5 text-[8px] sm:text-[9px] font-medium transition-colors hover:opacity-80",aW(a.status),"text-white truncate"),onClick:b=>{b.stopPropagation(),g(a)},type:"button",children:(0,b.jsx)("span",{className:"truncate",children:a.customer?.name||a.title})},a.id)),d.length>2&&(0,b.jsxs)("span",{className:"text-[8px] text-muted-foreground ml-1",children:["+",d.length-2," more"]})]})]})}function aY(){let d=(0,i.useScheduleStore)(a=>a.jobs),{currentDate:e,goToToday:f,navigatePrevious:h,navigateNext:j}=(0,g.useScheduleViewStore)(),k=(0,c.useMemo)(()=>Array.from(d.values()),[d]),[l,m]=(0,c.useState)(null),[n,o]=(0,c.useState)(null),[r,w]=(0,c.useState)(!1),x=(0,c.useMemo)(()=>e instanceof Date?e:new Date(e),[e]),y=(0,c.useMemo)(()=>{let a=(0,aR.startOfMonth)(x),b=(0,aO.endOfMonth)(x),c=(0,aS.startOfWeek)(a),d=(0,aP.endOfWeek)(b),e=[],f=c;for(;f<=d;)e.push(f),f=(0,aw.addDays)(f,1);return e},[x]),z=(0,c.useMemo)(()=>{if(!r)return y;let a=(0,aS.startOfWeek)(x),b=[];for(let c=0;c<7;c++)b.push((0,aw.addDays)(a,c));return b},[r,x,y]),A=(0,c.useMemo)(()=>{let a=new Map;return k.forEach(b=>{if(!b.scheduled_start)return;let c=new Date(b.scheduled_start),d=(0,p.format)(c,"yyyy-MM-dd");a.has(d)||a.set(d,[]),a.get(d)?.push(b)}),a.forEach(a=>{a.sort((a,b)=>a.scheduled_start?b.scheduled_start?new Date(a.scheduled_start).getTime()-new Date(b.scheduled_start).getTime():-1:1)}),a},[k]),B=(0,c.useCallback)((a,b)=>{o({date:a,jobs:b})},[]),C=(0,c.useCallback)(a=>{m(a)},[]),E=(0,c.useCallback)(async(b,c,...d)=>{m(null);try{switch(b){case"view_details":window.location.href=`/dashboard/work/jobs/${c.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:e}=await a.A(965863),f="move_to_status"===b?d[0]:b,g=await e(c.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[b]||f);g.success?(u.toast.success(`Job ${"move_to_status"===b?"moved to "+f:b+"ed"}`),window.location.reload()):u.toast.error(g.error||"Failed to update job status");break}case"reschedule":{let[b,e]=d,{updateJob:f}=await a.A(965863),g=await f({jobId:c.id,scheduled_start:b.toISOString(),scheduled_end:e.toISOString()});g.success?(u.toast.success("Job rescheduled"),window.location.reload()):u.toast.error(g.error||"Failed to reschedule job");break}case"reassign":{let b=d[0];if(b){let{assignJobToTechnician:d}=await a.A(959763),e=await d(c.id,b);e.success?(u.toast.success("Job reassigned"),window.location.reload()):u.toast.error(e.error||"Failed to reassign job")}else u.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:b}=await a.A(959763),d=await b(c.id);d.success?(u.toast.success("Job cancelled"),window.location.reload()):u.toast.error(d.error||"Failed to cancel job");break}default:console.warn("Unknown action:",b)}}catch(a){console.error("Job action error:",a),u.toast.error("An error occurred")}},[]),F=(0,c.useCallback)((a,b)=>{switch(o(null),a){case"view_day":window.location.href=`/dashboard/schedule?view=day&date=${(0,p.format)(b,"yyyy-MM-dd")}`;break;case"create_appointment":window.location.href=`/dashboard/work/appointments/new?date=${(0,p.format)(b,"yyyy-MM-dd")}`;break;case"create_job":window.location.href=`/dashboard/work/jobs/new?date=${(0,p.format)(b,"yyyy-MM-dd")}`;break;default:console.warn("Unknown day action:",a)}},[]),G=(0,q.isSameDay)(x,new Date);return(0,b.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,b.jsxs)("div",{className:"shrink-0 border-b bg-background",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-4",children:[(0,b.jsxs)(v.Button,{className:"h-9 w-9",onClick:h,size:"icon",variant:"ghost",children:[(0,b.jsx)(s.ChevronLeft,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Previous month"})]}),(0,b.jsxs)("div",{className:"flex flex-col items-center",children:[(0,b.jsxs)("h2",{className:"text-base sm:text-lg font-semibold",children:[(0,p.format)(x,r?"MMM d - ":"MMMM yyyy"),r&&(0,p.format)((0,aw.addDays)((0,aS.startOfWeek)(x),6),"MMM d, yyyy")]}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:[A.size," days with jobs"]})]}),(0,b.jsxs)(v.Button,{className:"h-9 w-9",onClick:j,size:"icon",variant:"ghost",children:[(0,b.jsx)(t.ChevronRight,{className:"h-4 w-4"}),(0,b.jsx)("span",{className:"sr-only",children:"Next month"})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 px-3 sm:px-4 pb-3",children:[(0,b.jsx)(v.Button,{className:"flex-1 h-8 text-xs",onClick:()=>w(!r),size:"sm",variant:"outline",children:r?"Show Month":"Show Week"}),!G&&(0,b.jsx)(v.Button,{className:"flex-1 h-8 text-xs",onClick:f,size:"sm",variant:"outline",children:"Today"})]})]}),(0,b.jsx)("div",{className:"flex-1 overflow-auto",children:(0,b.jsxs)("div",{className:"grid grid-cols-7 h-full",children:[aU.map((a,c)=>(0,b.jsxs)("div",{className:(0,D.cn)("sticky top-0 z-10 bg-muted/80 backdrop-blur-sm border-r border-b px-1 py-2 text-center text-[10px] sm:text-xs font-bold uppercase",(0===c||6===c)&&"bg-slate-200/80 dark:bg-slate-700/50"),children:[(0,b.jsx)("span",{className:"hidden xs:inline",children:a}),(0,b.jsx)("span",{className:"xs:hidden",children:aV[c]})]},a)),z.map(a=>{let c=(0,p.format)(a,"yyyy-MM-dd"),d=A.get(c)||[],e=(0,aQ.isSameMonth)(a,x);return(0,b.jsx)(aX,{date:a,isCurrentMonth:e,jobs:d,onDayTap:B,onJobTap:C},a.toISOString())})]})}),(0,b.jsx)(ag,{isOpen:null!==l,job:l,onAction:E,onClose:()=>m(null)}),(0,b.jsx)(aT,{date:n?.date||null,isOpen:null!==n,jobs:n?.jobs||[],onAction:F,onClose:()=>o(null),onJobTap:C})]})}let aZ=(0,j.default)(async()=>{},{loadableGenerated:{modules:[5456]},loading:()=>(0,b.jsx)("div",{className:"flex h-full w-full flex-col gap-4 p-4",children:(0,b.jsx)("div",{className:"grid grid-cols-7 gap-2",children:Array.from({length:35}).map((a,c)=>(0,b.jsx)(k.Skeleton,{className:"aspect-square w-full"},c))})}),ssr:!1});function a$(){return(0,b.jsx)(aZ,{})}function a_({initialData:a,bootstrapError:j}){let k=(0,i.useScheduleStore)(a=>a.hydrateFromServer),{viewMode:l}=(0,g.useScheduleViewStore)(),n=(0,e.useIsMobile)(),p=(0,c.useMemo)(()=>a?(0,h.deserializeScheduleBootstrap)(a):null,[a]);return!function(){let a=(0,f.useRouter)(),{goToToday:b,navigatePrevious:d,navigateNext:e,setViewMode:h}=(0,g.useScheduleViewStore)();(0,c.useEffect)(()=>{let c=c=>{let f=c.target;if("INPUT"!==f.tagName&&"TEXTAREA"!==f.tagName&&!f.isContentEditable&&!c.ctrlKey&&!c.metaKey&&!c.altKey)switch(c.key.toLowerCase()){case"t":c.preventDefault(),b();break;case"n":c.preventDefault(),a.push("/dashboard/work/new");break;case"[":c.preventDefault(),d();break;case"]":c.preventDefault(),e();break;case"1":c.preventDefault(),h("day");break;case"2":c.preventDefault(),h("month");break;case"3":c.preventDefault(),h("week")}};return document.addEventListener("keydown",c),()=>{document.removeEventListener("keydown",c)}},[b,d,e,h,a])}(),(0,c.useEffect)(()=>{p&&k(p)},[k,p]),(0,b.jsxs)("div",{className:"m-0 flex h-full w-full flex-1 flex-col overflow-hidden p-0",children:[j&&(0,b.jsxs)(d.Alert,{className:"mx-3 md:mx-4 mt-2 mb-3 md:mb-4 max-w-2xl self-center",variant:"destructive",children:[(0,b.jsx)(d.AlertTitle,{children:"Live schedule data unavailable"}),(0,b.jsxs)(d.AlertDescription,{children:[j,". Showing the scheduler without preloaded jobsâ€”use the refresh controls after fixing the issue."]})]}),n?(0,b.jsx)(b.Fragment,{children:"list"===l?(0,b.jsx)(aN,{}):"day"===l?(0,b.jsx)(as,{}):"week"===l?(0,b.jsx)(au,{}):"month"===l?(0,b.jsx)(aY,{}):(0,b.jsx)(aN,{})}):(0,b.jsx)(b.Fragment,{children:"month"===l?(0,b.jsx)(a$,{}):"week"===l?(0,b.jsx)(o,{}):"list"===l?(0,b.jsx)(aN,{}):(0,b.jsx)(m,{})})]})}a.s(["SchedulePageClient",()=>a_],726458)}];

//# sourceMappingURL=apps_web_src_components_schedule_schedule-page-client_tsx_22a07ea1._.js.map