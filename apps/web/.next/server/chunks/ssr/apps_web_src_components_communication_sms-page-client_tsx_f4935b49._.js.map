{"version":3,"sources":["../../../../../../apps/web/src/components/communication/sms-page-client.tsx"],"sourcesContent":["/**\n * SMS Communication Page\n *\n * Single page for all SMS folders with filter-based navigation\n * Route: /dashboard/communication/sms?folder=inbox\n *\n * Shows SMS list on left, detail panel on right when SMS is selected\n */\n\n\"use client\";\n\nimport {\n\tAlertTriangle,\n\tArchive,\n\tArrowLeft,\n\tLoader2,\n\tMessageSquare,\n\tMoreHorizontal,\n\tPanelLeft,\n\tPaperclip,\n\tPlus,\n\tRefreshCw,\n\tReply,\n\tSend,\n\tStar,\n\tStickyNote,\n\tTrash,\n\tX,\n} from \"lucide-react\";\nimport { useRouter, useSearchParams } from \"next/navigation\";\nimport { useCallback, useEffect, useRef, useState, useTransition } from \"react\";\nimport { toast } from \"sonner\";\nimport type {\n\tCompanySms,\n\tGetSmsResult,\n\tSmsTemplateContext,\n} from \"@/actions/sms-actions\";\n\n// Type for message attachments stored in provider_metadata\ntype MessageAttachment = {\n\ttype?: string;\n\turl?: string;\n\tfilename?: string;\n};\n\nimport {\n\tgetCompanyContextAction,\n\tgetSmsAction,\n\tgetSmsByIdAction,\n\tgetSmsConversationAction,\n\tmarkSmsAsReadAction,\n\tmarkSmsConversationAsReadAction,\n} from \"@/actions/sms-actions\";\nimport { sendTextMessage } from \"@/actions/twilio\";\nimport { SmsMessageInput } from \"@/components/communication/sms-message-input\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { Separator } from \"@/components/ui/separator\";\nimport { useSidebar } from \"@/components/ui/sidebar\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { cn } from \"@/lib/utils\";\n\ntype SmsPageClientProps = {\n\tinitialSms: GetSmsResult;\n\tinitialFolder: string;\n\tinitialSmsId: string | null;\n};\n\nexport function SmsPageClient({\n\tinitialSms,\n\tinitialFolder,\n\tinitialSmsId,\n}: SmsPageClientProps) {\n\tconst router = useRouter();\n\tconst { toggleSidebar } = useSidebar();\n\tconst searchParams = useSearchParams();\n\tconst folder = searchParams.get(\"folder\") || initialFolder;\n\tconst smsId = searchParams.get(\"id\") || initialSmsId;\n\tconst [isPending, startTransition] = useTransition();\n\tconst [sms, setSms] = useState<GetSmsResult | null>(initialSms);\n\tconst [loading, setLoading] = useState(false);\n\tconst [refreshing, setRefreshing] = useState(false);\n\tconst [error, setError] = useState<string | null>(null);\n\tconst [selectedSms, setSelectedSms] = useState<CompanySms | null>(null);\n\tconst [conversationMessages, setConversationMessages] = useState<\n\t\tCompanySms[]\n\t>([]);\n\tconst [loadingConversation, setLoadingConversation] = useState(false);\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst [searchInput, setSearchInput] = useState(\"\");\n\tconst [messageInput, setMessageInput] = useState(\"\");\n\tconst [sendingMessage, setSendingMessage] = useState(false);\n\tconst [attachments, setAttachments] = useState<File[]>([]);\n\tconst [companyContext, setCompanyContext] =\n\t\tuseState<SmsTemplateContext | null>(null);\n\tconst searchTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\tconst selectedSmsRef = useRef<CompanySms | null>(null);\n\tconst conversationScrollRef = useRef<HTMLDivElement>(null);\n\n\t// Fetch SMS messages function with optimistic loading\n\tconst fetchSms = useCallback(\n\t\tasync (showRefreshing = false) => {\n\t\t\tif (showRefreshing) {\n\t\t\t\tsetRefreshing(true);\n\t\t\t} else {\n\t\t\t\tsetLoading(true);\n\t\t\t}\n\t\t\tsetError(null);\n\n\t\t\tstartTransition(async () => {\n\t\t\t\ttry {\n\t\t\t\t\tconst result = await getSmsAction({\n\t\t\t\t\t\tlimit: 50,\n\t\t\t\t\t\toffset: 0,\n\t\t\t\t\t\ttype: \"all\",\n\t\t\t\t\t\tfolder: folder === \"inbox\" ? undefined : folder,\n\t\t\t\t\t\tsearch: searchQuery || undefined,\n\t\t\t\t\t\tsortBy: \"created_at\",\n\t\t\t\t\t\tsortOrder: \"desc\",\n\t\t\t\t\t});\n\n\t\t\t\t\tsetSms(result);\n\n\t\t\t\t\t// Update selected SMS if it still exists (preserve selection)\n\t\t\t\t\tconst currentSelected = selectedSmsRef.current;\n\t\t\t\t\tif (currentSelected) {\n\t\t\t\t\t\tconst updatedSms = result.sms.find(\n\t\t\t\t\t\t\t(s) => s.id === currentSelected.id,\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (updatedSms) {\n\t\t\t\t\t\t\tsetSelectedSms(updatedSms);\n\t\t\t\t\t\t\tselectedSmsRef.current = updatedSms;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsetSelectedSms(null);\n\t\t\t\t\t\t\tselectedSmsRef.current = null;\n\t\t\t\t\t\t\tsetConversationMessages([]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} catch (err) {\n\t\t\t\t\tconst errorMessage =\n\t\t\t\t\t\terr instanceof Error ? err.message : \"Failed to load SMS\";\n\t\t\t\t\tsetError(errorMessage);\n\t\t\t\t\ttoast.error(\"Failed to load SMS\", { description: errorMessage });\n\t\t\t\t} finally {\n\t\t\t\t\tsetLoading(false);\n\t\t\t\t\tsetRefreshing(false);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t[searchQuery, folder],\n\t);\n\n\t// Refetch when folder or search changes (but not on initial mount - we have initialSms)\n\tconst isInitialMount = useRef(true);\n\tuseEffect(() => {\n\t\tif (isInitialMount.current) {\n\t\t\tisInitialMount.current = false;\n\t\t\treturn;\n\t\t}\n\t\tfetchSms();\n\t\t// eslint-disable-next-line react-hooks/exhaustive-deps\n\t}, [folder, searchQuery]); // Refetch on folder/search change\n\n\t// Fetch company context once on mount (for template auto-fill)\n\tuseEffect(() => {\n\t\tgetCompanyContextAction().then((result) => {\n\t\t\tif (result.success && result.context) {\n\t\t\t\tsetCompanyContext(result.context);\n\t\t\t}\n\t\t});\n\t}, []);\n\n\t// Handle search input with debounce\n\tuseEffect(() => {\n\t\tif (searchTimeoutRef.current) {\n\t\t\tclearTimeout(searchTimeoutRef.current);\n\t\t}\n\n\t\tsearchTimeoutRef.current = setTimeout(() => {\n\t\t\tsetSearchQuery(searchInput);\n\t\t}, 300);\n\n\t\treturn () => {\n\t\t\tif (searchTimeoutRef.current) {\n\t\t\t\tclearTimeout(searchTimeoutRef.current);\n\t\t\t}\n\t\t};\n\t}, [searchInput]);\n\n\t// Fetch conversation messages for a phone number\n\tconst fetchConversation = useCallback(async (phoneNumber: string) => {\n\t\tif (!phoneNumber) return;\n\n\t\tsetLoadingConversation(true);\n\t\ttry {\n\t\t\tconst result = await getSmsConversationAction(phoneNumber);\n\t\t\tif (result.success && result.messages) {\n\t\t\t\tsetConversationMessages(result.messages);\n\n\t\t\t\t// Mark all unread messages in conversation as read\n\t\t\t\tconst unreadMessages = result.messages.filter(\n\t\t\t\t\t(msg) => !msg.read_at && msg.direction === \"inbound\",\n\t\t\t\t);\n\t\t\t\tif (unreadMessages.length > 0) {\n\t\t\t\t\t// Optimistically update UI\n\t\t\t\t\tsetConversationMessages((prev) =>\n\t\t\t\t\t\tprev.map((msg) =>\n\t\t\t\t\t\t\t!msg.read_at && msg.direction === \"inbound\"\n\t\t\t\t\t\t\t\t? { ...msg, read_at: new Date().toISOString() }\n\t\t\t\t\t\t\t\t: msg,\n\t\t\t\t\t\t),\n\t\t\t\t\t);\n\n\t\t\t\t\t// Update database\n\t\t\t\t\tmarkSmsConversationAsReadAction(phoneNumber)\n\t\t\t\t\t\t.then((result) => {\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\t// Update conversation messages optimistically (don't reload list)\n\t\t\t\t\t\t\t\tsetConversationMessages((prev) =>\n\t\t\t\t\t\t\t\t\tprev.map((msg) =>\n\t\t\t\t\t\t\t\t\t\t!msg.read_at && msg.direction === \"inbound\"\n\t\t\t\t\t\t\t\t\t\t\t? { ...msg, read_at: new Date().toISOString() }\n\t\t\t\t\t\t\t\t\t\t\t: msg,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t// Update SMS list optimistically (don't reload)\n\t\t\t\t\t\t\t\tsetSms((prev) => {\n\t\t\t\t\t\t\t\t\tif (!prev) return prev;\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\t\tsms: prev.sms.map((s) =>\n\t\t\t\t\t\t\t\t\t\t\t!s.read_at &&\n\t\t\t\t\t\t\t\t\t\t\ts.direction === \"inbound\" &&\n\t\t\t\t\t\t\t\t\t\t\t(s.from_address === phoneNumber ||\n\t\t\t\t\t\t\t\t\t\t\t\ts.to_address === phoneNumber)\n\t\t\t\t\t\t\t\t\t\t\t\t? { ...s, read_at: new Date().toISOString() }\n\t\t\t\t\t\t\t\t\t\t\t\t: s,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t// Notify sidebar to refresh counts (but don't reload SMS list)\n\t\t\t\t\t\t\t\twindow.dispatchEvent(new CustomEvent(\"sms-read\"));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t// Error marking as read - fail silently\n\t\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\t// Scroll to bottom after messages load\n\t\t\t\tsetTimeout(() => {\n\t\t\t\t\tif (conversationScrollRef.current) {\n\t\t\t\t\t\tconversationScrollRef.current.scrollTop =\n\t\t\t\t\t\t\tconversationScrollRef.current.scrollHeight;\n\t\t\t\t\t}\n\t\t\t\t}, 100);\n\t\t\t}\n\t\t} catch (err) {\n\t\t\ttoast.error(\"Failed to load conversation\");\n\t\t} finally {\n\t\t\tsetLoadingConversation(false);\n\t\t}\n\t}, []);\n\n\t// Handle SMS selection - update URL but stay on same page (no refresh)\n\tconst handleSmsSelect = useCallback(\n\t\t(sms: CompanySms) => {\n\t\t\t// Optimistic: Update state immediately (no waiting for navigation)\n\t\t\tsetSelectedSms(sms);\n\t\t\tselectedSmsRef.current = sms;\n\n\t\t\t// Update URL using replace (not push) to avoid page refresh\n\t\t\tconst queryParams = new URLSearchParams();\n\t\t\tif (folder && folder !== \"inbox\") queryParams.set(\"folder\", folder);\n\t\t\tqueryParams.set(\"id\", sms.id);\n\n\t\t\trouter.replace(`/dashboard/communication/sms?${queryParams.toString()}`, {\n\t\t\t\tscroll: false,\n\t\t\t});\n\n\t\t\t// Fetch conversation thread immediately (this shows the messages)\n\t\t\tconst phoneNumber =\n\t\t\t\tsms.direction === \"inbound\" ? sms.from_address : sms.to_address;\n\t\t\tif (phoneNumber) {\n\t\t\t\tfetchConversation(phoneNumber);\n\t\t\t}\n\n\t\t\t// Optimistic update for read status (after conversation is loading)\n\t\t\tif (!sms.read_at) {\n\t\t\t\tsetSms((prev) => {\n\t\t\t\t\tif (!prev) return prev;\n\t\t\t\t\treturn {\n\t\t\t\t\t\t...prev,\n\t\t\t\t\t\tsms: prev.sms.map((s) =>\n\t\t\t\t\t\t\ts.id === sms.id ? { ...s, read_at: new Date().toISOString() } : s,\n\t\t\t\t\t\t),\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t\t\t// Mark as read in background (don't wait, don't reload list)\n\t\t\t\tmarkSmsAsReadAction({ smsId: sms.id })\n\t\t\t\t\t.then((success) => {\n\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\t// Only update the specific SMS in the list, don't reload everything\n\t\t\t\t\t\t\tsetSms((prev) => {\n\t\t\t\t\t\t\t\tif (!prev) return prev;\n\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\tsms: prev.sms.map((s) =>\n\t\t\t\t\t\t\t\t\t\ts.id === sms.id\n\t\t\t\t\t\t\t\t\t\t\t? { ...s, read_at: new Date().toISOString() }\n\t\t\t\t\t\t\t\t\t\t\t: s,\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t// Notify sidebar to refresh counts (but don't reload SMS list)\n\t\t\t\t\t\t\twindow.dispatchEvent(new CustomEvent(\"sms-read\"));\n\t\t\t\t\t\t}\n\t\t\t\t\t})\n\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t// Error marking as read - fail silently\n\t\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t[router, folder, fetchConversation],\n\t);\n\n\t// Load SMS from URL if ID is present (from path or query)\n\t// Only run if smsId changed and SMS isn't already selected (prevents double-loading)\n\t// This handles direct URL navigation (e.g., sharing a link)\n\tuseEffect(() => {\n\t\t// Skip if SMS is already selected (handleSmsSelect already handled it)\n\t\tif (smsId && smsId === selectedSmsRef.current?.id) {\n\t\t\treturn;\n\t\t}\n\n\t\tif (smsId && sms?.sms) {\n\t\t\tconst smsMessage = sms.sms.find((s) => s.id === smsId);\n\t\t\tif (smsMessage) {\n\t\t\t\t// Update state directly without calling handleSmsSelect (to avoid URL update loop)\n\t\t\t\tsetSelectedSms(smsMessage);\n\t\t\t\tselectedSmsRef.current = smsMessage;\n\n\t\t\t\t// Fetch conversation thread immediately (this shows the messages)\n\t\t\t\tconst phoneNumber =\n\t\t\t\t\tsmsMessage.direction === \"inbound\"\n\t\t\t\t\t\t? smsMessage.from_address\n\t\t\t\t\t\t: smsMessage.to_address;\n\t\t\t\tif (phoneNumber) {\n\t\t\t\t\tfetchConversation(phoneNumber);\n\t\t\t\t}\n\n\t\t\t\t// Optimistic update for read status (after conversation is loading)\n\t\t\t\tif (!smsMessage.read_at) {\n\t\t\t\t\tsetSms((prev) => {\n\t\t\t\t\t\tif (!prev) return prev;\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\tsms: prev.sms.map((s) =>\n\t\t\t\t\t\t\t\ts.id === smsMessage.id\n\t\t\t\t\t\t\t\t\t? { ...s, read_at: new Date().toISOString() }\n\t\t\t\t\t\t\t\t\t: s,\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t};\n\t\t\t\t\t});\n\t\t\t\t\tmarkSmsAsReadAction({ smsId: smsMessage.id })\n\t\t\t\t\t\t.then((success) => {\n\t\t\t\t\t\t\tif (success) {\n\t\t\t\t\t\t\t\t// Only update the specific SMS in the list, don't reload everything\n\t\t\t\t\t\t\t\tsetSms((prev) => {\n\t\t\t\t\t\t\t\t\tif (!prev) return prev;\n\t\t\t\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t\t\t\t...prev,\n\t\t\t\t\t\t\t\t\t\tsms: prev.sms.map((s) =>\n\t\t\t\t\t\t\t\t\t\t\ts.id === smsMessage.id\n\t\t\t\t\t\t\t\t\t\t\t\t? { ...s, read_at: new Date().toISOString() }\n\t\t\t\t\t\t\t\t\t\t\t\t: s,\n\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t// Notify sidebar to refresh counts (but don't reload SMS list)\n\t\t\t\t\t\t\t\twindow.dispatchEvent(new CustomEvent(\"sms-read\"));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {\n\t\t\t\t\t\t\t// Error marking as read - fail silently\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else if (!smsMessage) {\n\t\t\t\tstartTransition(async () => {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst result = await getSmsByIdAction(smsId);\n\t\t\t\t\t\tif (result.success && result.sms) {\n\t\t\t\t\t\t\tsetSelectedSms(result.sms);\n\t\t\t\t\t\t\tselectedSmsRef.current = result.sms;\n\n\t\t\t\t\t\t\t// Fetch conversation thread\n\t\t\t\t\t\t\tconst phoneNumber =\n\t\t\t\t\t\t\t\tresult.sms.direction === \"inbound\"\n\t\t\t\t\t\t\t\t\t? result.sms.from_address\n\t\t\t\t\t\t\t\t\t: result.sms.to_address;\n\t\t\t\t\t\t\tif (phoneNumber) {\n\t\t\t\t\t\t\t\tfetchConversation(phoneNumber);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\t// Failed to fetch SMS by ID - fail silently\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else if (!smsId && selectedSms) {\n\t\t\tsetSelectedSms(null);\n\t\t\tselectedSmsRef.current = null;\n\t\t\tsetConversationMessages([]);\n\t\t}\n\t}, [smsId, sms?.sms, fetchConversation]);\n\n\tconst handleRefresh = useCallback(() => {\n\t\tfetchSms(true);\n\t\ttoast.success(\"Refreshing SMS...\");\n\t}, [fetchSms]);\n\n\tconst handleDelete = useCallback(\n\t\tasync (smsId: string) => {\n\t\t\tif (!confirm(\"Are you sure you want to delete this SMS?\")) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\ttoast.success(\"SMS deleted\");\n\n\t\t\t\tif (sms) {\n\t\t\t\t\tsetSms({\n\t\t\t\t\t\t...sms,\n\t\t\t\t\t\tsms: sms.sms.filter((s) => s.id !== smsId),\n\t\t\t\t\t\ttotal: sms.total - 1,\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tif (selectedSms?.id === smsId) {\n\t\t\t\t\tsetSelectedSms(null);\n\t\t\t\t\tsetConversationMessages([]);\n\t\t\t\t\tconst params = new URLSearchParams();\n\t\t\t\t\tif (folder && folder !== \"inbox\") params.set(\"folder\", folder);\n\t\t\t\t\trouter.push(\n\t\t\t\t\t\t`/dashboard/communication/sms${params.toString() ? `?${params.toString()}` : \"\"}`,\n\t\t\t\t\t\t{ scroll: false },\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} catch (err) {\n\t\t\t\ttoast.error(\"Failed to delete SMS\", {\n\t\t\t\t\tdescription: err instanceof Error ? err.message : \"Unknown error\",\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\t\t[sms, selectedSms, folder, router],\n\t);\n\n\tconst getSenderName = (sms: CompanySms) => {\n\t\tif (sms.customer?.first_name || sms.customer?.last_name) {\n\t\t\treturn `${sms.customer.first_name || \"\"} ${sms.customer.last_name || \"\"}`.trim();\n\t\t}\n\t\treturn sms.from_name || sms.from_address || \"Unknown\";\n\t};\n\n\tconst getSenderInitial = (sms: CompanySms) => {\n\t\tconst name = getSenderName(sms);\n\t\treturn name[0]?.toUpperCase() || \"U\";\n\t};\n\n\t// Handle file attachments\n\tconst handleAttachFiles = useCallback((files: File[]) => {\n\t\tsetAttachments((prev) => [...prev, ...files]);\n\t}, []);\n\n\t// Handle sending a message (with attachments support)\n\tconst handleSendMessage = useCallback(async () => {\n\t\tif (\n\t\t\t(!messageInput.trim() && attachments.length === 0) ||\n\t\t\t!selectedSms ||\n\t\t\tsendingMessage\n\t\t)\n\t\t\treturn;\n\n\t\tconst phoneNumber =\n\t\t\tselectedSms.direction === \"inbound\"\n\t\t\t\t? selectedSms.from_address\n\t\t\t\t: selectedSms.to_address;\n\t\tif (!phoneNumber) {\n\t\t\ttoast.error(\"Cannot determine recipient phone number\");\n\t\t\treturn;\n\t\t}\n\n\t\tsetSendingMessage(true);\n\t\ttry {\n\t\t\t// If we have attachments, upload them first and send as MMS\n\t\t\tif (attachments.length > 0) {\n\t\t\t\t// Upload files to storage and get URLs\n\t\t\t\tconst { uploadSmsAttachments } = await import(\"@/actions/sms-actions\");\n\t\t\t\tconst uploadResult = await uploadSmsAttachments(attachments);\n\n\t\t\t\tif (!uploadResult.success || !uploadResult.urls) {\n\t\t\t\t\ttoast.error(uploadResult.error || \"Failed to upload attachments\");\n\t\t\t\t\tsetSendingMessage(false);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Send MMS with attachments\n\t\t\t\tconst { sendMMSMessage } = await import(\"@/actions/twilio\");\n\t\t\t\tconst result = await sendMMSMessage({\n\t\t\t\t\tto: phoneNumber,\n\t\t\t\t\tfrom: \"\", // Will use default from company settings\n\t\t\t\t\ttext: messageInput.trim() || undefined,\n\t\t\t\t\tmediaUrls: uploadResult.urls,\n\t\t\t\t\tcustomerId: selectedSms.customer_id || undefined,\n\t\t\t\t});\n\n\t\t\t\tif (result.success) {\n\t\t\t\t\tsetMessageInput(\"\");\n\t\t\t\t\tsetAttachments([]);\n\t\t\t\t\ttoast.success(\"Message with attachments sent\");\n\t\t\t\t\t// Refresh conversation\n\t\t\t\t\tfetchConversation(phoneNumber);\n\t\t\t\t\t// Refresh SMS list\n\t\t\t\t\tfetchSms(true);\n\t\t\t\t} else {\n\t\t\t\t\ttoast.error(result.error || \"Failed to send message\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Send regular SMS\n\t\t\t\tconst result = await sendTextMessage({\n\t\t\t\t\tto: phoneNumber,\n\t\t\t\t\tfrom: \"\", // Will use default from company settings\n\t\t\t\t\ttext: messageInput.trim(),\n\t\t\t\t\tcustomerId: selectedSms.customer_id || undefined,\n\t\t\t\t});\n\n\t\t\t\tif (result.success) {\n\t\t\t\t\tsetMessageInput(\"\");\n\t\t\t\t\ttoast.success(\"Message sent\");\n\t\t\t\t\t// Refresh conversation\n\t\t\t\t\tfetchConversation(phoneNumber);\n\t\t\t\t\t// Refresh SMS list\n\t\t\t\t\tfetchSms(true);\n\t\t\t\t} else {\n\t\t\t\t\ttoast.error(result.error || \"Failed to send message\");\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (err) {\n\t\t\ttoast.error(\"Failed to send message\", {\n\t\t\t\tdescription: err instanceof Error ? err.message : \"Unknown error\",\n\t\t\t});\n\t\t} finally {\n\t\t\tsetSendingMessage(false);\n\t\t}\n\t}, [\n\t\tmessageInput,\n\t\tattachments,\n\t\tselectedSms,\n\t\tsendingMessage,\n\t\tfetchConversation,\n\t\tfetchSms,\n\t]);\n\n\t// Format timestamp for messages\n\tconst formatMessageTime = (date: string) => {\n\t\tconst messageDate = new Date(date);\n\t\tconst now = new Date();\n\t\tconst isToday = messageDate.toDateString() === now.toDateString();\n\n\t\tif (isToday) {\n\t\t\treturn messageDate.toLocaleTimeString(\"en-US\", {\n\t\t\t\thour: \"numeric\",\n\t\t\t\tminute: \"2-digit\",\n\t\t\t});\n\t\t}\n\n\t\treturn messageDate.toLocaleDateString(\"en-US\", {\n\t\t\tmonth: \"short\",\n\t\t\tday: \"numeric\",\n\t\t\thour: \"numeric\",\n\t\t\tminute: \"2-digit\",\n\t\t});\n\t};\n\n\t// Mobile: show list when no SMS selected, show detail when SMS selected\n\t// Desktop: always show both panels side by side\n\tconst showListOnMobile = !selectedSms;\n\tconst showDetailOnMobile = !!selectedSms;\n\n\treturn (\n\t\t<div className=\"flex h-full w-full flex-col overflow-hidden bg-sidebar\">\n\t\t\t<div className=\"flex flex-1 overflow-hidden min-h-0 md:gap-2\">\n\t\t\t\t{/* SMS List Panel - Hidden on mobile when SMS is selected */}\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"bg-card mb-1 shadow-sm flex flex-col overflow-hidden\",\n\t\t\t\t\t\t\"w-full h-full\", // Mobile: full width/height\n\t\t\t\t\t\t\"md:w-[400px] lg:w-[480px] md:rounded-tr-2xl\", // Desktop: fixed width with rounded corner\n\t\t\t\t\t\t// Mobile visibility logic\n\t\t\t\t\t\tshowListOnMobile ? \"flex\" : \"hidden md:flex\",\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"w-full h-full flex flex-col\">\n\t\t\t\t\t\t<div className=\"sticky top-0 z-15 flex items-center justify-between gap-1.5 p-2 pb-0 transition-colors bg-card\">\n\t\t\t\t\t\t\t<div className=\"w-full\">\n\t\t\t\t\t\t\t\t<div className=\"grid grid-cols-12 gap-2 mt-1\">\n\t\t\t\t\t\t\t\t\t<div className=\"col-span-12 flex gap-2\">\n\t\t\t\t\t\t\t\t\t\t{/* Sidebar toggle - larger on mobile for touch */}\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-10 w-10 p-0 md:h-8 md:w-8 shrink-0\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={toggleSidebar}\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Toggle sidebar\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<PanelLeft className=\"h-5 w-5 md:h-4 md:w-4\" />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t<div className=\"relative flex-1\">\n\t\t\t\t\t\t\t\t\t\t\t{/* Search input - text-base on mobile to prevent iOS zoom */}\n\t\t\t\t\t\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\t\t\t\t\t\t\tplaceholder=\"Search SMS...\"\n\t\t\t\t\t\t\t\t\t\t\t\tvalue={searchInput}\n\t\t\t\t\t\t\t\t\t\t\t\tonChange={(e) => setSearchInput(e.target.value)}\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-10 md:h-8 pl-9 pr-20 text-base md:text-sm border-input bg-white dark:bg-[#141414] dark:border-none\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t<svg\n\t\t\t\t\t\t\t\t\t\t\t\twidth=\"10\"\n\t\t\t\t\t\t\t\t\t\t\t\theight=\"10\"\n\t\t\t\t\t\t\t\t\t\t\t\tviewBox=\"0 0 10 10\"\n\t\t\t\t\t\t\t\t\t\t\t\tfill=\"none\"\n\t\t\t\t\t\t\t\t\t\t\t\txmlns=\"http://www.w3.org/2000/svg\"\n\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute left-3 top-1/2 -translate-y-1/2 fill-[#71717A] dark:fill-[#6F6F6F]\"\n\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t<path\n\t\t\t\t\t\t\t\t\t\t\t\t\tfillRule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tclipRule=\"evenodd\"\n\t\t\t\t\t\t\t\t\t\t\t\t\td=\"M6.81038 7.0756C6.18079 7.54011 5.40248 7.81466 4.56004 7.81466C2.46451 7.81466 0.765747 6.11589 0.765747 4.02037C0.765747 1.92484 2.46451 0.226074 4.56004 0.226074C6.65557 0.226074 8.35433 1.92484 8.35433 4.02037C8.35433 4.8628 8.07978 5.64112 7.61527 6.27071L9.70535 8.36078C9.92761 8.58305 9.92761 8.94341 9.70535 9.16568C9.48308 9.38794 9.12272 9.38794 8.90046 9.16568L6.81038 7.0756ZM7.21604 4.02037C7.21604 5.48724 6.02691 6.67637 4.56004 6.67637C3.09317 6.67637 1.90403 5.48724 1.90403 4.02037C1.90403 2.5535 3.09317 1.36436 4.56004 1.36436C6.02691 1.36436 7.21604 2.5535 7.21604 4.02037Z\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</svg>\n\t\t\t\t\t\t\t\t\t\t\t{searchInput && (\n\t\t\t\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSearchInput(\"\")}\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground\"\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<X className=\"h-3 w-3\" />\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={handleRefresh}\n\t\t\t\t\t\t\t\t\t\t\tdisabled={refreshing}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-10 w-10 p-0 md:h-8 md:w-8\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Refresh\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<RefreshCw\n\t\t\t\t\t\t\t\t\t\t\t\tclassName={`h-5 w-5 md:h-4 md:w-4 text-muted-foreground ${refreshing ? \"animate-spin\" : \"\"}`}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* SMS Items */}\n\t\t\t\t\t\t<div className=\"relative z-1 flex-1 overflow-hidden pt-0 min-h-0\">\n\t\t\t\t\t\t\t<div className=\"hide-link-indicator flex h-full w-full\">\n\t\t\t\t\t\t\t\t<div className=\"flex flex-1 flex-col\" id=\"sms-list-scroll\">\n\t\t\t\t\t\t\t\t\t<ScrollArea className=\"scrollbar-none flex-1 overflow-x-hidden h-full\">\n\t\t\t\t\t\t\t\t\t\t{loading ? (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center p-8\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Loader2 className=\"h-8 w-8 animate-spin text-primary mx-auto mb-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tLoading SMS...\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : error ? (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center p-8\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertTriangle className=\"h-8 w-8 text-destructive mx-auto mb-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-destructive mb-2 font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tFailed to load SMS\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mb-4\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{error}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => fetchSms()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tTry Again\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : sms?.sms?.length ? (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"min-h-[200px] px-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t{sms.sms.map((smsMessage) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\tconst isSelected = selectedSms?.id === smsMessage.id;\n\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={smsMessage.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"select-none md:my-1\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`hover:bg-accent group flex cursor-pointer flex-col items-start rounded-lg py-2 text-left text-sm transition-all hover:opacity-100 relative ${\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisSelected ? \"bg-accent opacity-100\" : \"\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t} ${!smsMessage.read_at ? \"opacity-100\" : \"opacity-60\"}`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => handleSmsSelect(smsMessage)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Hover Action Toolbar - pointer-events-none on container allows clicks to pass through */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"dark:bg-panelDark pointer-events-none absolute right-2 z-25 flex -translate-y-1/2 items-center gap-1 rounded-xl border bg-white p-1 opacity-0 shadow-sm group-hover:opacity-100 top-[-1] transition-opacity duration-200\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"pointer-events-auto h-6 w-6 overflow-visible p-0 hover:bg-accent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Star className=\"h-4 w-4 fill-transparent stroke-[#9D9D9D] dark:stroke-[#9D9D9D]\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"pointer-events-auto h-6 w-6 p-0 hover:bg-accent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AlertTriangle className=\"fill-[#9D9D9D] h-3.5 w-3.5\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"pointer-events-auto h-6 w-6 p-0 hover:bg-accent\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Archive className=\"fill-[#9D9D9D] h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"pointer-events-auto h-6 w-6 p-0 hover:bg-[#FDE4E9] dark:hover:bg-[#411D23]\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thandleDelete(smsMessage.id);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Trash className=\"fill-[#F43F5E] h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* SMS Card Content */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"relative flex w-full items-center justify-between gap-4 px-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Avatar */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Avatar className=\"h-8 w-8 shrink-0 rounded-full border\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"bg-white dark:bg-[#373737] text-[#9F9F9D] font-bold text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getSenderInitial(smsMessage)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Avatar>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* SMS Info */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex w-full justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"w-full\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Sender Name + Time */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex w-full flex-row items-center justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-row items-center gap-[4px]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={`font-${!smsMessage.read_at ? \"bold\" : \"bold\"} text-md flex items-baseline gap-1 group-hover:opacity-100`}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"line-clamp-1 overflow-hidden text-sm\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{getSenderName(smsMessage)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!smsMessage.read_at && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"ml-0.5 size-2 rounded-full bg-[#006FFE]\"></span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground text-nowrap text-xs font-normal opacity-70 transition-opacity group-hover:opacity-100 dark:text-[#8C8C8C]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{smsMessage.created_at\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? new Date(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsmsMessage.created_at,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t).toLocaleTimeString([], {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thour: \"2-digit\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tminute: \"2-digit\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Message Preview */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"mt-1 line-clamp-1 w-[95%] min-w-0 overflow-hidden text-sm text-[#8C8C8C]\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{smsMessage.body || \"No message\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center p-8\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<MessageSquare className=\"h-16 w-16 text-muted-foreground opacity-50 mx-auto mb-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium text-muted-foreground mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{searchQuery ? \"No SMS found\" : \"No SMS yet\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{searchQuery\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"Try adjusting your search terms\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"SMS messages will appear here when received\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</ScrollArea>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* SMS Detail - Right Panel (iPhone-style chat interface) */}\n\t\t\t\t{/* Mobile: shown when SMS selected, Desktop: always visible as flex-1 */}\n\t\t\t\t<div\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"bg-card mb-1 shadow-sm flex flex-col min-w-0 overflow-hidden\",\n\t\t\t\t\t\t\"w-full h-full\", // Mobile: full width/height\n\t\t\t\t\t\t\"md:rounded-tl-2xl md:flex-1\", // Desktop: rounded corner and flex\n\t\t\t\t\t\tshowDetailOnMobile ? \"flex\" : \"hidden md:flex\",\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"relative flex-1 min-h-0 flex flex-col\">\n\t\t\t\t\t\t{selectedSms ? (\n\t\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t\t{/* Header Toolbar */}\n\t\t\t\t\t\t\t\t<div className=\"sticky top-0 z-15 flex shrink-0 items-center justify-between gap-1.5 p-2 pb-0 transition-colors bg-card\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex flex-1 items-center gap-2\">\n\t\t\t\t\t\t\t\t\t\t{/* Back button (mobile) / Close button (desktop) */}\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\t\tsetSelectedSms(null);\n\t\t\t\t\t\t\t\t\t\t\t\tselectedSmsRef.current = null;\n\t\t\t\t\t\t\t\t\t\t\t\tsetConversationMessages([]);\n\t\t\t\t\t\t\t\t\t\t\t\tconst params = new URLSearchParams();\n\t\t\t\t\t\t\t\t\t\t\t\tif (folder && folder !== \"inbox\")\n\t\t\t\t\t\t\t\t\t\t\t\t\tparams.set(\"folder\", folder);\n\t\t\t\t\t\t\t\t\t\t\t\trouter.push(\n\t\t\t\t\t\t\t\t\t\t\t\t\t`/dashboard/communication/sms?${params.toString()}`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t{ scroll: false },\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-10 w-10 p-0 md:h-8 md:w-8 hover:bg-accent/80 active:bg-accent transition-colors\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"Back to list\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t{/* Arrow on mobile, X on desktop */}\n\t\t\t\t\t\t\t\t\t\t\t<ArrowLeft className=\"h-5 w-5 md:hidden text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t\t<X className=\"h-4 w-4 hidden md:block text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-10 w-10 p-0 md:h-8 md:w-8 hover:bg-accent/80 active:bg-accent transition-colors\"\n\t\t\t\t\t\t\t\t\t\t\ttitle=\"More options\"\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t<MoreHorizontal className=\"h-5 w-5 md:h-4 md:w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* Contact Info Section */}\n\t\t\t\t\t\t\t\t<div className=\"border-b border-border/50 px-2 py-4 space-y-3\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t<Avatar className=\"h-9 w-9 shrink-0 rounded-md\">\n\t\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"bg-muted text-muted-foreground font-semibold text-sm rounded-md\">\n\t\t\t\t\t\t\t\t\t\t\t\t{getSenderInitial(selectedSms)}\n\t\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"font-semibold text-sm text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t{getSenderName(selectedSms)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t{selectedSms.direction === \"inbound\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t? selectedSms.from_address || \"Unknown\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t: selectedSms.to_address || \"Unknown\"}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* Messages Area - iPhone Style */}\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tref={conversationScrollRef}\n\t\t\t\t\t\t\t\t\tclassName=\"flex-1 overflow-y-auto bg-card px-4 py-4\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{loadingConversation ? (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center h-full\">\n\t\t\t\t\t\t\t\t\t\t\t<Loader2 className=\"h-6 w-6 animate-spin text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : conversationMessages.length === 0 ? (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center justify-center h-full\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<MessageSquare className=\"h-12 w-12 text-muted-foreground opacity-50 mx-auto mb-2\" />\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tNo messages yet\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t\t{conversationMessages.map((msg, index) => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst isOutbound = msg.direction === \"outbound\";\n\t\t\t\t\t\t\t\t\t\t\t\tconst showTime =\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex === 0 ||\n\t\t\t\t\t\t\t\t\t\t\t\t\tnew Date(msg.created_at).getTime() -\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tnew Date(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconversationMessages[index - 1].created_at,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t).getTime() >\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t5 * 60 * 1000; // 5 minutes\n\n\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div key={msg.id} className=\"flex flex-col\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{showTime && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex justify-center my-2\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground bg-muted/50 px-2 py-1 rounded-full\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{formatMessageTime(msg.created_at)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"flex flex-col\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisOutbound ? \"items-end\" : \"items-start\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"max-w-[75%] rounded-2xl px-4 py-2 shadow-sm\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisOutbound\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary text-primary-foreground rounded-tr-sm\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-muted text-foreground rounded-tl-sm\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{/* Show attachments if present */}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{msg.provider_metadata &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttypeof msg.provider_metadata === \"object\" &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"attachments\" in msg.provider_metadata &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tArray.isArray(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmsg.provider_metadata.attachments,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmsg.provider_metadata.attachments.length >\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0 && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"mb-2 space-y-2\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmsg.body ? \"\" : \"\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(msg.provider_metadata.attachments as MessageAttachment[]).map(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(att, attIdx) => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst isImage =\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tatt.type === \"image\" ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(att.url &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/\\.(jpg|jpeg|png|gif|webp)$/i.test(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tatt.url,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t));\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={attIdx}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"rounded-lg overflow-hidden\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{isImage ? (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<img\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={att.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\talt={att.filename || \"Image\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"max-w-full max-h-64 object-contain rounded-lg\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tloading=\"lazy\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<a\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\thref={att.url}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttarget=\"_blank\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\trel=\"noopener noreferrer\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"flex items-center gap-2 p-2 rounded-lg hover:opacity-80 transition-opacity\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisOutbound\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-foreground/20\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-background/20\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Paperclip className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-xs truncate\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{att.filename ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"Attachment\"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{msg.body && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm whitespace-pre-wrap break-words\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{msg.body}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{!msg.body &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t(!msg.provider_metadata ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttypeof msg.provider_metadata !== \"object\" ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!(\"attachments\" in msg.provider_metadata) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t!Array.isArray(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmsg.provider_metadata.attachments,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t) ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tmsg.provider_metadata.attachments.length ===\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0) && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm opacity-70 italic\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tNo message content\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"text-xs text-muted-foreground mt-0.5\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tisOutbound ? \"text-right\" : \"text-left\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{new Date(msg.created_at).toLocaleTimeString(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t[],\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{ hour: \"2-digit\", minute: \"2-digit\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* Message Input - iPhone Style with Emojis & Attachments */}\n\t\t\t\t\t\t\t\t<SmsMessageInput\n\t\t\t\t\t\t\t\t\tvalue={messageInput}\n\t\t\t\t\t\t\t\t\tonChange={setMessageInput}\n\t\t\t\t\t\t\t\t\tonSend={handleSendMessage}\n\t\t\t\t\t\t\t\t\tonAttach={handleAttachFiles}\n\t\t\t\t\t\t\t\t\tsending={sendingMessage}\n\t\t\t\t\t\t\t\t\tdisabled={!selectedSms}\n\t\t\t\t\t\t\t\t\tplaceholder=\"Text Message\"\n\t\t\t\t\t\t\t\t\t// Pass customer context for templates\n\t\t\t\t\t\t\t\t\tcustomerId={selectedSms?.customer_id || undefined}\n\t\t\t\t\t\t\t\t\tcustomerName={\n\t\t\t\t\t\t\t\t\t\tselectedSms?.customer\n\t\t\t\t\t\t\t\t\t\t\t? `${selectedSms.customer.first_name || \"\"} ${selectedSms.customer.last_name || \"\"}`.trim()\n\t\t\t\t\t\t\t\t\t\t\t: undefined\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tcustomerFirstName={\n\t\t\t\t\t\t\t\t\t\tselectedSms?.customer?.first_name || undefined\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t// Pass company context for templates\n\t\t\t\t\t\t\t\t\tcompanyName={companyContext?.companyName}\n\t\t\t\t\t\t\t\t\tcompanyPhone={companyContext?.companyPhone}\n\t\t\t\t\t\t\t\t\t// Enable AI suggestions if customer is linked\n\t\t\t\t\t\t\t\t\tenableAiSuggestions={Boolean(selectedSms?.customer_id)}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t/* Empty State - No SMS Selected */\n\t\t\t\t\t\t\t<div className=\"flex flex-col items-center justify-center h-full px-4 py-8\">\n\t\t\t\t\t\t\t\t<div className=\"text-center space-y-4 max-w-md\">\n\t\t\t\t\t\t\t\t\t<MessageSquare className=\"h-16 w-16 text-muted-foreground opacity-50 mx-auto\" />\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t\t<h3 className=\"text-lg font-semibold text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\tNo conversation selected\n\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\tSelect a conversation from the list to view messages, or\n\t\t\t\t\t\t\t\t\t\t\tcreate a new SMS to get started.\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\t\tif (typeof window !== \"undefined\") {\n\t\t\t\t\t\t\t\t\t\t\t\twindow.dispatchEvent(\n\t\t\t\t\t\t\t\t\t\t\t\t\tnew CustomEvent(\"open-recipient-selector\", {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tdetail: { type: \"sms\" },\n\t\t\t\t\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\tclassName=\"mt-4 h-12 px-6 md:h-11 md:px-5\"\n\t\t\t\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Plus className=\"h-5 w-5 md:h-4 md:w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\t\tCreate new SMS\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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"}