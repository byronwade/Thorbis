{"version":3,"sources":["../../../../../../apps/web/src/components/layout/toolbar-stats-provider.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/lib/queries/stats-utils.ts","../../../../../../packages/database/src/error-helpers.ts","../../../../../../apps/web/src/components/properties/property-details/property-page-content.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/app/%28dashboard%29/dashboard/work/properties/%5Bid%5D/page.tsx","../../../../../../apps/web/src/components/properties/property-details/property-detail-data.tsx","../../../../../../apps/web/src/components/properties/property-details/property-detail-skeleton.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ToolbarStatsProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call ToolbarStatsProvider() from the server but ToolbarStatsProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/components/layout/toolbar-stats-provider.tsx\",\n    \"ToolbarStatsProvider\",\n);\n","/**\n * Statistics Utilities\n *\n * Helper functions to generate StatCard arrays from entity metrics\n * Used to generate toolbar stats from various entity types\n */\n\nimport type { StatCard } from \"@/components/ui/stats-cards\";\n\n/**\n * Format currency from cents to string\n */\nfunction formatCurrency(cents: number): string {\n\treturn new Intl.NumberFormat(\"en-US\", {\n\t\tstyle: \"currency\",\n\t\tcurrency: \"USD\",\n\t\tminimumFractionDigits: 0,\n\t\tmaximumFractionDigits: 0,\n\t}).format(cents / 100);\n}\n\n/**\n * Format hours to string\n */\nfunction formatHours(hours: number): string {\n\treturn `${hours.toFixed(1)}h`;\n}\n\n/**\n * Format percentage to string\n */\nfunction formatPercentage(value: number): string {\n\treturn `${value.toFixed(0)}%`;\n}\n\n/**\n * Generate job stats from metrics\n */\nfunction generateJobStats(metrics: {\n\ttotalAmount: number; // in cents\n\tpaidAmount: number; // in cents\n\ttotalLaborHours: number; // decimal hours\n\testimatedLaborHours: number; // decimal hours\n\tmaterialsCost: number; // in cents\n\tprofitMargin: number; // percentage\n\tcompletionPercentage: number; // 0-100\n\tstatus: string;\n}): StatCard[] {\n\t// Calculate outstanding balance\n\tconst outstanding = metrics.totalAmount - metrics.paidAmount;\n\n\t// Calculate profit (revenue minus costs)\n\tconst estimatedProfit = metrics.totalAmount - metrics.materialsCost;\n\tconst profitMarginCalc =\n\t\tmetrics.totalAmount > 0\n\t\t\t? ((estimatedProfit / metrics.totalAmount) * 100).toFixed(0)\n\t\t\t: 0;\n\n\t// Calculate labor efficiency (actual vs estimated)\n\tconst laborEfficiency =\n\t\tmetrics.estimatedLaborHours > 0\n\t\t\t? (\n\t\t\t\t\t(metrics.totalLaborHours / metrics.estimatedLaborHours) * 100 -\n\t\t\t\t\t100\n\t\t\t\t).toFixed(0)\n\t\t\t: 0;\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Job Value\",\n\t\t\tvalue: formatCurrency(metrics.totalAmount),\n\t\t\tchange:\n\t\t\t\toutstanding > 0\n\t\t\t\t\t? Number((-((outstanding / metrics.totalAmount) * 100)).toFixed(2))\n\t\t\t\t\t: undefined,\n\t\t\tchangeLabel:\n\t\t\t\toutstanding > 0 ? `${formatCurrency(outstanding)} due` : \"paid in full\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Labor Hours\",\n\t\t\tvalue: formatHours(metrics.totalLaborHours),\n\t\t\tchange: metrics.estimatedLaborHours > 0 ? Number(laborEfficiency) : 0,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.estimatedLaborHours > 0\n\t\t\t\t\t? `vs ${formatHours(metrics.estimatedLaborHours)} est`\n\t\t\t\t\t: \"no estimate\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Profitability\",\n\t\t\tvalue: formatCurrency(estimatedProfit),\n\t\t\tchange: Number(profitMarginCalc),\n\t\t\tchangeLabel: `${profitMarginCalc}% margin`,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Progress\",\n\t\t\tvalue: formatPercentage(metrics.completionPercentage),\n\t\t\tchange: metrics.completionPercentage === 100 ? 100 : undefined,\n\t\t\tchangeLabel: metrics.status,\n\t\t},\n\t];\n}\n\n/**\n * Generate customer stats from metrics\n */\nexport function generateCustomerStats(metrics: {\n\ttotalRevenue: number; // in cents\n\ttotalJobs: number;\n\ttotalProperties: number;\n\toutstandingBalance: number; // in cents\n}): StatCard[] {\n\treturn [\n\t\t{\n\t\t\tlabel: \"Total Revenue\",\n\t\t\tvalue: formatCurrency(metrics.totalRevenue),\n\t\t\tchange: undefined, // Cumulative stat - no period comparison\n\t\t\tchangeLabel: \"all time\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Jobs\",\n\t\t\tvalue: metrics.totalJobs.toString(),\n\t\t\tchange: undefined, // Cumulative stat - no period comparison\n\t\t\tchangeLabel: \"total\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Properties\",\n\t\t\tvalue: metrics.totalProperties.toString(),\n\t\t\tchange: 0,\n\t\t\tchangeLabel: \"locations\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Outstanding\",\n\t\t\tvalue: formatCurrency(metrics.outstandingBalance),\n\t\t\tchange: metrics.outstandingBalance > 0 ? -1 : 0, // Negative if balance exists\n\t\t\tchangeLabel: \"balance due\",\n\t\t},\n\t];\n}\n\n/**\n * Format relative date string\n */\nfunction formatDate(dateString: string | null): string {\n\tif (!dateString) {\n\t\treturn \"Never\";\n\t}\n\tconst date = new Date(dateString);\n\tconst now = new Date();\n\tconst diffTime = now.getTime() - date.getTime();\n\tconst diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n\tif (diffDays === 0) {\n\t\treturn \"Today\";\n\t}\n\tif (diffDays === 1) {\n\t\treturn \"Yesterday\";\n\t}\n\tif (diffDays < 7) {\n\t\treturn `${diffDays} days ago`;\n\t}\n\tif (diffDays < 30) {\n\t\treturn `${Math.floor(diffDays / 7)} weeks ago`;\n\t}\n\tif (diffDays < 365) {\n\t\treturn `${Math.floor(diffDays / 30)} months ago`;\n\t}\n\treturn `${Math.floor(diffDays / 365)} years ago`;\n}\n\n/**\n * Format next scheduled date\n */\nfunction formatNextScheduled(dateString: string | null): string {\n\tif (!dateString) {\n\t\treturn \"Not scheduled\";\n\t}\n\tconst date = new Date(dateString);\n\tconst now = new Date();\n\tconst diffTime = date.getTime() - now.getTime();\n\tconst diffDays = Math.floor(diffTime / (1000 * 60 * 60 * 24));\n\n\tif (diffDays < 0) {\n\t\treturn \"Overdue\";\n\t}\n\tif (diffDays === 0) {\n\t\treturn \"Today\";\n\t}\n\tif (diffDays === 1) {\n\t\treturn \"Tomorrow\";\n\t}\n\tif (diffDays < 7) {\n\t\treturn `In ${diffDays} days`;\n\t}\n\tif (diffDays < 30) {\n\t\treturn `In ${Math.floor(diffDays / 7)} weeks`;\n\t}\n\treturn date.toLocaleDateString(undefined, {\n\t\tmonth: \"short\",\n\t\tday: \"numeric\",\n\t});\n}\n\n/**\n * Generate property stats from metrics\n */\nexport function generatePropertyStats(metrics: {\n\ttotalJobs: number;\n\tactiveJobs: number;\n\ttotalRevenue: number; // in cents\n\tlastServiceDate: string | null;\n\tnextScheduledDate: string | null;\n\tequipmentCount: number;\n}): StatCard[] {\n\tconst jobActivityChange = metrics.activeJobs > 0 ? 100 : 0;\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Total Jobs\",\n\t\t\tvalue: metrics.totalJobs.toString(),\n\t\t\tchange: metrics.activeJobs > 0 ? jobActivityChange : undefined,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.activeJobs > 0\n\t\t\t\t\t? `${metrics.activeJobs} active`\n\t\t\t\t\t: \"no active jobs\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Total Revenue\",\n\t\t\tvalue: formatCurrency(metrics.totalRevenue),\n\t\t\tchange: metrics.totalRevenue > 0 ? undefined : 0,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.totalJobs > 0\n\t\t\t\t\t? `${metrics.totalJobs} job${metrics.totalJobs !== 1 ? \"s\" : \"\"}`\n\t\t\t\t\t: \"no jobs yet\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Last Service\",\n\t\t\tvalue: formatDate(metrics.lastServiceDate),\n\t\t\tchange: undefined,\n\t\t\tchangeLabel: metrics.lastServiceDate ? \"completed\" : \"no history\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Next Scheduled\",\n\t\t\tvalue: formatNextScheduled(metrics.nextScheduledDate),\n\t\t\tchange: metrics.nextScheduledDate ? 100 : undefined,\n\t\t\tchangeLabel: metrics.equipmentCount\n\t\t\t\t? `${metrics.equipmentCount} equipment`\n\t\t\t\t: \"no equipment\",\n\t\t},\n\t];\n}\n\n/**\n * Calculate days until due date\n */\nfunction daysUntilDue(dueDate: string | null): number | null {\n\tif (!dueDate) {\n\t\treturn null;\n\t}\n\tconst due = new Date(dueDate);\n\tconst now = new Date();\n\tconst diffTime = due.getTime() - now.getTime();\n\treturn Math.ceil(diffTime / (1000 * 60 * 60 * 24));\n}\n\n/**\n * Generate invoice stats from metrics\n */\nexport function generateInvoiceStats(metrics: {\n\ttotalAmount: number; // in cents\n\tpaidAmount: number; // in cents\n\tbalanceAmount: number; // in cents\n\tdueDate: string | null;\n\tstatus: string;\n\tcreatedAt: string;\n}): StatCard[] {\n\t// Calculate percentage paid\n\tconst percentPaid =\n\t\tmetrics.totalAmount > 0\n\t\t\t? Math.round((metrics.paidAmount / metrics.totalAmount) * 100)\n\t\t\t: 0;\n\n\tconst days = daysUntilDue(metrics.dueDate);\n\tconst isOverdue = days !== null && days < 0;\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Total Amount\",\n\t\t\tvalue: formatCurrency(metrics.totalAmount),\n\t\t},\n\t\t{\n\t\t\tlabel: \"Paid\",\n\t\t\tvalue: formatCurrency(metrics.paidAmount),\n\t\t\tchange: percentPaid,\n\t\t\tchangeLabel: `${percentPaid}% paid`,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Balance Due\",\n\t\t\tvalue: formatCurrency(metrics.balanceAmount),\n\t\t\tchange: metrics.balanceAmount > 0 ? -1 : 1,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Due Date\",\n\t\t\tvalue: metrics.dueDate\n\t\t\t\t? new Date(metrics.dueDate).toLocaleDateString(\"en-US\", {\n\t\t\t\t\t\tmonth: \"short\",\n\t\t\t\t\t\tday: \"numeric\",\n\t\t\t\t\t\tyear: \"numeric\",\n\t\t\t\t\t})\n\t\t\t\t: \"Not set\",\n\t\t\tchangeLabel:\n\t\t\t\tdays !== null\n\t\t\t\t\t? isOverdue\n\t\t\t\t\t\t? `${Math.abs(days)} days overdue`\n\t\t\t\t\t\t: `${days} days remaining`\n\t\t\t\t\t: undefined,\n\t\t\tchange: isOverdue ? -1 : days !== null && days <= 7 ? 0 : 1,\n\t\t},\n\t];\n}\n\n/**\n * Format valid until date for estimates\n */\nfunction formatValidUntil(\n\tdateString: string | null,\n\tdaysUntil: number | null,\n): string {\n\tif (!dateString) {\n\t\treturn \"No expiry\";\n\t}\n\tif (daysUntil === null) {\n\t\treturn \"No expiry\";\n\t}\n\tif (daysUntil < 0) {\n\t\treturn \"Expired\";\n\t}\n\tif (daysUntil === 0) {\n\t\treturn \"Expires today\";\n\t}\n\tif (daysUntil === 1) {\n\t\treturn \"Expires tomorrow\";\n\t}\n\tif (daysUntil < 7) {\n\t\treturn `${daysUntil} days left`;\n\t}\n\treturn new Date(dateString).toLocaleDateString(undefined, {\n\t\tmonth: \"short\",\n\t\tday: \"numeric\",\n\t});\n}\n\n/**\n * Generate estimate stats from metrics\n */\nexport function generateEstimateStats(metrics: {\n\ttotalAmount: number; // in cents\n\tlineItemsCount: number;\n\tstatus: string;\n\tvalidUntil: string | null;\n\tdaysUntilExpiry: number | null;\n\tisAccepted: boolean;\n}): StatCard[] {\n\tconst statusMap: Record<\n\t\tstring,\n\t\t{ change: number | undefined; label: string }\n\t> = {\n\t\tdraft: { change: undefined, label: \"not sent\" },\n\t\tsent: { change: 50, label: \"awaiting response\" },\n\t\taccepted: { change: 100, label: \"customer approved\" },\n\t\trejected: { change: 0, label: \"declined\" },\n\t};\n\tconst statusInfo = statusMap[metrics.status.toLowerCase()] || {\n\t\tchange: undefined,\n\t\tlabel: metrics.status,\n\t};\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Estimate Value\",\n\t\t\tvalue: formatCurrency(metrics.totalAmount),\n\t\t\tchange: metrics.isAccepted ? 100 : undefined,\n\t\t\tchangeLabel: metrics.isAccepted\n\t\t\t\t? \"accepted\"\n\t\t\t\t: `${metrics.lineItemsCount} item${metrics.lineItemsCount !== 1 ? \"s\" : \"\"}`,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Line Items\",\n\t\t\tvalue: metrics.lineItemsCount.toString(),\n\t\t\tchange: metrics.lineItemsCount > 0 ? undefined : 0,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.totalAmount > 0\n\t\t\t\t\t? formatCurrency(metrics.totalAmount)\n\t\t\t\t\t: \"no items\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Status\",\n\t\t\tvalue: metrics.status,\n\t\t\tchange: statusInfo.change,\n\t\t\tchangeLabel: statusInfo.label,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Valid Until\",\n\t\t\tvalue: formatValidUntil(metrics.validUntil, metrics.daysUntilExpiry),\n\t\t\tchange:\n\t\t\t\tmetrics.daysUntilExpiry !== null && metrics.daysUntilExpiry >= 0\n\t\t\t\t\t? metrics.daysUntilExpiry < 7\n\t\t\t\t\t\t? 0\n\t\t\t\t\t\t: undefined\n\t\t\t\t\t: undefined,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.validUntil && metrics.daysUntilExpiry !== null\n\t\t\t\t\t? metrics.daysUntilExpiry < 0\n\t\t\t\t\t\t? \"expired\"\n\t\t\t\t\t\t: metrics.daysUntilExpiry === 0\n\t\t\t\t\t\t\t? \"today\"\n\t\t\t\t\t\t\t: \"valid\"\n\t\t\t\t\t: \"no limit\",\n\t\t},\n\t];\n}\n\n/**\n * Generate appointment stats from metrics\n */\nexport function generateAppointmentStats(metrics: {\n\tduration: number; // minutes\n\ttravelTime: number; // minutes\n\tteamMemberCount: number;\n\tjobValue: number; // in cents\n}): StatCard[] {\n\treturn [\n\t\t{\n\t\t\tlabel: \"Duration\",\n\t\t\tvalue: `${Math.floor(metrics.duration / 60)}h ${metrics.duration % 60}m`,\n\t\t\tchange: undefined,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Travel Time\",\n\t\t\tvalue: metrics.travelTime > 0 ? `${metrics.travelTime}m` : \"N/A\",\n\t\t\tchange: undefined,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Team Members\",\n\t\t\tvalue: (metrics.teamMemberCount ?? 0).toString(),\n\t\t\tchange: undefined,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Job Value\",\n\t\t\tvalue: formatCurrency(metrics.jobValue),\n\t\t\tchange: metrics.jobValue > 100_000 ? 10 : undefined,\n\t\t},\n\t];\n}\n\n/**\n * Generate material stats from metrics\n */\nexport function generateMaterialStats(metrics: {\n\tquantityOnHand: number;\n\tquantityReserved: number;\n\tquantityAvailable: number;\n\tminimumQuantity: number;\n\treorderPoint?: number | null;\n\ttotalValue: number; // in cents\n\tstatus: string;\n}): StatCard[] {\n\tconst availabilityChange =\n\t\tmetrics.minimumQuantity > 0\n\t\t\t? Math.round(\n\t\t\t\t\t((metrics.quantityAvailable - metrics.minimumQuantity) /\n\t\t\t\t\t\tmetrics.minimumQuantity) *\n\t\t\t\t\t\t100,\n\t\t\t\t)\n\t\t\t: undefined;\n\n\tconst reservedPercent =\n\t\tmetrics.quantityOnHand > 0 && metrics.quantityReserved > 0\n\t\t\t? Math.round((-metrics.quantityReserved / metrics.quantityOnHand) * 100)\n\t\t\t: undefined;\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"On Hand\",\n\t\t\tvalue: metrics.quantityOnHand,\n\t\t\tchangeLabel: \"total units\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Available\",\n\t\t\tvalue: metrics.quantityAvailable,\n\t\t\tchange: availabilityChange,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.minimumQuantity > 0\n\t\t\t\t\t? `vs min ${metrics.minimumQuantity}`\n\t\t\t\t\t: \"available units\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Reserved\",\n\t\t\tvalue: metrics.quantityReserved,\n\t\t\tchange: reservedPercent,\n\t\t\tchangeLabel: \"allocated\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Inventory Value\",\n\t\t\tvalue: formatCurrency(metrics.totalValue),\n\t\t\tchangeLabel: \"at cost\",\n\t\t},\n\t];\n}\n\n/**\n * Generate purchase order stats from metrics\n */\nexport function generatePurchaseOrderStats(metrics: {\n\ttotalAmount: number; // in cents\n\tlineItemCount: number;\n\tstatus: string;\n\tdaysUntilDelivery?: number;\n}): StatCard[] {\n\treturn [\n\t\t{\n\t\t\tlabel: \"Total Amount\",\n\t\t\tvalue: formatCurrency(metrics.totalAmount),\n\t\t\tchange: undefined,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Line Items\",\n\t\t\tvalue: metrics.lineItemCount.toString(),\n\t\t\tchange: undefined,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Status\",\n\t\t\tvalue: metrics.status,\n\t\t\tchange: undefined,\n\t\t},\n\t\t{\n\t\t\tlabel: \"Delivery\",\n\t\t\tvalue:\n\t\t\t\tmetrics.daysUntilDelivery !== undefined\n\t\t\t\t\t? metrics.daysUntilDelivery > 0\n\t\t\t\t\t\t? `${metrics.daysUntilDelivery} days`\n\t\t\t\t\t\t: \"Today\"\n\t\t\t\t\t: \"Not set\",\n\t\t\tchange: undefined,\n\t\t},\n\t];\n}\n\n/**\n * Generate team member stats from metrics (simple version)\n */\nexport function generateTeamMemberStatsSimple(metrics: {\n\ttotalJobs: number;\n\thoursWorked: number;\n\trevenueGenerated: number; // in cents\n\tcustomerRating: number;\n\tjobsTrend?: number;\n\thoursTrend?: number;\n\trevenueTrend?: number;\n}): StatCard[] {\n\treturn [\n\t\t{\n\t\t\tlabel: \"Total Jobs\",\n\t\t\tvalue: metrics.totalJobs.toString(),\n\t\t\tchange: metrics.jobsTrend || 0,\n\t\t\tchangeLabel: \"vs last month\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Hours Worked\",\n\t\t\tvalue: formatHours(metrics.hoursWorked),\n\t\t\tchange: metrics.hoursTrend || 0,\n\t\t\tchangeLabel: \"vs last month\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Revenue Generated\",\n\t\t\tvalue: formatCurrency(metrics.revenueGenerated),\n\t\t\tchange: metrics.revenueTrend || 0,\n\t\t\tchangeLabel: \"vs last month\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Rating\",\n\t\t\tvalue:\n\t\t\t\tmetrics.customerRating > 0 ? metrics.customerRating.toFixed(1) : \"N/A\",\n\t\t\tchange: 0,\n\t\t\tchangeLabel: \"customer rating\",\n\t\t},\n\t];\n}\n\n/**\n * Generate contract stats from metrics\n */\nfunction generateContractStats(metrics: {\n\tstatus: string;\n\tsignedAt?: string | null;\n\tsentAt?: string | null;\n\tviewedAt?: string | null;\n\tvalidUntil?: string | null;\n}): StatCard[] {\n\tconst now = new Date();\n\tconst validUntil = metrics.validUntil ? new Date(metrics.validUntil) : null;\n\tconst daysUntilExpiry = validUntil\n\t\t? Math.ceil((validUntil.getTime() - now.getTime()) / (1000 * 60 * 60 * 24))\n\t\t: null;\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Status\",\n\t\t\tvalue: metrics.status.charAt(0).toUpperCase() + metrics.status.slice(1),\n\t\t\tchange: undefined,\n\t\t},\n\t\t...(metrics.signedAt\n\t\t\t? [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"Signed\",\n\t\t\t\t\t\tvalue: new Date(metrics.signedAt).toLocaleDateString(),\n\t\t\t\t\t\tchange: undefined,\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t: []),\n\t\t...(metrics.sentAt && !metrics.signedAt\n\t\t\t? [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"Sent\",\n\t\t\t\t\t\tvalue: new Date(metrics.sentAt).toLocaleDateString(),\n\t\t\t\t\t\tchange: undefined,\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t: []),\n\t\t...(validUntil\n\t\t\t? [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"Expires\",\n\t\t\t\t\t\tvalue:\n\t\t\t\t\t\t\tdaysUntilExpiry !== null\n\t\t\t\t\t\t\t\t? daysUntilExpiry > 0\n\t\t\t\t\t\t\t\t\t? `${daysUntilExpiry} days`\n\t\t\t\t\t\t\t\t\t: daysUntilExpiry === 0\n\t\t\t\t\t\t\t\t\t\t? \"Today\"\n\t\t\t\t\t\t\t\t\t\t: \"Expired\"\n\t\t\t\t\t\t\t\t: \"Not set\",\n\t\t\t\t\t\tchange:\n\t\t\t\t\t\t\tdaysUntilExpiry !== null && daysUntilExpiry < 7 ? -5 : undefined,\n\t\t\t\t\t},\n\t\t\t\t]\n\t\t\t: []),\n\t];\n}\n\n/**\n * Generate payment stats from metrics\n */\nexport function generatePaymentStats(metrics: {\n\tamount: number; // in cents\n\tstatus: string;\n\tpaymentMethod: string;\n\tpaymentType: string;\n\tcreatedAt: string;\n\tprocessedAt?: string | null;\n\trefundedAmount?: number; // in cents\n}): StatCard[] {\n\tconst _now = new Date();\n\tconst createdAt = new Date(metrics.createdAt);\n\tconst processedAt = metrics.processedAt\n\t\t? new Date(metrics.processedAt)\n\t\t: null;\n\n\t// Calculate processing time if processed\n\tconst processingTime = processedAt\n\t\t? Math.floor((processedAt.getTime() - createdAt.getTime()) / (1000 * 60)) // minutes\n\t\t: null;\n\n\tconst isRefunded = (metrics.refundedAmount || 0) > 0;\n\tconst netAmount = metrics.amount - (metrics.refundedAmount || 0);\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Payment Amount\",\n\t\t\tvalue: formatCurrency(metrics.amount),\n\t\t\tchange: isRefunded ? -1 : metrics.amount > 0 ? 100 : undefined,\n\t\t\tchangeLabel: isRefunded\n\t\t\t\t? `${formatCurrency(metrics.refundedAmount || 0)} refunded`\n\t\t\t\t: \"received\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Net Amount\",\n\t\t\tvalue: formatCurrency(netAmount),\n\t\t\tchange: isRefunded ? -1 : undefined,\n\t\t\tchangeLabel: isRefunded ? \"after refund\" : \"processed\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Status\",\n\t\t\tvalue: metrics.status,\n\t\t\tchange: metrics.status === \"completed\" ? 100 : undefined,\n\t\t\tchangeLabel: metrics.status === \"completed\" ? \"successful\" : \"pending\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Processing Time\",\n\t\t\tvalue:\n\t\t\t\tprocessingTime !== null\n\t\t\t\t\t? processingTime < 60\n\t\t\t\t\t\t? `${processingTime}m`\n\t\t\t\t\t\t: `${Math.floor(processingTime / 60)}h ${processingTime % 60}m`\n\t\t\t\t\t: \"Not processed\",\n\t\t\tchange: processingTime !== null && processingTime < 30 ? 100 : undefined,\n\t\t\tchangeLabel:\n\t\t\t\tprocessingTime !== null\n\t\t\t\t\t? `from ${createdAt.toLocaleDateString()}`\n\t\t\t\t\t: \"awaiting processing\",\n\t\t},\n\t];\n}\n\n/**\n * Generate team member stats from metrics (detailed version)\n */\nfunction generateTeamMemberStats(\n\tmetrics:\n\t\t| {\n\t\t\t\tactiveJobsCount: number;\n\t\t\t\thoursThisMonth: number;\n\t\t\t\tcompletionRate: number;\n\t\t\t\tavailableHours: number;\n\t\t\t\ttotalTasksCompleted: number;\n\t\t\t\ttotalTasks: number;\n\t\t\t\taverageHoursPerMonth: number;\n\t\t  }\n\t\t| {\n\t\t\t\ttotalJobs: number;\n\t\t\t\ttotalHours: number;\n\t\t\t\tactiveCertifications: number;\n\t\t\t\ttotalCertifications: number;\n\t\t\t\tcompletedJobs: number;\n\t\t\t\tactiveJobs: number;\n\t\t  },\n): StatCard[] {\n\t// Check which metrics format we have\n\tif (\"activeJobsCount\" in metrics) {\n\t\t// Original detailed version\n\t\tconst hoursVsAverage =\n\t\t\tmetrics.averageHoursPerMonth > 0\n\t\t\t\t? (\n\t\t\t\t\t\t((metrics.hoursThisMonth - metrics.averageHoursPerMonth) /\n\t\t\t\t\t\t\tmetrics.averageHoursPerMonth) *\n\t\t\t\t\t\t100\n\t\t\t\t\t).toFixed(0)\n\t\t\t\t: 0;\n\n\t\tconst completionRateCalc =\n\t\t\tmetrics.totalTasks > 0\n\t\t\t\t? ((metrics.totalTasksCompleted / metrics.totalTasks) * 100).toFixed(0)\n\t\t\t\t: 0;\n\n\t\tconst availabilityStatus =\n\t\t\tmetrics.availableHours > 0 ? \"available\" : \"fully booked\";\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tlabel: \"Active Jobs\",\n\t\t\t\tvalue: metrics.activeJobsCount.toString(),\n\t\t\t\tchange: metrics.activeJobsCount > 0 ? 12.5 : undefined,\n\t\t\t\tchangeLabel:\n\t\t\t\t\tmetrics.activeJobsCount > 0\n\t\t\t\t\t\t? \"currently assigned\"\n\t\t\t\t\t\t: \"no active assignments\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"Hours This Month\",\n\t\t\t\tvalue: formatHours(metrics.hoursThisMonth),\n\t\t\t\tchange:\n\t\t\t\t\tmetrics.averageHoursPerMonth > 0 ? Number(hoursVsAverage) : undefined,\n\t\t\t\tchangeLabel:\n\t\t\t\t\tmetrics.averageHoursPerMonth > 0\n\t\t\t\t\t\t? `vs ${formatHours(metrics.averageHoursPerMonth)} avg`\n\t\t\t\t\t\t: \"first month\",\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"Completion Rate\",\n\t\t\t\tvalue: formatPercentage(metrics.completionRate),\n\t\t\t\tchange: metrics.completionRate >= 90 ? Number(completionRateCalc) : 0,\n\t\t\t\tchangeLabel: `${metrics.totalTasksCompleted} / ${metrics.totalTasks} tasks`,\n\t\t\t},\n\t\t\t{\n\t\t\t\tlabel: \"Availability\",\n\t\t\t\tvalue: formatHours(metrics.availableHours),\n\t\t\t\tchange: metrics.availableHours > 0 ? undefined : 0,\n\t\t\t\tchangeLabel: availabilityStatus,\n\t\t\t},\n\t\t];\n\t}\n\t// Simplified version for detail pages\n\tconst _completionRate =\n\t\tmetrics.totalJobs > 0\n\t\t\t? Math.round((metrics.completedJobs / metrics.totalJobs) * 100)\n\t\t\t: 0;\n\n\treturn [\n\t\t{\n\t\t\tlabel: \"Active Jobs\",\n\t\t\tvalue: metrics.activeJobs.toString(),\n\t\t\tchange: metrics.activeJobs > 0 ? undefined : 0,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.activeJobs > 0 ? \"currently assigned\" : \"no active assignments\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Total Jobs\",\n\t\t\tvalue: metrics.totalJobs.toString(),\n\t\t\tchange: 0,\n\t\t\tchangeLabel: \"all time\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Hours Worked\",\n\t\t\tvalue: formatHours(metrics.totalHours),\n\t\t\tchange: 0,\n\t\t\tchangeLabel: \"lifetime\",\n\t\t},\n\t\t{\n\t\t\tlabel: \"Certifications\",\n\t\t\tvalue: `${metrics.activeCertifications}/${metrics.totalCertifications}`,\n\t\t\tchange:\n\t\t\t\tmetrics.activeCertifications === metrics.totalCertifications\n\t\t\t\t\t? 100\n\t\t\t\t\t: metrics.activeCertifications > 0\n\t\t\t\t\t\t? undefined\n\t\t\t\t\t\t: 0,\n\t\t\tchangeLabel:\n\t\t\t\tmetrics.activeCertifications === metrics.totalCertifications\n\t\t\t\t\t? \"all current\"\n\t\t\t\t\t: metrics.activeCertifications > 0\n\t\t\t\t\t\t? \"active\"\n\t\t\t\t\t\t: \"none active\",\n\t\t},\n\t];\n}\n","import type { PostgrestError } from \"@supabase/supabase-js\";\n\nexport type QueryError = PostgrestError | null;\n\nconst POSTGREST_ROW_NOT_FOUND = \"PGRST116\";\nconst UNDEFINED_COLUMN_ERROR_CODES = new Set([\"42703\", \"PGRST204\"]);\n\nconst isRowNotFoundError = (error: QueryError) =>\n\tBoolean(error?.code && error.code === POSTGREST_ROW_NOT_FOUND);\n\nexport const hasReportableError = (error: QueryError) =>\n\tBoolean(\n\t\terror &&\n\t\t\t!isRowNotFoundError(error) &&\n\t\t\t(error.message || error.details || error.hint || error.code),\n\t);\n\nexport const isMissingColumnError = (error: QueryError, columnName: string) => {\n\tif (!error) {\n\t\treturn false;\n\t}\n\n\tif (UNDEFINED_COLUMN_ERROR_CODES.has(error.code ?? \"\")) {\n\t\treturn true;\n\t}\n\n\tconst haystack = [error.message, error.details, error.hint]\n\t\t.filter((part): part is string => Boolean(part))\n\t\t.join(\" \")\n\t\t.toLowerCase();\n\n\treturn haystack.includes(columnName.toLowerCase());\n};\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const PropertyPageContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call PropertyPageContent() from the server but PropertyPageContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/components/properties/property-details/property-page-content.tsx\",\n    \"PropertyPageContent\",\n);\n","/**\n * Property Details Page - PPR Enabled\n *\n * Uses Partial Prerendering for instant page loads:\n * - Static shell renders instantly (5-20ms)\n * - Property data streams in (100-500ms)\n *\n * Performance: 8-30x faster than traditional SSR\n *\n * Comprehensive single-page view matching Job Details architecture\n *\n * Features:\n * - Sticky stats bar with 4 KPIs\n * - Comprehensive data fetching (12 queries)\n * - Collapsible accordion sections\n * - Google Maps integration\n * - Job history, equipment, schedules\n * - Customer info, communications\n * - Activity log, notes, attachments\n * - Inline editable metadata\n */\n\nimport { Suspense } from \"react\";\nimport { PropertyDetailData } from \"@/components/properties/property-details/property-detail-data\";\nimport { PropertyDetailSkeleton } from \"@/components/properties/property-details/property-detail-skeleton\";\n\ntype PropertyPageProps = {\n\tparams: Promise<{\n\t\tid: string;\n\t}>;\n};\n\nexport default async function PropertyPage({ params }: PropertyPageProps) {\n\tconst { id: propertyId } = await params;\n\n\treturn (\n\t\t<Suspense fallback={<PropertyDetailSkeleton />}>\n\t\t\t<PropertyDetailData propertyId={propertyId} />\n\t\t</Suspense>\n\t);\n}\n","/**\n * Property Detail Data Component - PPR Enabled\n *\n * Async server component that fetches all property data.\n * This component streams in after the shell renders.\n *\n * Fetches:\n * - Property data\n * - Customer data\n * - Jobs at property\n * - Equipment at property\n * - Schedules/appointments\n * - Estimates\n * - Invoices\n * - Maintenance plans\n * - Activity log\n * - Notes\n * - Attachments\n * - Communications\n *\n * Total: 12 queries (optimized with Promise.all)\n */\n\nimport { notFound, redirect } from \"next/navigation\";\nimport { ToolbarStatsProvider } from \"@/components/layout/toolbar-stats-provider\";\nimport { PropertyPageContent } from \"@/components/properties/property-details/property-page-content\";\nimport {\n\tgetActiveCompanyId,\n\tisActiveCompanyOnboardingComplete,\n} from \"@/lib/auth/company-context\";\nimport { generatePropertyStats } from \"@/lib/queries/stats-utils\";\nimport {\n\thasReportableError,\n\tisMissingColumnError,\n} from \"@/lib/supabase/error-helpers\";\nimport { createClient } from \"@/lib/supabase/server\";\n\ntype PropertyDetailDataProps = {\n\tpropertyId: string;\n};\n\nexport async function PropertyDetailData({\n\tpropertyId,\n}: PropertyDetailDataProps) {\n\tconst supabase = await createClient();\n\n\tif (!supabase) {\n\t\treturn notFound();\n\t}\n\n\t// Get current user\n\tconst {\n\t\tdata: { user },\n\t} = await supabase.auth.getUser();\n\n\tif (!user) {\n\t\treturn notFound();\n\t}\n\n\t// Check if active company has completed onboarding\n\tconst isOnboardingComplete = await isActiveCompanyOnboardingComplete();\n\n\tif (!isOnboardingComplete) {\n\t\tredirect(\"/dashboard\");\n\t}\n\n\t// Get active company ID\n\tconst activeCompanyId = await getActiveCompanyId();\n\n\tif (!activeCompanyId) {\n\t\tredirect(\"/dashboard\");\n\t}\n\n\t// First fetch property to check if it exists\n\tconst { data: property, error: propertyError } = await supabase\n\t\t.from(\"properties\")\n\t\t.select(\"*\")\n\t\t.eq(\"id\", propertyId)\n\t\t.eq(\"company_id\", activeCompanyId)\n\t\t.single();\n\n\tif (propertyError || !property) {\n\t\treturn notFound();\n\t}\n\n\t// Then fetch all related data in parallel (including financial data for Property 360Â° view)\n\tconst [\n\t\tcustomerResult,\n\t\tjobsResult,\n\t\tequipmentResult,\n\t\tschedulesResult,\n\t\testimatesResult,\n\t\tinvoicesResult,\n\t\tmaintenancePlansResult,\n\t\tactivitiesResult,\n\t\tnotesResult,\n\t\tattachmentsResult,\n\t] = await Promise.all([\n\t\t// 1. Customer info\n\t\tproperty.customer_id\n\t\t\t? supabase\n\t\t\t\t\t.from(\"customers\")\n\t\t\t\t\t.select(\"id, first_name, last_name, email, phone, company_name\")\n\t\t\t\t\t.eq(\"id\", property.customer_id)\n\t\t\t\t\t.single()\n\t\t\t: Promise.resolve({ data: null, error: null }),\n\n\t\t// 2. Jobs at this property\n\t\tsupabase\n\t\t\t.from(\"jobs\")\n\t\t\t.select(\n\t\t\t\t`\n        id,\n        job_number,\n        title,\n        status,\n        priority,\n        scheduled_start,\n        scheduled_end,\n        total_amount,\n        paid_amount,\n        created_at,\n        customer:customers!customer_id (\n          id,\n          first_name,\n          last_name\n        ),\n        assigned_user:users!assigned_to (\n          id,\n          name,\n          avatar\n        )\n      `,\n\t\t\t)\n\t\t\t.eq(\"property_id\", propertyId)\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.order(\"created_at\", { ascending: false }),\n\n\t\t// 3. Equipment installed at property\n\t\tsupabase\n\t\t\t.from(\"equipment\")\n\t\t\t.select(\"*\")\n\t\t\t.eq(\"property_id\", propertyId)\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.order(\"install_date\", { ascending: false }),\n\n\t\t// 4. Upcoming schedules/appointments\n\t\tsupabase\n\t\t\t.from(\"appointments\")\n\t\t\t.select(\n\t\t\t\t`\n        id,\n        title,\n        description,\n        start_time,\n        end_time,\n        duration,\n        status,\n        type,\n        job:jobs!job_id (\n          id,\n          job_number,\n          title\n        )\n      `,\n\t\t\t)\n\t\t\t.eq(\"property_id\", propertyId)\n\t\t\t.gte(\"start_time\", new Date().toISOString())\n\t\t\t.order(\"start_time\", { ascending: true })\n\t\t\t.limit(20),\n\n\t\t// 5. Estimates for this property\n\t\tsupabase\n\t\t\t.from(\"estimates\")\n\t\t\t.select(\n\t\t\t\t\"id, estimate_number, title, total_amount, status, created_at, job_id, property_id\",\n\t\t\t)\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.eq(\"property_id\", propertyId)\n\t\t\t.order(\"created_at\", { ascending: false })\n\t\t\t.limit(10),\n\n\t\t// 6. Invoices for this property\n\t\tsupabase\n\t\t\t.from(\"invoices\")\n\t\t\t.select(\n\t\t\t\t\"id, invoice_number, title, total_amount, balance_amount, status, created_at, job_id, property_id\",\n\t\t\t)\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.or(`property_id.eq.${propertyId}`)\n\t\t\t.order(\"created_at\", { ascending: false })\n\t\t\t.limit(10),\n\n\t\t// 7. Maintenance plans for this property\n\t\tsupabase\n\t\t\t.from(\"service_plans\")\n\t\t\t.select(\n\t\t\t\t\"id, name, description, frequency, status, created_at, next_service_date\",\n\t\t\t)\n\t\t\t.eq(\"property_id\", propertyId)\n\t\t\t.is(\"deleted_at\", null)\n\t\t\t.order(\"created_at\", { ascending: false }),\n\n\t\t// 8. Activity log\n\t\tsupabase\n\t\t\t.from(\"activity_log\")\n\t\t\t.select(\"*, user:profiles(id, full_name, email, avatar_url)\")\n\t\t\t.eq(\"entity_type\", \"property\")\n\t\t\t.eq(\"entity_id\", propertyId)\n\t\t\t.order(\"created_at\", { ascending: false })\n\t\t\t.limit(50),\n\n\t\t// 9. Notes\n\t\tsupabase\n\t\t\t.from(\"notes\")\n\t\t\t.select(\"*, user:profiles(id, full_name, email, avatar_url)\")\n\t\t\t.eq(\"entity_type\", \"property\")\n\t\t\t.eq(\"entity_id\", propertyId)\n\t\t\t.order(\"created_at\", { ascending: false }),\n\n\t\t// 10. Attachments\n\t\tsupabase\n\t\t\t.from(\"attachments\")\n\t\t\t.select(\"*\")\n\t\t\t.eq(\"entity_type\", \"property\")\n\t\t\t.eq(\"entity_id\", propertyId)\n\t\t\t.order(\"created_at\", { ascending: false }),\n\t]);\n\n\t// Extract customer data\n\tconst customer = customerResult.data;\n\n\t// Extract data from results\n\tconst jobs = jobsResult.data || [];\n\tconst equipment = equipmentResult.data || [];\n\tconst schedules = schedulesResult.data || [];\n\tconst estimates = estimatesResult.data || [];\n\tconst invoices = invoicesResult.data || [];\n\tconst maintenancePlans = maintenancePlansResult.data || [];\n\tconst activities = activitiesResult.data || [];\n\tconst notes = notesResult.data || [];\n\tconst attachments = attachmentsResult.data || [];\n\n\tconst propertyCommunicationFilters: string[] = [];\n\tif (customer?.id) {\n\t\tpropertyCommunicationFilters.push(`customer_id.eq.${customer.id}`);\n\t}\n\tconst jobIds = jobs.map((job: any) => job.id).filter(Boolean);\n\tfor (const id of jobIds) {\n\t\tpropertyCommunicationFilters.push(`job_id.eq.${id}`);\n\t}\n\tconst invoiceIds = invoices.map((invoice: any) => invoice.id).filter(Boolean);\n\tfor (const id of invoiceIds) {\n\t\tpropertyCommunicationFilters.push(`invoice_id.eq.${id}`);\n\t}\n\n\tconst propertyFilter = propertyId ? `property_id.eq.${propertyId}` : null;\n\n\tconst buildPropertyCommunicationsQuery = (filters: string[]) => {\n\t\tlet query = supabase\n\t\t\t.from(\"communications\")\n\t\t\t.select(\n\t\t\t\t`\n          *,\n          customer:customers!customer_id(id, first_name, last_name)\n        `,\n\t\t\t)\n\t\t\t.eq(\"company_id\", activeCompanyId)\n\t\t\t.order(\"created_at\", { ascending: false })\n\t\t\t.limit(50);\n\n\t\tif (filters.length > 0) {\n\t\t\tquery = query.or(filters.join(\",\"));\n\t\t}\n\n\t\treturn query;\n\t};\n\n\tconst filtersWithProperty = propertyFilter\n\t\t? [...propertyCommunicationFilters, propertyFilter]\n\t\t: propertyCommunicationFilters;\n\n\tlet { data: propertyCommunications, error: propertyCommunicationsError } =\n\t\tawait buildPropertyCommunicationsQuery(filtersWithProperty);\n\n\tconst shouldFallbackToFiltersWithoutProperty =\n\t\tpropertyFilter &&\n\t\tisMissingColumnError(propertyCommunicationsError, \"property_id\");\n\n\tif (shouldFallbackToFiltersWithoutProperty) {\n\t\tif (propertyCommunicationFilters.length > 0) {\n\t\t\t({ data: propertyCommunications, error: propertyCommunicationsError } =\n\t\t\t\tawait buildPropertyCommunicationsQuery(propertyCommunicationFilters));\n\t\t} else {\n\t\t\tpropertyCommunications = [];\n\t\t\tpropertyCommunicationsError = null;\n\t\t}\n\t}\n\n\tif (hasReportableError(propertyCommunicationsError)) {\n\t}\n\n\tconst communications =\n\t\t(propertyCommunications || []).filter((record, index, self) => {\n\t\t\tif (!record?.id) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn self.findIndex((entry) => entry.id === record.id) === index;\n\t\t}) ?? [];\n\n\t// Calculate metrics for stats bar\n\tconst totalJobs = jobs.length;\n\tconst activeJobs = jobs.filter(\n\t\t(job: any) =>\n\t\t\tjob.status &&\n\t\t\t![\"completed\", \"cancelled\"].includes(job.status.toLowerCase()),\n\t).length;\n\t// Access financial domain with optional chaining\n\tconst totalRevenue = jobs.reduce(\n\t\t(sum: number, job: any) => sum + (job.financial?.total_amount ?? 0),\n\t\t0,\n\t);\n\tconst completedJobs = jobs.filter(\n\t\t(job: any) => job.status?.toLowerCase() === \"completed\",\n\t);\n\tconst lastServiceDate =\n\t\tcompletedJobs.length > 0 ? completedJobs[0]?.created_at || null : null;\n\tconst nextScheduledDate =\n\t\tschedules.length > 0 ? schedules[0]?.start_time || null : null;\n\tconst equipmentCount = equipment.length;\n\n\tconst metrics = {\n\t\ttotalJobs,\n\t\tactiveJobs,\n\t\ttotalRevenue,\n\t\tlastServiceDate,\n\t\tnextScheduledDate,\n\t\tequipmentCount,\n\t};\n\n\t// Prepare data for page content\n\tconst propertyData = {\n\t\tproperty,\n\t\tcustomer,\n\t\tjobs,\n\t\tequipment,\n\t\tschedules,\n\t\testimates,\n\t\tinvoices,\n\t\tmaintenancePlans,\n\t\tcommunications,\n\t\tactivities,\n\t\tnotes,\n\t\tattachments,\n\t};\n\n\t// Generate stats for toolbar\n\tconst stats = generatePropertyStats(metrics);\n\n\treturn (\n\t\t<ToolbarStatsProvider stats={stats}>\n\t\t\t<div className=\"flex h-full w-full flex-col overflow-auto\">\n\t\t\t\t<div className=\"mx-auto w-full max-w-7xl\">\n\t\t\t\t\t<PropertyPageContent entityData={propertyData} metrics={metrics} />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</ToolbarStatsProvider>\n\t);\n}\n","/**\n * Property Detail Skeleton - PPR Loading State\n *\n * Renders instantly while property data streams in.\n * Provides immediate visual feedback to the user.\n *\n * Performance: Renders in 5-20ms (instant!)\n */\n\nexport function PropertyDetailSkeleton() {\n\treturn (\n\t\t<div className=\"flex h-full w-full flex-col overflow-auto\">\n\t\t\t<div className=\"mx-auto w-full max-w-7xl space-y-6 p-6\">\n\t\t\t\t{/* Header skeleton */}\n\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-8 w-64 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-96 animate-pulse rounded\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-10 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-10 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Stats bar skeleton */}\n\t\t\t\t<div className=\"grid gap-4 md:grid-cols-4\">\n\t\t\t\t\t{[1, 2, 3, 4].map((i) => (\n\t\t\t\t\t\t<div className=\"space-y-2 rounded-lg border p-4\" key={i}>\n\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-3 w-20 animate-pulse rounded\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Map skeleton */}\n\t\t\t\t<div className=\"bg-muted h-64 w-full animate-pulse rounded-lg\" />\n\n\t\t\t\t{/* Main content skeleton */}\n\t\t\t\t<div className=\"grid gap-6 lg:grid-cols-3\">\n\t\t\t\t\t{/* Left column - Property details */}\n\t\t\t\t\t<div className=\"space-y-6 lg:col-span-2\">\n\t\t\t\t\t\t{/* Customer info */}\n\t\t\t\t\t\t<div className=\"space-y-4 rounded-lg border p-6\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-full animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-3/4 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-2/3 animate-pulse rounded\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Jobs history */}\n\t\t\t\t\t\t<div className=\"space-y-4 rounded-lg border p-6\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t{[1, 2, 3].map((i) => (\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\" key={i}>\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-48 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Equipment */}\n\t\t\t\t\t\t<div className=\"space-y-4 rounded-lg border p-6\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t\t{[1, 2].map((i) => (\n\t\t\t\t\t\t\t\t\t<div className=\"space-y-2\" key={i}>\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-full animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-muted h-3 w-2/3 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Right column - Quick info */}\n\t\t\t\t\t<div className=\"space-y-6\">\n\t\t\t\t\t\t{/* Property info */}\n\t\t\t\t\t\t<div className=\"space-y-4 rounded-lg border p-6\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-full animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-3/4 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-2/3 animate-pulse rounded\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Upcoming schedules */}\n\t\t\t\t\t\t<div className=\"space-y-4 rounded-lg border p-6\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t{[1, 2].map((i) => (\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName=\"bg-muted h-4 w-full animate-pulse rounded\"\n\t\t\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Financial summary */}\n\t\t\t\t\t\t<div className=\"space-y-4 rounded-lg border p-6\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t{[1, 2, 3].map((i) => (\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\" key={i}>\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-20 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Tabs skeleton */}\n\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t<div className=\"flex gap-4 border-b\">\n\t\t\t\t\t\t{[1, 2, 3, 4, 5].map((i) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"bg-muted h-10 w-24 animate-pulse rounded-t\"\n\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t{[1, 2, 3].map((i) => (\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName=\"bg-muted h-20 w-full animate-pulse rounded\"\n\t\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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","ignoreList":[0,3]}