module.exports=[459390,a=>{"use strict";var b=a.i(861467),c=a.i(565308),d=a.i(60222),e=a.i(319895),f=a.i(145679);a.i(288007);var g=a.i(986990);a.i(445255);var h=a.i(18170),i=a.i(425809),j=a.i(700760);let k=[{id:"draft",name:"Draft",accentColor:"#6B7280"},{id:"pending",name:"Pending",accentColor:"#F59E0B"},{id:"paid",name:"Paid",accentColor:"#22C55E"},{id:"overdue",name:"Overdue",accentColor:"#EF4444"}],l=new Map(k.map(a=>[a.id,a.name])),m=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function n({invoices:a}){return(0,b.jsx)(i.EntityKanban,{calculateColumnMeta:(a,b)=>{let c=b.filter(b=>b.columnId===a),d=c.reduce((a,b)=>a+b.entity.amount,0);return{count:c.length,total:d}},columns:k,data:a,entityName:"invoices",formatTotal:a=>m.format(a/100),mapToKanbanItem:a=>({id:a.id,columnId:a.status,entity:a,invoice:a}),renderCard:a=>(0,b.jsx)(o,{item:{...a,invoice:a.entity}}),renderDragOverlay:a=>(0,b.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg",children:(0,b.jsx)(o,{item:{...a,invoice:a.entity}})}),showTotals:!0,updateEntityStatus:(a,b)=>({...a,status:b})})}function o({item:a}){let{invoice:i,columnId:k}=a;return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:i.invoiceNumber}),(0,b.jsx)("h3",{className:"text-foreground text-sm font-semibold",children:i.customer}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(g.Badge,{className:(0,j.cn)("text-xs","overdue"===k&&"bg-destructive/10 text-destructive","paid"===k&&"bg-primary/10 text-primary"),variant:"overdue"===k?"destructive":"paid"===k?"secondary":"outline",children:l.get(k)??k}),(0,b.jsx)(g.Badge,{className:"bg-muted/60 text-muted-foreground",variant:"outline",children:m.format(i.amount/100)})]})]})}),(0,b.jsxs)("div",{className:"text-muted-foreground space-y-2 text-xs",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.FileText,{className:"text-primary size-4"}),(0,b.jsxs)("span",{children:["Issued ",i.date]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.CalendarDays,{className:"text-primary size-4"}),(0,b.jsxs)("span",{className:(0,j.cn)("font-medium","overdue"===k?"text-destructive":"text-foreground"),children:["Due ",i.dueDate]})]})]}),(0,b.jsxs)("div",{className:"text-muted-foreground flex items-center justify-between pt-2 text-xs",children:[(0,b.jsxs)("span",{children:["Total ",m.format(i.amount/100)]}),(0,b.jsx)(h.Button,{asChild:!0,className:"text-primary gap-1 text-xs",size:"sm",variant:"ghost",children:(0,b.jsxs)(f.default,{href:`/dashboard/work/invoices/${i.id}`,children:["View",(0,b.jsx)(c.ArrowUpRight,{className:"size-3.5"})]})})]})]})}a.s(["InvoicesKanban",()=>n])},18507,a=>{"use strict";var b=a.i(861467),c=a.i(452168),d=a.i(187056),e=a.i(319895),f=a.i(638727),g=a.i(739044),h=a.i(145679),i=a.i(783281),j=a.i(156916);a.i(400355);var k=a.i(694340);a.i(445255);var l=a.i(18170),m=a.i(380340);a.i(696137);var n=a.i(736096),o=a.i(493667),p=a.i(337241),q=a.i(792268),r=a.i(758416);function s({invoices:s,itemsPerPage:t=50,showRefresh:u=!1,enableVirtualization:v="auto",totalCount:w,currentPage:x=1}){!function(a,b={}){let c=(0,p.useRouter)(),d=(0,p.usePathname)(),e=(0,p.useSearchParams)(),f=(0,i.useRef)(!0),{excludeKeys:g=[],debounceMs:h=300}=b;(0,i.useEffect)(()=>{if(!f.current)return;f.current=!1;let b={},c=a.getState().filters;e.forEach((a,d)=>{if(!g.includes(d)&&d in c){let e=c[d];"number"==typeof e?b[d]=Number.parseFloat(a):"boolean"==typeof e?b[d]="true"===a:b[d]=a}}),Object.keys(b).length>0&&a.getState().setFilters(b)},[]),(0,i.useEffect)(()=>{let b,f=a.subscribe(()=>{clearTimeout(b),b=setTimeout(()=>{let b=a.getState().filters,f=new URLSearchParams(e.toString());Object.entries(b).forEach(([a,b])=>{g.includes(a)||(""===b||null==b||"all"===b||"active"===b?f.delete(a):f.set(a,String(b)))});let h=""===f.toString()?d:`${d}?${f.toString()}`;h!==`${d}${e.toString()?`?${e.toString()}`:""}`&&c.push(h,{scroll:!1})},h)});return()=>{clearTimeout(b),f()}},[a,c,d,e,g,h])}(r.useInvoiceFiltersStore);let y=(0,r.useInvoiceFiltersStore)(a=>a.filters),[z,A]=(0,i.useState)(!1),[B,C]=(0,i.useState)(null),[D,E]=(0,i.useState)(!1),[F,G]=(0,i.useState)(!1),[H,I]=(0,i.useState)(new Set),[J,K]=(0,i.useState)(new Set),L=(0,i.useMemo)(()=>{let a=s;if("active"===y.archiveStatus?a=a.filter(a=>!(a.archived_at||a.deleted_at)):"archived"===y.archiveStatus&&(a=a.filter(a=>!!(a.archived_at||a.deleted_at))),y.status&&"all"!==y.status&&(a=a.filter(a=>a.status===y.status)),y.amountMin){let b=100*Number(y.amountMin);a=a.filter(a=>a.amount>=b)}if(y.amountMax){let b=100*Number(y.amountMax);a=a.filter(a=>a.amount<=b)}if(y.customerName){let b=y.customerName.toLowerCase();a=a.filter(a=>a.customer.toLowerCase().includes(b))}if(y.invoiceNumber){let b=y.invoiceNumber.toLowerCase();a=a.filter(a=>a.invoiceNumber.toLowerCase().includes(b))}return a},[s,y]),M="archived"===y.archiveStatus||"all"===y.archiveStatus,N=[{key:"invoiceNumber",header:"Invoice #",width:"w-36",shrink:!0,sortable:!0,render:a=>(0,b.jsx)(h.default,{className:"text-foreground hover:text-primary text-sm font-medium transition-colors hover:underline",href:`/dashboard/work/invoices/${a.id}`,onClick:a=>a.stopPropagation(),children:a.invoiceNumber})},{key:"customer",header:"Customer",width:"flex-1",sortable:!0,hideable:!1,render:a=>(0,b.jsx)(h.default,{className:"block",href:`/dashboard/work/invoices/${a.id}`,onClick:a=>a.stopPropagation(),children:(0,b.jsx)("span",{className:"text-foreground text-sm font-medium hover:underline",children:a.customer})})},{key:"date",header:"Date",width:"w-32",shrink:!0,hideOnMobile:!0,sortable:!0,hideable:!0,render:a=>(0,b.jsx)("span",{className:"text-muted-foreground text-sm tabular-nums",children:a.date})},{key:"dueDate",header:"Due Date",width:"w-32",shrink:!0,hideOnMobile:!0,sortable:!0,hideable:!1,render:a=>(0,b.jsx)("span",{className:"text-muted-foreground text-sm tabular-nums",children:a.dueDate})},{key:"amount",header:"Amount",width:"w-32",shrink:!0,align:"right",sortable:!0,hideable:!1,render:a=>(0,b.jsx)("span",{className:"font-semibold tabular-nums",children:(0,q.formatCurrency)(a.amount,{decimals:2})})},{key:"status",header:"Status",width:"w-28",shrink:!0,sortable:!0,hideable:!1,render:a=>(0,b.jsx)(o.InvoiceStatusBadge,{status:a.status})},{key:"actions",header:"",width:"w-10",shrink:!0,render:a=>(0,b.jsx)(n.RowActionsDropdown,{actions:[{label:"View Invoice",icon:e.FileText,href:`/dashboard/work/invoices/${a.id}`},{label:"Send to Customer",icon:g.Send,onClick:()=>{window.location.href=`/dashboard/work/invoices/${a.id}?action=send`}},{label:"Download PDF",icon:d.Download,onClick:()=>{window.open(`/api/invoices/${a.id}/pdf`,"_blank")}},..."paid"!==a.status?[{label:"Archive Invoice",icon:c.Archive,variant:"destructive",separatorBefore:!0,onClick:()=>{C(a.id),A(!0)}}]:[]]})}],[O,P]=(0,i.useState)(!1),Q=[{label:"Send",icon:(0,b.jsx)(g.Send,{className:"h-4 w-4"}),onClick:async a=>{O||(0===L.filter(b=>a.has(b.id)).length?j.toast.error("No invoices selected"):(K(a),G(!0)))}},{label:"Download",icon:(0,b.jsx)(d.Download,{className:"h-4 w-4"}),onClick:()=>{j.toast.info("Download functionality coming soon")}},{label:"Archive Selected",icon:(0,b.jsx)(c.Archive,{className:"h-4 w-4"}),onClick:a=>{L.some(b=>a.has(b.id)&&"paid"!==b.status)?(I(a),E(!0)):j.toast.error("All selected invoices are paid and cannot be archived")},variant:"destructive"}];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(m.FullWidthDataTable,{bulkActions:Q,columns:N,data:L,emptyAction:(0,b.jsxs)(l.Button,{onClick:()=>window.location.href="/dashboard/work/invoices/new",size:"sm",children:[(0,b.jsx)(f.Plus,{className:"mr-2 size-4"}),"Create Invoice"]}),emptyIcon:(0,b.jsx)(e.FileText,{className:"text-muted-foreground h-8 w-8"}),emptyMessage:"No invoices found",enableSelection:!0,enableVirtualization:v,entity:"invoices",getHighlightClass:()=>"bg-destructive/50 dark:bg-destructive/20",getItemId:a=>a.id,isArchived:a=>!!(a.archived_at||a.deleted_at),isHighlighted:a=>"overdue"===a.status,itemsPerPage:t,totalCount:w??L.length,currentPageFromServer:x,serverPagination:!0,onRefresh:()=>window.location.reload(),onRowClick:a=>{window.location.href=`/dashboard/work/invoices/${a.id}`},searchFilter:(a,b)=>{let c=b.toLowerCase();return a.invoiceNumber.toLowerCase().includes(c)||a.customer.toLowerCase().includes(c)||a.status.toLowerCase().includes(c)},searchPlaceholder:"Search invoices by number, customer, or status...",showArchived:M,showRefresh:u,toolbarActions:void 0}),(0,b.jsx)(k.AlertDialog,{onOpenChange:A,open:z,children:(0,b.jsxs)(k.AlertDialogContent,{children:[(0,b.jsxs)(k.AlertDialogHeader,{children:[(0,b.jsx)(k.AlertDialogTitle,{children:"Archive Invoice?"}),(0,b.jsx)(k.AlertDialogDescription,{children:"This invoice will be archived and can be restored within 90 days."})]}),(0,b.jsxs)(k.AlertDialogFooter,{children:[(0,b.jsx)(k.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(k.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{if(B)try{let{archiveInvoice:b}=await a.A(679714),c=await b(B);c.success?(j.toast.success("Invoice archived successfully"),window.location.reload()):j.toast.error(c.error||"Failed to archive invoice")}catch{j.toast.error("Failed to archive invoice")}},children:"Archive"})]})]})}),(0,b.jsx)(k.AlertDialog,{onOpenChange:E,open:D,children:(0,b.jsxs)(k.AlertDialogContent,{children:[(0,b.jsxs)(k.AlertDialogHeader,{children:[(0,b.jsxs)(k.AlertDialogTitle,{children:["Archive ",H.size," Invoice(s)?"]}),(0,b.jsxs)(k.AlertDialogDescription,{children:[H.size," invoice(s) will be archived and can be restored within 90 days. Paid invoices will be automatically skipped."]})]}),(0,b.jsxs)(k.AlertDialogFooter,{children:[(0,b.jsx)(k.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(k.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{let b=j.toast.loading(`Archiving ${H.size} invoice(s)...`);try{let{bulkArchiveInvoices:c}=await a.A(57202),d=await c(Array.from(H));if(j.toast.dismiss(b),d.success&&d.data){let{successful:a,failed:b,skipped:c}=d.data;a>0?(j.toast.success(d.message||"Invoices archived"),window.location.reload()):c>0&&0===b?j.toast.warning(`${c} paid invoice${1!==c?"s":""} cannot be archived`):j.toast.error(d.message||"Failed to archive invoices")}else j.toast.error("Failed to archive invoices")}catch(a){j.toast.dismiss(b),j.toast.error(a instanceof Error?a.message:"Failed to archive invoices")}},children:"Archive"})]})]})}),(0,b.jsx)(k.AlertDialog,{onOpenChange:G,open:F,children:(0,b.jsxs)(k.AlertDialogContent,{children:[(0,b.jsxs)(k.AlertDialogHeader,{children:[(0,b.jsxs)(k.AlertDialogTitle,{children:["Send ",J.size," Invoice(s)?"]}),(0,b.jsxs)(k.AlertDialogDescription,{children:["This will send ",J.size," invoice",1!==J.size?"s":""," via email to your customers.",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),(0,b.jsx)("strong",{children:"Estimated time:"})," ",Math.ceil(.5*J.size)," second",1!==Math.ceil(.5*J.size)?"s":"",(0,b.jsx)("br",{}),(0,b.jsx)("br",{}),"Note: Only invoices with customer email addresses will be sent."]})]}),(0,b.jsxs)(k.AlertDialogFooter,{children:[(0,b.jsx)(k.AlertDialogCancel,{children:"Cancel"}),(0,b.jsx)(k.AlertDialogAction,{onClick:async()=>{G(!1),P(!0);let{useSyncStore:b}=await a.A(800564),{startOperation:c,updateOperation:d,completeOperation:e}=b.getState(),f=Array.from(J),g=f.length,h=c({type:"bulk_send_invoices",title:`Sending ${g} invoice${1!==g?"s":""}`,description:"Preparing emails with payment links...",total:g,current:0});try{let{bulkSendInvoices:b}=await a.A(891586),c=await b(f,{batchSize:10,batchDelay:1e3});c.success||(c.results?.successful??0)>0?(e(h,!0),j.toast.success(c.message)):(e(h,!1,c.error||"Failed to send invoices"),j.toast.error(c.error||"Failed to send invoices")),(c.results?.successful??0)>0&&window.location.reload()}catch(a){e(h,!1,a instanceof Error?a.message:"Failed to send invoices"),j.toast.error(a instanceof Error?a.message:"Failed to send invoices")}finally{P(!1),K(new Set)}},children:"Send Invoices"})]})]})})]})}a.s(["InvoicesTable",()=>s],18507)}];

//# sourceMappingURL=apps_web_src_components_work_5a9c1000._.js.map