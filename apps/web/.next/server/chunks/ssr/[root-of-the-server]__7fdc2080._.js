module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},997868,a=>{a.n(a.i(884849))},592581,a=>{a.n(a.i(596565))},134005,a=>{a.n(a.i(977930))},565165,a=>{a.n(a.i(728209))},147941,a=>{a.n(a.i(484103))},304434,a=>{a.n(a.i(632684))},407521,a=>{a.n(a.i(693094))},797797,a=>{a.n(a.i(977207))},290022,a=>{a.n(a.i(362735))},729157,a=>{a.n(a.i(470009))},712363,a=>{a.n(a.i(279732))},208120,a=>{a.n(a.i(52860))},863056,a=>{a.n(a.i(77721))},66645,a=>{a.n(a.i(914802))},774453,a=>{a.n(a.i(964200))},255760,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call MaintenancePlanPageContent() from the server but MaintenancePlanPageContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/maintenance-plans/maintenance-plan-page-content.tsx <module evaluation>","MaintenancePlanPageContent");a.s(["MaintenancePlanPageContent",0,b])},407410,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call MaintenancePlanPageContent() from the server but MaintenancePlanPageContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/maintenance-plans/maintenance-plan-page-content.tsx","MaintenancePlanPageContent");a.s(["MaintenancePlanPageContent",0,b])},214018,a=>{"use strict";a.i(255760);var b=a.i(407410);a.n(b)},151110,a=>{"use strict";var b=a.i(504348),c=a.i(429969);a.i(692167);var d=a.i(852596),e=a.i(214018);a.i(467361);var f=a.i(445074),g=a.i(136874);async function h({planId:c}){let h=await (0,g.createClient)();if(!h)return(0,d.notFound)();let{data:{user:i}}=await h.auth.getUser();if(!i)return(0,d.notFound)();await (0,f.isActiveCompanyOnboardingComplete)()||(0,d.redirect)("/dashboard");let{getActiveCompanyId:j}=await a.A(37652),k=await j();k||(0,d.redirect)("/dashboard");let{data:l,error:m}=await h.from("maintenance_plans").select(`
      *,
      customer:customers!customer_id(*),
      property:properties!property_id(*)
    `).eq("id",c).eq("company_id",k).maybeSingle();if(m||!l)return(0,d.notFound)();let n={...l,price:l.price??(null!==l.amount&&void 0!==l.amount?Math.round(100*Number(l.amount)):0),included_services:l.included_services??l.services_included??[],next_service_due:l.next_service_due??l.next_service_date??null,visits_per_term:l.visits_per_term??l.total_services_scheduled??1,type:l.type??"maintenance",taxable:l.taxable??!1},o=Array.isArray(n.customer)?n.customer[0]:n.customer,p=Array.isArray(n.property)?n.property[0]:n.property,{data:q}=await h.from("equipment").select("*").eq("service_plan_id",c).is("deleted_at",null),[{data:r},{data:s},{data:t},{data:u},{data:v},{data:w}]=await Promise.all([h.from("jobs").select("id, job_number, title, status, completed_at, property:properties!property_id(id, name, address)").eq("company_id",k).is("deleted_at",null).or(`metadata->>'service_plan_id'.eq.${c},metadata->>'maintenance_plan_id'.eq.${c}`).order("created_at",{ascending:!1}).limit(10),q&&q.length>0?h.from("appointments").select(`
            id,
            scheduled_start,
            scheduled_end,
            status,
            type,
            job:jobs!job_id(id, job_number, title),
            property:properties!property_id(id, name, address)
          `).eq("company_id",k).gte("scheduled_start",new Date().toISOString()).is("deleted_at",null).order("scheduled_start",{ascending:!0}).limit(10).then(async a=>{if(!a.data)return a;let b=q.map(a=>a.id),c=a.data.map(a=>a.job_id).filter(Boolean);if(0===c.length)return{data:[],error:null};let{data:d}=await h.from("job_equipment").select("job_id").in("equipment_id",b).in("job_id",c),e=new Set(d?.map(a=>a.job_id)||[]);return{data:a.data.filter(a=>a.job_id&&e.has(a.job_id)),error:null}}):Promise.resolve({data:[],error:null}),h.from("invoices").select("id, invoice_number, total_amount, status, created_at").eq("company_id",k).or(`metadata->>'service_plan_id'.eq.${c},metadata->>'maintenance_plan_id'.eq.${c}`).order("created_at",{ascending:!1}).limit(10),h.from("activity_log").select("*, user:users!user_id(*)").eq("entity_type","service_plan").eq("entity_id",c).order("created_at",{ascending:!1}).limit(50),h.from("notes").select("*").eq("entity_type","service_plan").eq("entity_id",c).is("deleted_at",null).order("created_at",{ascending:!1}),h.from("attachments").select("*").eq("entity_type","service_plan").eq("entity_id",c).order("created_at",{ascending:!1})]);return(0,b.jsx)("div",{className:"flex h-full w-full flex-col overflow-auto",children:(0,b.jsx)("div",{className:"mx-auto w-full max-w-7xl",children:(0,b.jsx)(e.MaintenancePlanPageContent,{entityData:{plan:n,customer:o,property:p,equipment:q||[],generatedJobs:r||[],scheduledAppointments:s||[],generatedInvoices:t||[],activities:u||[],notes:v||[],attachments:w||[]}})})})}function i(){return(0,b.jsx)("div",{className:"flex h-full w-full flex-col overflow-auto",children:(0,b.jsxs)("div",{className:"mx-auto w-full max-w-7xl space-y-6 p-6",children:[(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-8 w-64 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-80 animate-pulse rounded"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:"bg-muted h-10 w-28 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-10 w-28 animate-pulse rounded"})]})]})}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(a=>(0,b.jsxs)("div",{className:"space-y-2 rounded-lg border p-4",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-24 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-6 w-32 animate-pulse rounded"})]},a))}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-6 lg:col-span-2",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-40 animate-pulse rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-full animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-3/4 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-2/3 animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-40 animate-pulse rounded"}),(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3,4,5].map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"bg-muted size-5 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-64 animate-pulse rounded"})]},a))})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-32 animate-pulse rounded"}),(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-48 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-24 animate-pulse rounded"})]},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-24 animate-pulse rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-full animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-3/4 animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-32 animate-pulse rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-full animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-2/3 animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-24 animate-pulse rounded"}),(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-24 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-32 animate-pulse rounded"})]},a))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex gap-4 border-b",children:[1,2,3,4].map(a=>(0,b.jsx)("div",{className:"bg-muted h-10 w-28 animate-pulse rounded-t"},a))}),(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsx)("div",{className:"bg-muted h-24 w-full animate-pulse rounded"},a))})]})]})})}async function j({params:a}){let{id:d}=await a;return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(i,{}),children:(0,b.jsx)(h,{planId:d})})}a.s(["default",()=>j],151110)},37652,a=>{a.v(b=>Promise.all(["server/chunks/ssr/apps_web_src_lib_auth_company-context_ts_732d588b._.js"].map(b=>a.l(b))).then(()=>b(480513)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__7fdc2080._.js.map