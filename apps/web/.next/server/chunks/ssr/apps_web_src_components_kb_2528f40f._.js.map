{"version":3,"sources":["../../../../../../apps/web/src/components/kb/kb-sidebar-provider.tsx","../../../../../../apps/web/src/components/kb/kb-search.tsx","../../../../../../apps/web/src/actions/data%3Ab00341%20%3Ctext/javascript%3E"],"sourcesContent":["/**\n * KB Sidebar Provider - Client Component\n *\n * Provides sidebar context and layout structure\n */\n\n\"use client\";\n\nimport React, { type ReactNode } from \"react\";\nimport {\n\tSidebar,\n\tSidebarInset,\n\tSidebarProvider,\n\tSidebarRail,\n\tSidebarTrigger,\n} from \"@/components/ui/sidebar\";\n\ntype KBSidebarProviderProps = {\n\tchildren: ReactNode;\n};\n\nexport function KBSidebarProvider({ children }: KBSidebarProviderProps) {\n\t// Extract sidebar content and main content from children\n\t// The first child should be the sidebar content, rest is main content\n\tconst childrenArray = React.Children.toArray(children);\n\tconst sidebarContent = childrenArray[0];\n\tconst mainContent = childrenArray.slice(1);\n\n\treturn (\n\t\t<SidebarProvider>\n\t\t\t<Sidebar collapsible=\"offcanvas\" variant=\"sidebar\">\n\t\t\t\t{sidebarContent}\n\t\t\t\t<SidebarRail />\n\t\t\t</Sidebar>\n\t\t\t<SidebarInset>\n\t\t\t\t<div className=\"flex h-full flex-col\">\n\t\t\t\t\t{/* Sidebar Trigger for mobile */}\n\t\t\t\t\t<div className=\"flex h-16 shrink-0 items-center gap-2 border-b px-4 md:hidden\">\n\t\t\t\t\t\t<SidebarTrigger />\n\t\t\t\t\t\t<span className=\"font-semibold\">Knowledge Base</span>\n\t\t\t\t\t</div>\n\t\t\t\t\t{/* Main Content */}\n\t\t\t\t\t<div className=\"flex-1 overflow-auto\">{mainContent}</div>\n\t\t\t\t</div>\n\t\t\t</SidebarInset>\n\t\t</SidebarProvider>\n\t);\n}\n","/**\n * KB Search - Client Component\n *\n * Global search bar with autocomplete for knowledge base\n */\n\n\"use client\";\n\nimport { Loader2, Search } from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { searchKBArticles } from \"@/actions/kb\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport type { KBArticleWithRelations } from \"@/lib/kb/types\";\nimport { cn } from \"@/lib/utils\";\n\ntype KBSearchProps = {\n\tclassName?: string;\n\tplaceholder?: string;\n\tshowButton?: boolean;\n};\n\nexport function KBSearch({\n\tclassName,\n\tplaceholder = \"Search knowledge base...\",\n\tshowButton = true,\n}: KBSearchProps) {\n\tconst [query, setQuery] = useState(\"\");\n\tconst [results, setResults] = useState<KBArticleWithRelations[]>([]);\n\tconst [isSearching, setIsSearching] = useState(false);\n\tconst [showResults, setShowResults] = useState(false);\n\tconst router = useRouter();\n\tconst searchRef = useRef<HTMLDivElement>(null);\n\tconst inputRef = useRef<HTMLInputElement>(null);\n\n\t// Close results when clicking outside\n\tuseEffect(() => {\n\t\tconst handleClickOutside = (event: MouseEvent) => {\n\t\t\tif (\n\t\t\t\tsearchRef.current &&\n\t\t\t\t!searchRef.current.contains(event.target as Node)\n\t\t\t) {\n\t\t\t\tsetShowResults(false);\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener(\"mousedown\", handleClickOutside);\n\t\treturn () => document.removeEventListener(\"mousedown\", handleClickOutside);\n\t}, []);\n\n\t// Search as user types (debounced)\n\tuseEffect(() => {\n\t\tif (!query.trim()) {\n\t\t\tsetResults([]);\n\t\t\tsetShowResults(false);\n\t\t\treturn;\n\t\t}\n\n\t\tconst timeoutId = setTimeout(async () => {\n\t\t\tsetIsSearching(true);\n\t\t\tconst result = await searchKBArticles(query, { limit: 5 });\n\t\t\tif (result.success && result.articles) {\n\t\t\t\tsetResults(result.articles);\n\t\t\t\tsetShowResults(true);\n\t\t\t}\n\t\t\tsetIsSearching(false);\n\t\t}, 300);\n\n\t\treturn () => clearTimeout(timeoutId);\n\t}, [query]);\n\n\tconst handleSubmit = (e: React.FormEvent) => {\n\t\te.preventDefault();\n\t\tif (query.trim()) {\n\t\t\trouter.push(`/kb/search?q=${encodeURIComponent(query)}`);\n\t\t\tsetShowResults(false);\n\t\t}\n\t};\n\n\tconst handleResultClick = (categorySlug: string, articleSlug: string) => {\n\t\trouter.push(`/kb/${categorySlug}/${articleSlug}`);\n\t\tsetShowResults(false);\n\t\tsetQuery(\"\");\n\t};\n\n\treturn (\n\t\t<div className={cn(\"relative w-full\", className)} ref={searchRef}>\n\t\t\t<form className=\"flex gap-2\" onSubmit={handleSubmit}>\n\t\t\t\t<div className=\"relative flex-1\">\n\t\t\t\t\t<Search className=\"text-muted-foreground absolute top-1/2 left-3 size-4 -translate-y-1/2\" />\n\t\t\t\t\t<Input\n\t\t\t\t\t\tclassName=\"pl-10\"\n\t\t\t\t\t\tonChange={(e) => setQuery(e.target.value)}\n\t\t\t\t\t\tonFocus={() => query.trim() && setShowResults(true)}\n\t\t\t\t\t\tplaceholder={placeholder}\n\t\t\t\t\t\tref={inputRef}\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tvalue={query}\n\t\t\t\t\t/>\n\t\t\t\t\t{isSearching && (\n\t\t\t\t\t\t<Loader2 className=\"text-muted-foreground absolute top-1/2 right-3 size-4 -translate-y-1/2 animate-spin\" />\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t{showButton && (\n\t\t\t\t\t<Button disabled={!query.trim() || isSearching} type=\"submit\">\n\t\t\t\t\t\tSearch\n\t\t\t\t\t</Button>\n\t\t\t\t)}\n\n\t\t\t\t{/* Autocomplete results dropdown */}\n\t\t\t\t{showResults && results.length > 0 && (\n\t\t\t\t\t<div className=\"bg-card absolute top-full z-50 mt-2 w-full rounded-lg border shadow-lg\">\n\t\t\t\t\t\t<div className=\"max-h-96 space-y-1 overflow-y-auto p-2\">\n\t\t\t\t\t\t\t{results.map((article) => (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"hover:bg-accent w-full rounded-md px-3 py-2 text-left text-sm transition-colors\"\n\t\t\t\t\t\t\t\t\tkey={article.id}\n\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\thandleResultClick(article.category.slug, article.slug)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"font-medium\">{article.title}</div>\n\t\t\t\t\t\t\t\t\t{article.excerpt && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"text-muted-foreground line-clamp-1 text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t{article.excerpt}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t<div className=\"text-muted-foreground text-xs\">\n\t\t\t\t\t\t\t\t\t\t{article.category.title}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t<div className=\"border-t pt-2\">\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"text-primary hover:bg-accent w-full rounded-md px-3 py-2 text-left text-sm font-medium\"\n\t\t\t\t\t\t\t\t\tonClick={handleSubmit}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tView all results for \"{query}\"\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</form>\n\t\t</div>\n\t);\n}\n","/* __next_internal_action_entry_do_not_use__ [{\"60301b0c2049c37f7b265049269699f6d4a7a33d92\":\"searchKBArticles\"},\"apps/web/src/actions/kb.ts\",\"\"] */\"use turbopack no side effects\";import{createServerReference,callServer,findSourceMapURL}from\"private-next-rsc-action-client-wrapper\";export var searchKBArticles=/*#__PURE__*/createServerReference(\"60301b0c2049c37f7b265049269699f6d4a7a33d92\",callServer,void 0,findSourceMapURL,\"searchKBArticles\");"],"names":[],"mappings":"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"}