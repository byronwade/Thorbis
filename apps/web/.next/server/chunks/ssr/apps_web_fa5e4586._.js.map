{"version":3,"sources":["../../../../../../apps/web/src/actions/teams-actions.ts","../../../../../../apps/web/.next-internal/server/app/%28dashboard%29/dashboard/communication/teams/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["/**\n * Teams/Channels Server Actions\n * \n * Server-side actions for team channel messaging\n */\n\n\"use server\";\n\nimport { createClient } from \"@/lib/supabase/server\";\nimport { getActiveCompanyId } from \"@/lib/auth/company-context\";\nimport { z } from \"zod\";\n\nconst getChannelMessagesSchema = z.object({\n  channel: z.string().min(1),\n  limit: z.coerce.number().min(1).max(500).optional().default(100),\n  offset: z.coerce.number().min(0).optional().default(0),\n  search: z.string().optional(),\n});\n\nconst sendChannelMessageSchema = z.object({\n  channel: z.string().min(1),\n  text: z.string().optional(),\n  attachments: z.array(z.object({\n    file: z.instanceof(File),\n    type: z.enum([\"image\", \"file\"]),\n  })).optional().default([]),\n});\n\nexport type GetChannelMessagesInput = z.infer<typeof getChannelMessagesSchema>;\nexport type SendChannelMessageInput = z.infer<typeof sendChannelMessageSchema>;\n\nexport type ChannelMessage = {\n  id: string;\n  body: string;\n  body_html: string | null;\n  created_at: string;\n  read_at: string | null;\n  direction: \"inbound\" | \"outbound\";\n  sent_by: string | null;\n  sent_by_user?: {\n    id: string;\n    name: string | null;\n    avatar: string | null;\n  } | null;\n  provider_metadata: Record<string, unknown> | null;\n};\n\n/**\n * Get messages for a team channel\n */\nexport async function getTeamChannelMessagesAction(\n  input: GetChannelMessagesInput\n): Promise<{\n  success: boolean;\n  messages?: ChannelMessage[];\n  error?: string;\n}> {\n  try {\n    const parseResult = getChannelMessagesSchema.safeParse(input);\n    \n    if (!parseResult.success) {\n      return {\n        success: false,\n        error: `Invalid input: ${parseResult.error.errors.map(e => `${e.path.join('.')}: ${e.message}`).join(', ')}`,\n      };\n    }\n    \n    const validatedInput = parseResult.data;\n    const companyId = await getActiveCompanyId();\n    \n    if (!companyId) {\n      return { success: false, error: \"No active company found\" };\n    }\n\n    const supabase = await createClient();\n    if (!supabase) {\n      return { success: false, error: \"Database connection failed\" };\n    }\n\n    // Query communications table for channel messages\n    // Using tags to identify channel messages\n    let query = supabase\n      .from(\"communications\")\n      .select(`\n        id,\n        body,\n        body_html,\n        created_at,\n        read_at,\n        direction,\n        sent_by,\n        provider_metadata,\n        tags,\n        sent_by_user:users!sent_by(id, name, avatar)\n      `)\n      .eq(\"company_id\", companyId)\n      .eq(\"type\", \"sms\") // Using SMS type for team messages\n      .is(\"deleted_at\", null)\n      .order(\"created_at\", { ascending: true });\n\n    if (validatedInput.search) {\n      query = query.ilike(\"body\", `%${validatedInput.search}%`);\n    }\n\n    query = query.range(validatedInput.offset, validatedInput.offset + validatedInput.limit - 1);\n\n    const { data, error } = await query;\n    \n    // Filter messages by channel tag in memory (workaround for JSONB contains issue)\n    // The tags column is JSONB, but .contains() is having type issues, so filter in memory\n    const filteredData = data?.filter((msg) => {\n      const tags = msg.tags as string[] | null;\n      return tags && Array.isArray(tags) && tags.includes(validatedInput.channel);\n    }) || [];\n\n    if (error) {\n      console.error(\"Error fetching channel messages:\", error);\n      return { success: false, error: error.message };\n    }\n\n    const messages = (filteredData || []).map((msg) => ({\n      ...msg,\n      provider_metadata: (msg.provider_metadata as Record<string, unknown>) || null,\n    })) as ChannelMessage[];\n\n    return { success: true, messages };\n  } catch (error) {\n    console.error(\"Error in getTeamChannelMessagesAction:\", error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown error\",\n    };\n  }\n}\n\n/**\n * Send a message to a team channel\n */\nexport async function sendTeamChannelMessageAction(\n  input: SendChannelMessageInput\n): Promise<{\n  success: boolean;\n  messageId?: string;\n  error?: string;\n}> {\n  try {\n    const parseResult = sendChannelMessageSchema.safeParse(input);\n    \n    if (!parseResult.success) {\n      return {\n        success: false,\n        error: `Invalid input: ${parseResult.error.errors.map(e => `${e.path.join('.')}: ${e.message}`).join(', ')}`,\n      };\n    }\n    \n    const validatedInput = parseResult.data;\n    const companyId = await getActiveCompanyId();\n    \n    if (!companyId) {\n      return { success: false, error: \"No active company found\" };\n    }\n\n    const supabase = await createClient();\n    if (!supabase) {\n      return { success: false, error: \"Database connection failed\" };\n    }\n\n    // Get current user\n    const { data: { user } } = await supabase.auth.getUser();\n    if (!user) {\n      return { success: false, error: \"User not authenticated\" };\n    }\n\n    // Extract attachment URLs (already uploaded by client)\n    const attachmentUrls = validatedInput.attachments\n      ?.map(a => a.url)\n      .filter((url): url is string => !!url) || [];\n\n    // Insert message into communications table\n    const { data: message, error: insertError } = await supabase\n      .from(\"communications\")\n      .insert({\n        company_id: companyId,\n        type: \"sms\",\n        direction: \"outbound\",\n        channel: \"teams\",\n        body: validatedInput.text || \"\",\n        body_html: validatedInput.text || null,\n        sent_by: user.id,\n        to_address: `channel:${validatedInput.channel}`,\n        from_address: user.email || \"\",\n        tags: [validatedInput.channel],\n        provider_metadata: attachmentUrls.length > 0 ? {\n          attachments: attachmentUrls.map((url, idx) => ({\n            url,\n            type: validatedInput.attachments?.[idx]?.type || \"file\",\n            filename: validatedInput.attachments?.[idx]?.filename || \"attachment\",\n          })),\n        } : null,\n        attachment_count: attachmentUrls.length,\n        status: \"sent\",\n        is_internal: true, // Team messages are internal\n      })\n      .select()\n      .single();\n\n    if (insertError) {\n      console.error(\"Error sending channel message:\", insertError);\n      return { success: false, error: insertError.message };\n    }\n\n    return { success: true, messageId: message.id };\n  } catch (error) {\n    console.error(\"Error in sendTeamChannelMessageAction:\", error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown error\",\n    };\n  }\n}\n\n/**\n * Mark all unread messages in a team channel as read\n */\nexport async function markTeamChannelAsReadAction(channel: string): Promise<{\n  success: boolean;\n  error?: string;\n}> {\n  \"use server\";\n  \n  try {\n    const companyId = await getActiveCompanyId();\n    \n    if (!companyId) {\n      return { success: false, error: \"No active company found\" };\n    }\n\n    const supabase = await createClient();\n    if (!supabase) {\n      return { success: false, error: \"Database connection failed\" };\n    }\n\n    // Get all unread inbound messages first, then filter by channel in memory\n    const { data: unreadMessages, error: fetchError } = await supabase\n      .from(\"communications\")\n      .select(\"id, tags\")\n      .eq(\"company_id\", companyId)\n      .eq(\"type\", \"sms\")\n      .eq(\"direction\", \"inbound\")\n      .is(\"read_at\", null)\n      .is(\"deleted_at\", null);\n\n    if (fetchError) {\n      console.error(\"Error fetching unread messages:\", fetchError);\n      return { success: false, error: fetchError.message };\n    }\n\n    // Filter by channel in memory (workaround for JSONB contains issue)\n    const channelMessageIds = (unreadMessages || [])\n      .filter((msg) => {\n        const tags = msg.tags as string[] | null;\n        return tags && Array.isArray(tags) && tags.includes(channel);\n      })\n      .map((msg) => msg.id);\n\n    if (channelMessageIds.length === 0) {\n      return { success: true }; // No unread messages to mark\n    }\n\n    // Mark filtered messages as read\n    const readAt = new Date().toISOString();\n    const { data, error } = await supabase\n      .from(\"communications\")\n      .update({ read_at: readAt })\n      .in(\"id\", channelMessageIds)\n      .select(\"id, read_at\");\n\n    if (error) {\n      console.error(\"Error marking channel messages as read:\", error);\n      return { success: false, error: error.message };\n    }\n\n    console.log(`âœ… markTeamChannelAsReadAction success: Marked ${data?.length || 0} messages as read`);\n\n    if (error) {\n      console.error(\"Error marking channel messages as read:\", error);\n      return { success: false, error: error.message };\n    }\n\n    return { success: true };\n  } catch (error) {\n    console.error(\"Error in markTeamChannelAsReadAction:\", error);\n    return {\n      success: false,\n      error: error instanceof Error ? error.message : \"Unknown error\",\n    };\n  }\n}\n\n","export {getCurrentUserRole as '001f005176797ef23488068124fb9a744915a477de'} from 'ACTIONS_MODULE0'\nexport {canDeleteTeamMember as '406f6624261c6dd1a908026fa1408a3f6d507b6e7d'} from 'ACTIONS_MODULE0'\nexport {getPayrixMerchantAccount as '40704f0e856ad801ef93b43436f219a36f7c0efd2c'} from 'ACTIONS_MODULE1'\nexport {getWebRTCCredentials as '000478fbf5363dae5000d525663da13e29908cb952'} from 'ACTIONS_MODULE2'\nexport {transcribeCallRecording as '4002f454c46f4c21ca6e9e26362583ccff69c9f914'} from 'ACTIONS_MODULE2'\nexport {getCompanyPhoneNumbers as '4019cf9f81eb3c06f82b5c2f8eb042f3d95d91e933'} from 'ACTIONS_MODULE2'\nexport {getCallRoutingRules as '40247c617842c31b242455a0961cbd2c3297606a16'} from 'ACTIONS_MODULE2'\nexport {updateCallRoutingRule as '40413bfa888916480edbc33ebb812158fddf960f89'} from 'ACTIONS_MODULE2'\nexport {startCallRecording as '404e47931374ad2a1b54bc11f357703790f6104530'} from 'ACTIONS_MODULE2'\nexport {transferActiveCall as '405a16958f97c37bd4b5711bd8761510bdab55839f'} from 'ACTIONS_MODULE2'\nexport {searchPhoneNumbers as '406864ae05b8b51c66cc2c335999e5011a41cb521f'} from 'ACTIONS_MODULE2'\nexport {makeCall as '40b2df540ec465c5dc19545c96486485bb50b5633b'} from 'ACTIONS_MODULE2'\nexport {sendTextMessage as '40d050abdabe2ee7293436c505c5f27b4408a2f27c'} from 'ACTIONS_MODULE2'\nexport {stopCallRecording as '40d5cc291162e2fd61245bdb851d5e8ed609e4ed19'} from 'ACTIONS_MODULE2'\nexport {sendMMSMessage as '40edd91786b2a482e617fb16f2474d26ec295435e7'} from 'ACTIONS_MODULE2'\nexport {purchasePhoneNumber as '40fd6a80b32792fab749933f98f07503d8e94c0305'} from 'ACTIONS_MODULE2'\nexport {deleteCallRoutingRule as '607d0f958daf66b2a0d5277cdda17600dace5156bb'} from 'ACTIONS_MODULE2'\nexport {toggleCallRoutingRule as '60853f1e409364f7e171e27229217994ff224414e6'} from 'ACTIONS_MODULE2'\nexport {createServiceSupabaseClient as '00a13dbd00149949fc1367d3e76ae7d789e07f5321'} from 'ACTIONS_MODULE3'\nexport {ensureMessagingBranding as '606753f8910b46d5792f4bdeb457cdf29d1a8bbadc'} from 'ACTIONS_MODULE4'\nexport {ensureMessagingCampaign as '70a648f43fa62ae3dcf2070eb90413e96e81591e77'} from 'ACTIONS_MODULE4'\nexport {checkTelnyxVerificationStatus as '007505a78985e53e083a498c97761ed8a463d3d379'} from 'ACTIONS_MODULE5'\nexport {submitAutomatedVerification as '4087f0badccd6aaf6a28b640ab4bbc513f0832d105'} from 'ACTIONS_MODULE5'\nexport {registerCompanyFor10DLC as '40ae25402a089e45aa071d979e8cc6ad136205cc98'} from 'ACTIONS_MODULE5'\nexport {sendVerificationSubmittedEmail as '70f58c5ba46ef02b620d7dc87bae8fc83f6d480755'} from 'ACTIONS_MODULE6'\nexport {sendEmail as '40f8c061cf84f884e77af3425bc24b8a8d72f598fb'} from 'ACTIONS_MODULE7'\nexport {handleComplaintWebhook as '6045f8436f9cdfdadb7bfe3955677adfc5f4102de0'} from 'ACTIONS_MODULE7'\nexport {handleBounceWebhook as '78a8ea4f1cfa571a366adccf36ac04b1c85d61ae2b'} from 'ACTIONS_MODULE7'\nexport {runHealthCheckForAllDomains as '00c53a1f02416c3261983f8096f19a3450bfd51775'} from 'ACTIONS_MODULE8'\nexport {getDomainHealth as '400b8fb96146bfd004a3166563a5ab5536bb610c70'} from 'ACTIONS_MODULE8'\nexport {recordDeliveryEvent as '404d6f2891af89c71d5bde33d110a216bdd3ee4729'} from 'ACTIONS_MODULE8'\nexport {getCompanyDomainsHealth as '405c57a8fed352b8679525b56014eb8c49105c850c'} from 'ACTIONS_MODULE8'\nexport {processResendWebhookEvent as '40ad037af6f6ab1a3004746d3a1b65afa65527002d'} from 'ACTIONS_MODULE8'\nexport {generateDeliverabilityReport as '40ecf2c792e84ef4b898fda98ec27277b4a9dddef2'} from 'ACTIONS_MODULE8'\nexport {resetHourlyCounters as '004cdde5e6ae8991bab4ba61ae40647c2b823200ba'} from 'ACTIONS_MODULE9'\nexport {resetDailyCounters as '006acf41615a2f7795c47b6d7a3016e18300f2ad17'} from 'ACTIONS_MODULE9'\nexport {incrementEmailCounter as '4029b163c1c0acfd806352a72fe8030c8ae4f7f8ac'} from 'ACTIONS_MODULE9'\nexport {getCompanyActiveDomain as '407a5a7d0a7dd7989a963eb2485a3527c1dcb20a70'} from 'ACTIONS_MODULE9'\nexport {checkRateLimit as '40af86a915f04df8d7cc189fe26e45e0cc24663080'} from 'ACTIONS_MODULE9'\nexport {isGmailIntegrationEnabled as '00fe74bdf14126b5ad89e9480e82978d6357f356b3'} from 'ACTIONS_MODULE10'\nexport {getUserGmailTokens as '400ce95360aaffa14a99dfdf969ba5166c69a59eb6'} from 'ACTIONS_MODULE10'\nexport {disconnectCompanyGmail as '401d3d830065dd7c4777fad67f642392f48735c4ab'} from 'ACTIONS_MODULE10'\nexport {disconnectUserGmail as '404575d602ef4c60c0058b592b8c3e42fbcd13fc4c'} from 'ACTIONS_MODULE10'\nexport {getCompanyEmailProvider as '40787b1598849126560f9f0b0f8fe8967338c7bf28'} from 'ACTIONS_MODULE10'\nexport {getCompanyGmailTokens as '40beeb56302a20d27cd8ba7a0988310f855633d7e6'} from 'ACTIONS_MODULE10'\nexport {refreshUserGmailToken as '602fab67313b110e6ccb66e54b1e16450b2a772cc7'} from 'ACTIONS_MODULE10'\nexport {sendCompanyGmailEmail as '60302947fc4caffa53a719728f3c2cebace926098c'} from 'ACTIONS_MODULE10'\nexport {syncUserInbox as '603643b13bf288cc628303bb4d12df0311b11434c7'} from 'ACTIONS_MODULE10'\nexport {checkCompanyGmailHealth as '60856182db5eaec7f85eda2a5a94c5d7d3524325d6'} from 'ACTIONS_MODULE10'\nexport {refreshCompanyGmailToken as '60eeb51685ac265a4ad793a230a515fe6e462f16f4'} from 'ACTIONS_MODULE10'\nexport {fetchUserInbox as '708daa303e36e37247e22b5b828b6aad8c73ac283b'} from 'ACTIONS_MODULE10'\nexport {setCompanyEmailProvider as '70dd3bc4222a87350dc137fa9cbcb849fa1913b397'} from 'ACTIONS_MODULE10'\nexport {storeGmailMessage as '78d41ef818e75fef94d65a87ea1f0faf418132e3c5'} from 'ACTIONS_MODULE10'\nexport {storeUserGmailTokens as '7e3a356960ddd52a3fa4dc6d981ae7202a59eb9a3d'} from 'ACTIONS_MODULE10'\nexport {storeCompanyGmailTokens as '7f06df826c4fff42950e712c0f548254e275be2a52'} from 'ACTIONS_MODULE10'\nexport {getProviderHealthDashboard as '00a122f9d5fe3a1603c636c3a251886129b66154f8'} from 'ACTIONS_MODULE11'\nexport {checkProviderAlert as '40c7885bdc4fe4cdd5f57e78579230c58088adbef4'} from 'ACTIONS_MODULE11'\nexport {cleanupOldEvents as '40d3c4ceeaee653aa257a28ed429a7fd272fa9fb66'} from 'ACTIONS_MODULE11'\nexport {recordProviderEvent as '40e06418f4b93b40c84a25511e0468e1e8a41ddecf'} from 'ACTIONS_MODULE11'\nexport {getProviderStats as '60c643a41ce1a8e6cc8338da6e2f3678c386910460'} from 'ACTIONS_MODULE11'\nexport {recordSendFailure as '78255c3fa8c9facf7c3f353202f2907836e8eb5539'} from 'ACTIONS_MODULE11'\nexport {recordSendSuccess as '783861d25688b32ba086bbe9e45444975c36a1b285'} from 'ACTIONS_MODULE11'\nexport {recordFallbackTriggered as '78766431b437b16f7cb00b4d64a2f3be5e092ed724'} from 'ACTIONS_MODULE11'\nexport {deleteNotification as '40fab1894acc5e3d1fdd8d8c6128a7cecee06e7e6a'} from 'ACTIONS_MODULE12'\nexport {markAllAsRead as '00cf212b0097820096122537beac12e3403b97d564'} from 'ACTIONS_MODULE12'\nexport {markAsRead as '4094cf679b4a10ca0f969f4fc1b55602aac4e0fbc3'} from 'ACTIONS_MODULE12'\nexport {makeCall as '40b2df540ec465c5dc19545c96486485bb50b5633b'} from 'ACTIONS_MODULE2'\nexport {getWebRTCCredentials as '000478fbf5363dae5000d525663da13e29908cb952'} from 'ACTIONS_MODULE2'\nexport {signOut as '0043ae510c3322ea499beb9e1bb77d06afb4ef19bd'} from 'ACTIONS_MODULE13'\nexport {switchCompany as '4097c3c574342661f9a3c8244961d001234449f36f'} from 'ACTIONS_MODULE14'\nexport {updateUserStatus as '4081009dd4dff14ff4ece62648bad23a83f2f9f63c'} from 'ACTIONS_MODULE15'\nexport {getTotalUnreadCountAction as '00ebc03a4ffc993aea7ec2e541686105c2bace2437'} from 'ACTIONS_MODULE16'\nexport {getCompanyPendingActions as '40e9589cb639f2902eb841bedc1247d966486d6fd7'} from 'ACTIONS_MODULE17'\nexport {checkIsCompanyOwner as '001be5cf82b793f19f6a7d010c91c14577fa7a130d'} from 'ACTIONS_MODULE17'\nexport {getCustomerByPhone as '6013add076e3eaed7dc37e8b800ce977d5abb8d49a'} from 'ACTIONS_MODULE18'\nexport {startCallRecording as '404e47931374ad2a1b54bc11f357703790f6104530'} from 'ACTIONS_MODULE2'\nexport {stopCallRecording as '40d5cc291162e2fd61245bdb851d5e8ed609e4ed19'} from 'ACTIONS_MODULE2'\nexport {deleteCustomer as '4082b52123c24a95685a53c36313418a95c259c65b'} from 'ACTIONS_MODULE18'\nexport {searchCustomers as '60193685409a9d118f1b364e14ecf57d05fa5638a9'} from 'ACTIONS_MODULE18'\nexport {getCustomersForDialer as '0077abd0cb1e555f91adaa482ad0b2f565bbd0629a'} from 'ACTIONS_MODULE18'\nexport {getPendingSupportSessions as '000f90f949d6a2f5484d061d5a738a59a8c846aeaa'} from 'ACTIONS_MODULE19'\nexport {getActiveSupportSessions as '00665c1bbcd52d612d5bb4bf3be5e7fc75554132e6'} from 'ACTIONS_MODULE19'\nexport {approveSupportSessionRequest as '602e89ae7ace85fc30cd3b4b1dd865d517c0cb1cd5'} from 'ACTIONS_MODULE19'\nexport {rejectSupportSessionRequest as '60886af124323873afd4d5b64bb4143abbcba2c154'} from 'ACTIONS_MODULE19'\nexport {endActiveSupportSession as '40369e8ea4eced7bdaef8203d369469ee7b630db8c'} from 'ACTIONS_MODULE19'\nexport {createEmailFolderAction as '408d3694fd0dd48e424f53c9bf5083b946ab3ec990'} from 'ACTIONS_MODULE20'\nexport {getEmailFolderCountsAction as '009e962eae57bf128b2023081fd7259048edd8884a'} from 'ACTIONS_MODULE16'\nexport {getEmailFoldersAction as '00235a0ba91f1ba226f33fa40dcf4c93a2c3548c70'} from 'ACTIONS_MODULE20'\nexport {deleteEmailFolderAction as '40c55f8e0922f2c7fd8d502e4c75395bf5f0470430'} from 'ACTIONS_MODULE20'\nexport {searchVendors as '404a3266e0319dbd8c24fec80bb69ecfe029d2a768'} from 'ACTIONS_MODULE21'\nexport {getSmsFolderCountsAction as '0006f7bd89b72f0836ec7bf4db73019f1b32e6c24a'} from 'ACTIONS_MODULE22'\nexport {getTeamChannelMessagesAction as '407cdb4f27b0a3c9f049dfd3b6d0861b01b26a0e85'} from 'ACTIONS_MODULE23'\nexport {sendTeamChannelMessageAction as '40d31525c81948d6fd1432186542094856234a3c66'} from 'ACTIONS_MODULE23'\nexport {markTeamChannelAsReadAction as '40581e668b6daea6cb7c47a00911750a07df65b573'} from 'ACTIONS_MODULE23'\nexport {getSmsAction as '401da60f1a9391a303a1b16907796e4c0f50d69f2e'} from 'ACTIONS_MODULE22'\nexport {getSmsByIdAction as '4044b52e9024b2d9706a0fecdc03f2b79b2581d95f'} from 'ACTIONS_MODULE22'\nexport {markSmsAsReadAction as '40b400ebd66fa044553037f011b7b9f79ac7991a54'} from 'ACTIONS_MODULE22'\nexport {markSmsConversationAsReadAction as '40955555a6fefc5cd6fcbb13dbbda08c03e7c12997'} from 'ACTIONS_MODULE22'\nexport {getSmsConversationAction as '40641943d0d58e4efdbd5a78b4dee1f49227c7ed47'} from 'ACTIONS_MODULE22'\nexport {uploadSmsAttachments as '404c132f24569b4f654af19a6a5cb46969dc24f12a'} from 'ACTIONS_MODULE22'\nexport {getCompanyContextAction as '00ac96dc81c57c5c0b6ef948993077a34552967467'} from 'ACTIONS_MODULE22'\n"],"names":[],"mappings":"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"}