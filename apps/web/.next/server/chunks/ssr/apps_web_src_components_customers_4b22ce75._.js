module.exports=[802763,a=>{"use strict";var b=a.i(861467),c=a.i(565308),d=a.i(789815),e=a.i(898062),f=a.i(101482),g=a.i(145679);a.i(288007);var h=a.i(986990);a.i(445255);var i=a.i(18170),j=a.i(425809),k=a.i(700760);let l=[{id:"active",name:"Active",accentColor:"#22C55E"},{id:"prospect",name:"Prospect",accentColor:"#3B82F6"},{id:"inactive",name:"Inactive",accentColor:"#6B7280"}],m=new Map(l.map(a=>[a.id,a.name])),n=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function o({customers:a}){return(0,b.jsx)(j.EntityKanban,{calculateColumnMeta:(a,b)=>{let c=b.filter(b=>b.columnId===a),d=c.reduce((a,b)=>a+b.entity.totalValue,0);return{count:c.length,total:d}},columns:l,data:a,entityName:"customers",formatTotal:a=>n.format(a/100),mapToKanbanItem:a=>({id:a.id,columnId:a.status,entity:a,customer:a}),renderCard:a=>(0,b.jsx)(p,{item:{...a,customer:a.entity}}),renderDragOverlay:a=>(0,b.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg",children:(0,b.jsx)(p,{item:{...a,customer:a.entity}})}),showTotals:!0,updateEntityStatus:(a,b)=>({...a,status:b})})}function p({item:a}){let{customer:j,columnId:l}=a;return(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("h3",{className:"text-foreground text-sm font-semibold",children:j.name}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:j.contact}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)(h.Badge,{className:(0,k.cn)("text-xs","active"===l&&"bg-primary/10 text-primary","prospect"===l&&"bg-primary/10 text-primary"),variant:"active"===l?"secondary":"outline",children:m.get(l)??l}),j.totalValue>0&&(0,b.jsx)(h.Badge,{className:"bg-muted/60 text-muted-foreground",variant:"outline",children:n.format(j.totalValue/100)})]})]})}),(0,b.jsxs)("div",{className:"text-muted-foreground space-y-2 text-xs",children:[j.email&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(d.Mail,{className:"text-primary size-4"}),(0,b.jsx)("span",{className:"truncate",children:j.email})]}),j.phone&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Phone,{className:"text-primary size-4"}),(0,b.jsx)("span",{children:j.phone})]}),j.address&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(f.Users,{className:"text-primary size-4"}),(0,b.jsx)("span",{className:"truncate",children:[j.address,j.city,j.state].filter(Boolean).join(", ")})]})]}),(0,b.jsxs)("div",{className:"text-muted-foreground flex items-center justify-between pt-2 text-xs",children:[(0,b.jsx)("span",{children:"None"!==j.lastService?`Last: ${j.lastService}`:"No services"}),(0,b.jsx)(i.Button,{asChild:!0,className:"text-primary gap-1 text-xs",size:"sm",variant:"ghost",children:(0,b.jsxs)(g.default,{href:`/dashboard/customers/${j.id}`,children:["View",(0,b.jsx)(c.ArrowUpRight,{className:"size-3.5"})]})})]})]})}a.s(["CustomersKanban",()=>o])},550490,a=>{"use strict";var b=a.i(861467),c=a.i(452168),d=a.i(789815),e=a.i(898062),f=a.i(339632),g=a.i(101482),h=a.i(145679),i=a.i(337241),j=a.i(156916),k=a.i(169021),l=(0,k.createServerReference)("40d50ee235579ecdb3668988207cec81de072ea844",k.callServer,void 0,k.findSourceMapURL,"deleteCustomer");a.i(516775);var m=a.i(560272);a.i(445255);var n=a.i(18170),o=a.i(380340);a.i(696137);var p=a.i(736096);a.i(525756),a.i(854729);var q=a.i(493667),r=a.i(792268),s=a.i(985214),t=a.i(858707),u=a.i(563432);function v({customers:a,itemsPerPage:k=50,totalCount:v,currentPage:w=1,onCustomerClick:x,enableVirtualization:y="auto",showRefresh:z=!1}){let A=(0,i.useRouter)(),B=(0,u.useArchiveStore)(a=>a.filters.customers),C=a.filter(a=>{let b=!!(a.archived_at||a.deleted_at);return"active"===B?!b:"archived"!==B||b}),D=[{key:"customer",header:"Customer",width:"flex-1",sortable:!0,render:a=>(0,b.jsxs)(h.default,{className:"flex items-center gap-3",href:`/dashboard/customers/${a.id}`,onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(m.Avatar,{className:"h-8 w-8",children:(0,b.jsx)(m.AvatarFallback,{className:"text-xs",children:a.name.split(" ").map(a=>a[0]).join("").slice(0,2).toUpperCase()})}),(0,b.jsxs)("div",{className:"min-w-0",children:[(0,b.jsx)("div",{className:"text-foreground truncate font-medium leading-tight hover:underline",children:a.name}),(0,b.jsx)("div",{className:"text-muted-foreground mt-0.5 truncate text-xs leading-tight",children:a.contact})]})]})},{key:"contact",header:"Contact",width:"w-56",shrink:!0,sortable:!0,hideOnMobile:!0,hideable:!0,render:a=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"text-foreground flex items-center gap-1.5",children:[(0,b.jsx)(d.Mail,{className:"text-muted-foreground h-3 w-3"}),(0,b.jsx)("span",{className:"truncate text-xs",children:a.email})]}),(0,b.jsxs)("div",{className:"text-foreground flex items-center gap-1.5",children:[(0,b.jsx)(e.Phone,{className:"text-muted-foreground h-3 w-3"}),(0,b.jsx)("span",{className:"text-xs tabular-nums",children:a.phone})]})]})},{key:"address",header:"Address",width:"w-56",shrink:!0,hideOnMobile:!0,hideable:!0,render:a=>a.address||a.city||a.state?(0,b.jsxs)("div",{className:"space-y-1",children:[a.address&&(0,b.jsx)("div",{className:"text-foreground truncate text-xs",children:a.address}),(a.city||a.state||a.zipCode)&&(0,b.jsx)("div",{className:"text-muted-foreground truncate text-xs",children:[a.city,a.state,a.zipCode].filter(Boolean).join(", ")})]}):(0,b.jsx)("span",{className:"text-muted-foreground text-xs italic",children:"No address"})},function(a,c,d,e={}){return{key:a,header:c,width:e.width||"w-28",sortable:e.sortable??!0,hideOnMobile:e.hideOnMobile??!1,render:a=>{let c=d(a);return c?(0,b.jsx)(q.CustomerStatusBadge,{status:c}):(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"â€”"})}}}("status","Status",a=>a.status,{width:"w-28"}),{key:"service",header:"Service",sortable:!0,width:"w-48",shrink:!0,hideOnMobile:!0,hideable:!0,render:a=>(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsxs)("div",{className:"text-foreground text-xs",children:["Last:"," ",(0,b.jsx)("span",{className:"text-muted-foreground",children:a.lastService})]}),(0,b.jsxs)("div",{className:"text-foreground text-xs",children:["Next:"," ",(0,b.jsx)("span",{className:"text-muted-foreground",children:a.nextService})]})]})},{key:"value",header:"Total Value",width:"w-32",shrink:!0,align:"right",render:a=>(0,b.jsx)("span",{className:"text-xs font-semibold tabular-nums",children:(0,r.formatCurrencyFromDollars)(a.totalValue)})},{key:"actions",header:"",width:"w-10",shrink:!0,render:a=>(0,b.jsx)(p.RowActionsDropdown,{actions:[{label:"View Details",icon:g.Users,href:`/dashboard/customers/${a.id}`},{label:"Send Email",icon:d.Mail,href:`mailto:${a.email}`},{label:"Call Customer",icon:e.Phone,href:`tel:${a.phone}`},{label:"Delete Customer",icon:f.Trash2,variant:"destructive",separatorBefore:!0,onClick:async()=>{let b=await l(a.id);b.success?(j.toast.success("Customer deleted"),window.location.reload()):j.toast.error(b.error||"Failed to delete customer")}}]})}],E=[{label:"Export",icon:(0,b.jsx)(c.Archive,{className:"h-4 w-4"}),onClick:b=>{let c=new Blob([["Name,Contact,Email,Phone,Status,Total Value",...a.filter(a=>b.has(a.id)).map(a=>[a.name,a.contact,a.email,a.phone,a.status,a.totalValue].join(","))].join("\n")],{type:"text/csv"}),d=URL.createObjectURL(c),e=document.createElement("a");e.href=d,e.download=`customers-export-${new Date().toISOString().split("T")[0]}.csv`,e.click(),URL.revokeObjectURL(d),j.toast.success(`Exported ${b.size} customer${b.size>1?"s":""}`)}},{label:"Delete",icon:(0,b.jsx)(f.Trash2,{className:"h-4 w-4"}),onClick:async a=>{let b=0,c=0;for(let d of a){let a=await l(d);a.success?b++:(c++,console.error(`Failed to delete customer ${d}:`,a.error))}b>0&&j.toast.success(`Deleted ${b} customer${b>1?"s":""}`),c>0&&j.toast.error(`Failed to delete ${c} customer${c>1?"s":""}`),window.location.reload()},variant:"destructive"}];return(0,b.jsx)(o.FullWidthDataTable,{...t.TablePresets.fullList({entity:"customers",enableSelection:!0,searchPlaceholder:"Search customers by name, email, phone, address, or status...",itemsPerPage:k,showRefresh:z}),data:C,columns:D,getItemId:a=>a.id,bulkActions:E,searchFilter:(a,b)=>{let c=b.toLowerCase();return a.name.toLowerCase().includes(c)||a.contact.toLowerCase().includes(c)||a.email.toLowerCase().includes(c)||a.phone.toLowerCase().includes(c)||a.status.toLowerCase().includes(c)||(a.address?.toLowerCase().includes(c)??!1)||(a.city?.toLowerCase().includes(c)??!1)||(a.state?.toLowerCase().includes(c)??!1)||(a.zipCode?.toLowerCase().includes(c)??!1)},onRowClick:a=>{x?x(a):window.location.href=`/dashboard/customers/${a.id}`},totalCount:v??C.length,currentPageFromServer:w,serverPagination:!0,onRefresh:()=>A.refresh(),emptyMessage:"No customers found",emptyIcon:(0,b.jsx)(g.Users,{className:"text-muted-foreground h-8 w-8"}),emptyAction:(0,b.jsxs)(n.Button,{onClick:()=>window.location.href="/dashboard/customers/new",size:"sm",children:[(0,b.jsx)(g.Users,{className:"mr-2 size-4"}),"Add Customer"]}),isArchived:a=>!!(a.archived_at||a.deleted_at),showArchived:"active"!==B,isHighlighted:a=>{let{isHighlighted:b,highlightClass:c}=(0,s.getRowHighlight)(a);return!c.includes("bg-success")&&b},getHighlightClass:a=>(0,s.getRowHighlight)(a).highlightClass,enableVirtualization:y})}a.s(["CustomersTable",()=>v],550490)}];

//# sourceMappingURL=apps_web_src_components_customers_4b22ce75._.js.map