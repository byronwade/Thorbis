module.exports=[729382,a=>{"use strict";let b=(0,a.i(203431).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["default",()=>b])},232553,a=>{"use strict";var b=a.i(729382);a.s(["Save",()=>b.default])},256564,a=>{"use strict";a.s([])},120939,835218,443847,a=>{"use strict";var b=a.i(861467),c=a.i(638446),d=a.i(352770),e=a.i(198803),f=a.i(232553),g=a.i(337241);a.i(288007);var h=a.i(986990);a.i(445255);var i=a.i(18170);a.i(928414);var j=a.i(745250);function k({title:a,description:k,helpText:l,hasChanges:m=!1,isPending:n=!1,isLoading:o=!1,onSave:p,onCancel:q,saveButtonText:r="Save Settings",children:s}){let t=(0,g.useRouter)();return o?(0,b.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,b.jsx)(e.Loader2,{className:"text-muted-foreground size-8 animate-spin"})}):(0,b.jsxs)("div",{className:"space-y-8 py-8",children:[(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:a}),l&&(0,b.jsxs)(j.Tooltip,{children:[(0,b.jsx)(j.TooltipTrigger,{asChild:!0,children:(0,b.jsx)("button",{className:"flex-shrink-0",type:"button",children:(0,b.jsx)(d.HelpCircle,{className:"text-muted-foreground h-3.5 w-3.5"})})}),(0,b.jsx)(j.TooltipContent,{className:"max-w-xs",children:(0,b.jsx)("p",{className:"text-sm",children:l})})]})]}),m&&(0,b.jsx)(h.Badge,{className:"bg-warning hover:bg-warning",children:"Unsaved Changes"})]}),(0,b.jsx)("p",{className:"text-muted-foreground text-lg",children:k})]}),(0,b.jsx)("div",{className:"space-y-6",children:s}),(0,b.jsx)("div",{className:"bg-card sticky bottom-0 z-10 rounded-xl border p-6 shadow-lg",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"flex items-center gap-3",children:m?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"bg-warning dark:bg-warning/30 flex h-8 w-8 items-center justify-center rounded-full",children:(0,b.jsx)("div",{className:"bg-warning h-2 w-2 animate-pulse rounded-full"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Unsaved Changes"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Save your changes or discard them"})]})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("div",{className:"bg-success dark:bg-success/30 flex h-8 w-8 items-center justify-center rounded-full",children:(0,b.jsx)(c.Check,{className:"text-success dark:text-success h-4 w-4"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"All Changes Saved"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Your settings are up to date"})]})]})}),(0,b.jsxs)("div",{className:"flex gap-3",children:[(0,b.jsx)(i.Button,{disabled:n,onClick:q||(()=>t.refresh()),type:"button",variant:"outline",children:"Cancel"}),(0,b.jsx)(i.Button,{disabled:n||!m,onClick:p,type:"button",children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(e.Loader2,{className:"mr-2 size-4 animate-spin"}),"Saving..."]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(f.Save,{className:"mr-2 size-4"}),r]})})]})]})})]})}a.i(380934),a.i(347421),a.s(["SettingsPageLayout",()=>k],120939),a.i(156120),a.s([],835218);var l=a.i(783281),m=a.i(251048);function n({getter:a,setter:b,initialState:c,settingsName:d,transformLoad:e,transformSave:f,prefetchedData:g}){let{toast:h}=(0,m.useToast)(),[i,j]=(0,l.useTransition)(),k=(0,l.useRef)(!!g),n=(0,l.useRef)({...c,...g??{}}),[o,p]=(0,l.useState)(n.current),[q,r]=(0,l.useState)(n.current),[s,t]=(0,l.useState)(!g),[u,v]=(0,l.useState)(!1);async function w(){t(!0);try{let b=await a();if(b.success&&b.data){let a=e?e(b.data):b.data,d={...c,...a};p(d),r(d),v(!1)}}catch(a){h.error(`Failed to load ${d} settings`)}finally{t(!1)}}(0,l.useEffect)(()=>{if(k.current){k.current=!1;return}w()},[w]);let x=async a=>{j(async()=>{try{let c=a||(f?f(o):new FormData),e=await b(c);e.success?(r(o),v(!1),h.success(`${d.charAt(0).toUpperCase()+d.slice(1)} settings saved successfully`)):h.error(e.error||`Failed to save ${d} settings`)}catch(a){h.error(`An unexpected error occurred while saving ${d} settings`)}})};return{settings:o,isLoading:s,isPending:i,hasUnsavedChanges:u,updateSetting:(a,b)=>{p(c=>({...c,[a]:b})),v(!0)},updateSettings:a=>{p(b=>({...b,...a})),v(!0)},saveSettings:x,reset:()=>{p(q),v(!1)},reload:async()=>{await w()}}}a.s(["useSettings",()=>n],443847)},656308,a=>{"use strict";var b=a.i(861467),c=a.i(916680),d=a.i(352770),e=a.i(898062),f=a.i(127634),g=a.i(145679),h=a.i(783281);a.i(256564);var i=a.i(169021),j=(0,i.createServerReference)("001e268d704c80f5b89fb479dd6938d6e80fdd51dc",i.callServer,void 0,i.findSourceMapURL,"getSmsSettings"),k=(0,i.createServerReference)("40703142390e16b4c8335ffe2f874a170ff11db169",i.callServer,void 0,i.findSourceMapURL,"updateSmsSettings"),l=a.i(120939);a.i(835218);var m=a.i(733621);a.i(445255);var n=a.i(18170);a.i(380934);var o=a.i(347421);a.i(839984);var p=a.i(372712);a.i(458393);var q=a.i(82012);a.i(146697);var r=a.i(778737),s=a.i(382281);a.i(650756);var t=a.i(560450);a.i(897346);var u=a.i(75892);a.i(928414);var v=a.i(745250),w=a.i(443847);let x={provider:"telnyx",providerApiKey:"",senderNumber:"",autoReplyEnabled:!1,autoReplyMessage:"",optOutMessage:"Reply STOP to unsubscribe",includeOptOut:!0,consentRequired:!0};a.s(["default",0,function({initialSettings:a}){let{settings:i,isLoading:y,isPending:z,hasUnsavedChanges:A,updateSetting:B,saveSettings:C,reload:D}=(0,w.useSettings)({getter:j,setter:k,initialState:x,settingsName:"sms",prefetchedData:a??void 0,transformLoad:a=>a?{provider:a.provider??"telnyx",senderNumber:a.sender_number??"",autoReplyEnabled:a.auto_reply_enabled??!1,autoReplyMessage:a.auto_reply_message??"",optOutMessage:a.opt_out_message??"Reply STOP to unsubscribe",includeOptOut:a.include_opt_out??!0,consentRequired:a.consent_required??!0}:{},transformSave:a=>{let b=new FormData;return b.append("provider",a.provider),b.append("providerApiKey",a.providerApiKey),b.append("senderNumber",a.senderNumber),b.append("autoReplyEnabled",a.autoReplyEnabled.toString()),b.append("autoReplyMessage",a.autoReplyMessage),b.append("optOutMessage",a.optOutMessage),b.append("includeOptOut",a.includeOptOut.toString()),b.append("consentRequired",a.consentRequired.toString()),b}}),E=(0,h.useCallback)(()=>{C()},[C]),F=(0,h.useCallback)(()=>{D()},[D]);return(0,b.jsx)(v.TooltipProvider,{children:(0,b.jsxs)(l.SettingsPageLayout,{description:"Configure SMS sending numbers, auto-responses, and compliance defaults.",hasChanges:A,helpText:"Applies to all outbound text messages and automation.",isLoading:y,isPending:z,onCancel:F,onSave:E,saveButtonText:"Save SMS settings",title:"SMS & Text",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,b.jsx)(m.Breadcrumb,{children:(0,b.jsxs)(m.BreadcrumbList,{children:[(0,b.jsx)(m.BreadcrumbItem,{children:(0,b.jsx)(m.BreadcrumbLink,{asChild:!0,children:(0,b.jsx)(g.default,{href:"/dashboard/settings",children:"Settings"})})}),(0,b.jsx)(m.BreadcrumbSeparator,{}),(0,b.jsx)(m.BreadcrumbItem,{children:(0,b.jsx)(m.BreadcrumbLink,{asChild:!0,children:(0,b.jsx)(g.default,{href:"/dashboard/settings/communications",children:"Communications"})})}),(0,b.jsx)(m.BreadcrumbSeparator,{}),(0,b.jsx)(m.BreadcrumbItem,{children:(0,b.jsx)(m.BreadcrumbPage,{children:"SMS"})})]})}),(0,b.jsx)(n.Button,{asChild:!0,variant:"ghost",children:(0,b.jsxs)(g.default,{href:"/dashboard/settings/communications",children:[(0,b.jsx)(f.Settings,{className:"mr-2 size-4"}),"Back to communications"]})})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsxs)(o.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(e.Phone,{className:"size-4"}),"Sender Identity"]}),(0,b.jsx)(o.CardDescription,{children:"Number and name customers see"})]}),(0,b.jsx)(o.CardContent,{className:"space-y-4",children:(0,b.jsxs)(s.StandardFormRow,{cols:2,children:[(0,b.jsxs)(s.StandardFormField,{label:"SMS phone number",htmlFor:"sms-phone",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsxs)(v.Tooltip,{children:[(0,b.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(d.HelpCircle,{className:"text-muted-foreground size-3"})}),(0,b.jsx)(v.TooltipContent,{children:"Provisioned number used to send all texts."})]}),(0,b.jsx)("span",{className:"text-sm text-muted-foreground",children:"Provisioned number used to send all texts"})]}),(0,b.jsx)(p.Input,{id:"sms-phone",onChange:a=>B("senderNumber",a.target.value),placeholder:"(555) 123-4567",type:"tel",value:i.senderNumber}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Must match an active Telnyx or Twilio number."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)(s.StandardFormField,{label:"Provider",htmlFor:"sms-provider",children:(0,b.jsxs)("select",{id:"sms-provider",className:"border-input bg-background block w-full rounded-md border px-3 py-2 text-sm",onChange:a=>B("provider",a.target.value),value:i.provider,children:[(0,b.jsx)("option",{value:"telnyx",children:"Telnyx"}),(0,b.jsx)("option",{value:"twilio",children:"Twilio"}),(0,b.jsx)("option",{value:"other",children:"Other"})]})}),(0,b.jsxs)(s.StandardFormField,{label:"Provider API Key",htmlFor:"sms-api-key",children:[(0,b.jsx)(p.Input,{id:"sms-api-key",onChange:a=>B("providerApiKey",a.target.value),placeholder:"Provider API key",type:"password",value:i.providerApiKey}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Stored securely; leave blank to keep existing."})]})]})]})})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsx)(o.CardTitle,{children:"Auto-response"}),(0,b.jsx)(o.CardDescription,{children:"Automatically reply when a customer texts you"})]}),(0,b.jsxs)(o.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Enable auto-response"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Sends an immediate acknowledgment outside business hours."})]}),(0,b.jsx)(t.Switch,{checked:i.autoReplyEnabled,onCheckedChange:a=>B("autoReplyEnabled",a)})]}),i.autoReplyEnabled&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r.Separator,{}),(0,b.jsxs)(s.StandardFormField,{label:"Auto-response message",htmlFor:"auto-response-msg",children:[(0,b.jsx)(u.Textarea,{id:"auto-response-msg",className:"min-h-[120px] resize-none",onChange:a=>B("autoReplyMessage",a.target.value),placeholder:"Thanks for texting! We'll respond during business hours.",value:i.autoReplyMessage}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Sent once per conversation when an incoming SMS is received."})]})]})]})]}),(0,b.jsxs)(o.Card,{children:[(0,b.jsxs)(o.CardHeader,{children:[(0,b.jsx)(o.CardTitle,{children:"Compliance"}),(0,b.jsx)(o.CardDescription,{children:"Required messaging disclosures and consent tracking"})]}),(0,b.jsxs)(o.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(q.Label,{className:"flex items-center gap-2 text-sm font-medium",children:["Include opt-out instructions",(0,b.jsxs)(v.Tooltip,{children:[(0,b.jsx)(v.TooltipTrigger,{asChild:!0,children:(0,b.jsx)(d.HelpCircle,{className:"text-muted-foreground size-3"})}),(0,b.jsx)(v.TooltipContent,{children:"Automatically append “Reply STOP to unsubscribe”."})]})]}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Required for promotional messaging in most regions."})]}),(0,b.jsx)(t.Switch,{checked:i.includeOptOut,onCheckedChange:a=>B("includeOptOut",a)})]}),(0,b.jsx)(r.Separator,{}),(0,b.jsxs)(s.StandardFormField,{label:"Opt-out message",htmlFor:"opt-out-msg",children:[(0,b.jsx)(u.Textarea,{id:"opt-out-msg",className:"min-h-[80px] resize-none",onChange:a=>B("optOutMessage",a.target.value),value:i.optOutMessage}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Displayed after any outgoing SMS when opt-out instructions are enabled."})]}),(0,b.jsx)(r.Separator,{}),(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Consent required"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Only send messages to contacts with documented consent."})]}),(0,b.jsx)(t.Switch,{checked:i.consentRequired,onCheckedChange:a=>B("consentRequired",a)})]})]})]}),(0,b.jsx)(o.Card,{className:"border-warning/40 bg-warning/5",children:(0,b.jsxs)(o.CardContent,{className:"flex items-start gap-3 pt-6",children:[(0,b.jsx)(c.AlertTriangle,{className:"text-warning size-5"}),(0,b.jsxs)("div",{className:"space-y-1",children:[(0,b.jsx)("p",{className:"text-warning text-sm font-semibold",children:"Compliance reminder"}),(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"Follow TCPA/CTIA guidelines: honor STOP requests immediately, keep quiet hours, and collect explicit consent before sending marketing texts. Configure opt-outs and consent policies here so Thorbis can enforce them automatically."})]})]})})]})})}],656308)}];

//# sourceMappingURL=_cd67dc4e._.js.map