{"version":3,"sources":["../../../../../../apps/web/src/app/%28dashboard%29/dashboard/settings/communications/phone/phone-settings-client.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/app/%28dashboard%29/dashboard/settings/communications/phone/page.tsx","../../../../../../apps/web/src/components/settings/phone/phone-data.tsx","../../../../../../apps/web/src/app/%28dashboard%29/dashboard/settings/communications/phone/phone-config.ts","../../../../../../apps/web/src/components/settings/phone/phone-skeleton.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/apps/web/src/app/(dashboard)/dashboard/settings/communications/phone/phone-settings-client.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/app/(dashboard)/dashboard/settings/communications/phone/phone-settings-client.tsx\",\n    \"default\",\n);\n","/**\n * Uphone Page - PPR Enabled\n *\n * Uses Partial Prerendering for instant page loads.\n * Performance: 10-20x faster than traditional SSR\n */\n\nimport { Suspense } from \"react\";\nimport { UphoneData } from \"@/components/settings/phone/phone-data\";\nimport { UphoneSkeleton } from \"@/components/settings/phone/phone-skeleton\";\n\nexport default function UphonePage() {\n\treturn (\n\t\t<Suspense fallback={<UphoneSkeleton />}>\n\t\t\t<UphoneData />\n\t\t</Suspense>\n\t);\n}\n","import { notFound } from \"next/navigation\";\nimport {\n\tDEFAULT_PHONE_SETTINGS,\n\tmapPhoneSettings,\n} from \"@/app/(dashboard)/dashboard/settings/communications/phone/phone-config\";\nimport PhoneSettingsClient from \"@/app/(dashboard)/dashboard/settings/communications/phone/phone-settings-client\";\nimport { getActiveCompanyId } from \"@/lib/auth/company-context\";\nimport { createClient } from \"@/lib/supabase/server\";\n\nexport async function UphoneData() {\n\tconst supabase = await createClient();\n\tif (!supabase) {\n\t\treturn notFound();\n\t}\n\n\tconst {\n\t\tdata: { user },\n\t} = await supabase.auth.getUser();\n\tif (!user) {\n\t\treturn notFound();\n\t}\n\n\tconst activeCompanyId = await getActiveCompanyId();\n\tif (!activeCompanyId) {\n\t\treturn notFound();\n\t}\n\n\tconst { data, error } = await supabase\n\t\t.from(\"communication_phone_settings\")\n\t\t.select(\"*\")\n\t\t.eq(\"company_id\", activeCompanyId)\n\t\t.maybeSingle();\n\n\tif (error) {\n\t\tconsole.error(\"Failed to load phone settings\", error);\n\t}\n\n\tconst initialSettings = {\n\t\t...DEFAULT_PHONE_SETTINGS,\n\t\t...mapPhoneSettings(data ?? null),\n\t};\n\n\treturn <PhoneSettingsClient initialSettings={initialSettings} />;\n}\n","import type { Database } from \"@/types/supabase\";\n\ntype PhoneSettingsRow =\n\t| Database[\"public\"][\"Tables\"][\"communication_phone_settings\"][\"Row\"]\n\t| null;\n\nexport type PhoneSettingsState = {\n\troutingStrategy: \"round_robin\" | \"skills_based\" | \"priority\" | \"simultaneous\";\n\tfallbackNumber: string;\n\tbusinessHoursOnly: boolean;\n\tvoicemailEnabled: boolean;\n\tvoicemailGreetingUrl: string;\n\tvoicemailEmailNotifications: boolean;\n\tvoicemailTranscriptionEnabled: boolean;\n\trecordingEnabled: boolean;\n\trecordingAnnouncement: string;\n\trecordingConsentRequired: boolean;\n\tivrEnabled: boolean;\n\tivrMenu: string;\n};\n\nexport const DEFAULT_PHONE_SETTINGS: PhoneSettingsState = {\n\troutingStrategy: \"round_robin\",\n\tfallbackNumber: \"\",\n\tbusinessHoursOnly: false,\n\tvoicemailEnabled: true,\n\tvoicemailGreetingUrl: \"\",\n\tvoicemailEmailNotifications: true,\n\tvoicemailTranscriptionEnabled: false,\n\trecordingEnabled: false,\n\trecordingAnnouncement:\n\t\t\"This call may be recorded for quality assurance purposes.\",\n\trecordingConsentRequired: true,\n\tivrEnabled: false,\n\tivrMenu: \"{}\",\n};\n\nexport function mapPhoneSettings(\n\trow: PhoneSettingsRow,\n): Partial<PhoneSettingsState> {\n\tif (!row) {\n\t\treturn {};\n\t}\n\n\treturn {\n\t\troutingStrategy:\n\t\t\t(row.routing_strategy as PhoneSettingsState[\"routingStrategy\"]) ??\n\t\t\t\"round_robin\",\n\t\tfallbackNumber: row.fallback_number ?? \"\",\n\t\tbusinessHoursOnly: row.business_hours_only ?? false,\n\t\tvoicemailEnabled: row.voicemail_enabled ?? true,\n\t\tvoicemailGreetingUrl: row.voicemail_greeting_url ?? \"\",\n\t\tvoicemailEmailNotifications: row.voicemail_email_notifications ?? true,\n\t\tvoicemailTranscriptionEnabled: row.voicemail_transcription_enabled ?? false,\n\t\trecordingEnabled: row.recording_enabled ?? false,\n\t\trecordingAnnouncement:\n\t\t\trow.recording_announcement ||\n\t\t\t\"This call may be recorded for quality assurance purposes.\",\n\t\trecordingConsentRequired: row.recording_consent_required ?? true,\n\t\tivrEnabled: row.ivr_enabled ?? false,\n\t\tivrMenu: row.ivr_menu ? JSON.stringify(row.ivr_menu) : \"{}\",\n\t};\n}\n","export function UphoneSkeleton() {\n\treturn (\n\t\t<div className=\"flex h-full flex-col gap-4 p-4\">\n\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t<div className=\"bg-muted h-8 w-48 animate-pulse rounded\" />\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<div className=\"bg-muted h-8 w-24 animate-pulse rounded\" />\n\t\t\t\t\t<div className=\"bg-muted h-8 w-24 animate-pulse rounded\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"space-y-2\">\n\t\t\t\t{[...new Array(10)].map((_, i) => (\n\t\t\t\t\t<div className=\"flex items-center gap-4\" key={i}>\n\t\t\t\t\t\t<div className=\"bg-muted h-12 w-12 animate-pulse rounded\" />\n\t\t\t\t\t\t<div className=\"flex-1 space-y-2\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-3/4 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-3 w-1/2 animate-pulse rounded\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"bg-muted h-8 w-20 animate-pulse rounded\" />\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}