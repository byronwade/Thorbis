{"version":3,"sources":["../../../../../../apps/web/src/components/work/estimates/estimate-page-content.tsx"],"sourcesContent":["/**\n * Estimate Page Content\n *\n * Comprehensive estimate details with collapsible sections\n * Matches job and customer detail page patterns\n */\n\n\"use client\";\n\nimport {\n\tCalendar,\n\tFileCheck,\n\tFileText,\n\tLink2Off,\n\tPackage,\n\tReceipt,\n\tTrendingUp,\n\tUser,\n} from \"lucide-react\";\nimport Link from \"next/link\";\nimport { useRouter } from \"next/navigation\";\nimport { useMemo, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { updateEntityTags } from \"@/actions/entity-tags\";\nimport { unlinkJobFromEstimate } from \"@/actions/estimates\";\nimport { DetailPageContentLayout } from \"@/components/layout/detail-page-content-layout\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n\tDialog,\n\tDialogContent,\n\tDialogDescription,\n\tDialogFooter,\n\tDialogHeader,\n\tDialogTitle,\n} from \"@/components/ui/dialog\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n\tTable,\n\tTableBody,\n\tTableCell,\n\tTableHead,\n\tTableHeader,\n\tTableRow,\n} from \"@/components/ui/table\";\nimport {\n\tUnifiedAccordionContent,\n\ttype UnifiedAccordionSection,\n} from \"@/components/ui/unified-accordion\";\nimport { WorkflowTimeline } from \"@/components/ui/workflow-timeline\";\nimport { EntityTags } from \"@/components/work/entity-tags\";\nimport { useSectionShortcuts } from \"@/hooks/use-section-shortcuts\";\n\nexport type EstimateData = {\n\testimate: any;\n\tcustomer?: any;\n\tjob?: any;\n\tinvoice?: any;\n\tcontract?: any; // NEW: for workflow timeline\n\tnotes?: any[];\n\tactivities?: any[];\n\tattachments?: any[];\n};\n\nexport type EstimatePageContentProps = {\n\tentityData: EstimateData;\n\tmetrics?: any;\n};\n\nfunction formatCurrency(cents: number | null | undefined): string {\n\tif (cents === null || cents === undefined) {\n\t\treturn \"$0.00\";\n\t}\n\treturn new Intl.NumberFormat(\"en-US\", {\n\t\tstyle: \"currency\",\n\t\tcurrency: \"USD\",\n\t}).format(cents / 100);\n}\n\nfunction getStatusBadge(status: string, key?: string) {\n\tconst variants: Record<string, { className: string; label: string }> = {\n\t\tdraft: {\n\t\t\tclassName:\n\t\t\t\t\"bg-muted text-foreground dark:bg-foreground/20 dark:text-muted-foreground\",\n\t\t\tlabel: \"Draft\",\n\t\t},\n\t\tsent: {\n\t\t\tclassName: \"bg-primary text-primary dark:bg-primary/20 dark:text-primary\",\n\t\t\tlabel: \"Sent\",\n\t\t},\n\t\tviewed: {\n\t\t\tclassName:\n\t\t\t\t\"bg-accent text-accent-foreground dark:bg-accent/20 dark:text-accent-foreground\",\n\t\t\tlabel: \"Viewed\",\n\t\t},\n\t\taccepted: {\n\t\t\tclassName: \"bg-success text-white\",\n\t\t\tlabel: \"Accepted\",\n\t\t},\n\t\tdeclined: {\n\t\t\tclassName: \"bg-destructive text-white\",\n\t\t\tlabel: \"Declined\",\n\t\t},\n\t\texpired: {\n\t\t\tclassName: \"bg-warning text-white\",\n\t\t\tlabel: \"Expired\",\n\t\t},\n\t};\n\n\tconst config = variants[status] || {\n\t\tclassName: \"bg-muted text-foreground\",\n\t\tlabel: status,\n\t};\n\n\treturn (\n\t\t<Badge className={config.className} key={key} variant=\"outline\">\n\t\t\t{config.label}\n\t\t</Badge>\n\t);\n}\n\nexport function EstimatePageContent({ entityData }: EstimatePageContentProps) {\n\tconst router = useRouter();\n\tconst [unlinkJobId, setUnlinkJobId] = useState<string | null>(null);\n\tconst [isUnlinking, setIsUnlinking] = useState(false);\n\n\tconst {\n\t\testimate,\n\t\tcustomer,\n\t\tjob,\n\t\tinvoice,\n\t\tcontract, // NEW: for workflow timeline\n\t\tnotes = [],\n\t\tactivities = [],\n\t\tattachments = [],\n\t} = entityData;\n\n\t// Extract tags from junction table data\n\tconst estimateTags = useMemo(() => {\n\t\tif (!estimate?.estimate_tags) {\n\t\t\treturn [];\n\t\t}\n\t\treturn estimate.estimate_tags.map((et: any) => ({\n\t\t\tid: et.id,\n\t\t\tname: et.name,\n\t\t\tslug: et.slug,\n\t\t\tcolor: et.color,\n\t\t\tcategory: et.category,\n\t\t\ticon: et.icon,\n\t\t}));\n\t}, [estimate?.estimate_tags]);\n\n\t// Keyboard shortcuts for section navigation (Ctrl+1 through Ctrl+9)\n\tconst sectionShortcuts = useMemo(\n\t\t() => ({\n\t\t\t\"1\": () => {\n\t\t\t\t// Workflow Timeline (if exists)\n\t\t\t\tconst element = document.querySelector(\n\t\t\t\t\t'[data-section-id=\"workflow-timeline\"]',\n\t\t\t\t);\n\t\t\t\tif (element) {\n\t\t\t\t\telement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\t\t\t\t\tconst trigger = element.querySelector(\"[data-accordion-trigger]\");\n\t\t\t\t\tif (trigger && trigger.getAttribute(\"data-state\") === \"closed\") {\n\t\t\t\t\t\t(trigger as HTMLElement).click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"2\": () => {\n\t\t\t\t// Estimate Details\n\t\t\t\tconst element = document.querySelector(\n\t\t\t\t\t'[data-section-id=\"estimate-details\"]',\n\t\t\t\t);\n\t\t\t\tif (element) {\n\t\t\t\t\telement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\t\t\t\t\tconst trigger = element.querySelector(\"[data-accordion-trigger]\");\n\t\t\t\t\tif (trigger && trigger.getAttribute(\"data-state\") === \"closed\") {\n\t\t\t\t\t\t(trigger as HTMLElement).click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"3\": () => {\n\t\t\t\t// Line Items\n\t\t\t\tconst element = document.querySelector(\n\t\t\t\t\t'[data-section-id=\"line-items\"]',\n\t\t\t\t);\n\t\t\t\tif (element) {\n\t\t\t\t\telement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\t\t\t\t\tconst trigger = element.querySelector(\"[data-accordion-trigger]\");\n\t\t\t\t\tif (trigger && trigger.getAttribute(\"data-state\") === \"closed\") {\n\t\t\t\t\t\t(trigger as HTMLElement).click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"4\": () => {\n\t\t\t\t// Customer\n\t\t\t\tconst element = document.querySelector('[data-section-id=\"customer\"]');\n\t\t\t\tif (element) {\n\t\t\t\t\telement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\t\t\t\t\tconst trigger = element.querySelector(\"[data-accordion-trigger]\");\n\t\t\t\t\tif (trigger && trigger.getAttribute(\"data-state\") === \"closed\") {\n\t\t\t\t\t\t(trigger as HTMLElement).click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"5\": () => {\n\t\t\t\t// Job\n\t\t\t\tconst element = document.querySelector('[data-section-id=\"job\"]');\n\t\t\t\tif (element) {\n\t\t\t\t\telement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\t\t\t\t\tconst trigger = element.querySelector(\"[data-accordion-trigger]\");\n\t\t\t\t\tif (trigger && trigger.getAttribute(\"data-state\") === \"closed\") {\n\t\t\t\t\t\t(trigger as HTMLElement).click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t\"9\": () => {\n\t\t\t\t// Tags\n\t\t\t\tconst element = document.querySelector('[data-section-id=\"tags\"]');\n\t\t\t\tif (element) {\n\t\t\t\t\telement.scrollIntoView({ behavior: \"smooth\", block: \"start\" });\n\t\t\t\t\tconst trigger = element.querySelector(\"[data-accordion-trigger]\");\n\t\t\t\t\tif (trigger && trigger.getAttribute(\"data-state\") === \"closed\") {\n\t\t\t\t\t\t(trigger as HTMLElement).click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t}),\n\t\t[],\n\t);\n\n\tuseSectionShortcuts(sectionShortcuts);\n\n\tconst handleUnlinkJob = async () => {\n\t\tif (!unlinkJobId) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetIsUnlinking(true);\n\t\ttry {\n\t\t\tconst result = await unlinkJobFromEstimate(estimate.id);\n\n\t\t\tif (result.success) {\n\t\t\t\ttoast.success(\"Job unlinked from estimate\");\n\t\t\t\tsetUnlinkJobId(null);\n\t\t\t\t// Refresh to show updated data\n\t\t\t\trouter.refresh();\n\t\t\t} else {\n\t\t\t\ttoast.error(result.error || \"Failed to unlink job\");\n\t\t\t}\n\t\t} catch (_error) {\n\t\t\ttoast.error(\"Failed to unlink job\");\n\t\t} finally {\n\t\t\tsetIsUnlinking(false);\n\t\t}\n\t};\n\n\t// Move computations before early return to comply with Rules of Hooks\n\tconst lineItems = estimate.line_items\n\t\t? typeof estimate.line_items === \"string\"\n\t\t\t? JSON.parse(estimate.line_items)\n\t\t\t: estimate.line_items\n\t\t: [];\n\n\tconst headerBadges = [getStatusBadge(estimate.status || \"draft\", \"status\")];\n\n\tconst customHeader = (\n\t\t<div className=\"w-full px-2 sm:px-0\">\n\t\t\t<div className=\"bg-muted/50 rounded-md shadow-sm\">\n\t\t\t\t<div className=\"flex flex-col gap-4 p-4 sm:p-6\">\n\t\t\t\t\t<div className=\"flex flex-col gap-6 sm:flex-row sm:items-start sm:justify-between\">\n\t\t\t\t\t\t<div className=\"flex flex-col gap-4\">\n\t\t\t\t\t\t\t<div className=\"flex flex-wrap items-center gap-2\">\n\t\t\t\t\t\t\t\t{headerBadges}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex flex-col gap-2\">\n\t\t\t\t\t\t\t\t<h1 className=\"text-2xl font-semibold sm:text-3xl\">\n\t\t\t\t\t\t\t\t\t{estimate.title ||\n\t\t\t\t\t\t\t\t\t\t`Estimate ${estimate.estimate_number || estimate.id.slice(0, 8)}`}\n\t\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground text-sm sm:text-base\">\n\t\t\t\t\t\t\t\t\t{formatCurrency(estimate.total_amount)}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{customer && (\n\t\t\t\t\t\t<div className=\"flex flex-wrap items-center gap-3\">\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName=\"border-border/60 bg-background hover:border-primary/50 hover:bg-primary/5 inline-flex items-center gap-2 rounded-full border px-4 py-2 text-sm font-medium transition-colors\"\n\t\t\t\t\t\t\t\thref={`/dashboard/customers/${customer.id}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<User className=\"size-4\" />\n\t\t\t\t\t\t\t\t{customer.display_name ||\n\t\t\t\t\t\t\t\t\t`${customer.first_name || \"\"} ${customer.last_name || \"\"}`.trim() ||\n\t\t\t\t\t\t\t\t\t\"Unknown Customer\"}\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\n\t\t\t\t\t<div className=\"flex flex-wrap items-center gap-3\">\n\t\t\t\t\t\t{estimate.valid_until && (\n\t\t\t\t\t\t\t<div className=\"bg-muted inline-flex items-center gap-2 rounded-full px-3 py-1 text-sm\">\n\t\t\t\t\t\t\t\t<Calendar className=\"text-muted-foreground size-4\" />\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">\n\t\t\t\t\t\t\t\t\tValid until{\" \"}\n\t\t\t\t\t\t\t\t\t{new Date(estimate.valid_until).toLocaleDateString()}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t{job && (\n\t\t\t\t\t\t\t<Link\n\t\t\t\t\t\t\t\tclassName=\"bg-muted hover:bg-muted/80 inline-flex items-center gap-2 rounded-full px-3 py-1 text-sm transition-colors\"\n\t\t\t\t\t\t\t\thref={`/dashboard/work/${job.id}`}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<FileText className=\"text-muted-foreground size-4\" />\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">Job #{job.job_number}</span>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n\n\tconst customSections = useMemo<UnifiedAccordionSection[]>(() => {\n\t\tconst sections: UnifiedAccordionSection[] = [];\n\n\t\t// NEW: Sales Workflow Timeline Section\n\t\t// Only show if there's a contract or invoice to display progression\n\t\tif (contract || invoice) {\n\t\t\tconst workflowStages = [\n\t\t\t\t{\n\t\t\t\t\tid: \"estimate\",\n\t\t\t\t\tlabel: \"Estimate Created\",\n\t\t\t\t\tstatus: \"completed\" as const,\n\t\t\t\t\tdate: estimate.created_at,\n\t\t\t\t\thref: `/dashboard/work/estimates/${estimate.id}`,\n\t\t\t\t\tdescription:\n\t\t\t\t\t\testimate.status === \"accepted\" ? \"Accepted by customer\" : undefined,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"contract\",\n\t\t\t\t\tlabel: \"Contract Generated\",\n\t\t\t\t\tstatus: contract ? (\"completed\" as const) : (\"pending\" as const),\n\t\t\t\t\tdate: contract?.created_at,\n\t\t\t\t\thref: contract\n\t\t\t\t\t\t? `/dashboard/work/contracts/${contract.id}`\n\t\t\t\t\t\t: undefined,\n\t\t\t\t\tdescription:\n\t\t\t\t\t\tcontract?.status === \"signed\"\n\t\t\t\t\t\t\t? \"Signed\"\n\t\t\t\t\t\t\t: contract\n\t\t\t\t\t\t\t\t? \"Pending signature\"\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"invoice\",\n\t\t\t\t\tlabel: \"Invoice Created\",\n\t\t\t\t\tstatus: invoice ? (\"completed\" as const) : (\"pending\" as const),\n\t\t\t\t\tdate: invoice?.created_at,\n\t\t\t\t\thref: invoice ? `/dashboard/work/invoices/${invoice.id}` : undefined,\n\t\t\t\t\tdescription:\n\t\t\t\t\t\tinvoice?.status === \"paid\"\n\t\t\t\t\t\t\t? \"Paid in full\"\n\t\t\t\t\t\t\t: invoice\n\t\t\t\t\t\t\t\t? `Status: ${invoice.status}`\n\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: \"payment\",\n\t\t\t\t\tlabel: \"Payment Received\",\n\t\t\t\t\tstatus:\n\t\t\t\t\t\tinvoice?.status === \"paid\"\n\t\t\t\t\t\t\t? (\"completed\" as const)\n\t\t\t\t\t\t\t: invoice\n\t\t\t\t\t\t\t\t? (\"current\" as const)\n\t\t\t\t\t\t\t\t: (\"pending\" as const),\n\t\t\t\t\tdate: invoice?.paid_at,\n\t\t\t\t\tdescription: invoice?.paid_at\n\t\t\t\t\t\t? \"Completed\"\n\t\t\t\t\t\t: invoice\n\t\t\t\t\t\t\t? `Balance: ${formatCurrency(invoice.balance_amount)}`\n\t\t\t\t\t\t\t: undefined,\n\t\t\t\t},\n\t\t\t];\n\n\t\t\tsections.push({\n\t\t\t\tid: \"workflow-timeline\",\n\t\t\t\ttitle: \"Sales Workflow\",\n\t\t\t\ticon: <TrendingUp className=\"size-4\" />,\n\t\t\t\tdefaultOpen: true,\n\t\t\t\tcontent: (\n\t\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t\t<WorkflowTimeline stages={workflowStages} />\n\t\t\t\t\t</UnifiedAccordionContent>\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\t// Line Items Section\n\t\tsections.push({\n\t\t\tid: \"line-items\",\n\t\t\ttitle: \"Line Items\",\n\t\t\ticon: <FileText className=\"size-4\" />,\n\t\t\tcount: lineItems.length,\n\t\t\tdefaultOpen: !(contract || invoice), // Only default open if workflow not shown\n\t\t\tcontent: (\n\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t{lineItems.length > 0 ? (\n\t\t\t\t\t\t<div className=\"-mx-4 overflow-x-auto sm:mx-0\">\n\t\t\t\t\t\t\t<Table>\n\t\t\t\t\t\t\t\t<TableHeader>\n\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t<TableHead>Description</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">Quantity</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">Unit Price</TableHead>\n\t\t\t\t\t\t\t\t\t\t<TableHead className=\"text-right\">Total</TableHead>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableHeader>\n\t\t\t\t\t\t\t\t<TableBody>\n\t\t\t\t\t\t\t\t\t{lineItems.map((item: any, index: number) => (\n\t\t\t\t\t\t\t\t\t\t<TableRow key={index}>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t{item.description || item.name || \"Item\"}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t\t\t{item.quantity || 1}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(\n\t\t\t\t\t\t\t\t\t\t\t\t\titem.unit_price || item.unitPrice || item.price || 0,\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right font-semibold\">\n\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(\n\t\t\t\t\t\t\t\t\t\t\t\t\t(item.quantity || 1) *\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t(item.unit_price ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.unitPrice ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\titem.price ||\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t0),\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t<TableRow className=\"bg-muted/50 border-t-2\">\n\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right font-semibold\" colSpan={3}>\n\t\t\t\t\t\t\t\t\t\t\tSubtotal\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right font-semibold\">\n\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(estimate.subtotal || 0)}\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t{estimate.tax_amount > 0 && (\n\t\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\" colSpan={3}>\n\t\t\t\t\t\t\t\t\t\t\t\tTax ({estimate.tax_rate || 0}%)\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(estimate.tax_amount || 0)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t{estimate.discount_amount > 0 && (\n\t\t\t\t\t\t\t\t\t\t<TableRow>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\" colSpan={3}>\n\t\t\t\t\t\t\t\t\t\t\t\tDiscount\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right\">\n\t\t\t\t\t\t\t\t\t\t\t\t-{formatCurrency(estimate.discount_amount || 0)}\n\t\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t<TableRow className=\"bg-muted/50 border-t-2\">\n\t\t\t\t\t\t\t\t\t\t<TableCell\n\t\t\t\t\t\t\t\t\t\t\tclassName=\"text-right text-lg font-bold\"\n\t\t\t\t\t\t\t\t\t\t\tcolSpan={3}\n\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\tTotal\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t\t<TableCell className=\"text-right text-lg font-bold\">\n\t\t\t\t\t\t\t\t\t\t\t{formatCurrency(estimate.total_amount || 0)}\n\t\t\t\t\t\t\t\t\t\t</TableCell>\n\t\t\t\t\t\t\t\t\t</TableRow>\n\t\t\t\t\t\t\t\t</TableBody>\n\t\t\t\t\t\t\t</Table>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"flex h-64 items-center justify-center\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<FileText className=\"text-muted-foreground/50 mx-auto size-12\" />\n\t\t\t\t\t\t\t\t<p className=\"text-muted-foreground mt-4 text-sm\">\n\t\t\t\t\t\t\t\t\tNo line items yet\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</UnifiedAccordionContent>\n\t\t\t),\n\t\t});\n\n\t\tif (estimate.terms) {\n\t\t\tsections.push({\n\t\t\t\tid: \"terms\",\n\t\t\t\ttitle: \"Terms & Conditions\",\n\t\t\t\ticon: <FileCheck className=\"size-4\" />,\n\t\t\t\tcontent: (\n\t\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t<p className=\"text-sm whitespace-pre-wrap\">{estimate.terms}</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</UnifiedAccordionContent>\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\tif (estimate.valid_until) {\n\t\t\tsections.push({\n\t\t\t\tid: \"validity\",\n\t\t\t\ttitle: \"Validity\",\n\t\t\t\ticon: <Calendar className=\"size-4\" />,\n\t\t\t\tcontent: (\n\t\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t<Label>Valid Until</Label>\n\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t{new Date(estimate.valid_until).toLocaleDateString()}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{estimate.status === \"accepted\" && estimate.accepted_at && (\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Accepted At</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t{new Date(estimate.accepted_at).toLocaleString()}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t{estimate.status === \"declined\" && estimate.declined_at && (\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Declined At</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t{new Date(estimate.declined_at).toLocaleString()}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t{estimate.decline_reason && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"mt-2\">\n\t\t\t\t\t\t\t\t\t\t\t<Label>Decline Reason</Label>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">{estimate.decline_reason}</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</UnifiedAccordionContent>\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\tif (customer) {\n\t\t\tsections.push({\n\t\t\t\tid: \"customer-details\",\n\t\t\t\ttitle: \"Customer Details\",\n\t\t\t\ticon: <User className=\"size-4\" />,\n\t\t\t\tcontent: (\n\t\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t\t<div className=\"flex flex-col gap-4 md:flex-row md:items-start md:justify-between\">\n\t\t\t\t\t\t\t<div className=\"grid flex-1 gap-4 md:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Name</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t{customer.display_name ||\n\t\t\t\t\t\t\t\t\t\t\t`${customer.first_name || \"\"} ${customer.last_name || \"\"}`.trim() ||\n\t\t\t\t\t\t\t\t\t\t\t\"Unknown\"}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Email</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">{customer.email || \"N/A\"}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Phone</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">{customer.phone || \"N/A\"}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button asChild size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t\t\t<Link href={`/dashboard/customers/${customer.id}`}>\n\t\t\t\t\t\t\t\t\tView Full Profile\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</UnifiedAccordionContent>\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\tif (job) {\n\t\t\tsections.push({\n\t\t\t\tid: \"job-details\",\n\t\t\t\ttitle: \"Related Job\",\n\t\t\t\ticon: <FileText className=\"size-4\" />,\n\t\t\t\tcontent: (\n\t\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t\t<div className=\"flex flex-col gap-4 md:flex-row md:items-start md:justify-between\">\n\t\t\t\t\t\t\t<div className=\"grid flex-1 gap-4 md:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Job Number</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t#{job.job_number || job.id.slice(0, 8)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Title</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">{job.title || \"N/A\"}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t\t<Button asChild size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t\t\t\t<Link href={`/dashboard/work/${job.id}`}>View Job</Link>\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => setUnlinkJobId(job.id)}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Link2Off className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\t\t\tUnlink\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</UnifiedAccordionContent>\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\tif (invoice) {\n\t\t\tsections.push({\n\t\t\t\tid: \"invoice-details\",\n\t\t\t\ttitle: \"Related Invoice\",\n\t\t\t\ticon: <Receipt className=\"size-4\" />,\n\t\t\t\tcontent: (\n\t\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t\t<div className=\"flex flex-col gap-4 md:flex-row md:items-start md:justify-between\">\n\t\t\t\t\t\t\t<div className=\"grid flex-1 gap-4 md:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Invoice Number</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t#{invoice.invoice_number || invoice.id.slice(0, 8)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<Label>Invoice Amount</Label>\n\t\t\t\t\t\t\t\t\t<p className=\"text-sm\">\n\t\t\t\t\t\t\t\t\t\t{formatCurrency(invoice.total_amount)}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Button asChild size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t\t\t<Link href={`/dashboard/work/invoices/${invoice.id}`}>\n\t\t\t\t\t\t\t\t\tView Invoice\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</UnifiedAccordionContent>\n\t\t\t\t),\n\t\t\t});\n\t\t}\n\n\t\t// Tags Section\n\t\tsections.push({\n\t\t\tid: \"tags\",\n\t\t\ttitle: \"Tags\",\n\t\t\ticon: <Package className=\"size-4\" />,\n\t\t\tcontent: (\n\t\t\t\t<UnifiedAccordionContent>\n\t\t\t\t\t<div className=\"w-full\">\n\t\t\t\t\t\t<div className=\"bg-muted/50 rounded-md\">\n\t\t\t\t\t\t\t<div className=\"flex flex-col gap-3 p-4\">\n\t\t\t\t\t\t\t\t<span className=\"text-muted-foreground text-xs font-medium\">\n\t\t\t\t\t\t\t\t\tOrganize estimates with tags:\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<EntityTags\n\t\t\t\t\t\t\t\t\tentityId={estimate.id}\n\t\t\t\t\t\t\t\t\tentityType=\"estimate\"\n\t\t\t\t\t\t\t\t\tonUpdateTags={async (id, tags) => {\n\t\t\t\t\t\t\t\t\t\tconst result = await updateEntityTags(\"estimate\", id, tags);\n\t\t\t\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\t\t\t\trouter.refresh();\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to update tags\");\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\ttags={estimateTags}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</UnifiedAccordionContent>\n\t\t\t),\n\t\t});\n\n\t\treturn sections;\n\t}, [\n\t\testimate,\n\t\tcustomer,\n\t\tjob,\n\t\tinvoice,\n\t\tcontract,\n\t\tlineItems,\n\t\testimateTags,\n\t\trouter,\n\t]);\n\n\tconst relatedItems = useMemo(() => {\n\t\tconst items: any[] = [];\n\n\t\tif (customer) {\n\t\t\titems.push({\n\t\t\t\tid: `customer-${customer.id}`,\n\t\t\t\ttype: \"customer\",\n\t\t\t\ttitle:\n\t\t\t\t\tcustomer.display_name ||\n\t\t\t\t\t`${customer.first_name || \"\"} ${customer.last_name || \"\"}`.trim() ||\n\t\t\t\t\t\"Unknown Customer\",\n\t\t\t\tsubtitle: customer.email || customer.phone || undefined,\n\t\t\t\thref: `/dashboard/customers/${customer.id}`,\n\t\t\t});\n\t\t}\n\n\t\tif (job) {\n\t\t\titems.push({\n\t\t\t\tid: `job-${job.id}`,\n\t\t\t\ttype: \"job\",\n\t\t\t\ttitle: job.title || `Job #${job.job_number || job.id.slice(0, 8)}`,\n\t\t\t\tsubtitle: job.status,\n\t\t\t\thref: `/dashboard/work/${job.id}`,\n\t\t\t\tbadge: job.status\n\t\t\t\t\t? { label: job.status, variant: \"outline\" as const }\n\t\t\t\t\t: undefined,\n\t\t\t});\n\t\t}\n\n\t\tif (invoice) {\n\t\t\titems.push({\n\t\t\t\tid: `invoice-${invoice.id}`,\n\t\t\t\ttype: \"invoice\",\n\t\t\t\ttitle: `Invoice #${invoice.invoice_number || invoice.id.slice(0, 8)}`,\n\t\t\t\tsubtitle: formatCurrency(invoice.total_amount),\n\t\t\t\thref: `/dashboard/work/invoices/${invoice.id}`,\n\t\t\t\tbadge: invoice.status\n\t\t\t\t\t? { label: invoice.status, variant: \"outline\" as const }\n\t\t\t\t\t: undefined,\n\t\t\t});\n\t\t}\n\n\t\treturn items;\n\t}, [customer, job, invoice]);\n\n\treturn (\n\t\t<>\n\t\t\t<DetailPageContentLayout\n\t\t\t\tactivities={activities}\n\t\t\t\tattachments={attachments}\n\t\t\t\tcustomHeader={customHeader}\n\t\t\t\tcustomSections={customSections}\n\t\t\t\tdefaultOpenSection=\"line-items\"\n\t\t\t\tnotes={notes}\n\t\t\t\trelatedItems={relatedItems}\n\t\t\t\tshowStandardSections={{\n\t\t\t\t\tactivities: true,\n\t\t\t\t\tnotes: true,\n\t\t\t\t\tattachments: true,\n\t\t\t\t\trelatedItems: true,\n\t\t\t\t}}\n\t\t\t/>\n\n\t\t\t{/* Archive Dialog */}\n\t\t\t{/* Unlink Job Confirmation Dialog */}\n\t\t\t<Dialog\n\t\t\t\tonOpenChange={(open) => !open && setUnlinkJobId(null)}\n\t\t\t\topen={unlinkJobId !== null}\n\t\t\t>\n\t\t\t\t<DialogContent>\n\t\t\t\t\t<DialogHeader>\n\t\t\t\t\t\t<DialogTitle>Unlink Job from Estimate?</DialogTitle>\n\t\t\t\t\t\t<DialogDescription>\n\t\t\t\t\t\t\tThis will remove the job association from this estimate. The\n\t\t\t\t\t\t\testimate will remain in the system but will no longer appear on\n\t\t\t\t\t\t\tthe job's page.\n\t\t\t\t\t\t</DialogDescription>\n\t\t\t\t\t</DialogHeader>\n\t\t\t\t\t<DialogFooter>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdisabled={isUnlinking}\n\t\t\t\t\t\t\tonClick={() => setUnlinkJobId(null)}\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tdisabled={isUnlinking}\n\t\t\t\t\t\t\tonClick={handleUnlinkJob}\n\t\t\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{isUnlinking ? \"Unlinking...\" : \"Unlink Job\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</DialogFooter>\n\t\t\t\t</DialogContent>\n\t\t\t</Dialog>\n\t\t</>\n\t);\n}\n"],"names":[],"mappings":"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"}