module.exports=[792998,a=>{"use strict";var b=a.i(861467),c=a.i(89626),d=a.i(97997),e=a.i(452168),f=a.i(96250),g=a.i(337850),h=a.i(624126),i=a.i(274956),j=a.i(187056),k=a.i(874544),l=a.i(319895),m=a.i(789815),n=a.i(824124),o=a.i(383413),p=a.i(21220),q=a.i(505275),q=q,r=a.i(530762),s=a.i(320091),t=a.i(362841),u=a.i(145679),v=a.i(337241),w=a.i(783281),x=a.i(156916),y=a.i(671390),z=a.i(169021),A=(0,z.createServerReference)("7c13474a9092a93eb9a51197c6e34b5eb46593056c",z.callServer,void 0,z.findSourceMapURL,"updatePurchaseOrderVendor"),B=a.i(263758),C=a.i(638446),D=a.i(858781),E=a.i(441178);a.i(445255);var F=a.i(18170);a.i(421695);var G=a.i(736786);a.i(297229);var H=a.i(489904),I=a.i(700760);function J({value:a,onValueChange:c,placeholder:d="Select vendor...",disabled:e=!1,className:f}){let[g,h]=(0,w.useState)(!1),[i,j]=(0,w.useState)([]),[k,l]=(0,w.useState)(!1),[m,n]=(0,w.useState)("");(0,w.useEffect)(()=>{let a=async()=>{l(!0);let a=await (0,E.searchVendors)(m||"");a.success&&a.data&&j(a.data),l(!1)},b=setTimeout(()=>{a()},300);return()=>clearTimeout(b)},[m]);let o=i.find(b=>b.id===a);return(0,b.jsxs)(H.Popover,{onOpenChange:h,open:g,children:[(0,b.jsx)(H.PopoverTrigger,{asChild:!0,children:(0,b.jsxs)(F.Button,{"aria-expanded":g,className:(0,I.cn)("w-full justify-between",!o&&"text-muted-foreground",f),disabled:e,role:"combobox",variant:"outline",children:[o?(0,b.jsxs)("span",{className:"flex items-center gap-2",children:[(0,b.jsx)(B.Building2,{className:"h-4 w-4"}),(0,b.jsx)("span",{children:o.display_name||o.name}),(0,b.jsxs)("span",{className:"text-muted-foreground text-xs",children:["(",o.vendor_number,")"]})]}):(0,b.jsx)("span",{children:d}),(0,b.jsx)(D.ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,b.jsx)(H.PopoverContent,{align:"start",className:"w-full p-0",children:(0,b.jsxs)(G.Command,{children:[(0,b.jsx)(G.CommandInput,{onValueChange:n,placeholder:"Search vendors..."}),(0,b.jsxs)(G.CommandList,{children:[(0,b.jsx)(G.CommandEmpty,{children:k?"Loading...":"No vendors found."}),(0,b.jsx)(G.CommandGroup,{children:i.map(d=>(0,b.jsxs)(G.CommandItem,{onSelect:()=>{c(d.id===a?void 0:d.id,d.id===a?void 0:d),h(!1)},value:`${d.name} ${d.vendor_number} ${d.email||""}`,children:[(0,b.jsx)(C.Check,{className:(0,I.cn)("mr-2 h-4 w-4",a===d.id?"opacity-100":"opacity-0")}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"font-medium",children:d.display_name||d.name}),(0,b.jsxs)("span",{className:"text-muted-foreground text-xs",children:[d.vendor_number,d.email&&` • ${d.email}`]})]})]},d.id))})]})]})})]})}var K=a.i(645659),L=a.i(506294);a.i(288007);var M=a.i(986990);a.i(19256);var N=a.i(417132);a.i(956852);var O=a.i(90125);a.i(458393);var P=a.i(82012),Q=a.i(382281);a.i(897618);var R=a.i(709929);a.i(897346);var S=a.i(75892);a.i(476036);var T=a.i(930514),U=a.i(251048);function V({entityData:a,metrics:z}){(0,v.useRouter)();let{toast:B}=(0,U.useToast)(),[C,D]=(0,w.useState)(!1),[E,G]=(0,w.useState)(!1),[H,I]=(0,w.useState)(!1),[V,W]=(0,w.useState)(!1),{purchaseOrder:X,job:Y,estimate:Z,invoice:$,lineItems:_=[],activities:aa=[],attachments:ab=[],requestedByUser:ac,approvedByUser:ad}=a,[ae,af]=(0,w.useState)(!1),[ag,ah]=(0,w.useState)(X.status||"draft"),[ai,aj]=(0,w.useState)(""),[ak,al]=(0,w.useState)(!1),[am,an]=(0,w.useState)(!1),[ao,ap]=(0,w.useState)(X.vendor_id),[aq,ar]=(0,w.useState)(null),[as,at]=(0,w.useState)(!1),[au,av]=(0,w.useState)(!1),[aw,ax]=(0,w.useState)("line-items"),ay=async()=>{W(!0);try{let a=await (0,y.archivePurchaseOrder)(X.id);a.success?(x.toast.success("Purchase order archived successfully"),I(!1),window.location.href="/dashboard/work/purchase-orders"):x.toast.error(a.error||"Failed to archive purchase order")}catch(a){x.toast.error("Failed to archive purchase order")}finally{W(!1)}},az=[{id:"line-items",title:"Line Items",count:_.length,defaultOpen:!0,content:(0,b.jsx)(T.UnifiedAccordionContent,{children:_.length>0?(0,b.jsx)("div",{className:"-mx-4 overflow-x-auto sm:mx-0",children:(0,b.jsxs)(R.Table,{children:[(0,b.jsx)(R.TableHeader,{className:"bg-background sticky top-0",children:(0,b.jsxs)(R.TableRow,{children:[(0,b.jsx)(R.TableHead,{className:"min-w-[200px]",children:"Description"}),(0,b.jsx)(R.TableHead,{className:"w-24 text-right",children:"Ordered"}),("partially_received"===X.status||"received"===X.status||_.some(a=>a.received_quantity>0))&&(0,b.jsx)(R.TableHead,{className:"w-24 text-right",children:"Received"}),(0,b.jsx)(R.TableHead,{className:"w-32 text-right",children:"Unit Price"}),(0,b.jsx)(R.TableHead,{className:"w-32 text-right",children:"Total"})]})}),(0,b.jsxs)(R.TableBody,{children:[_.map(a=>{let c=a.received_quantity||0,d=a.quantity||0,e=c>=d,g=c>0&&c<d;return(0,b.jsxs)(R.TableRow,{children:[(0,b.jsx)(R.TableCell,{className:"font-medium",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[a.description,e&&(0,b.jsx)(f.CheckCircle2,{"aria-label":"Fully received",className:"text-success size-4"}),g&&(0,b.jsx)(h.Clock,{"aria-label":"Partially received",className:"text-warning size-4"})]})}),(0,b.jsx)(R.TableCell,{className:"text-right",children:d}),("partially_received"===X.status||"received"===X.status||c>0)&&(0,b.jsxs)(R.TableCell,{className:"text-right",children:[(0,b.jsx)("span",{className:e?"text-success font-semibold":g?"text-warning":"",children:c}),g&&(0,b.jsxs)("span",{className:"text-muted-foreground ml-1 text-xs",children:["(",d-c," remaining)"]})]}),(0,b.jsx)(R.TableCell,{className:"text-right",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format((a.unit_price||0)/100)}),(0,b.jsx)(R.TableCell,{className:"text-right font-semibold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(d*(a.unit_price||0)/100)})]},a.id)}),(0,b.jsxs)(R.TableRow,{className:"bg-muted/50 border-t-2",children:[(0,b.jsx)(R.TableCell,{className:"text-right font-semibold",colSpan:"partially_received"===X.status||"received"===X.status||_.some(a=>a.received_quantity>0)?4:3,children:"Total"}),(0,b.jsx)(R.TableCell,{className:"text-right text-lg font-bold",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(_.reduce((a,b)=>a+(b.quantity||0)*(b.unit_price||0),0)/100)})]})]})]})}):(0,b.jsx)("div",{className:"flex h-64 items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(l.FileText,{className:"text-muted-foreground/50 mx-auto size-12"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-4 text-sm",children:"No line items yet"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Add items to this purchase order"})]})})})}];return Y&&az.push({id:"job-details",title:"Related Job",icon:(0,b.jsx)(t.Wrench,{className:"size-4"}),content:(0,b.jsx)(T.UnifiedAccordionContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Job Number"}),(0,b.jsxs)(u.default,{className:"text-primary block text-sm font-medium hover:underline",href:`/dashboard/work/${Y.id}`,children:["#",Y.job_number]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Title"}),(0,b.jsx)("p",{className:"text-sm",children:Y.title})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Status"}),(0,b.jsx)(M.Badge,{variant:"outline",children:Y.status})]})]})})}),Z&&az.push({id:"source-estimate",title:"Source Estimate",icon:(0,b.jsx)(l.FileText,{className:"size-4"}),content:(0,b.jsx)(T.UnifiedAccordionContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Estimate Number"}),(0,b.jsxs)(u.default,{className:"text-primary block text-sm font-medium hover:underline",href:`/dashboard/work/estimates/${Z.id}`,children:["#",Z.estimate_number||Z.id.slice(0,8)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Title"}),(0,b.jsx)("p",{className:"text-sm",children:Z.title})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Total Amount"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format((Z.total_amount||0)/100)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Status"}),(0,b.jsx)(M.Badge,{variant:"outline",children:Z.status})]})]})})}),$&&az.push({id:"related-invoice",title:"Related Invoice",icon:(0,b.jsx)(k.FileCheck,{className:"size-4"}),content:(0,b.jsx)(T.UnifiedAccordionContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Invoice Number"}),(0,b.jsxs)(u.default,{className:"text-primary block text-sm font-medium hover:underline",href:`/dashboard/work/invoices/${$.id}`,children:["#",$.invoice_number||$.id.slice(0,8)]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Title"}),(0,b.jsx)("p",{className:"text-sm",children:$.title})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Total Amount"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(($.total_amount||0)/100)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Status"}),(0,b.jsx)(M.Badge,{variant:"paid"===$.status?"default":"outline",children:$.status})]})]})})}),(X.delivery_address||X.tracking_number)&&az.push({id:"delivery",title:"Delivery Details",icon:(0,b.jsx)(n.MapPin,{className:"size-4"}),content:(0,b.jsx)(T.UnifiedAccordionContent,{children:(0,b.jsxs)("div",{className:"space-y-3",children:[X.delivery_address&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Delivery Address"}),(0,b.jsx)("p",{className:"text-sm whitespace-pre-line",children:X.delivery_address})]}),X.tracking_number&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Tracking Number"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-mono text-sm",children:X.tracking_number}),(0,b.jsx)(F.Button,{asChild:!0,className:"h-6 px-2",size:"sm",variant:"ghost",children:(0,b.jsx)("a",{href:`https://www.google.com/search?q=${encodeURIComponent(X.tracking_number)}`,rel:"noopener noreferrer",target:"_blank",children:"Track"})})]})]})]})})}),az.push({id:"attachments",title:"Attachments",icon:(0,b.jsx)(p.Paperclip,{className:"size-4"}),count:ab.length,content:(0,b.jsx)(T.UnifiedAccordionContent,{children:ab.length>0?(0,b.jsx)("div",{className:"space-y-2",children:ab.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-2",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(l.FileText,{className:"text-muted-foreground size-4"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:a.original_file_name||a.file_name}),(0,b.jsxs)("p",{className:"text-muted-foreground text-xs",children:[a.file_size?`${(a.file_size/1024).toFixed(1)} KB`:"",a.category&&` • ${a.category}`]})]})]}),(0,b.jsx)(F.Button,{asChild:!0,size:"sm",variant:"ghost",children:(0,b.jsx)("a",{href:a.storage_url,rel:"noopener noreferrer",target:"_blank",children:(0,b.jsx)(j.Download,{className:"size-4"})})})]},a.id))}):(0,b.jsx)("p",{className:"text-muted-foreground text-center text-sm",children:"No attachments yet"})})}),(X.notes||X.internal_notes)&&az.push({id:"notes",title:"Notes",icon:(0,b.jsx)(l.FileText,{className:"size-4"}),content:(0,b.jsx)(T.UnifiedAccordionContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[X.notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Public Notes"}),(0,b.jsx)("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:X.notes})]}),X.internal_notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-xs",children:"Internal Notes"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-sm whitespace-pre-wrap",children:X.internal_notes})]})]})})}),az.push({id:"documents",title:"Documents",icon:(0,b.jsx)(p.Paperclip,{className:"size-4"}),count:ab.length,content:(0,b.jsx)(L.AttachmentsSection,{attachments:ab})}),az.push({id:"activity",title:"Activity",icon:(0,b.jsx)(c.Activity,{className:"size-4"}),count:aa.length,content:(0,b.jsx)(K.ActivityLogSection,{activities:aa})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"w-full",children:(0,b.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,b.jsxs)("div",{className:"hidden flex-row items-center justify-between lg:flex",children:[(0,b.jsx)("div",{className:"flex flex-row items-center gap-2",children:(0,b.jsx)("h1",{className:"text-2xl font-semibold",children:X.title})}),(0,b.jsxs)("div",{className:"flex h-min gap-2",children:[(0,b.jsxs)(F.Button,{onClick:()=>window.print(),size:"sm",variant:"outline",children:[(0,b.jsx)(r.Printer,{className:"mr-2 size-4"}),"Print"]}),X.vendor_email&&(0,b.jsx)(F.Button,{asChild:!0,size:"sm",variant:"outline",children:(0,b.jsxs)("a",{href:`mailto:${X.vendor_email}?subject=Purchase Order ${X.po_number||X.poNumber}`,children:[(0,b.jsx)(m.Mail,{className:"mr-2 size-4"}),"Email Vendor"]})}),(0,b.jsxs)(O.DropdownMenu,{children:[(0,b.jsx)(O.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(F.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(o.MoreVertical,{className:"size-4"})})}),(0,b.jsxs)(O.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("pending_approval"),af(!0)},children:"Request Approval"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("approved"),af(!0)},children:"Approve"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("ordered"),af(!0)},children:"Mark as Ordered"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("partially_received"),af(!0)},children:"Partially Received"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("received"),af(!0)},children:"Mark as Received"}),(0,b.jsx)(O.DropdownMenuItem,{className:"text-destructive",onClick:()=>{ah("cancelled"),af(!0)},children:"Cancel PO"}),(0,b.jsxs)(O.DropdownMenuItem,{onClick:()=>I(!0),children:[(0,b.jsx)(e.Archive,{className:"mr-2 size-4"}),"Archive"]})]})]})]})]}),(0,b.jsxs)("div",{className:"bg-muted/50 rounded-md shadow-sm",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-4 overflow-hidden p-4 sm:p-6 md:flex-row",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsx)("div",{className:"aspect-[16/10] w-full md:w-[320px] lg:w-[400px]",children:(0,b.jsx)("div",{className:"border-border flex size-full w-full flex-none justify-center overflow-hidden rounded-lg border border-solid p-0",children:(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsx)("div",{className:"border-border w-full border-b border-solid p-3",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["received"===X.status?(0,b.jsx)(f.CheckCircle2,{className:"text-success size-4"}):"cancelled"===X.status?(0,b.jsx)(d.AlertCircle,{className:"text-destructive size-4"}):(0,b.jsx)(h.Clock,{className:"text-warning size-4"}),(0,b.jsx)("h3",{className:"text-sm font-medium",children:X.status?.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase())||"Draft"})]})}),(0,b.jsx)("div",{className:"flex h-[calc(100%-45px)] flex-col p-3",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"PO Number"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:X.po_number||X.poNumber})]}),X.vendor&&(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"Vendor"}),(0,b.jsx)("p",{className:"text-sm font-medium",children:X.vendor})]})]})})]})})}),(0,b.jsxs)("div",{className:"flex h-min flex-wrap gap-2 lg:hidden",children:[(0,b.jsxs)(F.Button,{className:"min-w-[96px] flex-1",onClick:()=>window.print(),size:"sm",variant:"outline",children:[(0,b.jsx)(r.Printer,{className:"mr-2 size-4"}),"Print"]}),X.vendor_email&&(0,b.jsx)(F.Button,{asChild:!0,className:"min-w-[96px] flex-1",size:"sm",variant:"outline",children:(0,b.jsxs)("a",{href:`mailto:${X.vendor_email}?subject=Purchase Order ${X.po_number||X.poNumber}`,children:[(0,b.jsx)(m.Mail,{className:"mr-2 size-4"}),"Email"]})}),(0,b.jsxs)(O.DropdownMenu,{children:[(0,b.jsx)(O.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsx)(F.Button,{size:"sm",variant:"outline",children:(0,b.jsx)(o.MoreVertical,{className:"size-4"})})}),(0,b.jsxs)(O.DropdownMenuContent,{align:"end",children:[(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("pending_approval"),af(!0)},children:"Request Approval"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("approved"),af(!0)},children:"Approve"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("ordered"),af(!0)},children:"Mark as Ordered"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("partially_received"),af(!0)},children:"Partially Received"}),(0,b.jsx)(O.DropdownMenuItem,{onClick:()=>{ah("received"),af(!0)},children:"Mark as Received"}),(0,b.jsx)(O.DropdownMenuItem,{className:"text-destructive",onClick:()=>{ah("cancelled"),af(!0)},children:"Cancel PO"}),(0,b.jsxs)(O.DropdownMenuItem,{onClick:()=>I(!0),children:[(0,b.jsx)(e.Archive,{className:"mr-2 size-4"}),"Archive"]})]})]})]})]}),(0,b.jsxs)("div",{className:"flex min-w-0 flex-1 flex-col gap-4 sm:gap-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4 md:grid-cols-4 [&>div]:flex-[0_1_auto]",children:[(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"Created"}),(0,b.jsxs)("div",{className:"flex h-5 items-center gap-2 text-sm whitespace-nowrap [&>*]:text-ellipsis",children:[(0,b.jsx)(s.User,{className:"text-muted-foreground size-4 flex-none"}),(0,b.jsx)("span",{className:"-ml-px shrink truncate text-sm",children:ac?.name||ac?.email||"Unknown"}),(0,b.jsx)("span",{className:"text-muted-foreground flex-none text-xs tabular-nums",children:new Date(X.created_at).toLocaleDateString()})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"Status"}),(0,b.jsxs)("div",{className:"-ml-[3px] flex h-5 items-center gap-1 text-sm whitespace-nowrap [&>*]:text-ellipsis",children:[(0,b.jsx)("span",{className:"flex size-4 items-center justify-center",children:(0,b.jsx)("span",{className:`size-2.5 flex-none rounded-full ${"received"===X.status?"bg-success":"cancelled"===X.status?"bg-destructive":"bg-warning"}`})}),(0,b.jsx)("span",{className:"text-sm",children:X.status?.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase())||"Draft"}),X.priority&&(0,b.jsx)(M.Badge,{className:"ml-1",variant:"outline",children:X.priority})]})]}),X.expected_delivery&&(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"Expected Delivery"}),(0,b.jsxs)("div",{className:"flex h-5 items-center gap-2 text-sm whitespace-nowrap tabular-nums [&>*]:text-ellipsis",children:[(0,b.jsx)(h.Clock,{className:"text-muted-foreground size-4 flex-none"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:new Date(X.expected_delivery).toLocaleDateString()}),X.actual_delivery&&(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:new Date(X.actual_delivery).toLocaleDateString()})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"Total"}),(0,b.jsxs)("div",{className:"flex h-5 items-center gap-2 text-sm whitespace-nowrap [&>*]:text-ellipsis",children:[(0,b.jsx)(i.DollarSign,{className:"text-muted-foreground size-4 flex-none"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format((X.total_amount||0)/100)})]})]})]}),(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"Vendor"}),(0,b.jsxs)("div",{className:"flex h-5 items-center gap-2 text-sm whitespace-nowrap [&>*]:text-ellipsis",children:[!am&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(s.User,{className:"text-muted-foreground size-4 flex-none"}),X.vendor?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{className:"text-sm font-medium",children:X.vendor}),(0,b.jsxs)(F.Button,{className:"h-6 px-2",onClick:()=>an(!0),size:"sm",variant:"ghost",children:[(0,b.jsx)(q.default,{className:"mr-1 size-3"}),"Change"]})]}):(0,b.jsx)(F.Button,{className:"h-6",onClick:()=>an(!0),size:"sm",variant:"outline",children:"Assign Vendor"})]}),am&&(0,b.jsxs)("div",{className:"flex w-full items-center gap-2",children:[(0,b.jsx)(J,{className:"flex-1",onValueChange:(a,b)=>{ap(a),ar(b)},placeholder:"Select vendor...",value:ao}),(0,b.jsx)(F.Button,{className:"h-6",disabled:as||!ao,onClick:async()=>{if(!ao)return void B.error("Please select a vendor");at(!0);try{let a=aq?.display_name||aq?.name||X.vendor,b=aq?.email||X.vendor_email,c=aq?.phone||X.vendor_phone,d=await A(X.id,ao,a,b,c);if(d.success)B.success(`Vendor changed to ${a}`),an(!1);else throw Error(d.error||"Failed to update vendor")}catch(a){B.error(a instanceof Error?a.message:"Failed to update vendor")}finally{at(!1)}},size:"sm",children:as?"Saving...":"Save"}),(0,b.jsx)(F.Button,{className:"h-6",disabled:as,onClick:()=>{an(!1),ap(X.vendor_id),ar(null)},size:"sm",variant:"ghost",children:"Cancel"})]})]})]}),X.job_id&&(0,b.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,b.jsx)("span",{className:"text-muted-foreground text-xs",children:"Related Job"}),(0,b.jsxs)("div",{className:"flex h-5 items-center gap-2 text-sm whitespace-nowrap [&>*]:text-ellipsis",children:[(0,b.jsx)(k.FileCheck,{className:"text-muted-foreground size-4 flex-none"}),(0,b.jsxs)("span",{className:"text-sm font-medium",children:["Job #",X.job_id]})]})]})]})]}),(0,b.jsx)("div",{className:"rounded-b","data-orientation":"vertical",children:(0,b.jsxs)("div",{"data-orientation":"vertical","data-state":au?"open":"closed",children:[(0,b.jsx)("button",{className:"ease border-border hover:bg-muted/50 disabled:text-muted-foreground flex h-12 w-full cursor-pointer items-center justify-between border-0 border-t bg-transparent px-4 transition-all duration-200","data-radix-collection-item":"",onClick:()=>av(!au),type:"button",children:(0,b.jsxs)("span",{className:"flex w-full items-center gap-2",children:[(0,b.jsx)(g.ChevronRight,{className:`size-4 transition-transform duration-200 ease-[ease] ${au?"rotate-90":""}`}),(0,b.jsx)("span",{className:"flex w-full items-center gap-2",children:(0,b.jsx)("span",{className:"text-sm font-medium",children:"Purchase Order Details"})})]})}),(0,b.jsx)("div",{className:"slide-in-from-top-2 animate-in data-[state=closed]:animate-content-close data-[state=closed]:animate-out data-[state=open]:animate-content-open overflow-hidden duration-200 will-change-[height]","data-state":au?"open":"closed",hidden:!au,role:"region",children:(0,b.jsxs)("div",{className:"space-y-4 border-t p-4 sm:p-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-muted-foreground text-xs",children:"PO Number"}),(0,b.jsx)("p",{className:"mt-1 text-sm font-medium",children:X.po_number||X.poNumber})]}),X.delivery_address&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-muted-foreground text-xs",children:"Delivery Address"}),(0,b.jsx)("p",{className:"mt-1 text-sm whitespace-pre-line",children:X.delivery_address})]}),X.tracking_number&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-muted-foreground text-xs",children:"Tracking Number"}),(0,b.jsxs)("div",{className:"mt-1 flex items-center gap-2",children:[(0,b.jsx)("p",{className:"font-mono text-sm",children:X.tracking_number}),(0,b.jsx)(F.Button,{asChild:!0,className:"h-6 px-2",size:"sm",variant:"ghost",children:(0,b.jsx)("a",{href:`https://www.google.com/search?q=${encodeURIComponent(X.tracking_number)}`,rel:"noopener noreferrer",target:"_blank",children:"Track"})})]})]}),X.notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-muted-foreground text-xs",children:"Public Notes"}),(0,b.jsx)("p",{className:"mt-1 text-sm whitespace-pre-wrap",children:X.notes})]}),X.internal_notes&&(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{className:"text-muted-foreground text-xs",children:"Internal Notes"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-sm whitespace-pre-wrap",children:X.internal_notes})]})]})})]})})]}),(0,b.jsx)(T.UnifiedAccordion,{defaultOpenSection:"line-items",sections:az})]})}),(0,b.jsx)(N.Dialog,{onOpenChange:af,open:ae,children:(0,b.jsxs)(N.DialogContent,{children:[(0,b.jsxs)(N.DialogHeader,{children:[(0,b.jsx)(N.DialogTitle,{children:"Update Purchase Order Status"}),(0,b.jsxs)(N.DialogDescription,{children:["Update the status of this purchase order to"," ",ag.replace("_"," "),"."]})]}),(0,b.jsxs)("div",{className:"space-y-4 py-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(P.Label,{children:"New Status"}),(0,b.jsx)("div",{className:"mt-2",children:(0,b.jsx)(M.Badge,{variant:"default",children:ag.replace("_"," ").replace(/\b\w/g,a=>a.toUpperCase())})})]}),(0,b.jsx)(Q.StandardFormField,{label:"Notes (Optional)",htmlFor:"status-notes",children:(0,b.jsx)(S.Textarea,{id:"status-notes",onChange:a=>aj(a.target.value),placeholder:"Add any notes about this status change...",value:ai})})]}),(0,b.jsxs)(N.DialogFooter,{className:"flex-col gap-2 sm:flex-row",children:[(0,b.jsx)(F.Button,{className:"w-full sm:w-auto",onClick:()=>{af(!1),aj("")},variant:"outline",children:"Cancel"}),(0,b.jsx)(F.Button,{className:"w-full sm:w-auto",disabled:ak,onClick:async()=>{B.success(`Status changed to ${ag.replace("_"," ")}`),af(!1),aj("")},children:ak?"Updating...":"Update Status"})]})]})}),(0,b.jsx)(N.Dialog,{onOpenChange:I,open:H,children:(0,b.jsxs)(N.DialogContent,{children:[(0,b.jsxs)(N.DialogHeader,{children:[(0,b.jsx)(N.DialogTitle,{children:"Archive Purchase Order?"}),(0,b.jsx)(N.DialogDescription,{children:"This will archive the purchase order. You can restore it from the archive within 90 days."})]}),(0,b.jsxs)(N.DialogFooter,{children:[(0,b.jsx)(F.Button,{disabled:V,onClick:()=>I(!1),variant:"outline",children:"Cancel"}),(0,b.jsx)(F.Button,{disabled:V,onClick:ay,variant:"destructive",children:V?"Archiving...":"Archive Purchase Order"})]})]})})]})}a.s(["PurchaseOrderPageContent",()=>V],792998)}];

//# sourceMappingURL=apps_web_src_components_work_purchase-order-page-content_tsx_af244682._.js.map