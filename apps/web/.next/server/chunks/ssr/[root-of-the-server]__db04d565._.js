module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},997868,a=>{a.n(a.i(884849))},592581,a=>{a.n(a.i(596565))},134005,a=>{a.n(a.i(977930))},565165,a=>{a.n(a.i(728209))},147941,a=>{a.n(a.i(484103))},304434,a=>{a.n(a.i(632684))},407521,a=>{a.n(a.i(693094))},797797,a=>{a.n(a.i(977207))},290022,a=>{a.n(a.i(362735))},729157,a=>{a.n(a.i(470009))},712363,a=>{a.n(a.i(279732))},208120,a=>{a.n(a.i(52860))},863056,a=>{a.n(a.i(77721))},468729,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call WorkDataView() from the server but WorkDataView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/work-data-view.tsx <module evaluation>","WorkDataView");a.s(["WorkDataView",0,b])},750692,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call WorkDataView() from the server but WorkDataView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/work-data-view.tsx","WorkDataView");a.s(["WorkDataView",0,b])},310669,a=>{"use strict";a.i(468729);var b=a.i(750692);a.n(b)},688258,a=>{a.n(a.i(763951))},359544,a=>{a.n(a.i(656570))},401803,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call TeamsKanban() from the server but TeamsKanban is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/teams-kanban.tsx <module evaluation>","TeamsKanban");a.s(["TeamsKanban",0,b])},992878,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call TeamsKanban() from the server but TeamsKanban is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/teams-kanban.tsx","TeamsKanban");a.s(["TeamsKanban",0,b])},442788,a=>{"use strict";a.i(401803);var b=a.i(992878);a.n(b)},334911,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call TeamsTable() from the server but TeamsTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/teams-table.tsx <module evaluation>","TeamsTable");a.s(["TeamsTable",0,b])},636689,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call TeamsTable() from the server but TeamsTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/teams-table.tsx","TeamsTable");a.s(["TeamsTable",0,b])},430824,a=>{"use strict";a.i(334911);var b=a.i(636689);a.n(b)},790004,a=>{"use strict";var b=a.i(504348),c=a.i(429969);a.i(692167);var d=a.i(852596),e=a.i(442788),f=a.i(430824),g=a.i(310669);a.i(467361);var h=a.i(445074),i=a.i(933427);let j=50,k=`
  id,
  user_id,
  company_id,
  role,
  permissions,
  department_id,
  job_title,
  status,
  invited_at,
  accepted_at,
  created_at,
  updated_at,
  emergency_contact_name,
  emergency_contact_phone,
  emergency_contact_relationship,
  employee_id,
  hire_date,
  employment_type,
  work_schedule,
  work_location,
  pay_type,
  hourly_rate,
  annual_salary,
  commission_rate,
  commission_structure,
  overtime_eligible,
  street_address,
  city,
  state,
  postal_code,
  country,
  skills,
  certifications,
  licenses,
  service_areas,
  availability_schedule,
  max_weekly_hours,
  preferred_job_types,
  performance_notes,
  last_review_date,
  next_review_date,
  notes,
  archived_at
`,l=(0,c.cache)(async(a,b=j,c="",d,e="active")=>{let f=d??await (0,h.getActiveCompanyId)();if(!f)return{teamMembers:[],totalCount:0};let g=await (0,i.createServiceSupabaseClient)();if(!g)throw Error("Supabase client not configured");let l=(Math.max(a,1)-1)*b,m=g.from("company_memberships").select(k,{count:"exact"}).eq("company_id",f).order("created_at",{ascending:!1}).range(l,l+b-1);"active"===e?m=m.eq("status","active"):"archived"===e&&(m=m.eq("status","suspended"));let n=c.trim();if(n){let a=n.replace(/,/g,"\\,"),b=`%${a}%`;m=m.or(`job_title.ilike.${b},role.ilike.${b}`)}let{data:o,error:p,count:q}=await m;if(p)throw Error(`Failed to load team members: ${p.message}`);let r=o??[],s=r.map(a=>a.user_id).filter(a=>null!==a);if(0===s.length)return{teamMembers:r.map(a=>({...a,user:null})),totalCount:q??0};let{data:t,error:u}=await g.from("profiles").select("id, email, full_name, avatar_url, phone").in("id",s);u&&console.error("Failed to fetch profiles:",u);let v=new Map((t??[]).map(a=>[a.id,a]));return{teamMembers:r.map(a=>({...a,user:a.user_id?v.get(a.user_id)??null:null})),totalCount:q??0}}),m="Team Member",n=["full_name","fullName","name","display_name","displayName","preferred_name","preferredName"],o=["first_name","firstName","given_name","givenName","first"],p=["last_name","lastName","family_name","familyName","surname","last"],q=["middle_name","middleName","middle"];function r(a){return a&&"object"==typeof a?a:null}function s(a,b){if(a)for(let c of b){let b=a[c];if("string"==typeof b){let a=b.trim();if(a)return a}}}function t(a){if(!a)return;let b=s(a,n);if(b)return b;let c=[s(a,o),s(a,q),s(a,p)].filter(Boolean);if(c.length)return c.join(" ").replace(/\s+/g," ").trim();let d=r(a.profile);if(d)return t(d)}function u(a){return a?a.raw_user_meta_data??a.user_metadata??{}:{}}function v(a){let b,c,d,e,f,g=u(a.user),h=a.role||m,i=a.department||"General",j=a.joined_at||a.invited_at,k=a.last_active_at||a.user?.last_sign_in_at;return{id:a.id,name:(c=t(b=u(a.user)),d=t(r(b.profile)),e="string"==typeof a.user?.full_name?a.user.full_name:void 0,f=a.user?.email?.split("@")[0]||a.email?.split("@")[0]||null,a.invited_name||c||d||e||f||a.invited_email||a.email||(a.role?a.role.replace(/_/g," ").replace(/\b\w/g,a=>a.toUpperCase()):void 0)||"Unknown"),email:a.user?.email||a.email||a.invited_email||"",roleId:"team-role",roleName:h,roleColor:({Owner:"#fbbf24",Administrator:"#3b82f6",Manager:"#10b981",Technician:"#6b7280"})[h||""]||"#6b7280",departmentId:"team-department",departmentName:i,departmentColor:({Sales:"#3b82f6",Operations:"#10b981",Service:"#f59e0b",Support:"#8b5cf6"})[i||""]||"#6b7280",status:a.status||"active",avatar:function(a,b){let c=s(b,["avatar_url","avatar","photoURL","photo_url"])||s(r(b.profile),["avatar_url","avatar","photoURL","photo_url"]);if(c)return c;let d=a.user?.avatar_url;return"string"==typeof d&&d.length>0?d:void 0}(a,g),jobTitle:a.job_title||("string"==typeof g.title?g.title:void 0)||m,phone:a.phone||("string"==typeof g.phone?g.phone:void 0),joinedDate:j?new Date(j).toLocaleDateString():"",lastActive:k?function(a){let b=Math.floor((new Date().getTime()-a.getTime())/6e4);if(b<1)return"Just now";if(b<60)return`${b} min ago`;let c=Math.floor(b/60);if(c<24)return`${c} hour${c>1?"s":""} ago`;let d=Math.floor(c/24);return`${d} day${d>1?"s":""} ago`}(new Date(k)):"Never",archived_at:a.archived_at}}async function w({searchParams:a}){let c=await (0,h.getActiveCompanyId)();if(!c)return(0,d.notFound)();let i=Number(a?.page)||1,k=a?.search??"",m=a?.filter??"active",n=["active","archived","all"].includes(m)?m:"active",{teamMembers:o,totalCount:p}=await l(i,j,k,c,n),q=o.map(v);return(0,b.jsx)(g.WorkDataView,{kanban:(0,b.jsx)(e.TeamsKanban,{members:q}),section:"team",table:(0,b.jsx)(f.TeamsTable,{initialArchiveFilter:n,initialSearchQuery:k,itemsPerPage:j,teamMembers:q,totalCount:p,currentPage:i})})}a.i(250202);var x=a.i(709027);function y(){return(0,b.jsx)(x.DataTableListSkeleton,{})}async function z({searchParams:a}){let d=await a;return(0,b.jsx)("div",{className:"flex h-full flex-col",children:(0,b.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(y,{}),children:(0,b.jsx)(w,{searchParams:d})})})})}a.s(["default",()=>z],790004)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__db04d565._.js.map