{"version":3,"sources":["../../../../../../apps/web/src/components/reports/analytics-charts.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/components/reports/analytics-overview.tsx","../../../../../../node_modules/.pnpm/lucide-react%400.552.0_react%4019.2.0/node_modules/lucide-react/src/icons/arrow-up-right.ts"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const AnalyticsCharts = registerClientReference(\n    function() { throw new Error(\"Attempted to call AnalyticsCharts() from the server but AnalyticsCharts is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/components/reports/analytics-charts.tsx\",\n    \"AnalyticsCharts\",\n);\n","/**\n * Analytics Overview Dashboard - Server Component\n *\n * Main dashboard showing real-time KPIs, trends, and quick insights.\n * Uses React.cache() for deduplication and Suspense for streaming.\n */\n\nimport {\n\tAlertTriangle,\n\tArrowDownRight,\n\tArrowUpRight,\n\tBriefcase,\n\tCalendar,\n\tCheckCircle2,\n\tClock,\n\tDollarSign,\n\tMessageSquare,\n\tReceipt,\n\tTarget,\n\tTrendingDown,\n\tTrendingUp,\n\tUsers,\n} from \"lucide-react\";\nimport Link from \"next/link\";\nimport { Suspense } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport {\n\tCard,\n\tCardContent,\n\tCardDescription,\n\tCardHeader,\n\tCardTitle,\n} from \"@/components/ui/card\";\nimport { Progress } from \"@/components/ui/progress\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { getActiveCompanyId } from \"@/lib/auth/company-context\";\nimport {\n\tgetAnalyticsTrends,\n\tgetCustomerHealthDistribution,\n\tgetEstimateConversionFunnel,\n\tgetInvoiceAgingSummary,\n\tgetKPISummary,\n} from \"@/lib/queries/analytics\";\nimport { AnalyticsCharts } from \"./analytics-charts\";\n\n// Formatters\nfunction formatCurrency(amount: number): string {\n\tif (amount >= 1000000) {\n\t\treturn `$${(amount / 1000000).toFixed(1)}M`;\n\t}\n\tif (amount >= 1000) {\n\t\treturn `$${(amount / 1000).toFixed(1)}K`;\n\t}\n\treturn new Intl.NumberFormat(\"en-US\", {\n\t\tstyle: \"currency\",\n\t\tcurrency: \"USD\",\n\t\tminimumFractionDigits: 0,\n\t\tmaximumFractionDigits: 0,\n\t}).format(amount);\n}\n\nfunction formatPercent(value: number | null): string {\n\tif (value === null) return \"—\";\n\treturn `${value.toFixed(1)}%`;\n}\n\nfunction formatNumber(value: number): string {\n\tif (value >= 1000000) {\n\t\treturn `${(value / 1000000).toFixed(1)}M`;\n\t}\n\tif (value >= 1000) {\n\t\treturn `${(value / 1000).toFixed(1)}K`;\n\t}\n\treturn value.toLocaleString();\n}\n\n// KPI Card Component\nfunction KPICard({\n\ttitle,\n\tvalue,\n\tsubtitle,\n\ticon,\n\ttrend,\n\ttrendValue,\n\thref,\n}: {\n\ttitle: string;\n\tvalue: string;\n\tsubtitle?: string;\n\ticon: React.ReactNode;\n\ttrend?: \"up\" | \"down\" | \"neutral\";\n\ttrendValue?: string;\n\thref?: string;\n}) {\n\tconst content = (\n\t\t<Card className=\"relative overflow-hidden transition-all hover:shadow-md\">\n\t\t\t<CardHeader className=\"flex flex-row items-center justify-between space-y-0 pb-2\">\n\t\t\t\t<CardTitle className=\"text-xs md:text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t{title}\n\t\t\t\t</CardTitle>\n\t\t\t\t<div className=\"rounded-md bg-primary/10 p-2 text-primary\">{icon}</div>\n\t\t\t</CardHeader>\n\t\t\t<CardContent>\n\t\t\t\t<div className=\"text-xl md:text-2xl font-bold\">{value}</div>\n\t\t\t\t<div className=\"mt-1 flex items-center gap-2\">\n\t\t\t\t\t{trend && trendValue && (\n\t\t\t\t\t\t<span\n\t\t\t\t\t\t\tclassName={`flex items-center text-xs font-medium ${\n\t\t\t\t\t\t\t\ttrend === \"up\"\n\t\t\t\t\t\t\t\t\t? \"text-green-600\"\n\t\t\t\t\t\t\t\t\t: trend === \"down\"\n\t\t\t\t\t\t\t\t\t\t? \"text-red-600\"\n\t\t\t\t\t\t\t\t\t\t: \"text-muted-foreground\"\n\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{trend === \"up\" ? (\n\t\t\t\t\t\t\t\t<ArrowUpRight className=\"mr-0.5 h-3 w-3\" />\n\t\t\t\t\t\t\t) : trend === \"down\" ? (\n\t\t\t\t\t\t\t\t<ArrowDownRight className=\"mr-0.5 h-3 w-3\" />\n\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t{trendValue}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t\t{subtitle && (\n\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground\">{subtitle}</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</CardContent>\n\t\t</Card>\n\t);\n\n\tif (href) {\n\t\treturn (\n\t\t\t<Link href={href} className=\"block\">\n\t\t\t\t{content}\n\t\t\t</Link>\n\t\t);\n\t}\n\n\treturn content;\n}\n\n// Quick Stat Card for smaller metrics\nfunction QuickStatCard({\n\tlabel,\n\tvalue,\n\tcolor = \"blue\",\n}: {\n\tlabel: string;\n\tvalue: string | number;\n\tcolor?: \"blue\" | \"green\" | \"yellow\" | \"red\" | \"purple\";\n}) {\n\tconst colorClasses = {\n\t\tblue: \"bg-blue-500/10 text-blue-600\",\n\t\tgreen: \"bg-green-500/10 text-green-600\",\n\t\tyellow: \"bg-yellow-500/10 text-yellow-600\",\n\t\tred: \"bg-red-500/10 text-red-600\",\n\t\tpurple: \"bg-purple-500/10 text-purple-600\",\n\t};\n\n\treturn (\n\t\t<div className=\"rounded-lg border bg-card/50 p-3 md:p-4\">\n\t\t\t<div className=\"text-xs font-medium text-muted-foreground\">{label}</div>\n\t\t\t<div\n\t\t\t\tclassName={`mt-1 text-lg md:text-xl font-bold ${colorClasses[color].split(\" \")[1]}`}\n\t\t\t>\n\t\t\t\t{value}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n\n// Report Link Card\nfunction ReportLinkCard({\n\ttitle,\n\tdescription,\n\thref,\n\ticon,\n\tbadge,\n}: {\n\ttitle: string;\n\tdescription: string;\n\thref: string;\n\ticon: React.ReactNode;\n\tbadge?: string;\n}) {\n\treturn (\n\t\t<Link href={href} className=\"block group\">\n\t\t\t<Card className=\"h-full transition-all hover:border-primary/50 hover:shadow-sm group-hover:bg-muted/30\">\n\t\t\t\t<CardHeader className=\"pb-2\">\n\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t<div className=\"rounded-md bg-primary/10 p-2 text-primary\">\n\t\t\t\t\t\t\t{icon}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{badge && (\n\t\t\t\t\t\t\t<Badge variant=\"secondary\" className=\"text-xs\">\n\t\t\t\t\t\t\t\t{badge}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</CardHeader>\n\t\t\t\t<CardContent>\n\t\t\t\t\t<CardTitle className=\"text-base group-hover:text-primary\">\n\t\t\t\t\t\t{title}\n\t\t\t\t\t</CardTitle>\n\t\t\t\t\t<CardDescription className=\"mt-1 text-xs\">\n\t\t\t\t\t\t{description}\n\t\t\t\t\t</CardDescription>\n\t\t\t\t</CardContent>\n\t\t\t</Card>\n\t\t</Link>\n\t);\n}\n\n// Main Analytics Overview Component\nexport async function AnalyticsOverview() {\n\tconst companyId = await getActiveCompanyId();\n\n\tif (!companyId) {\n\t\treturn (\n\t\t\t<div className=\"flex min-h-[400px] items-center justify-center\">\n\t\t\t\t<p className=\"text-muted-foreground\">\n\t\t\t\t\tPlease select a company to view analytics\n\t\t\t\t</p>\n\t\t\t</div>\n\t\t);\n\t}\n\n\t// Fetch all data in parallel\n\tconst [trends, kpis, customerHealth, estimateFunnel, invoiceAging] =\n\t\tawait Promise.all([\n\t\t\tgetAnalyticsTrends(companyId, 30),\n\t\t\tgetKPISummary(companyId),\n\t\t\tgetCustomerHealthDistribution(companyId),\n\t\t\tgetEstimateConversionFunnel(companyId, 30),\n\t\t\tgetInvoiceAgingSummary(companyId),\n\t\t]);\n\n\t// Calculate totals from trends\n\tconst totalRevenue = trends.revenue.reduce((sum, day) => sum + day.value, 0);\n\tconst totalJobs = trends.jobs.reduce((sum, day) => sum + day.value, 0);\n\tconst totalComms = trends.communications.reduce(\n\t\t(sum, day) => sum + day.value + (day.value2 || 0),\n\t\t0,\n\t);\n\n\t// Calculate previous period for comparison (simple approximation)\n\tconst halfwayPoint = Math.floor(trends.revenue.length / 2);\n\tconst currentPeriodRevenue = trends.revenue\n\t\t.slice(halfwayPoint)\n\t\t.reduce((sum, day) => sum + day.value, 0);\n\tconst previousPeriodRevenue = trends.revenue\n\t\t.slice(0, halfwayPoint)\n\t\t.reduce((sum, day) => sum + day.value, 0);\n\tconst revenueChange =\n\t\tpreviousPeriodRevenue > 0\n\t\t\t? ((currentPeriodRevenue - previousPeriodRevenue) /\n\t\t\t\t\tpreviousPeriodRevenue) *\n\t\t\t\t100\n\t\t\t: 0;\n\n\tconst currentPeriodJobs = trends.jobs\n\t\t.slice(halfwayPoint)\n\t\t.reduce((sum, day) => sum + day.value, 0);\n\tconst previousPeriodJobs = trends.jobs\n\t\t.slice(0, halfwayPoint)\n\t\t.reduce((sum, day) => sum + day.value, 0);\n\tconst jobsChange =\n\t\tpreviousPeriodJobs > 0\n\t\t\t? ((currentPeriodJobs - previousPeriodJobs) / previousPeriodJobs) * 100\n\t\t\t: 0;\n\n\t// Customer health totals\n\tconst totalCustomers =\n\t\tcustomerHealth.low +\n\t\tcustomerHealth.medium +\n\t\tcustomerHealth.high +\n\t\tcustomerHealth.unknown;\n\n\treturn (\n\t\t<div className=\"flex w-full flex-col gap-4 p-4 md:p-6\">\n\t\t\t{/* Primary KPIs */}\n\t\t\t<div className=\"grid gap-3 md:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n\t\t\t\t<KPICard\n\t\t\t\t\ttitle=\"Total Revenue\"\n\t\t\t\t\tvalue={formatCurrency(totalRevenue)}\n\t\t\t\t\tsubtitle=\"Last 30 days\"\n\t\t\t\t\ticon={<DollarSign className=\"h-4 w-4\" />}\n\t\t\t\t\ttrend={revenueChange >= 0 ? \"up\" : \"down\"}\n\t\t\t\t\ttrendValue={`${Math.abs(revenueChange).toFixed(1)}%`}\n\t\t\t\t\thref=\"/dashboard/reports/financial\"\n\t\t\t\t/>\n\t\t\t\t<KPICard\n\t\t\t\t\ttitle=\"Jobs Completed\"\n\t\t\t\t\tvalue={formatNumber(totalJobs)}\n\t\t\t\t\tsubtitle=\"Last 30 days\"\n\t\t\t\t\ticon={<Briefcase className=\"h-4 w-4\" />}\n\t\t\t\t\ttrend={jobsChange >= 0 ? \"up\" : \"down\"}\n\t\t\t\t\ttrendValue={`${Math.abs(jobsChange).toFixed(1)}%`}\n\t\t\t\t\thref=\"/dashboard/reports/jobs\"\n\t\t\t\t/>\n\t\t\t\t<KPICard\n\t\t\t\t\ttitle=\"Active Customers\"\n\t\t\t\t\tvalue={formatNumber(totalCustomers)}\n\t\t\t\t\tsubtitle={`${customerHealth.low} healthy`}\n\t\t\t\t\ticon={<Users className=\"h-4 w-4\" />}\n\t\t\t\t\thref=\"/dashboard/reports/customers\"\n\t\t\t\t/>\n\t\t\t\t<KPICard\n\t\t\t\t\ttitle=\"Communications\"\n\t\t\t\t\tvalue={formatNumber(totalComms)}\n\t\t\t\t\tsubtitle=\"Last 30 days\"\n\t\t\t\t\ticon={<MessageSquare className=\"h-4 w-4\" />}\n\t\t\t\t/>\n\t\t\t</div>\n\n\t\t\t{/* Charts Section */}\n\t\t\t<Suspense fallback={<ChartsSkeleton />}>\n\t\t\t\t<AnalyticsCharts trends={trends} />\n\t\t\t</Suspense>\n\n\t\t\t{/* Secondary Metrics Row */}\n\t\t\t<div className=\"grid gap-3 md:gap-4 grid-cols-1 md:grid-cols-2 lg:grid-cols-3\">\n\t\t\t\t{/* Estimate Conversion */}\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-2\">\n\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2 text-base\">\n\t\t\t\t\t\t\t<Target className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\tEstimate Conversion\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t\t<CardDescription>Last 30 days</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"mb-4 flex items-baseline gap-2\">\n\t\t\t\t\t\t\t<span className=\"text-3xl font-bold\">\n\t\t\t\t\t\t\t\t{formatPercent(estimateFunnel.conversionRate)}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\tvariant={\n\t\t\t\t\t\t\t\t\testimateFunnel.conversionRate >= 50 ? \"default\" : \"secondary\"\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{estimateFunnel.won} won\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<div className=\"flex justify-between text-sm\">\n\t\t\t\t\t\t\t\t<span className=\"text-muted-foreground\">Total Sent</span>\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">{estimateFunnel.total}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Progress value={estimateFunnel.conversionRate} className=\"h-2\" />\n\t\t\t\t\t\t\t<div className=\"flex justify-between text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t<span>Won: {estimateFunnel.won}</span>\n\t\t\t\t\t\t\t\t<span>Pending: {estimateFunnel.pending}</span>\n\t\t\t\t\t\t\t\t<span>Lost: {estimateFunnel.lost}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t{/* Customer Health */}\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-2\">\n\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2 text-base\">\n\t\t\t\t\t\t\t<Users className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\tCustomer Health\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t\t<CardDescription>Churn risk distribution</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<div className=\"h-3 w-3 rounded-full bg-green-500\" />\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm\">Low Risk</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">{customerHealth.low}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Progress\n\t\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t\ttotalCustomers > 0\n\t\t\t\t\t\t\t\t\t\t? (customerHealth.low / totalCustomers) * 100\n\t\t\t\t\t\t\t\t\t\t: 0\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName=\"h-2 [&>div]:bg-green-500\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<div className=\"h-3 w-3 rounded-full bg-yellow-500\" />\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm\">Medium Risk</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">{customerHealth.medium}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Progress\n\t\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t\ttotalCustomers > 0\n\t\t\t\t\t\t\t\t\t\t? (customerHealth.medium / totalCustomers) * 100\n\t\t\t\t\t\t\t\t\t\t: 0\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName=\"h-2 [&>div]:bg-yellow-500\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<div className=\"h-3 w-3 rounded-full bg-red-500\" />\n\t\t\t\t\t\t\t\t\t<span className=\"text-sm\">High Risk</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<span className=\"font-medium\">{customerHealth.high}</span>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<Progress\n\t\t\t\t\t\t\t\tvalue={\n\t\t\t\t\t\t\t\t\ttotalCustomers > 0\n\t\t\t\t\t\t\t\t\t\t? (customerHealth.high / totalCustomers) * 100\n\t\t\t\t\t\t\t\t\t\t: 0\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tclassName=\"h-2 [&>div]:bg-red-500\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\n\t\t\t\t{/* KPI Highlights */}\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader className=\"pb-2\">\n\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2 text-base\">\n\t\t\t\t\t\t\t<CheckCircle2 className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\tPerformance KPIs\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t\t<CardDescription>Team metrics</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tFirst Time Fix Rate\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\tvariant={\n\t\t\t\t\t\t\t\t\t\tkpis.firstTimeFixRate && kpis.firstTimeFixRate >= 85\n\t\t\t\t\t\t\t\t\t\t\t? \"default\"\n\t\t\t\t\t\t\t\t\t\t\t: \"secondary\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{formatPercent(kpis.firstTimeFixRate)}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tUtilization Rate\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\tvariant={\n\t\t\t\t\t\t\t\t\t\tkpis.utilizationRate && kpis.utilizationRate >= 75\n\t\t\t\t\t\t\t\t\t\t\t? \"default\"\n\t\t\t\t\t\t\t\t\t\t\t: \"secondary\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{formatPercent(kpis.utilizationRate)}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tOn-Time Rate\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\tvariant={\n\t\t\t\t\t\t\t\t\t\tkpis.onTimeRate && kpis.onTimeRate >= 90\n\t\t\t\t\t\t\t\t\t\t\t? \"default\"\n\t\t\t\t\t\t\t\t\t\t\t: \"secondary\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{formatPercent(kpis.onTimeRate)}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t\t\t\t<span className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tAvg Customer Rating\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\tvariant={\n\t\t\t\t\t\t\t\t\t\tkpis.avgCustomerRating && kpis.avgCustomerRating >= 4.5\n\t\t\t\t\t\t\t\t\t\t\t? \"default\"\n\t\t\t\t\t\t\t\t\t\t\t: \"secondary\"\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{kpis.avgCustomerRating\n\t\t\t\t\t\t\t\t\t\t? `${kpis.avgCustomerRating.toFixed(1)} ★`\n\t\t\t\t\t\t\t\t\t\t: \"—\"}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t</div>\n\n\t\t\t{/* Quick Access Reports */}\n\t\t\t<div>\n\t\t\t\t<h3 className=\"mb-3 md:mb-4 text-base md:text-lg font-semibold\">\n\t\t\t\t\tQuick Access Reports\n\t\t\t\t</h3>\n\t\t\t\t<div className=\"grid gap-3 md:gap-4 grid-cols-1 sm:grid-cols-2 lg:grid-cols-4\">\n\t\t\t\t\t<ReportLinkCard\n\t\t\t\t\t\ttitle=\"Financial Reports\"\n\t\t\t\t\t\tdescription=\"P&L, cash flow, AR aging, and revenue analysis\"\n\t\t\t\t\t\thref=\"/dashboard/reports/financial\"\n\t\t\t\t\t\ticon={<DollarSign className=\"h-5 w-5\" />}\n\t\t\t\t\t\tbadge=\"12 reports\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ReportLinkCard\n\t\t\t\t\t\ttitle=\"Job Performance\"\n\t\t\t\t\t\tdescription=\"Completion rates, efficiency, and profitability\"\n\t\t\t\t\t\thref=\"/dashboard/reports/jobs\"\n\t\t\t\t\t\ticon={<Briefcase className=\"h-5 w-5\" />}\n\t\t\t\t\t\tbadge=\"10 reports\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ReportLinkCard\n\t\t\t\t\t\ttitle=\"Team Leaderboard\"\n\t\t\t\t\t\tdescription=\"Technician rankings and performance metrics\"\n\t\t\t\t\t\thref=\"/dashboard/reports/technicians\"\n\t\t\t\t\t\ticon={<Users className=\"h-5 w-5\" />}\n\t\t\t\t\t\tbadge=\"8 reports\"\n\t\t\t\t\t/>\n\t\t\t\t\t<ReportLinkCard\n\t\t\t\t\t\ttitle=\"Customer Analytics\"\n\t\t\t\t\t\tdescription=\"Retention, LTV, acquisition, and segments\"\n\t\t\t\t\t\thref=\"/dashboard/reports/customers\"\n\t\t\t\t\t\ticon={<Target className=\"h-5 w-5\" />}\n\t\t\t\t\t\tbadge=\"9 reports\"\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Invoice Aging Summary */}\n\t\t\t{invoiceAging && (\n\t\t\t\t<Card>\n\t\t\t\t\t<CardHeader>\n\t\t\t\t\t\t<CardTitle className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t<Receipt className=\"h-5 w-5 text-primary\" />\n\t\t\t\t\t\t\tAccounts Receivable Aging\n\t\t\t\t\t\t</CardTitle>\n\t\t\t\t\t\t<CardDescription>Outstanding invoice breakdown</CardDescription>\n\t\t\t\t\t</CardHeader>\n\t\t\t\t\t<CardContent>\n\t\t\t\t\t\t<div className=\"grid gap-3 md:gap-4 grid-cols-2 sm:grid-cols-3 md:grid-cols-5\">\n\t\t\t\t\t\t\t<QuickStatCard\n\t\t\t\t\t\t\t\tlabel=\"Current\"\n\t\t\t\t\t\t\t\tvalue={formatCurrency(invoiceAging.current?.amount || 0)}\n\t\t\t\t\t\t\t\tcolor=\"green\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<QuickStatCard\n\t\t\t\t\t\t\t\tlabel=\"1-30 Days\"\n\t\t\t\t\t\t\t\tvalue={formatCurrency(invoiceAging[\"1-30\"]?.amount || 0)}\n\t\t\t\t\t\t\t\tcolor=\"blue\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<QuickStatCard\n\t\t\t\t\t\t\t\tlabel=\"31-60 Days\"\n\t\t\t\t\t\t\t\tvalue={formatCurrency(invoiceAging[\"31-60\"]?.amount || 0)}\n\t\t\t\t\t\t\t\tcolor=\"yellow\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<QuickStatCard\n\t\t\t\t\t\t\t\tlabel=\"61-90 Days\"\n\t\t\t\t\t\t\t\tvalue={formatCurrency(invoiceAging[\"61-90\"]?.amount || 0)}\n\t\t\t\t\t\t\t\tcolor=\"yellow\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<QuickStatCard\n\t\t\t\t\t\t\t\tlabel=\"90+ Days\"\n\t\t\t\t\t\t\t\tvalue={formatCurrency(invoiceAging[\"90+\"]?.amount || 0)}\n\t\t\t\t\t\t\t\tcolor=\"red\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</CardContent>\n\t\t\t\t</Card>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n\n// Skeleton for charts loading\nfunction ChartsSkeleton() {\n\treturn (\n\t\t<Card>\n\t\t\t<CardHeader>\n\t\t\t\t<Skeleton className=\"h-6 w-48\" />\n\t\t\t\t<Skeleton className=\"h-4 w-32\" />\n\t\t\t</CardHeader>\n\t\t\t<CardContent>\n\t\t\t\t<Skeleton className=\"h-[300px] w-full\" />\n\t\t\t</CardContent>\n\t\t</Card>\n\t);\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'M7 7h10v10', key: '1tivn9' }],\n  ['path', { d: 'M7 17 17 7', key: '1vkiza' }],\n];\n\n/**\n * @component @name ArrowUpRight\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNNyA3aDEwdjEwIiAvPgogIDxwYXRoIGQ9Ik03IDE3IDE3IDciIC8+Cjwvc3ZnPgo=) - https://lucide.dev/icons/arrow-up-right\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowUpRight = createLucideIcon('arrow-up-right', __iconNode);\n\nexport default ArrowUpRight;\n"],"names":[],"mappings":"wCAEO,IAAM,EAAkB,CAAA,EAAA,AAD/B,EAAA,CAAA,CAAA,QAC+B,uBAAA,AAAuB,EAClD,WAAa,MAAM,AAAI,MAAM,4OAA8O,EAC3Q,qFACA,yEAHG,IAAM,EAAkB,CAAA,EAD/B,AAC+B,EAD/B,CAAA,CAAA,QAC+B,uBAAA,AAAuB,EAClD,WAAa,MAAM,AAAI,MAAM,4OAA8O,EAC3Q,iEACA,mJCEJ,EAAA,CAAA,CAAA,OCYM,CAAA,EAAe,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,IAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAhBF,CAClC,AAesD,CAfrD,AAeqD,CAfrD,AAeqD,CAfrD,AAeqD,CAAA,AAfrD,CAAA,AAeqD,CAfrD,AAeqD,CAfrD,AAeqD,CAfrD,AAAQ,AAe6C,CAf7C,AAAE,AAe2C,CAAU,CAflD,AAekD,CAflD,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAc,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CAC3C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAQ,CAAA,AAAE,EAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAc,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CAC7C,EDCA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAgBA,EAAA,CAAA,CAAA,MACA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QAOA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,QAAA,EAAA,CAAA,CAAA,QACA,EAAA,CAAA,CAAA,OAOA,EAAA,CAAA,CAAA","ignoreList":[0,2]}