{"version":3,"sources":["../../../../../../apps/web/src/components/work/estimates-kanban.tsx","../../../../../../apps/web/src/components/work/estimates-table.tsx","../../../../../../apps/web/src/components/ui/table-filters.tsx"],"sourcesContent":["\"use client\";\n\nimport { ArrowUpRight, CalendarDays, ClipboardList } from \"lucide-react\";\nimport Link from \"next/link\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { type ColumnMeta, EntityKanban } from \"@/components/ui/entity-kanban\";\nimport type { KanbanItemBase } from \"@/components/ui/shadcn-io/kanban\";\nimport type { Estimate } from \"@/components/work/estimates-table\";\nimport { cn } from \"@/lib/utils\";\n\ntype EstimateStatus = Estimate[\"status\"];\n\ntype EstimatesKanbanItem = KanbanItemBase & {\n\testimate: Estimate;\n};\n\nconst ESTIMATE_COLUMNS: Array<{\n\tid: EstimateStatus;\n\tname: string;\n\taccentColor: string;\n}> = [\n\t{ id: \"draft\", name: \"Draft\", accentColor: \"#6B7280\" },\n\t{ id: \"sent\", name: \"Sent\", accentColor: \"#2563EB\" },\n\t{ id: \"accepted\", name: \"Accepted\", accentColor: \"#22C55E\" },\n\t{ id: \"declined\", name: \"Declined\", accentColor: \"#EF4444\" },\n];\n\nconst columnLabel = new Map(\n\tESTIMATE_COLUMNS.map((column) => [column.id, column.name]),\n);\n\nconst currencyFormatter = new Intl.NumberFormat(\"en-US\", {\n\tstyle: \"currency\",\n\tcurrency: \"USD\",\n});\n\nexport function EstimatesKanban({ estimates }: { estimates: Estimate[] }) {\n\treturn (\n\t\t<EntityKanban<Estimate, EstimateStatus>\n\t\t\tcalculateColumnMeta={(columnId, items): ColumnMeta => {\n\t\t\t\tconst columnItems = items.filter((item) => item.columnId === columnId);\n\t\t\t\tconst total = columnItems.reduce(\n\t\t\t\t\t(sum, item) => sum + (item.entity as Estimate).amount,\n\t\t\t\t\t0,\n\t\t\t\t);\n\t\t\t\treturn { count: columnItems.length, total };\n\t\t\t}}\n\t\t\tcolumns={ESTIMATE_COLUMNS}\n\t\t\tdata={estimates}\n\t\t\tentityName=\"estimates\"\n\t\t\tformatTotal={(total) => currencyFormatter.format(total / 100)}\n\t\t\tmapToKanbanItem={(estimate) => ({\n\t\t\t\tid: estimate.id,\n\t\t\t\tcolumnId: estimate.status,\n\t\t\t\tentity: estimate,\n\t\t\t\testimate,\n\t\t\t})}\n\t\t\trenderCard={(item) => (\n\t\t\t\t<EstimateCard\n\t\t\t\t\titem={{ ...item, estimate: item.entity } as EstimatesKanbanItem}\n\t\t\t\t/>\n\t\t\t)}\n\t\t\trenderDragOverlay={(item) => (\n\t\t\t\t<div className=\"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg\">\n\t\t\t\t\t<EstimateCard\n\t\t\t\t\t\titem={{ ...item, estimate: item.entity } as EstimatesKanbanItem}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\t\t\t)}\n\t\t\tshowTotals={true}\n\t\t\tupdateEntityStatus={(estimate, newStatus) => ({\n\t\t\t\t...estimate,\n\t\t\t\tstatus: newStatus,\n\t\t\t})}\n\t\t/>\n\t);\n}\n\nfunction EstimateCard({ item }: { item: EstimatesKanbanItem }) {\n\tconst { estimate, columnId } = item;\n\treturn (\n\t\t<div className=\"space-y-3\">\n\t\t\t<div className=\"flex items-start justify-between gap-3\">\n\t\t\t\t<div className=\"space-y-1\">\n\t\t\t\t\t<p className=\"text-muted-foreground text-xs font-semibold tracking-wide uppercase\">\n\t\t\t\t\t\t{estimate.estimateNumber}\n\t\t\t\t\t</p>\n\t\t\t\t\t<h3 className=\"text-foreground text-sm font-semibold\">\n\t\t\t\t\t\t{estimate.project}\n\t\t\t\t\t</h3>\n\t\t\t\t\t<div className=\"flex flex-wrap items-center gap-2\">\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"text-xs\",\n\t\t\t\t\t\t\t\tcolumnId === \"declined\" && \"bg-destructive/10 text-destructive\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tvariant={columnId === \"declined\" ? \"destructive\" : \"secondary\"}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{columnLabel.get(columnId as EstimateStatus) ?? columnId}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\tclassName=\"bg-muted/60 text-muted-foreground\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{currencyFormatter.format(estimate.amount / 100)}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"text-muted-foreground space-y-2 text-xs\">\n\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t<ClipboardList className=\"text-primary size-4\" />\n\t\t\t\t\t<span className=\"text-foreground font-medium\">\n\t\t\t\t\t\t{estimate.customer}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t<CalendarDays className=\"text-primary size-4\" />\n\t\t\t\t\t<span>\n\t\t\t\t\t\t{estimate.date} â†’ {estimate.validUntil}\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"text-muted-foreground flex items-center justify-between pt-2 text-xs\">\n\t\t\t\t<span>Valid until {estimate.validUntil}</span>\n\t\t\t\t<Button\n\t\t\t\t\tasChild\n\t\t\t\t\tclassName=\"text-primary gap-1 text-xs\"\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t>\n\t\t\t\t\t<Link href={`/dashboard/work/estimates/${estimate.id}`}>\n\t\t\t\t\t\tView\n\t\t\t\t\t\t<ArrowUpRight className=\"size-3.5\" />\n\t\t\t\t\t</Link>\n\t\t\t\t</Button>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport {\n\tArchive,\n\tDownload,\n\tFileText,\n\tMoreHorizontal,\n\tSend,\n} from \"lucide-react\";\nimport Link from \"next/link\";\nimport { useMemo, useState } from \"react\";\nimport {\n\tAlertDialog,\n\tAlertDialogAction,\n\tAlertDialogCancel,\n\tAlertDialogContent,\n\tAlertDialogDescription,\n\tAlertDialogFooter,\n\tAlertDialogHeader,\n\tAlertDialogTitle,\n} from \"@/components/ui/alert-dialog\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n\tDropdownMenu,\n\tDropdownMenuContent,\n\tDropdownMenuItem,\n\tDropdownMenuLabel,\n\tDropdownMenuSeparator,\n\tDropdownMenuTrigger,\n} from \"@/components/ui/dropdown-menu\";\nimport {\n\ttype BulkAction,\n\ttype ColumnDef,\n\tFullWidthDataTable,\n} from \"@/components/ui/full-width-datatable\";\nimport { EstimateStatusBadge } from \"@/components/ui/status-badge\";\nimport {\n\tClearFiltersButton,\n\ttype FilterGroup,\n\tTableFilters,\n} from \"@/components/ui/table-filters\";\nimport { formatCurrency } from \"@/lib/formatters\";\n\nexport type Estimate = {\n\tid: string;\n\testimateNumber: string;\n\tcustomer: string;\n\tproject: string;\n\tdate: string;\n\tvalidUntil: string;\n\tamount: number;\n\tstatus: \"accepted\" | \"sent\" | \"draft\" | \"declined\" | \"expired\";\n\tarchived_at?: string | null;\n\tdeleted_at?: string | null;\n};\n\ntype EstimatesTableProps = {\n\testimates: Estimate[];\n\titemsPerPage?: number;\n\ttotalCount?: number;\n\tcurrentPage?: number;\n};\n\nexport function EstimatesTable({\n\testimates,\n\titemsPerPage = 50,\n\ttotalCount,\n\tcurrentPage = 1,\n}: EstimatesTableProps) {\n\t// Filter state\n\tconst [activeFilters, setActiveFilters] = useState<Record<string, string>>({\n\t\tStatus: \"all\",\n\t\tArchive: \"active\",\n\t});\n\n\tconst [isSingleArchiveOpen, setIsSingleArchiveOpen] = useState(false);\n\tconst [isBulkArchiveOpen, setIsBulkArchiveOpen] = useState(false);\n\tconst [isBulkSendDialogOpen, setIsBulkSendDialogOpen] = useState(false);\n\tconst [estimateToArchive, setEstimateToArchive] = useState<string | null>(\n\t\tnull,\n\t);\n\tconst [selectedEstimateIds, setSelectedEstimateIds] = useState<Set<string>>(\n\t\tnew Set(),\n\t);\n\tconst [pendingSendIds, setPendingSendIds] = useState<Set<string>>(new Set());\n\n\t// Count estimates by status\n\tconst statusCounts = useMemo(() => {\n\t\tconst counts = {\n\t\t\tall: estimates.length,\n\t\t\tdraft: 0,\n\t\t\tsent: 0,\n\t\t\taccepted: 0,\n\t\t\tdeclined: 0,\n\t\t\texpired: 0,\n\t\t};\n\n\t\tfor (const estimate of estimates) {\n\t\t\tif (estimate.status === \"draft\") {\n\t\t\t\tcounts.draft++;\n\t\t\t} else if (estimate.status === \"sent\") {\n\t\t\t\tcounts.sent++;\n\t\t\t} else if (estimate.status === \"accepted\") {\n\t\t\t\tcounts.accepted++;\n\t\t\t} else if (estimate.status === \"declined\") {\n\t\t\t\tcounts.declined++;\n\t\t\t} else if (estimate.status === \"expired\") {\n\t\t\t\tcounts.expired++;\n\t\t\t}\n\t\t}\n\n\t\treturn counts;\n\t}, [estimates]);\n\n\t// Count by archive status\n\tconst archiveCounts = useMemo(() => {\n\t\tlet active = 0;\n\t\tlet archived = 0;\n\n\t\tfor (const estimate of estimates) {\n\t\t\tconst isArchived = Boolean(estimate.archived_at || estimate.deleted_at);\n\t\t\tif (isArchived) {\n\t\t\t\tarchived++;\n\t\t\t} else {\n\t\t\t\tactive++;\n\t\t\t}\n\t\t}\n\n\t\treturn { all: estimates.length, active, archived };\n\t}, [estimates]);\n\n\t// Define filter groups\n\tconst filterGroups: FilterGroup[] = [\n\t\t{\n\t\t\tlabel: \"Status\",\n\t\t\toptions: [\n\t\t\t\t{ label: \"All Statuses\", value: \"all\", count: statusCounts.all },\n\t\t\t\t{ label: \"Draft\", value: \"draft\", count: statusCounts.draft },\n\t\t\t\t{ label: \"Sent\", value: \"sent\", count: statusCounts.sent },\n\t\t\t\t{ label: \"Accepted\", value: \"accepted\", count: statusCounts.accepted },\n\t\t\t\t{ label: \"Declined\", value: \"declined\", count: statusCounts.declined },\n\t\t\t\t{ label: \"Expired\", value: \"expired\", count: statusCounts.expired },\n\t\t\t],\n\t\t},\n\t\t{\n\t\t\tlabel: \"Archive\",\n\t\t\toptions: [\n\t\t\t\t{ label: \"Active Only\", value: \"active\", count: archiveCounts.active },\n\t\t\t\t{ label: \"All Estimates\", value: \"all\", count: archiveCounts.all },\n\t\t\t\t{\n\t\t\t\t\tlabel: \"Archived Only\",\n\t\t\t\t\tvalue: \"archived\",\n\t\t\t\t\tcount: archiveCounts.archived,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t];\n\n\t// Filter estimates based on active filters\n\tconst filteredEstimates = useMemo(() => {\n\t\treturn estimates.filter((estimate) => {\n\t\t\t// Filter by status\n\t\t\tconst statusFilter = activeFilters.Status;\n\t\t\tif (statusFilter !== \"all\" && estimate.status !== statusFilter) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Filter by archive status\n\t\t\tconst archiveFilter = activeFilters.Archive;\n\t\t\tconst isArchived = Boolean(estimate.archived_at || estimate.deleted_at);\n\t\t\tif (archiveFilter === \"active\" && isArchived) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (archiveFilter === \"archived\" && !isArchived) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn true;\n\t\t});\n\t}, [estimates, activeFilters]);\n\n\t// Handle filter changes\n\tconst handleFilterChange = (filterGroup: string, value: string) => {\n\t\tsetActiveFilters((prev) => ({ ...prev, [filterGroup]: value }));\n\t};\n\n\t// Clear all filters\n\tconst handleClearFilters = () => {\n\t\tsetActiveFilters({\n\t\t\tStatus: \"all\",\n\t\t\tArchive: \"active\",\n\t\t});\n\t};\n\n\t// Count active filters (excluding defaults)\n\tconst activeFilterCount =\n\t\t(activeFilters.Status !== \"all\" ? 1 : 0) +\n\t\t(activeFilters.Archive !== \"active\" ? 1 : 0);\n\n\tconst columns: ColumnDef<Estimate>[] = [\n\t\t{\n\t\t\tkey: \"estimateNumber\",\n\t\t\theader: \"Estimate #\",\n\t\t\twidth: \"w-36\",\n\t\t\tshrink: true,\n\t\t\tsortable: true,\n\t\t\thideable: false,\n\t\t\tsortFn: (a, b) => a.estimateNumber.localeCompare(b.estimateNumber),\n\t\t\trender: (estimate) => (\n\t\t\t\t<Link\n\t\t\t\t\tclassName=\"text-foreground hover:text-primary text-sm font-medium transition-colors hover:underline\"\n\t\t\t\t\thref={`/dashboard/work/estimates/${estimate.id}`}\n\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t>\n\t\t\t\t\t{estimate.estimateNumber}\n\t\t\t\t</Link>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tkey: \"customer\",\n\t\t\theader: \"Customer\",\n\t\t\twidth: \"w-48\",\n\t\t\tshrink: true,\n\t\t\tsortable: true,\n\t\t\thideable: false, // CRITICAL: Always show customer for quick identification\n\t\t\tsortFn: (a, b) => a.customer.localeCompare(b.customer),\n\t\t\trender: (estimate) => (\n\t\t\t\t<span className=\"text-foreground text-sm font-medium\">\n\t\t\t\t\t{estimate.customer}\n\t\t\t\t</span>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tkey: \"project\",\n\t\t\theader: \"Project\",\n\t\t\twidth: \"flex-1\",\n\t\t\tsortable: true,\n\t\t\thideable: false,\n\t\t\tsortFn: (a, b) => a.project.localeCompare(b.project),\n\t\t\trender: (estimate) => (\n\t\t\t\t<Link\n\t\t\t\t\tclassName=\"block min-w-0\"\n\t\t\t\t\thref={`/dashboard/work/estimates/${estimate.id}`}\n\t\t\t\t\tonClick={(e) => e.stopPropagation()}\n\t\t\t\t>\n\t\t\t\t\t<span className=\"text-foreground text-sm leading-tight font-medium hover:underline\">\n\t\t\t\t\t\t{estimate.project}\n\t\t\t\t\t</span>\n\t\t\t\t</Link>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tkey: \"date\",\n\t\t\theader: \"Date\",\n\t\t\twidth: \"w-32\",\n\t\t\tshrink: true,\n\t\t\thideOnMobile: true,\n\t\t\tsortable: true,\n\t\t\thideable: true,\n\t\t\tsortFn: (a, b) => a.date.localeCompare(b.date),\n\t\t\trender: (estimate) => (\n\t\t\t\t<span className=\"text-muted-foreground text-sm tabular-nums\">\n\t\t\t\t\t{estimate.date}\n\t\t\t\t</span>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tkey: \"validUntil\",\n\t\t\theader: \"Valid Until\",\n\t\t\twidth: \"w-32\",\n\t\t\tshrink: true,\n\t\t\thideOnMobile: true,\n\t\t\tsortable: true,\n\t\t\thideable: true,\n\t\t\tsortFn: (a, b) => a.validUntil.localeCompare(b.validUntil),\n\t\t\trender: (estimate) => (\n\t\t\t\t<span className=\"text-muted-foreground text-sm tabular-nums\">\n\t\t\t\t\t{estimate.validUntil}\n\t\t\t\t</span>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tkey: \"amount\",\n\t\t\theader: \"Amount\",\n\t\t\twidth: \"w-32\",\n\t\t\tshrink: true,\n\t\t\talign: \"right\",\n\t\t\tsortable: true,\n\t\t\thideable: false, // CRITICAL: Financial data essential\n\t\t\tsortFn: (a, b) => a.amount - b.amount,\n\t\t\trender: (estimate) => (\n\t\t\t\t<span className=\"font-semibold tabular-nums\">\n\t\t\t\t\t{formatCurrency(estimate.amount, { decimals: 2 })}\n\t\t\t\t</span>\n\t\t\t),\n\t\t},\n\t\t{\n\t\t\tkey: \"status\",\n\t\t\theader: \"Status\",\n\t\t\twidth: \"w-28\",\n\t\t\tshrink: true,\n\t\t\tsortable: true,\n\t\t\thideable: false, // CRITICAL: Status key for action items\n\t\t\tsortFn: (a, b) => a.status.localeCompare(b.status),\n\t\t\trender: (estimate) => <EstimateStatusBadge status={estimate.status} />,\n\t\t},\n\t\t{\n\t\t\tkey: \"actions\",\n\t\t\theader: \"\",\n\t\t\twidth: \"w-10\",\n\t\t\tshrink: true,\n\t\t\trender: (estimate) => (\n\t\t\t\t<div data-no-row-click>\n\t\t\t\t\t<DropdownMenu>\n\t\t\t\t\t\t<DropdownMenuTrigger asChild>\n\t\t\t\t\t\t\t<Button size=\"icon\" variant=\"ghost\">\n\t\t\t\t\t\t\t\t<MoreHorizontal className=\"size-4\" />\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</DropdownMenuTrigger>\n\t\t\t\t\t\t<DropdownMenuContent align=\"end\">\n\t\t\t\t\t\t\t<DropdownMenuLabel>Actions</DropdownMenuLabel>\n\t\t\t\t\t\t\t<DropdownMenuSeparator />\n\t\t\t\t\t\t\t<DropdownMenuItem>\n\t\t\t\t\t\t\t\t<Send className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\t\tSend to Customer\n\t\t\t\t\t\t\t</DropdownMenuItem>\n\t\t\t\t\t\t\t<DropdownMenuItem>\n\t\t\t\t\t\t\t\t<Download className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\t\tDownload PDF\n\t\t\t\t\t\t\t</DropdownMenuItem>\n\t\t\t\t\t\t\t<DropdownMenuSeparator />\n\t\t\t\t\t\t\t<DropdownMenuItem\n\t\t\t\t\t\t\t\tclassName=\"text-destructive\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tsetEstimateToArchive(estimate.id);\n\t\t\t\t\t\t\t\t\tsetIsSingleArchiveOpen(true);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Archive className=\"mr-2 size-4\" />\n\t\t\t\t\t\t\t\tArchive Estimate\n\t\t\t\t\t\t\t</DropdownMenuItem>\n\t\t\t\t\t\t</DropdownMenuContent>\n\t\t\t\t\t</DropdownMenu>\n\t\t\t\t</div>\n\t\t\t),\n\t\t},\n\t];\n\n\t// Loading state for bulk actions\n\tconst [isBulkSending, setIsBulkSending] = useState(false);\n\n\tconst bulkActions: BulkAction[] = [\n\t\t{\n\t\t\tlabel: \"Send\",\n\t\t\ticon: <Send className=\"h-4 w-4\" />,\n\t\t\tonClick: async (selectedIds) => {\n\t\t\t\tif (isBulkSending) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst estimatesToSend = filteredEstimates.filter((est) =>\n\t\t\t\t\tselectedIds.has(est.id),\n\t\t\t\t);\n\n\t\t\t\tif (estimatesToSend.length === 0) {\n\t\t\t\t\tconst { toast } = await import(\"sonner\");\n\t\t\t\t\ttoast.error(\"No estimates selected\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\t// Open confirmation dialog\n\t\t\t\tsetPendingSendIds(selectedIds);\n\t\t\t\tsetIsBulkSendDialogOpen(true);\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tlabel: \"Archive Selected\",\n\t\t\ticon: <Archive className=\"h-4 w-4\" />,\n\t\t\tonClick: async (selectedIds) => {\n\t\t\t\tsetSelectedEstimateIds(selectedIds);\n\t\t\t\tsetIsBulkArchiveOpen(true);\n\t\t\t},\n\t\t\tvariant: \"destructive\",\n\t\t},\n\t];\n\n\tconst searchFilter = (estimate: Estimate, query: string) => {\n\t\tconst searchStr = query.toLowerCase();\n\t\treturn (\n\t\t\testimate.estimateNumber.toLowerCase().includes(searchStr) ||\n\t\t\testimate.customer.toLowerCase().includes(searchStr) ||\n\t\t\testimate.project.toLowerCase().includes(searchStr) ||\n\t\t\testimate.status.toLowerCase().includes(searchStr)\n\t\t);\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t<FullWidthDataTable\n\t\t\t\tbulkActions={bulkActions}\n\t\t\t\tcolumns={columns}\n\t\t\t\tdata={filteredEstimates}\n\t\t\t\temptyIcon={\n\t\t\t\t\t<FileText className=\"text-muted-foreground mx-auto h-12 w-12\" />\n\t\t\t\t}\n\t\t\t\temptyMessage=\"No estimates found\"\n\t\t\t\tenableSelection={true}\n\t\t\t\tentity=\"estimates\"\n\t\t\t\tgetHighlightClass={() => \"bg-success/30 dark:bg-success/10\"}\n\t\t\t\tgetItemId={(estimate) => estimate.id}\n\t\t\t\tisArchived={(est) => Boolean(est.archived_at || est.deleted_at)}\n\t\t\t\tisHighlighted={(estimate) => estimate.status === \"accepted\"}\n\t\t\t\titemsPerPage={itemsPerPage}\n\t\t\t\ttotalCount={totalCount ?? filteredEstimates.length}\n\t\t\t\tcurrentPageFromServer={currentPage}\n\t\t\t\tserverPagination\n\t\t\t\tonRefresh={() => window.location.reload()}\n\t\t\t\tonRowClick={(estimate) =>\n\t\t\t\t\t(window.location.href = `/dashboard/work/estimates/${estimate.id}`)\n\t\t\t\t}\n\t\t\t\tsearchFilter={searchFilter}\n\t\t\t\tsearchPlaceholder=\"Search estimates by number, customer, project, or status...\"\n\t\t\t\tshowArchived={activeFilters.Archive !== \"active\"}\n\t\t\t\tshowRefresh={false}\n\t\t\t\ttoolbarActions={\n\t\t\t\t\t<>\n\t\t\t\t\t\t<TableFilters\n\t\t\t\t\t\t\tactiveFilters={activeFilters}\n\t\t\t\t\t\t\tfilters={filterGroups}\n\t\t\t\t\t\t\tonFilterChange={handleFilterChange}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<ClearFiltersButton\n\t\t\t\t\t\t\tcount={activeFilterCount}\n\t\t\t\t\t\t\tonClear={handleClearFilters}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</>\n\t\t\t\t}\n\t\t\t/>\n\n\t\t\t{/* Single Estimate Archive Dialog */}\n\t\t\t<AlertDialog\n\t\t\t\tonOpenChange={setIsSingleArchiveOpen}\n\t\t\t\topen={isSingleArchiveOpen}\n\t\t\t>\n\t\t\t\t<AlertDialogContent>\n\t\t\t\t\t<AlertDialogHeader>\n\t\t\t\t\t\t<AlertDialogTitle>Archive Estimate?</AlertDialogTitle>\n\t\t\t\t\t\t<AlertDialogDescription>\n\t\t\t\t\t\t\tThis estimate will be archived and can be restored within 90 days.\n\t\t\t\t\t\t\tAfter 90 days, it will be permanently deleted.\n\t\t\t\t\t\t</AlertDialogDescription>\n\t\t\t\t\t</AlertDialogHeader>\n\t\t\t\t\t<AlertDialogFooter>\n\t\t\t\t\t\t<AlertDialogCancel>Cancel</AlertDialogCancel>\n\t\t\t\t\t\t<AlertDialogAction\n\t\t\t\t\t\t\tclassName=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tif (estimateToArchive) {\n\t\t\t\t\t\t\t\t\tconst { archiveEstimate } = await import(\n\t\t\t\t\t\t\t\t\t\t\"@/actions/estimates\"\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tawait archiveEstimate(estimateToArchive);\n\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tArchive\n\t\t\t\t\t\t</AlertDialogAction>\n\t\t\t\t\t</AlertDialogFooter>\n\t\t\t\t</AlertDialogContent>\n\t\t\t</AlertDialog>\n\n\t\t\t{/* Bulk Archive Dialog */}\n\t\t\t<AlertDialog onOpenChange={setIsBulkArchiveOpen} open={isBulkArchiveOpen}>\n\t\t\t\t<AlertDialogContent>\n\t\t\t\t\t<AlertDialogHeader>\n\t\t\t\t\t\t<AlertDialogTitle>\n\t\t\t\t\t\t\tArchive {selectedEstimateIds.size} Estimate(s)?\n\t\t\t\t\t\t</AlertDialogTitle>\n\t\t\t\t\t\t<AlertDialogDescription>\n\t\t\t\t\t\t\tThese estimates will be archived and can be restored within 90\n\t\t\t\t\t\t\tdays. After 90 days, they will be permanently deleted.\n\t\t\t\t\t\t</AlertDialogDescription>\n\t\t\t\t\t</AlertDialogHeader>\n\t\t\t\t\t<AlertDialogFooter>\n\t\t\t\t\t\t<AlertDialogCancel>Cancel</AlertDialogCancel>\n\t\t\t\t\t\t<AlertDialogAction\n\t\t\t\t\t\t\tclassName=\"bg-destructive text-destructive-foreground hover:bg-destructive/90\"\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tconst { archiveEstimate } = await import(\"@/actions/estimates\");\n\t\t\t\t\t\t\t\tfor (const estimateId of selectedEstimateIds) {\n\t\t\t\t\t\t\t\t\tawait archiveEstimate(estimateId);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tArchive All\n\t\t\t\t\t\t</AlertDialogAction>\n\t\t\t\t\t</AlertDialogFooter>\n\t\t\t\t</AlertDialogContent>\n\t\t\t</AlertDialog>\n\n\t\t\t{/* Bulk Send Confirmation Dialog */}\n\t\t\t<AlertDialog\n\t\t\t\tonOpenChange={setIsBulkSendDialogOpen}\n\t\t\t\topen={isBulkSendDialogOpen}\n\t\t\t>\n\t\t\t\t<AlertDialogContent>\n\t\t\t\t\t<AlertDialogHeader>\n\t\t\t\t\t\t<AlertDialogTitle>\n\t\t\t\t\t\t\tSend {pendingSendIds.size} Estimate(s)?\n\t\t\t\t\t\t</AlertDialogTitle>\n\t\t\t\t\t\t<AlertDialogDescription>\n\t\t\t\t\t\t\tThis will send {pendingSendIds.size} estimate\n\t\t\t\t\t\t\t{pendingSendIds.size !== 1 ? \"s\" : \"\"} via email to your\n\t\t\t\t\t\t\tcustomers.\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<strong>Estimated time:</strong>{\" \"}\n\t\t\t\t\t\t\t{Math.ceil(pendingSendIds.size * 0.5)} second\n\t\t\t\t\t\t\t{Math.ceil(pendingSendIds.size * 0.5) !== 1 ? \"s\" : \"\"}\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\tNote: Only estimates with customer email addresses will be sent.\n\t\t\t\t\t\t</AlertDialogDescription>\n\t\t\t\t\t</AlertDialogHeader>\n\t\t\t\t\t<AlertDialogFooter>\n\t\t\t\t\t\t<AlertDialogCancel>Cancel</AlertDialogCancel>\n\t\t\t\t\t\t<AlertDialogAction\n\t\t\t\t\t\t\tonClick={async () => {\n\t\t\t\t\t\t\t\tsetIsBulkSendDialogOpen(false);\n\t\t\t\t\t\t\t\tsetIsBulkSending(true);\n\n\t\t\t\t\t\t\t\t// Import sync store\n\t\t\t\t\t\t\t\tconst { useSyncStore } = await import(\n\t\t\t\t\t\t\t\t\t\"@/lib/stores/sync-store\"\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tconst { startOperation, completeOperation } =\n\t\t\t\t\t\t\t\t\tuseSyncStore.getState();\n\n\t\t\t\t\t\t\t\tconst { toast } = await import(\"sonner\");\n\t\t\t\t\t\t\t\tconst estimateIds = Array.from(pendingSendIds);\n\t\t\t\t\t\t\t\tconst count = estimateIds.length;\n\n\t\t\t\t\t\t\t\t// Start sync operation\n\t\t\t\t\t\t\t\tconst operationId = startOperation({\n\t\t\t\t\t\t\t\t\ttype: \"bulk_send_estimates\",\n\t\t\t\t\t\t\t\t\ttitle: `Sending ${count} estimate${count !== 1 ? \"s\" : \"\"}`,\n\t\t\t\t\t\t\t\t\tdescription: \"Preparing emails...\",\n\t\t\t\t\t\t\t\t\ttotal: count,\n\t\t\t\t\t\t\t\t\tcurrent: 0,\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tconst { bulkSendEstimates } = await import(\n\t\t\t\t\t\t\t\t\t\t\"@/actions/bulk-communications\"\n\t\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\t\t// Send estimates\n\t\t\t\t\t\t\t\t\tconst result = await bulkSendEstimates(estimateIds, {\n\t\t\t\t\t\t\t\t\t\tbatchSize: 10,\n\t\t\t\t\t\t\t\t\t\tbatchDelay: 1000,\n\t\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t\t// Complete operation\n\t\t\t\t\t\t\t\t\tif (result.success || (result.results?.successful ?? 0) > 0) {\n\t\t\t\t\t\t\t\t\t\tcompleteOperation(operationId, true);\n\t\t\t\t\t\t\t\t\t\ttoast.success(result.message);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tcompleteOperation(\n\t\t\t\t\t\t\t\t\t\t\toperationId,\n\t\t\t\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\t\t\t\tresult.error || \"Failed to send estimates\",\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to send estimates\");\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t// Reload if any succeeded\n\t\t\t\t\t\t\t\t\tif ((result.results?.successful ?? 0) > 0) {\n\t\t\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\t\t\t\tcompleteOperation(\n\t\t\t\t\t\t\t\t\t\toperationId,\n\t\t\t\t\t\t\t\t\t\tfalse,\n\t\t\t\t\t\t\t\t\t\terror instanceof Error\n\t\t\t\t\t\t\t\t\t\t\t? error.message\n\t\t\t\t\t\t\t\t\t\t\t: \"Failed to send estimates\",\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\ttoast.error(\n\t\t\t\t\t\t\t\t\t\terror instanceof Error\n\t\t\t\t\t\t\t\t\t\t\t? error.message\n\t\t\t\t\t\t\t\t\t\t\t: \"Failed to send estimates\",\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\t\t\tsetIsBulkSending(false);\n\t\t\t\t\t\t\t\t\tsetPendingSendIds(new Set());\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tSend Estimates\n\t\t\t\t\t\t</AlertDialogAction>\n\t\t\t\t\t</AlertDialogFooter>\n\t\t\t\t</AlertDialogContent>\n\t\t\t</AlertDialog>\n\t\t</>\n\t);\n}\n","// Re-export from @stratos/ui package\nexport * from \"@stratos/ui\";\n"],"names":[],"mappings":"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"}