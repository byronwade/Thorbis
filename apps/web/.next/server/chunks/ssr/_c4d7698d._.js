module.exports=[780195,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"registerServerReference",{enumerable:!0,get:function(){return d.registerServerReference}});let d=a.r(742210)},395731,(a,b,c)=>{"use strict";function d(a){for(let b=0;b<a.length;b++){let c=a[b];if("function"!=typeof c)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof c}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(c,"__esModule",{value:!0}),Object.defineProperty(c,"ensureServerEntryExports",{enumerable:!0,get:function(){return d}})},933427,a=>{"use strict";var b=a.i(780195),c=a.i(319351);async function d(){let a=process.env.SUPABASE_POOLER_URL||"https://togejqdwggezkxahomeh.supabase.co",b=process.env.SUPABASE_SERVICE_ROLE_KEY;return a&&b?(0,c.createClient)(a,b,{auth:{persistSession:!1,autoRefreshToken:!1},db:{schema:"public"},global:{headers:{"x-my-custom-header":"service-role"}}}):null}(0,a.i(395731).ensureServerEntryExports)([d]),(0,b.registerServerReference)(d,"00a13dbd00149949fc1367d3e76ae7d789e07f5321",null),a.s(["createServiceSupabaseClient",()=>d])},57535,883385,a=>{"use strict";function b(a){let{progress:b,completedAt:c}=a;if(c)return!0;if(!b||"object"!=typeof b)return!1;if(!0===b.onboardingCompleted)return!0;let d=b.completedSteps;return!!(Array.isArray(d)&&d.includes("complete"))}a.s(["isOnboardingComplete",()=>b],57535);var c=a.i(429969),d=a.i(136874);let e=(0,c.cache)(async()=>{try{let a=await (0,d.createClient)();if(!a)return null;let{data:{user:b},error:c}=await a.auth.getUser();if(c)return c.name,null;return b}catch(a){return a&&"object"==typeof a&&"name"in a&&a.name,null}});async function f(){let a=await e();if(!a)throw Error("Authentication required. Please log in to continue.");return a}(0,c.cache)(async()=>{try{let a=await (0,d.createClient)();if(!a)return null;let{data:{session:b},error:c}=await a.auth.getSession();if(c)return null;return b}catch(a){return null}}),a.s(["getCurrentUser",0,e,"requireUser",()=>f],883385)},445074,a=>{"use strict";var b=a.i(136874),c=a.i(933427),d=a.i(57535),e=a.i(429969),f=a.i(883385);let g="active_company_id",h=(0,e.cache)(async()=>{let b,{cookies:c}=await a.A(858982);try{b=await c()}catch(a){if(a instanceof Error&&(a.message.includes("During prerendering")||a.message.includes("prerendering")||a.message.includes("cookies()")))return null;throw a}let d=b.get(g)?.value;if(d&&await m(d))return d;let e=await l();return e[0]?.id||null}),i=(0,e.cache)(async()=>{let a=await h();if(!a)return null;let c=await (0,b.createClient)();if(!c)return null;let{data:d}=await c.from("companies").select("id, name, logo, phone, email").eq("id",a).is("deleted_at",null).single();return d});async function j(b){if(!await m(b))throw Error("You don't have access to this company");let{cookies:c}=await a.A(858982);(await c()).set(g,b,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:2592e3,path:"/"})}async function k(){let{cookies:b}=await a.A(858982);(await b()).delete(g)}let l=(0,e.cache)(async()=>{let a=await (0,f.getCurrentUser)();if(!a)return[];let b=await (0,c.createServiceSupabaseClient)();if(!b)return[];let{data:d}=await b.from("company_memberships").select(`
      company_id,
      companies!inner (
        id,
        name,
        logo,
        deleted_at,
        onboarding_completed_at
      )
    `).eq("user_id",a.id).eq("status","active").is("companies.deleted_at",null);return d?d.sort((a,b)=>{let c=!!a.companies.onboarding_completed_at,d=!!b.companies.onboarding_completed_at;return c&&!d?-1:!c&&d?1:a.companies.name.localeCompare(b.companies.name)}).map(a=>({id:a.companies.id,name:a.companies.name,logo:a.companies.logo})):[]}),m=(0,e.cache)(async a=>{let c=await (0,f.getCurrentUser)();if(!c)return!1;let d=await (0,b.createClient)();if(!d)return!1;let[e,g]=await Promise.all([d.from("companies").select("id").eq("id",a).is("deleted_at",null).single(),d.from("company_memberships").select("id").eq("user_id",c.id).eq("company_id",a).eq("status","active").single()]);return!!(e.data&&g.data)}),n=(0,e.cache)(async()=>{let a=await (0,f.getCurrentUser)();if(!a)return null;let c=await h();if(!c)return null;let d=await (0,b.createClient)();if(!d)return null;let{data:e}=await d.from("team_members").select("id").eq("user_id",a.id).eq("company_id",c).eq("status","active").single();return e?.id||null});async function o(){let a=await h();if(!a)throw Error("No active company selected. Please select a company.");return a}async function p(){let a=await (0,f.getCurrentUser)();if(!a)return!1;let b=await h();if(!b)return!1;let e=await (0,c.createServiceSupabaseClient)();if(!e)return!1;let{data:g}=await e.from("company_memberships").select("company_id, companies!inner(stripe_subscription_status, onboarding_progress, onboarding_completed_at)").eq("user_id",a.id).eq("company_id",b).eq("status","active").maybeSingle();if(!g)return!1;let i=Array.isArray(g.companies)?g.companies[0]:g.companies,j=i?.stripe_subscription_status,k=i?.onboarding_progress||null,l=(0,d.isOnboardingComplete)({progress:k,completedAt:i?.onboarding_completed_at??null});return("active"===j||"trialing"===j)&&l||!1}a.s(["clearActiveCompany",()=>k,"getActiveCompany",0,i,"getActiveCompanyId",0,h,"getActiveTeamMemberId",0,n,"getUserCompanies",0,l,"isActiveCompanyOnboardingComplete",()=>p,"requireActiveCompany",()=>o,"setActiveCompany",()=>j])},467361,a=>{"use strict";a.i(445074),a.s([])},636404,(a,b,c)=>{"use strict";Object.defineProperty(c,"__esModule",{value:!0});var d={RequestCookies:function(){return f.RequestCookies},ResponseCookies:function(){return f.ResponseCookies},stringifyCookie:function(){return f.stringifyCookie}};for(var e in d)Object.defineProperty(c,e,{enumerable:!0,get:d[e]});let f=a.r(446010)},818944,a=>{"use strict";let b={AUTH_UNAUTHORIZED:"AUTH_UNAUTHORIZED",AUTH_FORBIDDEN:"AUTH_FORBIDDEN",AUTH_TOKEN_EXPIRED:"AUTH_TOKEN_EXPIRED",AUTH_TOKEN_INVALID:"AUTH_TOKEN_INVALID",AUTH_EMAIL_NOT_VERIFIED:"AUTH_EMAIL_NOT_VERIFIED",VALIDATION_FAILED:"VALIDATION_FAILED",VALIDATION_REQUIRED_FIELD:"VALIDATION_REQUIRED_FIELD",VALIDATION_INVALID_FORMAT:"VALIDATION_INVALID_FORMAT",VALIDATION_OUT_OF_RANGE:"VALIDATION_OUT_OF_RANGE",DB_RECORD_NOT_FOUND:"DB_RECORD_NOT_FOUND",DB_DUPLICATE_ENTRY:"DB_DUPLICATE_ENTRY",DB_CONSTRAINT_VIOLATION:"DB_CONSTRAINT_VIOLATION",DB_FOREIGN_KEY_VIOLATION:"DB_FOREIGN_KEY_VIOLATION",DB_CONNECTION_ERROR:"DB_CONNECTION_ERROR",DB_QUERY_ERROR:"DB_QUERY_ERROR",DB_INSERT_ERROR:"DB_INSERT_ERROR",DB_UPDATE_ERROR:"DB_UPDATE_ERROR",BUSINESS_RULE_VIOLATION:"BUSINESS_RULE_VIOLATION",INSUFFICIENT_PERMISSIONS:"INSUFFICIENT_PERMISSIONS",OPERATION_NOT_ALLOWED:"OPERATION_NOT_ALLOWED",RESOURCE_LOCKED:"RESOURCE_LOCKED",RESOURCE_DELETED:"RESOURCE_DELETED",SERVICE_UNAVAILABLE:"SERVICE_UNAVAILABLE",SERVICE_TIMEOUT:"SERVICE_TIMEOUT",SERVICE_RATE_LIMIT:"SERVICE_RATE_LIMIT",SERVICE_INTEGRATION_ERROR:"SERVICE_INTEGRATION_ERROR",EXTERNAL_API_ERROR:"EXTERNAL_API_ERROR",FILE_NOT_FOUND:"FILE_NOT_FOUND",FILE_TOO_LARGE:"FILE_TOO_LARGE",FILE_INVALID_TYPE:"FILE_INVALID_TYPE",FILE_UPLOAD_FAILED:"FILE_UPLOAD_FAILED",PAYMENT_FAILED:"PAYMENT_FAILED",PAYMENT_DECLINED:"PAYMENT_DECLINED",PAYMENT_INSUFFICIENT_FUNDS:"PAYMENT_INSUFFICIENT_FUNDS",PAYMENT_INVALID_AMOUNT:"PAYMENT_INVALID_AMOUNT",PAYMENT_ALREADY_REFUNDED:"PAYMENT_ALREADY_REFUNDED",PAYMENT_CANNOT_REFUND:"PAYMENT_CANNOT_REFUND",UNKNOWN_ERROR:"UNKNOWN_ERROR",INTERNAL_SERVER_ERROR:"INTERNAL_SERVER_ERROR",BAD_REQUEST:"BAD_REQUEST",NOT_IMPLEMENTED:"NOT_IMPLEMENTED",UNAUTHORIZED:"UNAUTHORIZED",NOT_FOUND:"NOT_FOUND",CONFLICT:"CONFLICT",EXPIRED:"EXPIRED",VALIDATION_ERROR:"VALIDATION_ERROR"};class c extends Error{code;statusCode;details;constructor(a,d=b.UNKNOWN_ERROR,e=400,f){super(a),this.code=d,this.statusCode=e,this.details=f,this.name="ActionError",Error.captureStackTrace&&Error.captureStackTrace(this,c)}toJSON(){return{success:!1,error:this.message,code:this.code,statusCode:this.statusCode,...this.details&&{details:this.details}}}static fromUnknown(a){return a instanceof c?a:a instanceof Error?new c(a.message,b.INTERNAL_SERVER_ERROR,500):new c("An unexpected error occurred",b.UNKNOWN_ERROR,500)}}a.s(["ActionError",()=>c,"ERROR_CODES",0,b,"ERROR_MESSAGES",0,{unauthorized:()=>"You must be logged in to perform this action",forbidden:a=>`You don't have permission to access this ${a}`,emailNotVerified:()=>"Please verify your email before continuing",requiredField:a=>`${a} is required`,invalidFormat:a=>`${a} has an invalid format`,outOfRange:(a,b,c)=>`${a} must be between ${b} and ${c}`,notFound:a=>`${a} not found`,alreadyExists:a=>`${a} already exists`,cannotDelete:(a,b)=>`Cannot delete ${a}: ${b}`,insufficientFunds:()=>"Insufficient funds for this transaction",cannotRefund:a=>`Cannot process refund: ${a}`,resourceLocked:a=>`${a} is currently being modified by another user`,operationFailed:a=>`Failed to ${a}`,serviceUnavailable:a=>`${a} is currently unavailable`}])},974406,a=>{"use strict";var b=a.i(269269),c=a.i(818944);async function d(a){try{let b=await a();return{success:!0,data:b}}catch(a){if(a instanceof c.ActionError)return a.code===c.ERROR_CODES.AUTH_FORBIDDEN||a.code===c.ERROR_CODES.AUTH_UNAUTHORIZED||console.error(`[Action Error] ${a.code}: ${a.message}`),{success:!1,error:a.message,code:a.code,...a.details&&{details:a.details}};if(a instanceof b.ZodError)return{success:!1,error:a.issues[0]?.message||"Validation failed",code:c.ERROR_CODES.VALIDATION_FAILED,details:{issues:a.issues.map(a=>({field:a.path.join("."),message:a.message}))}};if(a instanceof Error)return{success:!1,error:"An unexpected error occurred",code:c.ERROR_CODES.INTERNAL_SERVER_ERROR};return{success:!1,error:"An unexpected error occurred",code:c.ERROR_CODES.UNKNOWN_ERROR}}}function e(a){if(!a)throw new c.ActionError("Database connection failed",c.ERROR_CODES.DB_CONNECTION_ERROR,500)}function f(a){if(!a)throw new c.ActionError("You must be logged in to perform this action",c.ERROR_CODES.AUTH_UNAUTHORIZED,401)}function g(a,b){if(!a)throw new c.ActionError(`${b} not found`,c.ERROR_CODES.DB_RECORD_NOT_FOUND,404)}a.s(["assertAuthenticated",()=>f,"assertExists",()=>g,"assertSupabase",()=>e,"withErrorHandling",()=>d])}];

//# sourceMappingURL=_c4d7698d._.js.map