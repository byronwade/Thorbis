module.exports=[264738,a=>{"use strict";let b=(0,a.i(203431).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["default",()=>b])},779184,a=>{"use strict";var b=a.i(264738);a.s(["ChevronLeft",()=>b.default])},801761,a=>{"use strict";let b=(0,a.i(203431).default)("sticky-note",[["path",{d:"M21 9a2.4 2.4 0 0 0-.706-1.706l-3.588-3.588A2.4 2.4 0 0 0 15 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2z",key:"1dfntj"}],["path",{d:"M15 3v5a1 1 0 0 0 1 1h5",key:"6s6qgf"}]]);a.s(["default",()=>b])},447088,a=>{"use strict";let b=(0,a.i(203431).default)("reply",[["path",{d:"M20 18v-2a4 4 0 0 0-4-4H4",key:"5vmcpk"}],["path",{d:"m9 17-5-5 5-5",key:"nvlc11"}]]);a.s(["default",()=>b])},334044,a=>{"use strict";var b=a.i(801761);a.s(["StickyNote",()=>b.default])},521995,a=>{"use strict";var b=a.i(447088);a.s(["Reply",()=>b.default])},301784,a=>{"use strict";var b=a.i(861467);a.i(445255);var c=a.i(18170),d=a.i(700760),e=a.i(187056),f=a.i(891079),g=a.i(273819),h=a.i(97997),i=a.i(783281),j=a.i(156916);a.i(928414);var k=a.i(745250);function l({html:a,text:c,attachments:e,className:g}){let[h,j]=(0,i.useState)(null);(0,i.useEffect)(()=>{},[]);let k=(0,i.useMemo)(()=>a&&h?h.sanitize(a,{ALLOWED_TAGS:["p","br","strong","em","u","b","i","s","strike","a","ul","ol","li","h1","h2","h3","h4","h5","h6","blockquote","img","table","thead","tbody","tfoot","tr","th","td","div","span","hr","pre","code","font","center","section","article","header","footer","main","style"],ALLOWED_ATTR:["href","src","alt","title","width","height","style","class","id","align","valign","border","cellpadding","cellspacing","bgcolor","color","face","size","colspan","rowspan","target","rel"],ALLOW_DATA_ATTR:!1,ALLOWED_URI_REGEXP:/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,KEEP_CONTENT:!0,ADD_TAGS:["style"],ADD_ATTR:["media","type"]}):null,[a,h]),l=(0,i.useMemo)(()=>c?c.split(/\n\n+/).map((a,c)=>(0,b.jsx)("p",{className:"mb-4 last:mb-0",children:a.split("\n").map((a,c,d)=>(0,b.jsxs)("span",{children:[a,c<d.length-1&&(0,b.jsx)("br",{})]},c))},c)):null,[c]),n=e&&e.length>0;return(0,b.jsxs)("div",{className:(0,d.cn)("flex flex-col gap-4",g),children:[(0,b.jsx)("div",{className:"email-content-wrapper prose prose-sm dark:prose-invert max-w-none",children:k?(0,b.jsx)("div",{className:"email-content-html text-sm leading-relaxed",style:{fontSize:"14px",lineHeight:"1.6",color:"inherit"},dangerouslySetInnerHTML:{__html:k}}):a&&!h?l?(0,b.jsx)("div",{className:"text-sm leading-relaxed text-foreground",children:l}):(0,b.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,b.jsx)("div",{className:"text-sm text-muted-foreground italic",children:"Loading email content..."})}):l?(0,b.jsx)("div",{className:"text-sm leading-relaxed text-foreground",children:l}):(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("svg",{width:"64",height:"64",viewBox:"0 0 192 192",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mx-auto mb-4 opacity-30",children:(0,b.jsx)("rect",{width:"192",height:"192",rx:"96",fill:"currentColor",fillOpacity:"0.15"})}),(0,b.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:"No content available"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"This email may have been deleted or expired"})]})})}),n&&(0,b.jsxs)("div",{className:"border-t border-border/50 pt-4",children:[(0,b.jsxs)("h3",{className:"text-sm font-semibold mb-3 flex items-center gap-2 text-foreground",children:[(0,b.jsx)(f.File,{className:"h-4 w-4"}),"Attachments (",e.length,")"]}),(0,b.jsx)("div",{className:"flex flex-col gap-2",children:e.map((a,c)=>(0,b.jsx)(m,{attachment:a},a.id||a.path||c))})]})]})}function m({attachment:a}){let d=a.filename||a.name||"attachment",l=a.content_type||a.type||"",m=l.startsWith("image/"),n=a.storage_url||null,o=!!n&&"#"!==n,p=(0,i.useCallback)(()=>{j.toast.error("Attachment unavailable",{description:"This attachment cannot be downloaded. The file may have expired or been removed."})},[]);return(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-muted/50 rounded-lg hover:bg-muted transition-colors",children:[(0,b.jsx)("div",{className:"flex-shrink-0",children:m?(0,b.jsx)(g.Image,{className:"h-5 w-5 text-muted-foreground"}):(0,b.jsx)(f.File,{className:"h-5 w-5 text-muted-foreground"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm font-medium truncate",children:d}),(0,b.jsxs)("div",{className:"flex items-center gap-1.5",children:[l&&(0,b.jsx)("span",{className:"text-xs text-muted-foreground",children:l}),!o&&(0,b.jsxs)(k.Tooltip,{children:[(0,b.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)("span",{className:"text-xs text-orange-500 flex items-center gap-0.5",children:[(0,b.jsx)(h.AlertCircle,{className:"h-3 w-3"}),"Unavailable"]})}),(0,b.jsx)(k.TooltipContent,{children:(0,b.jsx)("p",{children:"This attachment cannot be downloaded"})})]})]})]}),o?(0,b.jsx)(c.Button,{variant:"ghost",size:"sm",className:"flex-shrink-0",asChild:!0,children:(0,b.jsxs)("a",{href:n,download:d,target:"_blank",rel:"noopener noreferrer",children:[(0,b.jsx)(e.Download,{className:"h-4 w-4"}),(0,b.jsxs)("span",{className:"sr-only",children:["Download ",d]})]})}):(0,b.jsxs)(k.Tooltip,{children:[(0,b.jsx)(k.TooltipTrigger,{asChild:!0,children:(0,b.jsxs)(c.Button,{variant:"ghost",size:"sm",className:"flex-shrink-0 opacity-50",onClick:p,children:[(0,b.jsx)(e.Download,{className:"h-4 w-4"}),(0,b.jsxs)("span",{className:"sr-only",children:["Download ",d]})]})}),(0,b.jsx)(k.TooltipContent,{children:(0,b.jsx)("p",{children:"Attachment unavailable for download"})})]})]})}a.s(["EmailContent",()=>l])},190827,a=>{"use strict";let b=(0,a.i(203431).default)("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);a.s(["default",()=>b])},341493,a=>{"use strict";var b=a.i(190827);a.s(["Trash",()=>b.default])},101697,676694,a=>{"use strict";var b=a.i(203431);let c=(0,b.default)("forward",[["path",{d:"m15 17 5-5-5-5",key:"nf172w"}],["path",{d:"M4 18v-2a4 4 0 0 1 4-4h12",key:"jmiej9"}]]);a.s(["default",()=>c],101697);let d=(0,b.default)("reply-all",[["path",{d:"m12 17-5-5 5-5",key:"1s3y5u"}],["path",{d:"M22 18v-2a4 4 0 0 0-4-4H7",key:"1fcyog"}],["path",{d:"m7 17-5-5 5-5",key:"1ed8i2"}]]);a.s(["default",()=>d],676694)},201489,190121,27878,a=>{"use strict";var b=a.i(169021),c=(0,b.createServerReference)("406d2674c7205459d9f4f40892380fb085c342fe1c",b.callServer,void 0,b.findSourceMapURL,"getEmailsAction");a.s(["getEmailsAction",()=>c],201489);var d=a.i(101697);a.s(["Forward",()=>d.default],190121);var e=a.i(676694);a.s(["ReplyAll",()=>e.default],27878)},62364,a=>{"use strict";var b=a.i(861467),c=a.i(337241),d=a.i(783281),e=a.i(169021),f=(0,e.createServerReference)("400737686314e248a3cd3c96e588f4e7cbf17190d8",e.callServer,void 0,e.findSourceMapURL,"getEmailByIdAction"),g=a.i(201489),h=a.i(301784);a.i(516775);var i=a.i(560272);a.i(445255);var j=a.i(18170);a.i(146697);var k=a.i(778737);a.i(928414);var l=a.i(745250),m=a.i(916680),n=a.i(452168),o=a.i(779184),p=a.i(190121),q=a.i(94436),r=a.i(521995),s=a.i(27878),t=a.i(171768),u=a.i(334044),v=a.i(341493),w=a.i(300298),x=a.i(156916),y=a.i(145679);function z(){let a=(0,c.useParams)(),e=(0,c.useRouter)(),z=a?.folder||"inbox",A=a?.id,[B,C]=(0,d.useTransition)(),[D,E]=(0,d.useState)(null),[F,G]=(0,d.useState)(null),[H,I]=(0,d.useState)(!0),[J,K]=(0,d.useState)(null),[L,M]=(0,d.useState)(null),[N,O]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{(async()=>{try{let a=await (0,g.getEmailsAction)({limit:50,offset:0,type:"all",folder:"inbox"===z?void 0:z,sortBy:"created_at",sortOrder:"desc"});G(a)}catch(a){console.error("Failed to fetch emails:",a)}})()},[z]),(0,d.useEffect)(()=>{if(!A){K("No email ID provided"),I(!1);return}I(!0),K(null),C(async()=>{try{let a=await f(A);if(!a.success||!a.email)throw Error(a.error||"Email not found");E(a.email),M({html:a.email.body_html||null,text:a.email.body||null})}catch(b){let a=b instanceof Error?b.message:"Failed to load email";K(a),x.toast.error("Failed to load email",{description:a})}finally{I(!1)}})},[A]),H&&!D)?(0,b.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading email..."})]})}):J||!D?(0,b.jsx)("div",{className:"flex h-full w-full items-center justify-center",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)(m.AlertTriangle,{className:"h-8 w-8 text-destructive mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-sm font-medium text-destructive mb-2",children:J||"Email not found"}),(0,b.jsxs)(j.Button,{variant:"outline",onClick:()=>e.push(`/dashboard/communication/${z}`),children:["Back to ",z.charAt(0).toUpperCase()+z.slice(1)]})]})}):(0,b.jsx)("div",{className:"flex h-full w-full flex-col overflow-hidden bg-sidebar",children:(0,b.jsxs)("div",{className:"flex flex-1 overflow-hidden min-h-0 gap-2",children:[(0,b.jsxs)("div",{className:"bg-card mb-1 w-full md:w-[400px] lg:w-[480px] shadow-sm lg:h-full lg:shadow-sm flex flex-col rounded-tr-2xl overflow-hidden",children:[(0,b.jsx)("div",{className:"p-4 border-b",children:(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:()=>e.push(`/dashboard/communication/${z}`),className:"w-full justify-start",children:[(0,b.jsx)(o.ChevronLeft,{className:"h-4 w-4 mr-2"}),"Back to ",z.charAt(0).toUpperCase()+z.slice(1)]})}),(0,b.jsx)("div",{className:"flex-1 overflow-y-auto",children:F?.emails?.map(a=>{let c=a.id===D.id;return(0,b.jsx)(y.default,{href:`/dashboard/communication/${z}/${a.id}`,className:`block border-b border-border/50 hover:bg-accent/50 transition-colors ${c?"bg-accent":""}`,children:(0,b.jsxs)("div",{className:"p-3 space-y-2",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("p",{className:"text-sm font-semibold text-foreground line-clamp-1",children:a.from_name||a.from_address||"Unknown"}),!a.read_at&&(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary shrink-0"})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-1",children:a.subject||"No subject"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:new Date(a.created_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})]})},a.id)})})]}),(0,b.jsx)("div",{className:"bg-card mb-1 rounded-tl-2xl shadow-sm lg:h-full flex flex-col min-w-0 flex-1 overflow-hidden",children:(0,b.jsx)("div",{className:"relative flex-1 min-h-0 flex flex-col",children:(0,b.jsx)("div",{className:"flex flex-col h-full flex-1 min-h-0",children:(0,b.jsxs)("div",{className:"bg-card relative flex flex-col overflow-hidden transition-all duration-300 h-full flex-1 min-h-0",children:[(0,b.jsxs)("div",{className:"sticky top-0 z-15 flex shrink-0 items-center justify-between gap-1.5 p-2 pb-0 transition-colors bg-card",children:[(0,b.jsxs)("div",{className:"flex flex-1 items-center gap-2",children:[(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",onClick:()=>e.push(`/dashboard/communication/${z}`),className:"h-8 w-8 p-0 hover:bg-accent/80 active:bg-accent transition-colors",children:[(0,b.jsx)(w.X,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"sr-only",children:"Close"})]}),(0,b.jsx)(k.Separator,{orientation:"vertical",className:"h-4 bg-border/60"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",className:"h-8 px-2 hover:bg-accent/80 active:bg-accent transition-colors",children:[(0,b.jsx)(s.ReplyAll,{className:"h-4 w-4 mr-1.5 text-muted-foreground"}),(0,b.jsx)("span",{className:"text-sm leading-none font-medium",children:"Reply all"})]}),(0,b.jsxs)(j.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-accent/80 active:bg-accent transition-colors",title:"Notes",children:[(0,b.jsx)(u.StickyNote,{className:"h-4 w-4 text-muted-foreground"}),(0,b.jsx)("span",{className:"sr-only",children:"Notes"})]}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-accent/80 active:bg-accent transition-colors",title:"Star",children:(0,b.jsx)(t.Star,{className:"h-4 w-4 text-muted-foreground"})}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-accent/80 active:bg-accent transition-colors",title:"Archive",children:(0,b.jsx)(n.Archive,{className:"h-4 w-4 text-muted-foreground"})}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-destructive/10 active:bg-destructive/15 transition-colors",title:"Delete",children:(0,b.jsx)(v.Trash,{className:"h-4 w-4 fill-destructive text-destructive"})}),(0,b.jsx)(j.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 hover:bg-accent/80 active:bg-accent transition-colors",title:"More options",children:(0,b.jsx)(q.MoreHorizontal,{className:"h-4 w-4 text-muted-foreground"})})]})]}),(0,b.jsx)("div",{className:"flex min-h-0 flex-1 flex-col overflow-hidden",children:(0,b.jsxs)("div",{className:"relative overflow-hidden flex-1 h-full min-h-0 flex flex-col",children:[(0,b.jsx)(l.TooltipProvider,{children:(0,b.jsxs)("div",{className:"border-b border-border/50 px-2 py-4 space-y-3",children:[(0,b.jsx)("h1",{className:"text-base font-semibold text-foreground",children:D.subject||"No Subject"}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(i.Avatar,{className:"h-9 w-9 shrink-0 rounded-md cursor-pointer",children:(0,b.jsx)(i.AvatarFallback,{className:"bg-muted text-muted-foreground font-semibold text-sm rounded-md",children:D.from_address?.[0]?.toUpperCase()||"U"})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-semibold text-sm text-foreground",children:D.from_name||D.from_address||"Unknown"}),!D.read_at&&(0,b.jsx)("div",{className:"h-2 w-2 rounded-full bg-primary"})]}),(0,b.jsxs)("div",{className:"text-xs text-muted-foreground",children:["to ",D.to_address?.includes("@")?"me"===D.to_address.split("@")[0]?"you":D.to_address.split("@")[0]:"you"]})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:(0,b.jsx)("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:new Date(D.created_at).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"})})})]})]})}),(0,b.jsxs)("div",{className:"flex-1 overflow-hidden flex flex-col min-h-0",children:[(0,b.jsx)("div",{className:"flex-1 overflow-y-auto px-2 py-4",children:N?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent mx-auto mb-4"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading email content..."})]})}):(0,b.jsx)(h.EmailContent,{html:L?.html||D.body_html||null,text:L?.text||D.body||null,attachments:null})}),(0,b.jsx)("div",{className:"border-t border-border/50 px-2 py-4 bg-background",children:(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)(j.Button,{variant:"default",size:"sm",className:"h-9 px-4",children:[(0,b.jsx)(r.Reply,{className:"h-4 w-4 mr-2"}),"Reply"]}),(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",className:"h-9 px-4",children:[(0,b.jsx)(s.ReplyAll,{className:"h-4 w-4 mr-2"}),"Reply All"]}),(0,b.jsxs)(j.Button,{variant:"outline",size:"sm",className:"h-9 px-4",children:[(0,b.jsx)(p.Forward,{className:"h-4 w-4 mr-2"}),"Forward"]})]})})]})]})})]})})})})]})})}a.s(["default",()=>z],62364)}];

//# sourceMappingURL=_3541adcb._.js.map