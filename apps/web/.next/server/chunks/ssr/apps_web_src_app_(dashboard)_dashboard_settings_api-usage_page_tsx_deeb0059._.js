module.exports=[173079,a=>{"use strict";var b=a.i(504348),c=a.i(429969),d=a.i(465807),e=a.i(634332),f=a.i(123523),g=a.i(836040),h=a.i(862875);let i=(0,a.i(543474).default)("server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);var j=a.i(142969),k=a.i(646620),l=a.i(276480);a.i(150644);var m=a.i(236028);a.i(174010);var n=a.i(705991);a.i(502549);var o=a.i(236433),p=a.i(933427);let q=new class{baseUrl="https://api.telnyx.com/v2";apiKey;constructor(){const a=process.env.TELNYX_API_KEY;a||console.warn("TELNYX_API_KEY not set - Telnyx usage tracking disabled"),this.apiKey=a||""}async fetch(a,b){if(!this.apiKey)return null;let c=new URL(`${this.baseUrl}${a}`);b&&Object.entries(b).forEach(([a,b])=>{c.searchParams.append(a,b)});try{let a=await fetch(c.toString(),{headers:{Authorization:`Bearer ${this.apiKey}`,"Content-Type":"application/json"}});if(!a.ok)return console.error(`Telnyx API error: ${a.status} ${a.statusText}`),null;return await a.json()}catch(a){return console.error("Telnyx API fetch error:",a),null}}getCurrentMonthRange(){let a=new Date,b=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59);return{startDate:b.toISOString(),endDate:c.toISOString()}}async getVoiceUsage(a,b){let c=a&&b?{startDate:a,endDate:b}:this.getCurrentMonthRange(),d=await this.fetch("/reports/cdr_usage_reports/sync",{start_date:c.startDate,end_date:c.endDate});if(!d?.data)return null;let{aggregations:e,records:f}=d.data,g=0,h=0;if(f)for(let a of f){let b=a.duration/60;"inbound"===a.direction?g+=b:h+=b}return{total_minutes:e.total_duration/60,inbound_minutes:g,outbound_minutes:h,total_calls:e.record_count,total_cost_cents:Math.round(100*e.total_cost)}}async getSmsUsage(a,b){let c=new Date,d=new Date(c.getTime()-864e6),e=await this.fetch("/messages",{"page[size]":"250","filter[created_at][gte]":d.toISOString(),"filter[created_at][lte]":c.toISOString()});if(!e?.data)return null;let f=0,g=0,h=0;for(let a of e.data)"outbound"===a.direction?f+=a.parts:g+=a.parts,h+=Math.round(100*parseFloat(a.cost.amount));return{total_messages:f+g,outbound_messages:f,inbound_messages:g,total_cost_cents:h}}async getCurrentMonthUsage(){let[a,b]=await Promise.all([this.getVoiceUsage(),this.getSmsUsage()]);return{voice:a,sms:b,total_cost_cents:(a?.total_cost_cents||0)+(b?.total_cost_cents||0)}}async checkHealth(){let a=Date.now();try{let b=await fetch(`${this.baseUrl}/connections`,{headers:{Authorization:`Bearer ${this.apiKey}`}}),c=Date.now()-a;if(b.ok)return{healthy:!0,responseTimeMs:c};return{healthy:!1,responseTimeMs:c,error:`HTTP ${b.status}: ${b.statusText}`}}catch(b){return{healthy:!1,responseTimeMs:Date.now()-a,error:b instanceof Error?b.message:"Unknown error"}}}},r=new class{baseUrl="https://api.supabase.com/v1";accessToken;projectRef;constructor(){const a=process.env.SUPABASE_MANAGEMENT_PAT,b="https://togejqdwggezkxahomeh.supabase.co".match(/https:\/\/([^.]+)\.supabase\.co/)?.[1];a||console.warn("SUPABASE_MANAGEMENT_PAT not set - Supabase usage tracking disabled"),this.accessToken=a||"",this.projectRef=b||""}async fetch(a,b){if(!this.accessToken||!this.projectRef)return null;let c=new URL(`${this.baseUrl}${a}`);b&&Object.entries(b).forEach(([a,b])=>{c.searchParams.append(a,b)});try{let a=await fetch(c.toString(),{headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}});if(!a.ok)return console.error(`Supabase API error: ${a.status} ${a.statusText}`),null;return await a.json()}catch(a){return console.error("Supabase API fetch error:",a),null}}async getApiCounts(a="daily"){let b=await this.fetch(`/projects/${this.projectRef}/analytics/endpoints/usage.api-counts`,{interval:a});return b?.data||null}async getTotalApiRequestCount(){let a=await this.fetch(`/projects/${this.projectRef}/analytics/endpoints/usage.api-requests-count`);return a?.count||null}async getDatabaseSize(){return null}async getCurrentPeriodUsage(){let a=await this.getApiCounts("daily");return a&&0!==a.length?a.reduce((a,b)=>({auth_requests:a.auth_requests+b.total_auth_requests,rest_requests:a.rest_requests+b.total_rest_requests,realtime_requests:a.realtime_requests+b.total_realtime_requests,storage_requests:a.storage_requests+b.total_storage_requests,total_requests:a.total_requests+b.total_auth_requests+b.total_rest_requests+b.total_realtime_requests+b.total_storage_requests}),{auth_requests:0,rest_requests:0,realtime_requests:0,storage_requests:0,total_requests:0}):null}async checkHealth(){let a=Date.now();try{let b=await fetch(`${this.baseUrl}/projects`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),c=Date.now()-a;if(b.ok)return{healthy:!0,responseTimeMs:c};return{healthy:!1,responseTimeMs:c,error:`HTTP ${b.status}: ${b.statusText}`}}catch(b){return{healthy:!1,responseTimeMs:Date.now()-a,error:b instanceof Error?b.message:"Unknown error"}}}},s=new class{projectId;billingAccountId;accessToken;constructor(){this.projectId=process.env.GOOGLE_CLOUD_PROJECT_ID||"",this.billingAccountId=process.env.GOOGLE_CLOUD_BILLING_ACCOUNT_ID||"",this.accessToken=process.env.GOOGLE_CLOUD_ACCESS_TOKEN||"",this.projectId||console.warn("GOOGLE_CLOUD_PROJECT_ID not set - Google Cloud tracking disabled")}async fetch(a){if(!this.accessToken)return null;try{let b=await fetch(a,{headers:{Authorization:`Bearer ${this.accessToken}`,"Content-Type":"application/json"}});if(!b.ok)return console.error(`Google Cloud API error: ${b.status} ${b.statusText}`),null;return await b.json()}catch(a){return console.error("Google Cloud API fetch error:",a),null}}async getEnabledServices(){let a=await this.fetch(`https://serviceusage.googleapis.com/v1/projects/${this.projectId}/services?filter=state:ENABLED`);return a?.services?a.services.map(a=>a.config.name):null}async getAIUsage(){return{gemini_requests:0,gemini_tokens_input:0,gemini_tokens_output:0,document_ai_pages:0,vision_requests:0,speech_minutes:0,translation_characters:0,total_cost_cents:0}}async getCurrentMonthBilling(){if(!this.billingAccountId)return null;let a=new Date,b=new Date(a.getFullYear(),a.getMonth(),1),c=`https://cloudbilling.googleapis.com/v1/billingAccounts/${this.billingAccountId}/budgets`,d=await this.fetch(c);return d?.budgets?d.budgets.map(a=>({service_name:"all_services",display_name:"All Google Cloud Services",usage_amount:1,usage_unit:"budget",cost_usd:parseFloat(a.currentSpend?.units||"0"),month:b.toISOString().slice(0,7)})):null}async getMapsUsage(){return{geocoding_requests:0,places_requests:0,directions_requests:0,static_maps_requests:0,total_cost_cents:0}}async checkHealth(){let a=Date.now();try{let b=await fetch(`https://serviceusage.googleapis.com/v1/projects/${this.projectId}/services?pageSize=1`,{headers:{Authorization:`Bearer ${this.accessToken}`}}),c=Date.now()-a;if(b.ok)return{healthy:!0,responseTimeMs:c};if(401===b.status||403===b.status)return{healthy:!0,responseTimeMs:c,error:"Authentication required - API is available"};return{healthy:!1,responseTimeMs:c,error:`HTTP ${b.status}: ${b.statusText}`}}catch(b){return{healthy:!1,responseTimeMs:Date.now()-a,error:b instanceof Error?b.message:"Unknown error"}}}},t=new class{baseUrl="https://api.stripe.com/v1";secretKey;constructor(){const a=process.env.STRIPE_SECRET_KEY;a||console.warn("STRIPE_SECRET_KEY not set - Stripe billing tracking disabled"),this.secretKey=a||""}async fetch(a,b){if(!this.secretKey)return null;let c=new URL(`${this.baseUrl}${a}`);b&&Object.entries(b).forEach(([a,b])=>{c.searchParams.append(a,b)});try{let a=await fetch(c.toString(),{headers:{Authorization:`Bearer ${this.secretKey}`,"Content-Type":"application/x-www-form-urlencoded"}});if(!a.ok)return console.error(`Stripe API error: ${a.status} ${a.statusText}`),null;return await a.json()}catch(a){return console.error("Stripe API fetch error:",a),null}}getCurrentMonthRange(){let a=new Date,b=new Date(a.getFullYear(),a.getMonth(),1),c=new Date(a.getFullYear(),a.getMonth()+1,0,23,59,59);return{startTimestamp:Math.floor(b.getTime()/1e3),endTimestamp:Math.floor(c.getTime()/1e3)}}async getBalanceTransactions(a=100){let{startTimestamp:b,endTimestamp:c}=this.getCurrentMonthRange(),d=await this.fetch("/balance_transactions",{limit:a.toString(),"created[gte]":b.toString(),"created[lte]":c.toString()});return d?.data||null}async getCurrentMonthStats(){let a=await this.getBalanceTransactions(100);if(!a)return null;let b=0,c=0,d=0,e=0,f=0;for(let g of a)switch(g.type){case"charge":b+=g.amount,c+=g.net,d+=g.fee,f++;break;case"refund":e+=Math.abs(g.amount),c+=g.net;break;case"payout":break;default:c+=g.net,d+=g.fee}return{gross_volume_cents:b,net_volume_cents:c,fees_cents:d,refunds_cents:e,transaction_count:f,average_transaction_cents:f>0?Math.round(b/f):0}}async getUsage(){let{startTimestamp:a,endTimestamp:b}=this.getCurrentMonthRange(),c=await this.fetch("/charges",{limit:"100","created[gte]":a.toString(),"created[lte]":b.toString()}),d=await this.fetch("/disputes",{limit:"100","created[gte]":a.toString(),"created[lte]":b.toString()});if(!c?.data)return null;let e=c.data,f=d?.data||[],g=0,h=0,i=0,j=0,k=0;for(let a of e)"succeeded"===a.status?(h++,g+=a.amount):"failed"===a.status&&i++,(a.refunded||a.amount_refunded>0)&&(j++,k+=a.amount_refunded);let l=Math.round(.029*g+30*h);return{total_transactions:e.length,total_volume_cents:g,total_fees_cents:l,successful_charges:h,failed_charges:i,refunds_count:j,refunds_amount_cents:k,disputes_count:f.length}}async getBalance(){let a=await this.fetch("/balance");if(!a)return null;let b=a.available.find(a=>"usd"===a.currency)||a.available[0],c=a.pending.find(a=>"usd"===a.currency)||a.pending[0];return{available_cents:b?.amount||0,pending_cents:c?.amount||0,currency:b?.currency||"usd"}}static calculateFee(a,b={}){let c=.029;return b.isInternational&&(c+=.005),b.hasCurrencyConversion&&(c+=.01),Math.round(a*c)+30}static calculateNetAmount(a,b={}){let c=this.calculateFee(a,b);return a-c}async checkHealth(){let a=Date.now();try{let b=await fetch(`${this.baseUrl}/balance`,{headers:{Authorization:`Bearer ${this.secretKey}`}}),c=Date.now()-a;if(b.ok)return{healthy:!0,responseTimeMs:c};return{healthy:!1,responseTimeMs:c,error:`HTTP ${b.status}: ${b.statusText}`}}catch(b){return{healthy:!1,responseTimeMs:Date.now()-a,error:b instanceof Error?b.message:"Unknown error"}}}},u={google_gemini:{serviceName:"google_gemini",displayName:"Google Gemini AI",category:"ai",provider:"google",freeTier:{limit:1500,period:"daily",unit:"requests"},costAfterFree:{cents:7.5,perUnits:1e6,unit:"tokens"},baseCostCents:0,hasExternalApi:!0,healthCheckEndpoint:"https://generativelanguage.googleapis.com/v1/models",warningThresholdPct:80,criticalThresholdPct:95,description:"Gemini AI for text generation, chat, and multimodal tasks"},google_document_ai:{serviceName:"google_document_ai",displayName:"Document AI",category:"ai",provider:"google",freeTier:{limit:1e3,period:"monthly",unit:"pages"},costAfterFree:{cents:1,perUnits:1,unit:"page"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Document parsing, OCR, and form extraction"},google_vision:{serviceName:"google_vision",displayName:"Vision AI",category:"ai",provider:"google",freeTier:{limit:1e3,period:"monthly",unit:"requests"},costAfterFree:{cents:150,perUnits:1e3,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Image analysis, OCR, and object detection"},google_speech_to_text:{serviceName:"google_speech_to_text",displayName:"Speech-to-Text",category:"ai",provider:"google",freeTier:{limit:60,period:"monthly",unit:"minutes"},costAfterFree:{cents:60,perUnits:1,unit:"minute"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Audio transcription and speech recognition"},google_text_to_speech:{serviceName:"google_text_to_speech",displayName:"Text-to-Speech",category:"ai",provider:"google",freeTier:{limit:4e6,period:"monthly",unit:"characters"},costAfterFree:{cents:400,perUnits:1e6,unit:"characters"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Text to natural speech synthesis"},google_translation:{serviceName:"google_translation",displayName:"Translation",category:"ai",provider:"google",freeTier:{limit:5e5,period:"monthly",unit:"characters"},costAfterFree:{cents:2e3,perUnits:1e6,unit:"characters"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Language translation services"},google_geocoding:{serviceName:"google_geocoding",displayName:"Geocoding",category:"google_maps",provider:"google",freeTier:{limit:1e4,period:"monthly",unit:"requests"},costAfterFree:{cents:50,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Address to coordinates conversion"},google_directions:{serviceName:"google_directions",displayName:"Directions",category:"google_maps",provider:"google",freeTier:{limit:1e4,period:"monthly",unit:"requests"},costAfterFree:{cents:50,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Route planning and navigation"},google_places:{serviceName:"google_places",displayName:"Places",category:"google_maps",provider:"google",freeTier:{limit:1e4,period:"monthly",unit:"requests"},costAfterFree:{cents:170,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Place search, details, and autocomplete"},google_distance_matrix:{serviceName:"google_distance_matrix",displayName:"Distance Matrix",category:"google_maps",provider:"google",freeTier:{limit:1e4,period:"monthly",unit:"requests"},costAfterFree:{cents:50,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Travel distance and time calculations"},google_maps_static:{serviceName:"google_maps_static",displayName:"Maps Static",category:"google_maps",provider:"google",freeTier:{limit:25e3,period:"monthly",unit:"requests"},costAfterFree:{cents:20,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Static map image generation"},google_street_view:{serviceName:"google_street_view",displayName:"Street View",category:"google_maps",provider:"google",freeTier:{limit:25e3,period:"monthly",unit:"requests"},costAfterFree:{cents:70,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Street-level imagery"},google_routes:{serviceName:"google_routes",displayName:"Routes API",category:"google_maps",provider:"google",freeTier:{limit:1e4,period:"monthly",unit:"requests"},costAfterFree:{cents:50,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Advanced routing with traffic awareness"},google_elevation:{serviceName:"google_elevation",displayName:"Elevation",category:"google_maps",provider:"google",freeTier:null,costAfterFree:{cents:50,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Terrain elevation data"},google_timezone:{serviceName:"google_timezone",displayName:"Time Zone",category:"google_maps",provider:"google",freeTier:null,costAfterFree:{cents:50,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Time zone lookups by location"},supabase:{serviceName:"supabase",displayName:"Supabase",category:"infrastructure",provider:"supabase",freeTier:null,costAfterFree:null,baseCostCents:2500,hasExternalApi:!0,healthCheckEndpoint:"https://api.supabase.com/v1/projects",warningThresholdPct:80,criticalThresholdPct:95,description:"Database, Auth, Storage, Edge Functions"},vercel:{serviceName:"vercel",displayName:"Vercel",category:"infrastructure",provider:"vercel",freeTier:{limit:1e3,period:"monthly",unit:"GB"},costAfterFree:{cents:15,perUnits:1,unit:"GB"},baseCostCents:2e3,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Hosting, Edge Functions, Analytics"},telnyx_voice:{serviceName:"telnyx_voice",displayName:"Telnyx Voice",category:"communication",provider:"telnyx",freeTier:null,costAfterFree:{cents:90,perUnits:100,unit:"minute"},baseCostCents:0,hasExternalApi:!0,healthCheckEndpoint:"https://api.telnyx.com/v2/connections",warningThresholdPct:80,criticalThresholdPct:95,description:"VoIP calls and call control"},telnyx_sms:{serviceName:"telnyx_sms",displayName:"Telnyx SMS",category:"communication",provider:"telnyx",freeTier:null,costAfterFree:{cents:25,perUnits:100,unit:"message"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"SMS and MMS messaging"},resend:{serviceName:"resend",displayName:"Resend Email",category:"communication",provider:"resend",freeTier:{limit:3e3,period:"monthly",unit:"emails"},costAfterFree:{cents:9,perUnits:100,unit:"email"},baseCostCents:0,hasExternalApi:!1,healthCheckEndpoint:"https://api.resend.com/emails",warningThresholdPct:80,criticalThresholdPct:95,description:"Transactional email delivery"},assemblyai:{serviceName:"assemblyai",displayName:"AssemblyAI",category:"communication",provider:"assemblyai",freeTier:{limit:500,period:"monthly",unit:"credits"},costAfterFree:{cents:15,perUnits:1,unit:"hour"},baseCostCents:0,hasExternalApi:!0,warningThresholdPct:80,criticalThresholdPct:95,description:"Call transcription and audio intelligence"},attom:{serviceName:"attom",displayName:"ATTOM Property",category:"data",provider:"attom",freeTier:null,costAfterFree:{cents:500,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Property data, valuations, sales history"},shovels:{serviceName:"shovels",displayName:"Shovels Permits",category:"data",provider:"shovels",freeTier:null,costAfterFree:{cents:300,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Building permits and contractor data"},walk_score:{serviceName:"walk_score",displayName:"Walk Score",category:"data",provider:"walkscore",freeTier:{limit:5e3,period:"daily",unit:"requests"},costAfterFree:{cents:10,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Walkability, transit, and bike scores"},crimeometer:{serviceName:"crimeometer",displayName:"CrimeoMeter",category:"data",provider:"crimeometer",freeTier:null,costAfterFree:{cents:500,perUnits:100,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Real-time crime data and safety scores"},fema_flood:{serviceName:"fema_flood",displayName:"FEMA Flood",category:"data",provider:"fema",freeTier:null,costAfterFree:{cents:0,perUnits:1,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Flood zone and risk data (free)"},census_bureau:{serviceName:"census_bureau",displayName:"Census Bureau",category:"data",provider:"census",freeTier:null,costAfterFree:{cents:0,perUnits:1,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Demographics and housing data (free)"},fbi_crime:{serviceName:"fbi_crime",displayName:"FBI Crime Data",category:"data",provider:"fbi",freeTier:null,costAfterFree:{cents:0,perUnits:1,unit:"request"},baseCostCents:0,hasExternalApi:!1,warningThresholdPct:80,criticalThresholdPct:95,description:"Crime statistics by state (free)"},stripe:{serviceName:"stripe",displayName:"Stripe",category:"payments",provider:"stripe",freeTier:null,costAfterFree:{percentage:2.9,fixedCents:30,unit:"transaction"},baseCostCents:0,hasExternalApi:!0,healthCheckEndpoint:"https://api.stripe.com/v1/balance",warningThresholdPct:80,criticalThresholdPct:95,description:"Payment processing (2.9% + $0.30)"}};async function v(){let a=(0,p.createServiceSupabaseClient)(),b=new Date().toISOString().slice(0,7),{data:c,error:d}=await a.from("api_usage_realtime").select("*").eq("month",b);if(d)return console.error("Error fetching usage:",d),null;let e=Object.entries(u).map(([a,b])=>{var d;let e,f,g=c?.find(b=>b.service_id===a),h=g?.usage_count||0,i=g?.cost_cents||0,j=g?.free_tier_remaining,k=b.free_tier?(d=b.free_tier,(e=u[h])&&e.freeTier?Math.min(100,d/e.freeTier.limit*100):null):0;return{service_id:a,display_name:b.display_name,category:b.category,usage_count:h,cost_cents:i,free_tier_remaining:j,free_tier_percentage:k,alert_level:(f=u[k])?(void 0)>=f.criticalThresholdPct?"critical":(void 0)>=f.warningThresholdPct?"warning":"ok":"ok",last_synced:g?.last_synced||null}}),f=e.reduce((a,b)=>a+b.cost_cents,0),g=e.filter(a=>"warning"===a.alert_level||"critical"===a.alert_level).length;return{services:e,total_cost_cents:f,services_at_risk:g}}async function w(){let a=await v();return a?a.services.filter(a=>"warning"===a.alert_level||"critical"===a.alert_level).map(a=>{let b=u[a.service_id];return{service_id:a.service_id,display_name:a.display_name,usage_count:a.usage_count,free_tier_limit:b?.free_tier?.monthly_limit||0,percentage_used:a.free_tier_percentage,alert_level:a.alert_level}}).sort((a,b)=>b.percentage_used-a.percentage_used):[]}let x={telnyx_voice:{check:()=>q.checkHealth()},telnyx_sms:{check:()=>q.checkHealth()},supabase_database:{check:()=>r.checkHealth()},supabase_auth:{check:()=>r.checkHealth()},supabase_storage:{check:()=>r.checkHealth()},supabase_realtime:{check:()=>r.checkHealth()},google_gemini:{check:()=>s.checkHealth()},google_maps_geocoding:{check:()=>B()},stripe_payments:{check:()=>t.checkHealth()},resend:{check:()=>A("https://api.resend.com/emails","Resend")},assembly_ai:{check:()=>A("https://api.assemblyai.com/v2/transcript","AssemblyAI")},walkscore:{check:()=>A("https://api.walkscore.com/score","WalkScore")},census_bureau:{check:()=>A("https://api.census.gov/data.json","Census Bureau")},vercel_hosting:{check:()=>C()}};async function y(){let a=(0,p.createServiceSupabaseClient)(),b=new Date,c=new Date(b.getTime()-864e5),d=new Date(b.getTime()-6048e5),e=new Date(b.getTime()-2592e6),f=[];for(let[b,g]of Object.entries(u)){if(!x[b])continue;let{data:h}=await a.from("api_health_log").select("is_healthy, response_time_ms").eq("service_id",b).gte("checked_at",c.toISOString()),{data:i}=await a.from("api_health_log").select("is_healthy").eq("service_id",b).gte("checked_at",d.toISOString()),{data:j}=await a.from("api_health_log").select("is_healthy").eq("service_id",b).gte("checked_at",e.toISOString()),{data:k}=await a.from("api_health_log").select("*").eq("service_id",b).order("checked_at",{ascending:!1}).limit(1).single(),l=a=>a&&0!==a.length?Math.round(a.filter(a=>a.is_healthy).length/a.length*1e4)/100:100,m=a=>a&&0!==a.length?Math.round(a.reduce((a,b)=>a+(b.response_time_ms||0),0)/a.length):0,{data:n}=await a.from("api_health_log").select("is_healthy").eq("service_id",b).order("checked_at",{ascending:!1}).limit(10),o=0;if(n)for(let a of n)if(a.is_healthy)break;else o++;let p="healthy",q=l(h);o>=3||q<50?p="down":(o>=1||q<95)&&(p="degraded"),f.push({service_id:b,display_name:g.display_name,category:g.category,current_status:p,uptime_24h:q,uptime_7d:l(i),uptime_30d:l(j),average_response_ms:m(h),last_checked:k?.checked_at||null,last_error:k?.error_message||null,consecutive_failures:o})}return f}async function z(){let a=await y(),b=a.filter(a=>"healthy"===a.current_status).length,c=a.filter(a=>"degraded"===a.current_status).length,d=a.filter(a=>"down"===a.current_status).length,e=a.length>0?a.reduce((a,b)=>a+b.uptime_24h,0)/a.length:100,f="healthy";return d>0||e<90?f="critical":(c>0||e<99)&&(f="degraded"),{overall_status:f,healthy_services:b,degraded_services:c,down_services:d,average_uptime_24h:Math.round(100*e)/100,services:a}}async function A(a,b){let c=Date.now();try{let b=await fetch(a,{method:"HEAD",signal:AbortSignal.timeout(1e4)}),d=Date.now()-c;if(b.status<500)return{healthy:!0,responseTimeMs:d};return{healthy:!1,responseTimeMs:d,error:`HTTP ${b.status}`}}catch(a){return{healthy:!1,responseTimeMs:Date.now()-c,error:a instanceof Error?a.message:"Connection failed"}}}async function B(){return A("https://maps.googleapis.com/maps/api/geocode/json?address=test&key=AIzaSyCVKN0pddG230vvjT0EMP9sSIR31j1q2t0","Google Maps")}async function C(){let a="http://localhost:3000",b=a.startsWith("http")?a:`https://${a}`;return A(`${b}/api/health`,"Vercel")}function D(a){return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(a/100)}function E(a){return a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toString()}async function F(){let[a,c,p]=await Promise.all([v(),w(),z()]),q=new Date().getDate(),r=new Date(new Date().getFullYear(),new Date().getMonth()+1,0).getDate(),s=a?Math.round(a.total_cost_cents/Math.max(q,1)*r):0,t={};if(a?.services)for(let b of a.services)t[b.category]||(t[b.category]=[]),t[b.category].push(b);return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"API Usage & Costs"}),(0,b.jsx)("p",{className:"text-muted-foreground mt-2",children:"Monitor API usage, costs, and service health across all integrations"})]}),(0,b.jsx)("div",{className:"flex items-center gap-2",children:p&&(0,b.jsxs)(m.Badge,{variant:"healthy"===p.overall_status?"default":"degraded"===p.overall_status?"secondary":"destructive",className:"text-sm",children:["healthy"===p.overall_status&&(0,b.jsx)(f.CheckCircle,{className:"mr-1 h-3 w-3"}),"degraded"===p.overall_status&&(0,b.jsx)(e.AlertTriangle,{className:"mr-1 h-3 w-3"}),"critical"===p.overall_status&&(0,b.jsx)(d.AlertCircle,{className:"mr-1 h-3 w-3"}),"System ",p.overall_status]})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{className:"pb-3",children:(0,b.jsxs)(n.CardTitle,{className:"text-muted-foreground flex items-center gap-2 text-sm font-medium",children:[(0,b.jsx)(h.DollarSign,{className:"h-4 w-4"}),"Current Month Cost"]})}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:D(a?.total_cost_cents||0)}),(0,b.jsxs)("p",{className:"text-muted-foreground mt-1 text-xs",children:["Projected: ",D(s)," by month end"]})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{className:"pb-3",children:(0,b.jsxs)(n.CardTitle,{className:"text-muted-foreground flex items-center gap-2 text-sm font-medium",children:[(0,b.jsx)(j.TrendingUp,{className:"h-4 w-4"}),"Services at Risk"]})}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsx)("div",{className:`text-3xl font-bold ${c.length>0?"text-yellow-600":"text-green-600"}`,children:c.length}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-xs",children:"Approaching free tier limits"})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{className:"pb-3",children:(0,b.jsxs)(n.CardTitle,{className:"text-muted-foreground flex items-center gap-2 text-sm font-medium",children:[(0,b.jsx)(i,{className:"h-4 w-4"}),"Services Monitored"]})}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsx)("div",{className:"text-3xl font-bold",children:a?.services.length||0}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-xs",children:"Active integrations tracked"})]})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{className:"pb-3",children:(0,b.jsxs)(n.CardTitle,{className:"text-muted-foreground flex items-center gap-2 text-sm font-medium",children:[(0,b.jsx)(k.Wifi,{className:"h-4 w-4"}),"System Uptime"]})}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsxs)("div",{className:`text-3xl font-bold ${function(a){switch(a){case"down":return"text-red-600";case"degraded":return"text-yellow-600";default:return"text-green-600"}}(p?.overall_status||"healthy")}`,children:[p?.average_uptime_24h.toFixed(1)||100,"%"]}),(0,b.jsx)("p",{className:"text-muted-foreground mt-1 text-xs",children:"24-hour average"})]})]})]}),c.length>0&&(0,b.jsxs)(n.Card,{className:"border-yellow-300 bg-yellow-50 dark:border-yellow-900 dark:bg-yellow-900/20",children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsxs)(n.CardTitle,{className:"flex items-center gap-2 text-yellow-700 dark:text-yellow-400",children:[(0,b.jsx)(e.AlertTriangle,{className:"h-5 w-5"}),"Services Approaching Free Tier Limits"]}),(0,b.jsx)(n.CardDescription,{className:"text-yellow-600 dark:text-yellow-500",children:"These services are nearing their free tier limits and may incur charges soon"})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:c.map(a=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg bg-white p-4 dark:bg-gray-900",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.display_name}),(0,b.jsx)(m.Badge,{variant:"critical"===a.alert_level?"destructive":"secondary",className:"text-xs",children:"critical"===a.alert_level?"Critical":"Warning"})]}),(0,b.jsxs)("p",{className:"text-muted-foreground mt-1 text-sm",children:[E(a.usage_count)," / ",E(a.free_tier_limit)," used"]})]}),(0,b.jsxs)("div",{className:"w-32",children:[(0,b.jsx)(o.Progress,{value:a.percentage_used,className:"critical"===a.alert_level?"[&>div]:bg-red-500":"[&>div]:bg-yellow-500"}),(0,b.jsxs)("p",{className:"text-muted-foreground mt-1 text-right text-xs",children:[a.percentage_used.toFixed(1),"%"]})]})]},a.service_id))})})]}),p&&(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(k.Wifi,{className:"h-5 w-5"}),"Service Health Status"]}),(0,b.jsx)(n.CardDescription,{children:"Real-time availability monitoring for all external services"})]}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsxs)("div",{className:"mb-4 flex gap-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-green-500"}),(0,b.jsxs)("span",{className:"text-sm",children:[p.healthy_services," Healthy"]})]}),p.degraded_services>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-yellow-500"}),(0,b.jsxs)("span",{className:"text-sm",children:[p.degraded_services," Degraded"]})]}),p.down_services>0&&(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:"h-3 w-3 rounded-full bg-red-500"}),(0,b.jsxs)("span",{className:"text-sm",children:[p.down_services," Down"]})]})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4 lg:grid-cols-6",children:p.services.map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-2 rounded-lg border p-2",children:["healthy"===a.current_status?(0,b.jsx)(f.CheckCircle,{className:"h-4 w-4 text-green-500"}):"degraded"===a.current_status?(0,b.jsx)(e.AlertTriangle,{className:"h-4 w-4 text-yellow-500"}):(0,b.jsx)(l.WifiOff,{className:"h-4 w-4 text-red-500"}),(0,b.jsx)("span",{className:"truncate text-xs",children:a.display_name})]},a.service_id))})]})]}),Object.entries(t).map(([a,c])=>(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(n.CardTitle,{className:"capitalize",children:a.replace(/_/g," ")}),(0,b.jsxs)(n.CardDescription,{children:["Usage and costs for ",a.replace(/_/g," ").toLowerCase()," services"]})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:c.map(a=>{let c=u[a.service_id],d=c?.free_tier,e=c?.free_tier?.monthly_limit||0;return(0,b.jsx)("div",{className:"rounded-lg border p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"font-medium",children:a.display_name}),"normal"!==a.alert_level&&(0,b.jsx)(m.Badge,{variant:"critical"===a.alert_level?"destructive":"secondary",className:"text-xs",children:"critical"===a.alert_level?"95%+":"80%+"})]}),(0,b.jsxs)("div",{className:"text-muted-foreground mt-1 flex items-center gap-4 text-sm",children:[(0,b.jsxs)("span",{children:["Usage: ",(0,b.jsx)("strong",{children:E(a.usage_count)}),d&&` / ${E(e)}`]}),a.cost_cents>0&&(0,b.jsxs)("span",{children:["Cost: ",(0,b.jsx)("strong",{children:D(a.cost_cents)})]}),a.last_synced&&(0,b.jsxs)("span",{className:"flex items-center gap-1 text-xs",children:[(0,b.jsx)(g.Clock,{className:"h-3 w-3"}),"Synced ",new Date(a.last_synced).toLocaleTimeString()]})]})]}),d&&(0,b.jsxs)("div",{className:"w-40",children:[(0,b.jsx)(o.Progress,{value:a.free_tier_percentage,className:`${"critical"===a.alert_level?"[&>div]:bg-red-500":"warning"===a.alert_level?"[&>div]:bg-yellow-500":"[&>div]:bg-green-500"}`}),(0,b.jsxs)("div",{className:"text-muted-foreground mt-1 flex justify-between text-xs",children:[(0,b.jsx)("span",{children:"Free tier"}),(0,b.jsxs)("span",{children:[a.free_tier_percentage.toFixed(1),"%"]})]})]})]})},a.service_id)})})})]},a)),(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsxs)(n.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(h.DollarSign,{className:"h-5 w-5"}),"Monthly Cost Breakdown"]}),(0,b.jsx)(n.CardDescription,{children:"Estimated costs by service category"})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[Object.entries(t).map(([c,d])=>{let e=d.reduce((a,b)=>a+b.cost_cents,0),f=a?.total_cost_cents?e/a.total_cost_cents*100:0;return(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("div",{className:"font-medium capitalize",children:c.replace(/_/g," ")}),(0,b.jsxs)("div",{className:"text-muted-foreground text-sm",children:[d.length," services"]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)("div",{className:"w-32",children:(0,b.jsx)(o.Progress,{value:f})}),(0,b.jsx)("div",{className:"w-20 text-right font-medium",children:D(e)})]})]},c)}),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between border-t pt-4",children:[(0,b.jsx)("div",{className:"text-lg font-bold",children:"Total Estimated Cost"}),(0,b.jsx)("div",{className:"text-lg font-bold",children:D(a?.total_cost_cents||0)})]})]})})]}),(0,b.jsxs)(n.Card,{className:"bg-muted/50",children:[(0,b.jsx)(n.CardHeader,{children:(0,b.jsx)(n.CardTitle,{children:"About API Usage Tracking"})}),(0,b.jsxs)(n.CardContent,{className:"space-y-4",children:[(0,b.jsx)("p",{className:"text-muted-foreground text-sm",children:"This dashboard provides real-time monitoring of all external API integrations used by Stratos:"}),(0,b.jsxs)("ul",{className:"text-muted-foreground list-inside list-disc space-y-2 text-sm",children:[(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Usage Tracking"})," - Monitor API calls, tokens, and resource consumption"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Free Tier Alerts"})," - Get warned at 80% and 95% of free tier limits"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Cost Estimation"})," - Track actual costs and project monthly expenses"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Health Monitoring"})," - Real-time availability and uptime tracking"]}),(0,b.jsxs)("li",{children:[(0,b.jsx)("strong",{children:"Automatic Sync"})," - Usage data is synced hourly from provider APIs"]})]}),(0,b.jsx)("div",{className:"border-t pt-4",children:(0,b.jsxs)("p",{className:"text-muted-foreground text-xs",children:[(0,b.jsx)("strong",{children:"Note:"})," Cost estimates are based on current usage patterns. Actual charges may vary. Some services (like internal tracking) show usage without costs as they are included in your subscription."]})})]})]})]})}a.i(416128);var G=a.i(109483);function H(){return(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(G.Skeleton,{className:"h-9 w-64"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-5 w-96"})]}),(0,b.jsx)(G.Skeleton,{className:"h-6 w-32"})]}),(0,b.jsx)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-4",children:[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)(n.Card,{children:[(0,b.jsx)(n.CardHeader,{className:"pb-3",children:(0,b.jsx)(G.Skeleton,{className:"h-4 w-32"})}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsx)(G.Skeleton,{className:"h-9 w-24"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-3 w-40"})]})]},c))}),(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(G.Skeleton,{className:"h-6 w-64"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-4 w-96"})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-4",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(G.Skeleton,{className:"h-5 w-40"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-4 w-32"})]}),(0,b.jsx)(G.Skeleton,{className:"h-2 w-32"})]},c))})})]}),(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(G.Skeleton,{className:"h-6 w-48"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-4 w-72"})]}),(0,b.jsxs)(n.CardContent,{children:[(0,b.jsxs)("div",{className:"mb-4 flex gap-4",children:[(0,b.jsx)(G.Skeleton,{className:"h-5 w-24"}),(0,b.jsx)(G.Skeleton,{className:"h-5 w-24"}),(0,b.jsx)(G.Skeleton,{className:"h-5 w-24"})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2 md:grid-cols-4 lg:grid-cols-6",children:[...Array(12)].map((a,c)=>(0,b.jsx)(G.Skeleton,{className:"h-10 w-full"},c))})]})]}),[void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(G.Skeleton,{className:"h-6 w-40"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-4 w-64"})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsx)("div",{className:"space-y-4",children:[void 0,void 0,void 0].map((a,c)=>(0,b.jsx)("div",{className:"rounded-lg border p-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(G.Skeleton,{className:"h-5 w-48"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-4 w-64"})]}),(0,b.jsx)(G.Skeleton,{className:"h-2 w-40"})]})},c))})})]},c)),(0,b.jsxs)(n.Card,{children:[(0,b.jsxs)(n.CardHeader,{children:[(0,b.jsx)(G.Skeleton,{className:"h-6 w-48"}),(0,b.jsx)(G.Skeleton,{className:"mt-2 h-4 w-56"})]}),(0,b.jsx)(n.CardContent,{children:(0,b.jsxs)("div",{className:"space-y-4",children:[[void 0,void 0,void 0,void 0].map((a,c)=>(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(G.Skeleton,{className:"h-5 w-32"}),(0,b.jsx)(G.Skeleton,{className:"mt-1 h-4 w-24"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(G.Skeleton,{className:"h-2 w-32"}),(0,b.jsx)(G.Skeleton,{className:"h-5 w-20"})]})]},c)),(0,b.jsxs)("div",{className:"mt-4 flex items-center justify-between border-t pt-4",children:[(0,b.jsx)(G.Skeleton,{className:"h-6 w-48"}),(0,b.jsx)(G.Skeleton,{className:"h-6 w-24"})]})]})})]})]})}function I(){return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(H,{}),children:(0,b.jsx)(F,{})})}a.s(["default",()=>I,"dynamic",0,"force-dynamic","metadata",0,{title:"API Usage & Costs | Settings",description:"Monitor API usage, costs, and service health across all integrations"}],173079)}];

//# sourceMappingURL=apps_web_src_app_%28dashboard%29_dashboard_settings_api-usage_page_tsx_deeb0059._.js.map