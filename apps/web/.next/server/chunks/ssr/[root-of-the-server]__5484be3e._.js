module.exports=[254799,(a,b,c)=>{b.exports=a.x("crypto",()=>require("crypto"))},666680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},81111,(a,b,c)=>{b.exports=a.x("node:stream",()=>require("node:stream"))},575202,a=>a.a(async(b,c)=>{try{let b=await a.y("prettier/plugins/html");a.n(b),c()}catch(a){c(a)}},!0),535167,a=>a.a(async(b,c)=>{try{let b=await a.y("prettier/standalone");a.n(b),c()}catch(a){c(a)}},!0),343860,a=>{"use strict";var b=a.i(933427);let c={urgency:["act now","limited time","urgent","immediate","expires","hurry","don't miss","last chance","final notice","deadline"],money:["free","$$$","cash","discount","save big","best price","cheap","bargain","bonus","prize","winner","congratulations"],suspicious:["click here","click below","buy now","order now","subscribe now","sign up free","no obligation","risk free","100% free","act immediately"],formatting:["ALL CAPS WORDS","!!!","???","$$$","***","###"]},d={urgency:2,money:3,suspicious:4,formatting:1.5,excessiveLinks:5,noUnsubscribe:3,shortContent:2,imageHeavy:3};async function e(a,c){let d=await (0,b.createServiceSupabaseClient)(),e=new Map;for(let a of c)e.set(a.toLowerCase(),{suppressed:!1});let{data:f}=await d.from("email_suppressions").select("email, reason, created_at").eq("company_id",a).in("email",c.map(a=>a.toLowerCase()));if(f)for(let a of f)e.set(a.email,{suppressed:!0,reason:a.reason,suppressedAt:a.created_at});let{data:g}=await d.from("email_global_bounces").select("email, bounce_type, created_at").in("email",c.map(a=>a.toLowerCase())).eq("bounce_type","hard");if(g)for(let a of g){let b=e.get(a.email);b?.suppressed||e.set(a.email,{suppressed:!0,reason:`Global hard bounce: ${a.bounce_type}`,suppressedAt:a.created_at})}return e}function f(a,b,e,f){let g,h=0,i=[],j=`${a} ${e}`.toLowerCase(),k=b.toLowerCase();for(let[a,b]of Object.entries(c)){let c=d[a]||1;for(let a of b){let b=RegExp(a.toLowerCase(),"gi"),d=j.match(b);d&&(h+=d.length*c,d.length>1&&i.push(`Contains "${a}" ${d.length} times`))}}let l=a.split(" ").filter(a=>a.length>3&&a===a.toUpperCase());l.length>0&&(h+=3*l.length,i.push(`Subject contains ${l.length} ALL CAPS words`));let m=(a.match(/!/g)||[]).length;m>1&&(h+=2*m,i.push(`Excessive exclamation marks in subject (${m})`));let n=(k.match(/<a\s/gi)||[]).length,o=e.split(/\s+/).length;o>0&&n/o>.1&&(h+=d.excessiveLinks,i.push(`High link density (${n} links in ${o} words)`)),(k.match(/<img\s/gi)||[]).length>0&&e.length<200&&(h+=d.imageHeavy,i.push("Image-heavy email with little text")),f||(h+=d.noUnsubscribe,i.push("Missing unsubscribe link (required for marketing emails)")),e.length<50&&(h+=d.shortContent,i.push("Very short email content")),(k.includes("display:none")||k.includes("font-size:0"))&&(h+=10,i.push("Contains hidden text (spam technique)"));let p=/<a[^>]*href=["']([^"']+)["'][^>]*>([^<]+)<\/a>/gi;for(;null!==(g=p.exec(b));){let a=g[1].toLowerCase(),b=g[2].toLowerCase();if(b.includes("click here")||b.includes("click this")||b.startsWith("http")&&!b.includes(new URL(a).hostname)){h+=5,i.push("Contains deceptive or vague link text");break}}return{score:Math.min(h,100),issues:i}}async function g(a){let c=await (0,b.createServiceSupabaseClient)(),{data:d}=await c.from("company_email_domains").select("created_at, emails_sent_today, total_emails_sent, warmup_completed").eq("id",a).single();if(!d)return{inWarmup:!0,daysSinceCreation:0,recommendedDailyLimit:10,currentDaySent:0,suggestions:["Domain not found"]};let e=new Date(d.created_at),f=Math.floor((new Date().getTime()-e.getTime())/864e5),g=20;for(let[a,b]of Object.entries({0:20,2:50,4:100,7:200,14:500,21:1e3,28:2500,35:5e3,42:1e4}))f>=parseInt(a)&&(g=b);let h=f<42&&!d.warmup_completed,i=[];return h&&(i.push(`Domain is in warm-up period (day ${f}/42). Recommended daily limit: ${g} emails.`),d.emails_sent_today>=.8*g&&i.push("Approaching daily warm-up limit. Consider spreading sends across multiple days.")),{inWarmup:h,daysSinceCreation:f,recommendedDailyLimit:g,currentDaySent:d.emails_sent_today||0,suggestions:i}}async function h(a){let c=await (0,b.createServiceSupabaseClient)(),{data:d}=await c.from("company_email_domains").select("status, is_suspended, sending_enabled, spf_verified, dkim_verified, dmarc_verified").eq("id",a).single();if(!d)return{canSend:!1,issues:["Domain not found"],dnsStatus:{spf:!1,dkim:!1,dmarc:!1}};let e=[];return"verified"!==d.status&&e.push(`Domain not verified (status: ${d.status})`),d.is_suspended&&e.push("Domain is suspended"),d.sending_enabled||e.push("Sending is disabled for this domain"),d.spf_verified||e.push("SPF record not verified - emails may fail authentication"),d.dkim_verified||e.push("DKIM not verified - emails may fail authentication"),d.dmarc_verified||e.push("DMARC not configured - reduces deliverability"),{canSend:0===e.length,issues:e,dnsStatus:{spf:d.spf_verified||!1,dkim:d.dkim_verified||!1,dmarc:d.dmarc_verified||!1}}}async function i(a,b,c,d,j,k,l=!1){let m=[],n=[],o=[],p=await h(b);p.canSend?p.dnsStatus.dmarc||m.push("DMARC not configured - consider adding for better deliverability"):n.push(...p.issues);let q=await e(a,c),r=[],s=0;for(let[a,b]of q)r.push({email:a,suppressed:b.suppressed,reason:b.reason}),b.suppressed&&s++;s>0&&m.push(`${s} recipient(s) on suppression list and will be skipped`),s===c.length&&n.push("All recipients are on suppression list - no emails will be sent");let t=j.includes("unsubscribe")||j.includes("List-Unsubscribe"),u=f(d,j,k,t||!l);u.score>=60?(n.push(`High spam score (${u.score}/100) - email likely to be filtered`),n.push(...u.issues)):u.score>=30&&(m.push(`Moderate spam score (${u.score}/100) - consider improvements`),m.push(...u.issues));let v=await g(b);if(v.inWarmup){o.push(...v.suggestions);let a=c.length-s,b=v.recommendedDailyLimit-v.currentDaySent;a>b&&m.push(`Sending ${a} emails exceeds warm-up limit (${b} remaining today). Consider sending over multiple days.`)}return j.includes("<!DOCTYPE")||j.includes("<html")||o.push("Consider using proper HTML structure with DOCTYPE for better rendering"),k.length<100&&o.push("Consider adding more text content - very short emails may look suspicious"),l&&!t&&n.push("Marketing emails MUST include an unsubscribe link (CAN-SPAM requirement)"),j.includes("{{")||j.includes("{name}")||d.includes("{{")||o.push("Consider adding personalization (recipient name, company) for better engagement"),{allowed:0===n.length,warnings:m,errors:n,suggestions:o,spamScore:u.score,recipientStatus:r}}async function j(a,c,d,e){let f=await (0,b.createServiceSupabaseClient)(),{error:g}=await f.from("email_suppressions").upsert({company_id:a,email:c.toLowerCase(),reason:d,details:e,created_at:new Date().toISOString()},{onConflict:"company_id,email"});return g?(console.error("Error adding to suppression list:",g),{success:!1,error:g.message}):{success:!0}}async function k(a,c,d){if("hard"!==c)return{success:!0};let e=await (0,b.createServiceSupabaseClient)(),{error:f}=await e.from("email_global_bounces").upsert({email:a.toLowerCase(),bounce_type:c,bounce_reason:d,bounce_count:1,last_bounce_at:new Date().toISOString(),created_at:new Date().toISOString()},{onConflict:"email"});return f?(console.error("Error adding to global bounce list:",f),{success:!1,error:f.message}):{success:!0}}async function l(a,c){let d=await (0,b.createServiceSupabaseClient)(),{error:e}=await d.from("email_suppressions").delete().eq("company_id",a).eq("email",c.toLowerCase());return e?(console.error("Error removing from suppression list:",e),{success:!1,error:e.message}):{success:!0}}async function m(a,c=100,d=0){let e=await (0,b.createServiceSupabaseClient)(),{data:f,count:g,error:h}=await e.from("email_suppressions").select("email, reason, details, created_at",{count:"exact"}).eq("company_id",a).order("created_at",{ascending:!1}).range(d,d+c-1);return h?(console.error("Error fetching suppression list:",h),{data:[],total:0}):{data:f||[],total:g||0}}a.s(["addToGlobalBounceList",()=>k,"addToSuppressionList",()=>j,"calculateSpamScore",()=>f,"checkDomainWarmup",()=>g,"checkSuppressionList",()=>e,"getSuppressionList",()=>m,"removeFromSuppressionList",()=>l,"runPreSendChecks",()=>i,"verifyDomainStatus",()=>h])},766734,a=>{"use strict";var b=a.i(504348),c=a.i(459208),d=a.i(313793);function e({href:a,children:e,variant:f="primary"}){let g={primary:{backgroundColor:d.EMAIL_COLORS.primary,color:d.EMAIL_COLORS.primaryText,border:"none"},outline:{backgroundColor:"transparent",color:d.EMAIL_COLORS.primary,border:`2px solid ${d.EMAIL_COLORS.primary}`}};return(0,b.jsx)(c.Button,{href:a,style:{display:"inline-block",padding:"12px 24px",fontSize:"16px",fontWeight:"600",textDecoration:"none",borderRadius:"8px",textAlign:"center",transition:"all 0.2s ease",...g[f]},children:e})}a.s(["Button",()=>e])},313793,130236,a=>{"use strict";let b={background:"#fafafa",surface:"#fcfcfc",surfaceStrong:"#f2f2f2",primary:"#3c6ff5",primaryText:"#fafafa",heading:"#171717",text:"#171717",muted:"#737373",border:"#e6e6e6"};a.s(["EMAIL_COLORS",0,b],313793);var c=a.i(504348),d=a.i(173686);function e({children:a,level:e=1,style:f}){let g=`h${e}`,h={1:{fontSize:"32px",fontWeight:"700",color:b.heading,margin:"0 0 16px 0",lineHeight:"1.2"},2:{fontSize:"24px",fontWeight:"600",color:b.text,margin:"0 0 12px 0",lineHeight:"1.3"},3:{fontSize:"18px",fontWeight:"600",color:b.muted,margin:"0 0 8px 0",lineHeight:"1.4"}};return(0,c.jsx)(d.Heading,{as:g,style:{...h[e],...f},children:a})}a.s(["Heading",()=>e],130236)},60847,a=>{"use strict";var b=a.i(504348),c=a.i(280105),d=a.i(995146),e=a.i(550042),f=a.i(858257),g=a.i(835929),h=a.i(54101),i=a.i(843775),j=a.i(225249),k=a.i(424340),l=a.i(402239),m=a.i(313793);let n=process.env.NEXT_PUBLIC_THORBIS_LOGO_URL||"https://thorbis.com/logo-white.png",o=process.env.NEXT_PUBLIC_WEBSITE_URL||"https://thorbis.com",p=process.env.THORBIS_SUPPORT_EMAIL||"support@thorbis.com",q=`${o}/docs`,r=`${o}/privacy`,s=`${o}/terms`;function t({children:a,previewText:m}){return(0,b.jsxs)(g.Html,{children:[(0,b.jsx)(e.Head,{children:(0,b.jsx)("style",{children:`
          @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

          /* Reset email client styles */
          body { margin: 0; padding: 0; }
          table { border-collapse: collapse; }
          img { border: 0; }

          /* Responsive */
          @media only screen and (max-width: 600px) {
            .mobile-padding { padding: 20px !important; }
            .mobile-text { font-size: 14px !important; }
            .mobile-heading { font-size: 24px !important; }
          }
        `})}),m&&(0,b.jsx)(j.Preview,{children:m}),(0,b.jsx)(c.Body,{style:u,children:(0,b.jsxs)(d.Container,{style:v,children:[(0,b.jsx)(k.Section,{style:w,children:(0,b.jsx)(h.Img,{src:n,alt:"Thorbis",width:"160",height:"40",style:x})}),(0,b.jsx)(k.Section,{style:y,className:"mobile-padding",children:a}),(0,b.jsx)(f.Hr,{style:z}),(0,b.jsxs)(k.Section,{style:A,className:"mobile-padding",children:[(0,b.jsxs)(l.Text,{style:B,children:["Need help?"," ",(0,b.jsx)(i.Link,{href:`mailto:${p}`,style:C,children:"Contact Support"})," • ",(0,b.jsx)(i.Link,{href:q,style:C,children:"Documentation"})]}),(0,b.jsxs)(l.Text,{style:B,children:[(0,b.jsx)(i.Link,{href:r,style:C,children:"Privacy Policy"})," • ",(0,b.jsx)(i.Link,{href:s,style:C,children:"Terms of Service"})]}),(0,b.jsxs)(l.Text,{style:D,children:["© ",new Date().getFullYear()," Thorbis. All rights reserved."]}),(0,b.jsx)(l.Text,{style:E,children:"Thorbis • 123 Innovation Drive, San Francisco, CA 94105"}),(0,b.jsxs)(l.Text,{style:F,children:["You're receiving this email because you have an account with Thorbis."," ",(0,b.jsx)(i.Link,{href:"{{unsubscribe_url}}",style:C,children:"Unsubscribe from marketing emails"})]})]})]})})]})}let u={backgroundColor:m.EMAIL_COLORS.background,fontFamily:'Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',WebkitFontSmoothing:"antialiased",MozOsxFontSmoothing:"grayscale"},v={backgroundColor:m.EMAIL_COLORS.surface,maxWidth:"600px",margin:"0 auto"},w={backgroundColor:m.EMAIL_COLORS.primary,padding:"40px 0",textAlign:"center"},x={margin:"0 auto",display:"block"},y={padding:"48px 40px",color:m.EMAIL_COLORS.text,fontSize:"16px",lineHeight:"24px"},z={borderColor:m.EMAIL_COLORS.border,borderWidth:"1px",margin:"0"},A={padding:"32px 40px",textAlign:"center",backgroundColor:m.EMAIL_COLORS.surfaceStrong},B={color:m.EMAIL_COLORS.muted,fontSize:"14px",lineHeight:"24px",margin:"8px 0"},C={color:m.EMAIL_COLORS.primary,textDecoration:"none",fontWeight:"500"},D={color:m.EMAIL_COLORS.muted,fontSize:"13px",margin:"16px 0 0 0",fontWeight:"600"},E={color:m.EMAIL_COLORS.muted,fontSize:"12px",margin:"8px 0"},F={color:m.EMAIL_COLORS.muted,fontSize:"11px",margin:"16px 0 0 0",lineHeight:"18px"};a.s(["BaseLayout",()=>t])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5484be3e._.js.map