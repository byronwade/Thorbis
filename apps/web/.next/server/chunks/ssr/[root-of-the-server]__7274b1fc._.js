module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},997868,a=>{a.n(a.i(884849))},592581,a=>{a.n(a.i(596565))},134005,a=>{a.n(a.i(977930))},565165,a=>{a.n(a.i(728209))},147941,a=>{a.n(a.i(484103))},304434,a=>{a.n(a.i(632684))},407521,a=>{a.n(a.i(693094))},797797,a=>{a.n(a.i(977207))},290022,a=>{a.n(a.i(362735))},729157,a=>{a.n(a.i(470009))},712363,a=>{a.n(a.i(279732))},208120,a=>{a.n(a.i(52860))},863056,a=>{a.n(a.i(77721))},468729,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call WorkDataView() from the server but WorkDataView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/work-data-view.tsx <module evaluation>","WorkDataView");a.s(["WorkDataView",0,b])},750692,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call WorkDataView() from the server but WorkDataView is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/work-data-view.tsx","WorkDataView");a.s(["WorkDataView",0,b])},310669,a=>{"use strict";a.i(468729);var b=a.i(750692);a.n(b)},431834,a=>{a.n(a.i(326141))},196797,a=>{a.n(a.i(868504))},227783,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call PaymentsKanban() from the server but PaymentsKanban is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/payments-kanban.tsx <module evaluation>","PaymentsKanban");a.s(["PaymentsKanban",0,b])},454307,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call PaymentsKanban() from the server but PaymentsKanban is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/payments-kanban.tsx","PaymentsKanban");a.s(["PaymentsKanban",0,b])},669408,a=>{"use strict";a.i(227783);var b=a.i(454307);a.n(b)},66836,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call PaymentsTable() from the server but PaymentsTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/payments-table.tsx <module evaluation>","PaymentsTable");a.s(["PaymentsTable",0,b])},6019,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call PaymentsTable() from the server but PaymentsTable is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/payments-table.tsx","PaymentsTable");a.s(["PaymentsTable",0,b])},725827,a=>{"use strict";a.i(66836);var b=a.i(6019);a.n(b)},852098,a=>{"use strict";var b=a.i(504348),c=a.i(429969);a.i(692167);var d=a.i(852596),e=a.i(669408),f=a.i(725827),g=a.i(310669);a.i(467361);var h=a.i(445074),i=a.i(933427);let j=`
  id,
  company_id,
  payment_number,
  amount,
  payment_method,
  status,
  processed_at,
  created_at,
  updated_at,
  archived_at,
  deleted_at,
  invoice_id,
  job_id,
  customer_id,
  customers!payments_customer_id_customers_id_fk (
    display_name,
    first_name,
    last_name
  )
`;async function k(a,b=50){let c=await (0,h.getActiveCompanyId)();if(!c)return{payments:[],totalCount:0};let d=await (0,i.createServiceSupabaseClient)();if(!d)throw Error("Supabase client not configured");let e=(Math.max(a,1)-1)*b,{data:f,error:g,count:l}=await d.from("payments").select(j,{count:"exact"}).eq("company_id",c).order("processed_at",{ascending:!1,nullsFirst:!1}).order("created_at",{ascending:!1}).range(e,e+b-1);if(g)throw Error(`Failed to load payments: ${g.message}`);return{payments:f??[],totalCount:l??0}}async function l({searchParams:a}){if(!await (0,h.getActiveCompanyId)())return(0,d.notFound)();let c=Number(a?.page)||1,{payments:i,totalCount:j}=await k(c,50);if(!i)return(0,d.notFound)();let l=i.map(a=>({id:a.id,payment_number:a.payment_number||"",amount:a.amount??0,payment_method:a.payment_method||"other",status:a.status||"pending",processed_at:a.processed_at?new Date(a.processed_at):null,created_at:new Date(a.created_at),updated_at:new Date(a.updated_at),customer:Array.isArray(a.customers)?a.customers[0]:a.customers,invoice_id:a.invoice_id,job_id:a.job_id,customer_id:a.customer_id,company_id:a.company_id,archived_at:a.archived_at,deleted_at:a.deleted_at}));return(0,b.jsx)(g.WorkDataView,{kanban:(0,b.jsx)(e.PaymentsKanban,{payments:l}),section:"payments",table:(0,b.jsx)(f.PaymentsTable,{currentPage:c,itemsPerPage:50,payments:l,totalCount:j})})}(0,c.cache)(async(a,b)=>{let c=await (0,i.createServiceSupabaseClient)();if(!c)throw Error("Supabase client not configured");let{data:d,error:e}=await c.rpc("get_payment_complete",{p_payment_id:a,p_company_id:b});return e?(console.error("Error fetching payment:",e),null):d?.[0]?.payment_data||null}),a.i(250202);var m=a.i(709027);function n(){return(0,b.jsx)(m.DataTableListSkeleton,{})}async function o({searchParams:a}){let d=await a;return(0,b.jsx)("div",{className:"flex h-full flex-col",children:(0,b.jsx)("div",{className:"flex-1 overflow-hidden",children:(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(n,{}),children:(0,b.jsx)(l,{searchParams:d})})})})}a.s(["default",()=>o],852098)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__7274b1fc._.js.map