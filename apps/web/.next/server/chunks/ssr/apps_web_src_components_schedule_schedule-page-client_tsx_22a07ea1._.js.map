{"version":3,"sources":["../../../../../../apps/web/src/components/schedule/schedule-page-client.tsx","../../../../../../apps/web/src/hooks/use-schedule-keyboard-shortcuts.ts","../../../../../../apps/web/src/components/schedule/dispatch-timeline-lazy.tsx","../../../../../../apps/web/src/components/schedule/kanban-view-lazy.tsx","../../../../../../apps/web/src/components/schedule/mobile/day-view-mobile.tsx","../../../../../../apps/web/src/components/schedule/mobile/date-picker-sheet.tsx","../../../../../../apps/web/src/components/schedule/mobile/empty-state-mobile.tsx","../../../../../../apps/web/src/components/schedule/mobile/job-actions-bottom-sheet.tsx","../../../../../../node_modules/.pnpm/date-fns%404.1.0/node_modules/date-fns/setHours.js","../../../../../../node_modules/.pnpm/date-fns%404.1.0/node_modules/date-fns/setMinutes.js","../../../../../../apps/web/src/components/schedule/mobile/reschedule-picker-sheet.tsx","../../../../../../apps/web/src/components/schedule/mobile/status-picker-sheet.tsx","../../../../../../apps/web/src/components/schedule/mobile/technician-picker-sheet.tsx","../../../../../../apps/web/src/components/schedule/mobile/job-card-mobile.tsx","../../../../../../apps/web/src/components/schedule/mobile/mobile-schedule-header.tsx","../../../../../../apps/web/src/components/schedule/mobile/filter-jobs-sheet.tsx","../../../../../../apps/web/src/components/schedule/mobile/search-jobs-sheet.tsx","../../../../../../apps/web/src/components/schedule/mobile/kanban-view-mobile.tsx","../../../../../../apps/web/src/components/schedule/mobile/list-view-mobile.tsx","../../../../../../node_modules/.pnpm/date-fns%404.1.0/node_modules/date-fns/isTomorrow.js","../../../../../../node_modules/.pnpm/date-fns%404.1.0/node_modules/date-fns/parseISO.js","../../../../../../apps/web/src/components/schedule/mobile/schedule-filters-mobile.tsx","../../../../../../apps/web/src/components/schedule/mobile/monthly-view-mobile.tsx","../../../../../../apps/web/src/components/schedule/mobile/day-detail-bottom-sheet.tsx","../../../../../../apps/web/src/components/schedule/monthly-view-lazy.tsx"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useMemo } from \"react\";\nimport { Alert, AlertDescription, AlertTitle } from \"@/components/ui/alert\";\nimport { useIsMobile } from \"@/hooks/use-mobile\";\nimport { useScheduleKeyboardShortcuts } from \"@/hooks/use-schedule-keyboard-shortcuts\";\nimport type { ScheduleBootstrapSerialized } from \"@/lib/schedule-bootstrap\";\nimport { deserializeScheduleBootstrap } from \"@/lib/schedule-bootstrap\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport { DispatchTimelineLazy as DispatchTimeline } from \"./dispatch-timeline-lazy\";\nimport { KanbanViewLazy as KanbanView } from \"./kanban-view-lazy\";\nimport { DayViewMobile } from \"./mobile/day-view-mobile\";\nimport { KanbanViewMobile } from \"./mobile/kanban-view-mobile\";\nimport { ListViewMobile } from \"./mobile/list-view-mobile\";\nimport { MonthlyViewMobile } from \"./mobile/monthly-view-mobile\";\nimport { MonthlyViewLazy as MonthlyView } from \"./monthly-view-lazy\";\n\ntype SchedulePageClientProps = {\n\tinitialData?: ScheduleBootstrapSerialized;\n\tbootstrapError?: string | null;\n};\n\nexport function SchedulePageClient({\n\tinitialData,\n\tbootstrapError,\n}: SchedulePageClientProps) {\n\tconst hydrateFromServer = useScheduleStore(\n\t\t(state) => state.hydrateFromServer,\n\t);\n\tconst { viewMode } = useScheduleViewStore();\n\tconst isMobile = useIsMobile(); // Detect mobile viewport (<768px)\n\tconst payload = useMemo(\n\t\t() => (initialData ? deserializeScheduleBootstrap(initialData) : null),\n\t\t[initialData],\n\t);\n\n\t// Enable keyboard shortcuts (T=today, N=new, [/]=nav, 1/2/3=views)\n\tuseScheduleKeyboardShortcuts();\n\n\tuseEffect(() => {\n\t\tif (payload) {\n\t\t\thydrateFromServer(payload);\n\t\t}\n\t}, [hydrateFromServer, payload]);\n\n\treturn (\n\t\t<div className=\"m-0 flex h-full w-full flex-1 flex-col overflow-hidden p-0\">\n\t\t\t{bootstrapError && (\n\t\t\t\t<Alert\n\t\t\t\t\tclassName=\"mx-3 md:mx-4 mt-2 mb-3 md:mb-4 max-w-2xl self-center\"\n\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t>\n\t\t\t\t\t<AlertTitle>Live schedule data unavailable</AlertTitle>\n\t\t\t\t\t<AlertDescription>\n\t\t\t\t\t\t{bootstrapError}. Showing the scheduler without preloaded jobsâ€”use\n\t\t\t\t\t\tthe refresh controls after fixing the issue.\n\t\t\t\t\t</AlertDescription>\n\t\t\t\t</Alert>\n\t\t\t)}\n\n\t\t\t{/*\n\t\t\t\tMobile vs Desktop Routing:\n\t\t\t\t- Mobile (<768px): Use mobile-optimized views with vertical scrolling, tap actions\n\t\t\t\t- Desktop (â‰¥768px): Use existing drag & drop timeline/kanban/month views\n\n\t\t\t\tMobile views:\n\t\t\t\t- List view: âœ… Primary mobile view (vertical scrolling, search/filter)\n\t\t\t\t- Day view: âœ… Vertical timeline with collapsible tech sections\n\t\t\t\t- Week view: âœ… Single-column kanban with swipe navigation\n\t\t\t\t- Month view: âœ… Touch-friendly calendar grid with day detail bottom sheets\n\t\t\t*/}\n\t\t\t{isMobile ? (\n\t\t\t\t<>\n\t\t\t\t\t{viewMode === \"list\" ? (\n\t\t\t\t\t\t<ListViewMobile />\n\t\t\t\t\t) : viewMode === \"day\" ? (\n\t\t\t\t\t\t<DayViewMobile />\n\t\t\t\t\t) : viewMode === \"week\" ? (\n\t\t\t\t\t\t<KanbanViewMobile />\n\t\t\t\t\t) : viewMode === \"month\" ? (\n\t\t\t\t\t\t<MonthlyViewMobile />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t// Fallback: Use list view for unknown modes\n\t\t\t\t\t\t<ListViewMobile />\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t) : (\n\t\t\t\t<>\n\t\t\t\t\t{/* Desktop views (unchanged) */}\n\t\t\t\t\t{viewMode === \"month\" ? (\n\t\t\t\t\t\t<MonthlyView />\n\t\t\t\t\t) : viewMode === \"week\" ? (\n\t\t\t\t\t\t<KanbanView />\n\t\t\t\t\t) : viewMode === \"list\" ? (\n\t\t\t\t\t\t// Desktop users can access list view too\n\t\t\t\t\t\t<ListViewMobile />\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<DispatchTimeline />\n\t\t\t\t\t)}\n\t\t\t\t</>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { useRouter } from \"next/navigation\";\nimport { useEffect } from \"react\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\n\n/**\n * Keyboard shortcuts for the schedule view:\n * - T: Go to today\n * - N: New job (navigates to /dashboard/work/new)\n * - [: Previous period\n * - ]: Next period\n * - 1: Timeline/Day view\n * - 2: Monthly view\n * - 3: Kanban/Status board view\n */\nexport function useScheduleKeyboardShortcuts() {\n\tconst router = useRouter();\n\tconst { goToToday, navigatePrevious, navigateNext, setViewMode } =\n\t\tuseScheduleViewStore();\n\n\tuseEffect(() => {\n\t\tconst handleKeyDown = (event: KeyboardEvent) => {\n\t\t\t// Ignore if user is typing in an input, textarea, or contenteditable\n\t\t\tconst target = event.target as HTMLElement;\n\t\t\tif (\n\t\t\t\ttarget.tagName === \"INPUT\" ||\n\t\t\t\ttarget.tagName === \"TEXTAREA\" ||\n\t\t\t\ttarget.isContentEditable\n\t\t\t) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Ignore if any modifier keys are pressed (except shift for some cases)\n\t\t\tif (event.ctrlKey || event.metaKey || event.altKey) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tswitch (event.key.toLowerCase()) {\n\t\t\t\tcase \"t\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tgoToToday();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"n\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\trouter.push(\"/dashboard/work/new\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"[\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tnavigatePrevious();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"]\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tnavigateNext();\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"1\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetViewMode(\"day\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"2\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetViewMode(\"month\");\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"3\":\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tsetViewMode(\"week\"); // week = kanban view\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t};\n\n\t\tdocument.addEventListener(\"keydown\", handleKeyDown);\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"keydown\", handleKeyDown);\n\t\t};\n\t}, [goToToday, navigatePrevious, navigateNext, setViewMode, router]);\n}\n","/**\n * DispatchTimeline - Lazy Loaded Wrapper\n *\n * Performance optimization:\n * - Dynamically imports the full 1638-line dispatch timeline component (~35KB)\n * - Only loads when user switches to \"Day\" view mode\n * - Shows skeleton loading state while importing\n * - Reduces initial schedule page bundle significantly\n */\n\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst DispatchTimeline = dynamic(\n\t() =>\n\t\timport(\"./dispatch-timeline\").then((mod) => ({\n\t\t\tdefault: mod.DispatchTimeline,\n\t\t})),\n\t{\n\t\tloading: () => (\n\t\t\t<div className=\"flex h-full w-full flex-col gap-4 p-4\">\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<Skeleton className=\"h-10 w-32\" />\n\t\t\t\t\t<Skeleton className=\"h-10 w-32\" />\n\t\t\t\t\t<Skeleton className=\"h-10 flex-1\" />\n\t\t\t\t</div>\n\t\t\t\t<Skeleton className=\"h-full w-full\" />\n\t\t\t</div>\n\t\t),\n\t\tssr: false, // Complex timeline requires browser environment\n\t},\n);\n\nexport function DispatchTimelineLazy() {\n\treturn <DispatchTimeline />;\n}\n","/**\n * KanbanView - Lazy Loaded Wrapper\n *\n * Performance optimization:\n * - Dynamically imports the full kanban view component (~15KB)\n * - Only loads when user switches to \"Week\" view mode\n * - Shows skeleton loading state while importing\n * - Reduces initial schedule page bundle\n */\n\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst KanbanView = dynamic(\n\t() => import(\"./kanban-view\").then((mod) => ({ default: mod.KanbanView })),\n\t{\n\t\tloading: () => (\n\t\t\t<div className=\"flex h-full w-full gap-4 p-4\">\n\t\t\t\t{Array.from({ length: 7 }).map((_, i) => (\n\t\t\t\t\t<div key={i} className=\"flex flex-1 flex-col gap-2\">\n\t\t\t\t\t\t<Skeleton className=\"h-8 w-full\" />\n\t\t\t\t\t\t<Skeleton className=\"h-32 w-full\" />\n\t\t\t\t\t\t<Skeleton className=\"h-32 w-full\" />\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t),\n\t\tssr: false, // Kanban DnD requires browser environment\n\t},\n);\n\nexport function KanbanViewLazy() {\n\treturn <KanbanView />;\n}\n","\"use client\";\n\nimport { format, isSameDay } from \"date-fns\";\nimport {\n\tChevronDown,\n\tChevronLeft,\n\tChevronRight,\n\tChevronRight as ChevronRightIcon,\n} from \"lucide-react\";\nimport { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport type { Job, Technician } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport { DatePickerSheet } from \"./date-picker-sheet\";\nimport { EmptyStateMobile } from \"./empty-state-mobile\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { JobCardMobile } from \"./job-card-mobile\";\nimport { MobileScheduleHeader } from \"./mobile-schedule-header\";\n\n/**\n * DayViewMobile - Mobile-optimized day view with vertical timeline\n *\n * Completely different from desktop dispatch timeline:\n * - NO horizontal 1,920px scroll\n * - Vertical scrolling (natural mobile pattern)\n * - Time slots stacked vertically (8am, 9am, 10am, etc.)\n * - Collapsible technician sections\n * - Unassigned jobs panel at bottom\n * - Tap job card â†’ bottom sheet (no drag & drop)\n * - Date navigation with arrows or swipe\n *\n * Layout:\n * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n * â”‚ â† Jan 15, 2025 â†’  [Today]      â”‚ Date nav\n * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n * â”‚ Mike Johnson (4 jobs) â–¼         â”‚ Collapsible\n * â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\n * â”‚ â”‚ 8:00 AM - Job card          â”‚ â”‚\n * â”‚ â”‚ 10:00 AM - Job card         â”‚ â”‚\n * â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\n * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n * â”‚ Sarah Williams (2 jobs) â–¼       â”‚\n * â”‚ ... jobs ...                    â”‚\n * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n * â”‚ ðŸ“‹ Unassigned (8) â–¶             â”‚ Collapsible\n * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n */\n\nexport function DayViewMobile() {\n\t// Get Maps from store (stable references)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\tconst {\n\t\tcurrentDate,\n\t\tgoToToday,\n\t\tnavigatePrevious,\n\t\tnavigateNext,\n\t\tsetCurrentDate,\n\t} = useScheduleViewStore();\n\n\t// Convert Maps to arrays once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\tconst technicians = useMemo(\n\t\t() => Array.from(techniciansMap.values()),\n\t\t[techniciansMap],\n\t);\n\n\t// Local state\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\tconst [expandedTechs, setExpandedTechs] = useState<Set<string>>(new Set());\n\tconst [showUnassigned, setShowUnassigned] = useState(false);\n\tconst [showDatePicker, setShowDatePicker] = useState(false);\n\tconst [hasAutoExpanded, setHasAutoExpanded] = useState(false);\n\n\t// Filter jobs for current date\n\tconst todaysJobs = useMemo(() => {\n\t\treturn jobs.filter((job) => {\n\t\t\tif (!job.startTime) return false;\n\t\t\t// Handle both ISO string and Date object\n\t\t\tconst jobDate =\n\t\t\t\ttypeof job.startTime === \"string\"\n\t\t\t\t\t? new Date(job.startTime)\n\t\t\t\t\t: job.startTime;\n\t\t\treturn isSameDay(jobDate, currentDate);\n\t\t});\n\t}, [jobs, currentDate]);\n\n\t// Group jobs by technician\n\tconst jobsByTechnician = useMemo(() => {\n\t\tconst grouped = new Map<string, Job[]>();\n\n\t\t// Initialize map with all technicians (including those with no jobs)\n\t\ttechnicians.forEach((tech) => {\n\t\t\tgrouped.set(tech.id, []);\n\t\t});\n\n\t\t// Group jobs by assigned technician\n\t\ttodaysJobs.forEach((job) => {\n\t\t\tif (job.technicianId) {\n\t\t\t\tconst techJobs = grouped.get(job.technicianId) || [];\n\t\t\t\ttechJobs.push(job);\n\t\t\t\tgrouped.set(job.technicianId, techJobs);\n\t\t\t}\n\t\t});\n\n\t\t// Sort jobs within each technician by start time\n\t\tgrouped.forEach((jobs) => {\n\t\t\tjobs.sort((a, b) => {\n\t\t\t\tif (!a.startTime) return 1;\n\t\t\t\tif (!b.startTime) return -1;\n\t\t\t\treturn (\n\t\t\t\t\tnew Date(a.startTime).getTime() - new Date(b.startTime).getTime()\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\n\t\treturn grouped;\n\t}, [todaysJobs, technicians]);\n\n\t// Get unassigned jobs for today\n\tconst unassignedJobs = useMemo(() => {\n\t\treturn todaysJobs.filter((job) => job.isUnassigned);\n\t}, [todaysJobs]);\n\n\t// Auto-expand technicians that have jobs for the day (better UX than starting collapsed)\n\tuseEffect(() => {\n\t\tif (hasAutoExpanded || jobsByTechnician.size === 0) return;\n\n\t\tconst techsWithJobs = new Set<string>();\n\t\tjobsByTechnician.forEach((jobs, techId) => {\n\t\t\tif (jobs.length > 0) {\n\t\t\t\ttechsWithJobs.add(techId);\n\t\t\t}\n\t\t});\n\n\t\tif (techsWithJobs.size > 0) {\n\t\t\tsetExpandedTechs(techsWithJobs);\n\t\t\tsetHasAutoExpanded(true);\n\t\t}\n\t}, [jobsByTechnician, hasAutoExpanded]);\n\n\t// Reset auto-expand flag when date changes\n\tuseEffect(() => {\n\t\tsetHasAutoExpanded(false);\n\t}, [currentDate]);\n\n\t// Toggle technician section\n\tconst toggleTechnician = useCallback((techId: string) => {\n\t\tsetExpandedTechs((prev) => {\n\t\t\tconst next = new Set(prev);\n\t\t\tif (next.has(techId)) {\n\t\t\t\tnext.delete(techId);\n\t\t\t} else {\n\t\t\t\tnext.add(techId);\n\t\t\t}\n\t\t\treturn next;\n\t\t});\n\t}, []);\n\n\t// Job action handler\n\tconst handleJobAction = useCallback(\n\t\tasync (action: string, job: Job, ...args: unknown[]) => {\n\t\t\tconsole.log(\"Job action:\", action, job, args);\n\t\t\tsetSelectedJob(null);\n\n\t\t\ttry {\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase \"view_details\":\n\t\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"dispatch\":\n\t\t\t\t\tcase \"arrive\":\n\t\t\t\t\tcase \"start\":\n\t\t\t\t\tcase \"complete\":\n\t\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst newStatus =\n\t\t\t\t\t\t\taction === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t\t\t`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reassign\": {\n\t\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\n\t\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"cancel\": {\n\t\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\n\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\t\ttoast.error(\"An error occurred\");\n\t\t\t}\n\t\t},\n\t\t[],\n\t);\n\n\t// Format date display\n\tconst dateDisplay = format(currentDate, \"EEEE, MMM d, yyyy\");\n\tconst isToday = isSameDay(currentDate, new Date());\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Mobile Header with view switcher, stats, and actions */}\n\t\t\t<MobileScheduleHeader onJobSelect={setSelectedJob} />\n\n\t\t\t{/* Date navigation */}\n\t\t\t<div className=\"shrink-0 border-b bg-background\">\n\t\t\t\t<div className=\"flex items-center justify-between p-4\">\n\t\t\t\t\t{/* Previous day */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigatePrevious}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Previous day</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Current date - Clickable */}\n\t\t\t\t\t<button\n\t\t\t\t\t\tclassName=\"flex flex-col items-center transition-colors hover:text-primary active:scale-95\"\n\t\t\t\t\t\tonClick={() => setShowDatePicker(true)}\n\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<h2 className=\"text-sm font-medium text-muted-foreground\">\n\t\t\t\t\t\t\t{format(currentDate, \"EEEE\")}\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<p className=\"text-lg font-semibold\">\n\t\t\t\t\t\t\t{format(currentDate, \"MMM d, yyyy\")}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</button>\n\n\t\t\t\t\t{/* Next day */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigateNext}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronRightIcon className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Next day</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Today button (only show when not on today) */}\n\t\t\t\t{!isToday && (\n\t\t\t\t\t<div className=\"px-4 pb-3\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t\tonClick={goToToday}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tGo to Today\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Scrollable content */}\n\t\t\t<div className=\"flex-1 overflow-y-auto\">\n\t\t\t\t{todaysJobs.length === 0 ? (\n\t\t\t\t\t<EmptyStateMobile\n\t\t\t\t\t\tactionLabel=\"View Full Schedule\"\n\t\t\t\t\t\tonAction={() => {\n\t\t\t\t\t\t\twindow.location.href = \"/dashboard/schedule\";\n\t\t\t\t\t\t}}\n\t\t\t\t\t\tvariant=\"no_jobs_today\"\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-0\">\n\t\t\t\t\t\t{/* Technician sections */}\n\t\t\t\t\t\t{technicians.map((tech) => {\n\t\t\t\t\t\t\tconst techJobs = jobsByTechnician.get(tech.id) || [];\n\t\t\t\t\t\t\tconst isExpanded = expandedTechs.has(tech.id);\n\t\t\t\t\t\t\tconst hasJobs = techJobs.length > 0;\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<div className=\"border-b last:border-b-0\" key={tech.id}>\n\t\t\t\t\t\t\t\t\t{/* Technician header (collapsible) */}\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName=\"flex w-full items-center justify-between bg-muted/30 p-4 text-left transition-colors hover:bg-muted/50 active:bg-muted\"\n\t\t\t\t\t\t\t\t\t\tonClick={() => toggleTechnician(tech.id)}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t{isExpanded ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium\">{tech.name}</h3>\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.length}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.length === 1 ? \"job\" : \"jobs\"}\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t{/* Job count badge */}\n\t\t\t\t\t\t\t\t\t\t{hasJobs && (\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex h-6 min-w-6 items-center justify-center rounded-full bg-primary/10 px-2 text-xs font-semibold text-primary\">\n\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.length}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t\t{/* Job cards (only show when expanded) */}\n\t\t\t\t\t\t\t\t\t{isExpanded && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"bg-background px-4 pb-4\">\n\t\t\t\t\t\t\t\t\t\t\t{techJobs.length === 0 ? (\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"py-8 text-center text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tNo jobs scheduled for today\n\t\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1.5\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{techJobs.map((job) => (\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowDate={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tshowTechnician={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\n\t\t\t\t\t\t{/* Unassigned jobs section */}\n\t\t\t\t\t\t{unassignedJobs.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"border-t\">\n\t\t\t\t\t\t\t\t{/* Unassigned header (collapsible) */}\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName=\"flex w-full items-center justify-between bg-yellow-50 dark:bg-yellow-950/20 p-4 text-left transition-colors hover:bg-yellow-100 dark:hover:bg-yellow-950/30 active:bg-yellow-100 dark:active:bg-yellow-950/30\"\n\t\t\t\t\t\t\t\t\tonClick={() => setShowUnassigned(!showUnassigned)}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t{showUnassigned ? (\n\t\t\t\t\t\t\t\t\t\t\t<ChevronDown className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"font-medium\">ðŸ“‹ Unassigned</h3>\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t{unassignedJobs.length}{\" \"}\n\t\t\t\t\t\t\t\t\t\t\t\t{unassignedJobs.length === 1 ? \"job\" : \"jobs\"} need\n\t\t\t\t\t\t\t\t\t\t\t\tassignment\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Count badge */}\n\t\t\t\t\t\t\t\t\t<div className=\"flex h-6 min-w-6 items-center justify-center rounded-full bg-yellow-500 dark:bg-yellow-600 px-2 text-xs font-semibold text-white\">\n\t\t\t\t\t\t\t\t\t\t{unassignedJobs.length}\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</button>\n\n\t\t\t\t\t\t\t\t{/* Unassigned job cards */}\n\t\t\t\t\t\t\t\t{showUnassigned && (\n\t\t\t\t\t\t\t\t\t<div className=\"bg-background px-4 pb-4\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"space-y-1.5\">\n\t\t\t\t\t\t\t\t\t\t\t{unassignedJobs.map((job) => (\n\t\t\t\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowDate={false}\n\t\t\t\t\t\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\n\t\t\t{/* Date Picker Sheet */}\n\t\t\t<DatePickerSheet\n\t\t\t\tcurrentDate={currentDate}\n\t\t\t\tisOpen={showDatePicker}\n\t\t\t\tonClose={() => setShowDatePicker(false)}\n\t\t\t\tonDateSelect={(date) => {\n\t\t\t\t\tsetCurrentDate(date);\n\t\t\t\t\tsetShowDatePicker(false);\n\t\t\t\t}}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { format } from \"date-fns\";\nimport { Calendar as CalendarIcon, X } from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n} from \"@/components/ui/sheet\";\n\n/**\n * DatePickerSheet - Mobile date picker for schedule\n *\n * Features:\n * - Full calendar view\n * - Quick date selection\n * - Today button for quick reset\n * - Visual indicator for selected date\n * - Swipe to dismiss\n */\n\ntype DatePickerSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tcurrentDate: Date;\n\tonDateSelect: (date: Date) => void;\n};\n\nexport function DatePickerSheet({\n\tisOpen,\n\tonClose,\n\tcurrentDate,\n\tonDateSelect,\n}: DatePickerSheetProps) {\n\tconst [selectedDate, setSelectedDate] = useState<Date>(currentDate);\n\n\tconst handleDateSelect = (date: Date | undefined) => {\n\t\tif (date) {\n\t\t\tsetSelectedDate(date);\n\t\t}\n\t};\n\n\tconst handleConfirm = () => {\n\t\tonDateSelect(selectedDate);\n\t\tonClose();\n\t};\n\n\tconst handleToday = () => {\n\t\tconst today = new Date();\n\t\tsetSelectedDate(today);\n\t\tonDateSelect(today);\n\t\tonClose();\n\t};\n\n\tconst handleCancel = () => {\n\t\tsetSelectedDate(currentDate); // Reset to original\n\t\tonClose();\n\t};\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={handleCancel}>\n\t\t\t<SheetContent side=\"bottom\" className=\"h-[500px] flex flex-col\">\n\t\t\t\t<SheetHeader>\n\t\t\t\t\t<SheetTitle className=\"flex items-center justify-between\">\n\t\t\t\t\t\t<span className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t<CalendarIcon className=\"h-5 w-5\" />\n\t\t\t\t\t\t\tSelect Date\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"h-8 w-8 p-0\"\n\t\t\t\t\t\t\tonClick={handleCancel}\n\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</SheetTitle>\n\t\t\t\t</SheetHeader>\n\n\t\t\t\t{/* Calendar */}\n\t\t\t\t<div className=\"flex-1 flex items-center justify-center overflow-y-auto py-4\">\n\t\t\t\t\t<Calendar\n\t\t\t\t\t\tclassName=\"rounded-md border\"\n\t\t\t\t\t\tmode=\"single\"\n\t\t\t\t\t\tonSelect={handleDateSelect}\n\t\t\t\t\t\tselected={selectedDate}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Footer Actions */}\n\t\t\t\t<div className=\"shrink-0 space-y-2 border-t pt-4\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\tonClick={handleToday}\n\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tToday\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button className=\"flex-1\" onClick={handleConfirm} size=\"default\">\n\t\t\t\t\t\t\tGo to {format(selectedDate, \"MMM d, yyyy\")}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n","\"use client\";\n\nimport { Calendar, Search, Users } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * EmptyStateMobile - Mobile-optimized empty state component\n *\n * Shows helpful messages and CTAs when:\n * - No jobs scheduled\n * - No search/filter results\n * - No unassigned jobs\n * - Technician has no jobs today\n *\n * Design:\n * - Icon illustration\n * - Helpful message\n * - Call-to-action button(s)\n * - Centered layout\n * - Compact for mobile screens\n */\n\nexport type EmptyStateVariant =\n\t| \"no_jobs\"\n\t| \"no_results\"\n\t| \"no_unassigned\"\n\t| \"no_jobs_today\";\n\ntype EmptyStateMobileProps = {\n\tvariant: EmptyStateVariant;\n\tonAction?: () => void;\n\tactionLabel?: string;\n\tclassName?: string;\n};\n\nconst emptyStateConfig: Record<\n\tEmptyStateVariant,\n\t{\n\t\ticon: React.ElementType;\n\t\ttitle: string;\n\t\tdescription: string;\n\t\tdefaultActionLabel: string;\n\t}\n> = {\n\tno_jobs: {\n\t\ticon: Calendar,\n\t\ttitle: \"No jobs scheduled\",\n\t\tdescription: \"Get started by scheduling your first appointment\",\n\t\tdefaultActionLabel: \"Schedule Appointment\",\n\t},\n\tno_results: {\n\t\ticon: Search,\n\t\ttitle: \"No jobs found\",\n\t\tdescription: \"Try adjusting your search or filters\",\n\t\tdefaultActionLabel: \"Clear Filters\",\n\t},\n\tno_unassigned: {\n\t\ticon: Users,\n\t\ttitle: \"All jobs assigned\",\n\t\tdescription: \"Great! All jobs have been assigned to technicians\",\n\t\tdefaultActionLabel: \"View Schedule\",\n\t},\n\tno_jobs_today: {\n\t\ticon: Calendar,\n\t\ttitle: \"No jobs today\",\n\t\tdescription: \"This technician has no scheduled jobs for today\",\n\t\tdefaultActionLabel: \"View Full Schedule\",\n\t},\n};\n\nexport function EmptyStateMobile({\n\tvariant,\n\tonAction,\n\tactionLabel,\n\tclassName,\n}: EmptyStateMobileProps) {\n\tconst config = emptyStateConfig[variant];\n\tconst Icon = config.icon;\n\tconst finalActionLabel = actionLabel || config.defaultActionLabel;\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\n\t\t\t\t\"flex flex-col items-center justify-center gap-4 px-6 py-12 text-center\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t>\n\t\t\t{/* Icon */}\n\t\t\t<div className=\"flex h-16 w-16 items-center justify-center rounded-full bg-muted\">\n\t\t\t\t<Icon className=\"h-8 w-8 text-muted-foreground\" />\n\t\t\t</div>\n\n\t\t\t{/* Title */}\n\t\t\t<div className=\"space-y-2\">\n\t\t\t\t<h3 className=\"text-lg font-semibold\">{config.title}</h3>\n\t\t\t\t<p className=\"text-sm text-muted-foreground max-w-sm\">\n\t\t\t\t\t{config.description}\n\t\t\t\t</p>\n\t\t\t</div>\n\n\t\t\t{/* Action button (if provided) */}\n\t\t\t{onAction && (\n\t\t\t\t<Button className=\"mt-2\" onClick={onAction}>\n\t\t\t\t\t{finalActionLabel}\n\t\t\t\t</Button>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { format } from \"date-fns\";\nimport {\n\tArrowRight,\n\tCalendar,\n\tCheckCircle2,\n\tClock,\n\tMapPin,\n\tNavigation,\n\tRepeat,\n\tTrash2,\n\tUser,\n\tUsers,\n\tX,\n} from \"lucide-react\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\nimport { ReschedulePickerSheet } from \"./reschedule-picker-sheet\";\nimport { StatusPickerSheet } from \"./status-picker-sheet\";\nimport { TechnicianPickerSheet } from \"./technician-picker-sheet\";\n\n/**\n * JobActionsBottomSheet - Mobile bottom drawer for job actions\n *\n * Replaces desktop context menus and drag-and-drop interactions.\n * Provides large touch-friendly buttons for all job actions.\n *\n * Design:\n * - Slides up from bottom (native iOS/Android pattern)\n * - Backdrop dims background\n * - Swipe down to dismiss\n * - Large action buttons (56px height minimum)\n * - Context-aware actions (only show relevant actions based on status)\n * - Nested pickers for reschedule/reassign/status changes\n *\n * Actions:\n * - View Details: Navigate to full job page\n * - Dispatch: Change status to dispatched\n * - Arrive: Change status to arrived\n * - Start: Change status to in progress\n * - Complete: Change status to completed\n * - Reschedule: Open date/time picker (nested)\n * - Reassign: Open technician picker (nested)\n * - Move to Status: Open status picker (nested)\n * - Cancel Job: Confirmation modal + change to cancelled\n *\n * Props:\n * - isOpen: Controls visibility\n * - onClose: Callback to close sheet\n * - job: Job data to display\n * - onAction: Callback when action is selected\n */\n\ntype JobAction =\n\t| \"view_details\"\n\t| \"dispatch\"\n\t| \"arrive\"\n\t| \"start\"\n\t| \"complete\"\n\t| \"reschedule\"\n\t| \"reassign\"\n\t| \"move_to_status\"\n\t| \"cancel\";\n\ntype JobActionsBottomSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tjob: Job | null;\n\tonAction: (action: string, job: Job, ...args: any[]) => void;\n};\n\n// Animation duration (must match CSS transition)\nconst ANIMATION_DURATION = 300;\n\nexport function JobActionsBottomSheet({\n\tisOpen,\n\tonClose,\n\tjob,\n\tonAction,\n}: JobActionsBottomSheetProps) {\n\tconst [isClosing, setIsClosing] = useState(false);\n\tconst [activePickerJob, setActivePickerJob] = useState<Job | null>(null);\n\tconst [activePicker, setActivePicker] = useState<\n\t\t\"reschedule\" | \"reassign\" | \"status\" | null\n\t>(null);\n\tconst sheetRef = useRef<HTMLDivElement>(null);\n\n\t// Handle closing animation\n\tconst handleClose = useCallback(() => {\n\t\tsetIsClosing(true);\n\t\tsetTimeout(() => {\n\t\t\tonClose();\n\t\t\tsetIsClosing(false);\n\t\t}, ANIMATION_DURATION);\n\t}, [onClose]);\n\n\t// Close on backdrop click\n\tuseEffect(() => {\n\t\tconst handleBackdropClick = (event: MouseEvent) => {\n\t\t\tif (\n\t\t\t\tsheetRef.current &&\n\t\t\t\t!sheetRef.current.contains(event.target as Node)\n\t\t\t) {\n\t\t\t\thandleClose();\n\t\t\t}\n\t\t};\n\n\t\tif (isOpen) {\n\t\t\tdocument.addEventListener(\"mousedown\", handleBackdropClick);\n\t\t}\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"mousedown\", handleBackdropClick);\n\t\t};\n\t}, [isOpen, handleClose]);\n\n\t// Close on escape key\n\tuseEffect(() => {\n\t\tconst handleEscape = (event: KeyboardEvent) => {\n\t\t\tif (event.key === \"Escape\") {\n\t\t\t\thandleClose();\n\t\t\t}\n\t\t};\n\n\t\tif (isOpen) {\n\t\t\tdocument.addEventListener(\"keydown\", handleEscape);\n\t\t}\n\n\t\treturn () => {\n\t\t\tdocument.removeEventListener(\"keydown\", handleEscape);\n\t\t};\n\t}, [isOpen, handleClose]);\n\n\t// Reset picker state when main sheet opens/closes\n\tuseEffect(() => {\n\t\tif (!isOpen) {\n\t\t\tsetActivePicker(null);\n\t\t\tsetActivePickerJob(null);\n\t\t}\n\t}, [isOpen]);\n\n\t// Handle action button clicks\n\tconst handleActionClick = useCallback(\n\t\t(action: JobAction, currentJob: Job) => {\n\t\t\t// For actions that need a picker, open the picker instead of directly calling onAction\n\t\t\tif (action === \"reschedule\") {\n\t\t\t\tsetActivePickerJob(currentJob);\n\t\t\t\tsetActivePicker(\"reschedule\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (action === \"reassign\") {\n\t\t\t\tsetActivePickerJob(currentJob);\n\t\t\t\tsetActivePicker(\"reassign\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (action === \"move_to_status\") {\n\t\t\t\tsetActivePickerJob(currentJob);\n\t\t\t\tsetActivePicker(\"status\");\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// For direct actions, call onAction immediately\n\t\t\tonAction(action, currentJob);\n\t\t\thandleClose();\n\t\t},\n\t\t[onAction, handleClose],\n\t);\n\n\t// Handle picker confirmations\n\tconst handleRescheduleConfirm = useCallback(\n\t\t(currentJob: Job, newStart: Date, newEnd: Date) => {\n\t\t\tonAction(\"reschedule\", currentJob, newStart, newEnd);\n\t\t\tsetActivePicker(null);\n\t\t\tsetActivePickerJob(null);\n\t\t\thandleClose();\n\t\t},\n\t\t[onAction, handleClose],\n\t);\n\n\tconst handleReassignConfirm = useCallback(\n\t\t(currentJob: Job, technicianId: string | null) => {\n\t\t\tonAction(\"reassign\", currentJob, technicianId);\n\t\t\tsetActivePicker(null);\n\t\t\tsetActivePickerJob(null);\n\t\t\thandleClose();\n\t\t},\n\t\t[onAction, handleClose],\n\t);\n\n\tconst handleStatusConfirm = useCallback(\n\t\t(currentJob: Job, newStatus: string) => {\n\t\t\tonAction(\"move_to_status\", currentJob, newStatus);\n\t\t\tsetActivePicker(null);\n\t\t\tsetActivePickerJob(null);\n\t\t\thandleClose();\n\t\t},\n\t\t[onAction, handleClose],\n\t);\n\n\tconst handlePickerClose = useCallback(() => {\n\t\tsetActivePicker(null);\n\t\tsetActivePickerJob(null);\n\t}, []);\n\n\tif (!isOpen && !isClosing) {\n\t\treturn null;\n\t}\n\n\tif (!job) {\n\t\treturn null;\n\t}\n\n\t// Get current status\n\tconst status = (job.status?.toLowerCase().replace(/ /g, \"_\") ||\n\t\t\"unscheduled\") as string;\n\n\t// Determine which actions to show based on current status\n\tconst availableActions: JobAction[] = [];\n\n\t// Status-specific actions\n\tif (status === \"scheduled\") {\n\t\tavailableActions.push(\"dispatch\");\n\t}\n\tif (status === \"dispatched\") {\n\t\tavailableActions.push(\"arrive\");\n\t}\n\tif (status === \"arrived\") {\n\t\tavailableActions.push(\"start\");\n\t}\n\tif (status === \"in_progress\") {\n\t\tavailableActions.push(\"complete\");\n\t}\n\n\t// Always available actions\n\tavailableActions.push(\"reschedule\", \"reassign\", \"move_to_status\");\n\n\t// Cancel action (always last)\n\tif (status !== \"cancelled\" && status !== \"completed\") {\n\t\tavailableActions.push(\"cancel\");\n\t}\n\n\t// Always show view details\n\tavailableActions.unshift(\"view_details\");\n\n\t// Format job details\n\tconst customerName = job.customer?.name || \"No Customer\";\n\tconst propertyAddress = job.location?.address?.street || \"No location\";\n\tconst startTime = job.startTime\n\t\t? format(new Date(job.startTime), \"MMM d, h:mm a\")\n\t\t: \"Not scheduled\";\n\tconst endTime = job.endTime ? format(new Date(job.endTime), \"h:mm a\") : \"\";\n\tconst timeDisplay = endTime ? `${startTime} - ${endTime}` : startTime;\n\n\t// Get primary technician from assignments\n\tconst primaryAssignment = job.assignments.find((a) => a.role === \"primary\");\n\tconst techInitials = primaryAssignment?.displayName\n\t\t? primaryAssignment.displayName\n\t\t\t\t.split(\" \")\n\t\t\t\t.map((n) => n[0])\n\t\t\t\t.join(\"\")\n\t\t\t\t.toUpperCase()\n\t\t\t\t.slice(0, 2)\n\t\t: \"?\";\n\n\t// Calculate duration\n\tconst duration =\n\t\tjob.startTime && job.endTime\n\t\t\t? Math.round(\n\t\t\t\t\t(new Date(job.endTime).getTime() -\n\t\t\t\t\t\tnew Date(job.startTime).getTime()) /\n\t\t\t\t\t\t(1000 * 60 * 60),\n\t\t\t\t)\n\t\t\t: 0;\n\n\t// Action button configuration\n\tconst actionConfig: Record<\n\t\tJobAction,\n\t\t{\n\t\t\ticon: React.ElementType;\n\t\t\tlabel: string;\n\t\t\tvariant?: \"default\" | \"destructive\";\n\t\t}\n\t> = {\n\t\tview_details: { icon: ArrowRight, label: \"View Full Details\" },\n\t\tdispatch: { icon: Navigation, label: \"Dispatch Job\" },\n\t\tarrive: { icon: MapPin, label: \"Mark as Arrived\" },\n\t\tstart: { icon: Clock, label: \"Start Job\" },\n\t\tcomplete: { icon: CheckCircle2, label: \"Mark as Complete\" },\n\t\treschedule: { icon: Calendar, label: \"Reschedule\" },\n\t\treassign: { icon: Users, label: \"Reassign Technician\" },\n\t\tmove_to_status: { icon: Repeat, label: \"Move to Status...\" },\n\t\tcancel: { icon: Trash2, label: \"Cancel Job\", variant: \"destructive\" },\n\t};\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed inset-0 z-50 bg-background/80 backdrop-blur-sm\",\n\t\t\t\t\tisClosing\n\t\t\t\t\t\t? \"animate-out fade-out duration-300\"\n\t\t\t\t\t\t: \"animate-in fade-in duration-300\",\n\t\t\t\t)}\n\t\t\t/>\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"safe-bottom fixed bottom-0 left-0 right-0 z-50 rounded-t-3xl border-t border-border bg-background shadow-2xl\",\n\t\t\t\t\tisClosing\n\t\t\t\t\t\t? \"animate-out slide-out-to-bottom duration-300\"\n\t\t\t\t\t\t: \"animate-in slide-in-from-bottom duration-300\",\n\t\t\t\t)}\n\t\t\t\tref={sheetRef}\n\t\t\t>\n\t\t\t\t{/* Handle indicator */}\n\t\t\t\t<div className=\"flex justify-center py-4\">\n\t\t\t\t\t<div className=\"h-1.5 w-10 rounded-full bg-muted\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Scrollable content */}\n\t\t\t\t<div className=\"max-h-[80vh] overflow-y-auto px-6 pb-6\">\n\t\t\t\t\t{/* Header: Close button */}\n\t\t\t\t\t<div className=\"flex items-center justify-between mb-4\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold\">Job Actions</h2>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\t\tonClick={handleClose}\n\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Job Summary */}\n\t\t\t\t\t<div className=\"mb-6 space-y-3 rounded-lg border bg-muted/50 p-4\">\n\t\t\t\t\t\t{/* Customer & Title */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<h3 className=\"text-base font-medium leading-tight\">\n\t\t\t\t\t\t\t\t{customerName}\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mt-0.5\">\n\t\t\t\t\t\t\t\t{job.title || \"Untitled Job\"}\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Details grid */}\n\t\t\t\t\t\t<div className=\"space-y-2 text-sm\">\n\t\t\t\t\t\t\t{/* Time */}\n\t\t\t\t\t\t\t<div className=\"flex items-start gap-2\">\n\t\t\t\t\t\t\t\t<Clock className=\"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t\t\t<p className=\"font-medium\">{timeDisplay}</p>\n\t\t\t\t\t\t\t\t\t{duration > 0 && (\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{duration} {duration === 1 ? \"hour\" : \"hours\"}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* Location */}\n\t\t\t\t\t\t\t{propertyAddress !== \"No location\" && (\n\t\t\t\t\t\t\t\t<div className=\"flex items-start gap-2\">\n\t\t\t\t\t\t\t\t\t<MapPin className=\"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t\t<p>{propertyAddress}</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t\t{/* Assigned Technician */}\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<User className=\"h-4 w-4 shrink-0 text-muted-foreground\" />\n\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<Avatar className=\"h-6 w-6\">\n\t\t\t\t\t\t\t\t\t\t<AvatarImage\n\t\t\t\t\t\t\t\t\t\t\talt={primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t\t\t\t\t\tsrc={primaryAssignment?.avatar || undefined}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t{techInitials}\n\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t\t\t<span className=\"font-medium\">\n\t\t\t\t\t\t\t\t\t\t{primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{/* Status Badge */}\n\t\t\t\t\t\t\t<div className=\"flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<Badge variant=\"secondary\" className=\"capitalize\">\n\t\t\t\t\t\t\t\t\t{job.status || \"Unscheduled\"}\n\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Description (if exists) */}\n\t\t\t\t\t\t{job.description && (\n\t\t\t\t\t\t\t<div className=\"pt-2 border-t\">\n\t\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground line-clamp-2\">\n\t\t\t\t\t\t\t\t\t{job.description}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Action Buttons */}\n\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t<h3 className=\"text-sm font-medium text-muted-foreground mb-3\">\n\t\t\t\t\t\t\tActions\n\t\t\t\t\t\t</h3>\n\n\t\t\t\t\t\t{availableActions.map((action) => {\n\t\t\t\t\t\t\tconst config = actionConfig[action];\n\t\t\t\t\t\t\tconst Icon = config.icon;\n\t\t\t\t\t\t\tconst isDestructive = config.variant === \"destructive\";\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"h-14 w-full justify-start gap-3 text-base font-medium\",\n\t\t\t\t\t\t\t\t\t\tisDestructive && \"text-destructive hover:text-destructive\",\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tkey={action}\n\t\t\t\t\t\t\t\t\tonClick={() => handleActionClick(action, job)}\n\t\t\t\t\t\t\t\t\tvariant={isDestructive ? \"ghost\" : \"outline\"}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Icon className=\"h-5 w-5\" />\n\t\t\t\t\t\t\t\t\t{config.label}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Nested Picker Sheets */}\n\t\t\t<ReschedulePickerSheet\n\t\t\t\tisOpen={activePicker === \"reschedule\"}\n\t\t\t\tjob={activePickerJob}\n\t\t\t\tonClose={handlePickerClose}\n\t\t\t\tonConfirm={handleRescheduleConfirm}\n\t\t\t/>\n\n\t\t\t<TechnicianPickerSheet\n\t\t\t\tisOpen={activePicker === \"reassign\"}\n\t\t\t\tjob={activePickerJob}\n\t\t\t\tonClose={handlePickerClose}\n\t\t\t\tonConfirm={handleReassignConfirm}\n\t\t\t/>\n\n\t\t\t<StatusPickerSheet\n\t\t\t\tisOpen={activePicker === \"status\"}\n\t\t\t\tjob={activePickerJob}\n\t\t\t\tonClose={handlePickerClose}\n\t\t\t\tonConfirm={handleStatusConfirm}\n\t\t\t/>\n\t\t</>\n\t);\n}\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link setHours} function options.\n */\n\n/**\n * @name setHours\n * @category Hour Helpers\n * @summary Set the hours to the given date.\n *\n * @description\n * Set the hours to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param hours - The hours of the new date\n * @param options - An object with options\n *\n * @returns The new date with the hours set\n *\n * @example\n * // Set 4 hours to 1 September 2014 11:30:00:\n * const result = setHours(new Date(2014, 8, 1, 11, 30), 4)\n * //=> Mon Sep 01 2014 04:30:00\n */\nexport function setHours(date, hours, options) {\n  const _date = toDate(date, options?.in);\n  _date.setHours(hours);\n  return _date;\n}\n\n// Fallback for modularized imports:\nexport default setHours;\n","import { toDate } from \"./toDate.js\";\n\n/**\n * The {@link setMinutes} function options.\n */\n\n/**\n * @name setMinutes\n * @category Minute Helpers\n * @summary Set the minutes to the given date.\n *\n * @description\n * Set the minutes to the given date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows using extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, returned from the context function, or inferred from the arguments.\n *\n * @param date - The date to be changed\n * @param minutes - The minutes of the new date\n * @param options - An object with options\n *\n * @returns The new date with the minutes set\n *\n * @example\n * // Set 45 minutes to 1 September 2014 11:30:40:\n * const result = setMinutes(new Date(2014, 8, 1, 11, 30, 40), 45)\n * //=> Mon Sep 01 2014 11:45:40\n */\nexport function setMinutes(date, minutes, options) {\n  const date_ = toDate(date, options?.in);\n  date_.setMinutes(minutes);\n  return date_;\n}\n\n// Fallback for modularized imports:\nexport default setMinutes;\n","\"use client\";\n\nimport { addDays, format, setHours, setMinutes, startOfDay } from \"date-fns\";\nimport { Calendar as CalendarIcon, Clock, X } from \"lucide-react\";\nimport { useMemo, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Calendar } from \"@/components/ui/calendar\";\nimport { Label } from \"@/components/ui/label\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * ReschedulePickerSheet - Date and time picker for rescheduling jobs\n *\n * Features:\n * - Calendar date picker\n * - Time slot selection (30-minute intervals)\n * - Duration estimation based on job type\n * - Visual feedback for selected date/time\n * - Touch-friendly 56px+ buttons\n */\n\ntype ReschedulePickerSheetProps = {\n\tjob: Job | null;\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonConfirm: (job: Job, newStart: Date, newEnd: Date) => void;\n};\n\n// Generate time slots in 30-minute intervals\nconst generateTimeSlots = () => {\n\tconst slots: { label: string; time: string }[] = [];\n\tfor (let hour = 0; hour < 24; hour++) {\n\t\tfor (let minute = 0; minute < 60; minute += 30) {\n\t\t\tconst date = new Date();\n\t\t\tdate.setHours(hour, minute, 0, 0);\n\t\t\tslots.push({\n\t\t\t\tlabel: format(date, \"h:mm a\"),\n\t\t\t\ttime: `${String(hour).padStart(2, \"0\")}:${String(minute).padStart(2, \"0\")}`,\n\t\t\t});\n\t\t}\n\t}\n\treturn slots;\n};\n\nconst TIME_SLOTS = generateTimeSlots();\n\n// Business hours shortcuts (6am - 6pm)\nconst BUSINESS_HOURS = TIME_SLOTS.filter((slot) => {\n\tconst [hour] = slot.time.split(\":\").map(Number);\n\treturn hour >= 6 && hour < 18;\n});\n\nexport function ReschedulePickerSheet({\n\tjob,\n\tisOpen,\n\tonClose,\n\tonConfirm,\n}: ReschedulePickerSheetProps) {\n\tconst [selectedDate, setSelectedDate] = useState<Date | undefined>(\n\t\tjob?.scheduled_start ? new Date(job.scheduled_start) : new Date(),\n\t);\n\tconst [selectedTime, setSelectedTime] = useState<string>(\n\t\tjob?.scheduled_start\n\t\t\t? format(new Date(job.scheduled_start), \"HH:mm\")\n\t\t\t: \"09:00\",\n\t);\n\tconst [showAllHours, setShowAllHours] = useState(false);\n\n\t// Estimate duration based on job type or use actual duration\n\tconst estimatedDuration = useMemo(() => {\n\t\tif (job?.scheduled_start && job?.scheduled_end) {\n\t\t\tconst start = new Date(job.scheduled_start);\n\t\t\tconst end = new Date(job.scheduled_end);\n\t\t\treturn (end.getTime() - start.getTime()) / (1000 * 60 * 60); // hours\n\t\t}\n\n\t\t// Default estimates based on job title keywords\n\t\tconst title = job?.title?.toLowerCase() || \"\";\n\t\tif (title.includes(\"emergency\")) return 3;\n\t\tif (title.includes(\"install\")) return 4;\n\t\tif (title.includes(\"inspection\")) return 1;\n\t\tif (title.includes(\"maintenance\")) return 2;\n\t\treturn 2; // Default 2 hours\n\t}, [job]);\n\n\t// Calculate new end time\n\tconst newEndTime = useMemo(() => {\n\t\tif (!selectedDate || !selectedTime) return null;\n\n\t\tconst [hours, minutes] = selectedTime.split(\":\").map(Number);\n\t\tconst newStart = startOfDay(selectedDate);\n\t\tsetHours(newStart, hours);\n\t\tsetMinutes(newStart, minutes);\n\n\t\tconst newEnd = new Date(newStart);\n\t\tnewEnd.setHours(newStart.getHours() + Math.floor(estimatedDuration));\n\t\tnewEnd.setMinutes(newStart.getMinutes() + (estimatedDuration % 1) * 60);\n\n\t\treturn newEnd;\n\t}, [selectedDate, selectedTime, estimatedDuration]);\n\n\tconst handleConfirm = () => {\n\t\tif (!job || !selectedDate || !selectedTime || !newEndTime) return;\n\n\t\tconst [hours, minutes] = selectedTime.split(\":\").map(Number);\n\t\tconst newStart = startOfDay(selectedDate);\n\t\tsetHours(newStart, hours);\n\t\tsetMinutes(newStart, minutes);\n\n\t\tonConfirm(job, newStart, newEndTime);\n\t\tonClose();\n\t};\n\n\tif (!job) return null;\n\n\tconst displaySlots = showAllHours ? TIME_SLOTS : BUSINESS_HOURS;\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"90vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold mb-1\">\n\t\t\t\t\t\t\tReschedule Appointment\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{job.customer?.name || \"Unknown Customer\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\tCurrent:{\" \"}\n\t\t\t\t\t\t\t{job.scheduled_start\n\t\t\t\t\t\t\t\t? format(new Date(job.scheduled_start), \"MMM d, h:mm a\")\n\t\t\t\t\t\t\t\t: \"Not scheduled\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Content */}\n\t\t\t\t<ScrollArea\n\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\tstyle={{ maxHeight: \"calc(90vh - 240px)\" }}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"p-4 space-y-6\">\n\t\t\t\t\t\t{/* Calendar */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Label className=\"text-sm font-medium mb-2 flex items-center gap-2\">\n\t\t\t\t\t\t\t\t<CalendarIcon className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\tSelect Date\n\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t<div className=\"flex justify-center\">\n\t\t\t\t\t\t\t\t<Calendar\n\t\t\t\t\t\t\t\t\tdisabled={(date) => date < startOfDay(new Date())}\n\t\t\t\t\t\t\t\t\tmode=\"single\"\n\t\t\t\t\t\t\t\t\tonSelect={setSelectedDate}\n\t\t\t\t\t\t\t\t\tselected={selectedDate}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Time Slots */}\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<div className=\"flex items-center justify-between mb-2\">\n\t\t\t\t\t\t\t\t<Label className=\"text-sm font-medium flex items-center gap-2\">\n\t\t\t\t\t\t\t\t\t<Clock className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t\tSelect Time\n\t\t\t\t\t\t\t\t</Label>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => setShowAllHours(!showAllHours)}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{showAllHours ? \"Business Hours\" : \"All Hours\"}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"grid grid-cols-3 gap-2\">\n\t\t\t\t\t\t\t\t{displaySlots.map((slot) => (\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"h-12 text-sm font-medium\",\n\t\t\t\t\t\t\t\t\t\t\tselectedTime === slot.time &&\n\t\t\t\t\t\t\t\t\t\t\t\t\"bg-primary text-primary-foreground hover:bg-primary/90\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={slot.time}\n\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedTime(slot.time)}\n\t\t\t\t\t\t\t\t\t\tvariant={selectedTime === slot.time ? \"default\" : \"outline\"}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{slot.label}\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t{/* Preview */}\n\t\t\t\t\t\t{selectedDate && selectedTime && newEndTime && (\n\t\t\t\t\t\t\t<div className=\"bg-muted/50 rounded-lg p-4 space-y-2\">\n\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium\">New Schedule Preview</p>\n\t\t\t\t\t\t\t\t<div className=\"space-y-1 text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>Date:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{format(selectedDate, \"EEEE, MMMM d, yyyy\")}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>Start:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{format(\n\t\t\t\t\t\t\t\t\t\t\t\tsetHours(\n\t\t\t\t\t\t\t\t\t\t\t\t\tsetMinutes(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedDate,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tparseInt(selectedTime.split(\":\")[1]),\n\t\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\tparseInt(selectedTime.split(\":\")[0]),\n\t\t\t\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\t\t\t\t\"h:mm a\",\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>End:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{format(newEndTime, \"h:mm a\")}\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"flex justify-between\">\n\t\t\t\t\t\t\t\t\t\t<span>Duration:</span>\n\t\t\t\t\t\t\t\t\t\t<span className=\"font-medium text-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{estimatedDuration}h\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tdisabled={!selectedDate || !selectedTime}\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tConfirm Reschedule\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n","\"use client\";\n\nimport {\n\tCalendar,\n\tCheckCircle,\n\tCheckCircle2,\n\tClock,\n\tMapPin,\n\tNavigation,\n\tTruck,\n\tX,\n\tXCircle,\n} from \"lucide-react\";\nimport { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * StatusPickerSheet - Status selection for job workflow\n *\n * Features:\n * - Visual status options with icons and colors\n * - Status descriptions for clarity\n * - Workflow suggestions (next logical status)\n * - Touch-friendly 64px+ buttons\n * - Disabled states for invalid transitions\n */\n\ntype StatusPickerSheetProps = {\n\tjob: Job | null;\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonConfirm: (job: Job, newStatus: string) => void;\n};\n\n// Status configuration\nconst STATUS_OPTIONS = [\n\t{\n\t\tid: \"unscheduled\",\n\t\tlabel: \"Unscheduled\",\n\t\ticon: Clock,\n\t\tcolor: \"bg-gray-500\",\n\t\tborderColor: \"border-gray-500\",\n\t\tdescription: \"No date/time assigned\",\n\t},\n\t{\n\t\tid: \"scheduled\",\n\t\tlabel: \"Scheduled\",\n\t\ticon: Calendar,\n\t\tcolor: \"bg-blue-500\",\n\t\tborderColor: \"border-blue-500\",\n\t\tdescription: \"Date and time confirmed\",\n\t},\n\t{\n\t\tid: \"dispatched\",\n\t\tlabel: \"Dispatched\",\n\t\ticon: Truck,\n\t\tcolor: \"bg-sky-500\",\n\t\tborderColor: \"border-sky-500\",\n\t\tdescription: \"Technician on the way\",\n\t},\n\t{\n\t\tid: \"arrived\",\n\t\tlabel: \"Arrived\",\n\t\ticon: MapPin,\n\t\tcolor: \"bg-emerald-400\",\n\t\tborderColor: \"border-emerald-400\",\n\t\tdescription: \"Technician at location\",\n\t},\n\t{\n\t\tid: \"in_progress\",\n\t\tlabel: \"In Progress\",\n\t\ticon: Navigation,\n\t\tcolor: \"bg-amber-500 animate-pulse\",\n\t\tborderColor: \"border-amber-500\",\n\t\tdescription: \"Work actively underway\",\n\t},\n\t{\n\t\tid: \"closed\",\n\t\tlabel: \"Closed\",\n\t\ticon: CheckCircle,\n\t\tcolor: \"bg-emerald-600\",\n\t\tborderColor: \"border-emerald-600\",\n\t\tdescription: \"Work completed, awaiting review\",\n\t},\n\t{\n\t\tid: \"completed\",\n\t\tlabel: \"Completed\",\n\t\ticon: CheckCircle2,\n\t\tcolor: \"bg-green-700\",\n\t\tborderColor: \"border-green-700\",\n\t\tdescription: \"Fully complete and approved\",\n\t},\n\t{\n\t\tid: \"cancelled\",\n\t\tlabel: \"Cancelled\",\n\t\ticon: XCircle,\n\t\tcolor: \"bg-red-500\",\n\t\tborderColor: \"border-red-500\",\n\t\tdescription: \"Job cancelled or abandoned\",\n\t},\n] as const;\n\n// Workflow logic: what statuses make sense from current status\nconst getValidTransitions = (currentStatus?: string): string[] => {\n\tconst status = currentStatus?.toLowerCase() || \"unscheduled\";\n\n\tswitch (status) {\n\t\tcase \"unscheduled\":\n\t\t\treturn [\"scheduled\"];\n\t\tcase \"scheduled\":\n\t\t\treturn [\"dispatched\", \"cancelled\"];\n\t\tcase \"dispatched\":\n\t\t\treturn [\"arrived\", \"scheduled\", \"cancelled\"];\n\t\tcase \"arrived\":\n\t\t\treturn [\"in_progress\", \"dispatched\", \"cancelled\"];\n\t\tcase \"in_progress\":\n\t\t\treturn [\"closed\", \"arrived\"];\n\t\tcase \"closed\":\n\t\t\treturn [\"completed\", \"in_progress\"];\n\t\tcase \"completed\":\n\t\t\treturn []; // Terminal state\n\t\tcase \"cancelled\":\n\t\t\treturn [\"scheduled\"]; // Can re-schedule\n\t\tdefault:\n\t\t\treturn [\"scheduled\"];\n\t}\n};\n\nexport function StatusPickerSheet({\n\tjob,\n\tisOpen,\n\tonClose,\n\tonConfirm,\n}: StatusPickerSheetProps) {\n\tconst [selectedStatus, setSelectedStatus] = useState<string | null>(\n\t\tjob?.status?.toLowerCase() || null,\n\t);\n\n\tconst currentStatus = job?.status?.toLowerCase() || \"unscheduled\";\n\tconst validTransitions = getValidTransitions(currentStatus);\n\n\tconst handleConfirm = () => {\n\t\tif (!job || !selectedStatus) return;\n\t\tonConfirm(job, selectedStatus);\n\t\tonClose();\n\t};\n\n\tif (!job) return null;\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"85vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold mb-1\">Change Status</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{job.customer?.name || \"Unknown Customer\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground capitalize\">\n\t\t\t\t\t\t\tCurrent: {currentStatus.replace(/_/g, \" \")}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Status Options */}\n\t\t\t\t<ScrollArea\n\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\tstyle={{ maxHeight: \"calc(85vh - 220px)\" }}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"p-4 space-y-3\">\n\t\t\t\t\t\t{/* Suggested next statuses */}\n\t\t\t\t\t\t{validTransitions.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"mb-4\">\n\t\t\t\t\t\t\t\t<p className=\"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\tSuggested Next Steps\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\n\t\t\t\t\t\t{STATUS_OPTIONS.map((statusOption) => {\n\t\t\t\t\t\t\tconst isSelected = selectedStatus === statusOption.id;\n\t\t\t\t\t\t\tconst isCurrent = currentStatus === statusOption.id;\n\t\t\t\t\t\t\tconst isValid = validTransitions.includes(statusOption.id);\n\t\t\t\t\t\t\tconst isSuggested = isValid && !isCurrent;\n\t\t\t\t\t\t\tconst isDisabled =\n\t\t\t\t\t\t\t\tisCurrent || (!isValid && validTransitions.length > 0);\n\n\t\t\t\t\t\t\tconst StatusIcon = statusOption.icon;\n\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"flex w-full items-start gap-3 rounded-lg border-2 p-4 transition-all text-left\",\n\t\t\t\t\t\t\t\t\t\tisDisabled\n\t\t\t\t\t\t\t\t\t\t\t? \"opacity-50 cursor-not-allowed\"\n\t\t\t\t\t\t\t\t\t\t\t: \"hover:border-primary/50 active:scale-98\",\n\t\t\t\t\t\t\t\t\t\tisSelected && !isDisabled && \"border-primary bg-primary/5\",\n\t\t\t\t\t\t\t\t\t\tisSuggested &&\n\t\t\t\t\t\t\t\t\t\t\t!isSelected &&\n\t\t\t\t\t\t\t\t\t\t\t\"border-green-500/30 bg-green-50 dark:bg-green-950/20\",\n\t\t\t\t\t\t\t\t\t\tisCurrent && \"border-muted-foreground bg-muted\",\n\t\t\t\t\t\t\t\t\t\t!isSelected &&\n\t\t\t\t\t\t\t\t\t\t\t!isSuggested &&\n\t\t\t\t\t\t\t\t\t\t\t!isCurrent &&\n\t\t\t\t\t\t\t\t\t\t\t\"border-border\",\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tdisabled={isDisabled}\n\t\t\t\t\t\t\t\t\tkey={statusOption.id}\n\t\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\t\t!isDisabled && setSelectedStatus(statusOption.id)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t{/* Icon */}\n\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"flex h-12 w-12 shrink-0 items-center justify-center rounded-full\",\n\t\t\t\t\t\t\t\t\t\t\tstatusOption.color,\n\t\t\t\t\t\t\t\t\t\t\tisDisabled && \"opacity-50\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<StatusIcon className=\"h-6 w-6 text-white\" />\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Content */}\n\t\t\t\t\t\t\t\t\t<div className=\"flex-1 min-w-0\">\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-base font-semibold\">\n\t\t\t\t\t\t\t\t\t\t\t\t{statusOption.label}\n\t\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t\t\t{isCurrent && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-[10px] px-2 py-0.5 bg-muted-foreground/20 rounded-full font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tCurrent\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t{isSuggested && !isSelected && (\n\t\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-[10px] px-2 py-0.5 bg-green-500 text-white rounded-full font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t\tRecommended\n\t\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t{statusOption.description}\n\t\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t{/* Selection indicator */}\n\t\t\t\t\t\t\t\t\t{isSelected && !isDisabled && (\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex shrink-0 items-center justify-center h-6 w-6 rounded-full bg-primary\">\n\t\t\t\t\t\t\t\t\t\t\t<CheckCircle className=\"h-4 w-4 text-primary-foreground\" />\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})}\n\n\t\t\t\t\t\t{/* All other statuses */}\n\t\t\t\t\t\t{validTransitions.length > 0 && (\n\t\t\t\t\t\t\t<div className=\"pt-4 border-t\">\n\t\t\t\t\t\t\t\t<p className=\"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\tOther Statuses\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mb-3\">\n\t\t\t\t\t\t\t\t\tThese transitions may not be typical for the current workflow\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tdisabled={!selectedStatus || selectedStatus === currentStatus}\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tUpdate Status\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n","\"use client\";\n\nimport { Check, Search, UserCircle, X } from \"lucide-react\";\nimport { useMemo, useState } from \"react\";\nimport { Avatar, AvatarFallback } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job, Technician } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * TechnicianPickerSheet - Technician selection for job assignment\n *\n * Features:\n * - Search technicians by name\n * - Shows current workload (jobs assigned)\n * - Visual feedback for selected technician\n * - Touch-friendly 56px+ buttons\n * - Unassign option to remove technician\n */\n\ntype TechnicianPickerSheetProps = {\n\tjob: Job | null;\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonConfirm: (job: Job, technicianId: string | null) => void;\n};\n\nexport function TechnicianPickerSheet({\n\tjob,\n\tisOpen,\n\tonClose,\n\tonConfirm,\n}: TechnicianPickerSheetProps) {\n\t// Get Maps from store (stable references)\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Convert Maps to arrays once (memoized)\n\tconst technicians = useMemo(\n\t\t() => Array.from(techniciansMap.values()),\n\t\t[techniciansMap],\n\t);\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst [selectedTechId, setSelectedTechId] = useState<string | null>(\n\t\tjob?.assignedTechnicianId || null,\n\t);\n\n\t// Calculate workload for each technician\n\tconst techniciansWithWorkload = useMemo(() => {\n\t\treturn technicians.map((tech) => {\n\t\t\tconst assignedJobs = jobs.filter(\n\t\t\t\t(j) => j.assignedTechnicianId === tech.id,\n\t\t\t);\n\t\t\tconst activeJobs = assignedJobs.filter(\n\t\t\t\t(j) =>\n\t\t\t\t\t![\"completed\", \"cancelled\", \"closed\"].includes(\n\t\t\t\t\t\tj.status?.toLowerCase() || \"\",\n\t\t\t\t\t),\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\t...tech,\n\t\t\t\ttotalJobs: assignedJobs.length,\n\t\t\t\tactiveJobs: activeJobs.length,\n\t\t\t};\n\t\t});\n\t}, [technicians, jobs]);\n\n\t// Filter technicians by search query\n\tconst filteredTechnicians = useMemo(() => {\n\t\tif (!searchQuery.trim()) return techniciansWithWorkload;\n\n\t\tconst query = searchQuery.toLowerCase();\n\t\treturn techniciansWithWorkload.filter((tech) =>\n\t\t\ttech.name.toLowerCase().includes(query),\n\t\t);\n\t}, [techniciansWithWorkload, searchQuery]);\n\n\t// Sort: Current assignee first, then by active jobs (least busy first)\n\tconst sortedTechnicians = useMemo(() => {\n\t\treturn [...filteredTechnicians].sort((a, b) => {\n\t\t\t// Current assignee always first\n\t\t\tif (a.id === job?.assignedTechnicianId) return -1;\n\t\t\tif (b.id === job?.assignedTechnicianId) return 1;\n\n\t\t\t// Then sort by active jobs (least busy first)\n\t\t\treturn a.activeJobs - b.activeJobs;\n\t\t});\n\t}, [filteredTechnicians, job]);\n\n\tconst handleConfirm = () => {\n\t\tif (!job) return;\n\t\tonConfirm(job, selectedTechId);\n\t\tonClose();\n\t};\n\n\tif (!job) return null;\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"85vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold mb-1\">Assign Technician</h2>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{job.customer?.name || \"Unknown Customer\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">{job.title}</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Search */}\n\t\t\t\t<div className=\"px-4 pt-4\">\n\t\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n\t\t\t\t\t\t<Input\n\t\t\t\t\t\t\tclassName=\"h-11 pl-10 text-base\"\n\t\t\t\t\t\t\tonChange={(e) => setSearchQuery(e.target.value)}\n\t\t\t\t\t\t\tplaceholder=\"Search technicians...\"\n\t\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\t\tvalue={searchQuery}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Unassign Option */}\n\t\t\t\t{job.assignedTechnicianId && (\n\t\t\t\t\t<div className=\"px-4 pt-3\">\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-orange-500/50 active:scale-98\",\n\t\t\t\t\t\t\t\tselectedTechId === null\n\t\t\t\t\t\t\t\t\t? \"border-orange-500 bg-orange-50 dark:bg-orange-950/20\"\n\t\t\t\t\t\t\t\t\t: \"border-border\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={() => setSelectedTechId(null)}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<div className=\"flex h-12 w-12 items-center justify-center rounded-full bg-orange-100 dark:bg-orange-900\">\n\t\t\t\t\t\t\t\t<UserCircle className=\"h-6 w-6 text-orange-600 dark:text-orange-400\" />\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t<div className=\"flex-1 text-left\">\n\t\t\t\t\t\t\t\t<p className=\"text-base font-semibold\">Unassign Technician</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tRemove technician from this job\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t{selectedTechId === null && (\n\t\t\t\t\t\t\t\t<Check className=\"h-5 w-5 text-orange-600 shrink-0\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\n\t\t\t\t{/* Technician List */}\n\t\t\t\t<ScrollArea\n\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\tstyle={{ maxHeight: \"calc(85vh - 280px)\" }}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"p-4 space-y-2\">\n\t\t\t\t\t\t{sortedTechnicians.length === 0 ? (\n\t\t\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t\t\t<UserCircle className=\"h-12 w-12 text-muted-foreground/50 mb-3\" />\n\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium mb-1\">No technicians found</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tTry a different search term\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\tsortedTechnicians.map((tech) => {\n\t\t\t\t\t\t\t\tconst isSelected = selectedTechId === tech.id;\n\t\t\t\t\t\t\t\tconst isCurrentAssignee = job.assignedTechnicianId === tech.id;\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-primary/50 active:scale-98\",\n\t\t\t\t\t\t\t\t\t\t\tisSelected\n\t\t\t\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"border-border\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedTechId(tech.id)}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<Avatar className=\"h-12 w-12\">\n\t\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"text-sm font-medium\">\n\t\t\t\t\t\t\t\t\t\t\t\t{tech.name\n\t\t\t\t\t\t\t\t\t\t\t\t\t.split(\" \")\n\t\t\t\t\t\t\t\t\t\t\t\t\t.map((n) => n[0])\n\t\t\t\t\t\t\t\t\t\t\t\t\t.join(\"\")\n\t\t\t\t\t\t\t\t\t\t\t\t\t.toUpperCase()\n\t\t\t\t\t\t\t\t\t\t\t\t\t.slice(0, 2)}\n\t\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t\t</Avatar>\n\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex-1 text-left\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t\t\t\t\t\t<p className=\"text-base font-semibold\">{tech.name}</p>\n\t\t\t\t\t\t\t\t\t\t\t\t{isCurrentAssignee && (\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName=\"h-5 px-2 text-[9px]\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tCurrent\n\t\t\t\t\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3 text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t\t\t<span>{tech.activeJobs} active</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span>â€¢</span>\n\t\t\t\t\t\t\t\t\t\t\t\t<span>{tech.totalJobs} total</span>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t{/* Workload indicator */}\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-2 shrink-0\">\n\t\t\t\t\t\t\t\t\t\t\t<div className=\"flex flex-col items-end\">\n\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"h-2 w-16 rounded-full bg-muted overflow-hidden\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"h-full transition-all\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs === 0 && \"bg-green-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs > 0 &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs <= 3 &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"bg-blue-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs > 3 &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs <= 6 &&\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\"bg-yellow-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttech.activeJobs > 6 && \"bg-red-500\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\twidth: `${Math.min((tech.activeJobs / 10) * 100, 100)}%`,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t\t\t\t{isSelected && <Check className=\"h-5 w-5 text-primary\" />}\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tCancel\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-12\"\n\t\t\t\t\t\t\tdisabled={selectedTechId === job.assignedTechnicianId}\n\t\t\t\t\t\t\tonClick={handleConfirm}\n\t\t\t\t\t\t\tsize=\"lg\"\n\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{selectedTechId === null ? \"Unassign\" : \"Assign Technician\"}\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</>\n\t);\n}\n","\"use client\";\n\nimport { format } from \"date-fns\";\nimport { Clock, MapPin, User } from \"lucide-react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * JobCardMobile - Mobile-optimized job card component\n *\n * Design specifications:\n * - Height: 80px (comfortable touch target, 44px+ recommended)\n * - Full-width layout with clear visual hierarchy\n * - Large touch targets for tap interactions\n * - Displays: customer, time, location, technician, status\n * - Optimized for vertical list scrolling\n *\n * Usage:\n * - List view: Primary job card in vertical scrolling list\n * - Day view: Job card in technician timeline slots\n * - Week view: Job card in kanban columns\n *\n * Interactions:\n * - Tap card: Opens bottom sheet with job details and actions\n * - Long-press: Enters selection mode (future)\n * - Swipe: Quick actions like dispatch/unassign (future)\n */\n\ntype JobStatus =\n\t| \"unscheduled\"\n\t| \"scheduled\"\n\t| \"dispatched\"\n\t| \"arrived\"\n\t| \"in_progress\"\n\t| \"closed\"\n\t| \"completed\"\n\t| \"cancelled\";\n\ntype JobCardMobileProps = {\n\tjob: Job;\n\tonClick?: () => void;\n\tclassName?: string;\n\tshowTechnician?: boolean; // Hide technician info in day view (already grouped by tech)\n\tshowDate?: boolean; // Show date in list/week views, hide in day view (already grouped by date)\n};\n\n// Status badge styles (consistent with desktop)\nconst statusStyles: Record<\n\tJobStatus,\n\t{ bg: string; text: string; label: string }\n> = {\n\tunscheduled: {\n\t\tbg: \"bg-gray-100 dark:bg-gray-800\",\n\t\ttext: \"text-gray-700 dark:text-gray-300\",\n\t\tlabel: \"Unscheduled\",\n\t},\n\tscheduled: {\n\t\tbg: \"bg-blue-100 dark:bg-blue-900/30\",\n\t\ttext: \"text-blue-700 dark:text-blue-300\",\n\t\tlabel: \"Scheduled\",\n\t},\n\tdispatched: {\n\t\tbg: \"bg-yellow-100 dark:bg-yellow-900/30\",\n\t\ttext: \"text-yellow-700 dark:text-yellow-300\",\n\t\tlabel: \"Dispatched\",\n\t},\n\tarrived: {\n\t\tbg: \"bg-purple-100 dark:bg-purple-900/30\",\n\t\ttext: \"text-purple-700 dark:text-purple-300\",\n\t\tlabel: \"Arrived\",\n\t},\n\tin_progress: {\n\t\tbg: \"bg-orange-100 dark:bg-orange-900/30\",\n\t\ttext: \"text-orange-700 dark:text-orange-300\",\n\t\tlabel: \"In Progress\",\n\t},\n\tclosed: {\n\t\tbg: \"bg-green-100 dark:bg-green-900/30\",\n\t\ttext: \"text-green-700 dark:text-green-300\",\n\t\tlabel: \"Closed\",\n\t},\n\tcompleted: {\n\t\tbg: \"bg-emerald-100 dark:bg-emerald-900/30\",\n\t\ttext: \"text-emerald-700 dark:text-emerald-300\",\n\t\tlabel: \"Completed\",\n\t},\n\tcancelled: {\n\t\tbg: \"bg-red-100 dark:bg-red-900/30\",\n\t\ttext: \"text-red-700 dark:text-red-300\",\n\t\tlabel: \"Cancelled\",\n\t},\n};\n\nexport function JobCardMobile({\n\tjob,\n\tonClick,\n\tclassName,\n\tshowTechnician = true,\n\tshowDate = true,\n}: JobCardMobileProps) {\n\tconst status = (job.status?.toLowerCase().replace(/ /g, \"_\") ||\n\t\t\"unscheduled\") as JobStatus;\n\tconst statusStyle = statusStyles[status] || statusStyles.unscheduled;\n\n\t// Format time (9:00 AM - 10:30 AM)\n\tconst startTime = job.startTime\n\t\t? format(new Date(job.startTime), \"h:mm a\")\n\t\t: \"Not scheduled\";\n\tconst endTime = job.endTime ? format(new Date(job.endTime), \"h:mm a\") : \"\";\n\tconst timeRange = endTime ? `${startTime} - ${endTime}` : startTime;\n\n\t// Format date (Jan 15)\n\tconst dateDisplay = job.startTime\n\t\t? format(new Date(job.startTime), \"MMM d\")\n\t\t: \"\";\n\n\t// Get primary technician from assignments\n\tconst primaryAssignment = job.assignments.find((a) => a.role === \"primary\");\n\tconst techInitials = primaryAssignment?.displayName\n\t\t? primaryAssignment.displayName\n\t\t\t\t.split(\" \")\n\t\t\t\t.map((n) => n[0])\n\t\t\t\t.join(\"\")\n\t\t\t\t.toUpperCase()\n\t\t\t\t.slice(0, 2)\n\t\t: \"?\";\n\n\t// Customer/property info\n\tconst customerName = job.customer?.name || \"No Customer\";\n\tconst locationDisplay = job.location?.address?.street || \"No location\";\n\n\treturn (\n\t\t<button\n\t\t\tclassName={cn(\n\t\t\t\t// Base styles - more compact, full width\n\t\t\t\t\"group relative flex w-full items-center gap-3 rounded-lg border bg-card p-3 text-left transition-all\",\n\t\t\t\t// Reduced height for compact design\n\t\t\t\t\"min-h-[64px]\",\n\t\t\t\t// Hover/active states\n\t\t\t\t\"hover:border-primary/30 hover:bg-primary/5 hover:shadow-sm\",\n\t\t\t\t\"active:scale-[0.99]\",\n\t\t\t\t// Focus states for accessibility\n\t\t\t\t\"focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n\t\t\t\tclassName,\n\t\t\t)}\n\t\t\tonClick={onClick}\n\t\t\ttype=\"button\"\n\t\t>\n\t\t\t{/* Left: Time */}\n\t\t\t<div className=\"flex flex-col items-center justify-center shrink-0 w-16 text-center\">\n\t\t\t\t<span className=\"text-sm font-semibold leading-tight\">\n\t\t\t\t\t{startTime === \"Not scheduled\"\n\t\t\t\t\t\t? \"--:--\"\n\t\t\t\t\t\t: format(new Date(job.startTime), \"h:mm\")}\n\t\t\t\t</span>\n\t\t\t\t<span className=\"text-[0.65rem] text-muted-foreground uppercase\">\n\t\t\t\t\t{startTime === \"Not scheduled\"\n\t\t\t\t\t\t? \"\"\n\t\t\t\t\t\t: format(new Date(job.startTime), \"a\")}\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t{/* Center: Job info */}\n\t\t\t<div className=\"flex-1 min-w-0 space-y-0.5\">\n\t\t\t\t{/* Customer name */}\n\t\t\t\t<h3 className=\"text-sm font-semibold leading-tight truncate\">\n\t\t\t\t\t{customerName}\n\t\t\t\t</h3>\n\t\t\t\t{/* Job title */}\n\t\t\t\t<p className=\"text-xs text-muted-foreground truncate\">\n\t\t\t\t\t{job.title || \"Untitled Job\"}\n\t\t\t\t</p>\n\t\t\t\t{/* Location - only on mobile, very compact */}\n\t\t\t\t{locationDisplay !== \"No location\" && (\n\t\t\t\t\t<div className=\"flex items-center gap-1 text-[0.65rem] text-muted-foreground\">\n\t\t\t\t\t\t<MapPin className=\"h-2.5 w-2.5\" />\n\t\t\t\t\t\t<span className=\"truncate\">{locationDisplay}</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Right: Status badge + Technician */}\n\t\t\t<div className=\"flex flex-col items-end gap-1.5 shrink-0\">\n\t\t\t\t{/* Status badge - smaller */}\n\t\t\t\t<Badge\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"text-[0.65rem] font-medium h-4 px-1.5\",\n\t\t\t\t\t\tstatusStyle.bg,\n\t\t\t\t\t\tstatusStyle.text,\n\t\t\t\t\t)}\n\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t>\n\t\t\t\t\t{statusStyle.label}\n\t\t\t\t</Badge>\n\n\t\t\t\t{/* Technician avatar - only if showing */}\n\t\t\t\t{showTechnician && (\n\t\t\t\t\t<div className=\"flex items-center gap-1\">\n\t\t\t\t\t\t<Avatar className=\"h-4 w-4\">\n\t\t\t\t\t\t\t<AvatarImage\n\t\t\t\t\t\t\t\talt={primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t\t\tsrc={primaryAssignment?.avatar || undefined}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<AvatarFallback className=\"text-[0.5rem] font-medium\">\n\t\t\t\t\t\t\t\t{techInitials}\n\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t<span className=\"text-[0.65rem] text-muted-foreground max-w-[60px] truncate\">\n\t\t\t\t\t\t\t{primaryAssignment?.displayName || \"Unassigned\"}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</button>\n\t);\n}\n","\"use client\";\n\nimport {\n\tBarChart3,\n\tCalendar,\n\tFilter,\n\tLayoutGrid,\n\tList,\n\tPlus,\n\tSearch,\n} from \"lucide-react\";\nimport { useRouter } from \"next/navigation\";\nimport { useMemo, useState } from \"react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n\tSheetTrigger,\n} from \"@/components/ui/sheet\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport { FilterJobsSheet } from \"./filter-jobs-sheet\";\nimport { SearchJobsSheet } from \"./search-jobs-sheet\";\n\n/**\n * MobileScheduleHeader - Feature-rich mobile toolbar\n *\n * Features:\n * - View mode switcher (Day/Week/List)\n * - Quick stats (Total/Completed/In Progress/Unassigned)\n * - Search jobs\n * - Filter options\n * - Create new job\n */\n\ntype ViewMode = \"day\" | \"week\" | \"list\";\n\ntype MobileScheduleHeaderProps = {\n\tonJobSelect?: (job: Job) => void;\n};\n\nexport function MobileScheduleHeader({\n\tonJobSelect,\n}: MobileScheduleHeaderProps) {\n\tconst router = useRouter();\n\tconst { viewMode, setViewMode } = useScheduleViewStore();\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Local state for sheets\n\tconst [showSearch, setShowSearch] = useState(false);\n\tconst [showFilter, setShowFilter] = useState(false);\n\tconst [activeFilters, setActiveFilters] = useState<{\n\t\tstatuses: string[];\n\t\ttechnicianIds: string[];\n\t\tshowUnassignedOnly: boolean;\n\t}>({\n\t\tstatuses: [],\n\t\ttechnicianIds: [],\n\t\tshowUnassignedOnly: false,\n\t});\n\n\t// Calculate stats\n\tconst stats = useMemo(() => {\n\t\tconst jobs = Array.from(jobsMap.values());\n\t\tconst today = new Date();\n\t\ttoday.setHours(0, 0, 0, 0);\n\n\t\tconst todaysJobs = jobs.filter((job) => {\n\t\t\tconst jobDate = new Date(job.startTime);\n\t\t\tjobDate.setHours(0, 0, 0, 0);\n\t\t\treturn jobDate.getTime() === today.getTime();\n\t\t});\n\n\t\treturn {\n\t\t\ttotal: todaysJobs.length,\n\t\t\tcompleted: todaysJobs.filter((j) => j.status === \"completed\").length,\n\t\t\tinProgress: todaysJobs.filter(\n\t\t\t\t(j) => j.status === \"in_progress\" || j.status === \"in-progress\",\n\t\t\t).length,\n\t\t\tunassigned: todaysJobs.filter((j) => j.isUnassigned).length,\n\t\t};\n\t}, [jobsMap]);\n\n\tconst handleViewModeChange = (mode: ViewMode) => {\n\t\tsetViewMode(mode);\n\t};\n\n\tconst handleCreateJob = () => {\n\t\trouter.push(\"/dashboard/work/jobs/new\");\n\t};\n\n\tconst handleJobSelect = (job: Job) => {\n\t\tif (onJobSelect) {\n\t\t\tonJobSelect(job);\n\t\t}\n\t};\n\n\tconst handleApplyFilters = (filters: typeof activeFilters) => {\n\t\tsetActiveFilters(filters);\n\t\t// TODO: Apply filters to job list\n\t};\n\n\tconst activeFilterCount =\n\t\tactiveFilters.statuses.length +\n\t\tactiveFilters.technicianIds.length +\n\t\t(activeFilters.showUnassignedOnly ? 1 : 0);\n\n\treturn (\n\t\t<div className=\"safe-top sticky top-0 z-35 border-b bg-background/95 backdrop-blur-sm supports-[backdrop-filter]:bg-background/80\">\n\t\t\t{/* Top row: Actions */}\n\t\t\t<div className=\"flex items-center justify-between gap-2 px-4 py-2.5\">\n\t\t\t\t{/* View mode switcher */}\n\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-lg border p-1\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => handleViewModeChange(\"day\")}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant={viewMode === \"day\" ? \"secondary\" : \"ghost\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t<Calendar className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Day view</span>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => handleViewModeChange(\"week\")}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant={viewMode === \"week\" ? \"secondary\" : \"ghost\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t<LayoutGrid className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Week view</span>\n\t\t\t\t\t</Button>\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => handleViewModeChange(\"list\")}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant={viewMode === \"list\" ? \"secondary\" : \"ghost\"}\n\t\t\t\t\t>\n\t\t\t\t\t\t<List className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">List view</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Action buttons */}\n\t\t\t\t<div className=\"flex items-center gap-1.5\">\n\t\t\t\t\t{/* Stats sheet */}\n\t\t\t\t\t<Sheet>\n\t\t\t\t\t\t<SheetTrigger asChild>\n\t\t\t\t\t\t\t<Button className=\"h-9 w-9 p-0\" size=\"sm\" variant=\"ghost\">\n\t\t\t\t\t\t\t\t<BarChart3 className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t\t<span className=\"sr-only\">View stats</span>\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</SheetTrigger>\n\t\t\t\t\t\t<SheetContent side=\"bottom\" className=\"h-[300px]\">\n\t\t\t\t\t\t\t<SheetHeader>\n\t\t\t\t\t\t\t\t<SheetTitle>Today's Stats</SheetTitle>\n\t\t\t\t\t\t\t</SheetHeader>\n\t\t\t\t\t\t\t<div className=\"mt-6 grid grid-cols-2 gap-4\">\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold\">{stats.total}</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Total Jobs</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-green-600\">\n\t\t\t\t\t\t\t\t\t\t{stats.completed}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Completed</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-orange-600\">\n\t\t\t\t\t\t\t\t\t\t{stats.inProgress}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">In Progress</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div className=\"rounded-lg border p-4\">\n\t\t\t\t\t\t\t\t\t<p className=\"text-2xl font-bold text-yellow-600\">\n\t\t\t\t\t\t\t\t\t\t{stats.unassigned}\n\t\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">Unassigned</p>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</SheetContent>\n\t\t\t\t\t</Sheet>\n\n\t\t\t\t\t{/* Search button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={() => setShowSearch(true)}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Search className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Search jobs</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Filter button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0 relative\"\n\t\t\t\t\t\tonClick={() => setShowFilter(true)}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Filter className=\"h-4 w-4\" />\n\t\t\t\t\t\t{activeFilterCount > 0 && (\n\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\tclassName=\"absolute -top-1 -right-1 h-4 min-w-4 p-0 text-[0.6rem]\"\n\t\t\t\t\t\t\t\tvariant=\"destructive\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{activeFilterCount}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t)}\n\t\t\t\t\t\t<span className=\"sr-only\">Filter jobs</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Create job button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 p-0\"\n\t\t\t\t\t\tonClick={handleCreateJob}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Plus className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Create job</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Bottom row: Quick stats pills */}\n\t\t\t<div className=\"flex items-center gap-2 overflow-x-auto px-4 pb-2 scrollbar-none\">\n\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border bg-muted/50 px-3 py-1 text-xs whitespace-nowrap\">\n\t\t\t\t\t<span className=\"font-semibold\">{stats.total}</span>\n\t\t\t\t\t<span className=\"text-muted-foreground\">Total</span>\n\t\t\t\t</div>\n\t\t\t\t{stats.completed > 0 && (\n\t\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border border-green-200 bg-green-50 px-3 py-1 text-xs whitespace-nowrap dark:border-green-900 dark:bg-green-950\">\n\t\t\t\t\t\t<span className=\"font-semibold text-green-700 dark:text-green-300\">\n\t\t\t\t\t\t\t{stats.completed}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span className=\"text-green-600 dark:text-green-400\">Done</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{stats.inProgress > 0 && (\n\t\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border border-orange-200 bg-orange-50 px-3 py-1 text-xs whitespace-nowrap dark:border-orange-900 dark:bg-orange-950\">\n\t\t\t\t\t\t<span className=\"font-semibold text-orange-700 dark:text-orange-300\">\n\t\t\t\t\t\t\t{stats.inProgress}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span className=\"text-orange-600 dark:text-orange-400\">Active</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t\t{stats.unassigned > 0 && (\n\t\t\t\t\t<div className=\"flex items-center gap-1.5 rounded-full border border-yellow-200 bg-yellow-50 px-3 py-1 text-xs whitespace-nowrap dark:border-yellow-900 dark:bg-yellow-950\">\n\t\t\t\t\t\t<span className=\"font-semibold text-yellow-700 dark:text-yellow-300\">\n\t\t\t\t\t\t\t{stats.unassigned}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span className=\"text-yellow-600 dark:text-yellow-400\">\n\t\t\t\t\t\t\tUnassigned\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Search Sheet */}\n\t\t\t<SearchJobsSheet\n\t\t\t\tisOpen={showSearch}\n\t\t\t\tonClose={() => setShowSearch(false)}\n\t\t\t\tonJobSelect={handleJobSelect}\n\t\t\t/>\n\n\t\t\t{/* Filter Sheet */}\n\t\t\t<FilterJobsSheet\n\t\t\t\tactiveFilters={activeFilters}\n\t\t\t\tisOpen={showFilter}\n\t\t\t\tonApplyFilters={handleApplyFilters}\n\t\t\t\tonClose={() => setShowFilter(false)}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { Check, Filter, X } from \"lucide-react\";\nimport { useMemo, useState } from \"react\";\nimport { Avatar, AvatarFallback, AvatarImage } from \"@/components/ui/avatar\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n} from \"@/components/ui/sheet\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * FilterJobsSheet - Mobile filter interface for jobs\n *\n * Features:\n * - Filter by status (scheduled, dispatched, in progress, etc.)\n * - Filter by technician\n * - Filter by date range\n * - Show unassigned jobs\n * - Apply/Clear filters\n * - Visual indicators for active filters\n */\n\ntype FilterJobsSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tactiveFilters: {\n\t\tstatuses: string[];\n\t\ttechnicianIds: string[];\n\t\tshowUnassignedOnly: boolean;\n\t};\n\tonApplyFilters: (filters: {\n\t\tstatuses: string[];\n\t\ttechnicianIds: string[];\n\t\tshowUnassignedOnly: boolean;\n\t}) => void;\n};\n\nconst STATUS_OPTIONS = [\n\t{\n\t\tvalue: \"scheduled\",\n\t\tlabel: \"Scheduled\",\n\t\tcolor: \"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300\",\n\t},\n\t{\n\t\tvalue: \"dispatched\",\n\t\tlabel: \"Dispatched\",\n\t\tcolor:\n\t\t\t\"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300\",\n\t},\n\t{\n\t\tvalue: \"arrived\",\n\t\tlabel: \"Arrived\",\n\t\tcolor:\n\t\t\t\"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300\",\n\t},\n\t{\n\t\tvalue: \"in_progress\",\n\t\tlabel: \"In Progress\",\n\t\tcolor:\n\t\t\t\"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300\",\n\t},\n\t{\n\t\tvalue: \"completed\",\n\t\tlabel: \"Completed\",\n\t\tcolor:\n\t\t\t\"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300\",\n\t},\n\t{\n\t\tvalue: \"cancelled\",\n\t\tlabel: \"Cancelled\",\n\t\tcolor: \"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300\",\n\t},\n];\n\nexport function FilterJobsSheet({\n\tisOpen,\n\tonClose,\n\tactiveFilters,\n\tonApplyFilters,\n}: FilterJobsSheetProps) {\n\tconst [selectedStatuses, setSelectedStatuses] = useState<string[]>(\n\t\tactiveFilters.statuses,\n\t);\n\tconst [selectedTechnicianIds, setSelectedTechnicianIds] = useState<string[]>(\n\t\tactiveFilters.technicianIds,\n\t);\n\tconst [showUnassignedOnly, setShowUnassignedOnly] = useState(\n\t\tactiveFilters.showUnassignedOnly,\n\t);\n\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\tconst technicians = useMemo(\n\t\t() => Array.from(techniciansMap.values()),\n\t\t[techniciansMap],\n\t);\n\n\tconst toggleStatus = (status: string) => {\n\t\tsetSelectedStatuses((prev) =>\n\t\t\tprev.includes(status)\n\t\t\t\t? prev.filter((s) => s !== status)\n\t\t\t\t: [...prev, status],\n\t\t);\n\t};\n\n\tconst toggleTechnician = (techId: string) => {\n\t\tsetSelectedTechnicianIds((prev) =>\n\t\t\tprev.includes(techId)\n\t\t\t\t? prev.filter((id) => id !== techId)\n\t\t\t\t: [...prev, techId],\n\t\t);\n\t};\n\n\tconst handleApply = () => {\n\t\tonApplyFilters({\n\t\t\tstatuses: selectedStatuses,\n\t\t\ttechnicianIds: selectedTechnicianIds,\n\t\t\tshowUnassignedOnly,\n\t\t});\n\t\tonClose();\n\t};\n\n\tconst handleClear = () => {\n\t\tsetSelectedStatuses([]);\n\t\tsetSelectedTechnicianIds([]);\n\t\tsetShowUnassignedOnly(false);\n\t};\n\n\tconst hasActiveFilters =\n\t\tselectedStatuses.length > 0 ||\n\t\tselectedTechnicianIds.length > 0 ||\n\t\tshowUnassignedOnly;\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={onClose}>\n\t\t\t<SheetContent\n\t\t\t\tside=\"right\"\n\t\t\t\tclassName=\"w-[300px] sm:w-[400px] flex flex-col\"\n\t\t\t>\n\t\t\t\t<SheetHeader>\n\t\t\t\t\t<SheetTitle className=\"flex items-center justify-between\">\n\t\t\t\t\t\t<span>Filter Jobs</span>\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"h-8 w-8 p-0\"\n\t\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t</SheetTitle>\n\t\t\t\t</SheetHeader>\n\n\t\t\t\t<div className=\"flex-1 overflow-y-auto py-6 space-y-6\">\n\t\t\t\t\t{/* Status Filters */}\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t<Label className=\"text-sm font-semibold\">Status</Label>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t{STATUS_OPTIONS.map((status) => (\n\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\"flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors\",\n\t\t\t\t\t\t\t\t\t\tselectedStatuses.includes(status.value)\n\t\t\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5\"\n\t\t\t\t\t\t\t\t\t\t\t: \"border-border hover:bg-muted/50\",\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\tkey={status.value}\n\t\t\t\t\t\t\t\t\tonClick={() => toggleStatus(status.value)}\n\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\"text-xs\", status.color)}\n\t\t\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{status.label}\n\t\t\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t\t\t\t{selectedStatuses.includes(status.value) && (\n\t\t\t\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Technician Filters */}\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t<Label className=\"text-sm font-semibold\">Technician</Label>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t{technicians.map((tech) => {\n\t\t\t\t\t\t\t\tconst initials = tech.name\n\t\t\t\t\t\t\t\t\t.split(\" \")\n\t\t\t\t\t\t\t\t\t.map((n) => n[0])\n\t\t\t\t\t\t\t\t\t.join(\"\")\n\t\t\t\t\t\t\t\t\t.toUpperCase()\n\t\t\t\t\t\t\t\t\t.slice(0, 2);\n\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors\",\n\t\t\t\t\t\t\t\t\t\t\tselectedTechnicianIds.includes(tech.id)\n\t\t\t\t\t\t\t\t\t\t\t\t? \"border-primary bg-primary/5\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"border-border hover:bg-muted/50\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\t\t\tonClick={() => toggleTechnician(tech.id)}\n\t\t\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t<div className=\"flex items-center gap-3\">\n\t\t\t\t\t\t\t\t\t\t\t<Avatar className=\"h-8 w-8\">\n\t\t\t\t\t\t\t\t\t\t\t\t<AvatarImage\n\t\t\t\t\t\t\t\t\t\t\t\t\talt={tech.name}\n\t\t\t\t\t\t\t\t\t\t\t\t\tsrc={tech.avatar || undefined}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t\t<AvatarFallback className=\"text-xs\">\n\t\t\t\t\t\t\t\t\t\t\t\t\t{initials}\n\t\t\t\t\t\t\t\t\t\t\t\t</AvatarFallback>\n\t\t\t\t\t\t\t\t\t\t\t</Avatar>\n\t\t\t\t\t\t\t\t\t\t\t<span className=\"text-sm font-medium\">{tech.name}</span>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t{selectedTechnicianIds.includes(tech.id) && (\n\t\t\t\t\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-primary\" />\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t})}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Unassigned Filter */}\n\t\t\t\t\t<div className=\"space-y-3\">\n\t\t\t\t\t\t<Label className=\"text-sm font-semibold\">Special Filters</Label>\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors\",\n\t\t\t\t\t\t\t\tshowUnassignedOnly\n\t\t\t\t\t\t\t\t\t? \"border-yellow-500 bg-yellow-50 dark:bg-yellow-950/20\"\n\t\t\t\t\t\t\t\t\t: \"border-border hover:bg-muted/50\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tonClick={() => setShowUnassignedOnly(!showUnassignedOnly)}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"text-sm font-medium\">Show unassigned only</span>\n\t\t\t\t\t\t\t{showUnassignedOnly && (\n\t\t\t\t\t\t\t\t<Check className=\"h-4 w-4 text-yellow-600 dark:text-yellow-400\" />\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Footer Actions */}\n\t\t\t\t<div className=\"shrink-0 space-y-2 border-t pt-4\">\n\t\t\t\t\t{hasActiveFilters && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"w-full\"\n\t\t\t\t\t\t\tonClick={handleClear}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tClear All Filters\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t\t<Button className=\"w-full\" onClick={handleApply} size=\"default\">\n\t\t\t\t\t\tApply Filters\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n","\"use client\";\n\nimport { Search, X } from \"lucide-react\";\nimport { useMemo, useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n\tSheet,\n\tSheetContent,\n\tSheetHeader,\n\tSheetTitle,\n} from \"@/components/ui/sheet\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { JobCardMobile } from \"./job-card-mobile\";\n\n/**\n * SearchJobsSheet - Mobile search interface for jobs\n *\n * Features:\n * - Real-time search as you type\n * - Searches customer name, job title, location\n * - Shows matching jobs in scrollable list\n * - Tap job to view details\n * - Clear search button\n */\n\ntype SearchJobsSheetProps = {\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonJobSelect: (job: Job) => void;\n};\n\nexport function SearchJobsSheet({\n\tisOpen,\n\tonClose,\n\tonJobSelect,\n}: SearchJobsSheetProps) {\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Get all jobs as array\n\tconst allJobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\t// Filter jobs by search query\n\tconst filteredJobs = useMemo(() => {\n\t\tif (!searchQuery.trim()) return [];\n\n\t\tconst query = searchQuery.toLowerCase();\n\n\t\treturn allJobs.filter((job) => {\n\t\t\t// Search customer name\n\t\t\tconst customerName = job.customer?.name?.toLowerCase() || \"\";\n\t\t\tif (customerName.includes(query)) return true;\n\n\t\t\t// Search job title\n\t\t\tconst jobTitle = job.title?.toLowerCase() || \"\";\n\t\t\tif (jobTitle.includes(query)) return true;\n\n\t\t\t// Search location\n\t\t\tconst location = job.location?.address?.street?.toLowerCase() || \"\";\n\t\t\tif (location.includes(query)) return true;\n\n\t\t\t// Search job number\n\t\t\tconst jobNumber = job.jobNumber?.toString().toLowerCase() || \"\";\n\t\t\tif (jobNumber.includes(query)) return true;\n\n\t\t\treturn false;\n\t\t});\n\t}, [allJobs, searchQuery]);\n\n\tconst handleJobClick = (job: Job) => {\n\t\tonJobSelect(job);\n\t\tonClose();\n\t};\n\n\tconst handleClearSearch = () => {\n\t\tsetSearchQuery(\"\");\n\t};\n\n\treturn (\n\t\t<Sheet open={isOpen} onOpenChange={onClose}>\n\t\t\t<SheetContent side=\"top\" className=\"h-[90vh] flex flex-col\">\n\t\t\t\t<SheetHeader>\n\t\t\t\t\t<SheetTitle>Search Jobs</SheetTitle>\n\t\t\t\t</SheetHeader>\n\n\t\t\t\t{/* Search Input */}\n\t\t\t\t<div className=\"relative mt-4\">\n\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n\t\t\t\t\t<Input\n\t\t\t\t\t\tautoFocus\n\t\t\t\t\t\tclassName=\"pl-9 pr-9\"\n\t\t\t\t\t\tonChange={(e) => setSearchQuery(e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Search by customer, job title, location...\"\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tvalue={searchQuery}\n\t\t\t\t\t/>\n\t\t\t\t\t{searchQuery && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0\"\n\t\t\t\t\t\t\tonClick={handleClearSearch}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t\t\t<span className=\"sr-only\">Clear search</span>\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Results */}\n\t\t\t\t<div className=\"flex-1 overflow-y-auto mt-4\">\n\t\t\t\t\t{!searchQuery.trim() ? (\n\t\t\t\t\t\t<div className=\"flex h-full items-center justify-center\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<Search className=\"mx-auto h-12 w-12 text-muted-foreground opacity-20\" />\n\t\t\t\t\t\t\t\t<p className=\"mt-4 text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tStart typing to search jobs\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : filteredJobs.length === 0 ? (\n\t\t\t\t\t\t<div className=\"flex h-full items-center justify-center\">\n\t\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t\t<Search className=\"mx-auto h-12 w-12 text-muted-foreground opacity-20\" />\n\t\t\t\t\t\t\t\t<p className=\"mt-4 text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\t\tNo jobs found for &quot;{searchQuery}&quot;\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground mb-3\">\n\t\t\t\t\t\t\t\t{filteredJobs.length}{\" \"}\n\t\t\t\t\t\t\t\t{filteredJobs.length === 1 ? \"job\" : \"jobs\"} found\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t{filteredJobs.map((job) => (\n\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\tonClick={() => handleJobClick(job)}\n\t\t\t\t\t\t\t\t\tshowDate={true}\n\t\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</SheetContent>\n\t\t</Sheet>\n\t);\n}\n","\"use client\";\n\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { EmptyStateMobile } from \"./empty-state-mobile\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { JobCardMobile } from \"./job-card-mobile\";\n\n/**\n * KanbanViewMobile - Mobile-optimized kanban view with single column\n *\n * Completely different from desktop 8-column kanban:\n * - ONE status column at a time (full screen width)\n * - Horizontal swipe to navigate between statuses\n * - Status indicator dots at top\n * - Full-width job cards (better readability)\n * - Tap card â†’ bottom sheet with \"Move to...\" action\n * - NO drag & drop (use bottom sheet to change status)\n *\n * Layout:\n * â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\n * â”‚ â—‹ â—‹ â—‹ â— â—‹ â—‹ â—‹ â—‹                â”‚ Status dots\n * â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚\n * â”‚    â† Dispatched â†’               â”‚ Current status\n * â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤\n * â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\n * â”‚ â”‚ Job card (full width)       â”‚ â”‚\n * â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\n * â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚\n * â”‚ â”‚ Job card                    â”‚ â”‚\n * â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚\n * â”‚                                 â”‚\n * â”‚ 12 jobs                         â”‚ Count\n * â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n *\n * Swipe left/right changes status column\n */\n\nconst STATUS_COLUMNS = [\n\t{ id: \"unscheduled\", label: \"Unscheduled\", color: \"bg-gray-500\" },\n\t{ id: \"scheduled\", label: \"Scheduled\", color: \"bg-blue-500\" },\n\t{ id: \"dispatched\", label: \"Dispatched\", color: \"bg-yellow-500\" },\n\t{ id: \"arrived\", label: \"Arrived\", color: \"bg-purple-500\" },\n\t{ id: \"in_progress\", label: \"In Progress\", color: \"bg-orange-500\" },\n\t{ id: \"closed\", label: \"Closed\", color: \"bg-green-500\" },\n\t{ id: \"completed\", label: \"Completed\", color: \"bg-emerald-500\" },\n\t{ id: \"cancelled\", label: \"Cancelled\", color: \"bg-red-500\" },\n] as const;\n\nexport function KanbanViewMobile() {\n\t// Get Map from store (stable reference)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\n\t// Convert Map to array once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\t// Local state\n\tconst [currentStatusIndex, setCurrentStatusIndex] = useState(2); // Start at \"dispatched\"\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\n\tconst currentStatus = STATUS_COLUMNS[currentStatusIndex];\n\n\t// Filter jobs by current status\n\tconst statusJobs = useMemo(() => {\n\t\treturn jobs.filter((job) => {\n\t\t\tconst jobStatus = (job.status || \"unscheduled\")\n\t\t\t\t.toLowerCase()\n\t\t\t\t.replace(/ /g, \"_\");\n\t\t\treturn jobStatus === currentStatus.id;\n\t\t});\n\t}, [jobs, currentStatus.id]);\n\n\t// Sort by scheduled start time\n\tconst sortedJobs = useMemo(() => {\n\t\treturn [...statusJobs].sort((a, b) => {\n\t\t\tif (!a.scheduled_start) return 1;\n\t\t\tif (!b.scheduled_start) return -1;\n\t\t\treturn (\n\t\t\t\tnew Date(a.scheduled_start).getTime() -\n\t\t\t\tnew Date(b.scheduled_start).getTime()\n\t\t\t);\n\t\t});\n\t}, [statusJobs]);\n\n\t// Navigation handlers\n\tconst handlePrevious = useCallback(() => {\n\t\tsetCurrentStatusIndex((prev) => Math.max(0, prev - 1));\n\t}, []);\n\n\tconst handleNext = useCallback(() => {\n\t\tsetCurrentStatusIndex((prev) =>\n\t\t\tMath.min(STATUS_COLUMNS.length - 1, prev + 1),\n\t\t);\n\t}, []);\n\n\tconst handleJumpToStatus = useCallback((index: number) => {\n\t\tsetCurrentStatusIndex(index);\n\t}, []);\n\n\t// Job action handler\n\tconst handleJobAction = useCallback(\n\t\tasync (action: string, job: Job, ...args: unknown[]) => {\n\t\t\tconsole.log(\"Job action:\", action, job, args);\n\t\t\tsetSelectedJob(null);\n\n\t\t\ttry {\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase \"view_details\":\n\t\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"dispatch\":\n\t\t\t\t\tcase \"arrive\":\n\t\t\t\t\tcase \"start\":\n\t\t\t\t\tcase \"complete\":\n\t\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst newStatus =\n\t\t\t\t\t\t\taction === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t\t\t`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reassign\": {\n\t\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\n\t\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"cancel\": {\n\t\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\n\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\t\ttoast.error(\"An error occurred\");\n\t\t\t}\n\t\t},\n\t\t[],\n\t);\n\n\tconst canGoPrevious = currentStatusIndex > 0;\n\tconst canGoNext = currentStatusIndex < STATUS_COLUMNS.length - 1;\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Header: Status indicator dots */}\n\t\t\t<div className=\"shrink-0 border-b bg-background p-4\">\n\t\t\t\t{/* Dots */}\n\t\t\t\t<div className=\"mb-4 flex items-center justify-center gap-2\">\n\t\t\t\t\t{STATUS_COLUMNS.map((status, index) => {\n\t\t\t\t\t\tconst isActive = index === currentStatusIndex;\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclassName=\"transition-transform hover:scale-125 active:scale-110\"\n\t\t\t\t\t\t\t\tkey={status.id}\n\t\t\t\t\t\t\t\tonClick={() => handleJumpToStatus(index)}\n\t\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\t\tclassName={`h-2 w-2 rounded-full transition-all ${\n\t\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t\t? `${status.color} scale-125`\n\t\t\t\t\t\t\t\t\t\t\t: \"bg-muted-foreground/30\"\n\t\t\t\t\t\t\t\t\t}`}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<span className=\"sr-only\">{status.label}</span>\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Current status with navigation */}\n\t\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t\t{/* Previous button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tdisabled={!canGoPrevious}\n\t\t\t\t\t\tonClick={handlePrevious}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Previous status</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Current status */}\n\t\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={`mb-1 h-1 w-16 rounded-full ${currentStatus.color}`}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<h2 className=\"text-lg font-semibold\">{currentStatus.label}</h2>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t{sortedJobs.length} {sortedJobs.length === 1 ? \"job\" : \"jobs\"}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Next button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tdisabled={!canGoNext}\n\t\t\t\t\t\tonClick={handleNext}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Next status</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Scrollable job list */}\n\t\t\t<div className=\"flex-1 overflow-y-auto\">\n\t\t\t\t{sortedJobs.length === 0 ? (\n\t\t\t\t\t<div className=\"flex h-full items-center justify-center p-6\">\n\t\t\t\t\t\t<div className=\"text-center\">\n\t\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t\tNo jobs with status \"{currentStatus.label}\"\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t{canGoNext && (\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tclassName=\"mt-4\"\n\t\t\t\t\t\t\t\t\tonClick={handleNext}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\tView {STATUS_COLUMNS[currentStatusIndex + 1].label}\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-2 p-4\">\n\t\t\t\t\t\t{sortedJobs.map((job) => (\n\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\tshowDate={true}\n\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { format, isToday, isTomorrow, parseISO } from \"date-fns\";\nimport { Plus, Search } from \"lucide-react\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport {\n\tSelect,\n\tSelectContent,\n\tSelectItem,\n\tSelectTrigger,\n\tSelectValue,\n} from \"@/components/ui/select\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { EmptyStateMobile } from \"./empty-state-mobile\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\nimport { JobCardMobile } from \"./job-card-mobile\";\nimport type { ActiveFilters, FilterOption } from \"./schedule-filters-mobile\";\nimport { ScheduleFiltersMobile } from \"./schedule-filters-mobile\";\n\n/**\n * ListViewMobile - Primary mobile schedule view\n *\n * Features:\n * - Vertical scrolling list of all jobs\n * - Search bar at top (full-text search)\n * - Filter chips (status, technician)\n * - Group by: Date, Technician, Status, Customer\n * - Sort by: Start Time, Priority, Customer\n * - Tap job card â†’ bottom sheet with actions\n * - Pull to refresh (future)\n * - Floating Action Button (FAB) for new appointments\n * - Infinite scroll with lazy loading (future)\n *\n * This is the DEFAULT mobile view as it provides the best\n * mobile experience with vertical scrolling and easy filtering.\n */\n\ntype GroupByOption = \"date\" | \"technician\" | \"status\" | \"customer\";\ntype SortByOption = \"start_time\" | \"priority\" | \"customer\" | \"status\";\n\nexport function ListViewMobile() {\n\t// Get Maps from store (stable references)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\tconst techniciansMap = useScheduleStore((state) => state.technicians);\n\n\t// Convert Maps to arrays once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\tconst technicians = useMemo(\n\t\t() => Array.from(techniciansMap.values()),\n\t\t[techniciansMap],\n\t);\n\n\t// Local state\n\tconst [searchQuery, setSearchQuery] = useState(\"\");\n\tconst [groupBy, setGroupBy] = useState<GroupByOption>(\"date\");\n\tconst [sortBy, setSortBy] = useState<SortByOption>(\"start_time\");\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\tconst [activeFilters, setActiveFilters] = useState<ActiveFilters>({\n\t\tstatuses: [],\n\t\ttechnicians: [],\n\t});\n\n\t// Filter options\n\tconst statusOptions: FilterOption[] = useMemo(() => {\n\t\tconst statusCounts = jobs.reduce(\n\t\t\t(acc, job) => {\n\t\t\t\tconst status = job.status || \"unscheduled\";\n\t\t\t\tacc[status] = (acc[status] || 0) + 1;\n\t\t\t\treturn acc;\n\t\t\t},\n\t\t\t{} as Record<string, number>,\n\t\t);\n\n\t\treturn [\n\t\t\t{\n\t\t\t\tid: \"scheduled\",\n\t\t\t\tlabel: \"Scheduled\",\n\t\t\t\tcount: statusCounts.scheduled || 0,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"dispatched\",\n\t\t\t\tlabel: \"Dispatched\",\n\t\t\t\tcount: statusCounts.dispatched || 0,\n\t\t\t},\n\t\t\t{ id: \"arrived\", label: \"Arrived\", count: statusCounts.arrived || 0 },\n\t\t\t{\n\t\t\t\tid: \"in_progress\",\n\t\t\t\tlabel: \"In Progress\",\n\t\t\t\tcount: statusCounts.in_progress || 0,\n\t\t\t},\n\t\t\t{\n\t\t\t\tid: \"completed\",\n\t\t\t\tlabel: \"Completed\",\n\t\t\t\tcount: statusCounts.completed || 0,\n\t\t\t},\n\t\t];\n\t}, [jobs]);\n\n\tconst technicianOptions: FilterOption[] = useMemo(() => {\n\t\treturn technicians.map((tech) => {\n\t\t\tconst jobCount = jobs.filter(\n\t\t\t\t(job) => job.assignedTechnicianId === tech.id,\n\t\t\t).length;\n\t\t\treturn {\n\t\t\t\tid: tech.id,\n\t\t\t\tlabel: tech.name,\n\t\t\t\tcount: jobCount,\n\t\t\t};\n\t\t});\n\t}, [technicians, jobs]);\n\n\t// Filter jobs based on search and filters\n\tconst filteredJobs = useMemo(() => {\n\t\tlet filtered = [...jobs];\n\n\t\t// Search filter\n\t\tif (searchQuery.trim()) {\n\t\t\tconst query = searchQuery.toLowerCase();\n\t\t\tfiltered = filtered.filter(\n\t\t\t\t(job) =>\n\t\t\t\t\tjob.customer?.name.toLowerCase().includes(query) ||\n\t\t\t\t\tjob.title?.toLowerCase().includes(query) ||\n\t\t\t\t\tjob.property?.address?.toLowerCase().includes(query) ||\n\t\t\t\t\tjob.description?.toLowerCase().includes(query),\n\t\t\t);\n\t\t}\n\n\t\t// Status filter\n\t\tif (activeFilters.statuses.length > 0) {\n\t\t\tfiltered = filtered.filter((job) =>\n\t\t\t\tactiveFilters.statuses.includes(\n\t\t\t\t\tjob.status?.toLowerCase() || \"unscheduled\",\n\t\t\t\t),\n\t\t\t);\n\t\t}\n\n\t\t// Technician filter\n\t\tif (activeFilters.technicians.length > 0) {\n\t\t\tfiltered = filtered.filter((job) =>\n\t\t\t\tjob.assignedTechnicianId\n\t\t\t\t\t? activeFilters.technicians.includes(job.assignedTechnicianId)\n\t\t\t\t\t: false,\n\t\t\t);\n\t\t}\n\n\t\treturn filtered;\n\t}, [jobs, searchQuery, activeFilters]);\n\n\t// Sort jobs\n\tconst sortedJobs = useMemo(() => {\n\t\tconst sorted = [...filteredJobs];\n\n\t\tswitch (sortBy) {\n\t\t\tcase \"start_time\":\n\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\tif (!a.scheduled_start) return 1;\n\t\t\t\t\tif (!b.scheduled_start) return -1;\n\t\t\t\t\treturn (\n\t\t\t\t\t\tnew Date(a.scheduled_start).getTime() -\n\t\t\t\t\t\tnew Date(b.scheduled_start).getTime()\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"customer\":\n\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\tconst nameA = a.customer?.name || \"\";\n\t\t\t\t\tconst nameB = b.customer?.name || \"\";\n\t\t\t\t\treturn nameA.localeCompare(nameB);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"status\":\n\t\t\t\tsorted.sort((a, b) => {\n\t\t\t\t\tconst statusA = a.status || \"unscheduled\";\n\t\t\t\t\tconst statusB = b.status || \"unscheduled\";\n\t\t\t\t\treturn statusA.localeCompare(statusB);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\n\t\treturn sorted;\n\t}, [filteredJobs, sortBy]);\n\n\t// Group jobs\n\tconst groupedJobs = useMemo(() => {\n\t\tconst groups: Record<string, Job[]> = {};\n\n\t\tsortedJobs.forEach((job) => {\n\t\t\tlet groupKey = \"\";\n\n\t\t\tswitch (groupBy) {\n\t\t\t\tcase \"date\": {\n\t\t\t\t\tif (!job.scheduled_start) {\n\t\t\t\t\t\tgroupKey = \"Unscheduled\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Handle both ISO string and Date object\n\t\t\t\t\t\tconst date =\n\t\t\t\t\t\t\ttypeof job.scheduled_start === \"string\"\n\t\t\t\t\t\t\t\t? parseISO(job.scheduled_start)\n\t\t\t\t\t\t\t\t: new Date(job.scheduled_start);\n\n\t\t\t\t\t\tif (isToday(date)) {\n\t\t\t\t\t\t\tgroupKey = \"Today\";\n\t\t\t\t\t\t} else if (isTomorrow(date)) {\n\t\t\t\t\t\t\tgroupKey = \"Tomorrow\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgroupKey = format(date, \"EEEE, MMM d\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tcase \"technician\":\n\t\t\t\t\tgroupKey = job.assignedTechnician?.name || \"Unassigned\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"status\":\n\t\t\t\t\tgroupKey = job.status || \"Unscheduled\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"customer\":\n\t\t\t\t\tgroupKey = job.customer?.name || \"No Customer\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tgroupKey = \"All Jobs\";\n\t\t\t}\n\n\t\t\tif (!groups[groupKey]) {\n\t\t\t\tgroups[groupKey] = [];\n\t\t\t}\n\t\t\tgroups[groupKey].push(job);\n\t\t});\n\n\t\treturn groups;\n\t}, [sortedJobs, groupBy]);\n\n\t// Filter handlers\n\tconst handleToggleStatus = useCallback((statusId: string) => {\n\t\tsetActiveFilters((prev) => ({\n\t\t\t...prev,\n\t\t\tstatuses: prev.statuses.includes(statusId)\n\t\t\t\t? prev.statuses.filter((s) => s !== statusId)\n\t\t\t\t: [...prev.statuses, statusId],\n\t\t}));\n\t}, []);\n\n\tconst handleToggleTechnician = useCallback((techId: string) => {\n\t\tsetActiveFilters((prev) => ({\n\t\t\t...prev,\n\t\t\ttechnicians: prev.technicians.includes(techId)\n\t\t\t\t? prev.technicians.filter((t) => t !== techId)\n\t\t\t\t: [...prev.technicians, techId],\n\t\t}));\n\t}, []);\n\n\tconst handleClearFilters = useCallback(() => {\n\t\tsetActiveFilters({ statuses: [], technicians: [] });\n\t\tsetSearchQuery(\"\");\n\t}, []);\n\n\t// Job action handler\n\tconst handleJobAction = useCallback(\n\t\tasync (action: string, job: Job, ...args: unknown[]) => {\n\t\t\tconsole.log(\"Job action:\", action, job, args);\n\t\t\tsetSelectedJob(null);\n\n\t\t\ttry {\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase \"view_details\":\n\t\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"dispatch\":\n\t\t\t\t\tcase \"arrive\":\n\t\t\t\t\tcase \"start\":\n\t\t\t\t\tcase \"complete\":\n\t\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst newStatus =\n\t\t\t\t\t\t\taction === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t\t\t`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reassign\": {\n\t\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\n\t\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"cancel\": {\n\t\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\n\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\t\ttoast.error(\"An error occurred\");\n\t\t\t}\n\t\t},\n\t\t[],\n\t);\n\n\t// Empty state\n\tif (\n\t\tfilteredJobs.length === 0 &&\n\t\t!searchQuery &&\n\t\tactiveFilters.statuses.length === 0\n\t) {\n\t\treturn (\n\t\t\t<div className=\"flex h-full flex-col\">\n\t\t\t\t<EmptyStateMobile\n\t\t\t\t\tonAction={() => {\n\t\t\t\t\t\twindow.location.href = \"/dashboard/work/jobs/new\";\n\t\t\t\t\t}}\n\t\t\t\t\tvariant=\"no_jobs\"\n\t\t\t\t/>\n\t\t\t</div>\n\t\t);\n\t}\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Header: Search */}\n\t\t\t<div className=\"shrink-0 space-y-3 border-b bg-background p-4\">\n\t\t\t\t{/* Search input */}\n\t\t\t\t<div className=\"relative\">\n\t\t\t\t\t<Search className=\"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground\" />\n\t\t\t\t\t<Input\n\t\t\t\t\t\tclassName=\"h-11 pl-10 text-base\"\n\t\t\t\t\t\tonChange={(e) => setSearchQuery(e.target.value)}\n\t\t\t\t\t\tplaceholder=\"Search jobs, customers, or locations...\"\n\t\t\t\t\t\ttype=\"search\"\n\t\t\t\t\t\tvalue={searchQuery}\n\t\t\t\t\t/>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Filters */}\n\t\t\t\t<ScheduleFiltersMobile\n\t\t\t\t\tactiveFilters={activeFilters}\n\t\t\t\t\tonClearAll={handleClearFilters}\n\t\t\t\t\tonToggleStatus={handleToggleStatus}\n\t\t\t\t\tonToggleTechnician={handleToggleTechnician}\n\t\t\t\t\tstatusOptions={statusOptions}\n\t\t\t\t\ttechnicianOptions={technicianOptions}\n\t\t\t\t/>\n\n\t\t\t\t{/* Group by / Sort by controls */}\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<Select\n\t\t\t\t\t\tonValueChange={(value) => setGroupBy(value as GroupByOption)}\n\t\t\t\t\t\tvalue={groupBy}\n\t\t\t\t\t>\n\t\t\t\t\t\t<SelectTrigger className=\"h-9 w-[140px] text-sm\">\n\t\t\t\t\t\t\t<SelectValue placeholder=\"Group by\" />\n\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t<SelectItem value=\"date\">Group by Date</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"technician\">Group by Tech</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"status\">Group by Status</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"customer\">Group by Customer</SelectItem>\n\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t</Select>\n\n\t\t\t\t\t<Select\n\t\t\t\t\t\tonValueChange={(value) => setSortBy(value as SortByOption)}\n\t\t\t\t\t\tvalue={sortBy}\n\t\t\t\t\t>\n\t\t\t\t\t\t<SelectTrigger className=\"h-9 w-[140px] text-sm\">\n\t\t\t\t\t\t\t<SelectValue placeholder=\"Sort by\" />\n\t\t\t\t\t\t</SelectTrigger>\n\t\t\t\t\t\t<SelectContent>\n\t\t\t\t\t\t\t<SelectItem value=\"start_time\">Sort by Time</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"customer\">Sort by Customer</SelectItem>\n\t\t\t\t\t\t\t<SelectItem value=\"status\">Sort by Status</SelectItem>\n\t\t\t\t\t\t</SelectContent>\n\t\t\t\t\t</Select>\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Scrollable job list */}\n\t\t\t<div className=\"flex-1 overflow-y-auto\">\n\t\t\t\t{filteredJobs.length === 0 ? (\n\t\t\t\t\t<EmptyStateMobile\n\t\t\t\t\t\tactionLabel=\"Clear Filters\"\n\t\t\t\t\t\tonAction={handleClearFilters}\n\t\t\t\t\t\tvariant=\"no_results\"\n\t\t\t\t\t/>\n\t\t\t\t) : (\n\t\t\t\t\t<div className=\"space-y-6 p-4\">\n\t\t\t\t\t\t{Object.entries(groupedJobs).map(([groupName, groupJobs]) => (\n\t\t\t\t\t\t\t<div key={groupName}>\n\t\t\t\t\t\t\t\t{/* Section header */}\n\t\t\t\t\t\t\t\t<div className=\"mb-3 flex items-center justify-between\">\n\t\t\t\t\t\t\t\t\t<h3 className=\"text-sm font-semibold text-muted-foreground uppercase tracking-wide\">\n\t\t\t\t\t\t\t\t\t\t{groupName}\n\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t<span className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t\t\t\t{groupJobs.length} {groupJobs.length === 1 ? \"job\" : \"jobs\"}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</div>\n\n\t\t\t\t\t\t\t\t{/* Job cards */}\n\t\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t\t{groupJobs.map((job) => (\n\t\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\t\tonClick={() => setSelectedJob(job)}\n\t\t\t\t\t\t\t\t\t\t\tshowDate={groupBy !== \"date\"}\n\t\t\t\t\t\t\t\t\t\t\tshowTechnician={groupBy !== \"technician\"}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t))}\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Floating Action Button (FAB) - Create new job */}\n\t\t\t<Button\n\t\t\t\tclassName=\"fixed right-4 bottom-20 lg:bottom-4 h-14 w-14 rounded-full shadow-lg\"\n\t\t\t\tonClick={() => {\n\t\t\t\t\twindow.location.href = \"/dashboard/work/jobs/new\";\n\t\t\t\t}}\n\t\t\t\tsize=\"icon\"\n\t\t\t>\n\t\t\t\t<Plus className=\"h-6 w-6\" />\n\t\t\t\t<span className=\"sr-only\">Create new job</span>\n\t\t\t</Button>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","import { addDays } from \"./addDays.js\";\nimport { constructNow } from \"./constructNow.js\";\nimport { isSameDay } from \"./isSameDay.js\";\n\n/**\n * The {@link isTomorrow} function options.\n */\n\n/**\n * @name isTomorrow\n * @category Day Helpers\n * @summary Is the given date tomorrow?\n * @pure false\n *\n * @description\n * Is the given date tomorrow?\n *\n * @param date - The date to check\n * @param options - An object with options\n *\n * @returns The date is tomorrow\n *\n * @example\n * // If today is 6 October 2014, is 7 October 14:00:00 tomorrow?\n * const result = isTomorrow(new Date(2014, 9, 7, 14, 0))\n * //=> true\n */\nexport function isTomorrow(date, options) {\n  return isSameDay(\n    date,\n    addDays(constructNow(options?.in || date), 1),\n    options,\n  );\n}\n\n// Fallback for modularized imports:\nexport default isTomorrow;\n","import {\n  millisecondsInHour,\n  millisecondsInMinute,\n} from \"./constants.js\";\nimport { constructFrom } from \"./constructFrom.js\";\nimport { toDate } from \"./toDate.js\";\n\n/**\n * The {@link parseISO} function options.\n */\n\n/**\n * @name parseISO\n * @category Common Helpers\n * @summary Parse ISO string\n *\n * @description\n * Parse the given string in ISO 8601 format and return an instance of Date.\n *\n * Function accepts complete ISO 8601 formats as well as partial implementations.\n * ISO 8601: http://en.wikipedia.org/wiki/ISO_8601\n *\n * If the argument isn't a string, the function cannot parse the string or\n * the values are invalid, it returns Invalid Date.\n *\n * @typeParam DateType - The `Date` type, the function operates on. Gets inferred from passed arguments. Allows to use extensions like [`UTCDate`](https://github.com/date-fns/utc).\n * @typeParam ResultDate - The result `Date` type, it is the type returned from the context function if it is passed, or inferred from the arguments.\n *\n * @param argument - The value to convert\n * @param options - An object with options\n *\n * @returns The parsed date in the local time zone\n *\n * @example\n * // Convert string '2014-02-11T11:30:30' to date:\n * const result = parseISO('2014-02-11T11:30:30')\n * //=> Tue Feb 11 2014 11:30:30\n *\n * @example\n * // Convert string '+02014101' to date,\n * // if the additional number of digits in the extended year format is 1:\n * const result = parseISO('+02014101', { additionalDigits: 1 })\n * //=> Fri Apr 11 2014 00:00:00\n */\nexport function parseISO(argument, options) {\n  const invalidDate = () => constructFrom(options?.in, NaN);\n\n  const additionalDigits = options?.additionalDigits ?? 2;\n  const dateStrings = splitDateString(argument);\n\n  let date;\n  if (dateStrings.date) {\n    const parseYearResult = parseYear(dateStrings.date, additionalDigits);\n    date = parseDate(parseYearResult.restDateString, parseYearResult.year);\n  }\n\n  if (!date || isNaN(+date)) return invalidDate();\n\n  const timestamp = +date;\n  let time = 0;\n  let offset;\n\n  if (dateStrings.time) {\n    time = parseTime(dateStrings.time);\n    if (isNaN(time)) return invalidDate();\n  }\n\n  if (dateStrings.timezone) {\n    offset = parseTimezone(dateStrings.timezone);\n    if (isNaN(offset)) return invalidDate();\n  } else {\n    const tmpDate = new Date(timestamp + time);\n    const result = toDate(0, options?.in);\n    result.setFullYear(\n      tmpDate.getUTCFullYear(),\n      tmpDate.getUTCMonth(),\n      tmpDate.getUTCDate(),\n    );\n    result.setHours(\n      tmpDate.getUTCHours(),\n      tmpDate.getUTCMinutes(),\n      tmpDate.getUTCSeconds(),\n      tmpDate.getUTCMilliseconds(),\n    );\n    return result;\n  }\n\n  return toDate(timestamp + time + offset, options?.in);\n}\n\nconst patterns = {\n  dateTimeDelimiter: /[T ]/,\n  timeZoneDelimiter: /[Z ]/i,\n  timezone: /([Z+-].*)$/,\n};\n\nconst dateRegex =\n  /^-?(?:(\\d{3})|(\\d{2})(?:-?(\\d{2}))?|W(\\d{2})(?:-?(\\d{1}))?|)$/;\nconst timeRegex =\n  /^(\\d{2}(?:[.,]\\d*)?)(?::?(\\d{2}(?:[.,]\\d*)?))?(?::?(\\d{2}(?:[.,]\\d*)?))?$/;\nconst timezoneRegex = /^([+-])(\\d{2})(?::?(\\d{2}))?$/;\n\nfunction splitDateString(dateString) {\n  const dateStrings = {};\n  const array = dateString.split(patterns.dateTimeDelimiter);\n  let timeString;\n\n  // The regex match should only return at maximum two array elements.\n  // [date], [time], or [date, time].\n  if (array.length > 2) {\n    return dateStrings;\n  }\n\n  if (/:/.test(array[0])) {\n    timeString = array[0];\n  } else {\n    dateStrings.date = array[0];\n    timeString = array[1];\n    if (patterns.timeZoneDelimiter.test(dateStrings.date)) {\n      dateStrings.date = dateString.split(patterns.timeZoneDelimiter)[0];\n      timeString = dateString.substr(\n        dateStrings.date.length,\n        dateString.length,\n      );\n    }\n  }\n\n  if (timeString) {\n    const token = patterns.timezone.exec(timeString);\n    if (token) {\n      dateStrings.time = timeString.replace(token[1], \"\");\n      dateStrings.timezone = token[1];\n    } else {\n      dateStrings.time = timeString;\n    }\n  }\n\n  return dateStrings;\n}\n\nfunction parseYear(dateString, additionalDigits) {\n  const regex = new RegExp(\n    \"^(?:(\\\\d{4}|[+-]\\\\d{\" +\n      (4 + additionalDigits) +\n      \"})|(\\\\d{2}|[+-]\\\\d{\" +\n      (2 + additionalDigits) +\n      \"})$)\",\n  );\n\n  const captures = dateString.match(regex);\n  // Invalid ISO-formatted year\n  if (!captures) return { year: NaN, restDateString: \"\" };\n\n  const year = captures[1] ? parseInt(captures[1]) : null;\n  const century = captures[2] ? parseInt(captures[2]) : null;\n\n  // either year or century is null, not both\n  return {\n    year: century === null ? year : century * 100,\n    restDateString: dateString.slice((captures[1] || captures[2]).length),\n  };\n}\n\nfunction parseDate(dateString, year) {\n  // Invalid ISO-formatted year\n  if (year === null) return new Date(NaN);\n\n  const captures = dateString.match(dateRegex);\n  // Invalid ISO-formatted string\n  if (!captures) return new Date(NaN);\n\n  const isWeekDate = !!captures[4];\n  const dayOfYear = parseDateUnit(captures[1]);\n  const month = parseDateUnit(captures[2]) - 1;\n  const day = parseDateUnit(captures[3]);\n  const week = parseDateUnit(captures[4]);\n  const dayOfWeek = parseDateUnit(captures[5]) - 1;\n\n  if (isWeekDate) {\n    if (!validateWeekDate(year, week, dayOfWeek)) {\n      return new Date(NaN);\n    }\n    return dayOfISOWeekYear(year, week, dayOfWeek);\n  } else {\n    const date = new Date(0);\n    if (\n      !validateDate(year, month, day) ||\n      !validateDayOfYearDate(year, dayOfYear)\n    ) {\n      return new Date(NaN);\n    }\n    date.setUTCFullYear(year, month, Math.max(dayOfYear, day));\n    return date;\n  }\n}\n\nfunction parseDateUnit(value) {\n  return value ? parseInt(value) : 1;\n}\n\nfunction parseTime(timeString) {\n  const captures = timeString.match(timeRegex);\n  if (!captures) return NaN; // Invalid ISO-formatted time\n\n  const hours = parseTimeUnit(captures[1]);\n  const minutes = parseTimeUnit(captures[2]);\n  const seconds = parseTimeUnit(captures[3]);\n\n  if (!validateTime(hours, minutes, seconds)) {\n    return NaN;\n  }\n\n  return (\n    hours * millisecondsInHour + minutes * millisecondsInMinute + seconds * 1000\n  );\n}\n\nfunction parseTimeUnit(value) {\n  return (value && parseFloat(value.replace(\",\", \".\"))) || 0;\n}\n\nfunction parseTimezone(timezoneString) {\n  if (timezoneString === \"Z\") return 0;\n\n  const captures = timezoneString.match(timezoneRegex);\n  if (!captures) return 0;\n\n  const sign = captures[1] === \"+\" ? -1 : 1;\n  const hours = parseInt(captures[2]);\n  const minutes = (captures[3] && parseInt(captures[3])) || 0;\n\n  if (!validateTimezone(hours, minutes)) {\n    return NaN;\n  }\n\n  return sign * (hours * millisecondsInHour + minutes * millisecondsInMinute);\n}\n\nfunction dayOfISOWeekYear(isoWeekYear, week, day) {\n  const date = new Date(0);\n  date.setUTCFullYear(isoWeekYear, 0, 4);\n  const fourthOfJanuaryDay = date.getUTCDay() || 7;\n  const diff = (week - 1) * 7 + day + 1 - fourthOfJanuaryDay;\n  date.setUTCDate(date.getUTCDate() + diff);\n  return date;\n}\n\n// Validation functions\n\n// February is null to handle the leap year (using ||)\nconst daysInMonths = [31, null, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];\n\nfunction isLeapYearIndex(year) {\n  return year % 400 === 0 || (year % 4 === 0 && year % 100 !== 0);\n}\n\nfunction validateDate(year, month, date) {\n  return (\n    month >= 0 &&\n    month <= 11 &&\n    date >= 1 &&\n    date <= (daysInMonths[month] || (isLeapYearIndex(year) ? 29 : 28))\n  );\n}\n\nfunction validateDayOfYearDate(year, dayOfYear) {\n  return dayOfYear >= 1 && dayOfYear <= (isLeapYearIndex(year) ? 366 : 365);\n}\n\nfunction validateWeekDate(_year, week, day) {\n  return week >= 1 && week <= 53 && day >= 0 && day <= 6;\n}\n\nfunction validateTime(hours, minutes, seconds) {\n  if (hours === 24) {\n    return minutes === 0 && seconds === 0;\n  }\n\n  return (\n    seconds >= 0 &&\n    seconds < 60 &&\n    minutes >= 0 &&\n    minutes < 60 &&\n    hours >= 0 &&\n    hours < 25\n  );\n}\n\nfunction validateTimezone(_hours, minutes) {\n  return minutes >= 0 && minutes <= 59;\n}\n\n// Fallback for modularized imports:\nexport default parseISO;\n","\"use client\";\n\nimport { Filter, X } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\n/**\n * ScheduleFiltersMobile - Mobile filter chips component\n *\n * Provides horizontal scrolling filter chips for:\n * - Status filtering (scheduled, dispatched, completed, etc.)\n * - Technician filtering\n * - Date range filtering\n *\n * Design:\n * - Horizontal scrolling chip container\n * - Active filters highlighted with primary color\n * - Clear all button when filters active\n * - Touch-friendly 36px height chips\n *\n * Usage:\n * - List view: Primary filtering UI\n * - Day/Week/Month views: Quick filter options\n */\n\nexport type FilterOption = {\n\tid: string;\n\tlabel: string;\n\tcount?: number; // Optional count badge (e.g., \"Dispatched (5)\")\n};\n\nexport type ActiveFilters = {\n\tstatuses: string[];\n\ttechnicians: string[];\n\tdateRange?: { start: Date; end: Date };\n};\n\ntype ScheduleFiltersMobileProps = {\n\tstatusOptions: FilterOption[];\n\ttechnicianOptions: FilterOption[];\n\tactiveFilters: ActiveFilters;\n\tonToggleStatus: (statusId: string) => void;\n\tonToggleTechnician: (techId: string) => void;\n\tonClearAll: () => void;\n\tonOpenFilters?: () => void; // Opens full filter modal\n\tclassName?: string;\n};\n\nexport function ScheduleFiltersMobile({\n\tstatusOptions,\n\ttechnicianOptions,\n\tactiveFilters,\n\tonToggleStatus,\n\tonToggleTechnician,\n\tonClearAll,\n\tonOpenFilters,\n\tclassName,\n}: ScheduleFiltersMobileProps) {\n\tconst hasActiveFilters =\n\t\tactiveFilters.statuses.length > 0 ||\n\t\tactiveFilters.technicians.length > 0 ||\n\t\tactiveFilters.dateRange;\n\n\tconst activeFilterCount =\n\t\tactiveFilters.statuses.length +\n\t\tactiveFilters.technicians.length +\n\t\t(activeFilters.dateRange ? 1 : 0);\n\n\treturn (\n\t\t<div\n\t\t\tclassName={cn(\"flex items-center gap-2 overflow-x-auto pb-2\", className)}\n\t\t>\n\t\t\t{/* Filter button (opens full filter modal) */}\n\t\t\t{onOpenFilters && (\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"h-9 shrink-0 gap-2\"\n\t\t\t\t\tonClick={onOpenFilters}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t>\n\t\t\t\t\t<Filter className=\"h-4 w-4\" />\n\t\t\t\t\t<span>Filters</span>\n\t\t\t\t\t{activeFilterCount > 0 && (\n\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\tclassName=\"ml-1 h-5 min-w-5 px-1.5 text-xs\"\n\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{activeFilterCount}\n\t\t\t\t\t\t</Badge>\n\t\t\t\t\t)}\n\t\t\t\t</Button>\n\t\t\t)}\n\n\t\t\t{/* Status filter chips */}\n\t\t\t{statusOptions.map((status) => {\n\t\t\t\tconst isActive = activeFilters.statuses.includes(status.id);\n\t\t\t\treturn (\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\"h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all\",\n\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t? \"bg-primary text-primary-foreground hover:bg-primary/90\"\n\t\t\t\t\t\t\t\t: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n\t\t\t\t\t\t)}\n\t\t\t\t\t\tkey={status.id}\n\t\t\t\t\t\tonClick={() => onToggleStatus(status.id)}\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<span>{status.label}</span>\n\t\t\t\t\t\t{status.count !== undefined && (\n\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"rounded-full px-1.5 py-0.5 text-xs font-semibold\",\n\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary-foreground/20 text-primary-foreground\"\n\t\t\t\t\t\t\t\t\t\t: \"bg-muted text-muted-foreground\",\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{status.count}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</Badge>\n\t\t\t\t);\n\t\t\t})}\n\n\t\t\t{/* Technician filter chips */}\n\t\t\t{technicianOptions.length > 0 && (\n\t\t\t\t<>\n\t\t\t\t\t{/* Separator */}\n\t\t\t\t\t<div className=\"h-6 w-px bg-border shrink-0\" />\n\n\t\t\t\t\t{technicianOptions.map((tech) => {\n\t\t\t\t\t\tconst isActive = activeFilters.technicians.includes(tech.id);\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<Badge\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all\",\n\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t? \"bg-primary text-primary-foreground hover:bg-primary/90\"\n\t\t\t\t\t\t\t\t\t\t: \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\tkey={tech.id}\n\t\t\t\t\t\t\t\tonClick={() => onToggleTechnician(tech.id)}\n\t\t\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<span>{tech.label}</span>\n\t\t\t\t\t\t\t\t{tech.count !== undefined && (\n\t\t\t\t\t\t\t\t\t<span\n\t\t\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\t\t\"rounded-full px-1.5 py-0.5 text-xs font-semibold\",\n\t\t\t\t\t\t\t\t\t\t\tisActive\n\t\t\t\t\t\t\t\t\t\t\t\t? \"bg-primary-foreground/20 text-primary-foreground\"\n\t\t\t\t\t\t\t\t\t\t\t\t: \"bg-muted text-muted-foreground\",\n\t\t\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t\t{tech.count}\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t</Badge>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</>\n\t\t\t)}\n\n\t\t\t{/* Clear all button (only show when filters active) */}\n\t\t\t{hasActiveFilters && (\n\t\t\t\t<Button\n\t\t\t\t\tclassName=\"h-9 shrink-0 gap-2\"\n\t\t\t\t\tonClick={onClearAll}\n\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t>\n\t\t\t\t\t<X className=\"h-4 w-4\" />\n\t\t\t\t\t<span>Clear</span>\n\t\t\t\t</Button>\n\t\t\t)}\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport {\n\taddDays,\n\tendOfMonth,\n\tendOfWeek,\n\tformat,\n\tisSameDay,\n\tisSameMonth,\n\tisToday,\n\tstartOfMonth,\n\tstartOfWeek,\n} from \"date-fns\";\nimport { ChevronLeft, ChevronRight } from \"lucide-react\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Button } from \"@/components/ui/button\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { useScheduleStore } from \"@/lib/stores/schedule-store\";\nimport { useScheduleViewStore } from \"@/lib/stores/schedule-view-store\";\nimport { cn } from \"@/lib/utils\";\nimport { DayDetailBottomSheet } from \"./day-detail-bottom-sheet\";\nimport { JobActionsBottomSheet } from \"./job-actions-bottom-sheet\";\n\n/**\n * MonthlyViewMobile - Mobile-optimized calendar month view\n *\n * Differences from desktop:\n * - Larger touch-friendly cells (100px+ height)\n * - Tap day â†’ bottom sheet with day details\n * - Tap job â†’ job actions bottom sheet\n * - NO drag & drop (use bottom sheet to reschedule)\n * - NO context menus or tooltips\n * - Simplified job indicators (dots + count)\n * - Week view toggle for very small screens\n */\n\nconst WEEKDAYS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\nconst WEEKDAYS_SHORT = [\"S\", \"M\", \"T\", \"W\", \"T\", \"F\", \"S\"];\n\n// Job status color mapping\nconst getStatusColor = (status?: string) => {\n\tswitch (status?.toLowerCase()) {\n\t\tcase \"scheduled\":\n\t\t\treturn \"bg-blue-500\";\n\t\tcase \"dispatched\":\n\t\t\treturn \"bg-sky-500\";\n\t\tcase \"arrived\":\n\t\t\treturn \"bg-emerald-400\";\n\t\tcase \"in_progress\":\n\t\t\treturn \"bg-amber-500\";\n\t\tcase \"closed\":\n\t\tcase \"completed\":\n\t\t\treturn \"bg-emerald-600\";\n\t\tcase \"cancelled\":\n\t\t\treturn \"bg-slate-400\";\n\t\tdefault:\n\t\t\treturn \"bg-slate-500\";\n\t}\n};\n\ntype DayCellProps = {\n\tdate: Date;\n\tjobs: Job[];\n\tisCurrentMonth: boolean;\n\tonDayTap: (date: Date, jobs: Job[]) => void;\n\tonJobTap: (job: Job) => void;\n};\n\nfunction DayCell({\n\tdate,\n\tjobs,\n\tisCurrentMonth,\n\tonDayTap,\n\tonJobTap,\n}: DayCellProps) {\n\tconst isCurrentDay = isToday(date);\n\tconst hasJobs = jobs.length > 0;\n\tconst isWeekend = date.getDay() === 0 || date.getDay() === 6;\n\n\t// Group jobs by status for colored dots\n\tconst statusCounts = useMemo(() => {\n\t\treturn jobs.reduce(\n\t\t\t(acc, job) => {\n\t\t\t\tconst status = job.status?.toLowerCase() || \"scheduled\";\n\t\t\t\tacc[status] = (acc[status] || 0) + 1;\n\t\t\t\treturn acc;\n\t\t\t},\n\t\t\t{} as Record<string, number>,\n\t\t);\n\t}, [jobs]);\n\n\t// Get top 3 statuses to show\n\tconst topStatuses = useMemo(() => {\n\t\treturn Object.entries(statusCounts)\n\t\t\t.sort(([, a], [, b]) => b - a)\n\t\t\t.slice(0, 3);\n\t}, [statusCounts]);\n\n\treturn (\n\t\t<button\n\t\t\tclassName={cn(\n\t\t\t\t\"flex h-24 sm:h-28 flex-col border-r border-b p-1.5 sm:p-2 text-left transition-all active:scale-95\",\n\t\t\t\t!isCurrentMonth && \"bg-muted/50 opacity-60\",\n\t\t\t\tisCurrentDay &&\n\t\t\t\t\t\"bg-blue-50 ring-2 ring-inset ring-blue-500/50 dark:bg-blue-950/30\",\n\t\t\t\tisWeekend && !isCurrentDay && \"bg-slate-100/80 dark:bg-slate-800/30\",\n\t\t\t)}\n\t\t\tonClick={() => onDayTap(date, jobs)}\n\t\t\ttype=\"button\"\n\t\t>\n\t\t\t{/* Date Number */}\n\t\t\t<div className=\"flex items-center justify-between gap-1 mb-1\">\n\t\t\t\t<span\n\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\"flex h-6 w-6 sm:h-7 sm:w-7 items-center justify-center rounded-full text-xs sm:text-sm font-bold\",\n\t\t\t\t\t\tisCurrentDay && \"bg-blue-500 text-white shadow-md\",\n\t\t\t\t\t\t!isCurrentDay && !isCurrentMonth && \"text-muted-foreground/60\",\n\t\t\t\t\t\t!isCurrentDay && isCurrentMonth && \"text-foreground\",\n\t\t\t\t\t)}\n\t\t\t\t>\n\t\t\t\t\t{format(date, \"d\")}\n\t\t\t\t</span>\n\n\t\t\t\t{/* Job count badge */}\n\t\t\t\t{hasJobs && (\n\t\t\t\t\t<Badge\n\t\t\t\t\t\tclassName=\"h-4 px-1.5 text-[9px] sm:text-[10px] font-semibold\"\n\t\t\t\t\t\tvariant=\"secondary\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{jobs.length}\n\t\t\t\t\t</Badge>\n\t\t\t\t)}\n\t\t\t</div>\n\n\t\t\t{/* Status indicators - Small colored dots */}\n\t\t\t{hasJobs && (\n\t\t\t\t<div className=\"flex flex-wrap gap-0.5\">\n\t\t\t\t\t{topStatuses.map(([status, count]) => (\n\t\t\t\t\t\t<div className=\"flex items-center gap-0.5\" key={status}>\n\t\t\t\t\t\t\t<div\n\t\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\t\"h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full\",\n\t\t\t\t\t\t\t\t\tgetStatusColor(status),\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{count > 1 && (\n\t\t\t\t\t\t\t\t<span className=\"text-[8px] sm:text-[9px] text-muted-foreground font-medium\">\n\t\t\t\t\t\t\t\t\t{count}\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t)}\n\n\t\t\t{/* First few jobs as mini pills (only on larger mobile screens) */}\n\t\t\t{hasJobs && (\n\t\t\t\t<div className=\"hidden xs:flex flex-col gap-0.5 mt-1 overflow-hidden\">\n\t\t\t\t\t{jobs.slice(0, 2).map((job) => (\n\t\t\t\t\t\t<button\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"flex items-center gap-1 rounded px-1 py-0.5 text-[8px] sm:text-[9px] font-medium transition-colors hover:opacity-80\",\n\t\t\t\t\t\t\t\tgetStatusColor(job.status),\n\t\t\t\t\t\t\t\t\"text-white truncate\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\tonClick={(e) => {\n\t\t\t\t\t\t\t\te.stopPropagation();\n\t\t\t\t\t\t\t\tonJobTap(job);\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\ttype=\"button\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"truncate\">\n\t\t\t\t\t\t\t\t{job.customer?.name || job.title}\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</button>\n\t\t\t\t\t))}\n\t\t\t\t\t{jobs.length > 2 && (\n\t\t\t\t\t\t<span className=\"text-[8px] text-muted-foreground ml-1\">\n\t\t\t\t\t\t\t+{jobs.length - 2} more\n\t\t\t\t\t\t</span>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t)}\n\t\t</button>\n\t);\n}\n\nexport function MonthlyViewMobile() {\n\t// Get Map from store (stable reference)\n\tconst jobsMap = useScheduleStore((state) => state.jobs);\n\tconst { currentDate, goToToday, navigatePrevious, navigateNext } =\n\t\tuseScheduleViewStore();\n\n\t// Convert Map to array once (memoized)\n\tconst jobs = useMemo(() => Array.from(jobsMap.values()), [jobsMap]);\n\n\t// Local state\n\tconst [selectedJob, setSelectedJob] = useState<Job | null>(null);\n\tconst [selectedDay, setSelectedDay] = useState<{\n\t\tdate: Date;\n\t\tjobs: Job[];\n\t} | null>(null);\n\tconst [showWeekView, setShowWeekView] = useState(false);\n\n\tconst dateObj = useMemo(\n\t\t() => (currentDate instanceof Date ? currentDate : new Date(currentDate)),\n\t\t[currentDate],\n\t);\n\n\t// Generate calendar grid\n\tconst calendarDays = useMemo(() => {\n\t\tconst monthStart = startOfMonth(dateObj);\n\t\tconst monthEnd = endOfMonth(dateObj);\n\t\tconst calendarStart = startOfWeek(monthStart);\n\t\tconst calendarEnd = endOfWeek(monthEnd);\n\n\t\tconst days: Date[] = [];\n\t\tlet currentDay = calendarStart;\n\n\t\twhile (currentDay <= calendarEnd) {\n\t\t\tdays.push(currentDay);\n\t\t\tcurrentDay = addDays(currentDay, 1);\n\t\t}\n\n\t\treturn days;\n\t}, [dateObj]);\n\n\t// Get jobs for the current week if in week view mode\n\tconst weekDays = useMemo(() => {\n\t\tif (!showWeekView) return calendarDays;\n\n\t\t// Find the week containing currentDate\n\t\tconst weekStart = startOfWeek(dateObj);\n\t\tconst days: Date[] = [];\n\t\tfor (let i = 0; i < 7; i++) {\n\t\t\tdays.push(addDays(weekStart, i));\n\t\t}\n\t\treturn days;\n\t}, [showWeekView, dateObj, calendarDays]);\n\n\t// Group jobs by date\n\tconst jobsByDate = useMemo(() => {\n\t\tconst grouped = new Map<string, Job[]>();\n\n\t\tjobs.forEach((job) => {\n\t\t\tif (!job.scheduled_start) return;\n\n\t\t\tconst startTime = new Date(job.scheduled_start);\n\t\t\tconst dateKey = format(startTime, \"yyyy-MM-dd\");\n\n\t\t\tif (!grouped.has(dateKey)) {\n\t\t\t\tgrouped.set(dateKey, []);\n\t\t\t}\n\t\t\tgrouped.get(dateKey)?.push(job);\n\t\t});\n\n\t\t// Sort jobs within each day by start time\n\t\tgrouped.forEach((jobList) => {\n\t\t\tjobList.sort((a, b) => {\n\t\t\t\tif (!a.scheduled_start) return 1;\n\t\t\t\tif (!b.scheduled_start) return -1;\n\t\t\t\treturn (\n\t\t\t\t\tnew Date(a.scheduled_start).getTime() -\n\t\t\t\t\tnew Date(b.scheduled_start).getTime()\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\n\t\treturn grouped;\n\t}, [jobs]);\n\n\t// Handlers\n\tconst handleDayTap = useCallback((date: Date, dayJobs: Job[]) => {\n\t\tsetSelectedDay({ date, jobs: dayJobs });\n\t}, []);\n\n\tconst handleJobTap = useCallback((job: Job) => {\n\t\tsetSelectedJob(job);\n\t}, []);\n\n\tconst handleJobAction = useCallback(\n\t\tasync (action: string, job: Job, ...args: unknown[]) => {\n\t\t\tconsole.log(\"Job action:\", action, job, args);\n\t\t\tsetSelectedJob(null);\n\n\t\t\ttry {\n\t\t\t\tswitch (action) {\n\t\t\t\t\tcase \"view_details\":\n\t\t\t\t\t\twindow.location.href = `/dashboard/work/jobs/${job.id}`;\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase \"dispatch\":\n\t\t\t\t\tcase \"arrive\":\n\t\t\t\t\tcase \"start\":\n\t\t\t\t\tcase \"complete\":\n\t\t\t\t\tcase \"move_to_status\": {\n\t\t\t\t\t\tconst { updateJobStatus } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst newStatus =\n\t\t\t\t\t\t\taction === \"move_to_status\" ? (args[0] as string) : action;\n\t\t\t\t\t\tconst statusMap: Record<string, string> = {\n\t\t\t\t\t\t\tdispatch: \"dispatched\",\n\t\t\t\t\t\t\tarrive: \"arrived\",\n\t\t\t\t\t\t\tstart: \"in_progress\",\n\t\t\t\t\t\t\tcomplete: \"completed\",\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst mappedStatus = statusMap[action] || newStatus;\n\t\t\t\t\t\tconst result = await updateJobStatus(job.id, mappedStatus);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\n\t\t\t\t\t\t\t\t`Job ${action === \"move_to_status\" ? \"moved to \" + newStatus : action + \"ed\"}`,\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to update job status\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reschedule\": {\n\t\t\t\t\t\tconst [newStart, newEnd] = args as [Date, Date];\n\t\t\t\t\t\tconst { updateJob } = await import(\"@/actions/jobs\");\n\t\t\t\t\t\tconst result = await updateJob({\n\t\t\t\t\t\t\tjobId: job.id,\n\t\t\t\t\t\t\tscheduled_start: newStart.toISOString(),\n\t\t\t\t\t\t\tscheduled_end: newEnd.toISOString(),\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job rescheduled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reschedule job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"reassign\": {\n\t\t\t\t\t\tconst technicianId = args[0] as string | null;\n\t\t\t\t\t\tif (technicianId) {\n\t\t\t\t\t\t\tconst { assignJobToTechnician } = await import(\n\t\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tconst result = await assignJobToTechnician(job.id, technicianId);\n\t\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\t\ttoast.success(\"Job reassigned\");\n\t\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to reassign job\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.info(\"Unassigning technician coming soon\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tcase \"cancel\": {\n\t\t\t\t\t\tconst { cancelJobAndAppointment } = await import(\n\t\t\t\t\t\t\t\"@/actions/schedule-assignments\"\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst result = await cancelJobAndAppointment(job.id);\n\t\t\t\t\t\tif (result.success) {\n\t\t\t\t\t\t\ttoast.success(\"Job cancelled\");\n\t\t\t\t\t\t\twindow.location.reload();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttoast.error(result.error || \"Failed to cancel job\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.warn(\"Unknown action:\", action);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tconsole.error(\"Job action error:\", error);\n\t\t\t\ttoast.error(\"An error occurred\");\n\t\t\t}\n\t\t},\n\t\t[],\n\t);\n\n\tconst handleDayAction = useCallback((action: string, date: Date) => {\n\t\tconsole.log(\"Day action:\", action, date);\n\t\tsetSelectedDay(null);\n\n\t\tswitch (action) {\n\t\t\tcase \"view_day\":\n\t\t\t\t// Navigate to day view with this date selected\n\t\t\t\twindow.location.href = `/dashboard/schedule?view=day&date=${format(date, \"yyyy-MM-dd\")}`;\n\t\t\t\tbreak;\n\t\t\tcase \"create_appointment\":\n\t\t\t\t// Navigate to new appointment page with date pre-filled\n\t\t\t\twindow.location.href = `/dashboard/work/appointments/new?date=${format(date, \"yyyy-MM-dd\")}`;\n\t\t\t\tbreak;\n\t\t\tcase \"create_job\":\n\t\t\t\t// Navigate to new job page with date pre-filled\n\t\t\t\twindow.location.href = `/dashboard/work/jobs/new?date=${format(date, \"yyyy-MM-dd\")}`;\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tconsole.warn(\"Unknown day action:\", action);\n\t\t}\n\t}, []);\n\n\tconst isToday = isSameDay(dateObj, new Date());\n\n\treturn (\n\t\t<div className=\"flex h-full flex-col overflow-hidden\">\n\t\t\t{/* Header: Month navigation */}\n\t\t\t<div className=\"shrink-0 border-b bg-background\">\n\t\t\t\t<div className=\"flex items-center justify-between p-3 sm:p-4\">\n\t\t\t\t\t{/* Previous month */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigatePrevious}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronLeft className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Previous month</span>\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{/* Current month/year */}\n\t\t\t\t\t<div className=\"flex flex-col items-center\">\n\t\t\t\t\t\t<h2 className=\"text-base sm:text-lg font-semibold\">\n\t\t\t\t\t\t\t{format(dateObj, showWeekView ? \"MMM d - \" : \"MMMM yyyy\")}\n\t\t\t\t\t\t\t{showWeekView &&\n\t\t\t\t\t\t\t\tformat(addDays(startOfWeek(dateObj), 6), \"MMM d, yyyy\")}\n\t\t\t\t\t\t</h2>\n\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground\">\n\t\t\t\t\t\t\t{jobsByDate.size} days with jobs\n\t\t\t\t\t\t</p>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Next month */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9\"\n\t\t\t\t\t\tonClick={navigateNext}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<ChevronRight className=\"h-4 w-4\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Next month</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* View toggle + Today button */}\n\t\t\t\t<div className=\"flex gap-2 px-3 sm:px-4 pb-3\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"flex-1 h-8 text-xs\"\n\t\t\t\t\t\tonClick={() => setShowWeekView(!showWeekView)}\n\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t>\n\t\t\t\t\t\t{showWeekView ? \"Show Month\" : \"Show Week\"}\n\t\t\t\t\t</Button>\n\n\t\t\t\t\t{!isToday && (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\tclassName=\"flex-1 h-8 text-xs\"\n\t\t\t\t\t\t\tonClick={goToToday}\n\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\tToday\n\t\t\t\t\t\t</Button>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Calendar Grid */}\n\t\t\t<div className=\"flex-1 overflow-auto\">\n\t\t\t\t<div className=\"grid grid-cols-7 h-full\">\n\t\t\t\t\t{/* Weekday Headers */}\n\t\t\t\t\t{WEEKDAYS.map((day, idx) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName={cn(\n\t\t\t\t\t\t\t\t\"sticky top-0 z-10 bg-muted/80 backdrop-blur-sm border-r border-b px-1 py-2 text-center text-[10px] sm:text-xs font-bold uppercase\",\n\t\t\t\t\t\t\t\t(idx === 0 || idx === 6) &&\n\t\t\t\t\t\t\t\t\t\"bg-slate-200/80 dark:bg-slate-700/50\",\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tkey={day}\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<span className=\"hidden xs:inline\">{day}</span>\n\t\t\t\t\t\t\t<span className=\"xs:hidden\">{WEEKDAYS_SHORT[idx]}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t))}\n\n\t\t\t\t\t{/* Day Cells */}\n\t\t\t\t\t{weekDays.map((date) => {\n\t\t\t\t\t\tconst dateKey = format(date, \"yyyy-MM-dd\");\n\t\t\t\t\t\tconst dayJobs = jobsByDate.get(dateKey) || [];\n\t\t\t\t\t\tconst isCurrentMonth = isSameMonth(date, dateObj);\n\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t<DayCell\n\t\t\t\t\t\t\t\tdate={date}\n\t\t\t\t\t\t\t\tisCurrentMonth={isCurrentMonth}\n\t\t\t\t\t\t\t\tjobs={dayJobs}\n\t\t\t\t\t\t\t\tkey={date.toISOString()}\n\t\t\t\t\t\t\t\tonDayTap={handleDayTap}\n\t\t\t\t\t\t\t\tonJobTap={handleJobTap}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t);\n\t\t\t\t\t})}\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Job Actions Bottom Sheet */}\n\t\t\t<JobActionsBottomSheet\n\t\t\t\tisOpen={selectedJob !== null}\n\t\t\t\tjob={selectedJob}\n\t\t\t\tonAction={handleJobAction}\n\t\t\t\tonClose={() => setSelectedJob(null)}\n\t\t\t/>\n\n\t\t\t{/* Day Detail Bottom Sheet */}\n\t\t\t<DayDetailBottomSheet\n\t\t\t\tdate={selectedDay?.date || null}\n\t\t\t\tisOpen={selectedDay !== null}\n\t\t\t\tjobs={selectedDay?.jobs || []}\n\t\t\t\tonAction={handleDayAction}\n\t\t\t\tonClose={() => setSelectedDay(null)}\n\t\t\t\tonJobTap={handleJobTap}\n\t\t\t/>\n\t\t</div>\n\t);\n}\n","\"use client\";\n\nimport { format, isToday, isTomorrow } from \"date-fns\";\nimport { Calendar, Plus, X } from \"lucide-react\";\nimport { Button } from \"@/components/ui/button\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport type { Job } from \"@/lib/stores/schedule-store\";\nimport { cn } from \"@/lib/utils\";\nimport { JobCardMobile } from \"./job-card-mobile\";\n\n/**\n * DayDetailBottomSheet - Shows all jobs for a specific day\n *\n * Triggered by tapping a day cell in the month view.\n * Displays:\n * - Day header with date\n * - All jobs for that day\n * - Actions: Create appointment, View day schedule\n */\n\ntype DayDetailBottomSheetProps = {\n\tdate: Date | null;\n\tjobs: Job[];\n\tisOpen: boolean;\n\tonClose: () => void;\n\tonJobTap: (job: Job) => void;\n\tonAction: (action: string, date: Date) => void;\n};\n\nexport function DayDetailBottomSheet({\n\tdate,\n\tjobs,\n\tisOpen,\n\tonClose,\n\tonJobTap,\n\tonAction,\n}: DayDetailBottomSheetProps) {\n\tif (!date) return null;\n\n\t// Format date display\n\tconst dateDisplay = (() => {\n\t\tif (isToday(date)) return \"Today\";\n\t\tif (isTomorrow(date)) return \"Tomorrow\";\n\t\treturn format(date, \"EEEE, MMMM d\");\n\t})();\n\n\tconst totalHours = jobs.reduce((sum, job) => {\n\t\tif (!job.scheduled_start || !job.scheduled_end) return sum;\n\t\tconst start = new Date(job.scheduled_start);\n\t\tconst end = new Date(job.scheduled_end);\n\t\treturn sum + (end.getTime() - start.getTime()) / (1000 * 60 * 60);\n\t}, 0);\n\n\treturn (\n\t\t<>\n\t\t\t{/* Backdrop */}\n\t\t\t{isOpen && (\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"fixed inset-0 z-50 bg-black/50 animate-in fade-in\"\n\t\t\t\t\tonClick={onClose}\n\t\t\t\t/>\n\t\t\t)}\n\n\t\t\t{/* Bottom Sheet */}\n\t\t\t<div\n\t\t\t\tclassName={cn(\n\t\t\t\t\t\"fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl\",\n\t\t\t\t\t\"transform transition-transform duration-300 ease-out\",\n\t\t\t\t\tisOpen ? \"translate-y-0\" : \"translate-y-full\",\n\t\t\t\t)}\n\t\t\t\tstyle={{ maxHeight: \"85vh\" }}\n\t\t\t>\n\t\t\t\t{/* Drag Handle */}\n\t\t\t\t<div className=\"flex justify-center pt-3 pb-2\">\n\t\t\t\t\t<div className=\"w-12 h-1 bg-muted-foreground/30 rounded-full\" />\n\t\t\t\t</div>\n\n\t\t\t\t{/* Header */}\n\t\t\t\t<div className=\"flex items-start justify-between gap-3 px-4 pb-4 border-b\">\n\t\t\t\t\t<div className=\"flex-1\">\n\t\t\t\t\t\t<div className=\"flex items-center gap-2 mb-1\">\n\t\t\t\t\t\t\t<Calendar className=\"h-5 w-5 text-primary\" />\n\t\t\t\t\t\t\t<h2 className=\"text-lg font-semibold\">{dateDisplay}</h2>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<p className=\"text-sm text-muted-foreground\">\n\t\t\t\t\t\t\t{format(date, \"MMMM d, yyyy\")}\n\t\t\t\t\t\t</p>\n\t\t\t\t\t\t{jobs.length > 0 && (\n\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mt-1\">\n\t\t\t\t\t\t\t\t{jobs.length} {jobs.length === 1 ? \"job\" : \"jobs\"} Â·{\" \"}\n\t\t\t\t\t\t\t\t{totalHours.toFixed(1)}h total\n\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Close button */}\n\t\t\t\t\t<Button\n\t\t\t\t\t\tclassName=\"h-9 w-9 shrink-0\"\n\t\t\t\t\t\tonClick={onClose}\n\t\t\t\t\t\tsize=\"icon\"\n\t\t\t\t\t\tvariant=\"ghost\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<X className=\"h-5 w-5\" />\n\t\t\t\t\t\t<span className=\"sr-only\">Close</span>\n\t\t\t\t\t</Button>\n\t\t\t\t</div>\n\n\t\t\t\t{/* Content */}\n\t\t\t\t<ScrollArea\n\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\tstyle={{ maxHeight: \"calc(85vh - 200px)\" }}\n\t\t\t\t>\n\t\t\t\t\t<div className=\"p-4\">\n\t\t\t\t\t\t{jobs.length === 0 ? (\n\t\t\t\t\t\t\t<div className=\"flex flex-col items-center justify-center py-12 text-center\">\n\t\t\t\t\t\t\t\t<Calendar className=\"h-12 w-12 text-muted-foreground/50 mb-3\" />\n\t\t\t\t\t\t\t\t<p className=\"text-sm font-medium mb-1\">No jobs scheduled</p>\n\t\t\t\t\t\t\t\t<p className=\"text-xs text-muted-foreground mb-4\">\n\t\t\t\t\t\t\t\t\tSchedule an appointment for this day\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\t\tonAction(\"create_appointment\", date);\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\tsize=\"sm\"\n\t\t\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\t\tNew Appointment\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t) : (\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t{jobs.map((job) => (\n\t\t\t\t\t\t\t\t\t<JobCardMobile\n\t\t\t\t\t\t\t\t\t\tjob={job}\n\t\t\t\t\t\t\t\t\t\tkey={job.id}\n\t\t\t\t\t\t\t\t\t\tonClick={() => onJobTap(job)}\n\t\t\t\t\t\t\t\t\t\tshowDate={false}\n\t\t\t\t\t\t\t\t\t\tshowTechnician={true}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t)}\n\t\t\t\t\t</div>\n\t\t\t\t</ScrollArea>\n\n\t\t\t\t{/* Actions */}\n\t\t\t\t{jobs.length > 0 && (\n\t\t\t\t\t<div className=\"border-t bg-muted/30 p-4 safe-bottom\">\n\t\t\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tonAction(\"create_appointment\", date);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t\t\tvariant=\"outline\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Plus className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\tNew Appointment\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\tclassName=\"flex-1\"\n\t\t\t\t\t\t\t\tonClick={() => {\n\t\t\t\t\t\t\t\t\tonAction(\"view_day\", date);\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tsize=\"default\"\n\t\t\t\t\t\t\t\tvariant=\"default\"\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Calendar className=\"h-4 w-4 mr-2\" />\n\t\t\t\t\t\t\t\tView Day Schedule\n\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t)}\n\t\t\t</div>\n\t\t</>\n\t);\n}\n","/**\n * MonthlyView - Lazy Loaded Wrapper\n *\n * Performance optimization:\n * - Dynamically imports the full 882-line monthly calendar view (~20KB)\n * - Only loads when user switches to \"Month\" view mode\n * - Shows skeleton loading state while importing\n * - Reduces initial schedule page bundle\n */\n\n\"use client\";\n\nimport dynamic from \"next/dynamic\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\n\nconst MonthlyView = dynamic(\n\t() => import(\"./monthly-view\").then((mod) => ({ default: mod.MonthlyView })),\n\t{\n\t\tloading: () => (\n\t\t\t<div className=\"flex h-full w-full flex-col gap-4 p-4\">\n\t\t\t\t<div className=\"grid grid-cols-7 gap-2\">\n\t\t\t\t\t{Array.from({ length: 35 }).map((_, i) => (\n\t\t\t\t\t\t<Skeleton key={i} className=\"aspect-square w-full\" />\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t),\n\t\tssr: false, // Calendar view requires browser environment\n\t},\n);\n\nexport function MonthlyViewLazy() {\n\treturn <MonthlyView />;\n}\n"],"names":[],"mappings":"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","ignoreList":[8,9,19,20]}