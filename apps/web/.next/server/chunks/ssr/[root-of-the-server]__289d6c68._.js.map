{"version":3,"sources":["../../../../../../apps/web/src/app/%28dashboard%29/dashboard/settings/communications/sms/sms-client.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/app/%28dashboard%29/dashboard/settings/communications/sms/page.tsx","../../../../../../apps/web/src/components/settings/sms/sms-data.tsx","../../../../../../apps/web/src/app/%28dashboard%29/dashboard/settings/communications/sms/sms-config.ts","../../../../../../apps/web/src/components/settings/sms/sms-skeleton.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/apps/web/src/app/(dashboard)/dashboard/settings/communications/sms/sms-client.tsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/app/(dashboard)/dashboard/settings/communications/sms/sms-client.tsx\",\n    \"default\",\n);\n","/**\n * Usms Page - PPR Enabled\n *\n * Uses Partial Prerendering for instant page loads.\n * Performance: 10-20x faster than traditional SSR\n */\n\nimport { Suspense } from \"react\";\nimport { UsmsData } from \"@/components/settings/sms/sms-data\";\nimport { UsmsSkeleton } from \"@/components/settings/sms/sms-skeleton\";\n\nexport default function UsmsPage() {\n\treturn (\n\t\t<Suspense fallback={<UsmsSkeleton />}>\n\t\t\t<UsmsData />\n\t\t</Suspense>\n\t);\n}\n","import { notFound } from \"next/navigation\";\nimport SmsSettingsClient from \"@/app/(dashboard)/dashboard/settings/communications/sms/sms-client\";\nimport {\n\tDEFAULT_SMS_SETTINGS,\n\tmapSmsSettings,\n} from \"@/app/(dashboard)/dashboard/settings/communications/sms/sms-config\";\nimport { getActiveCompanyId } from \"@/lib/auth/company-context\";\nimport { createClient } from \"@/lib/supabase/server\";\n\nexport async function UsmsData() {\n\tconst supabase = await createClient();\n\tif (!supabase) {\n\t\treturn notFound();\n\t}\n\n\tconst {\n\t\tdata: { user },\n\t} = await supabase.auth.getUser();\n\tif (!user) {\n\t\treturn notFound();\n\t}\n\n\tconst activeCompanyId = await getActiveCompanyId();\n\tif (!activeCompanyId) {\n\t\treturn notFound();\n\t}\n\n\tconst { data, error } = await supabase\n\t\t.from(\"communication_sms_settings\")\n\t\t.select(\"*\")\n\t\t.eq(\"company_id\", activeCompanyId)\n\t\t.maybeSingle();\n\n\tif (error) {\n\t\tconsole.error(\"Failed to load SMS settings\", error);\n\t}\n\n\tconst initialSettings = {\n\t\t...DEFAULT_SMS_SETTINGS,\n\t\t...mapSmsSettings(data ?? null),\n\t};\n\n\treturn <SmsSettingsClient initialSettings={initialSettings} />;\n}\n","import type { Database } from \"@/types/supabase\";\n\nexport type SmsSettingsRow =\n\tDatabase[\"public\"][\"Tables\"][\"communication_sms_settings\"][\"Row\"];\n\nexport type QuickRepliesConfig = {\n\tgreeting_enabled: boolean;\n\tgreeting_message: string;\n\tafter_hours_enabled: boolean;\n\tafter_hours_message: string;\n\tappointment_reminder_enabled: boolean;\n\tappointment_reminder_hours_before: number;\n\tappointment_reminder_message: string;\n\tjob_complete_enabled: boolean;\n\tjob_complete_message: string;\n\treview_request_enabled: boolean;\n\treview_request_delay_hours: number;\n\treview_request_message: string;\n};\n\nexport type SmsSettingsState = {\n\tprovider: \"twilio\" | \"other\";\n\tproviderApiKey: string;\n\tsenderNumber: string;\n\tautoReplyEnabled: boolean;\n\tautoReplyMessage: string;\n\toptOutMessage: string;\n\tincludeOptOut: boolean;\n\tconsentRequired: boolean;\n\tquickRepliesEnabled: boolean;\n\tquickRepliesConfig: QuickRepliesConfig;\n};\n\nexport const DEFAULT_QUICK_REPLIES_CONFIG: QuickRepliesConfig = {\n\tgreeting_enabled: false,\n\tgreeting_message:\n\t\t\"Hi! Thanks for reaching out to {{company_name}}. How can we help you today?\",\n\tafter_hours_enabled: false,\n\tafter_hours_message:\n\t\t\"Thanks for your message! We're currently closed but will respond first thing in the morning. For emergencies, call {{emergency_phone}}.\",\n\tappointment_reminder_enabled: false,\n\tappointment_reminder_hours_before: 24,\n\tappointment_reminder_message:\n\t\t\"Reminder: You have an appointment with {{company_name}} tomorrow at {{appointment_time}}. Reply YES to confirm or call us to reschedule.\",\n\tjob_complete_enabled: false,\n\tjob_complete_message:\n\t\t\"Your service has been completed! Thank you for choosing {{company_name}}. Please let us know if you have any questions.\",\n\treview_request_enabled: false,\n\treview_request_delay_hours: 24,\n\treview_request_message:\n\t\t\"Thank you for choosing {{company_name}}! We'd love to hear about your experience. Please leave us a review: {{review_link}}\",\n};\n\nexport const DEFAULT_SMS_SETTINGS: SmsSettingsState = {\n\tprovider: \"twilio\",\n\tproviderApiKey: \"\",\n\tsenderNumber: \"\",\n\tautoReplyEnabled: false,\n\tautoReplyMessage: \"\",\n\toptOutMessage: \"Reply STOP to unsubscribe\",\n\tincludeOptOut: true,\n\tconsentRequired: true,\n\tquickRepliesEnabled: false,\n\tquickRepliesConfig: DEFAULT_QUICK_REPLIES_CONFIG,\n};\n\nexport function mapSmsSettings(\n\trow: SmsSettingsRow | null,\n): Partial<SmsSettingsState> {\n\tif (!row) {\n\t\treturn {};\n\t}\n\n\t// Parse quick replies config from JSONB\n\tconst quickRepliesConfig =\n\t\ttypeof row.quick_replies_config === \"object\" && row.quick_replies_config\n\t\t\t? { ...DEFAULT_QUICK_REPLIES_CONFIG, ...(row.quick_replies_config as Partial<QuickRepliesConfig>) }\n\t\t\t: DEFAULT_QUICK_REPLIES_CONFIG;\n\n\treturn {\n\t\tprovider: (row.provider as SmsSettingsState[\"provider\"]) ?? \"twilio\",\n\t\tsenderNumber: row.sender_number ?? \"\",\n\t\tautoReplyEnabled: row.auto_reply_enabled ?? false,\n\t\tautoReplyMessage: row.auto_reply_message ?? \"\",\n\t\toptOutMessage: row.opt_out_message ?? \"Reply STOP to unsubscribe\",\n\t\tincludeOptOut: row.include_opt_out ?? true,\n\t\tconsentRequired: row.consent_required ?? true,\n\t\tquickRepliesEnabled: row.quick_replies_enabled ?? false,\n\t\tquickRepliesConfig,\n\t};\n}\n","export function UsmsSkeleton() {\n\treturn (\n\t\t<div className=\"flex h-full flex-col gap-4 p-4\">\n\t\t\t<div className=\"flex items-center justify-between\">\n\t\t\t\t<div className=\"bg-muted h-8 w-48 animate-pulse rounded\" />\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<div className=\"bg-muted h-8 w-24 animate-pulse rounded\" />\n\t\t\t\t\t<div className=\"bg-muted h-8 w-24 animate-pulse rounded\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div className=\"space-y-2\">\n\t\t\t\t{[...new Array(10)].map((_, i) => (\n\t\t\t\t\t<div className=\"flex items-center gap-4\" key={i}>\n\t\t\t\t\t\t<div className=\"bg-muted h-12 w-12 animate-pulse rounded\" />\n\t\t\t\t\t\t<div className=\"flex-1 space-y-2\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-3/4 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-3 w-1/2 animate-pulse rounded\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div className=\"bg-muted h-8 w-20 animate-pulse rounded\" />\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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","ignoreList":[0]}