{"version":3,"sources":["../../../../../../apps/web/src/components/layout/toolbar-stats-provider.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/lib/formatters.ts","../../../../../../apps/web/src/lib/queries/contracts.ts","../../../../../../apps/web/src/components/work/contracts/contract-page-content.tsx/__nextjs-internal-proxy.mjs","../../../../../../apps/web/src/app/%28dashboard%29/dashboard/work/contracts/%5Bid%5D/page.tsx","../../../../../../apps/web/src/components/work/contracts/contract-detail-data.tsx","../../../../../../apps/web/src/components/work/contracts/contract-detail-shell.tsx","../../../../../../apps/web/src/components/work/contracts/contract-detail-skeleton.tsx"],"sourcesContent":["// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ToolbarStatsProvider = registerClientReference(\n    function() { throw new Error(\"Attempted to call ToolbarStatsProvider() from the server but ToolbarStatsProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/components/layout/toolbar-stats-provider.tsx\",\n    \"ToolbarStatsProvider\",\n);\n","/**\n * Centralized Formatting Utilities\n *\n * Professional formatting functions following DRY principles.\n * Handles currency, dates, percentages, and other common formatting needs.\n *\n * Features:\n * - Type-safe with proper null/undefined handling\n * - Consistent formatting across the application\n * - Flexible options for different use cases\n * - Locale-aware formatting\n */\n\nexport type CurrencyFormatOptions = {\n\t/** Minimum fraction digits (default: 0) */\n\tminimumFractionDigits?: number;\n\t/** Maximum fraction digits (default: 2) */\n\tmaximumFractionDigits?: number;\n\t/** Show zero as \"$0.00\" or \"$0\" (default: true) */\n\tshowZero?: boolean;\n\t/** Decimal places (alias for maximumFractionDigits, for convenience) */\n\tdecimals?: number;\n};\n\nexport type DateFormatPreset =\n\t| \"short\" // \"Jan 15, 2024\"\n\t| \"medium\" // \"Jan 15, 2024\"\n\t| \"long\" // \"January 15, 2024\"\n\t| \"full\" // \"Monday, January 15, 2024\"\n\t| \"table\" // \"Jan 15, 2024\" (optimized for tables)\n\t| \"time\" // \"2:30 PM\"\n\t| \"datetime\"; // \"Jan 15, 2024, 2:30 PM\"\n\nexport type DateFormatOptions = {\n\t/** Preset format style */\n\tpreset?: DateFormatPreset;\n\t/** Custom format options (overrides preset) */\n\tcustom?: Intl.DateTimeFormatOptions;\n};\n\n/**\n * Format currency from cents to USD string\n *\n * @param cents - Amount in cents (can be null/undefined)\n * @param options - Formatting options\n * @returns Formatted currency string (e.g., \"$1,234.56\")\n *\n * @example\n * formatCurrency(123456) // \"$1,234.56\"\n * formatCurrency(null) // \"$0.00\"\n * formatCurrency(123456, { minimumFractionDigits: 0 }) // \"$1,235\"\n */\nexport function formatCurrency(\n\tcents: number | null | undefined,\n\toptions: CurrencyFormatOptions = {},\n): string {\n\tconst {\n\t\tminimumFractionDigits = 0,\n\t\tmaximumFractionDigits = options.decimals ?? 2,\n\t\tshowZero = true,\n\t\tdecimals,\n\t} = options;\n\n\t// Use decimals if provided, otherwise use maximumFractionDigits\n\tconst finalMaxFractionDigits =\n\t\tdecimals !== undefined ? decimals : maximumFractionDigits;\n\tconst finalMinFractionDigits =\n\t\tdecimals !== undefined ? decimals : minimumFractionDigits;\n\n\tif (cents === null || cents === undefined) {\n\t\treturn showZero\n\t\t\t? new Intl.NumberFormat(\"en-US\", {\n\t\t\t\t\tstyle: \"currency\",\n\t\t\t\t\tcurrency: \"USD\",\n\t\t\t\t\tminimumFractionDigits: 0,\n\t\t\t\t\tmaximumFractionDigits: 0,\n\t\t\t\t}).format(0)\n\t\t\t: \"$0.00\";\n\t}\n\n\treturn new Intl.NumberFormat(\"en-US\", {\n\t\tstyle: \"currency\",\n\t\tcurrency: \"USD\",\n\t\tminimumFractionDigits: finalMinFractionDigits,\n\t\tmaximumFractionDigits: finalMaxFractionDigits,\n\t}).format(cents / 100);\n}\n\n/**\n * Format currency from dollars (not cents)\n *\n * @param amount - Amount in dollars (can be null/undefined)\n * @param options - Formatting options\n * @returns Formatted currency string\n *\n * @example\n * formatCurrencyFromDollars(1234.56) // \"$1,234.56\"\n * formatCurrencyFromDollars(null) // \"$0.00\"\n */\nexport function formatCurrencyFromDollars(\n\tamount: number | null | undefined,\n\toptions: CurrencyFormatOptions = {},\n): string {\n\tconst {\n\t\tminimumFractionDigits = 0,\n\t\tmaximumFractionDigits = options.decimals ?? 2,\n\t\tshowZero = true,\n\t\tdecimals,\n\t} = options;\n\n\t// Use decimals if provided, otherwise use maximumFractionDigits\n\tconst finalMaxFractionDigits =\n\t\tdecimals !== undefined ? decimals : maximumFractionDigits;\n\tconst finalMinFractionDigits =\n\t\tdecimals !== undefined ? decimals : minimumFractionDigits;\n\n\tif (amount === null || amount === undefined || Number.isNaN(amount)) {\n\t\treturn showZero\n\t\t\t? new Intl.NumberFormat(\"en-US\", {\n\t\t\t\t\tstyle: \"currency\",\n\t\t\t\t\tcurrency: \"USD\",\n\t\t\t\t\tminimumFractionDigits: 0,\n\t\t\t\t\tmaximumFractionDigits: 0,\n\t\t\t\t}).format(0)\n\t\t\t: \"$0.00\";\n\t}\n\n\treturn new Intl.NumberFormat(\"en-US\", {\n\t\tstyle: \"currency\",\n\t\tcurrency: \"USD\",\n\t\tminimumFractionDigits: finalMinFractionDigits,\n\t\tmaximumFractionDigits: finalMaxFractionDigits,\n\t}).format(amount);\n}\n\n/**\n * Format date with flexible presets or custom options\n *\n * @param date - Date value (Date, number, string, or null)\n * @param options - Formatting options\n * @returns Formatted date string or \"—\" if null\n *\n * @example\n * formatDate(new Date()) // \"Jan 15, 2024\"\n * formatDate(new Date(), { preset: \"long\" }) // \"January 15, 2024\"\n * formatDate(null) // \"—\"\n */\nexport function formatDate(\n\tdate: Date | number | string | null | undefined,\n\toptions: DateFormatOptions | DateFormatPreset | string = {},\n): string {\n\tif (!date) {\n\t\treturn \"—\";\n\t}\n\n\tconst dateObj =\n\t\ttypeof date === \"number\" || typeof date === \"string\"\n\t\t\t? new Date(date)\n\t\t\t: date;\n\n\tif (Number.isNaN(dateObj.getTime())) {\n\t\treturn \"—\";\n\t}\n\n\t// Handle backward compatibility: string format parameter\n\tlet preset: DateFormatPreset = \"table\";\n\tlet custom: Intl.DateTimeFormatOptions | undefined;\n\n\tif (typeof options === \"string\") {\n\t\t// Legacy format: formatDate(date, \"short\")\n\t\tpreset = (options as DateFormatPreset) || \"table\";\n\t} else {\n\t\tpreset = options.preset || \"table\";\n\t\tcustom = options.custom;\n\t}\n\n\t// Preset configurations\n\tconst presetConfigs: Record<DateFormatPreset, Intl.DateTimeFormatOptions> = {\n\t\tshort: {\n\t\t\tmonth: \"short\",\n\t\t\tday: \"numeric\",\n\t\t\tyear: \"numeric\",\n\t\t},\n\t\tmedium: {\n\t\t\tmonth: \"short\",\n\t\t\tday: \"numeric\",\n\t\t\tyear: \"numeric\",\n\t\t},\n\t\tlong: {\n\t\t\tmonth: \"long\",\n\t\t\tday: \"numeric\",\n\t\t\tyear: \"numeric\",\n\t\t},\n\t\tfull: {\n\t\t\tweekday: \"long\",\n\t\t\tmonth: \"long\",\n\t\t\tday: \"numeric\",\n\t\t\tyear: \"numeric\",\n\t\t},\n\t\ttable: {\n\t\t\tmonth: \"short\",\n\t\t\tday: \"numeric\",\n\t\t\tyear: \"numeric\",\n\t\t},\n\t\ttime: {\n\t\t\thour: \"numeric\",\n\t\t\tminute: \"2-digit\",\n\t\t\thour12: true,\n\t\t},\n\t\tdatetime: {\n\t\t\tmonth: \"short\",\n\t\t\tday: \"numeric\",\n\t\t\tyear: \"numeric\",\n\t\t\thour: \"numeric\",\n\t\t\tminute: \"2-digit\",\n\t\t\thour12: true,\n\t\t},\n\t};\n\n\tconst formatOptions = custom || presetConfigs[preset];\n\n\treturn new Intl.DateTimeFormat(\"en-US\", formatOptions).format(dateObj);\n}\n\n/**\n * Format date and time together\n *\n * @param date - Date value\n * @returns Formatted date + time string\n *\n * @example\n * formatDateTime(new Date()) // \"Jan 15, 2024, 2:30 PM\"\n */\nexport function formatDateTime(\n\tdate: Date | number | string | null | undefined,\n): string {\n\treturn formatDate(date, { preset: \"datetime\" });\n}\n\n/**\n * Format time only (no date)\n *\n * @param date - Date value\n * @returns Formatted time string (e.g., \"2:30 PM\")\n *\n * @example\n * formatTime(new Date()) // \"2:30 PM\"\n */\nexport function formatTime(\n\tdate: Date | number | string | null | undefined,\n): string {\n\treturn formatDate(date, { preset: \"time\" });\n}\n\n/**\n * Format date range (start → end)\n *\n * @param start - Start date\n * @param end - End date (optional)\n * @returns Formatted date range string\n *\n * @example\n * formatDateRange(new Date(\"2024-01-15\"), new Date(\"2024-01-20\")) // \"Jan 15 → Jan 20, 2024\"\n */\nexport function formatDateRange(\n\tstart: Date | number | string | null | undefined,\n\tend?: Date | number | string | null | undefined,\n): string {\n\tif (!start) {\n\t\treturn \"—\";\n\t}\n\n\tconst startDate =\n\t\ttypeof start === \"number\" || typeof start === \"string\"\n\t\t\t? new Date(start)\n\t\t\t: start;\n\n\tif (Number.isNaN(startDate.getTime())) {\n\t\treturn \"—\";\n\t}\n\n\tif (!end) {\n\t\treturn formatDate(startDate, { preset: \"short\" });\n\t}\n\n\tconst endDate =\n\t\ttypeof end === \"number\" || typeof end === \"string\" ? new Date(end) : end;\n\n\tif (Number.isNaN(endDate.getTime())) {\n\t\treturn formatDate(startDate, { preset: \"short\" });\n\t}\n\n\t// Check if same day\n\tconst sameDay =\n\t\tstartDate.getFullYear() === endDate.getFullYear() &&\n\t\tstartDate.getMonth() === endDate.getMonth() &&\n\t\tstartDate.getDate() === endDate.getDate();\n\n\tif (sameDay) {\n\t\treturn formatDate(startDate, { preset: \"short\" });\n\t}\n\n\t// Format range\n\tconst startFormatted = new Intl.DateTimeFormat(\"en-US\", {\n\t\tmonth: \"short\",\n\t\tday: \"numeric\",\n\t}).format(startDate);\n\n\tconst endFormatted = new Intl.DateTimeFormat(\"en-US\", {\n\t\tmonth: \"short\",\n\t\tday: \"numeric\",\n\t\tyear: \"numeric\",\n\t}).format(endDate);\n\n\treturn `${startFormatted} → ${endFormatted}`;\n}\n\n/**\n * Format percentage value\n *\n * @param value - Percentage value (0-100)\n * @param decimals - Number of decimal places (default: 0)\n * @returns Formatted percentage string\n *\n * @example\n * formatPercentage(45.5) // \"46%\"\n * formatPercentage(45.5, 1) // \"45.5%\"\n */\nfunction formatPercentage(\n\tvalue: number | null | undefined,\n\tdecimals = 0,\n): string {\n\tif (value === null || value === undefined) {\n\t\treturn \"—\";\n\t}\n\n\treturn `${value.toFixed(decimals)}%`;\n}\n\n/**\n * Format hours (decimal to \"Xh Ym\" format)\n *\n * @param hours - Hours as decimal number\n * @returns Formatted hours string\n *\n * @example\n * formatHours(2.5) // \"2h 30m\"\n * formatHours(1.25) // \"1h 15m\"\n */\nfunction formatHours(hours: number | null | undefined): string {\n\tif (hours === null || hours === undefined) {\n\t\treturn \"0h\";\n\t}\n\n\tconst wholeHours = Math.floor(hours);\n\tconst minutes = Math.round((hours - wholeHours) * 60);\n\n\tif (minutes === 0) {\n\t\treturn `${wholeHours}h`;\n\t}\n\n\treturn `${wholeHours}h ${minutes}m`;\n}\n\n/**\n * Format number with thousand separators\n *\n * @param value - Number value\n * @param decimals - Number of decimal places (default: 0)\n * @returns Formatted number string\n *\n * @example\n * formatNumber(1234567) // \"1,234,567\"\n * formatNumber(1234.56, 2) // \"1,234.56\"\n */\nfunction formatNumber(\n\tvalue: number | null | undefined,\n\tdecimals = 0,\n): string {\n\tif (value === null || value === undefined) {\n\t\treturn \"0\";\n\t}\n\n\treturn new Intl.NumberFormat(\"en-US\", {\n\t\tminimumFractionDigits: decimals,\n\t\tmaximumFractionDigits: decimals,\n\t}).format(value);\n}\n","import { cache } from \"react\";\nimport { getActiveCompanyId } from \"@/lib/auth/company-context\";\nimport { createServiceSupabaseClient } from \"@/lib/supabase/service-client\";\nimport type { Database } from \"@/types/supabase\";\n\nexport const CONTRACTS_PAGE_SIZE = 50;\n\nconst CONTRACTS_SELECT = `\n  id,\n  company_id,\n  contract_number,\n  title,\n  status,\n  contract_type,\n  signer_name,\n  signer_email,\n  signer_company,\n  signer_title,\n  archived_at,\n  deleted_at,\n  created_at,\n  updated_at,\n  valid_from,\n  valid_until,\n  sent_at,\n  signed_at,\n  viewed_at,\n  invoice:invoices!contracts_invoice_id_invoices_id_fk (\n    id,\n    invoice_number,\n    customer:customers!invoices_customer_id_customers_id_fk (\n      id,\n      display_name,\n      first_name,\n      last_name,\n      company_name,\n      email\n    )\n  ),\n  estimate:estimates!contracts_estimate_id_estimates_id_fk (\n    id,\n    estimate_number,\n    customer:customers!estimates_customer_id_customers_id_fk (\n      id,\n      display_name,\n      first_name,\n      last_name,\n      company_name,\n      email\n    )\n  ),\n  job:jobs!contracts_job_id_jobs_id_fk (\n    id,\n    job_number,\n    title,\n    customer:customers!jobs_customer_id_customers_id_fk (\n      id,\n      display_name,\n      first_name,\n      last_name,\n      company_name,\n      email\n    )\n  )\n`;\n\ntype CustomerFields = {\n\tid: string;\n\tdisplay_name: string | null;\n\tfirst_name: string | null;\n\tlast_name: string | null;\n\tcompany_name: string | null;\n\temail: string | null;\n};\n\ntype InvoiceRelation = {\n\tid: string;\n\tinvoice_number: string;\n\tcustomer?: CustomerFields[] | CustomerFields | null;\n} | null;\n\ntype EstimateRelation = {\n\tid: string;\n\testimate_number: string;\n\tcustomer?: CustomerFields[] | CustomerFields | null;\n} | null;\n\ntype JobRelation = {\n\tid: string;\n\tjob_number: string | null;\n\ttitle: string | null;\n\tcustomer?: CustomerFields[] | CustomerFields | null;\n} | null;\n\nexport type ContractQueryResult =\n\tDatabase[\"public\"][\"Tables\"][\"contracts\"][\"Row\"] & {\n\t\tinvoice: InvoiceRelation;\n\t\testimate: EstimateRelation;\n\t\tjob: JobRelation;\n\t};\n\nexport type ContractsPageResult = {\n\tcontracts: ContractQueryResult[];\n\ttotalCount: number;\n};\n\nexport async function getContractsPageData(\n\tpage: number,\n\tpageSize: number = CONTRACTS_PAGE_SIZE,\n\tcompanyIdOverride?: string,\n): Promise<ContractsPageResult> {\n\t// IMPORTANT: Cannot use \"use cache\" here because we call getActiveCompanyId()\n\t// which uses cookies(). The query is already fast enough without page-level caching.\n\tconst companyId = companyIdOverride ?? (await getActiveCompanyId());\n\tif (!companyId) {\n\t\treturn { contracts: [], totalCount: 0 };\n\t}\n\n\tconst supabase = await createServiceSupabaseClient();\n\tif (!supabase) {\n\t\tthrow new Error(\"Supabase client not configured\");\n\t}\n\tconst start = (Math.max(page, 1) - 1) * pageSize;\n\tconst end = start + pageSize - 1;\n\n\tconst { data, error, count } = await supabase\n\t\t.from(\"contracts\")\n\t\t.select(CONTRACTS_SELECT, { count: \"exact\" })\n\t\t.eq(\"company_id\", companyId)\n\t\t.order(\"created_at\", { ascending: false })\n\t\t.range(start, end);\n\n\tif (error) {\n\t\tthrow new Error(`Failed to fetch contracts: ${error.message}`);\n\t}\n\n\treturn {\n\t\tcontracts: (data ?? []) as ContractQueryResult[],\n\t\ttotalCount: count ?? 0,\n\t};\n}\n\ntype ContractStatusRow = Pick<\n\tDatabase[\"public\"][\"Tables\"][\"contracts\"][\"Row\"],\n\t\"status\" | \"archived_at\" | \"deleted_at\"\n>;\n\nexport const getContractsStatusSummary = cache(async (\n\tcompanyIdOverride?: string,\n): Promise<ContractStatusRow[]> => {\n\t// Note: cache() provides request-level deduplication - works fine with cookies()\n\t// \"use cache\" directive would NOT work here due to cookies() usage\n\tconst companyId = companyIdOverride ?? (await getActiveCompanyId());\n\tif (!companyId) {\n\t\treturn [];\n\t}\n\n\tconst supabase = await createServiceSupabaseClient();\n\tif (!supabase) {\n\t\tthrow new Error(\"Supabase client not configured\");\n\t}\n\tconst { data, error } = await supabase\n\t\t.from(\"contracts\")\n\t\t.select(\"status, archived_at, deleted_at\")\n\t\t.eq(\"company_id\", companyId);\n\n\tif (error) {\n\t\tthrow new Error(`Failed to fetch contract stats: ${error.message}`);\n\t}\n\n\treturn (data ?? []) as ContractStatusRow[];\n});\n\n/**\n * Fetch complete contract data including related entities and tags\n * Uses React.cache() for request-level deduplication\n */\nexport const getContractComplete = cache(\n\tasync (contractId: string, companyId: string) => {\n\t\tconst supabase = await createServiceSupabaseClient();\n\t\tif (!supabase) {\n\t\t\tthrow new Error(\"Supabase client not configured\");\n\t\t}\n\n\t\tconst { data, error } = await supabase.rpc(\"get_contract_complete\", {\n\t\t\tp_contract_id: contractId,\n\t\t\tp_company_id: companyId,\n\t\t});\n\n\t\tif (error) {\n\t\t\tconsole.error(\"Error fetching contract:\", error);\n\t\t\treturn null;\n\t\t}\n\n\t\treturn data?.[0]?.contract_data || null;\n\t},\n);\n","// This file is generated by next-core EcmascriptClientReferenceModule.\nimport { registerClientReference } from \"react-server-dom-turbopack/server\";\nexport const ContractPageContent = registerClientReference(\n    function() { throw new Error(\"Attempted to call ContractPageContent() from the server but ContractPageContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/apps/web/src/components/work/contracts/contract-page-content.tsx\",\n    \"ContractPageContent\",\n);\n","/**\n * Contract Detail Page - PPR Enabled\n *\n * Uses Partial Prerendering for instant page loads:\n * - Static shell renders instantly (5-20ms)\n * - Contract data streams in (100-300ms)\n *\n * Performance: 5-15x faster than traditional SSR\n */\n\nimport { Suspense } from \"react\";\nimport { ContractDetailData } from \"@/components/work/contracts/contract-detail-data\";\nimport { ContractDetailShell } from \"@/components/work/contracts/contract-detail-shell\";\nimport { ContractDetailSkeleton } from \"@/components/work/contracts/contract-detail-skeleton\";\n\nexport default async function ContractDetailPage({\n\tparams,\n}: {\n\tparams: Promise<{ id: string }>;\n}) {\n\tconst { id: contractId } = await params;\n\n\treturn (\n\t\t<ContractDetailShell>\n\t\t\t<Suspense fallback={<ContractDetailSkeleton />}>\n\t\t\t\t<ContractDetailData contractId={contractId} />\n\t\t\t</Suspense>\n\t\t</ContractDetailShell>\n\t);\n}\n","import { notFound, redirect } from \"next/navigation\";\nimport { ToolbarStatsProvider } from \"@/components/layout/toolbar-stats-provider\";\nimport type { StatCard } from \"@/components/ui/stats-cards\";\nimport type {\n\tAppointmentRecord,\n\tContractPageEntityData,\n\tContractRecord,\n\tCustomerRecord,\n\tPropertyRecord,\n\tRelatedEstimate,\n\tRelatedInvoice,\n\tRelatedJob,\n} from \"@/components/work/contracts/contract-page-content\";\nimport { ContractPageContent } from \"@/components/work/contracts/contract-page-content\";\nimport { isActiveCompanyOnboardingComplete } from \"@/lib/auth/company-context\";\nimport { formatDate } from \"@/lib/formatters\";\nimport { getContractComplete } from \"@/lib/queries/contracts\";\nimport { createClient } from \"@/lib/supabase/server\";\n\ntype ContractDetailDataProps = {\n\tcontractId: string;\n};\n\nfunction formatStatusLabel(status: string | null | undefined): string {\n\tif (!status) {\n\t\treturn \"Draft\";\n\t}\n\n\treturn status\n\t\t.toString()\n\t\t.split(\"_\")\n\t\t.map((part) => part.charAt(0).toUpperCase() + part.slice(1))\n\t\t.join(\" \");\n}\n\nfunction formatStatDate(\n\tvalue: string | null | undefined,\n\tfallback: string,\n): string {\n\tif (!value) {\n\t\treturn fallback;\n\t}\n\n\tconst formatted = formatDate(value, { preset: \"short\" });\n\treturn formatted === \"—\" ? fallback : formatted;\n}\n\nfunction resolveCustomerName(\n\tcustomer: CustomerRecord | null,\n\tfallback: string,\n): string {\n\tif (!customer) {\n\t\treturn fallback;\n\t}\n\n\tif (customer.display_name) {\n\t\treturn customer.display_name;\n\t}\n\n\tconst fullName =\n\t\t`${customer.first_name || \"\"} ${customer.last_name || \"\"}`.trim();\n\n\tif (fullName) {\n\t\treturn fullName;\n\t}\n\n\treturn fallback;\n}\n\n/**\n * Contract Detail Data - Async Server Component\n *\n * Uses single optimized RPC query instead of N+1 pattern:\n * 1. Auth user check and onboarding check\n * 2. Contract with tags, estimate, invoice, and job data (single RPC call)\n * 3. Property and appointments (parallel)\n *\n * Streams in after shell renders (100-300ms).\n */\nexport async function ContractDetailData({\n\tcontractId,\n}: ContractDetailDataProps) {\n\tconst supabase = await createClient();\n\n\tif (!supabase) {\n\t\treturn notFound();\n\t}\n\n\t// Get authenticated user\n\tconst {\n\t\tdata: { user },\n\t} = await supabase.auth.getUser();\n\n\tif (!user) {\n\t\treturn notFound();\n\t}\n\n\t// Check if active company has completed onboarding\n\tconst isOnboardingComplete = await isActiveCompanyOnboardingComplete();\n\n\tif (!isOnboardingComplete) {\n\t\tredirect(\"/dashboard\");\n\t}\n\n\t// Get active company ID\n\tconst { getActiveCompanyId } = await import(\"@/lib/auth/company-context\");\n\tconst activeCompanyId = await getActiveCompanyId();\n\n\tif (!activeCompanyId) {\n\t\tredirect(\"/dashboard\");\n\t}\n\n\t// ✅ Load contract with tags via single RPC call\n\tconst contractData = await getContractComplete(contractId, activeCompanyId);\n\n\tif (!contractData) {\n\t\treturn notFound();\n\t}\n\n\t// Extract related entities from RPC response\n\tconst estimate = contractData.estimate;\n\tconst invoice = contractData.invoice;\n\tconst job = contractData.job;\n\n\t// Get customer from estimate, invoice, or job\n\tconst customer =\n\t\testimate?.customer || invoice?.customer || job?.customer || null;\n\tconst customerId =\n\t\testimate?.customer?.id || invoice?.customer?.id || job?.customer?.id;\n\n\t// Fetch property (via job) and appointments for contract context\n\tconst [{ data: property }, { data: appointments }] = await Promise.all([\n\t\t// Fetch property via job\n\t\tjob?.id\n\t\t\t? supabase\n\t\t\t\t\t.from(\"jobs\")\n\t\t\t\t\t.select(\"property_id, property:properties!property_id(*)\")\n\t\t\t\t\t.eq(\"id\", job.id)\n\t\t\t\t\t.single()\n\t\t\t\t\t.then((result) => ({\n\t\t\t\t\t\tdata: result.data?.property\n\t\t\t\t\t\t\t? Array.isArray(result.data.property)\n\t\t\t\t\t\t\t\t? result.data.property[0]\n\t\t\t\t\t\t\t\t: result.data.property\n\t\t\t\t\t\t\t: null,\n\t\t\t\t\t\terror: result.error,\n\t\t\t\t\t}))\n\t\t\t: Promise.resolve({ data: null, error: null }),\n\n\t\t// Fetch appointments related to the job\n\t\tjob?.id\n\t\t\t? supabase\n\t\t\t\t\t.from(\"appointments\")\n\t\t\t\t\t.select(\"id, scheduled_start, scheduled_end, status, type\")\n\t\t\t\t\t.eq(\"job_id\", job.id)\n\t\t\t\t\t.is(\"deleted_at\", null)\n\t\t\t\t\t.order(\"scheduled_start\", { ascending: false })\n\t\t\t\t\t.limit(5)\n\t\t\t: Promise.resolve({ data: [], error: null }),\n\t]);\n\n\t// Transform contract data\n\tconst normalizedCustomer = (customer ?? null) as CustomerRecord | null;\n\tconst normalizedProperty = (property ?? null) as PropertyRecord | null;\n\tconst normalizedEstimate = (estimate ?? null) as RelatedEstimate | null;\n\tconst normalizedInvoice = (invoice ?? null) as RelatedInvoice | null;\n\tconst normalizedJob = (job ?? null) as RelatedJob | null;\n\tconst normalizedAppointments = (appointments ?? []) as AppointmentRecord[];\n\n\tconst customerFallback =\n\t\tnormalizedCustomer?.display_name ||\n\t\t`${normalizedCustomer?.first_name || \"\"} ${normalizedCustomer?.last_name || \"\"}`.trim() ||\n\t\tcontractData.signer_email ||\n\t\t\"Unknown Customer\";\n\n\tconst contract: ContractRecord & { contract_tags?: any[] } = {\n\t\tid: contractData.id,\n\t\tcontractNumber: contractData.contract_number,\n\t\ttitle: contractData.title,\n\t\tdescription: contractData.description,\n\t\tcustomerName: resolveCustomerName(normalizedCustomer, customerFallback),\n\t\tcustomerId: customerId || null,\n\t\tstatus: contractData.status,\n\t\tcontractType: contractData.contract_type,\n\t\tsignerName: contractData.signer_name,\n\t\tsignerEmail: contractData.signer_email,\n\t\tsignerTitle: contractData.signer_title,\n\t\tsignerCompany: contractData.signer_company,\n\t\tsignedAt: contractData.signed_at,\n\t\tsentAt: contractData.sent_at,\n\t\tviewedAt: contractData.viewed_at,\n\t\tcreatedAt: contractData.created_at,\n\t\tvalidFrom: contractData.valid_from,\n\t\tvalidUntil: contractData.valid_until,\n\t\tipAddress: contractData.ip_address,\n\t\tcontent: contractData.content,\n\t\tterms: contractData.terms,\n\t\tnotes: contractData.notes,\n\t\tcontract_tags: contractData.contract_tags || [],\n\t};\n\n\tconst entityData: ContractPageEntityData = {\n\t\tcontract,\n\t\tcustomer: normalizedCustomer,\n\t\tproperty: normalizedProperty,\n\t\testimate: normalizedEstimate,\n\t\tinvoice: normalizedInvoice,\n\t\tjob: normalizedJob,\n\t\tappointments: normalizedAppointments,\n\t};\n\n\tconst linkedRecordsCount = [\n\t\tnormalizedEstimate,\n\t\tnormalizedInvoice,\n\t\tnormalizedJob,\n\t].filter(Boolean).length;\n\n\tconst stats: StatCard[] = [\n\t\t{\n\t\t\tlabel: \"Status\",\n\t\t\tvalue: formatStatusLabel(contract.status ?? null),\n\t\t},\n\t\t{\n\t\t\tlabel: \"Sent\",\n\t\t\tvalue: formatStatDate(contract.sentAt, \"Not sent\"),\n\t\t},\n\t\t{\n\t\t\tlabel: \"Signed\",\n\t\t\tvalue: formatStatDate(contract.signedAt, \"Pending\"),\n\t\t},\n\t\t{\n\t\t\tlabel: \"Valid Until\",\n\t\t\tvalue: formatStatDate(contract.validUntil, \"No expiry\"),\n\t\t},\n\t\t{\n\t\t\tlabel: \"Linked Records\",\n\t\t\tvalue: linkedRecordsCount,\n\t\t},\n\t];\n\n\treturn (\n\t\t<ToolbarStatsProvider stats={stats}>\n\t\t\t<ContractPageContent entityData={entityData} />\n\t\t</ToolbarStatsProvider>\n\t);\n}\n","import type { ReactNode } from \"react\";\n\ntype ContractDetailShellProps = {\n\tchildren: ReactNode;\n};\n\n/**\n * Contract Detail Shell - Static Server Component\n *\n * Renders instantly (5-20ms) and is cached at the edge.\n * Contains only static layout elements - no data fetching.\n */\nexport function ContractDetailShell({ children }: ContractDetailShellProps) {\n\treturn (\n\t\t<div className=\"flex h-full w-full flex-col overflow-auto\">\n\t\t\t<div className=\"mx-auto w-full max-w-7xl\">{children}</div>\n\t\t</div>\n\t);\n}\n","/**\n * Contract Detail Skeleton - Loading State\n *\n * Matches the exact layout of the contract detail page to prevent layout shifts.\n */\nexport function ContractDetailSkeleton() {\n\treturn (\n\t\t<div className=\"space-y-6\">\n\t\t\t{/* Header section */}\n\t\t\t<div className=\"flex items-start justify-between\">\n\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t{/* Contract number skeleton */}\n\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t{/* Title skeleton */}\n\t\t\t\t\t<div className=\"bg-muted h-8 w-64 animate-pulse rounded\" />\n\t\t\t\t\t{/* Customer skeleton */}\n\t\t\t\t\t<div className=\"bg-muted h-4 w-48 animate-pulse rounded\" />\n\t\t\t\t</div>\n\t\t\t\t{/* Action buttons skeleton */}\n\t\t\t\t<div className=\"flex gap-2\">\n\t\t\t\t\t<div className=\"bg-muted h-10 w-24 animate-pulse rounded\" />\n\t\t\t\t\t<div className=\"bg-muted h-10 w-24 animate-pulse rounded\" />\n\t\t\t\t</div>\n\t\t\t</div>\n\n\t\t\t{/* Stats cards skeleton */}\n\t\t\t<div className=\"grid gap-4 md:grid-cols-2 lg:grid-cols-5\">\n\t\t\t\t{[1, 2, 3, 4, 5].map((i) => (\n\t\t\t\t\t<div\n\t\t\t\t\t\tclassName=\"bg-card h-24 animate-pulse rounded-lg border p-4\"\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t>\n\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-20 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-16 animate-pulse rounded\" />\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</div>\n\n\t\t\t{/* Tabs skeleton */}\n\t\t\t<div className=\"space-y-4\">\n\t\t\t\t<div className=\"flex gap-4 border-b\">\n\t\t\t\t\t{[1, 2, 3, 4].map((i) => (\n\t\t\t\t\t\t<div\n\t\t\t\t\t\t\tclassName=\"bg-muted h-10 w-24 animate-pulse rounded-t\"\n\t\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\t/>\n\t\t\t\t\t))}\n\t\t\t\t</div>\n\n\t\t\t\t{/* Content skeleton */}\n\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t{/* Contract details card */}\n\t\t\t\t\t<div className=\"bg-card h-64 animate-pulse rounded-lg border p-6\">\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"space-y-2\">\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-full animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-3/4 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-5/6 animate-pulse rounded\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Signer details card */}\n\t\t\t\t\t<div className=\"bg-card h-48 animate-pulse rounded-lg border p-6\">\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"grid gap-4 md:grid-cols-2\">\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-full animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-full animate-pulse rounded\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t{/* Related records card */}\n\t\t\t\t\t<div className=\"bg-card h-32 animate-pulse rounded-lg border p-6\">\n\t\t\t\t\t\t<div className=\"space-y-4\">\n\t\t\t\t\t\t\t<div className=\"bg-muted h-6 w-32 animate-pulse rounded\" />\n\t\t\t\t\t\t\t<div className=\"flex gap-4\">\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t\t<div className=\"bg-muted h-4 w-24 animate-pulse rounded\" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t);\n}\n"],"names":[],"mappings":"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","ignoreList":[0,3]}