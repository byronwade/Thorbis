module.exports=[193695,(a,b,c)=>{b.exports=a.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},997868,a=>{a.n(a.i(884849))},592581,a=>{a.n(a.i(596565))},134005,a=>{a.n(a.i(977930))},565165,a=>{a.n(a.i(728209))},147941,a=>{a.n(a.i(484103))},304434,a=>{a.n(a.i(632684))},407521,a=>{a.n(a.i(693094))},797797,a=>{a.n(a.i(977207))},290022,a=>{a.n(a.i(362735))},729157,a=>{a.n(a.i(470009))},712363,a=>{a.n(a.i(279732))},208120,a=>{a.n(a.i(52860))},863056,a=>{a.n(a.i(77721))},721135,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call ToolbarStatsProvider() from the server but ToolbarStatsProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/layout/toolbar-stats-provider.tsx <module evaluation>","ToolbarStatsProvider");a.s(["ToolbarStatsProvider",0,b])},444593,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call ToolbarStatsProvider() from the server but ToolbarStatsProvider is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/layout/toolbar-stats-provider.tsx","ToolbarStatsProvider");a.s(["ToolbarStatsProvider",0,b])},206372,a=>{"use strict";a.i(721135);var b=a.i(444593);a.n(b)},19154,a=>{a.n(a.i(456621))},271141,a=>{a.n(a.i(581567))},162349,a=>{"use strict";function b(a,c={}){let{minimumFractionDigits:d=0,maximumFractionDigits:e=c.decimals??2,showZero:f=!0,decimals:g}=c,h=void 0!==g?g:e,i=void 0!==g?g:d;return null==a?f?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(0):"$0.00":new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:i,maximumFractionDigits:h}).format(a/100)}function c(a,b={}){let d;if(!a)return"—";let e="number"==typeof a||"string"==typeof a?new Date(a):a;if(Number.isNaN(e.getTime()))return"—";let f="table";"string"==typeof b?f=b||"table":(f=b.preset||"table",d=b.custom);let g=d||({short:{month:"short",day:"numeric",year:"numeric"},medium:{month:"short",day:"numeric",year:"numeric"},long:{month:"long",day:"numeric",year:"numeric"},full:{weekday:"long",month:"long",day:"numeric",year:"numeric"},table:{month:"short",day:"numeric",year:"numeric"},time:{hour:"numeric",minute:"2-digit",hour12:!0},datetime:{month:"short",day:"numeric",year:"numeric",hour:"numeric",minute:"2-digit",hour12:!0}})[f];return new Intl.DateTimeFormat("en-US",g).format(e)}a.s(["formatCurrency",()=>b,"formatDate",()=>c])},762691,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call ServiceAgreementPageContent() from the server but ServiceAgreementPageContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/service-agreements/service-agreement-page-content.tsx <module evaluation>","ServiceAgreementPageContent");a.s(["ServiceAgreementPageContent",0,b])},943984,a=>{"use strict";let b=(0,a.i(742210).registerClientReference)(function(){throw Error("Attempted to call ServiceAgreementPageContent() from the server but ServiceAgreementPageContent is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"[project]/apps/web/src/components/work/service-agreements/service-agreement-page-content.tsx","ServiceAgreementPageContent");a.s(["ServiceAgreementPageContent",0,b])},510650,a=>{"use strict";a.i(762691);var b=a.i(943984);a.n(b)},50771,a=>{"use strict";var b=a.i(504348),c=a.i(429969);a.i(692167);var d=a.i(852596),e=a.i(206372),f=a.i(510650);a.i(467361);var g=a.i(445074),h=a.i(162349),i=a.i(136874);async function j({agreementId:c}){let j=await (0,i.createClient)();if(!j)return(0,d.notFound)();let{data:{user:k}}=await j.auth.getUser();if(!k)return(0,d.notFound)();await (0,g.isActiveCompanyOnboardingComplete)()||(0,d.redirect)("/dashboard");let{getActiveCompanyId:l}=await a.A(37652),m=await l();m||(0,d.redirect)("/dashboard");let{data:n,error:o}=await j.from("service_plans").select(`
      *,
      customer:customers!customer_id(*),
      property:properties!property_id(*)
    `).eq("id",c).eq("type","contract").is("deleted_at",null).single();if(o||!n||n.company_id!==m)return(0,d.notFound)();let p=Array.isArray(n.customer)?n.customer[0]:n.customer,q=Array.isArray(n.property)?n.property[0]:n.property,[{data:r},{data:s},{data:t},{data:u},{data:v},{data:w}]=await Promise.all([j.from("invoices").select("id, invoice_number, total_amount, status, created_at").eq("company_id",m).or(`metadata->>'service_agreement_id'.eq.${c},metadata->>'service_plan_id'.eq.${c}`).order("created_at",{ascending:!1}).limit(20),j.from("jobs").select("id, job_number, title, status, completed_at").eq("company_id",m).or(`metadata->>'service_agreement_id'.eq.${c},metadata->>'service_plan_id'.eq.${c}`).order("created_at",{ascending:!1}).limit(20),n.property_id?j.from("equipment").select("*").eq("property_id",n.property_id).is("deleted_at",null):Promise.resolve({data:[],error:null}),j.from("activity_log").select("*, user:users!user_id(*)").eq("entity_type","service_plan").eq("entity_id",c).order("created_at",{ascending:!1}).limit(50),j.from("notes").select("*").eq("entity_type","service_plan").eq("entity_id",c).is("deleted_at",null).order("created_at",{ascending:!1}),j.from("attachments").select("*").eq("entity_type","service_plan").eq("entity_id",c).order("created_at",{ascending:!1})]),x=(r||[]).reduce((a,b)=>a+(b.total_amount||0),0),y=(s||[]).filter(a=>a.completed_at).length,z=(s||[]).filter(a=>"in_progress"===a.status).length,A=[{label:"Total Revenue",value:(0,h.formatCurrency)(x),change:0,changeLabel:"from this agreement"},{label:"Completed Jobs",value:y,change:0,changeLabel:"services delivered"},{label:"Active Jobs",value:z,change:0,changeLabel:"in progress"},{label:"Equipment",value:(t||[]).length,change:0,changeLabel:"covered items"}];return(0,b.jsx)(e.ToolbarStatsProvider,{stats:A,children:(0,b.jsx)("div",{className:"flex h-full w-full flex-col overflow-auto",children:(0,b.jsx)("div",{className:"mx-auto w-full max-w-7xl",children:(0,b.jsx)(f.ServiceAgreementPageContent,{entityData:{agreement:n,customer:p,property:q,invoices:r||[],jobs:s||[],equipment:t||[],activities:u||[],notes:v||[],attachments:w||[]}})})})})}function k(){return(0,b.jsx)("div",{className:"flex h-full w-full flex-col overflow-auto",children:(0,b.jsxs)("div",{className:"mx-auto w-full max-w-7xl space-y-6 p-6",children:[(0,b.jsx)("div",{className:"space-y-4",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-8 w-64 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-80 animate-pulse rounded"})]}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("div",{className:"bg-muted h-10 w-28 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-10 w-28 animate-pulse rounded"})]})]})}),(0,b.jsx)("div",{className:"grid gap-4 md:grid-cols-4",children:[1,2,3,4].map(a=>(0,b.jsxs)("div",{className:"space-y-2 rounded-lg border p-4",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-24 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-6 w-32 animate-pulse rounded"})]},a))}),(0,b.jsxs)("div",{className:"grid gap-6 lg:grid-cols-3",children:[(0,b.jsxs)("div",{className:"space-y-6 lg:col-span-2",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-40 animate-pulse rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-full animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-3/4 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-2/3 animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-48 animate-pulse rounded"}),(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3,4,5].map(a=>(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"bg-muted size-5 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-64 animate-pulse rounded"})]},a))})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-40 animate-pulse rounded"}),(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-48 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-24 animate-pulse rounded"})]},a))})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-24 animate-pulse rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-full animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-3/4 animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-32 animate-pulse rounded"}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-full animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-2/3 animate-pulse rounded"})]})]}),(0,b.jsxs)("div",{className:"space-y-4 rounded-lg border p-6",children:[(0,b.jsx)("div",{className:"bg-muted h-6 w-24 animate-pulse rounded"}),(0,b.jsx)("div",{className:"space-y-2",children:[1,2,3].map(a=>(0,b.jsxs)("div",{className:"flex justify-between",children:[(0,b.jsx)("div",{className:"bg-muted h-4 w-24 animate-pulse rounded"}),(0,b.jsx)("div",{className:"bg-muted h-4 w-32 animate-pulse rounded"})]},a))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"flex gap-4 border-b",children:[1,2,3,4].map(a=>(0,b.jsx)("div",{className:"bg-muted h-10 w-28 animate-pulse rounded-t"},a))}),(0,b.jsx)("div",{className:"space-y-3",children:[1,2,3].map(a=>(0,b.jsx)("div",{className:"bg-muted h-24 w-full animate-pulse rounded"},a))})]})]})})}async function l({params:a}){let{id:d}=await a;return(0,b.jsx)(c.Suspense,{fallback:(0,b.jsx)(k,{}),children:(0,b.jsx)(j,{agreementId:d})})}a.s(["default",()=>l],50771)},37652,a=>{a.v(b=>Promise.all(["server/chunks/ssr/apps_web_src_lib_auth_company-context_ts_732d588b._.js"].map(b=>a.l(b))).then(()=>b(480513)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5de4c070._.js.map