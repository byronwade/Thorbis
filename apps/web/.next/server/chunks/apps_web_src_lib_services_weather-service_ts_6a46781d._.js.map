{"version":3,"sources":["../../../../../apps/web/src/lib/services/weather-service.ts"],"sourcesContent":["/**\n * Weather Service - NWS API Integration\n *\n * Provides weather forecasts and severe weather alerts for job scheduling\n * Uses free National Weather Service API (api.weather.gov)\n *\n * Features:\n * - 7-day forecast\n * - Hourly forecast\n * - Active weather alerts\n * - Severe weather notifications\n */\n\nimport { z } from \"zod\";\n\nconst USER_AGENT = \"Thorbis-FMS/1.0 (support@thorbis.app)\";\n\n// ============================================================================\n// Types and Schemas\n// ============================================================================\n\nconst WeatherAlertSchema = z.object({\n\tevent: z.string(),\n\theadline: z.string(),\n\tdescription: z.string(),\n\tseverity: z.enum([\"Extreme\", \"Severe\", \"Moderate\", \"Minor\", \"Unknown\"]),\n\turgency: z.enum([\"Immediate\", \"Expected\", \"Future\", \"Past\", \"Unknown\"]),\n\tonset: z.string().optional(),\n\texpires: z.string().optional(),\n\tinstruction: z.string().nullable().optional(),\n});\n\nconst WeatherPeriodSchema = z.object({\n\tnumber: z.number(),\n\tname: z.string(),\n\ttemperature: z.number(),\n\ttemperatureUnit: z.string(),\n\twindSpeed: z.string(),\n\twindDirection: z.string(),\n\tshortForecast: z.string(),\n\tdetailedForecast: z.string(),\n\tstartTime: z.string(),\n\tendTime: z.string(),\n});\n\nconst WeatherDataSchema = z.object({\n\tlocation: z.object({\n\t\tlat: z.number(),\n\t\tlon: z.number(),\n\t\tgridId: z.string().optional(),\n\t\tgridX: z.number().optional(),\n\t\tgridY: z.number().optional(),\n\t}),\n\tforecast: z\n\t\t.object({\n\t\t\tperiods: z.array(WeatherPeriodSchema),\n\t\t\tupdated: z.string().optional(), // Made optional as API doesn't always return it\n\t\t})\n\t\t.optional(),\n\thourly: z\n\t\t.object({\n\t\t\tperiods: z.array(WeatherPeriodSchema),\n\t\t\tupdated: z.string().optional(), // Made optional as API doesn't always return it\n\t\t})\n\t\t.optional(),\n\talerts: z.array(WeatherAlertSchema),\n\thasActiveAlerts: z.boolean(),\n\thighestSeverity: z.enum([\"Extreme\", \"Severe\", \"Moderate\", \"Minor\", \"None\"]),\n\tenrichedAt: z.string(),\n});\n\nexport type WeatherData = z.infer<typeof WeatherDataSchema>;\nexport type WeatherAlert = z.infer<typeof WeatherAlertSchema>;\nexport type WeatherPeriod = z.infer<typeof WeatherPeriodSchema>;\n\n// ============================================================================\n// Weather Service\n// ============================================================================\n\nexport class WeatherService {\n\tprivate readonly cache: Map<\n\t\tstring,\n\t\t{ data: WeatherData; timestamp: number }\n\t> = new Map();\n\tprivate readonly cacheTTL = 1000 * 60 * 30; // 30 minutes\n\n\t/**\n\t * Get complete weather data for a location\n\t */\n\tasync getWeatherData(lat: number, lon: number): Promise<WeatherData | null> {\n\t\tconst cacheKey = `${lat.toFixed(4)},${lon.toFixed(4)}`;\n\n\t\t// Check cache\n\t\tconst cached = this.cache.get(cacheKey);\n\t\tif (cached && Date.now() - cached.timestamp < this.cacheTTL) {\n\t\t\treturn cached.data;\n\t\t}\n\n\t\ttry {\n\t\t\t// Step 1: Get NWS grid point metadata\n\t\t\tconst pointsRes = await fetch(\n\t\t\t\t`https://api.weather.gov/points/${lat.toFixed(4)},${lon.toFixed(4)}`,\n\t\t\t\t{\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"User-Agent\": USER_AGENT,\n\t\t\t\t\t\tAccept: \"application/geo+json\",\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t);\n\n\t\t\tif (!pointsRes.ok) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tconst pointsData = await pointsRes.json();\n\t\t\tconst properties = pointsData.properties;\n\n\t\t\t// Step 2: Fetch forecast, hourly, and alerts in parallel\n\t\t\tconst [forecastData, hourlyData, alertsData] = await Promise.all([\n\t\t\t\tproperties.forecast\n\t\t\t\t\t? this.fetchJson(properties.forecast)\n\t\t\t\t\t: Promise.resolve(null),\n\t\t\t\tproperties.forecastHourly\n\t\t\t\t\t? this.fetchJson(properties.forecastHourly)\n\t\t\t\t\t: Promise.resolve(null),\n\t\t\t\tthis.fetchJson(\n\t\t\t\t\t`https://api.weather.gov/alerts/active?point=${lat},${lon}`,\n\t\t\t\t),\n\t\t\t]);\n\n\t\t\t// Parse alerts\n\t\t\tconst alerts: WeatherAlert[] = [];\n\t\t\tlet highestSeverity: WeatherData[\"highestSeverity\"] = \"None\";\n\n\t\t\tif (alertsData?.features) {\n\t\t\t\tfor (const feature of alertsData.features) {\n\t\t\t\t\tconst props = feature.properties;\n\t\t\t\t\tconst alert: WeatherAlert = {\n\t\t\t\t\t\tevent: props.event || \"Unknown Event\",\n\t\t\t\t\t\theadline: props.headline || \"\",\n\t\t\t\t\t\tdescription: props.description || \"\",\n\t\t\t\t\t\tseverity: this.normalizeSeverity(props.severity),\n\t\t\t\t\t\turgency: this.normalizeUrgency(props.urgency),\n\t\t\t\t\t\tonset: props.onset,\n\t\t\t\t\t\texpires: props.expires,\n\t\t\t\t\t\tinstruction: props.instruction,\n\t\t\t\t\t};\n\t\t\t\t\talerts.push(alert);\n\n\t\t\t\t\t// Track highest severity\n\t\t\t\t\tif (\n\t\t\t\t\t\talert.severity !== \"Unknown\" &&\n\t\t\t\t\t\tthis.severityRank(alert.severity) >\n\t\t\t\t\t\t\tthis.severityRank(highestSeverity)\n\t\t\t\t\t) {\n\t\t\t\t\t\thighestSeverity = alert.severity as WeatherData[\"highestSeverity\"];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst weatherData: WeatherData = {\n\t\t\t\tlocation: {\n\t\t\t\t\tlat,\n\t\t\t\t\tlon,\n\t\t\t\t\tgridId: properties.gridId,\n\t\t\t\t\tgridX: properties.gridX,\n\t\t\t\t\tgridY: properties.gridY,\n\t\t\t\t},\n\t\t\t\tforecast: forecastData\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tperiods: forecastData.properties.periods.map((p: any) => ({\n\t\t\t\t\t\t\t\tnumber: p.number,\n\t\t\t\t\t\t\t\tname: p.name,\n\t\t\t\t\t\t\t\ttemperature: p.temperature,\n\t\t\t\t\t\t\t\ttemperatureUnit: p.temperatureUnit,\n\t\t\t\t\t\t\t\twindSpeed: p.windSpeed,\n\t\t\t\t\t\t\t\twindDirection: p.windDirection,\n\t\t\t\t\t\t\t\tshortForecast: p.shortForecast,\n\t\t\t\t\t\t\t\tdetailedForecast: p.detailedForecast,\n\t\t\t\t\t\t\t\tstartTime: p.startTime,\n\t\t\t\t\t\t\t\tendTime: p.endTime,\n\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\tupdated:\n\t\t\t\t\t\t\t\tforecastData.properties.updated ||\n\t\t\t\t\t\t\t\tforecastData.properties.generatedAt,\n\t\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\t\thourly: hourlyData\n\t\t\t\t\t? {\n\t\t\t\t\t\t\tperiods: hourlyData.properties.periods\n\t\t\t\t\t\t\t\t.slice(0, 24)\n\t\t\t\t\t\t\t\t.map((p: any) => ({\n\t\t\t\t\t\t\t\t\tnumber: p.number,\n\t\t\t\t\t\t\t\t\tname: p.name,\n\t\t\t\t\t\t\t\t\ttemperature: p.temperature,\n\t\t\t\t\t\t\t\t\ttemperatureUnit: p.temperatureUnit,\n\t\t\t\t\t\t\t\t\twindSpeed: p.windSpeed,\n\t\t\t\t\t\t\t\t\twindDirection: p.windDirection,\n\t\t\t\t\t\t\t\t\tshortForecast: p.shortForecast,\n\t\t\t\t\t\t\t\t\tdetailedForecast: p.detailedForecast,\n\t\t\t\t\t\t\t\t\tstartTime: p.startTime,\n\t\t\t\t\t\t\t\t\tendTime: p.endTime,\n\t\t\t\t\t\t\t\t})),\n\t\t\t\t\t\t\tupdated:\n\t\t\t\t\t\t\t\thourlyData.properties.updated ||\n\t\t\t\t\t\t\t\thourlyData.properties.generatedAt,\n\t\t\t\t\t\t}\n\t\t\t\t\t: undefined,\n\t\t\t\talerts,\n\t\t\t\thasActiveAlerts: alerts.length > 0,\n\t\t\t\thighestSeverity,\n\t\t\t\tenrichedAt: new Date().toISOString(),\n\t\t\t};\n\n\t\t\t// Cache the result\n\t\t\tthis.cache.set(cacheKey, { data: weatherData, timestamp: Date.now() });\n\n\t\t\treturn WeatherDataSchema.parse(weatherData);\n\t\t} catch (_error) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t/**\n\t * Get only active alerts for a location (faster)\n\t */\n\tasync getActiveAlerts(lat: number, lon: number): Promise<WeatherAlert[]> {\n\t\ttry {\n\t\t\tconst alertsData = await this.fetchJson(\n\t\t\t\t`https://api.weather.gov/alerts/active?point=${lat},${lon}`,\n\t\t\t);\n\n\t\t\tif (!alertsData?.features) {\n\t\t\t\treturn [];\n\t\t\t}\n\n\t\t\treturn alertsData.features.map((feature: any) => ({\n\t\t\t\tevent: feature.properties.event || \"Unknown Event\",\n\t\t\t\theadline: feature.properties.headline || \"\",\n\t\t\t\tdescription: feature.properties.description || \"\",\n\t\t\t\tseverity: this.normalizeSeverity(feature.properties.severity),\n\t\t\t\turgency: this.normalizeUrgency(feature.properties.urgency),\n\t\t\t\tonset: feature.properties.onset,\n\t\t\t\texpires: feature.properties.expires,\n\t\t\t\tinstruction: feature.properties.instruction,\n\t\t\t}));\n\t\t} catch (_error) {\n\t\t\treturn [];\n\t\t}\n\t}\n\n\t/**\n\t * Check if weather is suitable for outdoor work\n\t */\n\tisSuitableForOutdoorWork(weather: WeatherData): {\n\t\tsuitable: boolean;\n\t\treason?: string;\n\t} {\n\t\t// Check for severe weather alerts\n\t\tif (\n\t\t\tweather.highestSeverity === \"Extreme\" ||\n\t\t\tweather.highestSeverity === \"Severe\"\n\t\t) {\n\t\t\treturn {\n\t\t\t\tsuitable: false,\n\t\t\t\treason: \"Severe weather alert in effect\",\n\t\t\t};\n\t\t}\n\n\t\t// Check current/upcoming conditions\n\t\tif (weather.hourly?.periods?.[0]) {\n\t\t\tconst current = weather.hourly.periods[0];\n\n\t\t\t// Check for precipitation\n\t\t\tif (\n\t\t\t\tcurrent.shortForecast.toLowerCase().includes(\"rain\") ||\n\t\t\t\tcurrent.shortForecast.toLowerCase().includes(\"storm\") ||\n\t\t\t\tcurrent.shortForecast.toLowerCase().includes(\"snow\")\n\t\t\t) {\n\t\t\t\treturn {\n\t\t\t\t\tsuitable: false,\n\t\t\t\t\treason: `${current.shortForecast} expected`,\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t// Check for extreme temperatures\n\t\t\tif (current.temperature < 32) {\n\t\t\t\treturn {\n\t\t\t\t\tsuitable: false,\n\t\t\t\t\treason: \"Freezing temperatures\",\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (current.temperature > 100) {\n\t\t\t\treturn {\n\t\t\t\t\tsuitable: false,\n\t\t\t\t\treason: \"Extreme heat\",\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn { suitable: true };\n\t}\n\n\t/**\n\t * Helper to fetch JSON with proper headers\n\t */\n\tprivate async fetchJson(url: string): Promise<any> {\n\t\tconst res = await fetch(url, {\n\t\t\theaders: {\n\t\t\t\t\"User-Agent\": USER_AGENT,\n\t\t\t\tAccept: \"application/geo+json\",\n\t\t\t},\n\t\t});\n\n\t\tif (!res.ok) {\n\t\t\tthrow new Error(`Fetch failed: ${res.status} ${url}`);\n\t\t}\n\n\t\treturn res.json();\n\t}\n\n\t/**\n\t * Normalize severity values\n\t */\n\tprivate normalizeSeverity(\n\t\tseverity: string | undefined,\n\t): WeatherAlert[\"severity\"] {\n\t\tif (!severity) {\n\t\t\treturn \"Unknown\";\n\t\t}\n\t\tconst s = severity.toLowerCase();\n\t\tif (s.includes(\"extreme\")) {\n\t\t\treturn \"Extreme\";\n\t\t}\n\t\tif (s.includes(\"severe\")) {\n\t\t\treturn \"Severe\";\n\t\t}\n\t\tif (s.includes(\"moderate\")) {\n\t\t\treturn \"Moderate\";\n\t\t}\n\t\tif (s.includes(\"minor\")) {\n\t\t\treturn \"Minor\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\t/**\n\t * Normalize urgency values\n\t */\n\tprivate normalizeUrgency(\n\t\turgency: string | undefined,\n\t): WeatherAlert[\"urgency\"] {\n\t\tif (!urgency) {\n\t\t\treturn \"Unknown\";\n\t\t}\n\t\tconst u = urgency.toLowerCase();\n\t\tif (u.includes(\"immediate\")) {\n\t\t\treturn \"Immediate\";\n\t\t}\n\t\tif (u.includes(\"expected\")) {\n\t\t\treturn \"Expected\";\n\t\t}\n\t\tif (u.includes(\"future\")) {\n\t\t\treturn \"Future\";\n\t\t}\n\t\tif (u.includes(\"past\")) {\n\t\t\treturn \"Past\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\t/**\n\t * Get numeric rank for severity comparison\n\t */\n\tprivate severityRank(severity: string): number {\n\t\tswitch (severity) {\n\t\t\tcase \"Extreme\":\n\t\t\t\treturn 4;\n\t\t\tcase \"Severe\":\n\t\t\t\treturn 3;\n\t\t\tcase \"Moderate\":\n\t\t\t\treturn 2;\n\t\t\tcase \"Minor\":\n\t\t\t\treturn 1;\n\t\t\tdefault:\n\t\t\t\treturn 0;\n\t\t}\n\t}\n\n\t/**\n\t * Clear cache\n\t */\n\tclearCache(): void {\n\t\tthis.cache.clear();\n\t}\n}\n\n// Singleton instance\nexport const weatherService = new WeatherService();\n"],"names":[],"mappings":"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"}