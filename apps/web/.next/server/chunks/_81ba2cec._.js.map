{"version":3,"sources":["../../../../../apps/web/src/lib/email/token-encryption.ts","../../../../../node_modules/.pnpm/next%4016.0.4_%40opentelemetry%2Bapi%401.9.0_react-dom%4019.2.0_react%4019.2.0__react%4019.2.0/node_modules/next/src/server/route-modules/app-page/vendored/rsc/react-jsx-runtime.ts","../../../../../apps/web/src/lib/email/pre-send-checks.ts","../../../../../apps/web/emails/components/button.tsx","../../../../../apps/web/emails/components/card.tsx","../../../../../apps/web/emails/theme.ts","../../../../../apps/web/emails/components/heading.tsx","../../../../../apps/web/emails/layouts/base-layout.tsx"],"sourcesContent":["/**\n * Token Encryption Service\n *\n * Encrypts and decrypts OAuth refresh tokens before storing in database.\n * Uses AES-256-GCM for authenticated encryption.\n *\n * Security Features:\n * - AES-256-GCM authenticated encryption\n * - Unique IV (initialization vector) per token\n * - Authentication tag prevents tampering\n * - Key derivation from environment variable\n *\n * Environment Variables Required:\n * - TOKEN_ENCRYPTION_KEY: 32-byte hex string (64 characters)\n *\n * Generate key with: openssl rand -hex 32\n *\n * CRITICAL: Never commit encryption key to version control!\n */\n\nimport crypto from \"crypto\";\n\n// =============================================================================\n// CONSTANTS\n// =============================================================================\n\n/** Encryption algorithm (AES-256-GCM) */\nconst ALGORITHM = \"aes-256-gcm\";\n\n/** IV length in bytes (12 bytes = 96 bits, recommended for GCM) */\nconst IV_LENGTH = 12;\n\n/** Auth tag length in bytes (16 bytes = 128 bits) */\nconst AUTH_TAG_LENGTH = 16;\n\n/** Encoding for encrypted output */\nconst ENCODING = \"base64\";\n\n// =============================================================================\n// KEY MANAGEMENT\n// =============================================================================\n\n/**\n * Get encryption key from environment\n * Throws error if key is missing or invalid\n */\nfunction getEncryptionKey(): Buffer {\n\tconst keyHex = process.env.TOKEN_ENCRYPTION_KEY;\n\n\tif (!keyHex) {\n\t\tthrow new Error(\n\t\t\t\"TOKEN_ENCRYPTION_KEY environment variable not set. Generate with: openssl rand -hex 32\"\n\t\t);\n\t}\n\n\t// Verify key is 32 bytes (64 hex characters)\n\tif (keyHex.length !== 64) {\n\t\tthrow new Error(\n\t\t\t\"TOKEN_ENCRYPTION_KEY must be 32 bytes (64 hex characters). Generate with: openssl rand -hex 32\"\n\t\t);\n\t}\n\n\t// Convert hex string to buffer\n\tconst key = Buffer.from(keyHex, \"hex\");\n\n\tif (key.length !== 32) {\n\t\tthrow new Error(\"Invalid TOKEN_ENCRYPTION_KEY format\");\n\t}\n\n\treturn key;\n}\n\n// =============================================================================\n// ENCRYPTION/DECRYPTION\n// =============================================================================\n\n/**\n * Encrypt a token (refresh token or access token)\n *\n * @param plaintext - Token to encrypt\n * @returns Encrypted token string (format: iv:authTag:ciphertext, all base64)\n *\n * @example\n * const encrypted = encryptToken(\"ya29.a0AfH6SMB...\");\n * // Returns: \"rL8Kx2f...==:gH3pQ9...==:aB4cD5...\"\n */\nexport function encryptToken(plaintext: string): string {\n\ttry {\n\t\tconst key = getEncryptionKey();\n\n\t\t// Generate random IV (never reuse IVs!)\n\t\tconst iv = crypto.randomBytes(IV_LENGTH);\n\n\t\t// Create cipher\n\t\tconst cipher = crypto.createCipheriv(ALGORITHM, key, iv);\n\n\t\t// Encrypt\n\t\tlet ciphertext = cipher.update(plaintext, \"utf8\", ENCODING);\n\t\tciphertext += cipher.final(ENCODING);\n\n\t\t// Get authentication tag\n\t\tconst authTag = cipher.getAuthTag();\n\n\t\t// Return format: iv:authTag:ciphertext (all base64)\n\t\treturn [\n\t\t\tiv.toString(ENCODING),\n\t\t\tauthTag.toString(ENCODING),\n\t\t\tciphertext,\n\t\t].join(\":\");\n\t} catch (error) {\n\t\tconsole.error(\"[Token Encryption] Encryption failed:\", error);\n\t\tthrow new Error(\"Failed to encrypt token\");\n\t}\n}\n\n/**\n * Decrypt a token (refresh token or access token)\n *\n * @param encrypted - Encrypted token string (format: iv:authTag:ciphertext)\n * @returns Decrypted plaintext token\n *\n * @example\n * const plaintext = decryptToken(\"rL8Kx2f...==:gH3pQ9...==:aB4cD5...\");\n * // Returns: \"ya29.a0AfH6SMB...\"\n */\nexport function decryptToken(encrypted: string): string {\n\ttry {\n\t\tconst key = getEncryptionKey();\n\n\t\t// Parse encrypted format: iv:authTag:ciphertext\n\t\tconst parts = encrypted.split(\":\");\n\t\tif (parts.length !== 3) {\n\t\t\tthrow new Error(\"Invalid encrypted token format\");\n\t\t}\n\n\t\tconst [ivBase64, authTagBase64, ciphertext] = parts;\n\n\t\t// Convert from base64\n\t\tconst iv = Buffer.from(ivBase64, ENCODING);\n\t\tconst authTag = Buffer.from(authTagBase64, ENCODING);\n\n\t\t// Verify lengths\n\t\tif (iv.length !== IV_LENGTH) {\n\t\t\tthrow new Error(\"Invalid IV length\");\n\t\t}\n\n\t\tif (authTag.length !== AUTH_TAG_LENGTH) {\n\t\t\tthrow new Error(\"Invalid auth tag length\");\n\t\t}\n\n\t\t// Create decipher\n\t\tconst decipher = crypto.createDecipheriv(ALGORITHM, key, iv);\n\t\tdecipher.setAuthTag(authTag);\n\n\t\t// Decrypt\n\t\tlet plaintext = decipher.update(ciphertext, ENCODING, \"utf8\");\n\t\tplaintext += decipher.final(\"utf8\");\n\n\t\treturn plaintext;\n\t} catch (error) {\n\t\tconsole.error(\"[Token Encryption] Decryption failed:\", error);\n\t\tthrow new Error(\"Failed to decrypt token\");\n\t}\n}\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\n/**\n * Check if encryption key is configured\n * @returns True if key is set and valid\n */\nexport function isEncryptionConfigured(): boolean {\n\ttry {\n\t\tgetEncryptionKey();\n\t\treturn true;\n\t} catch {\n\t\treturn false;\n\t}\n}\n\n/**\n * Test encryption/decryption round-trip\n * Useful for validating configuration\n *\n * @returns True if encryption works correctly\n */\nexport function testEncryption(): boolean {\n\ttry {\n\t\tconst testToken = \"test_token_\" + crypto.randomBytes(32).toString(\"hex\");\n\t\tconst encrypted = encryptToken(testToken);\n\t\tconst decrypted = decryptToken(encrypted);\n\n\t\treturn decrypted === testToken;\n\t} catch {\n\t\treturn false;\n\t}\n}\n\n/**\n * Migrate existing plaintext tokens to encrypted format\n *\n * IMPORTANT: Run this as a one-time migration script\n * DO NOT run in production without backup!\n *\n * @example\n * // In a migration script:\n * await migrateTokensToEncrypted();\n */\nexport async function migrateTokensToEncrypted() {\n\t// This would be implemented as a standalone migration script\n\t// NOT included here to prevent accidental execution\n\tconsole.warn(\n\t\t\"[Token Encryption] Migration must be run as standalone script\"\n\t);\n\tthrow new Error(\"Use standalone migration script\");\n}\n\n// =============================================================================\n// WRAPPER FUNCTIONS FOR BACKWARD COMPATIBILITY\n// =============================================================================\n\n/**\n * Encrypt token with fallback for dev/test environments\n *\n * If encryption key not configured, returns plaintext (dev only!)\n * Production should always have encryption key configured\n */\nexport function encryptTokenSafe(plaintext: string): string {\n\tif (!isEncryptionConfigured()) {\n\t\tconsole.warn(\n\t\t\t\"[Token Encryption] Encryption key not configured - storing plaintext (DEV ONLY)\"\n\t\t);\n\t\treturn plaintext;\n\t}\n\n\treturn encryptToken(plaintext);\n}\n\n/**\n * Decrypt token with fallback for migration period\n *\n * If decryption fails (likely plaintext), returns as-is\n * Allows gradual migration from plaintext to encrypted\n */\nexport function decryptTokenSafe(encrypted: string): string {\n\tif (!isEncryptionConfigured()) {\n\t\tconsole.warn(\n\t\t\t\"[Token Encryption] Encryption key not configured - returning plaintext (DEV ONLY)\"\n\t\t);\n\t\treturn encrypted;\n\t}\n\n\t// Check if token is already encrypted (contains colons)\n\tif (!encrypted.includes(\":\")) {\n\t\tconsole.warn(\n\t\t\t\"[Token Encryption] Token appears to be plaintext - returning as-is (MIGRATION MODE)\"\n\t\t);\n\t\treturn encrypted;\n\t}\n\n\ttry {\n\t\treturn decryptToken(encrypted);\n\t} catch (error) {\n\t\tconsole.error(\n\t\t\t\"[Token Encryption] Decryption failed, returning plaintext:\",\n\t\t\terror\n\t\t);\n\t\treturn encrypted;\n\t}\n}\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['react-rsc']!.ReactJsxRuntime\n","import { createServiceSupabaseClient } from \"@/lib/supabase/service-client\";\n\n/**\n * Pre-Send Email Deliverability Checks\n *\n * Comprehensive checks before sending any email:\n * 1. Suppression list check (bounces, complaints, unsubscribes)\n * 2. Domain verification status\n * 3. Content spam score analysis\n * 4. Reputation check\n * 5. Rate/volume considerations for warm-up\n */\n\nexport interface PreSendCheckResult {\n\tallowed: boolean;\n\twarnings: string[];\n\terrors: string[];\n\tsuggestions: string[];\n\tspamScore?: number;\n\trecipientStatus?: {\n\t\temail: string;\n\t\tsuppressed: boolean;\n\t\treason?: string;\n\t}[];\n}\n\n// Spam trigger words and patterns\nconst SPAM_TRIGGERS = {\n\turgency: [\n\t\t\"act now\",\n\t\t\"limited time\",\n\t\t\"urgent\",\n\t\t\"immediate\",\n\t\t\"expires\",\n\t\t\"hurry\",\n\t\t\"don't miss\",\n\t\t\"last chance\",\n\t\t\"final notice\",\n\t\t\"deadline\",\n\t],\n\tmoney: [\n\t\t\"free\",\n\t\t\"$$$\",\n\t\t\"cash\",\n\t\t\"discount\",\n\t\t\"save big\",\n\t\t\"best price\",\n\t\t\"cheap\",\n\t\t\"bargain\",\n\t\t\"bonus\",\n\t\t\"prize\",\n\t\t\"winner\",\n\t\t\"congratulations\",\n\t],\n\tsuspicious: [\n\t\t\"click here\",\n\t\t\"click below\",\n\t\t\"buy now\",\n\t\t\"order now\",\n\t\t\"subscribe now\",\n\t\t\"sign up free\",\n\t\t\"no obligation\",\n\t\t\"risk free\",\n\t\t\"100% free\",\n\t\t\"act immediately\",\n\t],\n\tformatting: [\n\t\t\"ALL CAPS WORDS\",\n\t\t\"!!!\",\n\t\t\"???\",\n\t\t\"$$$\",\n\t\t\"***\",\n\t\t\"###\",\n\t],\n};\n\n// Weight multipliers for spam scoring\nconst SPAM_WEIGHTS = {\n\turgency: 2,\n\tmoney: 3,\n\tsuspicious: 4,\n\tformatting: 1.5,\n\texcessiveLinks: 5,\n\tnoUnsubscribe: 3,\n\tshortContent: 2,\n\timageHeavy: 3,\n};\n\n/**\n * Check if recipient is on suppression list (bounces, complaints, unsubscribes)\n */\nexport async function checkSuppressionList(\n\tcompanyId: string,\n\trecipientEmails: string[]\n): Promise<Map<string, { suppressed: boolean; reason?: string; suppressedAt?: string }>> {\n\tconst supabase = await createServiceSupabaseClient();\n\tconst results = new Map<string, { suppressed: boolean; reason?: string; suppressedAt?: string }>();\n\n\t// Initialize all as not suppressed\n\tfor (const email of recipientEmails) {\n\t\tresults.set(email.toLowerCase(), { suppressed: false });\n\t}\n\n\t// Check suppression list\n\tconst { data: suppressions } = await supabase\n\t\t.from(\"email_suppressions\")\n\t\t.select(\"email, reason, created_at\")\n\t\t.eq(\"company_id\", companyId)\n\t\t.in(\"email\", recipientEmails.map((e) => e.toLowerCase()));\n\n\tif (suppressions) {\n\t\tfor (const suppression of suppressions) {\n\t\t\tresults.set(suppression.email, {\n\t\t\t\tsuppressed: true,\n\t\t\t\treason: suppression.reason,\n\t\t\t\tsuppressedAt: suppression.created_at,\n\t\t\t});\n\t\t}\n\t}\n\n\t// Also check global hard bounces (cross-company)\n\tconst { data: globalBounces } = await supabase\n\t\t.from(\"email_global_bounces\")\n\t\t.select(\"email, bounce_type, created_at\")\n\t\t.in(\"email\", recipientEmails.map((e) => e.toLowerCase()))\n\t\t.eq(\"bounce_type\", \"hard\");\n\n\tif (globalBounces) {\n\t\tfor (const bounce of globalBounces) {\n\t\t\tconst existing = results.get(bounce.email);\n\t\t\tif (!existing?.suppressed) {\n\t\t\t\tresults.set(bounce.email, {\n\t\t\t\t\tsuppressed: true,\n\t\t\t\t\treason: `Global hard bounce: ${bounce.bounce_type}`,\n\t\t\t\t\tsuppressedAt: bounce.created_at,\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn results;\n}\n\n/**\n * Calculate spam score for email content\n * Lower is better: 0-30 = good, 30-60 = warning, 60+ = likely spam\n */\nexport function calculateSpamScore(\n\tsubject: string,\n\thtmlContent: string,\n\ttextContent: string,\n\thasUnsubscribeLink: boolean\n): { score: number; issues: string[] } {\n\tlet score = 0;\n\tconst issues: string[] = [];\n\n\tconst fullText = `${subject} ${textContent}`.toLowerCase();\n\tconst htmlLower = htmlContent.toLowerCase();\n\n\t// Check spam trigger words\n\tfor (const [category, words] of Object.entries(SPAM_TRIGGERS)) {\n\t\tconst weight = SPAM_WEIGHTS[category as keyof typeof SPAM_WEIGHTS] || 1;\n\t\tfor (const word of words) {\n\t\t\tconst regex = new RegExp(word.toLowerCase(), \"gi\");\n\t\t\tconst matches = fullText.match(regex);\n\t\t\tif (matches) {\n\t\t\t\tscore += matches.length * weight;\n\t\t\t\tif (matches.length > 1) {\n\t\t\t\t\tissues.push(`Contains \"${word}\" ${matches.length} times`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// Check for ALL CAPS in subject\n\tconst capsWords = subject.split(\" \").filter((w) => w.length > 3 && w === w.toUpperCase());\n\tif (capsWords.length > 0) {\n\t\tscore += capsWords.length * 3;\n\t\tissues.push(`Subject contains ${capsWords.length} ALL CAPS words`);\n\t}\n\n\t// Check excessive punctuation\n\tconst exclamations = (subject.match(/!/g) || []).length;\n\tif (exclamations > 1) {\n\t\tscore += exclamations * 2;\n\t\tissues.push(`Excessive exclamation marks in subject (${exclamations})`);\n\t}\n\n\t// Check link density\n\tconst links = (htmlLower.match(/<a\\s/gi) || []).length;\n\tconst wordCount = textContent.split(/\\s+/).length;\n\tif (wordCount > 0 && links / wordCount > 0.1) {\n\t\tscore += SPAM_WEIGHTS.excessiveLinks;\n\t\tissues.push(`High link density (${links} links in ${wordCount} words)`);\n\t}\n\n\t// Check image-to-text ratio\n\tconst images = (htmlLower.match(/<img\\s/gi) || []).length;\n\tif (images > 0 && textContent.length < 200) {\n\t\tscore += SPAM_WEIGHTS.imageHeavy;\n\t\tissues.push(\"Image-heavy email with little text\");\n\t}\n\n\t// Check for unsubscribe link\n\tif (!hasUnsubscribeLink) {\n\t\tscore += SPAM_WEIGHTS.noUnsubscribe;\n\t\tissues.push(\"Missing unsubscribe link (required for marketing emails)\");\n\t}\n\n\t// Check content length (very short emails look suspicious)\n\tif (textContent.length < 50) {\n\t\tscore += SPAM_WEIGHTS.shortContent;\n\t\tissues.push(\"Very short email content\");\n\t}\n\n\t// Check for suspicious patterns\n\tif (htmlLower.includes(\"display:none\") || htmlLower.includes(\"font-size:0\")) {\n\t\tscore += 10;\n\t\tissues.push(\"Contains hidden text (spam technique)\");\n\t}\n\n\t// Check for deceptive link text\n\tconst deceptiveLinkPattern = /<a[^>]*href=[\"']([^\"']+)[\"'][^>]*>([^<]+)<\\/a>/gi;\n\tlet match;\n\twhile ((match = deceptiveLinkPattern.exec(htmlContent)) !== null) {\n\t\tconst href = match[1].toLowerCase();\n\t\tconst text = match[2].toLowerCase();\n\t\tif (\n\t\t\ttext.includes(\"click here\") ||\n\t\t\ttext.includes(\"click this\") ||\n\t\t\t(text.startsWith(\"http\") && !text.includes(new URL(href).hostname))\n\t\t) {\n\t\t\tscore += 5;\n\t\t\tissues.push(\"Contains deceptive or vague link text\");\n\t\t\tbreak;\n\t\t}\n\t}\n\n\treturn { score: Math.min(score, 100), issues };\n}\n\n/**\n * Check domain warm-up status and recommend volume\n */\nexport async function checkDomainWarmup(\n\tdomainId: string\n): Promise<{\n\tinWarmup: boolean;\n\tdaysSinceCreation: number;\n\trecommendedDailyLimit: number;\n\tcurrentDaySent: number;\n\tsuggestions: string[];\n}> {\n\tconst supabase = await createServiceSupabaseClient();\n\n\tconst { data: domain } = await supabase\n\t\t.from(\"company_email_domains\")\n\t\t.select(\"created_at, emails_sent_today, total_emails_sent, warmup_completed\")\n\t\t.eq(\"id\", domainId)\n\t\t.single();\n\n\tif (!domain) {\n\t\treturn {\n\t\t\tinWarmup: true,\n\t\t\tdaysSinceCreation: 0,\n\t\t\trecommendedDailyLimit: 10,\n\t\t\tcurrentDaySent: 0,\n\t\t\tsuggestions: [\"Domain not found\"],\n\t\t};\n\t}\n\n\tconst createdAt = new Date(domain.created_at);\n\tconst now = new Date();\n\tconst daysSinceCreation = Math.floor((now.getTime() - createdAt.getTime()) / (1000 * 60 * 60 * 24));\n\n\t// Warm-up schedule (days -> max emails per day)\n\t// Gradual increase over 4-6 weeks for best deliverability\n\tconst warmupSchedule: Record<number, number> = {\n\t\t0: 20, // Day 0-1: 20 emails\n\t\t2: 50, // Day 2-3: 50 emails\n\t\t4: 100, // Day 4-6: 100 emails\n\t\t7: 200, // Week 2: 200 emails\n\t\t14: 500, // Week 3: 500 emails\n\t\t21: 1000, // Week 4: 1000 emails\n\t\t28: 2500, // Week 5: 2500 emails\n\t\t35: 5000, // Week 6: 5000 emails\n\t\t42: 10000, // Week 7+: 10000 emails\n\t};\n\n\tlet recommendedLimit = 20;\n\tfor (const [day, limit] of Object.entries(warmupSchedule)) {\n\t\tif (daysSinceCreation >= parseInt(day)) {\n\t\t\trecommendedLimit = limit;\n\t\t}\n\t}\n\n\tconst inWarmup = daysSinceCreation < 42 && !domain.warmup_completed;\n\tconst suggestions: string[] = [];\n\n\tif (inWarmup) {\n\t\tsuggestions.push(\n\t\t\t`Domain is in warm-up period (day ${daysSinceCreation}/42). Recommended daily limit: ${recommendedLimit} emails.`\n\t\t);\n\n\t\tif (domain.emails_sent_today >= recommendedLimit * 0.8) {\n\t\t\tsuggestions.push(\n\t\t\t\t\"Approaching daily warm-up limit. Consider spreading sends across multiple days.\"\n\t\t\t);\n\t\t}\n\t}\n\n\treturn {\n\t\tinWarmup,\n\t\tdaysSinceCreation,\n\t\trecommendedDailyLimit: recommendedLimit,\n\t\tcurrentDaySent: domain.emails_sent_today || 0,\n\t\tsuggestions,\n\t};\n}\n\n/**\n * Verify domain is properly configured for sending\n */\nexport async function verifyDomainStatus(\n\tdomainId: string\n): Promise<{\n\tcanSend: boolean;\n\tissues: string[];\n\tdnsStatus: {\n\t\tspf: boolean;\n\t\tdkim: boolean;\n\t\tdmarc: boolean;\n\t};\n}> {\n\tconst supabase = await createServiceSupabaseClient();\n\n\tconst { data: domain } = await supabase\n\t\t.from(\"company_email_domains\")\n\t\t.select(\"status, is_suspended, sending_enabled, spf_verified, dkim_verified, dmarc_verified\")\n\t\t.eq(\"id\", domainId)\n\t\t.single();\n\n\tif (!domain) {\n\t\treturn {\n\t\t\tcanSend: false,\n\t\t\tissues: [\"Domain not found\"],\n\t\t\tdnsStatus: { spf: false, dkim: false, dmarc: false },\n\t\t};\n\t}\n\n\tconst issues: string[] = [];\n\n\tif (domain.status !== \"verified\") {\n\t\tissues.push(`Domain not verified (status: ${domain.status})`);\n\t}\n\n\tif (domain.is_suspended) {\n\t\tissues.push(\"Domain is suspended\");\n\t}\n\n\tif (!domain.sending_enabled) {\n\t\tissues.push(\"Sending is disabled for this domain\");\n\t}\n\n\tif (!domain.spf_verified) {\n\t\tissues.push(\"SPF record not verified - emails may fail authentication\");\n\t}\n\n\tif (!domain.dkim_verified) {\n\t\tissues.push(\"DKIM not verified - emails may fail authentication\");\n\t}\n\n\tif (!domain.dmarc_verified) {\n\t\tissues.push(\"DMARC not configured - reduces deliverability\");\n\t}\n\n\treturn {\n\t\tcanSend: issues.length === 0,\n\t\tissues,\n\t\tdnsStatus: {\n\t\t\tspf: domain.spf_verified || false,\n\t\t\tdkim: domain.dkim_verified || false,\n\t\t\tdmarc: domain.dmarc_verified || false,\n\t\t},\n\t};\n}\n\n/**\n * Comprehensive pre-send check combining all validations\n */\nexport async function runPreSendChecks(\n\tcompanyId: string,\n\tdomainId: string,\n\trecipientEmails: string[],\n\tsubject: string,\n\thtmlContent: string,\n\ttextContent: string,\n\tisMarketingEmail: boolean = false\n): Promise<PreSendCheckResult> {\n\tconst warnings: string[] = [];\n\tconst errors: string[] = [];\n\tconst suggestions: string[] = [];\n\n\t// 1. Check domain status\n\tconst domainStatus = await verifyDomainStatus(domainId);\n\tif (!domainStatus.canSend) {\n\t\terrors.push(...domainStatus.issues);\n\t} else {\n\t\t// Add warnings for missing DNS records\n\t\tif (!domainStatus.dnsStatus.dmarc) {\n\t\t\twarnings.push(\"DMARC not configured - consider adding for better deliverability\");\n\t\t}\n\t}\n\n\t// 2. Check suppression list\n\tconst suppressions = await checkSuppressionList(companyId, recipientEmails);\n\tconst recipientStatus: PreSendCheckResult[\"recipientStatus\"] = [];\n\tlet suppressedCount = 0;\n\n\tfor (const [email, status] of suppressions) {\n\t\trecipientStatus.push({\n\t\t\temail,\n\t\t\tsuppressed: status.suppressed,\n\t\t\treason: status.reason,\n\t\t});\n\t\tif (status.suppressed) {\n\t\t\tsuppressedCount++;\n\t\t}\n\t}\n\n\tif (suppressedCount > 0) {\n\t\twarnings.push(\n\t\t\t`${suppressedCount} recipient(s) on suppression list and will be skipped`\n\t\t);\n\t}\n\n\tif (suppressedCount === recipientEmails.length) {\n\t\terrors.push(\"All recipients are on suppression list - no emails will be sent\");\n\t}\n\n\t// 3. Calculate spam score\n\tconst hasUnsubscribe =\n\t\thtmlContent.includes(\"unsubscribe\") ||\n\t\thtmlContent.includes(\"List-Unsubscribe\");\n\tconst spamAnalysis = calculateSpamScore(\n\t\tsubject,\n\t\thtmlContent,\n\t\ttextContent,\n\t\thasUnsubscribe || !isMarketingEmail\n\t);\n\n\tif (spamAnalysis.score >= 60) {\n\t\terrors.push(\n\t\t\t`High spam score (${spamAnalysis.score}/100) - email likely to be filtered`\n\t\t);\n\t\terrors.push(...spamAnalysis.issues);\n\t} else if (spamAnalysis.score >= 30) {\n\t\twarnings.push(\n\t\t\t`Moderate spam score (${spamAnalysis.score}/100) - consider improvements`\n\t\t);\n\t\twarnings.push(...spamAnalysis.issues);\n\t}\n\n\t// 4. Check warm-up status\n\tconst warmupStatus = await checkDomainWarmup(domainId);\n\tif (warmupStatus.inWarmup) {\n\t\tsuggestions.push(...warmupStatus.suggestions);\n\n\t\tconst activeRecipients = recipientEmails.length - suppressedCount;\n\t\tconst remainingCapacity =\n\t\t\twarmupStatus.recommendedDailyLimit - warmupStatus.currentDaySent;\n\n\t\tif (activeRecipients > remainingCapacity) {\n\t\t\twarnings.push(\n\t\t\t\t`Sending ${activeRecipients} emails exceeds warm-up limit (${remainingCapacity} remaining today). ` +\n\t\t\t\t\t`Consider sending over multiple days.`\n\t\t\t);\n\t\t}\n\t}\n\n\t// 5. Content-specific suggestions\n\tif (!htmlContent.includes(\"<!DOCTYPE\") && !htmlContent.includes(\"<html\")) {\n\t\tsuggestions.push(\n\t\t\t\"Consider using proper HTML structure with DOCTYPE for better rendering\"\n\t\t);\n\t}\n\n\tif (textContent.length < 100) {\n\t\tsuggestions.push(\n\t\t\t\"Consider adding more text content - very short emails may look suspicious\"\n\t\t);\n\t}\n\n\tif (isMarketingEmail && !hasUnsubscribe) {\n\t\terrors.push(\n\t\t\t\"Marketing emails MUST include an unsubscribe link (CAN-SPAM requirement)\"\n\t\t);\n\t}\n\n\t// Check for personalization\n\tif (\n\t\t!htmlContent.includes(\"{{\") &&\n\t\t!htmlContent.includes(\"{name}\") &&\n\t\t!subject.includes(\"{{\")\n\t) {\n\t\tsuggestions.push(\n\t\t\t\"Consider adding personalization (recipient name, company) for better engagement\"\n\t\t);\n\t}\n\n\treturn {\n\t\tallowed: errors.length === 0,\n\t\twarnings,\n\t\terrors,\n\t\tsuggestions,\n\t\tspamScore: spamAnalysis.score,\n\t\trecipientStatus,\n\t};\n}\n\n/**\n * Add email to suppression list\n */\nexport async function addToSuppressionList(\n\tcompanyId: string,\n\temail: string,\n\treason: \"bounce\" | \"complaint\" | \"unsubscribe\" | \"manual\",\n\tdetails?: string\n): Promise<{ success: boolean; error?: string }> {\n\tconst supabase = await createServiceSupabaseClient();\n\n\tconst { error } = await supabase.from(\"email_suppressions\").upsert(\n\t\t{\n\t\t\tcompany_id: companyId,\n\t\t\temail: email.toLowerCase(),\n\t\t\treason,\n\t\t\tdetails,\n\t\t\tcreated_at: new Date().toISOString(),\n\t\t},\n\t\t{\n\t\t\tonConflict: \"company_id,email\",\n\t\t}\n\t);\n\n\tif (error) {\n\t\tconsole.error(\"Error adding to suppression list:\", error);\n\t\treturn { success: false, error: error.message };\n\t}\n\n\treturn { success: true };\n}\n\n/**\n * Add email to global bounce list (cross-company hard bounces)\n */\nexport async function addToGlobalBounceList(\n\temail: string,\n\tbounceType: \"hard\" | \"soft\",\n\tbounceReason?: string\n): Promise<{ success: boolean; error?: string }> {\n\t// Only track hard bounces globally\n\tif (bounceType !== \"hard\") {\n\t\treturn { success: true };\n\t}\n\n\tconst supabase = await createServiceSupabaseClient();\n\n\tconst { error } = await supabase.from(\"email_global_bounces\").upsert(\n\t\t{\n\t\t\temail: email.toLowerCase(),\n\t\t\tbounce_type: bounceType,\n\t\t\tbounce_reason: bounceReason,\n\t\t\tbounce_count: 1,\n\t\t\tlast_bounce_at: new Date().toISOString(),\n\t\t\tcreated_at: new Date().toISOString(),\n\t\t},\n\t\t{\n\t\t\tonConflict: \"email\",\n\t\t}\n\t);\n\n\tif (error) {\n\t\tconsole.error(\"Error adding to global bounce list:\", error);\n\t\treturn { success: false, error: error.message };\n\t}\n\n\treturn { success: true };\n}\n\n/**\n * Remove email from suppression list (for manual review cases)\n */\nexport async function removeFromSuppressionList(\n\tcompanyId: string,\n\temail: string\n): Promise<{ success: boolean; error?: string }> {\n\tconst supabase = await createServiceSupabaseClient();\n\n\tconst { error } = await supabase\n\t\t.from(\"email_suppressions\")\n\t\t.delete()\n\t\t.eq(\"company_id\", companyId)\n\t\t.eq(\"email\", email.toLowerCase());\n\n\tif (error) {\n\t\tconsole.error(\"Error removing from suppression list:\", error);\n\t\treturn { success: false, error: error.message };\n\t}\n\n\treturn { success: true };\n}\n\n/**\n * Get suppression list for a company\n */\nexport async function getSuppressionList(\n\tcompanyId: string,\n\tlimit: number = 100,\n\toffset: number = 0\n): Promise<{\n\tdata: Array<{\n\t\temail: string;\n\t\treason: string;\n\t\tdetails?: string;\n\t\tcreated_at: string;\n\t}>;\n\ttotal: number;\n}> {\n\tconst supabase = await createServiceSupabaseClient();\n\n\tconst { data, count, error } = await supabase\n\t\t.from(\"email_suppressions\")\n\t\t.select(\"email, reason, details, created_at\", { count: \"exact\" })\n\t\t.eq(\"company_id\", companyId)\n\t\t.order(\"created_at\", { ascending: false })\n\t\t.range(offset, offset + limit - 1);\n\n\tif (error) {\n\t\tconsole.error(\"Error fetching suppression list:\", error);\n\t\treturn { data: [], total: 0 };\n\t}\n\n\treturn { data: data || [], total: count || 0 };\n}\n","/**\n * Email Button Component - Matches dashboard button design\n *\n * Design:\n * - Primary variant with Thorbis Electric Blue\n * - Outline variant for secondary actions\n * - Responsive and accessible\n * - Supports both link and button styles\n */\n\nimport { Button as EmailButton } from \"@react-email/components\";\nimport { EMAIL_COLORS } from \"../theme\";\n\ntype ButtonProps = {\n\thref: string;\n\tchildren: React.ReactNode;\n\tvariant?: \"primary\" | \"outline\";\n};\n\nexport function Button({ href, children, variant = \"primary\" }: ButtonProps) {\n\tconst baseStyle = {\n\t\tdisplay: \"inline-block\",\n\t\tpadding: \"12px 24px\",\n\t\tfontSize: \"16px\",\n\t\tfontWeight: \"600\",\n\t\ttextDecoration: \"none\",\n\t\tborderRadius: \"8px\",\n\t\ttextAlign: \"center\" as const,\n\t\ttransition: \"all 0.2s ease\",\n\t};\n\n\tconst variantStyles = {\n\t\tprimary: {\n\t\t\tbackgroundColor: EMAIL_COLORS.primary, // Thorbis Electric Blue\n\t\t\tcolor: EMAIL_COLORS.primaryText,\n\t\t\tborder: \"none\",\n\t\t},\n\t\toutline: {\n\t\t\tbackgroundColor: \"transparent\",\n\t\t\tcolor: EMAIL_COLORS.primary,\n\t\t\tborder: `2px solid ${EMAIL_COLORS.primary}`,\n\t\t},\n\t};\n\n\treturn (\n\t\t<EmailButton\n\t\t\thref={href}\n\t\t\tstyle={{\n\t\t\t\t...baseStyle,\n\t\t\t\t...variantStyles[variant],\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</EmailButton>\n\t);\n}\n","/**\n * Email Card Component - Information card matching dashboard cards\n *\n * Design:\n * - Clean white background with subtle border\n * - Rounded corners\n * - Padding for content spacing\n * - Optional header and footer sections\n */\n\nimport { Section, Text } from \"@react-email/components\";\nimport type { ReactNode } from \"react\";\nimport { EMAIL_COLORS } from \"../theme\";\n\ntype CardProps = {\n\tchildren: ReactNode;\n\ttitle?: string;\n\tstyle?: React.CSSProperties;\n};\n\nexport function Card({ children, title, style }: CardProps) {\n\treturn (\n\t\t<Section\n\t\t\tstyle={{\n\t\t\t\t...cardStyle,\n\t\t\t\t...style,\n\t\t\t}}\n\t\t>\n\t\t\t{title && <Text style={titleStyle}>{title}</Text>}\n\t\t\t{children}\n\t\t</Section>\n\t);\n}\n\nconst cardStyle = {\n\tbackgroundColor: EMAIL_COLORS.surface,\n\tborder: `1px solid ${EMAIL_COLORS.border}`,\n\tborderRadius: \"8px\",\n\tpadding: \"24px\",\n\tmargin: \"16px 0\",\n};\n\nconst titleStyle = {\n\tfontSize: \"18px\",\n\tfontWeight: \"600\",\n\tcolor: EMAIL_COLORS.heading,\n\tmargin: \"0 0 16px 0\",\n};\n","export const EMAIL_COLORS = {\n\tbackground: \"#fafafa\",\n\tsurface: \"#fcfcfc\",\n\tsurfaceStrong: \"#f2f2f2\",\n\tprimary: \"#3c6ff5\",\n\tprimaryText: \"#fafafa\",\n\theading: \"#171717\",\n\ttext: \"#171717\",\n\tmuted: \"#737373\",\n\tborder: \"#e6e6e6\",\n};\n","/**\n * Email Heading Component - Typography for email headings\n *\n * Design:\n * - H1, H2, H3 variants\n * - Matches dashboard typography\n * - Proper spacing and hierarchy\n */\n\nimport { Heading as EmailHeading } from \"@react-email/components\";\nimport { EMAIL_COLORS } from \"../theme\";\n\ntype HeadingProps = {\n\tchildren: React.ReactNode;\n\tlevel?: 1 | 2 | 3;\n\tstyle?: React.CSSProperties;\n};\n\nexport function Heading({ children, level = 1, style }: HeadingProps) {\n\tconst headingTag = `h${level}` as \"h1\" | \"h2\" | \"h3\";\n\tconst headingStyles = {\n\t\t1: {\n\t\t\tfontSize: \"32px\",\n\t\t\tfontWeight: \"700\",\n\t\t\tcolor: EMAIL_COLORS.heading,\n\t\t\tmargin: \"0 0 16px 0\",\n\t\t\tlineHeight: \"1.2\",\n\t\t},\n\t\t2: {\n\t\t\tfontSize: \"24px\",\n\t\t\tfontWeight: \"600\",\n\t\t\tcolor: EMAIL_COLORS.text,\n\t\t\tmargin: \"0 0 12px 0\",\n\t\t\tlineHeight: \"1.3\",\n\t\t},\n\t\t3: {\n\t\t\tfontSize: \"18px\",\n\t\t\tfontWeight: \"600\",\n\t\t\tcolor: EMAIL_COLORS.muted,\n\t\t\tmargin: \"0 0 8px 0\",\n\t\t\tlineHeight: \"1.4\",\n\t\t},\n\t};\n\n\treturn (\n\t\t<EmailHeading\n\t\t\tas={headingTag}\n\t\t\tstyle={{\n\t\t\t\t...headingStyles[level],\n\t\t\t\t...style,\n\t\t\t}}\n\t\t>\n\t\t\t{children}\n\t\t</EmailHeading>\n\t);\n}\n","/**\n * Thorbis-Branded Email Layout\n *\n * For platform/system emails:\n * - Clean, full-width design (no cards)\n * - Thorbis logo image from CDN/env\n * - Thorbis Electric Blue branding\n * - Professional footer with Thorbis info\n *\n * Uses environment variables for:\n * - Logo URL\n * - App URL\n * - Support email\n * - Company info\n */\n\nimport {\n\tBody,\n\tContainer,\n\tHead,\n\tHr,\n\tHtml,\n\tImg,\n\tLink,\n\tPreview,\n\tSection,\n\tText,\n} from \"@react-email/components\";\nimport type { ReactNode } from \"react\";\nimport { EMAIL_COLORS } from \"../theme\";\n\ntype BaseLayoutProps = {\n\tchildren: ReactNode;\n\tpreviewText?: string;\n};\n\n// Environment-based configuration\nconst THORBIS_LOGO_URL =\n\tprocess.env.NEXT_PUBLIC_THORBIS_LOGO_URL ||\n\t\"https://thorbis.com/logo-white.png\";\nconst THORBIS_APP_URL =\n\tprocess.env.NEXT_PUBLIC_APP_URL || \"https://app.thorbis.com\";\nconst THORBIS_WEBSITE =\n\tprocess.env.NEXT_PUBLIC_WEBSITE_URL || \"https://thorbis.com\";\nconst THORBIS_SUPPORT_EMAIL =\n\tprocess.env.THORBIS_SUPPORT_EMAIL || \"support@thorbis.com\";\nconst THORBIS_DOCS_URL = `${THORBIS_WEBSITE}/docs`;\nconst THORBIS_PRIVACY_URL = `${THORBIS_WEBSITE}/privacy`;\nconst THORBIS_TERMS_URL = `${THORBIS_WEBSITE}/terms`;\n\nexport function BaseLayout({ children, previewText }: BaseLayoutProps) {\n\treturn (\n\t\t<Html>\n\t\t\t<Head>\n\t\t\t\t<style>{`\n          @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\n\n          /* Reset email client styles */\n          body { margin: 0; padding: 0; }\n          table { border-collapse: collapse; }\n          img { border: 0; }\n\n          /* Responsive */\n          @media only screen and (max-width: 600px) {\n            .mobile-padding { padding: 20px !important; }\n            .mobile-text { font-size: 14px !important; }\n            .mobile-heading { font-size: 24px !important; }\n          }\n        `}</style>\n\t\t\t</Head>\n\t\t\t{previewText && <Preview>{previewText}</Preview>}\n\t\t\t<Body style={main}>\n\t\t\t\t<Container style={container}>\n\t\t\t\t\t{/* Header with Thorbis logo on blue background */}\n\t\t\t\t\t<Section style={header}>\n\t\t\t\t\t\t<Img\n\t\t\t\t\t\t\tsrc={THORBIS_LOGO_URL}\n\t\t\t\t\t\t\talt=\"Thorbis\"\n\t\t\t\t\t\t\twidth=\"160\"\n\t\t\t\t\t\t\theight=\"40\"\n\t\t\t\t\t\t\tstyle={logo}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Section>\n\n\t\t\t\t\t{/* Main content - full width, no cards */}\n\t\t\t\t\t<Section style={content} className=\"mobile-padding\">\n\t\t\t\t\t\t{children}\n\t\t\t\t\t</Section>\n\n\t\t\t\t\t{/* Divider */}\n\t\t\t\t\t<Hr style={divider} />\n\n\t\t\t\t\t{/* Footer */}\n\t\t\t\t\t<Section style={footer} className=\"mobile-padding\">\n\t\t\t\t\t\t{/* Support Links */}\n\t\t\t\t\t\t<Text style={footerText}>\n\t\t\t\t\t\t\tNeed help?{\" \"}\n\t\t\t\t\t\t\t<Link href={`mailto:${THORBIS_SUPPORT_EMAIL}`} style={footerLink}>\n\t\t\t\t\t\t\t\tContact Support\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t{\" • \"}\n\t\t\t\t\t\t\t<Link href={THORBIS_DOCS_URL} style={footerLink}>\n\t\t\t\t\t\t\t\tDocumentation\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</Text>\n\n\t\t\t\t\t\t{/* Legal Links */}\n\t\t\t\t\t\t<Text style={footerText}>\n\t\t\t\t\t\t\t<Link href={THORBIS_PRIVACY_URL} style={footerLink}>\n\t\t\t\t\t\t\t\tPrivacy Policy\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t{\" • \"}\n\t\t\t\t\t\t\t<Link href={THORBIS_TERMS_URL} style={footerLink}>\n\t\t\t\t\t\t\t\tTerms of Service\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</Text>\n\n\t\t\t\t\t\t{/* Company Info */}\n\t\t\t\t\t\t<Text style={footerCopyright}>\n\t\t\t\t\t\t\t© {new Date().getFullYear()} Thorbis. All rights reserved.\n\t\t\t\t\t\t</Text>\n\n\t\t\t\t\t\t<Text style={footerAddress}>\n\t\t\t\t\t\t\tThorbis • 123 Innovation Drive, San Francisco, CA 94105\n\t\t\t\t\t\t</Text>\n\n\t\t\t\t\t\t{/* Unsubscribe - required for CAN-SPAM compliance */}\n\t\t\t\t\t\t<Text style={footerUnsubscribe}>\n\t\t\t\t\t\t\tYou're receiving this email because you have an account with\n\t\t\t\t\t\t\tThorbis.{\" \"}\n\t\t\t\t\t\t\t<Link href=\"{{unsubscribe_url}}\" style={footerLink}>\n\t\t\t\t\t\t\t\tUnsubscribe from marketing emails\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t</Text>\n\t\t\t\t\t</Section>\n\t\t\t\t</Container>\n\t\t\t</Body>\n\t\t</Html>\n\t);\n}\n\n// Styles - Clean, full-width design\nconst main = {\n\tbackgroundColor: EMAIL_COLORS.background,\n\tfontFamily:\n\t\t'Inter, -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n\tWebkitFontSmoothing: \"antialiased\" as const,\n\tMozOsxFontSmoothing: \"grayscale\" as const,\n};\n\nconst container = {\n\tbackgroundColor: EMAIL_COLORS.surface,\n\tmaxWidth: \"600px\",\n\tmargin: \"0 auto\",\n};\n\nconst header = {\n\tbackgroundColor: EMAIL_COLORS.primary, // Thorbis Electric Blue\n\tpadding: \"40px 0\",\n\ttextAlign: \"center\" as const,\n};\n\nconst logo = {\n\tmargin: \"0 auto\",\n\tdisplay: \"block\",\n};\n\nconst content = {\n\tpadding: \"48px 40px\",\n\tcolor: EMAIL_COLORS.text,\n\tfontSize: \"16px\",\n\tlineHeight: \"24px\",\n};\n\nconst divider = {\n\tborderColor: EMAIL_COLORS.border,\n\tborderWidth: \"1px\",\n\tmargin: \"0\",\n};\n\nconst footer = {\n\tpadding: \"32px 40px\",\n\ttextAlign: \"center\" as const,\n\tbackgroundColor: EMAIL_COLORS.surfaceStrong,\n};\n\nconst footerText = {\n\tcolor: EMAIL_COLORS.muted,\n\tfontSize: \"14px\",\n\tlineHeight: \"24px\",\n\tmargin: \"8px 0\",\n};\n\nconst footerLink = {\n\tcolor: EMAIL_COLORS.primary,\n\ttextDecoration: \"none\",\n\tfontWeight: \"500\",\n};\n\nconst footerCopyright = {\n\tcolor: EMAIL_COLORS.muted,\n\tfontSize: \"13px\",\n\tmargin: \"16px 0 0 0\",\n\tfontWeight: \"600\",\n};\n\nconst footerAddress = {\n\tcolor: EMAIL_COLORS.muted,\n\tfontSize: \"12px\",\n\tmargin: \"8px 0\",\n};\n\nconst footerUnsubscribe = {\n\tcolor: EMAIL_COLORS.muted,\n\tfontSize: \"11px\",\n\tmargin: \"16px 0 0 0\",\n\tlineHeight: \"18px\",\n};\n"],"names":["module","exports","require","vendored","ReactJsxRuntime"],"mappings":"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","ignoreList":[1]}