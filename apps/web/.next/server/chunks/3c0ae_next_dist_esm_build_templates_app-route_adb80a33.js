module.exports=[129950,e=>{"use strict";var r=e.i(755535),t=e.i(377233),a=e.i(490003),i=e.i(492991),s=e.i(241970),n=e.i(357699),o=e.i(212454),l=e.i(48717),c=e.i(798301),u=e.i(986366),p=e.i(983537),d=e.i(147475),m=e.i(561930),h=e.i(803747),g=e.i(368557),k=e.i(42037),y=e.i(193695);e.i(432036);var w=e.i(573881),f=e.i(297676);let b={walkers_paradise:{min:90,max:100,description:"Walker's Paradise",summary:"Daily errands do not require a car"},very_walkable:{min:70,max:89,description:"Very Walkable",summary:"Most errands can be accomplished on foot"},somewhat_walkable:{min:50,max:69,description:"Somewhat Walkable",summary:"Some errands can be accomplished on foot"},car_dependent_some:{min:25,max:49,description:"Car-Dependent",summary:"Most errands require a car"},car_dependent_all:{min:0,max:24,description:"Car-Dependent",summary:"Almost all errands require a car"}},v={excellent:{min:90,max:100,description:"Excellent Transit",summary:"Convenient for most trips"},great:{min:70,max:89,description:"Excellent Transit",summary:"Many nearby public transportation options"},good:{min:50,max:69,description:"Good Transit",summary:"Many nearby public transportation options"},some:{min:25,max:49,description:"Some Transit",summary:"A few public transportation options"},minimal:{min:0,max:24,description:"Minimal Transit",summary:"Few or no public transportation options"}},S={paradise:{min:90,max:100,description:"Biker's Paradise",summary:"Daily errands can be accomplished on a bike"},excellent:{min:70,max:89,description:"Very Bikeable",summary:"Biking is convenient for most trips"},bikeable:{min:50,max:69,description:"Bikeable",summary:"Some bike infrastructure"},minimal:{min:0,max:49,description:"Minimal Bike Infrastructure",summary:"Minimal bike infrastructure"}},R=new class{apiKey;baseUrl="https://api.walkscore.com";constructor(){this.apiKey=process.env.WALK_SCORE_API_KEY||""}async getWalkScore(e,r,t){if(!this.apiKey)return console.error("Walk Score API key not configured"),null;try{let a=new URL(`${this.baseUrl}/score`);a.searchParams.set("format","json"),a.searchParams.set("address",e),a.searchParams.set("wsapikey",this.apiKey),void 0!==r&&void 0!==t&&(a.searchParams.set("lat",r.toString()),a.searchParams.set("lon",t.toString())),a.searchParams.set("transit","1"),a.searchParams.set("bike","1");let i=await fetch(a.toString());if(!i.ok)throw Error(`Walk Score API error: ${i.status}`);let s=await i.json();if(1!==s.status)return console.error("Walk Score API returned error status:",s.status),null;return{walkScore:s.walkscore||0,walkDescription:s.description||this.getWalkDescription(s.walkscore||0),transitScore:s.transit?.score,transitDescription:s.transit?.description,bikeScore:s.bike?.score,bikeDescription:s.bike?.description,logoUrl:s.logo_url||"https://cdn.walk.sc/images/api-logo.png",moreInfoLink:s.ws_link||`https://www.walkscore.com/score/${encodeURIComponent(e)}`}}catch(e){return console.error("Error fetching Walk Score:",e),null}}async getDetailedScores(e,r,t){let a=await this.getWalkScore(e,r,t);if(!a)return null;let i=this.getScoreDetails(a.walkScore,b),s=void 0!==a.transitScore?this.getScoreDetails(a.transitScore,v):void 0,n=void 0!==a.bikeScore?this.getScoreDetails(a.bikeScore,S):void 0;return{address:e,lat:r||0,lng:t||0,walkScore:{score:a.walkScore,description:i.description,summary:i.summary},transitScore:s?{score:a.transitScore,description:s.description,summary:s.summary}:void 0,bikeScore:n?{score:a.bikeScore,description:n.description,summary:n.summary}:void 0,updated:new Date().toISOString()}}getWalkDescription(e){return this.getScoreDetails(e,b).description}getScoreDetails(e,r){for(let t in r){let a=r[t];if(e>=a.min&&e<=a.max)return{description:a.description,summary:a.summary}}return{description:"Unknown",summary:"Score not available"}}async analyzePropertyAccessibility(e,r,t){let a,i=await this.getDetailedScores(e,r,t);if(!i)return null;let s=[];i.walkScore.score>=90?(a="excellent",s.push("Urban/dense area - may have parking restrictions"),s.push("Consider metered parking or parking garage"),s.push("Customer may not have dedicated parking"),s.push("Good for foot traffic if local office nearby")):i.walkScore.score>=70?(a="good",s.push("Mixed residential/commercial area"),s.push("Street parking usually available"),s.push("Check for permit parking zones")):i.walkScore.score>=50?(a="fair",s.push("Suburban area - parking generally available"),s.push("May need longer travel times between jobs")):(a="poor",s.push("Car-dependent area - parking readily available"),s.push("Driveways common, easy equipment access"),s.push("Plan for longer drive times")),i.transitScore&&i.transitScore.score>=70&&s.push("Good transit area - customer may not have car for equipment disposal"),i.bikeScore&&i.bikeScore.score>=70&&s.push("Bike-friendly area - watch for cyclists near vehicle");let n=i.walkScore.score<70;return{address:e,overallAccessibility:a,walkScore:i.walkScore.score,transitScore:i.transitScore?.score,bikeScore:i.bikeScore?.score,serviceImplications:s,parkingLikely:n}}async estimateTravelDifficulty(e){let r,t=await this.getWalkScore(e);if(!t)return null;let a=[],i=[];return t.walkScore>=85?(r="challenging",a.push("High-density urban area"),a.push("Limited or expensive parking"),a.push("Narrow streets possible"),a.push("High pedestrian traffic"),i.push("Arrive early to find parking"),i.push("Use smaller service vehicle if possible"),i.push("Budget extra time for job completion"),i.push("Confirm building access procedures with customer")):t.walkScore>=60?(r="moderate",a.push("Mixed-use neighborhood"),a.push("Street parking may require searching"),i.push("Check for parking restrictions before arrival"),i.push("Standard service vehicle appropriate")):(r="easy",a.push("Suburban/residential area"),a.push("Ample parking usually available"),a.push("Easy vehicle access"),i.push("Standard routing and timing appropriate")),t.transitScore&&t.transitScore>=70&&a.push("Major transit hub nearby - watch for buses"),{difficulty:r,factors:a,recommendations:i}}async getNeighborhoodCharacter(e){let r=await this.getWalkScore(e);return r?r.walkScore>=90?{type:"urban-core",description:"Dense urban core - high walkability, excellent transit",typicalParkingAccess:"Street parking limited, may need garage or loading zone",equipmentAccessNotes:"Elevators/stairs for upper floors, coordinate with building management"}:r.walkScore>=70?{type:"urban",description:"Urban neighborhood - walkable with good transit access",typicalParkingAccess:"Street parking available but may be metered or time-limited",equipmentAccessNotes:"Mix of single-family and multi-family, verify access requirements"}:r.walkScore>=40?{type:"suburban",description:"Suburban area - car-dependent with some walkable amenities",typicalParkingAccess:"Driveways and ample street parking typically available",equipmentAccessNotes:"Standard residential access, garages and basements common"}:{type:"rural",description:"Rural or low-density area - car required for all activities",typicalParkingAccess:"Driveways, large lots, no parking concerns",equipmentAccessNotes:"May have long driveways, outbuildings, well/septic systems"}:null}async compareLocations(e){return(await Promise.all(e.map(e=>this.getWalkScore(e)))).map((r,t)=>{let a,i;return r?(r.walkScore>=85?(a="challenging",i="limited"):r.walkScore>=60?(a="moderate",i="moderate"):(a="easy",i="ample"),{address:e[t],walkScore:r.walkScore,difficulty:a,parkingAvailability:i}):null}).filter(e=>null!==e)}async getParkingRecommendations(e){let r,t,a,i=await this.getWalkScore(e);if(!i)return null;let s=[];return i.walkScore>=90?(r="hard",t=10,a=!0,s.push("Contact customer about parking options before arrival"),s.push("Ask if there's a driveway, garage, or designated visitor parking"),s.push("Check for loading zones that allow temporary parking"),s.push("Consider using parking app (SpotHero, ParkMobile) if available"),s.push("Budget 10-15 extra minutes for parking")):i.walkScore>=70?(r="moderate",t=5,a=!0,s.push("Street parking usually available but may be metered"),s.push("Check for permit parking restrictions"),s.push("Ask customer about best parking spot when confirming appointment")):i.walkScore>=50?(r="moderate",t=2,a=!1,s.push("Parking generally available"),s.push("Driveway or street parking should be accessible")):(r="easy",t=0,a=!1,s.push("Ample parking expected - driveways and wide streets"),s.push("No special parking arrangements needed")),{difficulty:r,recommendations:s,estimatedParkingTime:t,suggestCustomerConfirmation:a}}};var x=e.i(511368);e.i(16106);var C=e.i(985647),A=e.i(350318);async function E(e){try{let r=e.nextUrl.searchParams,t=r.get("address"),a=r.get("lat"),i=r.get("lng"),s=r.get("action")||"score";if(!t)return f.NextResponse.json({error:"address required"},{status:400});let n=await (0,x.createClient)();if(!n)return f.NextResponse.json({error:"Database connection failed"},{status:500});let{data:{user:o}}=await n.auth.getUser();if(!o)return f.NextResponse.json({error:"Unauthorized"},{status:401});let l=await (0,C.getActiveCompanyId)();if(!l)return f.NextResponse.json({error:"No active company selected"},{status:401});let c=await (0,A.checkApiQuota)(l,"walkscore");if(c&&!c.has_quota)return f.NextResponse.json({error:"API quota exceeded",currentUsage:c.current_usage,limit:c.monthly_limit},{status:429});let u={score:"walk_score",detailed:"detailed_scores",accessibility:"accessibility","travel-difficulty":"travel_difficulty",neighborhood:"neighborhood",parking:"parking",compare:"compare_locations"}[s];if(!u)return f.NextResponse.json({error:"Invalid action"},{status:400});let p=a?parseFloat(a):void 0,d=i?parseFloat(i):void 0,m=await (0,A.withUsageTracking)(l,"walkscore",u,async()=>{switch(s){case"score":return await R.getWalkScore(t,p,d);case"detailed":return await R.getDetailedScores(t,p,d);case"accessibility":return await R.analyzePropertyAccessibility(t,p,d);case"travel-difficulty":return await R.estimateTravelDifficulty(t);case"neighborhood":return await R.getNeighborhoodCharacter(t);case"parking":return await R.getParkingRecommendations(t);case"compare":let e=r.get("addresses");if(!e)throw Error("addresses required (comma-separated)");return await R.compareLocations(e.split(","));default:throw Error(`Unknown action: ${s}`)}});if(!m)return f.NextResponse.json({error:"No data found"},{status:404});return f.NextResponse.json(m,{headers:{"Cache-Control":"public, s-maxage=86400, stale-while-revalidate=172800"}})}catch(e){if(console.error("Walk Score API error:",e),e instanceof Error&&e.message.includes("required"))return f.NextResponse.json({error:e.message},{status:400});return f.NextResponse.json({error:"Internal server error"},{status:500})}}e.s(["GET",()=>E],224986);var P=e.i(224986);let N=new r.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/location/walkscore/route",pathname:"/api/location/walkscore",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/location/walkscore/route.ts",nextConfigOutput:"",userland:P}),{workAsyncStorage:D,workUnitAsyncStorage:_,serverHooks:T}=N;function q(){return(0,a.patchFetch)({workAsyncStorage:D,workUnitAsyncStorage:_})}async function U(e,r,a){N.isDev&&(0,i.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let f="/api/location/walkscore/route";f=f.replace(/\/index$/,"")||"/";let b=await N.prepare(e,r,{srcPage:f,multiZoneDraftMode:!1});if(!b)return r.statusCode=400,r.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:v,params:S,nextConfig:R,parsedUrl:x,isDraftMode:C,prerenderManifest:A,routerServerContext:E,isOnDemandRevalidate:P,revalidateOnlyGenerated:D,resolvedPathname:_,clientReferenceManifest:T,serverActionsManifest:q}=b,U=(0,l.normalizeAppPath)(f),M=!!(A.dynamicRoutes[U]||A.routes[_]),I=async()=>((null==E?void 0:E.render404)?await E.render404(e,r,x,!1):r.end("This page could not be found"),null);if(M&&!C){let e=!!A.routes[_],r=A.dynamicRoutes[U];if(r&&!1===r.fallback&&!e){if(R.experimental.adapterPath)return await I();throw new y.NoFallbackError}}let O=null;!M||N.isDev||C||(O="/index"===(O=_)?"/":O);let j=!0===N.isDev||!M,H=M&&!j;q&&T&&(0,n.setReferenceManifestsSingleton)({page:f,clientReferenceManifest:T,serverActionsManifest:q,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:q})});let W=e.method||"GET",K=(0,s.getTracer)(),B=K.getActiveScopeSpan(),$={params:S,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!R.experimental.authInterrupts},cacheComponents:!!R.cacheComponents,supportsDynamicResponse:j,incrementalCache:(0,i.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:R.cacheLife,waitUntil:a.waitUntil,onClose:e=>{r.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(r,t,a)=>N.onRequestError(e,r,a,E)},sharedContext:{buildId:v}},F=new c.NodeNextRequest(e),L=new c.NodeNextResponse(r),z=u.NextRequestAdapter.fromNodeNextRequest(F,(0,u.signalFromNodeResponse)(r));try{let n=async e=>N.handle(z,$).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let t=K.getRootSpanAttributes();if(!t)return;if(t.get("next.span_type")!==p.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${t.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=t.get("next.route");if(a){let r=`${W} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":r}),e.updateName(r)}else e.updateName(`${W} ${f}`)}),o=!!(0,i.getRequestMeta)(e,"minimalMode"),l=async i=>{var s,l;let c=async({previousCacheEntry:t})=>{try{if(!o&&P&&D&&!t)return r.statusCode=404,r.setHeader("x-nextjs-cache","REVALIDATED"),r.end("This page could not be found"),null;let s=await n(i);e.fetchMetrics=$.renderOpts.fetchMetrics;let l=$.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=$.renderOpts.collectedTags;if(!M)return await (0,m.sendResponse)(F,L,s,$.renderOpts.pendingWaitUntil),null;{let e=await s.blob(),r=(0,h.toNodeOutgoingHttpHeaders)(s.headers);c&&(r[k.NEXT_CACHE_TAGS_HEADER]=c),!r["content-type"]&&e.type&&(r["content-type"]=e.type);let t=void 0!==$.renderOpts.collectedRevalidate&&!($.renderOpts.collectedRevalidate>=k.INFINITE_CACHE)&&$.renderOpts.collectedRevalidate,a=void 0===$.renderOpts.collectedExpire||$.renderOpts.collectedExpire>=k.INFINITE_CACHE?void 0:$.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:s.status,body:Buffer.from(await e.arrayBuffer()),headers:r},cacheControl:{revalidate:t,expire:a}}}}catch(r){throw(null==t?void 0:t.isStale)&&await N.onRequestError(e,r,{routerKind:"App Router",routePath:f,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:P})},E),r}},u=await N.handleResponse({req:e,nextConfig:R,cacheKey:O,routeKind:t.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:P,revalidateOnlyGenerated:D,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:o});if(!M)return null;if((null==u||null==(s=u.value)?void 0:s.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||r.setHeader("x-nextjs-cache",P?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),C&&r.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&M||p.delete(k.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||r.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,g.getCacheControlHeader)(u.cacheControl)),await (0,m.sendResponse)(F,L,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};B?await l(B):await K.withPropagatedContext(e.headers,()=>K.trace(p.BaseServerSpan.handleRequest,{spanName:`${W} ${f}`,kind:s.SpanKind.SERVER,attributes:{"http.method":W,"http.target":e.url}},l))}catch(r){if(r instanceof y.NoFallbackError||await N.onRequestError(e,r,{routerKind:"App Router",routePath:U,routeType:"route",revalidateReason:(0,d.getRevalidateReason)({isStaticGeneration:H,isOnDemandRevalidate:P})}),M)throw r;return await (0,m.sendResponse)(F,L,new Response(null,{status:500})),null}}e.s(["handler",()=>U,"patchFetch",()=>q,"routeModule",()=>N,"serverHooks",()=>T,"workAsyncStorage",()=>D,"workUnitAsyncStorage",()=>_],129950)}];

//# sourceMappingURL=3c0ae_next_dist_esm_build_templates_app-route_adb80a33.js.map