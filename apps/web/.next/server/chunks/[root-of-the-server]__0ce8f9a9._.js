module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},254799,(e,t,r)=>{t.exports=e.x("crypto",()=>require("crypto"))},664598,(e,t,r)=>{"use strict";t.exports=e.r(918622)},849614,(e,t,r)=>{"use strict";t.exports=e.r(664598).vendored["react-rsc"].React},848347,(e,t,r)=>{"use strict";var a=Object.defineProperty,s=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,o={},l={RequestCookies:()=>g,ResponseCookies:()=>f,parseCookie:()=>d,parseSetCookie:()=>p,stringifyCookie:()=>u};for(var c in l)a(o,c,{get:l[c],enumerable:!0});function u(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),a=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?a:`${a}; ${r.join("; ")}`}function d(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[a,s]=[r.slice(0,e),r.slice(e+1)];try{t.set(a,decodeURIComponent(null!=s?s:"true"))}catch{}}return t}function p(e){if(!e)return;let[[t,r],...a]=d(e),{domain:s,expires:n,httponly:i,maxage:o,path:l,samesite:c,secure:u,partitioned:p,priority:g}=Object.fromEntries(a.map(([e,t])=>[e.toLowerCase().replace(/-/g,""),t]));{var f,h,y={name:t,value:decodeURIComponent(r),domain:s,...n&&{expires:new Date(n)},...i&&{httpOnly:!0},..."string"==typeof o&&{maxAge:Number(o)},path:l,...c&&{sameSite:m.includes(f=(f=c).toLowerCase())?f:void 0},...u&&{secure:!0},...g&&{priority:_.includes(h=(h=g).toLowerCase())?h:void 0},...p&&{partitioned:!0}};let e={};for(let t in y)y[t]&&(e[t]=y[t]);return e}}t.exports=((e,t,r,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of n(t))i.call(e,r)||void 0===r||a(e,r,{get:()=>t[r],enumerable:!(o=s(t,r))||o.enumerable});return e})(a({},"__esModule",{value:!0}),o);var m=["strict","lax","none"],_=["low","medium","high"],g=class{constructor(e){this._parsed=new Map,this._headers=e;const t=e.get("cookie");if(t)for(const[e,r]of d(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===a).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,a=this._parsed;return a.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(a).map(([e,t])=>u(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>u(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},f=class{constructor(e){var t,r,a;this._parsed=new Map,this._headers=e;const s=null!=(a=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?a:[];for(const e of Array.isArray(s)?s:function(e){if(!e)return[];var t,r,a,s,n,i=[],o=0;function l(){for(;o<e.length&&/\s/.test(e.charAt(o));)o+=1;return o<e.length}for(;o<e.length;){for(t=o,n=!1;l();)if(","===(r=e.charAt(o))){for(a=o,o+=1,l(),s=o;o<e.length&&"="!==(r=e.charAt(o))&&";"!==r&&","!==r;)o+=1;o<e.length&&"="===e.charAt(o)?(n=!0,o=s,i.push(e.substring(t,a)),t=o):o=a+1}else o+=1;(!n||o>=e.length)&&i.push(e.substring(t,e.length))}return i}(s)){const t=p(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let a="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===a)}has(e){return this._parsed.has(e)}set(...e){let[t,r,a]=1===e.length?[e[0].name,e[0].value,e[0]]:e,s=this._parsed;return s.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...a})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=u(r);t.append("set-cookie",e)}}(s,this._headers),this}delete(...e){let[t,r]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0]];return this.set({...r,name:t,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(u).join("; ")}}},335014,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return a}});class a{static get(e,t,r){let a=Reflect.get(e,t,r);return"function"==typeof a?a.bind(e):a}static set(e,t,r,a){return Reflect.set(e,t,r,a)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},52773,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a={isRequestAPICallableInsideAfter:function(){return c},throwForSearchParamsAccessInUseCache:function(){return l},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return o}};for(var s in a)Object.defineProperty(r,s,{enumerable:!0,get:a[s]});let n=e.r(797518),i=e.r(324725);function o(e,t){throw Object.defineProperty(new n.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function l(e,t){let r=Object.defineProperty(Error(`Route ${e.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(r,t),e.invalidDynamicUsageError??=r,r}function c(){let e=i.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},479404,(e,t,r)=>{"use strict";t.exports=e.r(664598).vendored["react-rsc"].ReactServerDOMTurbopackServer},471312,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"registerServerReference",{enumerable:!0,get:function(){return a.registerServerReference}});let a=e.r(479404)},798348,(e,t,r)=>{"use strict";function a(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureServerEntryExports",{enumerable:!0,get:function(){return a}})},273568,e=>{"use strict";var t=e.i(471312),r=e.i(381259);async function a(){let e=process.env.SUPABASE_POOLER_URL||"https://togejqdwggezkxahomeh.supabase.co",t=process.env.SUPABASE_SERVICE_ROLE_KEY;return e&&t?(0,r.createClient)(e,t,{auth:{persistSession:!1,autoRefreshToken:!1},db:{schema:"public"},global:{headers:{"x-my-custom-header":"service-role"}}}):null}(0,e.i(798348).ensureServerEntryExports)([a]),(0,t.registerServerReference)(a,"00a13dbd00149949fc1367d3e76ae7d789e07f5321",null),e.s(["createServiceSupabaseClient",()=>a])},614952,e=>{"use strict";var t=e.i(786348),r=e.i(628123);async function a(e,a,s){let n=process.env.TELNYX_API_KEY;if(!n)return{success:!1,error:"TELNYX_API_KEY is not configured"};let i=s?.operation||e,o=s?.timeout??15e3,l=async()=>{let r=new AbortController,s=setTimeout(()=>r.abort(),o);try{t.telnyxLogger.debug("Call API request",{endpoint:e,operation:i});let o=await fetch(`https://api.telnyx.com/v2${e}`,{method:"POST",headers:{Authorization:`Bearer ${n}`,"Content-Type":"application/json"},body:JSON.stringify(a),signal:r.signal});clearTimeout(s);let l=await o.json();if(!o.ok){let r=l?.errors?.[0]?.detail||l?.errors?.[0]||o.statusText;t.telnyxLogger.warn("Call API error response",{endpoint:e,operation:i,status:o.status,error:r});let a=Error(`Telnyx ${o.status}: ${r}`);throw a.statusCode=o.status,a}return t.telnyxLogger.debug("Call API success",{endpoint:e,operation:i}),{success:!0,data:l.data}}catch(r){if(clearTimeout(s),r instanceof Error&&"AbortError"===r.name)throw t.telnyxLogger.error("Call API timeout",{endpoint:e,operation:i,timeoutMs:o}),Error(`Request timeout after ${o}ms`);throw r}};try{if(s?.skipRetry)return await l();return await (0,r.withRetry)(l,{endpoint:`calls:${i}`,config:{maxRetries:2,baseDelayMs:500,maxDelayMs:2e3},onRetry:(r,a,s)=>{t.telnyxLogger.warn("Retrying call API request",{endpoint:e,operation:i,attempt:r,error:a.message,delayMs:s})}})}catch(r){return t.telnyxLogger.error("Call API request failed",{endpoint:e,operation:i,error:r instanceof Error?r.message:"Unknown error"}),{success:!1,error:r instanceof Error?r.message:"Request failed"}}}async function s(e){let t=await a("/calls",{to:e.to,from:e.from,connection_id:e.connectionId,webhook_url:e.webhookUrl,answering_machine_detection:e.answeringMachineDetection||"disabled",custom_headers:e.customHeaders},{operation:"initiate"});return t.success&&t.data?{success:!0,callControlId:t.data.call_control_id,callSessionId:t.data.call_session_id,data:t.data}:{success:!1,error:t.error||"Failed to initiate call"}}async function n(e){return a(`/calls/${e.callControlId}/actions/answer`,{webhook_url:e.webhookUrl,client_state:e.clientState},{operation:"answer",skipRetry:!0})}async function i(e){return a(`/calls/${e.callControlId}/actions/reject`,{cause:e.cause||"CALL_REJECTED"},{operation:"reject",skipRetry:!0})}async function o(e){return a(`/calls/${e.callControlId}/actions/hangup`,{},{operation:"hangup"})}async function l(e){return a(`/calls/${e.callControlId}/actions/record_start`,{format:e.format||"mp3",channels:e.channels||"single"},{operation:"record_start"})}async function c(e){return a(`/calls/${e.callControlId}/actions/record_stop`,{},{operation:"record_stop"})}async function u(e){return a(`/calls/${e.callControlId}/actions/playback_start`,{audio_url:e.audioUrl,loop:e.loop},{operation:"playback_start"})}async function d(e){return a(`/calls/${e.callControlId}/actions/speak`,{payload:e.text,voice:e.voice||"female",language:e.language||"en-US"},{operation:"speak"})}async function p(e){return a(`/calls/${e.callControlId}/actions/transfer`,{to:e.to,from:e.from},{operation:"transfer"})}async function m(e){return a(`/calls/${e.callControlId}/actions/send_dtmf`,{digits:e.digits},{operation:"send_dtmf"})}async function _(e){let t=!!e.audioUrl;return a(t?`/calls/${e.callControlId}/actions/gather_using_audio`:`/calls/${e.callControlId}/actions/gather_using_speak`,t?{audio_url:e.audioUrl,valid_digits:e.validDigits,max:e.maxDigits,min:e.minDigits,timeout_millis:e.timeout,terminating_digit:e.terminatingDigit||"#"}:{payload:e.speakText||"",valid_digits:e.validDigits,max:e.maxDigits,min:e.minDigits,timeout_millis:e.timeout,terminating_digit:e.terminatingDigit||"#"},{operation:t?"gather_audio":"gather_speak"})}e.s(["answerCall",()=>n,"gatherInput",()=>_,"hangupCall",()=>o,"initiateCall",()=>s,"playAudio",()=>u,"rejectCall",()=>i,"sendDTMF",()=>m,"speakText",()=>d,"startRecording",()=>l,"stopRecording",()=>c,"transferCall",()=>p])},291546,e=>{"use strict";var t=e.i(471312),r=e.i(717899),a=e.i(511368),s=e.i(893099),n=e.i(798348);let i=process.env.TELNYX_DEFAULT_MESSAGING_PROFILE_ID||process.env.NEXT_PUBLIC_TELNYX_MESSAGING_PROFILE_ID||"",o=/\s+/;function l(e){if(!e)return null;let t=e.replace(/\D/g,"");return t?11===t.length&&t.startsWith("1")?`+${t}`:10===t.length?`+1${t}`:e.startsWith("+")?e:`+${t}`:null}async function c(e,t){let{data:r}=await e.from("messaging_brands").select("id").eq("company_id",t.company_id).maybeSingle();r?await e.from("messaging_brands").update({...t,updated_at:new Date().toISOString()}).eq("id",r.id):await e.from("messaging_brands").insert(t)}async function u(e,t){let{data:r}=await e.from("messaging_campaigns").select("id").eq("messaging_brand_id",t.messaging_brand_id).eq("usecase",t.usecase).maybeSingle();if(r)return await e.from("messaging_campaigns").update({...t,updated_at:new Date().toISOString()}).eq("id",r.id),r.id;let{data:a}=await e.from("messaging_campaigns").insert(t).select("id").single();return a?.id??null}async function d(e,t){let n=t?.supabase??await (0,a.createClient)();if(!n)return{success:!1,error:"Supabase unavailable"};let{data:i,error:u}=await n.from("companies").select("id, name, legal_name, doing_business_as, phone, support_email, support_phone, website, website_url, brand_color, industry, address, city, state, zip_code, owner_id, ein, tax_id").eq("id",e).single();if(u||!i)return{success:!1,error:u?.message||"Company not found"};let{data:d}=await n.from("profiles").select("full_name, email, phone").eq("id",i.owner_id).maybeSingle(),p=function(e){if(!e)return{first:"Support",last:"Team"};let t=e.trim().split(o);return 1===t.length?{first:t[0],last:"Team"}:{first:t[0],last:t.slice(1).join(" ")}}(d?.full_name),m=d?.email||i.support_email||"support@example.com",_=l(d?.phone)||l(i.support_phone)||l(i.phone)||"+18314280176",{data:g}=await n.from("messaging_brands").select("*").eq("company_id",e).maybeSingle();if(g?.telnyx_brand_id){let e=await (0,s.getTenDlcBrand)(g.telnyx_brand_id);e.success&&e.data&&await n.from("messaging_brands").update({status:e.data.status,updated_at:new Date().toISOString()}).eq("id",g.id)}if(!g?.telnyx_brand_id){let t={customer_reference:e,brand_name:i.legal_name||i.name,ein:i.ein||i.tax_id||process.env.FALLBACK_TEST_EIN||"00-0000000",ein_issuing_country:"US",vertical:function(e){if(!e)return"PROFESSIONAL";let t=e.toLowerCase();return t.includes("plumb")||t.includes("hvac")||t.includes("electric")?"HOME_SERVICES":(t.includes("clean"),"PROFESSIONAL")}(i.industry),website:i.website||i.website_url||null,company_type:"PRIVATE_PROFIT",address:{line1:i.address||"115 Flintlock Lane",city:i.city||"Ben Lomond",state:i.state||"CA",postal_code:i.zip_code||"95005",country:"US"},contact:{first_name:p.first,last_name:p.last,email:m,phone:_},optional_attributes:{doing_business_as:i.doing_business_as||i.name}},r=await (0,s.createTenDlcBrand)(t);if(!(r.success&&r.data))return{success:!1,error:r.error||"Failed to create 10DLC brand"};await c(n,{company_id:e,telnyx_brand_id:r.data.id,status:"submitted",legal_name:t.brand_name,doing_business_as:i.doing_business_as||i.name,ein:t.ein,vertical:t.vertical,website:t.website,support_email:m,support_phone:_,address_line1:t.address.line1,city:t.address.city,state:t.address.state,postal_code:t.address.postal_code,brand_color:i.brand_color})}return(0,r.revalidatePath)("/dashboard/settings/communications/brand"),{success:!0}}async function p(e,t,n){let o=n?.supabase??await (0,a.createClient)();if(!o)return{success:!1,error:"Supabase unavailable"};let{data:l}=await o.from("messaging_brands").select("*").eq("company_id",e).maybeSingle();if(!l?.telnyx_brand_id){let r=await d(e,{supabase:o});return r.success?p(e,t):r}let c="CUSTOMER_CARE",{data:m}=await o.from("messaging_campaigns").select("*").eq("messaging_brand_id",l.id).eq("usecase",c).maybeSingle();if(m?.telnyx_campaign_id){let e=await (0,s.getTenDlcCampaign)(m.telnyx_campaign_id);e.success&&e.data&&await o.from("messaging_campaigns").update({status:e.data.status,updated_at:new Date().toISOString()}).eq("id",m.id)}let _=m?.id??null,g=m?.telnyx_campaign_id??null;if(!m?.telnyx_campaign_id){if(!i)return{success:!1,error:"TELNYX_DEFAULT_MESSAGING_PROFILE_ID not configured"};let t=`${l.doing_business_as||l.legal_name} provides appointment updates, reminders, and service notifications to existing customers.`,r=`Hi {{customer_name}}, this is ${l.doing_business_as||l.legal_name} confirming your upcoming appointment. Reply HELP for assistance or STOP to opt out.`,a={brand_id:l.telnyx_brand_id,campaign_alias:`${e}-customer-care`,usecase:c,description:t,sample_messages:[r],message_flow:"Customers opt in during onboarding or by texting our business line. They receive service updates and can opt out by replying STOP.",terms_and_conditions:"Msg & data rates may apply. Reply STOP to opt out, HELP for help.",help_message:`Thanks for contacting ${l.doing_business_as||l.legal_name}. Reply STOP to unsubscribe.`,help_phone_number:l.support_phone||"+18314280176",help_email:l.support_email||"support@example.com",auto_renewal:!0,message_fee_credits:0,opt_in_keywords:["START","YES"],opt_out_keywords:["STOP","UNSUBSCRIBE"],opt_in_message:"Thanks for opting in to receive messages from us. Reply STOP to opt out.",opt_out_message:"You have successfully been unsubscribed and will no longer receive messages. Reply START to opt in again."},n=await (0,s.createTenDlcCampaign)(a);if(!(n.success&&n.data))return{success:!1,error:n.error||"Failed to create 10DLC campaign"};_=await u(o,{messaging_brand_id:l.id,telnyx_campaign_id:n.data.id,status:"submitted",usecase:c,description:t,sample_messages:a.sample_messages,messaging_profile_id:i})||m?.id||null,g=n.data.id}if(!(_&&g))return{success:!1,error:"Campaign not ready"};let{data:f}=await o.from("messaging_campaign_phone_numbers").select("*").eq("messaging_campaign_id",_).eq("phone_number_id",t.id).maybeSingle();if(!f?.telnyx_relationship_id){let e=await (0,s.attachNumberToCampaign)(g,t.e164);if(!(e.success&&e.data))return{success:!1,error:e.error||"Failed to link number to campaign"};f?await o.from("messaging_campaign_phone_numbers").update({telnyx_relationship_id:e.data.id,status:"submitted"}).eq("id",f.id):await o.from("messaging_campaign_phone_numbers").insert({messaging_campaign_id:_,phone_number_id:t.id,telnyx_relationship_id:e.data.id,status:"submitted"})}return await o.from("phone_numbers").update({telnyx_messaging_profile_id:i,metadata:{ten_dlc_campaign_id:g}}).eq("id",t.id),(0,r.revalidatePath)("/dashboard/settings/communications/phone-numbers"),{success:!0}}(0,n.ensureServerEntryExports)([d,p]),(0,t.registerServerReference)(d,"606753f8910b46d5792f4bdeb457cdf29d1a8bbadc",null),(0,t.registerServerReference)(p,"70a648f43fa62ae3dcf2070eb90413e96e81591e77",null),e.s(["ensureMessagingBranding",()=>d,"ensureMessagingCampaign",()=>p])},358470,e=>{"use strict";var t=e.i(755535),r=e.i(377233),a=e.i(490003),s=e.i(492991),n=e.i(241970),i=e.i(357699),o=e.i(212454),l=e.i(48717),c=e.i(798301),u=e.i(986366),d=e.i(983537),p=e.i(147475),m=e.i(561930),_=e.i(803747),g=e.i(368557),f=e.i(42037),h=e.i(193695);e.i(432036);var y=e.i(573881),b=e.i(297676),v=e.i(467151);async function x(e){try{let{companyId:t,to:r,message:a}=await e.json();if(!t||!r||!a)return b.NextResponse.json({success:!1,error:"companyId, to, and message are required"},{status:400});let s=await fetch(`${e.nextUrl.origin}/api/telnyx/check-settings?companyId=${t}`),n=await s.json();if(!n.ready||!n.defaultNumber)return b.NextResponse.json({success:!1,error:"Company doesn't have a default outbound number configured"});let i=await (0,v.sendTextMessage)({companyId:t,to:r,from:n.defaultNumber,text:a});return b.NextResponse.json(i)}catch(e){return b.NextResponse.json({success:!1,error:e.message||"Failed to send test SMS"},{status:500})}}e.s(["POST",()=>x],648900);var w=e.i(648900);let R=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/telnyx/send-test-sms/route",pathname:"/api/telnyx/send-test-sms",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/telnyx/send-test-sms/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:S,workUnitAsyncStorage:E,serverHooks:C}=R;function A(){return(0,a.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:E})}async function P(e,t,a){R.isDev&&(0,s.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/telnyx/send-test-sms/route";b=b.replace(/\/index$/,"")||"/";let v=await R.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!v)return t.statusCode=400,t.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve()),null;let{buildId:x,params:w,nextConfig:S,parsedUrl:E,isDraftMode:C,prerenderManifest:A,routerServerContext:P,isOnDemandRevalidate:O,revalidateOnlyGenerated:k,resolvedPathname:T,clientReferenceManifest:j,serverActionsManifest:I}=v,D=(0,l.normalizeAppPath)(b),$=!!(A.dynamicRoutes[D]||A.routes[T]),N=async()=>((null==P?void 0:P.render404)?await P.render404(e,t,E,!1):t.end("This page could not be found"),null);if($&&!C){let e=!!A.routes[T],t=A.dynamicRoutes[D];if(t&&!1===t.fallback&&!e){if(S.experimental.adapterPath)return await N();throw new h.NoFallbackError}}let q=null;!$||R.isDev||C||(q="/index"===(q=T)?"/":q);let U=!0===R.isDev||!$,L=$&&!U;I&&j&&(0,i.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:j,serverActionsManifest:I,serverModuleMap:(0,o.createServerModuleMap)({serverActionsManifest:I})});let M=e.method||"GET",F=(0,n.getTracer)(),H=F.getActiveScopeSpan(),B={params:w,prerenderManifest:A,renderOpts:{experimental:{authInterrupts:!!S.experimental.authInterrupts},cacheComponents:!!S.cacheComponents,supportsDynamicResponse:U,incrementalCache:(0,s.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:S.cacheLife,waitUntil:a.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,a)=>R.onRequestError(e,t,a,P)},sharedContext:{buildId:x}},K=new c.NodeNextRequest(e),X=new c.NodeNextResponse(t),G=u.NextRequestAdapter.fromNodeNextRequest(K,(0,u.signalFromNodeResponse)(t));try{let i=async e=>R.handle(G,B).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=F.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let a=r.get("next.route");if(a){let t=`${M} ${a}`;e.setAttributes({"next.route":a,"http.route":a,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${b}`)}),o=!!(0,s.getRequestMeta)(e,"minimalMode"),l=async s=>{var n,l;let c=async({previousCacheEntry:r})=>{try{if(!o&&O&&k&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let n=await i(s);e.fetchMetrics=B.renderOpts.fetchMetrics;let l=B.renderOpts.pendingWaitUntil;l&&a.waitUntil&&(a.waitUntil(l),l=void 0);let c=B.renderOpts.collectedTags;if(!$)return await (0,m.sendResponse)(K,X,n,B.renderOpts.pendingWaitUntil),null;{let e=await n.blob(),t=(0,_.toNodeOutgoingHttpHeaders)(n.headers);c&&(t[f.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==B.renderOpts.collectedRevalidate&&!(B.renderOpts.collectedRevalidate>=f.INFINITE_CACHE)&&B.renderOpts.collectedRevalidate,a=void 0===B.renderOpts.collectedExpire||B.renderOpts.collectedExpire>=f.INFINITE_CACHE?void 0:B.renderOpts.collectedExpire;return{value:{kind:y.CachedRouteKind.APP_ROUTE,status:n.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:a}}}}catch(t){throw(null==r?void 0:r.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:O})},P),t}},u=await R.handleResponse({req:e,nextConfig:S,cacheKey:q,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:A,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:k,responseGenerator:c,waitUntil:a.waitUntil,isMinimalMode:o});if(!$)return null;if((null==u||null==(n=u.value)?void 0:n.kind)!==y.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});o||t.setHeader("x-nextjs-cache",O?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),C&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,_.fromNodeOutgoingHttpHeaders)(u.value.headers);return o&&$||d.delete(f.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,g.getCacheControlHeader)(u.cacheControl)),await (0,m.sendResponse)(K,X,new Response(u.value.body,{headers:d,status:u.value.status||200})),null};H?await l(H):await F.withPropagatedContext(e.headers,()=>F.trace(d.BaseServerSpan.handleRequest,{spanName:`${M} ${b}`,kind:n.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},l))}catch(t){if(t instanceof h.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:D,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:L,isOnDemandRevalidate:O})}),$)throw t;return await (0,m.sendResponse)(K,X,new Response(null,{status:500})),null}}e.s(["handler",()=>P,"patchFetch",()=>A,"routeModule",()=>R,"serverHooks",()=>C,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>E],358470)},226115,e=>{e.v(e=>Promise.resolve().then(()=>e(766988)))},989318,e=>{e.v(t=>Promise.all(["server/chunks/apps_web_src_lib_telnyx_messaging-profile-fetcher_ts_3db46723._.js"].map(t=>e.l(t))).then(()=>t(394972)))},764856,e=>{e.v(e=>Promise.resolve().then(()=>e(614952)))},229637,e=>{e.v(t=>Promise.all(["server/chunks/apps_web_src_lib_assemblyai_client_ts_2b8329fc._.js"].map(t=>e.l(t))).then(()=>t(268901)))},175702,e=>{e.v(t=>Promise.all(["server/chunks/_0a9984ef._.js"].map(t=>e.l(t))).then(()=>t(907631)))},925531,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__2a491e2c._.js","server/chunks/apps_web_src_lib_email_88ddc82e._.js","server/chunks/apps_web_src_lib_email_d758aae7._.js","server/chunks/node_modules__pnpm_1a9e968f._.js","server/chunks/_81ba2cec._.js","server/chunks/node_modules__pnpm_c28f4879._.js","server/chunks/_68658d0d._.js","server/chunks/apps_web_7b2fec1c._.js","server/chunks/apps_web_src_lib_email_gmail-client_ts_e648327c._.js","server/chunks/37e87_zod_v4_de06a7a1._.js"].map(t=>e.l(t))).then(()=>t(8583)))},633428,e=>{e.v(t=>Promise.all(["server/chunks/[root-of-the-server]__d1ab72d3._.js"].map(t=>e.l(t))).then(()=>t(333085)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__0ce8f9a9._.js.map