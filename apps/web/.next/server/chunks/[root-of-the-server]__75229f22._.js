module.exports=[918622,(e,t,r)=>{t.exports=e.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},556704,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},832319,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},324725,(e,t,r)=>{t.exports=e.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},193695,(e,t,r)=>{t.exports=e.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},664598,(e,t,r)=>{"use strict";t.exports=e.r(918622)},849614,(e,t,r)=>{"use strict";t.exports=e.r(664598).vendored["react-rsc"].React},848347,(e,t,r)=>{"use strict";var n=Object.defineProperty,o=Object.getOwnPropertyDescriptor,a=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,s={},l={RequestCookies:()=>m,ResponseCookies:()=>g,parseCookie:()=>d,parseSetCookie:()=>p,stringifyCookie:()=>u};for(var c in l)n(s,c,{get:l[c],enumerable:!0});function u(e){var t;let r=["path"in e&&e.path&&`Path=${e.path}`,"expires"in e&&(e.expires||0===e.expires)&&`Expires=${("number"==typeof e.expires?new Date(e.expires):e.expires).toUTCString()}`,"maxAge"in e&&"number"==typeof e.maxAge&&`Max-Age=${e.maxAge}`,"domain"in e&&e.domain&&`Domain=${e.domain}`,"secure"in e&&e.secure&&"Secure","httpOnly"in e&&e.httpOnly&&"HttpOnly","sameSite"in e&&e.sameSite&&`SameSite=${e.sameSite}`,"partitioned"in e&&e.partitioned&&"Partitioned","priority"in e&&e.priority&&`Priority=${e.priority}`].filter(Boolean),n=`${e.name}=${encodeURIComponent(null!=(t=e.value)?t:"")}`;return 0===r.length?n:`${n}; ${r.join("; ")}`}function d(e){let t=new Map;for(let r of e.split(/; */)){if(!r)continue;let e=r.indexOf("=");if(-1===e){t.set(r,"true");continue}let[n,o]=[r.slice(0,e),r.slice(e+1)];try{t.set(n,decodeURIComponent(null!=o?o:"true"))}catch{}}return t}function p(e){if(!e)return;let[[t,r],...n]=d(e),{domain:o,expires:a,httponly:i,maxage:s,path:l,samesite:c,secure:u,partitioned:p,priority:m}=Object.fromEntries(n.map(([e,t])=>[e.toLowerCase().replace(/-/g,""),t]));{var g,y,_={name:t,value:decodeURIComponent(r),domain:o,...a&&{expires:new Date(a)},...i&&{httpOnly:!0},..."string"==typeof s&&{maxAge:Number(s)},path:l,...c&&{sameSite:f.includes(g=(g=c).toLowerCase())?g:void 0},...u&&{secure:!0},...m&&{priority:h.includes(y=(y=m).toLowerCase())?y:void 0},...p&&{partitioned:!0}};let e={};for(let t in _)_[t]&&(e[t]=_[t]);return e}}t.exports=((e,t,r,s)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of a(t))i.call(e,r)||void 0===r||n(e,r,{get:()=>t[r],enumerable:!(s=o(t,r))||s.enumerable});return e})(n({},"__esModule",{value:!0}),s);var f=["strict","lax","none"],h=["low","medium","high"],m=class{constructor(e){this._parsed=new Map,this._headers=e;const t=e.get("cookie");if(t)for(const[e,r]of d(t))this._parsed.set(e,{name:e,value:r})}[Symbol.iterator](){return this._parsed[Symbol.iterator]()}get size(){return this._parsed.size}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed);if(!e.length)return r.map(([e,t])=>t);let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(([e])=>e===n).map(([e,t])=>t)}has(e){return this._parsed.has(e)}set(...e){let[t,r]=1===e.length?[e[0].name,e[0].value]:e,n=this._parsed;return n.set(t,{name:t,value:r}),this._headers.set("cookie",Array.from(n).map(([e,t])=>u(t)).join("; ")),this}delete(e){let t=this._parsed,r=Array.isArray(e)?e.map(e=>t.delete(e)):t.delete(e);return this._headers.set("cookie",Array.from(t).map(([e,t])=>u(t)).join("; ")),r}clear(){return this.delete(Array.from(this._parsed.keys())),this}[Symbol.for("edge-runtime.inspect.custom")](){return`RequestCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(e=>`${e.name}=${encodeURIComponent(e.value)}`).join("; ")}},g=class{constructor(e){var t,r,n;this._parsed=new Map,this._headers=e;const o=null!=(n=null!=(r=null==(t=e.getSetCookie)?void 0:t.call(e))?r:e.get("set-cookie"))?n:[];for(const e of Array.isArray(o)?o:function(e){if(!e)return[];var t,r,n,o,a,i=[],s=0;function l(){for(;s<e.length&&/\s/.test(e.charAt(s));)s+=1;return s<e.length}for(;s<e.length;){for(t=s,a=!1;l();)if(","===(r=e.charAt(s))){for(n=s,s+=1,l(),o=s;s<e.length&&"="!==(r=e.charAt(s))&&";"!==r&&","!==r;)s+=1;s<e.length&&"="===e.charAt(s)?(a=!0,s=o,i.push(e.substring(t,n)),t=s):s=n+1}else s+=1;(!a||s>=e.length)&&i.push(e.substring(t,e.length))}return i}(o)){const t=p(e);t&&this._parsed.set(t.name,t)}}get(...e){let t="string"==typeof e[0]?e[0]:e[0].name;return this._parsed.get(t)}getAll(...e){var t;let r=Array.from(this._parsed.values());if(!e.length)return r;let n="string"==typeof e[0]?e[0]:null==(t=e[0])?void 0:t.name;return r.filter(e=>e.name===n)}has(e){return this._parsed.has(e)}set(...e){let[t,r,n]=1===e.length?[e[0].name,e[0].value,e[0]]:e,o=this._parsed;return o.set(t,function(e={name:"",value:""}){return"number"==typeof e.expires&&(e.expires=new Date(e.expires)),e.maxAge&&(e.expires=new Date(Date.now()+1e3*e.maxAge)),(null===e.path||void 0===e.path)&&(e.path="/"),e}({name:t,value:r,...n})),function(e,t){for(let[,r]of(t.delete("set-cookie"),e)){let e=u(r);t.append("set-cookie",e)}}(o,this._headers),this}delete(...e){let[t,r]="string"==typeof e[0]?[e[0]]:[e[0].name,e[0]];return this.set({...r,name:t,value:"",expires:new Date(0)})}[Symbol.for("edge-runtime.inspect.custom")](){return`ResponseCookies ${JSON.stringify(Object.fromEntries(this._parsed))}`}toString(){return[...this._parsed.values()].map(u).join("; ")}}},335014,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ReflectAdapter",{enumerable:!0,get:function(){return n}});class n{static get(e,t,r){let n=Reflect.get(e,t,r);return"function"==typeof n?n.bind(e):n}static set(e,t,r,n){return Reflect.set(e,t,r,n)}static has(e,t){return Reflect.has(e,t)}static deleteProperty(e,t){return Reflect.deleteProperty(e,t)}}},52773,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n={isRequestAPICallableInsideAfter:function(){return c},throwForSearchParamsAccessInUseCache:function(){return l},throwWithStaticGenerationBailoutErrorWithDynamicError:function(){return s}};for(var o in n)Object.defineProperty(r,o,{enumerable:!0,get:n[o]});let a=e.r(797518),i=e.r(324725);function s(e,t){throw Object.defineProperty(new a.StaticGenBailoutError(`Route ${e} with \`dynamic = "error"\` couldn't be rendered statically because it used ${t}. See more info here: https://nextjs.org/docs/app/building-your-application/rendering/static-and-dynamic#dynamic-rendering`),"__NEXT_ERROR_CODE",{value:"E543",enumerable:!1,configurable:!0})}function l(e,t){let r=Object.defineProperty(Error(`Route ${e.route} used \`searchParams\` inside "use cache". Accessing dynamic request data inside a cache scope is not supported. If you need some search params inside a cached function await \`searchParams\` outside of the cached function and pass only the required search params as arguments to the cached function. See more info here: https://nextjs.org/docs/messages/next-request-in-use-cache`),"__NEXT_ERROR_CODE",{value:"E842",enumerable:!1,configurable:!0});throw Error.captureStackTrace(r,t),e.invalidDynamicUsageError??=r,r}function c(){let e=i.afterTaskAsyncStorage.getStore();return(null==e?void 0:e.rootTaskSpawnPhase)==="action"}},417446,948874,757460,704329,e=>{"use strict";let t=Object.freeze({status:"aborted"});function r(e,t,r){function n(r,n){var o;for(let a in Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:!1}),(o=r._zod).traits??(o.traits=new Set),r._zod.traits.add(e),t(r,n),i.prototype)a in r||Object.defineProperty(r,a,{value:i.prototype[a].bind(r)});r._zod.constr=i,r._zod.def=n}let o=r?.Parent??Object;class a extends o{}function i(e){var t;let o=r?.Parent?new a:this;for(let r of(n(o,e),(t=o._zod).deferred??(t.deferred=[]),o._zod.deferred))r();return o}return Object.defineProperty(a,"name",{value:e}),Object.defineProperty(i,"init",{value:n}),Object.defineProperty(i,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(i,"name",{value:e}),i}let n=Symbol("zod_brand");class o extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class a extends Error{constructor(e){super(`Encountered unidirectional transform during encode: ${e}`),this.name="ZodEncodeError"}}let i={};function s(e){return e&&Object.assign(i,e),i}function l(e){return e}function c(e){return e}function u(e){}function d(e){throw Error()}function p(e){}function f(e){let t=Object.values(e).filter(e=>"number"==typeof e);return Object.entries(e).filter(([e,r])=>-1===t.indexOf(+e)).map(([e,t])=>t)}function h(e,t="|"){return e.map(e=>F(e)).join(t)}function m(e,t){return"bigint"==typeof t?t.toString():t}function g(e){return{get value(){{let t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function y(e){return null==e}function _(e){let t=+!!e.startsWith("^"),r=e.endsWith("$")?e.length-1:e.length;return e.slice(t,r)}function b(e,t){let r=(e.toString().split(".")[1]||"").length,n=t.toString(),o=(n.split(".")[1]||"").length;if(0===o&&/\d?e-\d?/.test(n)){let e=n.match(/\d?e-(\d?)/);e?.[1]&&(o=Number.parseInt(e[1]))}let a=r>o?r:o;return Number.parseInt(e.toFixed(a).replace(".",""))%Number.parseInt(t.toFixed(a).replace(".",""))/10**a}e.s(["$ZodAsyncError",()=>o,"$ZodEncodeError",()=>a,"$brand",0,n,"$constructor",()=>r,"NEVER",0,t,"config",()=>s,"globalConfig",0,i],948874);let w=Symbol("evaluating");function v(e,t,r){let n;Object.defineProperty(e,t,{get(){if(n!==w)return void 0===n&&(n=w,n=r()),n},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function x(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function E(e,t,r){Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!0,configurable:!0})}function j(...e){let t={};for(let r of e)Object.assign(t,Object.getOwnPropertyDescriptors(r));return Object.defineProperties({},t)}function z(e){return j(e._zod.def)}function R(e,t){return t?t.reduce((e,t)=>e?.[t],e):e}function S(e){let t=Object.keys(e);return Promise.all(t.map(t=>e[t])).then(e=>{let r={};for(let n=0;n<t.length;n++)r[t[n]]=e[n];return r})}function A(e=10){let t="abcdefghijklmnopqrstuvwxyz",r="";for(let n=0;n<e;n++)r+=t[Math.floor(Math.random()*t.length)];return r}function O(e){return JSON.stringify(e)}let T="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function k(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)}let C=g(()=>{if("undefined"!=typeof navigator&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{return Function(""),!0}catch(e){return!1}});function P(e){if(!1===k(e))return!1;let t=e.constructor;if(void 0===t)return!0;let r=t.prototype;return!1!==k(r)&&!1!==Object.prototype.hasOwnProperty.call(r,"isPrototypeOf")}function I(e){return P(e)?{...e}:Array.isArray(e)?[...e]:e}function N(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}let $=new Set(["string","number","symbol"]),U=new Set(["string","number","bigint","boolean","symbol","undefined"]);function D(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function M(e,t,r){let n=new e._zod.constr(t??e._zod.def);return(!t||r?.parent)&&(n._zod.parent=e),n}function q(e){if(!e)return{};if("string"==typeof e)return{error:()=>e};if(e?.message!==void 0){if(e?.error!==void 0)throw Error("Cannot specify both `message` and `error` params");e.error=e.message}return(delete e.message,"string"==typeof e.error)?{...e,error:()=>e.error}:e}function B(e){let t;return new Proxy({},{get:(r,n,o)=>(t??(t=e()),Reflect.get(t,n,o)),set:(r,n,o,a)=>(t??(t=e()),Reflect.set(t,n,o,a)),has:(r,n)=>(t??(t=e()),Reflect.has(t,n)),deleteProperty:(r,n)=>(t??(t=e()),Reflect.deleteProperty(t,n)),ownKeys:r=>(t??(t=e()),Reflect.ownKeys(t)),getOwnPropertyDescriptor:(r,n)=>(t??(t=e()),Reflect.getOwnPropertyDescriptor(t,n)),defineProperty:(r,n,o)=>(t??(t=e()),Reflect.defineProperty(t,n,o))})}function F(e){return"bigint"==typeof e?e.toString()+"n":"string"==typeof e?`"${e}"`:`${e}`}function L(e){return Object.keys(e).filter(t=>"optional"===e[t]._zod.optin&&"optional"===e[t]._zod.optout)}let H={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-0x80000000,0x7fffffff],uint32:[0,0xffffffff],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},G={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function J(e,t){let r=e._zod.def,n=j(e._zod.def,{get shape(){let e={};for(let n in t){if(!(n in r.shape))throw Error(`Unrecognized key: "${n}"`);t[n]&&(e[n]=r.shape[n])}return E(this,"shape",e),e},checks:[]});return M(e,n)}function Z(e,t){let r=e._zod.def,n=j(e._zod.def,{get shape(){let n={...e._zod.def.shape};for(let e in t){if(!(e in r.shape))throw Error(`Unrecognized key: "${e}"`);t[e]&&delete n[e]}return E(this,"shape",n),n},checks:[]});return M(e,n)}function K(e,t){if(!P(t))throw Error("Invalid input to extend: expected a plain object");let r=e._zod.def.checks;if(r&&r.length>0)throw Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");let n=j(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t};return E(this,"shape",r),r},checks:[]});return M(e,n)}function V(e,t){if(!P(t))throw Error("Invalid input to safeExtend: expected a plain object");let r={...e._zod.def,get shape(){let r={...e._zod.def.shape,...t};return E(this,"shape",r),r},checks:e._zod.def.checks};return M(e,r)}function X(e,t){let r=j(e._zod.def,{get shape(){let r={...e._zod.def.shape,...t._zod.def.shape};return E(this,"shape",r),r},get catchall(){return t._zod.def.catchall},checks:[]});return M(e,r)}function W(e,t,r){let n=j(t._zod.def,{get shape(){let n=t._zod.def.shape,o={...n};if(r)for(let t in r){if(!(t in n))throw Error(`Unrecognized key: "${t}"`);r[t]&&(o[t]=e?new e({type:"optional",innerType:n[t]}):n[t])}else for(let t in n)o[t]=e?new e({type:"optional",innerType:n[t]}):n[t];return E(this,"shape",o),o},checks:[]});return M(t,n)}function Y(e,t,r){let n=j(t._zod.def,{get shape(){let n=t._zod.def.shape,o={...n};if(r)for(let t in r){if(!(t in o))throw Error(`Unrecognized key: "${t}"`);r[t]&&(o[t]=new e({type:"nonoptional",innerType:n[t]}))}else for(let t in n)o[t]=new e({type:"nonoptional",innerType:n[t]});return E(this,"shape",o),o},checks:[]});return M(t,n)}function Q(e,t=0){if(!0===e.aborted)return!0;for(let r=t;r<e.issues.length;r++)if(e.issues[r]?.continue!==!0)return!0;return!1}function ee(e,t){return t.map(t=>(t.path??(t.path=[]),t.path.unshift(e),t))}function et(e){return"string"==typeof e?e:e?.message}function er(e,t,r){let n={...e,path:e.path??[]};return e.message||(n.message=et(e.inst?._zod.def?.error?.(e))??et(t?.error?.(e))??et(r.customError?.(e))??et(r.localeError?.(e))??"Invalid input"),delete n.inst,delete n.continue,t?.reportInput||delete n.input,n}function en(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function eo(e){return Array.isArray(e)?"array":"string"==typeof e?"string":"unknown"}function ea(...e){let[t,r,n]=e;return"string"==typeof t?{message:t,code:"custom",input:r,inst:n}:{...t}}function ei(e){return Object.entries(e).filter(([e,t])=>Number.isNaN(Number.parseInt(e,10))).map(e=>e[1])}function es(e){let t=atob(e),r=new Uint8Array(t.length);for(let e=0;e<t.length;e++)r[e]=t.charCodeAt(e);return r}function el(e){let t="";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function ec(e){let t=e.replace(/-/g,"+").replace(/_/g,"/"),r="=".repeat((4-t.length%4)%4);return es(t+r)}function eu(e){return el(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function ed(e){let t=e.replace(/^0x/,"");if(t.length%2!=0)throw Error("Invalid hex string length");let r=new Uint8Array(t.length/2);for(let e=0;e<t.length;e+=2)r[e/2]=Number.parseInt(t.slice(e,e+2),16);return r}function ep(e){return Array.from(e).map(e=>e.toString(16).padStart(2,"0")).join("")}class ef{constructor(...e){}}e.s(["BIGINT_FORMAT_RANGES",0,G,"Class",()=>ef,"NUMBER_FORMAT_RANGES",0,H,"aborted",()=>Q,"allowsEval",0,C,"assert",()=>p,"assertEqual",()=>l,"assertIs",()=>u,"assertNever",()=>d,"assertNotEqual",()=>c,"assignProp",()=>E,"base64ToUint8Array",()=>es,"base64urlToUint8Array",()=>ec,"cached",()=>g,"captureStackTrace",0,T,"cleanEnum",()=>ei,"cleanRegex",()=>_,"clone",()=>M,"cloneDef",()=>z,"createTransparentProxy",()=>B,"defineLazy",()=>v,"esc",()=>O,"escapeRegex",()=>D,"extend",()=>K,"finalizeIssue",()=>er,"floatSafeRemainder",()=>b,"getElementAtPath",()=>R,"getEnumValues",()=>f,"getLengthableOrigin",()=>eo,"getParsedType",0,e=>{let t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":if(Array.isArray(e))return"array";if(null===e)return"null";if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return"promise";if("undefined"!=typeof Map&&e instanceof Map)return"map";if("undefined"!=typeof Set&&e instanceof Set)return"set";if("undefined"!=typeof Date&&e instanceof Date)return"date";if("undefined"!=typeof File&&e instanceof File)return"file";return"object";default:throw Error(`Unknown data type: ${t}`)}},"getSizableOrigin",()=>en,"hexToUint8Array",()=>ed,"isObject",()=>k,"isPlainObject",()=>P,"issue",()=>ea,"joinValues",()=>h,"jsonStringifyReplacer",()=>m,"merge",()=>X,"mergeDefs",()=>j,"normalizeParams",()=>q,"nullish",()=>y,"numKeys",()=>N,"objectClone",()=>x,"omit",()=>Z,"optionalKeys",()=>L,"partial",()=>W,"pick",()=>J,"prefixIssues",()=>ee,"primitiveTypes",0,U,"promiseAllObject",()=>S,"propertyKeyTypes",0,$,"randomString",()=>A,"required",()=>Y,"safeExtend",()=>V,"shallowClone",()=>I,"stringifyPrimitive",()=>F,"uint8ArrayToBase64",()=>el,"uint8ArrayToBase64url",()=>eu,"uint8ArrayToHex",()=>ep,"unwrapMessage",()=>et],757460);let eh=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,m,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},em=r("$ZodError",eh),eg=r("$ZodError",eh,{Parent:Error});function ey(e,t=e=>e.message){let r={},n=[];for(let o of e.issues)o.path.length>0?(r[o.path[0]]=r[o.path[0]]||[],r[o.path[0]].push(t(o))):n.push(t(o));return{formErrors:n,fieldErrors:r}}function e_(e,t=e=>e.message){let r={_errors:[]},n=e=>{for(let o of e.issues)if("invalid_union"===o.code&&o.errors.length)o.errors.map(e=>n({issues:e}));else if("invalid_key"===o.code)n({issues:o.issues});else if("invalid_element"===o.code)n({issues:o.issues});else if(0===o.path.length)r._errors.push(t(o));else{let e=r,n=0;for(;n<o.path.length;){let r=o.path[n];n===o.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(o))):e[r]=e[r]||{_errors:[]},e=e[r],n++}}};return n(e),r}function eb(e,t=e=>e.message){let r={errors:[]},n=(e,o=[])=>{var a,i;for(let s of e.issues)if("invalid_union"===s.code&&s.errors.length)s.errors.map(e=>n({issues:e},s.path));else if("invalid_key"===s.code)n({issues:s.issues},s.path);else if("invalid_element"===s.code)n({issues:s.issues},s.path);else{let e=[...o,...s.path];if(0===e.length){r.errors.push(t(s));continue}let n=r,l=0;for(;l<e.length;){let r=e[l],o=l===e.length-1;"string"==typeof r?(n.properties??(n.properties={}),(a=n.properties)[r]??(a[r]={errors:[]}),n=n.properties[r]):(n.items??(n.items=[]),(i=n.items)[r]??(i[r]={errors:[]}),n=n.items[r]),o&&n.errors.push(t(s)),l++}}};return n(e),r}function ew(e){let t=[];for(let r of e.map(e=>"object"==typeof e?e.key:e))"number"==typeof r?t.push(`[${r}]`):"symbol"==typeof r?t.push(`[${JSON.stringify(String(r))}]`):/[^\w$]/.test(r)?t.push(`[${JSON.stringify(r)}]`):(t.length&&t.push("."),t.push(r));return t.join("")}function ev(e){let t=[];for(let r of[...e.issues].sort((e,t)=>(e.path??[]).length-(t.path??[]).length))t.push(`✖ ${r.message}`),r.path?.length&&t.push(`  → at ${ew(r.path)}`);return t.join("\n")}e.s(["$ZodError",0,em,"$ZodRealError",0,eg,"flattenError",()=>ey,"formatError",()=>e_,"prettifyError",()=>ev,"toDotPath",()=>ew,"treeifyError",()=>eb],704329);let ex=(e,t)=>{em.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:t=>e_(e,t)},flatten:{value:t=>ey(e,t)},addIssue:{value:t=>{e.issues.push(t),e.message=JSON.stringify(e.issues,m,2)}},addIssues:{value:t=>{e.issues.push(...t),e.message=JSON.stringify(e.issues,m,2)}},isEmpty:{get:()=>0===e.issues.length}})},eE=r("ZodError",ex),ej=r("ZodError",ex,{Parent:Error});e.s(["ZodError",0,eE,"ZodRealError",0,ej],417446)},715051,e=>{"use strict";e.i(511368),e.s([])},36869,e=>{"use strict";var t=e.i(443608);let r="Thorbis-FMS/1.0 (support@thorbis.app)",n=t.z.object({dateTime:t.z.string().optional(),date:t.z.string().optional(),timeZone:t.z.string().optional()}),o=t.z.object({email:t.z.string().email(),displayName:t.z.string().optional(),responseStatus:t.z.enum(["needsAction","declined","tentative","accepted"]).optional(),optional:t.z.boolean().optional(),organizer:t.z.boolean().optional(),self:t.z.boolean().optional()}),a=t.z.object({method:t.z.enum(["email","popup","sms"]),minutes:t.z.number()}),i=t.z.object({id:t.z.string().optional(),status:t.z.enum(["confirmed","tentative","cancelled"]).optional(),htmlLink:t.z.string().optional(),created:t.z.string().optional(),updated:t.z.string().optional(),summary:t.z.string(),description:t.z.string().optional(),location:t.z.string().optional(),colorId:t.z.string().optional(),start:n,end:n,recurrence:t.z.array(t.z.string()).optional(),attendees:t.z.array(o).optional(),reminders:t.z.object({useDefault:t.z.boolean(),overrides:t.z.array(a).optional()}).optional(),extendedProperties:t.z.object({private:t.z.record(t.z.string()).optional(),shared:t.z.record(t.z.string()).optional()}).optional(),visibility:t.z.enum(["default","public","private","confidential"]).optional(),transparency:t.z.enum(["opaque","transparent"]).optional()}),s=t.z.object({start:t.z.string(),end:t.z.string()}),l=t.z.object({busy:t.z.array(s),errors:t.z.array(t.z.object({domain:t.z.string(),reason:t.z.string()})).optional()}),c=t.z.object({id:t.z.string(),summary:t.z.string(),description:t.z.string().optional(),location:t.z.string().optional(),timeZone:t.z.string().optional(),colorId:t.z.string().optional(),backgroundColor:t.z.string().optional(),foregroundColor:t.z.string().optional(),selected:t.z.boolean().optional(),accessRole:t.z.enum(["freeBusyReader","reader","writer","owner"]).optional(),primary:t.z.boolean().optional()});t.z.object({id:t.z.string(),jobNumber:t.z.string().optional(),title:t.z.string(),description:t.z.string().optional(),startTime:t.z.date(),endTime:t.z.date(),location:t.z.object({address:t.z.string(),lat:t.z.number().optional(),lng:t.z.number().optional()}).optional(),customer:t.z.object({name:t.z.string(),phone:t.z.string().optional(),email:t.z.string().optional()}).optional(),technicians:t.z.array(t.z.object({id:t.z.string(),name:t.z.string(),email:t.z.string().optional()})).optional(),jobType:t.z.string().optional(),status:t.z.string().optional(),priority:t.z.enum(["low","normal","high","emergency"]).optional(),notes:t.z.string().optional()});let u={emergency:"11",high:"6",normal:"7",low:"2"},d=new class{clientId;clientSecret;redirectUri;constructor(){this.clientId=process.env.GOOGLE_OAUTH_CLIENT_ID,this.clientSecret=process.env.GOOGLE_OAUTH_CLIENT_SECRET,this.redirectUri=process.env.GOOGLE_OAUTH_REDIRECT_URI||"http://localhost:3000/api/auth/google/callback"}isConfigured(){return!!this.clientId&&!!this.clientSecret}getAuthUrl(e,t){if(!this.clientId)throw Error("Google OAuth client ID not configured");let r=new URLSearchParams({client_id:this.clientId,redirect_uri:this.redirectUri,response_type:"code",scope:"https://www.googleapis.com/auth/calendar https://www.googleapis.com/auth/calendar.events",access_type:"offline",prompt:"consent",state:JSON.stringify({state:e,userId:t})});return`https://accounts.google.com/o/oauth2/v2/auth?${r.toString()}`}async exchangeCodeForTokens(e){if(!this.clientId||!this.clientSecret)return console.error("Google OAuth not configured"),null;try{let t=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":r},body:new URLSearchParams({client_id:this.clientId,client_secret:this.clientSecret,code:e,grant_type:"authorization_code",redirect_uri:this.redirectUri})});if(!t.ok){let e=await t.text();return console.error("Token exchange failed:",e),null}let n=await t.json();return{accessToken:n.access_token,refreshToken:n.refresh_token,expiresAt:new Date(Date.now()+1e3*n.expires_in),scope:n.scope}}catch(e){return console.error("Token exchange error:",e),null}}async refreshAccessToken(e){if(!this.clientId||!this.clientSecret)return null;try{let t=await fetch("https://oauth2.googleapis.com/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded","User-Agent":r},body:new URLSearchParams({client_id:this.clientId,client_secret:this.clientSecret,refresh_token:e,grant_type:"refresh_token"})});if(!t.ok)return null;let n=await t.json();return{accessToken:n.access_token,refreshToken:n.refresh_token||e,expiresAt:new Date(Date.now()+1e3*n.expires_in),scope:n.scope}}catch(e){return console.error("Token refresh error:",e),null}}async listCalendars(e){try{let t=await fetch("https://www.googleapis.com/calendar/v3/users/me/calendarList",{headers:{Authorization:`Bearer ${e}`,"User-Agent":r}});if(!t.ok)return console.error(`Calendar list error: ${t.status} ${t.statusText}`),[];return((await t.json()).items||[]).map(e=>c.parse(e))}catch(e){return console.error("List calendars error:",e),[]}}async createJobEvent(e,t,n="primary"){try{let o=this.appointmentToEvent(t),a=await fetch(`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(n)}/events`,{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json","User-Agent":r},body:JSON.stringify(o)});if(!a.ok){let e=await a.text();return console.error(`Create event error: ${a.status}`,e),null}let s=await a.json();return i.parse(s)}catch(e){return console.error("Create event error:",e),null}}async updateJobEvent(e,t,n,o="primary"){try{let a=this.appointmentToEvent(n),s=await fetch(`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(o)}/events/${encodeURIComponent(t)}`,{method:"PUT",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json","User-Agent":r},body:JSON.stringify(a)});if(!s.ok)return console.error(`Update event error: ${s.status}`),null;let l=await s.json();return i.parse(l)}catch(e){return console.error("Update event error:",e),null}}async deleteEvent(e,t,n="primary"){try{let o=await fetch(`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(n)}/events/${encodeURIComponent(t)}`,{method:"DELETE",headers:{Authorization:`Bearer ${e}`,"User-Agent":r}});return o.ok||404===o.status}catch(e){return console.error("Delete event error:",e),!1}}async getEvent(e,t,n="primary"){try{let o=await fetch(`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(n)}/events/${encodeURIComponent(t)}`,{headers:{Authorization:`Bearer ${e}`,"User-Agent":r}});if(!o.ok)return null;let a=await o.json();return i.parse(a)}catch(e){return console.error("Get event error:",e),null}}async listEvents(e,t){try{let n=new URLSearchParams({timeMin:t.timeMin.toISOString(),timeMax:t.timeMax.toISOString(),maxResults:String(t.maxResults||250),singleEvents:String(t.singleEvents??!0),orderBy:t.orderBy||"startTime"}),o=t.calendarId||"primary",a=await fetch(`https://www.googleapis.com/calendar/v3/calendars/${encodeURIComponent(o)}/events?${n}`,{headers:{Authorization:`Bearer ${e}`,"User-Agent":r}});if(!a.ok)return console.error(`List events error: ${a.status}`),[];return((await a.json()).items||[]).map(e=>i.parse(e))}catch(e){return console.error("List events error:",e),[]}}async getFreeBusy(e,t){try{let n=await fetch("https://www.googleapis.com/calendar/v3/freeBusy",{method:"POST",headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json","User-Agent":r},body:JSON.stringify({timeMin:t.timeMin.toISOString(),timeMax:t.timeMax.toISOString(),timeZone:t.timeZone||"America/New_York",items:t.calendarIds.map(e=>({id:e}))})});if(!n.ok)return console.error(`Free/busy error: ${n.status}`),new Map;let o=await n.json(),a=new Map;for(let[e,t]of Object.entries(o.calendars||{}))a.set(e,l.parse(t));return a}catch(e){return console.error("Free/busy error:",e),new Map}}async findAvailableSlots(e,t){let r=t.startHour??8,n=t.endHour??18,o=t.slotIntervalMinutes??30,a=new Date(t.date);a.setHours(r,0,0,0);let i=new Date(t.date);i.setHours(n,0,0,0);let s=await this.getFreeBusy(e,{calendarIds:t.calendarIds,timeMin:a,timeMax:i}),l=[];for(let e of s.values())for(let t of e.busy)l.push({start:new Date(t.start),end:new Date(t.end)});l.sort((e,t)=>e.start.getTime()-t.start.getTime());let c=[],u=a;for(;u.getTime()+6e4*t.durationMinutes<=i.getTime();){let e=new Date(u.getTime()+6e4*t.durationMinutes);l.some(t=>u<t.end&&e>t.start)||c.push({start:new Date(u),end:e}),u=new Date(u.getTime()+6e4*o)}return c}async syncTechnicianAppointments(e,t,r,n="primary"){let o={created:[],updated:[],deleted:[],errors:[],newSyncMap:new Map},a=new Set;for(let i of t){a.add(i.id);let t=r.get(i.id);try{if(t){let r=await this.updateJobEvent(e,t,i,n);r?.id?(o.updated.push(i.id),o.newSyncMap.set(i.id,r.id)):o.errors.push({appointmentId:i.id,error:"Failed to update event"})}else{let t=await this.createJobEvent(e,i,n);t?.id?(o.created.push(i.id),o.newSyncMap.set(i.id,t.id)):o.errors.push({appointmentId:i.id,error:"Failed to create event"})}}catch(e){o.errors.push({appointmentId:i.id,error:e instanceof Error?e.message:"Unknown error"})}}for(let[t,i]of r)!a.has(t)&&await this.deleteEvent(e,i,n)&&o.deleted.push(t);return o}appointmentToEvent(e){let t,r=[];e.jobNumber&&r.push(`Job #: ${e.jobNumber}`),e.customer&&(r.push(`
Customer: ${e.customer.name}`),e.customer.phone&&r.push(`Phone: ${e.customer.phone}`),e.customer.email&&r.push(`Email: ${e.customer.email}`)),e.jobType&&r.push(`
Job Type: ${e.jobType}`),e.status&&r.push(`Status: ${e.status}`),e.priority&&r.push(`Priority: ${e.priority.toUpperCase()}`),e.notes&&r.push(`
Notes:
${e.notes}`),e.description&&r.push(`
Description:
${e.description}`),e.location&&(t=e.location.address);let n=[];if(e.technicians)for(let t of e.technicians)t.email&&n.push({email:t.email,displayName:t.name});e.customer?.email&&n.push({email:e.customer.email,displayName:e.customer.name,optional:!0});let o=e.priority?u[e.priority]:void 0;return{summary:e.title,description:r.join("\n"),location:t,start:{dateTime:e.startTime.toISOString(),timeZone:"America/New_York"},end:{dateTime:e.endTime.toISOString(),timeZone:"America/New_York"},attendees:n.length>0?n:void 0,colorId:o,reminders:{useDefault:!1,overrides:[{method:"popup",minutes:60},{method:"popup",minutes:15}]},extendedProperties:{private:{stratosAppointmentId:e.id,stratosJobNumber:e.jobNumber||"",stratosJobType:e.jobType||""}},visibility:"private"}}};e.s(["googleCalendarService",0,d])},894498,e=>{"use strict";var t=e.i(755535),r=e.i(377233),n=e.i(490003),o=e.i(492991),a=e.i(241970),i=e.i(357699),s=e.i(212454),l=e.i(48717),c=e.i(798301),u=e.i(986366),d=e.i(983537),p=e.i(147475),f=e.i(561930),h=e.i(803747),m=e.i(368557),g=e.i(42037),y=e.i(193695);e.i(432036);var _=e.i(573881),b=e.i(297676),w=e.i(36869);e.i(715051);var v=e.i(511368);async function x(e){let t=await (0,v.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)return b.NextResponse.json({error:"Unauthorized"},{status:401});try{let{data:e,error:n}=await t.from("team_members").select("google_calendar_connected, google_calendar_refresh_token, google_calendar_id").eq("user_id",r.id).single();if(n||!e)return b.NextResponse.json({error:"User not found"},{status:404});if(!e.google_calendar_connected)return b.NextResponse.json({connected:!1,message:"Google Calendar not connected"});let o=await w.googleCalendarService.refreshAccessToken(e.google_calendar_refresh_token);if(!o)return await t.from("team_members").update({google_calendar_connected:!1,updated_at:new Date().toISOString()}).eq("user_id",r.id),b.NextResponse.json({connected:!1,message:"Calendar connection expired. Please reconnect."});let a=new Date,i=new Date(a.getTime()+6048e5),s=(await w.googleCalendarService.listEvents(o.accessToken,{calendarId:e.google_calendar_id||"primary",timeMin:a,timeMax:i})).filter(e=>e.extendedProperties?.private?.stratosAppointmentId);return b.NextResponse.json({connected:!0,calendarId:e.google_calendar_id||"primary",events:s.map(e=>({id:e.id,title:e.summary,start:e.start.dateTime||e.start.date,end:e.end.dateTime||e.end.date,location:e.location,appointmentId:e.extendedProperties?.private?.stratosAppointmentId,jobNumber:e.extendedProperties?.private?.stratosJobNumber})),totalEvents:s.length})}catch(e){return console.error("Calendar sync status error:",e),b.NextResponse.json({error:"Internal server error"},{status:500})}}async function E(e){let t=await (0,v.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)return b.NextResponse.json({error:"Unauthorized"},{status:401});try{let{technicianId:n,appointments:o}=await e.json(),a=n||r.id,{data:i,error:s}=await t.from("team_members").select("id, google_calendar_connected, google_calendar_refresh_token, google_calendar_id").eq("user_id",a).single();if(s||!i)return b.NextResponse.json({error:"User not found"},{status:404});if(!i.google_calendar_connected)return b.NextResponse.json({error:"Google Calendar not connected"},{status:400});let l=await w.googleCalendarService.refreshAccessToken(i.google_calendar_refresh_token);if(!l)return b.NextResponse.json({error:"Calendar connection expired. Please reconnect."},{status:401});let{data:c}=await t.from("calendar_sync_mappings").select("appointment_id, google_event_id").eq("team_member_id",i.id),u=new Map;for(let e of c||[])u.set(e.appointment_id,e.google_event_id);let d=o.map(e=>({id:e.id,jobNumber:e.job_number,title:e.title,description:e.description,startTime:new Date(e.start_time),endTime:new Date(e.end_time),location:e.address?{address:e.address,lat:e.lat,lng:e.lng}:void 0,customer:e.customer_name?{name:e.customer_name,phone:e.customer_phone,email:e.customer_email}:void 0,jobType:e.job_type,status:e.status,priority:e.priority,notes:e.notes})),p=await w.googleCalendarService.syncTechnicianAppointments(l.accessToken,d,u,i.google_calendar_id||"primary"),f=Array.from(p.newSyncMap.entries()).map(([e,t])=>({team_member_id:i.id,appointment_id:e,google_event_id:t,last_synced_at:new Date().toISOString()}));return f.length>0&&await t.from("calendar_sync_mappings").upsert(f,{onConflict:"team_member_id,appointment_id"}),p.deleted.length>0&&await t.from("calendar_sync_mappings").delete().eq("team_member_id",i.id).in("appointment_id",p.deleted),b.NextResponse.json({success:!0,created:p.created.length,updated:p.updated.length,deleted:p.deleted.length,errors:p.errors})}catch(e){return console.error("Calendar sync error:",e),b.NextResponse.json({error:"Internal server error"},{status:500})}}async function j(e){let t=await (0,v.createClient)(),{data:{user:r}}=await t.auth.getUser();if(!r)return b.NextResponse.json({error:"Unauthorized"},{status:401});try{let{date:n,durationMinutes:o=60,technicianIds:a}=await e.json();if(!n)return b.NextResponse.json({error:"Date is required"},{status:400});let{data:i}=await t.from("team_members").select("id, user_id, google_calendar_connected, google_calendar_refresh_token, google_calendar_id").eq("google_calendar_connected",!0).in("user_id",a||[r.id]);if(!i||0===i.length)return b.NextResponse.json({slots:[],message:"No connected calendars found"});let s={};for(let e of i){let t=await w.googleCalendarService.refreshAccessToken(e.google_calendar_refresh_token);if(!t)continue;let r=await w.googleCalendarService.findAvailableSlots(t.accessToken,{calendarIds:[e.google_calendar_id||"primary"],date:new Date(n),durationMinutes:o});s[e.user_id]=r}return b.NextResponse.json({date:n,durationMinutes:o,availability:s})}catch(e){return console.error("Free/busy check error:",e),b.NextResponse.json({error:"Internal server error"},{status:500})}}e.s(["GET",()=>x,"POST",()=>E,"PUT",()=>j],919211);var z=e.i(919211);let R=new t.AppRouteRouteModule({definition:{kind:r.RouteKind.APP_ROUTE,page:"/api/calendar/sync/route",pathname:"/api/calendar/sync",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/calendar/sync/route.ts",nextConfigOutput:"",userland:z}),{workAsyncStorage:S,workUnitAsyncStorage:A,serverHooks:O}=R;function T(){return(0,n.patchFetch)({workAsyncStorage:S,workUnitAsyncStorage:A})}async function k(e,t,n){R.isDev&&(0,o.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let b="/api/calendar/sync/route";b=b.replace(/\/index$/,"")||"/";let w=await R.prepare(e,t,{srcPage:b,multiZoneDraftMode:!1});if(!w)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:v,params:x,nextConfig:E,parsedUrl:j,isDraftMode:z,prerenderManifest:S,routerServerContext:A,isOnDemandRevalidate:O,revalidateOnlyGenerated:T,resolvedPathname:k,clientReferenceManifest:C,serverActionsManifest:P}=w,I=(0,l.normalizeAppPath)(b),N=!!(S.dynamicRoutes[I]||S.routes[k]),$=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,j,!1):t.end("This page could not be found"),null);if(N&&!z){let e=!!S.routes[k],t=S.dynamicRoutes[I];if(t&&!1===t.fallback&&!e){if(E.experimental.adapterPath)return await $();throw new y.NoFallbackError}}let U=null;!N||R.isDev||z||(U="/index"===(U=k)?"/":U);let D=!0===R.isDev||!N,M=N&&!D;P&&C&&(0,i.setReferenceManifestsSingleton)({page:b,clientReferenceManifest:C,serverActionsManifest:P,serverModuleMap:(0,s.createServerModuleMap)({serverActionsManifest:P})});let q=e.method||"GET",B=(0,a.getTracer)(),F=B.getActiveScopeSpan(),L={params:x,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!E.experimental.authInterrupts},cacheComponents:!!E.cacheComponents,supportsDynamicResponse:D,incrementalCache:(0,o.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:E.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,n)=>R.onRequestError(e,t,n,A)},sharedContext:{buildId:v}},H=new c.NodeNextRequest(e),G=new c.NodeNextResponse(t),J=u.NextRequestAdapter.fromNodeNextRequest(H,(0,u.signalFromNodeResponse)(t));try{let i=async e=>R.handle(J,L).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=B.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==d.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${q} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${q} ${b}`)}),s=!!(0,o.getRequestMeta)(e,"minimalMode"),l=async o=>{var a,l;let c=async({previousCacheEntry:r})=>{try{if(!s&&O&&T&&!r)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await i(o);e.fetchMetrics=L.renderOpts.fetchMetrics;let l=L.renderOpts.pendingWaitUntil;l&&n.waitUntil&&(n.waitUntil(l),l=void 0);let c=L.renderOpts.collectedTags;if(!N)return await (0,f.sendResponse)(H,G,a,L.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,h.toNodeOutgoingHttpHeaders)(a.headers);c&&(t[g.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==L.renderOpts.collectedRevalidate&&!(L.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&L.renderOpts.collectedRevalidate,n=void 0===L.renderOpts.collectedExpire||L.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:L.renderOpts.collectedExpire;return{value:{kind:_.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==r?void 0:r.isStale)&&await R.onRequestError(e,t,{routerKind:"App Router",routePath:b,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:O})},A),t}},u=await R.handleResponse({req:e,nextConfig:E,cacheKey:U,routeKind:r.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:O,revalidateOnlyGenerated:T,responseGenerator:c,waitUntil:n.waitUntil,isMinimalMode:s});if(!N)return null;if((null==u||null==(a=u.value)?void 0:a.kind)!==_.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(l=u.value)?void 0:l.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",O?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),z&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let d=(0,h.fromNodeOutgoingHttpHeaders)(u.value.headers);return s&&N||d.delete(g.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||d.get("Cache-Control")||d.set("Cache-Control",(0,m.getCacheControlHeader)(u.cacheControl)),await (0,f.sendResponse)(H,G,new Response(u.value.body,{headers:d,status:u.value.status||200})),null};F?await l(F):await B.withPropagatedContext(e.headers,()=>B.trace(d.BaseServerSpan.handleRequest,{spanName:`${q} ${b}`,kind:a.SpanKind.SERVER,attributes:{"http.method":q,"http.target":e.url}},l))}catch(t){if(t instanceof y.NoFallbackError||await R.onRequestError(e,t,{routerKind:"App Router",routePath:I,routeType:"route",revalidateReason:(0,p.getRevalidateReason)({isStaticGeneration:M,isOnDemandRevalidate:O})}),N)throw t;return await (0,f.sendResponse)(H,G,new Response(null,{status:500})),null}}e.s(["handler",()=>k,"patchFetch",()=>T,"routeModule",()=>R,"serverHooks",()=>O,"workAsyncStorage",()=>S,"workUnitAsyncStorage",()=>A],894498)},226115,e=>{e.v(t=>Promise.all(["server/chunks/3c0ae_next_09aa2dd0._.js"].map(t=>e.l(t))).then(()=>t(766988)))}];

//# sourceMappingURL=%5Broot-of-the-server%5D__75229f22._.js.map