{"version":3,"sources":["../../../../../apps/web/src/lib/telnyx/messaging-profile-setup.ts","../../../../../apps/web/src/lib/telnyx/numbers.ts","../../../../../apps/web/src/lib/telnyx/phone-number-setup.ts","../../../../../apps/web/src/lib/telnyx/config-validator.ts"],"sourcesContent":["/**\n * Messaging Profile Setup & Verification\n *\n * Verifies messaging profile configuration and can auto-update webhook URLs.\n */\n\nimport { TELNYX_CONFIG, telnyxClient } from \"./client\";\n\nexport type MessagingProfileStatus = {\n\texists: boolean;\n\tisActive: boolean;\n\thasWebhookUrl: boolean;\n\twebhookUrl: string | null;\n\twebhookFailoverUrl: string | null;\n\twebhookApiVersion: string | null;\n\tneedsFix: boolean;\n\tissues: string[];\n};\n\nexport type MessagingProfileFixResult = {\n\tsuccess: boolean;\n\tfixed: boolean;\n\terror?: string;\n\tchanges: string[];\n};\n\nfunction getWebhookUrl(): string | undefined {\n\tconst candidates = [\n\t\tprocess.env.NEXT_PUBLIC_SITE_URL,\n\t\tprocess.env.SITE_URL,\n\t\tprocess.env.NEXT_PUBLIC_APP_URL,\n\t\tprocess.env.APP_URL,\n\t];\n\t\n\tconst isDevelopment = \n\t\tprocess.env.NODE_ENV === \"development\" ||\n\t\tprocess.env.VERCEL_ENV !== \"production\" ||\n\t\tprocess.env.DEPLOYMENT_ENV !== \"production\";\n\t\n\tfor (const candidate of candidates) {\n\t\tif (candidate && candidate.trim()) {\n\t\t\tconst trimmed = candidate.trim();\n\t\t\tconst isLocal =\n\t\t\t\ttrimmed.includes(\"localhost\") ||\n\t\t\t\ttrimmed.includes(\"127.0.0.1\") ||\n\t\t\t\ttrimmed.includes(\"0.0.0.0\");\n\t\t\t\n\t\t\t// In development, allow localhost URLs (useful for testing with ngrok or similar)\n\t\t\t// In production, reject localhost\n\t\t\tif (isLocal && !isDevelopment) {\n\t\t\t\tcontinue; // Skip localhost in production\n\t\t\t}\n\t\t\t\n\t\t\tconst normalized = trimmed.startsWith(\"http\")\n\t\t\t\t? trimmed\n\t\t\t\t: `https://${trimmed}`;\n\t\t\treturn `${normalized.replace(/\\/+$/, \"\")}/api/webhooks/telnyx`;\n\t\t}\n\t}\n\treturn undefined;\n}\n\n/**\n * Verify messaging profile configuration\n */\nexport async function verifyMessagingProfile(\n\tmessagingProfileId?: string,\n): Promise<MessagingProfileStatus> {\n\tconst profileId = messagingProfileId || TELNYX_CONFIG.messagingProfileId;\n\n\tconst status: MessagingProfileStatus = {\n\t\texists: false,\n\t\tisActive: false,\n\t\thasWebhookUrl: false,\n\t\twebhookUrl: null,\n\t\twebhookFailoverUrl: null,\n\t\twebhookApiVersion: null,\n\t\tneedsFix: false,\n\t\tissues: [],\n\t};\n\n\tif (!profileId || profileId.trim() === \"\") {\n\t\tstatus.issues.push(\"Messaging profile ID is not configured\");\n\t\tstatus.needsFix = true;\n\t\treturn status;\n\t}\n\n\ttry {\n\t\tconst profile = await telnyxClient.messagingProfiles.retrieve(profileId);\n\t\tconst profileData = profile.data as any;\n\n\t\tif (!profileData) {\n\t\t\tstatus.issues.push(`Messaging profile ${profileId} not found in Telnyx`);\n\t\t\tstatus.needsFix = true;\n\t\t\treturn status;\n\t\t}\n\n\t\tstatus.exists = true;\n\t\tstatus.isActive = profileData.enabled !== false;\n\t\tstatus.webhookUrl = profileData.webhook_url || null;\n\t\tstatus.webhookFailoverUrl = profileData.webhook_failover_url || null;\n\t\tstatus.webhookApiVersion = profileData.webhook_api_version || null;\n\n\t\t// Check webhook URL\n\t\tconst expectedWebhookUrl = getWebhookUrl();\n\t\tif (!expectedWebhookUrl) {\n\t\t\tconst isDevelopment = \n\t\t\t\tprocess.env.NODE_ENV === \"development\" ||\n\t\t\t\tprocess.env.VERCEL_ENV !== \"production\" ||\n\t\t\t\tprocess.env.DEPLOYMENT_ENV !== \"production\";\n\t\t\t\n\t\t\tif (isDevelopment) {\n\t\t\t\tstatus.issues.push(\n\t\t\t\t\t\"NEXT_PUBLIC_SITE_URL is not set. Set it to your production URL (e.g., https://yourdomain.com) or use a tool like ngrok for local testing.\",\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tstatus.issues.push(\n\t\t\t\t\t\"NEXT_PUBLIC_SITE_URL is not set to a valid production URL. Set it to your production domain (e.g., https://yourdomain.com) in your environment variables.\",\n\t\t\t\t);\n\t\t\t}\n\t\t\tstatus.needsFix = true;\n\t\t} else if (!status.webhookUrl) {\n\t\t\tstatus.issues.push(\n\t\t\t\t`Webhook URL is not set. Expected: ${expectedWebhookUrl} (with optional ?company=... for multi-tenant)`,\n\t\t\t);\n\t\t\tstatus.needsFix = true;\n\t\t} else {\n\t\t\t// Accept both base webhook URL and company-specific URLs (with query params)\n\t\t\tconst baseUrl = status.webhookUrl.split(\"?\")[0];\n\t\t\tif (\n\t\t\t\tbaseUrl === expectedWebhookUrl ||\n\t\t\t\tstatus.webhookUrl === expectedWebhookUrl\n\t\t\t) {\n\t\t\t\tstatus.hasWebhookUrl = true;\n\t\t\t} else {\n\t\t\t\tstatus.issues.push(\n\t\t\t\t\t`Webhook URL base is not set correctly. Expected: ${expectedWebhookUrl}, Current: ${baseUrl}`,\n\t\t\t\t);\n\t\t\t\tstatus.needsFix = true;\n\t\t\t}\n\t\t}\n\n\t\t// Check webhook API version\n\t\tif (status.webhookApiVersion !== \"2\") {\n\t\t\tstatus.issues.push(\n\t\t\t\t`Webhook API version should be \"2\", but is \"${status.webhookApiVersion || \"not set\"}\"`,\n\t\t\t);\n\t\t\tstatus.needsFix = true;\n\t\t}\n\n\t\t// Check if profile is active\n\t\tif (!status.isActive) {\n\t\t\tstatus.issues.push(\"Messaging profile is not enabled\");\n\t\t\tstatus.needsFix = true;\n\t\t}\n\n\t\treturn status;\n\t} catch (error: any) {\n\t\tif (error?.statusCode === 404) {\n\t\t\tstatus.issues.push(`Messaging profile ${profileId} not found in Telnyx`);\n\t\t} else {\n\t\t\tstatus.issues.push(\n\t\t\t\terror?.message || \"Failed to retrieve messaging profile\",\n\t\t\t);\n\t\t}\n\t\tstatus.needsFix = true;\n\t\treturn status;\n\t}\n}\n\n/**\n * Auto-fix messaging profile configuration\n */\nexport async function fixMessagingProfile(\n\tmessagingProfileId?: string,\n\toptions?: {\n\t\twebhookUrl?: string;\n\t\twebhookFailoverUrl?: string;\n\t},\n): Promise<MessagingProfileFixResult> {\n\tconst profileId = messagingProfileId || TELNYX_CONFIG.messagingProfileId;\n\tconst changes: string[] = [];\n\n\tif (!profileId || profileId.trim() === \"\") {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\tfixed: false,\n\t\t\terror: \"Messaging profile ID is not configured\",\n\t\t\tchanges: [],\n\t\t};\n\t}\n\n\ttry {\n\t\t// Get current status\n\t\tconst status = await verifyMessagingProfile(profileId);\n\t\tif (!status.needsFix) {\n\t\t\treturn {\n\t\t\t\tsuccess: true,\n\t\t\t\tfixed: false,\n\t\t\t\tchanges: [],\n\t\t\t};\n\t\t}\n\n\t\t// Get expected webhook URL\n\t\tconst expectedWebhookUrl = options?.webhookUrl || getWebhookUrl();\n\t\tif (!expectedWebhookUrl) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\tfixed: false,\n\t\t\t\terror:\n\t\t\t\t\t\"NEXT_PUBLIC_SITE_URL must be set to a valid production URL to configure webhooks\",\n\t\t\t\tchanges: [],\n\t\t\t};\n\t\t}\n\n\t\t// Prepare update\n\t\tconst updateData: Record<string, unknown> = {};\n\n\t\t// Fix webhook URL\n\t\tif (status.webhookUrl !== expectedWebhookUrl) {\n\t\t\tupdateData.webhook_url = expectedWebhookUrl;\n\t\t\tchanges.push(`Updated webhook URL to ${expectedWebhookUrl}`);\n\t\t}\n\n\t\t// Fix webhook failover URL\n\t\tconst expectedFailoverUrl =\n\t\t\toptions?.webhookFailoverUrl ||\n\t\t\tprocess.env.TELNYX_WEBHOOK_FAILOVER_URL ||\n\t\t\tnull;\n\t\tif (status.webhookFailoverUrl !== expectedFailoverUrl) {\n\t\t\tupdateData.webhook_failover_url = expectedFailoverUrl;\n\t\t\tif (expectedFailoverUrl) {\n\t\t\t\tchanges.push(`Updated webhook failover URL to ${expectedFailoverUrl}`);\n\t\t\t} else {\n\t\t\t\tchanges.push(\"Removed webhook failover URL\");\n\t\t\t}\n\t\t}\n\n\t\t// Fix webhook API version\n\t\tif (status.webhookApiVersion !== \"2\") {\n\t\t\tupdateData.webhook_api_version = \"2\";\n\t\t\tchanges.push(\"Updated webhook API version to 2\");\n\t\t}\n\n\t\t// Fix profile enabled status\n\t\tif (!status.isActive) {\n\t\t\tupdateData.enabled = true;\n\t\t\tchanges.push(\"Enabled messaging profile\");\n\t\t}\n\n\t\t// Apply updates if needed\n\t\tif (Object.keys(updateData).length > 0) {\n\t\t\tawait telnyxClient.messagingProfiles.update(profileId, updateData);\n\t\t}\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tfixed: changes.length > 0,\n\t\t\tchanges,\n\t\t};\n\t} catch (error: any) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\tfixed: false,\n\t\t\terror: error?.message || \"Failed to update messaging profile\",\n\t\t\tchanges,\n\t\t};\n\t}\n}\n\n/**\n * Get messaging profile details\n */\nasync function getMessagingProfileDetails(\n\tmessagingProfileId?: string,\n): Promise<{\n\tsuccess: boolean;\n\tdata?: any;\n\terror?: string;\n}> {\n\tconst profileId = messagingProfileId || TELNYX_CONFIG.messagingProfileId;\n\n\tif (!profileId || profileId.trim() === \"\") {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: \"Messaging profile ID is not configured\",\n\t\t};\n\t}\n\n\ttry {\n\t\tconst profile = await telnyxClient.messagingProfiles.retrieve(profileId);\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tdata: profile.data,\n\t\t};\n\t} catch (error: any) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error?.message || \"Failed to retrieve messaging profile\",\n\t\t};\n\t}\n}\n","/**\n * Telnyx Phone Numbers Service - Number Management\n *\n * Handles all phone number operations including:\n * - Searching available numbers\n * - Purchasing numbers\n * - Porting numbers\n * - Configuring number settings\n * - Releasing numbers\n */\n\nimport { telnyxClient } from \"./client\";\n\n/**\n * Number type for search\n */\nexport type NumberType =\n\t| \"local\"\n\t| \"toll-free\"\n\t| \"national\"\n\t| \"mobile\"\n\t| \"shared_cost\";\n\n/**\n * Number features\n */\nexport type NumberFeature = \"sms\" | \"mms\" | \"voice\" | \"fax\";\n\n/**\n * Search for available phone numbers\n */\nexport async function searchAvailableNumbers(params: {\n\tcountryCode?: string;\n\tareaCode?: string;\n\tnumberType?: NumberType;\n\tfeatures?: NumberFeature[];\n\tlimit?: number;\n\tstartsWith?: string;\n\tendsWith?: string;\n\tcontains?: string;\n}) {\n\ttry {\n\t\tconst numbers = await (telnyxClient.availablePhoneNumbers as any).list({\n\t\t\tfilter: {\n\t\t\t\tcountry_code: params.countryCode || \"US\",\n\t\t\t\tnational_destination_code: params.areaCode,\n\t\t\t\tfeatures: params.features,\n\t\t\t\tlimit: params.limit || 10,\n\t\t\t\tstarts_with: params.startsWith,\n\t\t\t\tends_with: params.endsWith,\n\t\t\t\tcontains: params.contains,\n\t\t\t} as any,\n\t\t});\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tdata: numbers.data,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to search numbers\",\n\t\t};\n\t}\n}\n\n/**\n * Purchase a phone number\n */\nexport async function purchaseNumber(params: {\n\tphoneNumber: string;\n\tmessagingProfileId?: string;\n\tconnectionId?: string;\n\tbillingGroupId?: string;\n\tcustomerReference?: string;\n}) {\n\ttry {\n\t\tconst number = await telnyxClient.numberOrders.create({\n\t\t\tphone_numbers: [\n\t\t\t\t{\n\t\t\t\t\tphone_number: params.phoneNumber,\n\t\t\t\t},\n\t\t\t],\n\t\t\tmessaging_profile_id: params.messagingProfileId,\n\t\t\tconnection_id: params.connectionId,\n\t\t\tbilling_group_id: params.billingGroupId,\n\t\t\tcustomer_reference: params.customerReference,\n\t\t});\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\torderId: number.data?.id,\n\t\t\tdata: number.data,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to purchase number\",\n\t\t};\n\t}\n}\n\n/**\n * List all owned phone numbers\n */\nexport async function listOwnedNumbers(params?: {\n\tpageSize?: number;\n\tpageNumber?: number;\n\tfilterTag?: string;\n\tfilterStatus?: \"active\" | \"pending\" | \"suspended\" | \"deleted\";\n}) {\n\ttry {\n\t\tconst numbers = await (telnyxClient.phoneNumbers as any).list({\n\t\t\tpage: {\n\t\t\t\tsize: params?.pageSize || 20,\n\t\t\t\tnumber: params?.pageNumber || 1,\n\t\t\t},\n\t\t\tfilter: {\n\t\t\t\ttag: params?.filterTag,\n\t\t\t\tstatus: params?.filterStatus,\n\t\t\t} as any,\n\t\t});\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tdata: numbers.data,\n\t\t\tmeta: numbers.meta,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error instanceof Error ? error.message : \"Failed to list numbers\",\n\t\t};\n\t}\n}\n\n/**\n * Get phone number details\n */\nexport async function getNumberDetails(phoneNumberId: string) {\n\ttry {\n\t\tconst number = await (telnyxClient.phoneNumbers as any).retrieve(\n\t\t\tphoneNumberId,\n\t\t);\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tdata: number.data,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to retrieve number\",\n\t\t};\n\t}\n}\n\n/**\n * Update phone number configuration\n */\nexport async function updateNumber(params: {\n\tphoneNumberId: string;\n\tconnectionId?: string;\n\tmessagingProfileId?: string;\n\tbillingGroupId?: string;\n\ttags?: string[];\n\tcustomerReference?: string;\n}) {\n\ttry {\n\t\tconst number = await (telnyxClient.phoneNumbers as any).update(\n\t\t\tparams.phoneNumberId,\n\t\t\t{\n\t\t\t\tconnection_id: params.connectionId,\n\t\t\t\tmessaging_profile_id: params.messagingProfileId,\n\t\t\t\tbilling_group_id: params.billingGroupId,\n\t\t\t\ttags: params.tags,\n\t\t\t\tcustomer_reference: params.customerReference,\n\t\t\t} as any,\n\t\t);\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tdata: number.data,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: error instanceof Error ? error.message : \"Failed to update number\",\n\t\t};\n\t}\n}\n\n/**\n * Release (delete) a phone number\n */\nexport async function releaseNumber(phoneNumberId: string) {\n\ttry {\n\t\tawait (telnyxClient.phoneNumbers as any).del(phoneNumberId);\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to release number\",\n\t\t};\n\t}\n}\n\n/**\n * Initiate number porting request\n */\nexport async function initiatePorting(params: {\n\tphoneNumbers: string[];\n\tbillingGroupId?: string;\n\tfastPortEligible?: boolean;\n\t// Account information\n\taccountNumber?: string;\n\taccountPin?: string;\n\tauthorizedPerson?: string;\n\t// Service address\n\taddressLine1?: string;\n\tcity?: string;\n\tstateOrProvince?: string;\n\tzipOrPostalCode?: string;\n\tcountryCode?: string;\n}) {\n\ttry {\n\t\tconst portingOrder = await (telnyxClient as any).numberPortouts.create({\n\t\t\tphone_numbers: params.phoneNumbers,\n\t\t\tbilling_group_id: params.billingGroupId,\n\t\t\tfast_port_eligible: params.fastPortEligible,\n\t\t\tcustomer_reference: {\n\t\t\t\taccount_number: params.accountNumber,\n\t\t\t\taccount_pin: params.accountPin,\n\t\t\t\tauthorized_person: params.authorizedPerson,\n\t\t\t},\n\t\t\tservice_address: {\n\t\t\t\taddress_line_1: params.addressLine1,\n\t\t\t\tcity: params.city,\n\t\t\t\tstate_or_province: params.stateOrProvince,\n\t\t\t\tzip_or_postal_code: params.zipOrPostalCode,\n\t\t\t\tcountry_code: params.countryCode || \"US\",\n\t\t\t},\n\t\t});\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tportingOrderId: portingOrder.data.id,\n\t\t\tdata: portingOrder.data,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to initiate porting\",\n\t\t};\n\t}\n}\n\n/**\n * Get porting order status\n */\nasync function getPortingStatus(portingOrderId: string) {\n\ttry {\n\t\tconst order = await (telnyxClient as any).numberPortouts.retrieve(\n\t\t\tportingOrderId,\n\t\t);\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tstatus: order.data.status,\n\t\t\tdata: order.data,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to get porting status\",\n\t\t};\n\t}\n}\n\n/**\n * Estimate number costs\n */\nasync function estimateNumberCost(params: {\n\tcountryCode: string;\n\tnumberType: NumberType;\n}) {\n\t// Cost estimates based on Telnyx pricing (as of 2025)\n\tconst costs = {\n\t\tUS: {\n\t\t\tlocal: { monthly: 1.0, setup: 0.0 },\n\t\t\t\"toll-free\": { monthly: 2.0, setup: 0.0 },\n\t\t\tmobile: { monthly: 5.0, setup: 0.0 },\n\t\t},\n\t\tCA: {\n\t\t\tlocal: { monthly: 1.5, setup: 0.0 },\n\t\t\t\"toll-free\": { monthly: 2.5, setup: 0.0 },\n\t\t},\n\t\tGB: {\n\t\t\tlocal: { monthly: 2.0, setup: 0.0 },\n\t\t\t\"toll-free\": { monthly: 3.0, setup: 0.0 },\n\t\t},\n\t};\n\n\tconst countryCode = params.countryCode.toUpperCase();\n\tconst pricing = costs[countryCode as keyof typeof costs];\n\n\tif (!pricing) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: `Pricing not available for country: ${countryCode}`,\n\t\t};\n\t}\n\n\tconst typePricing = pricing[params.numberType as keyof typeof pricing];\n\n\tif (!typePricing) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror: `Number type ${params.numberType} not available in ${countryCode}`,\n\t\t};\n\t}\n\n\treturn {\n\t\tsuccess: true,\n\t\tcosts: {\n\t\t\tmonthly: typePricing.monthly,\n\t\t\tsetup: typePricing.setup,\n\t\t\tcurrency: \"USD\",\n\t\t},\n\t};\n}\n\n/**\n * Validate if a number can be ported\n */\nasync function validatePortability(phoneNumber: string) {\n\ttry {\n\t\t// This would typically call Telnyx's LNP (Local Number Portability) check API\n\t\t// For now, we'll do basic validation\n\n\t\tconst cleanNumber = phoneNumber.replace(/\\D/g, \"\");\n\n\t\t// Must be at least 10 digits\n\t\tif (cleanNumber.length < 10) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\tportable: false,\n\t\t\t\treason: \"Phone number must be at least 10 digits\",\n\t\t\t};\n\t\t}\n\n\t\t// In a real implementation, you would check with Telnyx's LNP API\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tportable: true,\n\t\t\testimatedPortingDays: 7, // Typical porting timeline\n\t\t\tfastPortEligible: false,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error\n\t\t\t\t\t? error.message\n\t\t\t\t\t: \"Failed to validate portability\",\n\t\t};\n\t}\n}\n","/**\n * Phone Number Setup & Verification\n *\n * Verifies phone numbers are properly configured in Telnyx and can auto-fix issues.\n */\n\nimport { TELNYX_CONFIG } from \"./client\";\nimport {\n\tgetNumberDetails,\n\tlistOwnedNumbers,\n\ttype NumberFeature,\n\tupdateNumber,\n} from \"./numbers\";\n\nexport type PhoneNumberStatus = {\n\texists: boolean;\n\thasMessagingProfile: boolean;\n\thasConnection: boolean;\n\tcapabilities: {\n\t\tsms: boolean;\n\t\tvoice: boolean;\n\t\tmms: boolean;\n\t};\n\tneedsFix: boolean;\n\tissues: string[];\n};\n\nexport type PhoneNumberFixResult = {\n\tsuccess: boolean;\n\tfixed: boolean;\n\terror?: string;\n\tchanges: string[];\n};\n\n/**\n * Find phone number ID by phone number string\n */\nasync function findPhoneNumberId(\n\tphoneNumber: string,\n): Promise<{ success: boolean; phoneNumberId?: string; error?: string }> {\n\ttry {\n\t\t// Normalize phone number (E.164 format)\n\t\tconst normalized = phoneNumber.replace(/\\D/g, \"\");\n\t\tconst e164 = normalized.startsWith(\"+\")\n\t\t\t? phoneNumber\n\t\t\t: normalized.startsWith(\"1\") && normalized.length === 11\n\t\t\t\t? `+${normalized}`\n\t\t\t\t: `+1${normalized}`;\n\n\t\t// List all owned numbers and find matching one\n\t\tconst result = await listOwnedNumbers({ pageSize: 100 });\n\t\tif (!result.success || !result.data) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\terror: \"Failed to list phone numbers from Telnyx\",\n\t\t\t};\n\t\t}\n\n\t\tconst numbers = Array.isArray(result.data) ? result.data : [result.data];\n\t\tconst matching = numbers.find(\n\t\t\t(num: any) =>\n\t\t\t\tnum.phone_number === e164 ||\n\t\t\t\tnum.phone_number === phoneNumber ||\n\t\t\t\tnum.phone_number?.replace(/\\D/g, \"\") === normalized,\n\t\t);\n\n\t\tif (!matching) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\terror: `Phone number ${phoneNumber} not found in Telnyx account`,\n\t\t\t};\n\t\t}\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tphoneNumberId: matching.id,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\terror:\n\t\t\t\terror instanceof Error ? error.message : \"Failed to find phone number\",\n\t\t};\n\t}\n}\n\n/**\n * Verify phone number configuration\n */\nexport async function verifyPhoneNumber(\n\tphoneNumber: string,\n): Promise<PhoneNumberStatus> {\n\tconst status: PhoneNumberStatus = {\n\t\texists: false,\n\t\thasMessagingProfile: false,\n\t\thasConnection: false,\n\t\tcapabilities: {\n\t\t\tsms: false,\n\t\t\tvoice: false,\n\t\t\tmms: false,\n\t\t},\n\t\tneedsFix: false,\n\t\tissues: [],\n\t};\n\n\ttry {\n\t\t// Find phone number ID\n\t\tconst findResult = await findPhoneNumberId(phoneNumber);\n\t\tif (!findResult.success || !findResult.phoneNumberId) {\n\t\t\tstatus.issues.push(\n\t\t\t\tfindResult.error || \"Phone number not found in Telnyx\",\n\t\t\t);\n\t\t\tstatus.needsFix = true;\n\t\t\treturn status;\n\t\t}\n\n\t\tstatus.exists = true;\n\n\t\t// Get phone number details\n\t\tconst detailsResult = await getNumberDetails(findResult.phoneNumberId);\n\t\tif (!detailsResult.success || !detailsResult.data) {\n\t\t\tstatus.issues.push(\"Failed to retrieve phone number details\");\n\t\t\tstatus.needsFix = true;\n\t\t\treturn status;\n\t\t}\n\n\t\tconst numberData = detailsResult.data as any;\n\n\t\t// Check messaging profile\n\t\tif (numberData.messaging_profile_id) {\n\t\t\tstatus.hasMessagingProfile = true;\n\t\t} else {\n\t\t\tstatus.issues.push(\n\t\t\t\t\"Phone number is not associated with a messaging profile\",\n\t\t\t);\n\t\t\tstatus.needsFix = true;\n\t\t}\n\n\t\t// Check connection\n\t\tif (numberData.connection_id) {\n\t\t\tstatus.hasConnection = true;\n\t\t} else {\n\t\t\tstatus.issues.push(\"Phone number is not associated with a connection\");\n\t\t\tstatus.needsFix = true;\n\t\t}\n\n\t\t// Check capabilities from phone number features\n\t\tconst features = (numberData.features || []) as string[];\n\t\tconst hasFeaturesSms = features.includes(\"sms\");\n\t\tconst hasFeaturesVoice = features.includes(\"voice\");\n\t\tconst hasFeaturesMms = features.includes(\"mms\");\n\n\t\t// Also check messaging settings endpoint for SMS/MMS status\n\t\tlet messagingEnabled = false;\n\t\ttry {\n\t\t\tconst TELNYX_API_KEY = process.env.TELNYX_API_KEY;\n\t\t\tif (TELNYX_API_KEY) {\n\t\t\t\tconst messagingResponse = await fetch(\n\t\t\t\t\t`https://api.telnyx.com/v2/phone_numbers/${findResult.phoneNumberId}/messaging`,\n\t\t\t\t\t{\n\t\t\t\t\t\theaders: {\n\t\t\t\t\t\t\tAuthorization: `Bearer ${TELNYX_API_KEY}`,\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t);\n\t\t\t\tif (messagingResponse.ok) {\n\t\t\t\t\tconst messagingData = await messagingResponse.json();\n\t\t\t\t\tconst messagingFeatures = messagingData?.data?.features;\n\t\t\t\t\tif (\n\t\t\t\t\t\tmessagingFeatures?.sms?.domestic_two_way ||\n\t\t\t\t\t\tmessagingFeatures?.mms?.domestic_two_way\n\t\t\t\t\t) {\n\t\t\t\t\t\tmessagingEnabled = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} catch {\n\t\t\t// Ignore errors - fall back to features check\n\t\t}\n\n\t\t// Consider SMS enabled if either features include it OR messaging settings confirm it\n\t\tstatus.capabilities.sms = hasFeaturesSms || messagingEnabled;\n\t\tstatus.capabilities.voice = hasFeaturesVoice;\n\t\tstatus.capabilities.mms = hasFeaturesMms || messagingEnabled;\n\n\t\tif (!status.capabilities.sms) {\n\t\t\tstatus.issues.push(\"Phone number does not have SMS capability\");\n\t\t}\n\t\tif (!status.capabilities.voice) {\n\t\t\tstatus.issues.push(\"Phone number does not have voice capability\");\n\t\t}\n\n\t\treturn status;\n\t} catch (error) {\n\t\tstatus.issues.push(\n\t\t\terror instanceof Error ? error.message : \"Unknown error\",\n\t\t);\n\t\tstatus.needsFix = true;\n\t\treturn status;\n\t}\n}\n\n/**\n * Auto-fix phone number configuration\n */\nexport async function fixPhoneNumber(\n\tphoneNumber: string,\n\toptions?: {\n\t\tmessagingProfileId?: string;\n\t\tconnectionId?: string;\n\t},\n): Promise<PhoneNumberFixResult> {\n\tconst changes: string[] = [];\n\n\ttry {\n\t\t// Find phone number ID\n\t\tconst findResult = await findPhoneNumberId(phoneNumber);\n\t\tif (!findResult.success || !findResult.phoneNumberId) {\n\t\t\treturn {\n\t\t\t\tsuccess: false,\n\t\t\t\tfixed: false,\n\t\t\t\terror: findResult.error || \"Phone number not found\",\n\t\t\t\tchanges: [],\n\t\t\t};\n\t\t}\n\n\t\t// Get current status\n\t\tconst status = await verifyPhoneNumber(phoneNumber);\n\t\tif (!status.needsFix) {\n\t\t\treturn {\n\t\t\t\tsuccess: true,\n\t\t\t\tfixed: false,\n\t\t\t\tchanges: [],\n\t\t\t};\n\t\t}\n\n\t\t// Prepare update parameters\n\t\tconst updateParams: {\n\t\t\tphoneNumberId: string;\n\t\t\tmessagingProfileId?: string;\n\t\t\tconnectionId?: string;\n\t\t} = {\n\t\t\tphoneNumberId: findResult.phoneNumberId,\n\t\t};\n\n\t\t// Fix messaging profile\n\t\tif (!status.hasMessagingProfile) {\n\t\t\tconst messagingProfileId =\n\t\t\t\toptions?.messagingProfileId || TELNYX_CONFIG.messagingProfileId;\n\t\t\tif (messagingProfileId) {\n\t\t\t\tupdateParams.messagingProfileId = messagingProfileId;\n\t\t\t\tchanges.push(\n\t\t\t\t\t`Assigned messaging profile ${messagingProfileId} to phone number`,\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tfixed: false,\n\t\t\t\t\terror:\n\t\t\t\t\t\t\"Messaging profile ID is required but not configured. Set TELNYX_DEFAULT_MESSAGING_PROFILE_ID.\",\n\t\t\t\t\tchanges: [],\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// Fix connection\n\t\tif (!status.hasConnection) {\n\t\t\tconst connectionId = options?.connectionId || TELNYX_CONFIG.connectionId;\n\t\t\tif (connectionId) {\n\t\t\t\tupdateParams.connectionId = connectionId;\n\t\t\t\tchanges.push(`Assigned connection ${connectionId} to phone number`);\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tfixed: false,\n\t\t\t\t\terror:\n\t\t\t\t\t\t\"Connection ID is required but not configured. Set NEXT_PUBLIC_TELNYX_CONNECTION_ID.\",\n\t\t\t\t\tchanges: [],\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\t// Apply updates if needed\n\t\tif (updateParams.messagingProfileId || updateParams.connectionId) {\n\t\t\tconst updateResult = await updateNumber(updateParams);\n\t\t\tif (!updateResult.success) {\n\t\t\t\treturn {\n\t\t\t\t\tsuccess: false,\n\t\t\t\t\tfixed: false,\n\t\t\t\t\terror: updateResult.error || \"Failed to update phone number\",\n\t\t\t\t\tchanges,\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\n\t\treturn {\n\t\t\tsuccess: true,\n\t\t\tfixed: changes.length > 0,\n\t\t\tchanges,\n\t\t};\n\t} catch (error) {\n\t\treturn {\n\t\t\tsuccess: false,\n\t\t\tfixed: false,\n\t\t\terror: error instanceof Error ? error.message : \"Unknown error\",\n\t\t\tchanges,\n\t\t};\n\t}\n}\n\n/**\n * Verify phone number has SMS capability\n */\nexport async function verifySmsCapability(\n\tphoneNumber: string,\n): Promise<{ hasSms: boolean; error?: string }> {\n\tconst status = await verifyPhoneNumber(phoneNumber);\n\n\tif (!status.exists) {\n\t\treturn {\n\t\t\thasSms: false,\n\t\t\terror: \"Phone number not found in Telnyx\",\n\t\t};\n\t}\n\n\tif (!status.capabilities.sms) {\n\t\treturn {\n\t\t\thasSms: false,\n\t\t\terror: \"Phone number does not have SMS capability\",\n\t\t};\n\t}\n\n\tif (!status.hasMessagingProfile) {\n\t\treturn {\n\t\t\thasSms: false,\n\t\t\terror: \"Phone number is not associated with a messaging profile\",\n\t\t};\n\t}\n\n\treturn { hasSms: true };\n}\n\n/**\n * Verify phone number has voice capability\n */\nexport async function verifyVoiceCapability(\n\tphoneNumber: string,\n): Promise<{ hasVoice: boolean; error?: string }> {\n\tconst status = await verifyPhoneNumber(phoneNumber);\n\n\tif (!status.exists) {\n\t\treturn {\n\t\t\thasVoice: false,\n\t\t\terror: \"Phone number not found in Telnyx\",\n\t\t};\n\t}\n\n\tif (!status.capabilities.voice) {\n\t\treturn {\n\t\t\thasVoice: false,\n\t\t\terror: \"Phone number does not have voice capability\",\n\t\t};\n\t}\n\n\tif (!status.hasConnection) {\n\t\treturn {\n\t\t\thasVoice: false,\n\t\t\terror: \"Phone number is not associated with a connection\",\n\t\t};\n\t}\n\n\treturn { hasVoice: true };\n}\n","/**\n * Telnyx Configuration Validator\n *\n * Validates all required Telnyx environment variables and configuration.\n * Provides clear error messages for missing or invalid configuration.\n */\n\nimport { TELNYX_CONFIG } from \"./client\";\n\nexport type ValidationResult = {\n\tvalid: boolean;\n\terrors: string[];\n\twarnings: string[];\n\tconfig: {\n\t\tapiKey: boolean;\n\t\tconnectionId: boolean;\n\t\tmessagingProfileId: boolean;\n\t\twebhookSecret: boolean;\n\t\tpublicKey: boolean;\n\t\tsiteUrl: boolean;\n\t};\n};\n\nfunction isLocalUrl(url: string): boolean {\n\tconst lowered = url.toLowerCase();\n\treturn (\n\t\tlowered.includes(\"localhost\") ||\n\t\tlowered.includes(\"127.0.0.1\") ||\n\t\tlowered.includes(\"0.0.0.0\") ||\n\t\tlowered.endsWith(\".local\") ||\n\t\tlowered.includes(\"://local\")\n\t);\n}\n\nfunction getBaseAppUrl(): string | undefined {\n\tconst candidates = [\n\t\tprocess.env.NEXT_PUBLIC_SITE_URL,\n\t\tprocess.env.SITE_URL,\n\t\tprocess.env.NEXT_PUBLIC_APP_URL,\n\t\tprocess.env.APP_URL,\n\t];\n\tfor (const candidate of candidates) {\n\t\tif (candidate && candidate.trim()) {\n\t\t\tconst trimmed = candidate.trim();\n\t\t\tif (!isLocalUrl(trimmed)) {\n\t\t\t\treturn trimmed.startsWith(\"http\") ? trimmed : `https://${trimmed}`;\n\t\t\t}\n\t\t}\n\t}\n\n\tconst vercelUrl = process.env.VERCEL_URL;\n\tif (vercelUrl && !isLocalUrl(vercelUrl)) {\n\t\treturn vercelUrl.startsWith(\"http\") ? vercelUrl : `https://${vercelUrl}`;\n\t}\n\n\treturn undefined;\n}\n\n/**\n * Validate all Telnyx configuration\n */\nexport function validateTelnyxConfig(): ValidationResult {\n\tconst errors: string[] = [];\n\tconst warnings: string[] = [];\n\tconst config = {\n\t\tapiKey: false,\n\t\tconnectionId: false,\n\t\tmessagingProfileId: false,\n\t\twebhookSecret: false,\n\t\tpublicKey: false,\n\t\tsiteUrl: false,\n\t};\n\n\t// Check API Key (required)\n\tif (!TELNYX_CONFIG.apiKey || TELNYX_CONFIG.apiKey.trim() === \"\") {\n\t\terrors.push(\n\t\t\t\"TELNYX_API_KEY is not set. This is required for all Telnyx operations.\",\n\t\t);\n\t} else if (TELNYX_CONFIG.apiKey.length < 20) {\n\t\terrors.push(\n\t\t\t\"TELNYX_API_KEY appears to be invalid (too short). Get your API key from https://portal.telnyx.com\",\n\t\t);\n\t} else {\n\t\tconfig.apiKey = true;\n\t}\n\n\t// Check Connection ID (required for voice calls)\n\tif (!TELNYX_CONFIG.connectionId || TELNYX_CONFIG.connectionId.trim() === \"\") {\n\t\terrors.push(\n\t\t\t\"NEXT_PUBLIC_TELNYX_CONNECTION_ID is not set. This is required for phone calls. Get it from Telnyx Portal → Mission Control → Connections.\",\n\t\t);\n\t} else {\n\t\tconfig.connectionId = true;\n\t}\n\n\t// Check Messaging Profile ID (required for SMS)\n\tif (\n\t\t!TELNYX_CONFIG.messagingProfileId ||\n\t\tTELNYX_CONFIG.messagingProfileId.trim() === \"\"\n\t) {\n\t\terrors.push(\n\t\t\t\"TELNYX_DEFAULT_MESSAGING_PROFILE_ID or NEXT_PUBLIC_TELNYX_MESSAGING_PROFILE_ID is not set. This is required for SMS/MMS. Run getDefaultMessagingProfile() to fetch it automatically from Telnyx.\",\n\t\t);\n\t} else {\n\t\tconfig.messagingProfileId = true;\n\t}\n\n\t// Check Webhook Secret (recommended for production)\n\tif (\n\t\t!TELNYX_CONFIG.webhookSecret ||\n\t\tTELNYX_CONFIG.webhookSecret.trim() === \"\"\n\t) {\n\t\twarnings.push(\n\t\t\t\"TELNYX_WEBHOOK_SECRET is not set. Webhook signature verification will be disabled. Set this in production for security.\",\n\t\t);\n\t} else {\n\t\tconfig.webhookSecret = true;\n\t}\n\n\t// Check Public Key (recommended for production)\n\tif (!TELNYX_CONFIG.publicKey || TELNYX_CONFIG.publicKey.trim() === \"\") {\n\t\twarnings.push(\n\t\t\t\"TELNYX_PUBLIC_KEY is not set. Webhook signature verification may not work correctly. Get it from Telnyx Portal → API Keys.\",\n\t\t);\n\t} else {\n\t\tconfig.publicKey = true;\n\t}\n\n\t// Check Site URL (required for webhooks)\n\tconst siteUrl = getBaseAppUrl();\n\tif (!siteUrl) {\n\t\terrors.push(\n\t\t\t\"NEXT_PUBLIC_SITE_URL or SITE_URL is not set to a valid production URL. This is required for webhook callbacks. Set it to your production domain (e.g., https://thorbis.co).\",\n\t\t);\n\t} else if (isLocalUrl(siteUrl)) {\n\t\tconst isProduction =\n\t\t\tprocess.env.VERCEL_ENV === \"production\" ||\n\t\t\tprocess.env.DEPLOYMENT_ENV === \"production\";\n\t\tif (isProduction) {\n\t\t\terrors.push(\n\t\t\t\t`Site URL is set to localhost (${siteUrl}) but you're in production. Set NEXT_PUBLIC_SITE_URL to your production domain.`,\n\t\t\t);\n\t\t} else {\n\t\t\twarnings.push(\n\t\t\t\t`Site URL is set to localhost (${siteUrl}). This will not work in production.`,\n\t\t\t);\n\t\t}\n\t} else {\n\t\tconfig.siteUrl = true;\n\t}\n\n\treturn {\n\t\tvalid: errors.length === 0,\n\t\terrors,\n\t\twarnings,\n\t\tconfig,\n\t};\n}\n\n/**\n * Validate configuration for SMS operations\n */\nexport async function validateSmsConfig(): Promise<{\n\tvalid: boolean;\n\terror?: string;\n\tsuggestedProfileId?: string;\n}> {\n\tconst validation = validateTelnyxConfig();\n\n\tif (!validation.config.apiKey) {\n\t\treturn {\n\t\t\tvalid: false,\n\t\t\terror: \"TELNYX_API_KEY is required for SMS operations\",\n\t\t};\n\t}\n\n\tif (!validation.config.messagingProfileId) {\n\t\t// Try to fetch messaging profile automatically\n\t\ttry {\n\t\t\tconst { getDefaultMessagingProfile } = await import(\n\t\t\t\t\"./messaging-profile-fetcher\"\n\t\t\t);\n\t\t\tconst profileResult = await getDefaultMessagingProfile();\n\n\t\t\tif (profileResult.success && profileResult.profile) {\n\t\t\t\treturn {\n\t\t\t\t\tvalid: false,\n\t\t\t\t\terror:\n\t\t\t\t\t\t\"TELNYX_DEFAULT_MESSAGING_PROFILE_ID is required for SMS operations.\",\n\t\t\t\t\tsuggestedProfileId: profileResult.profile.id,\n\t\t\t\t};\n\t\t\t}\n\t\t} catch {\n\t\t\t// If fetch fails, return generic error\n\t\t}\n\n\t\treturn {\n\t\t\tvalid: false,\n\t\t\terror:\n\t\t\t\t\"TELNYX_DEFAULT_MESSAGING_PROFILE_ID is required for SMS operations. Run getDefaultMessagingProfile() to fetch it automatically from Telnyx.\",\n\t\t};\n\t}\n\n\tif (!validation.config.siteUrl) {\n\t\treturn {\n\t\t\tvalid: false,\n\t\t\terror:\n\t\t\t\t\"NEXT_PUBLIC_SITE_URL must be set to a valid production URL for SMS webhooks.\",\n\t\t};\n\t}\n\n\treturn { valid: true };\n}\n\n/**\n * Validate configuration for voice call operations\n */\nexport function validateCallConfig(): {\n\tvalid: boolean;\n\terror?: string;\n} {\n\tconst validation = validateTelnyxConfig();\n\n\tif (!validation.config.apiKey) {\n\t\treturn {\n\t\t\tvalid: false,\n\t\t\terror: \"TELNYX_API_KEY is required for phone calls\",\n\t\t};\n\t}\n\n\tif (!validation.config.connectionId) {\n\t\treturn {\n\t\t\tvalid: false,\n\t\t\terror:\n\t\t\t\t\"NEXT_PUBLIC_TELNYX_CONNECTION_ID is required for phone calls. Get it from Telnyx Portal → Mission Control → Connections.\",\n\t\t};\n\t}\n\n\tif (!validation.config.siteUrl) {\n\t\treturn {\n\t\t\tvalid: false,\n\t\t\terror:\n\t\t\t\t\"NEXT_PUBLIC_SITE_URL must be set to a valid production URL for call webhooks.\",\n\t\t};\n\t}\n\n\treturn { valid: true };\n}\n\n/**\n * Get formatted error message for display to users\n */\nfunction getFormattedErrorMessage(validation: ValidationResult): string {\n\tif (validation.valid) {\n\t\treturn \"\";\n\t}\n\n\tconst lines = [\"Telnyx configuration errors:\"];\n\tvalidation.errors.forEach((error, index) => {\n\t\tlines.push(`${index + 1}. ${error}`);\n\t});\n\n\tif (validation.warnings.length > 0) {\n\t\tlines.push(\"\");\n\t\tlines.push(\"Warnings:\");\n\t\tvalidation.warnings.forEach((warning, index) => {\n\t\t\tlines.push(`${index + 1}. ${warning}`);\n\t\t});\n\t}\n\n\treturn lines.join(\"\\n\");\n}\n"],"names":[],"mappings":"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"}