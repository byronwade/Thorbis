module.exports=[127802,e=>{"use strict";var t=e.i(424830),o=e.i(353344),n=e.i(443608),r=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({type:n.z.literal("error"),error:n.z.object({type:n.z.string(),message:n.z.string()})}))),i=(0,o.createJsonErrorResponseHandler)({errorSchema:r,errorToMessage:e=>e.error.message}),a=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({type:n.z.literal("message"),id:n.z.string().nullish(),model:n.z.string().nullish(),content:n.z.array(n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("text"),text:n.z.string(),citations:n.z.array(n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("web_search_result_location"),cited_text:n.z.string(),url:n.z.string(),title:n.z.string(),encrypted_index:n.z.string()}),n.z.object({type:n.z.literal("page_location"),cited_text:n.z.string(),document_index:n.z.number(),document_title:n.z.string().nullable(),start_page_number:n.z.number(),end_page_number:n.z.number()}),n.z.object({type:n.z.literal("char_location"),cited_text:n.z.string(),document_index:n.z.number(),document_title:n.z.string().nullable(),start_char_index:n.z.number(),end_char_index:n.z.number()})])).optional()}),n.z.object({type:n.z.literal("thinking"),thinking:n.z.string(),signature:n.z.string()}),n.z.object({type:n.z.literal("redacted_thinking"),data:n.z.string()}),n.z.object({type:n.z.literal("tool_use"),id:n.z.string(),name:n.z.string(),input:n.z.unknown()}),n.z.object({type:n.z.literal("server_tool_use"),id:n.z.string(),name:n.z.string(),input:n.z.record(n.z.string(),n.z.unknown()).nullish()}),n.z.object({type:n.z.literal("web_fetch_tool_result"),tool_use_id:n.z.string(),content:n.z.union([n.z.object({type:n.z.literal("web_fetch_result"),url:n.z.string(),retrieved_at:n.z.string(),content:n.z.object({type:n.z.literal("document"),title:n.z.string().nullable(),citations:n.z.object({enabled:n.z.boolean()}).optional(),source:n.z.object({type:n.z.literal("text"),media_type:n.z.string(),data:n.z.string()})})}),n.z.object({type:n.z.literal("web_fetch_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("web_search_tool_result"),tool_use_id:n.z.string(),content:n.z.union([n.z.array(n.z.object({type:n.z.literal("web_search_result"),url:n.z.string(),title:n.z.string(),encrypted_content:n.z.string(),page_age:n.z.string().nullish()})),n.z.object({type:n.z.literal("web_search_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("code_execution_tool_result"),tool_use_id:n.z.string(),content:n.z.union([n.z.object({type:n.z.literal("code_execution_result"),stdout:n.z.string(),stderr:n.z.string(),return_code:n.z.number()}),n.z.object({type:n.z.literal("code_execution_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("bash_code_execution_tool_result"),tool_use_id:n.z.string(),content:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("bash_code_execution_result"),content:n.z.array(n.z.object({type:n.z.literal("bash_code_execution_output"),file_id:n.z.string()})),stdout:n.z.string(),stderr:n.z.string(),return_code:n.z.number()}),n.z.object({type:n.z.literal("bash_code_execution_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("text_editor_code_execution_tool_result"),tool_use_id:n.z.string(),content:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("text_editor_code_execution_tool_result_error"),error_code:n.z.string()}),n.z.object({type:n.z.literal("text_editor_code_execution_view_result"),content:n.z.string(),file_type:n.z.string(),num_lines:n.z.number().nullable(),start_line:n.z.number().nullable(),total_lines:n.z.number().nullable()}),n.z.object({type:n.z.literal("text_editor_code_execution_create_result"),is_file_update:n.z.boolean()}),n.z.object({type:n.z.literal("text_editor_code_execution_str_replace_result"),lines:n.z.array(n.z.string()).nullable(),new_lines:n.z.number().nullable(),new_start:n.z.number().nullable(),old_lines:n.z.number().nullable(),old_start:n.z.number().nullable()})])})])),stop_reason:n.z.string().nullish(),stop_sequence:n.z.string().nullish(),usage:n.z.looseObject({input_tokens:n.z.number(),output_tokens:n.z.number(),cache_creation_input_tokens:n.z.number().nullish(),cache_read_input_tokens:n.z.number().nullish()}),container:n.z.object({expires_at:n.z.string(),id:n.z.string(),skills:n.z.array(n.z.object({type:n.z.union([n.z.literal("anthropic"),n.z.literal("custom")]),skill_id:n.z.string(),version:n.z.string()})).nullish()}).nullish()}))),l=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("message_start"),message:n.z.object({id:n.z.string().nullish(),model:n.z.string().nullish(),usage:n.z.looseObject({input_tokens:n.z.number(),cache_creation_input_tokens:n.z.number().nullish(),cache_read_input_tokens:n.z.number().nullish()})})}),n.z.object({type:n.z.literal("content_block_start"),index:n.z.number(),content_block:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("text"),text:n.z.string()}),n.z.object({type:n.z.literal("thinking"),thinking:n.z.string()}),n.z.object({type:n.z.literal("tool_use"),id:n.z.string(),name:n.z.string()}),n.z.object({type:n.z.literal("redacted_thinking"),data:n.z.string()}),n.z.object({type:n.z.literal("server_tool_use"),id:n.z.string(),name:n.z.string(),input:n.z.record(n.z.string(),n.z.unknown()).nullish()}),n.z.object({type:n.z.literal("web_fetch_tool_result"),tool_use_id:n.z.string(),content:n.z.union([n.z.object({type:n.z.literal("web_fetch_result"),url:n.z.string(),retrieved_at:n.z.string(),content:n.z.object({type:n.z.literal("document"),title:n.z.string().nullable(),citations:n.z.object({enabled:n.z.boolean()}).optional(),source:n.z.object({type:n.z.literal("text"),media_type:n.z.string(),data:n.z.string()})})}),n.z.object({type:n.z.literal("web_fetch_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("web_search_tool_result"),tool_use_id:n.z.string(),content:n.z.union([n.z.array(n.z.object({type:n.z.literal("web_search_result"),url:n.z.string(),title:n.z.string(),encrypted_content:n.z.string(),page_age:n.z.string().nullish()})),n.z.object({type:n.z.literal("web_search_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("code_execution_tool_result"),tool_use_id:n.z.string(),content:n.z.union([n.z.object({type:n.z.literal("code_execution_result"),stdout:n.z.string(),stderr:n.z.string(),return_code:n.z.number()}),n.z.object({type:n.z.literal("code_execution_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("bash_code_execution_tool_result"),tool_use_id:n.z.string(),content:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("bash_code_execution_result"),content:n.z.array(n.z.object({type:n.z.literal("bash_code_execution_output"),file_id:n.z.string()})),stdout:n.z.string(),stderr:n.z.string(),return_code:n.z.number()}),n.z.object({type:n.z.literal("bash_code_execution_tool_result_error"),error_code:n.z.string()})])}),n.z.object({type:n.z.literal("text_editor_code_execution_tool_result"),tool_use_id:n.z.string(),content:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("text_editor_code_execution_tool_result_error"),error_code:n.z.string()}),n.z.object({type:n.z.literal("text_editor_code_execution_view_result"),content:n.z.string(),file_type:n.z.string(),num_lines:n.z.number().nullable(),start_line:n.z.number().nullable(),total_lines:n.z.number().nullable()}),n.z.object({type:n.z.literal("text_editor_code_execution_create_result"),is_file_update:n.z.boolean()}),n.z.object({type:n.z.literal("text_editor_code_execution_str_replace_result"),lines:n.z.array(n.z.string()).nullable(),new_lines:n.z.number().nullable(),new_start:n.z.number().nullable(),old_lines:n.z.number().nullable(),old_start:n.z.number().nullable()})])})])}),n.z.object({type:n.z.literal("content_block_delta"),index:n.z.number(),delta:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("input_json_delta"),partial_json:n.z.string()}),n.z.object({type:n.z.literal("text_delta"),text:n.z.string()}),n.z.object({type:n.z.literal("thinking_delta"),thinking:n.z.string()}),n.z.object({type:n.z.literal("signature_delta"),signature:n.z.string()}),n.z.object({type:n.z.literal("citations_delta"),citation:n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("web_search_result_location"),cited_text:n.z.string(),url:n.z.string(),title:n.z.string(),encrypted_index:n.z.string()}),n.z.object({type:n.z.literal("page_location"),cited_text:n.z.string(),document_index:n.z.number(),document_title:n.z.string().nullable(),start_page_number:n.z.number(),end_page_number:n.z.number()}),n.z.object({type:n.z.literal("char_location"),cited_text:n.z.string(),document_index:n.z.number(),document_title:n.z.string().nullable(),start_char_index:n.z.number(),end_char_index:n.z.number()})])})])}),n.z.object({type:n.z.literal("content_block_stop"),index:n.z.number()}),n.z.object({type:n.z.literal("error"),error:n.z.object({type:n.z.string(),message:n.z.string()})}),n.z.object({type:n.z.literal("message_delta"),delta:n.z.object({stop_reason:n.z.string().nullish(),stop_sequence:n.z.string().nullish(),container:n.z.object({expires_at:n.z.string(),id:n.z.string(),skills:n.z.array(n.z.object({type:n.z.union([n.z.literal("anthropic"),n.z.literal("custom")]),skill_id:n.z.string(),version:n.z.string()})).nullish()}).nullish()}),usage:n.z.looseObject({output_tokens:n.z.number(),cache_creation_input_tokens:n.z.number().nullish()})}),n.z.object({type:n.z.literal("message_stop")}),n.z.object({type:n.z.literal("ping")})]))),s=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({signature:n.z.string().optional(),redactedData:n.z.string().optional()}))),c=n.z.object({citations:n.z.object({enabled:n.z.boolean()}).optional(),title:n.z.string().optional(),context:n.z.string().optional()}),u=n.z.object({sendReasoning:n.z.boolean().optional(),thinking:n.z.object({type:n.z.union([n.z.literal("enabled"),n.z.literal("disabled")]),budgetTokens:n.z.number().optional()}).optional(),disableParallelToolUse:n.z.boolean().optional(),cacheControl:n.z.object({type:n.z.literal("ephemeral"),ttl:n.z.union([n.z.literal("5m"),n.z.literal("1h")]).optional()}).optional(),container:n.z.object({id:n.z.string().optional(),skills:n.z.array(n.z.object({type:n.z.union([n.z.literal("anthropic"),n.z.literal("custom")]),skillId:n.z.string(),version:n.z.string().optional()})).optional()}).optional()}),d=class{constructor(){this.breakpointCount=0,this.warnings=[]}getCacheControl(e,t){var o;let n,r=null!=(o=null==(n=null==e?void 0:e.anthropic)?void 0:n.cacheControl)?o:null==n?void 0:n.cache_control;if(r)return t.canCache?(this.breakpointCount++,this.breakpointCount>4)?void this.warnings.push({type:"unsupported-setting",setting:"cacheControl",details:`Maximum 4 cache breakpoints exceeded (found ${this.breakpointCount}). This breakpoint will be ignored.`}):r:void this.warnings.push({type:"unsupported-setting",setting:"cacheControl",details:`cache_control cannot be set on ${t.type}. It will be ignored.`})}getWarnings(){return this.warnings}},p=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({maxCharacters:n.z.number().optional()}))),_=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({command:n.z.enum(["view","create","str_replace","insert"]),path:n.z.string(),file_text:n.z.string().optional(),insert_line:n.z.number().int().optional(),new_str:n.z.string().optional(),old_str:n.z.string().optional(),view_range:n.z.array(n.z.number().int()).optional()}))),h=(0,o.createProviderDefinedToolFactory)({id:"anthropic.text_editor_20250728",name:"str_replace_based_edit_tool",inputSchema:_}),z=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({maxUses:n.z.number().optional(),allowedDomains:n.z.array(n.z.string()).optional(),blockedDomains:n.z.array(n.z.string()).optional(),userLocation:n.z.object({type:n.z.literal("approximate"),city:n.z.string().optional(),region:n.z.string().optional(),country:n.z.string().optional(),timezone:n.z.string().optional()}).optional()}))),m=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.array(n.z.object({url:n.z.string(),title:n.z.string(),pageAge:n.z.string().nullable(),encryptedContent:n.z.string(),type:n.z.literal("web_search_result")})))),y=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({query:n.z.string()}))),g=(0,o.createProviderDefinedToolFactoryWithOutputSchema)({id:"anthropic.web_search_20250305",name:"web_search",inputSchema:y,outputSchema:m}),b=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({maxUses:n.z.number().optional(),allowedDomains:n.z.array(n.z.string()).optional(),blockedDomains:n.z.array(n.z.string()).optional(),citations:n.z.object({enabled:n.z.boolean()}).optional(),maxContentTokens:n.z.number().optional()}))),x=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({type:n.z.literal("web_fetch_result"),url:n.z.string(),content:n.z.object({type:n.z.literal("document"),title:n.z.string(),citations:n.z.object({enabled:n.z.boolean()}).optional(),source:n.z.union([n.z.object({type:n.z.literal("base64"),mediaType:n.z.literal("application/pdf"),data:n.z.string()}),n.z.object({type:n.z.literal("text"),mediaType:n.z.literal("text/plain"),data:n.z.string()})])}),retrievedAt:n.z.string().nullable()}))),v=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({url:n.z.string()}))),f=(0,o.createProviderDefinedToolFactoryWithOutputSchema)({id:"anthropic.web_fetch_20250910",name:"web_fetch",inputSchema:v,outputSchema:x});async function k({tools:e,toolChoice:n,disableParallelToolUse:r,cacheControlValidator:i}){e=(null==e?void 0:e.length)?e:void 0;let a=[],l=new Set,s=i||new d;if(null==e)return{tools:void 0,toolChoice:void 0,toolWarnings:a,betas:l};let c=[];for(let t of e)switch(t.type){case"function":{let e=s.getCacheControl(t.providerOptions,{type:"tool definition",canCache:!0});c.push({name:t.name,description:t.description,input_schema:t.inputSchema,cache_control:e});break}case"provider-defined":switch(t.id){case"anthropic.code_execution_20250522":l.add("code-execution-2025-05-22"),c.push({type:"code_execution_20250522",name:"code_execution",cache_control:void 0});break;case"anthropic.code_execution_20250825":l.add("code-execution-2025-08-25"),c.push({type:"code_execution_20250825",name:"code_execution"});break;case"anthropic.computer_20250124":l.add("computer-use-2025-01-24"),c.push({name:"computer",type:"computer_20250124",display_width_px:t.args.displayWidthPx,display_height_px:t.args.displayHeightPx,display_number:t.args.displayNumber,cache_control:void 0});break;case"anthropic.computer_20241022":l.add("computer-use-2024-10-22"),c.push({name:"computer",type:"computer_20241022",display_width_px:t.args.displayWidthPx,display_height_px:t.args.displayHeightPx,display_number:t.args.displayNumber,cache_control:void 0});break;case"anthropic.text_editor_20250124":l.add("computer-use-2025-01-24"),c.push({name:"str_replace_editor",type:"text_editor_20250124",cache_control:void 0});break;case"anthropic.text_editor_20241022":l.add("computer-use-2024-10-22"),c.push({name:"str_replace_editor",type:"text_editor_20241022",cache_control:void 0});break;case"anthropic.text_editor_20250429":l.add("computer-use-2025-01-24"),c.push({name:"str_replace_based_edit_tool",type:"text_editor_20250429",cache_control:void 0});break;case"anthropic.text_editor_20250728":{let e=await (0,o.validateTypes)({value:t.args,schema:p});c.push({name:"str_replace_based_edit_tool",type:"text_editor_20250728",max_characters:e.maxCharacters,cache_control:void 0});break}case"anthropic.bash_20250124":l.add("computer-use-2025-01-24"),c.push({name:"bash",type:"bash_20250124",cache_control:void 0});break;case"anthropic.bash_20241022":l.add("computer-use-2024-10-22"),c.push({name:"bash",type:"bash_20241022",cache_control:void 0});break;case"anthropic.memory_20250818":l.add("context-management-2025-06-27"),c.push({name:"memory",type:"memory_20250818"});break;case"anthropic.web_fetch_20250910":{l.add("web-fetch-2025-09-10");let e=await (0,o.validateTypes)({value:t.args,schema:b});c.push({type:"web_fetch_20250910",name:"web_fetch",max_uses:e.maxUses,allowed_domains:e.allowedDomains,blocked_domains:e.blockedDomains,citations:e.citations,max_content_tokens:e.maxContentTokens,cache_control:void 0});break}case"anthropic.web_search_20250305":{let e=await (0,o.validateTypes)({value:t.args,schema:z});c.push({type:"web_search_20250305",name:"web_search",max_uses:e.maxUses,allowed_domains:e.allowedDomains,blocked_domains:e.blockedDomains,user_location:e.userLocation,cache_control:void 0});break}default:a.push({type:"unsupported-tool",tool:t})}break;default:a.push({type:"unsupported-tool",tool:t})}if(null==n)return{tools:c,toolChoice:r?{type:"auto",disable_parallel_tool_use:r}:void 0,toolWarnings:a,betas:l};let u=n.type;switch(u){case"auto":return{tools:c,toolChoice:{type:"auto",disable_parallel_tool_use:r},toolWarnings:a,betas:l};case"required":return{tools:c,toolChoice:{type:"any",disable_parallel_tool_use:r},toolWarnings:a,betas:l};case"none":return{tools:void 0,toolChoice:void 0,toolWarnings:a,betas:l};case"tool":return{tools:c,toolChoice:{type:"tool",name:n.toolName,disable_parallel_tool_use:r},toolWarnings:a,betas:l};default:throw new t.UnsupportedFunctionalityError({functionality:`tool choice type: ${u}`})}}var w=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({type:n.z.literal("code_execution_result"),stdout:n.z.string(),stderr:n.z.string(),return_code:n.z.number()}))),j=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({code:n.z.string()}))),S=(0,o.createProviderDefinedToolFactoryWithOutputSchema)({id:"anthropic.code_execution_20250522",name:"code_execution",inputSchema:j,outputSchema:w}),C=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("bash_code_execution_result"),content:n.z.array(n.z.object({type:n.z.literal("bash_code_execution_output"),file_id:n.z.string()})),stdout:n.z.string(),stderr:n.z.string(),return_code:n.z.number()}),n.z.object({type:n.z.literal("bash_code_execution_tool_result_error"),error_code:n.z.string()}),n.z.object({type:n.z.literal("text_editor_code_execution_tool_result_error"),error_code:n.z.string()}),n.z.object({type:n.z.literal("text_editor_code_execution_view_result"),content:n.z.string(),file_type:n.z.string(),num_lines:n.z.number().nullable(),start_line:n.z.number().nullable(),total_lines:n.z.number().nullable()}),n.z.object({type:n.z.literal("text_editor_code_execution_create_result"),is_file_update:n.z.boolean()}),n.z.object({type:n.z.literal("text_editor_code_execution_str_replace_result"),lines:n.z.array(n.z.string()).nullable(),new_lines:n.z.number().nullable(),new_start:n.z.number().nullable(),old_lines:n.z.number().nullable(),old_start:n.z.number().nullable()})]))),T=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.discriminatedUnion("type",[n.z.object({type:n.z.literal("bash_code_execution"),command:n.z.string()}),n.z.discriminatedUnion("command",[n.z.object({type:n.z.literal("text_editor_code_execution"),command:n.z.literal("view"),path:n.z.string()}),n.z.object({type:n.z.literal("text_editor_code_execution"),command:n.z.literal("create"),path:n.z.string(),file_text:n.z.string().nullish()}),n.z.object({type:n.z.literal("text_editor_code_execution"),command:n.z.literal("str_replace"),path:n.z.string(),old_str:n.z.string(),new_str:n.z.string()})])]))),N=(0,o.createProviderDefinedToolFactoryWithOutputSchema)({id:"anthropic.code_execution_20250825",name:"code_execution",inputSchema:T,outputSchema:C});async function I({prompt:e,sendReasoning:n,warnings:r,cacheControlValidator:i}){var a,l,u,p,_;let h,z=new Set,y=function(e){let t,o=[];for(let n of e){let{role:e}=n;switch(e){case"system":(null==t?void 0:t.type)!=="system"&&(t={type:"system",messages:[]},o.push(t)),t.messages.push(n);break;case"assistant":(null==t?void 0:t.type)!=="assistant"&&(t={type:"assistant",messages:[]},o.push(t)),t.messages.push(n);break;case"user":case"tool":(null==t?void 0:t.type)!=="user"&&(t={type:"user",messages:[]},o.push(t)),t.messages.push(n);break;default:throw Error(`Unsupported role: ${e}`)}}return o}(e),g=i||new d,b=[];async function v(e){var t,n;let r=await (0,o.parseProviderOptions)({provider:"anthropic",providerOptions:e,schema:c});return null!=(n=null==(t=null==r?void 0:r.citations)?void 0:t.enabled)&&n}async function f(e){let t=await (0,o.parseProviderOptions)({provider:"anthropic",providerOptions:e,schema:c});return{title:null==t?void 0:t.title,context:null==t?void 0:t.context}}for(let e=0;e<y.length;e++){let i=y[e],c=e===y.length-1,d=i.type;switch(d){case"system":if(null!=h)throw new t.UnsupportedFunctionalityError({functionality:"Multiple system messages that are separated by user/assistant messages"});h=i.messages.map(({content:e,providerOptions:t})=>({type:"text",text:e,cache_control:g.getCacheControl(t,{type:"system message",canCache:!0})}));break;case"user":{let e=[];for(let n of i.messages){let{role:r,content:i}=n;switch(r){case"user":for(let r=0;r<i.length;r++){let s=i[r],c=r===i.length-1,d=null!=(a=g.getCacheControl(s.providerOptions,{type:"user message part",canCache:!0}))?a:c?g.getCacheControl(n.providerOptions,{type:"user message",canCache:!0}):void 0;switch(s.type){case"text":e.push({type:"text",text:s.text,cache_control:d});break;case"file":if(s.mediaType.startsWith("image/"))e.push({type:"image",source:s.data instanceof URL?{type:"url",url:s.data.toString()}:{type:"base64",media_type:"image/*"===s.mediaType?"image/jpeg":s.mediaType,data:(0,o.convertToBase64)(s.data)},cache_control:d});else if("application/pdf"===s.mediaType){z.add("pdfs-2024-09-25");let t=await v(s.providerOptions),n=await f(s.providerOptions);e.push({type:"document",source:s.data instanceof URL?{type:"url",url:s.data.toString()}:{type:"base64",media_type:"application/pdf",data:(0,o.convertToBase64)(s.data)},title:null!=(l=n.title)?l:s.filename,...n.context&&{context:n.context},...t&&{citations:{enabled:!0}},cache_control:d})}else if("text/plain"===s.mediaType){let o=await v(s.providerOptions),n=await f(s.providerOptions);e.push({type:"document",source:s.data instanceof URL?{type:"url",url:s.data.toString()}:{type:"text",media_type:"text/plain",data:function(e){if("string"==typeof e)return Buffer.from(e,"base64").toString("utf-8");if(e instanceof Uint8Array)return new TextDecoder().decode(e);if(e instanceof URL)throw new t.UnsupportedFunctionalityError({functionality:"URL-based text documents are not supported for citations"});throw new t.UnsupportedFunctionalityError({functionality:`unsupported data type for text documents: ${typeof e}`})}(s.data)},title:null!=(u=n.title)?u:s.filename,...n.context&&{context:n.context},...o&&{citations:{enabled:!0}},cache_control:d})}else throw new t.UnsupportedFunctionalityError({functionality:`media type: ${s.mediaType}`})}}break;case"tool":for(let o=0;o<i.length;o++){let r,a=i[o],l=o===i.length-1,s=null!=(p=g.getCacheControl(a.providerOptions,{type:"tool result part",canCache:!0}))?p:l?g.getCacheControl(n.providerOptions,{type:"tool result message",canCache:!0}):void 0,c=a.output;switch(c.type){case"content":r=c.value.map(e=>{switch(e.type){case"text":return{type:"text",text:e.text};case"media":if(e.mediaType.startsWith("image/"))return{type:"image",source:{type:"base64",media_type:e.mediaType,data:e.data}};if("application/pdf"===e.mediaType)return z.add("pdfs-2024-09-25"),{type:"document",source:{type:"base64",media_type:e.mediaType,data:e.data}};throw new t.UnsupportedFunctionalityError({functionality:`media type: ${e.mediaType}`})}});break;case"text":case"error-text":r=c.value;break;default:r=JSON.stringify(c.value)}e.push({type:"tool_result",tool_use_id:a.toolCallId,content:r,is_error:"error-text"===c.type||"error-json"===c.type||void 0,cache_control:s})}break;default:throw Error(`Unsupported role: ${r}`)}}b.push({role:"user",content:e});break}case"assistant":{let e=[];for(let t=0;t<i.messages.length;t++){let a=i.messages[t],l=t===i.messages.length-1,{content:u}=a;for(let t=0;t<u.length;t++){let i=u[t],d=t===u.length-1,p=null!=(_=g.getCacheControl(i.providerOptions,{type:"assistant message part",canCache:!0}))?_:d?g.getCacheControl(a.providerOptions,{type:"assistant message",canCache:!0}):void 0;switch(i.type){case"text":e.push({type:"text",text:c&&l&&d?i.text.trim():i.text,cache_control:p});break;case"reasoning":if(n){let t=await (0,o.parseProviderOptions)({provider:"anthropic",providerOptions:i.providerOptions,schema:s});null!=t?null!=t.signature?(g.getCacheControl(i.providerOptions,{type:"thinking block",canCache:!1}),e.push({type:"thinking",thinking:i.text,signature:t.signature})):null!=t.redactedData?(g.getCacheControl(i.providerOptions,{type:"redacted thinking block",canCache:!1}),e.push({type:"redacted_thinking",data:t.redactedData})):r.push({type:"other",message:"unsupported reasoning metadata"}):r.push({type:"other",message:"unsupported reasoning metadata"})}else r.push({type:"other",message:"sending reasoning content is disabled for this model"});break;case"tool-call":if(i.providerExecuted){"code_execution"===i.toolName&&null!=i.input&&"object"==typeof i.input&&"type"in i.input&&"string"==typeof i.input.type&&("bash_code_execution"===i.input.type||"text_editor_code_execution"===i.input.type)?e.push({type:"server_tool_use",id:i.toolCallId,name:i.input.type,input:i.input,cache_control:p}):"code_execution"===i.toolName||"web_fetch"===i.toolName||"web_search"===i.toolName?e.push({type:"server_tool_use",id:i.toolCallId,name:i.toolName,input:i.input,cache_control:p}):r.push({type:"other",message:`provider executed tool call for tool ${i.toolName} is not supported`});break}e.push({type:"tool_use",id:i.toolCallId,name:i.toolName,input:i.input,cache_control:p});break;case"tool-result":if("code_execution"===i.toolName){let t=i.output;if("json"!==t.type){r.push({type:"other",message:`provider executed tool result output type ${t.type} for tool ${i.toolName} is not supported`});break}if(null==t.value||"object"!=typeof t.value||!("type"in t.value)||"string"!=typeof t.value.type){r.push({type:"other",message:`provider executed tool result output value is not a valid code execution result for tool ${i.toolName}`});break}if("code_execution_result"===t.value.type){let n=await (0,o.validateTypes)({value:t.value,schema:w});e.push({type:"code_execution_tool_result",tool_use_id:i.toolCallId,content:{type:n.type,stdout:n.stdout,stderr:n.stderr,return_code:n.return_code},cache_control:p})}else{let n=await (0,o.validateTypes)({value:t.value,schema:C});e.push("bash_code_execution_result"===n.type||"bash_code_execution_tool_result_error"===n.type?{type:"bash_code_execution_tool_result",tool_use_id:i.toolCallId,cache_control:p,content:n}:{type:"text_editor_code_execution_tool_result",tool_use_id:i.toolCallId,cache_control:p,content:n})}break}if("web_fetch"===i.toolName){let t=i.output;if("json"!==t.type){r.push({type:"other",message:`provider executed tool result output type ${t.type} for tool ${i.toolName} is not supported`});break}let n=await (0,o.validateTypes)({value:t.value,schema:x});e.push({type:"web_fetch_tool_result",tool_use_id:i.toolCallId,content:{type:"web_fetch_result",url:n.url,retrieved_at:n.retrievedAt,content:{type:"document",title:n.content.title,citations:n.content.citations,source:{type:n.content.source.type,media_type:n.content.source.mediaType,data:n.content.source.data}}},cache_control:p});break}if("web_search"===i.toolName){let t=i.output;if("json"!==t.type){r.push({type:"other",message:`provider executed tool result output type ${t.type} for tool ${i.toolName} is not supported`});break}let n=await (0,o.validateTypes)({value:t.value,schema:m});e.push({type:"web_search_tool_result",tool_use_id:i.toolCallId,content:n.map(e=>({url:e.url,title:e.title,page_age:e.pageAge,encrypted_content:e.encryptedContent,type:e.type})),cache_control:p});break}r.push({type:"other",message:`provider executed tool result for tool ${i.toolName} is not supported`})}}}b.push({role:"assistant",content:e});break}default:throw Error(`content type: ${d}`)}}return{prompt:{system:h,messages:b},betas:z}}function U({finishReason:e,isJsonResponseFromTool:t}){switch(e){case"pause_turn":case"end_turn":case"stop_sequence":return"stop";case"refusal":return"content-filter";case"tool_use":return t?"stop":"tool-calls";case"max_tokens":return"length";default:return"unknown"}}function E(e,t,o){var n;if("page_location"!==e.type&&"char_location"!==e.type)return;let r=t[e.document_index];if(r)return{type:"source",sourceType:"document",id:o(),mediaType:r.mediaType,title:null!=(n=e.document_title)?n:r.title,filename:r.filename,providerMetadata:{anthropic:"page_location"===e.type?{citedText:e.cited_text,startPageNumber:e.start_page_number,endPageNumber:e.end_page_number}:{citedText:e.cited_text,startCharIndex:e.start_char_index,endCharIndex:e.end_char_index}}}}var q=class{constructor(e,t){var n;this.specificationVersion="v2",this.modelId=e,this.config=t,this.generateId=null!=(n=t.generateId)?n:o.generateId}supportsUrl(e){return"https:"===e.protocol}get provider(){return this.config.provider}get supportedUrls(){var e,t,o;return null!=(o=null==(t=(e=this.config).supportedUrls)?void 0:t.call(e))?o:{}}async getArgs({prompt:e,maxOutputTokens:n,temperature:r,topP:i,topK:a,frequencyPenalty:l,presencePenalty:s,stopSequences:c,responseFormat:p,seed:_,tools:h,toolChoice:z,providerOptions:m}){var y,g,b,x,v;let f=[];null!=l&&f.push({type:"unsupported-setting",setting:"frequencyPenalty"}),null!=s&&f.push({type:"unsupported-setting",setting:"presencePenalty"}),null!=_&&f.push({type:"unsupported-setting",setting:"seed"}),(null==p?void 0:p.type)==="json"&&(null==p.schema?f.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format requires a schema. The response format is ignored."}):null!=h&&f.push({type:"unsupported-setting",setting:"tools",details:"JSON response format does not support tools. The provided tools are ignored."}));let w=(null==p?void 0:p.type)==="json"&&null!=p.schema?{type:"function",name:"json",description:"Respond with a JSON object.",inputSchema:p.schema}:void 0,j=await (0,o.parseProviderOptions)({provider:"anthropic",providerOptions:m,schema:u}),S=new d,{prompt:C,betas:T}=await I({prompt:e,sendReasoning:null==(y=null==j?void 0:j.sendReasoning)||y,warnings:f,cacheControlValidator:S}),N=(null==(g=null==j?void 0:j.thinking)?void 0:g.type)==="enabled",U=null==(b=null==j?void 0:j.thinking)?void 0:b.budgetTokens,{maxOutputTokens:E,knownModel:q}=(v=this.modelId).includes("claude-sonnet-4-")||v.includes("claude-3-7-sonnet")||v.includes("claude-haiku-4-5")?{maxOutputTokens:64e3,knownModel:!0}:v.includes("claude-opus-4-")?{maxOutputTokens:32e3,knownModel:!0}:v.includes("claude-3-5-haiku")?{maxOutputTokens:8192,knownModel:!0}:v.includes("claude-3-haiku")?{maxOutputTokens:4096,knownModel:!0}:{maxOutputTokens:4096,knownModel:!1},O=null!=n?n:E,R={model:this.modelId,max_tokens:O,temperature:r,top_k:a,top_p:i,stop_sequences:c,...N&&{thinking:{type:"enabled",budget_tokens:U}},...(null==j?void 0:j.container)&&{container:{id:j.container.id,skills:null==(x=j.container.skills)?void 0:x.map(e=>({type:e.type,skill_id:e.skillId,version:e.version}))}},system:C.system,messages:C.messages};if(N){if(null==U)throw new t.UnsupportedFunctionalityError({functionality:"thinking requires a budget"});null!=R.temperature&&(R.temperature=void 0,f.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported when thinking is enabled"})),null!=a&&(R.top_k=void 0,f.push({type:"unsupported-setting",setting:"topK",details:"topK is not supported when thinking is enabled"})),null!=i&&(R.top_p=void 0,f.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported when thinking is enabled"})),R.max_tokens=O+U}q&&R.max_tokens>E&&(null!=n&&f.push({type:"unsupported-setting",setting:"maxOutputTokens",details:`${R.max_tokens} (maxOutputTokens + thinkingBudget) is greater than ${this.modelId} ${E} max output tokens. The max output tokens have been limited to ${E}.`}),R.max_tokens=E),(null==j?void 0:j.container)&&j.container.skills&&j.container.skills.length>0&&(T.add("code-execution-2025-08-25"),T.add("skills-2025-10-02"),T.add("files-api-2025-04-14"),(null==h?void 0:h.some(e=>"provider-defined"===e.type&&"anthropic.code_execution_20250825"===e.id))||f.push({type:"other",message:"code execution tool is required when using skills"}));let{tools:D,toolChoice:P,toolWarnings:A,betas:$}=await k(null!=w?{tools:[w],toolChoice:{type:"tool",toolName:w.name},disableParallelToolUse:!0,cacheControlValidator:S}:{tools:null!=h?h:[],toolChoice:z,disableParallelToolUse:null==j?void 0:j.disableParallelToolUse,cacheControlValidator:S}),M=S.getWarnings();return{args:{...R,tools:D,tool_choice:P},warnings:[...f,...A,...M],betas:new Set([...T,...$]),usesJsonResponseTool:null!=w}}async getHeaders({betas:e,headers:t}){return(0,o.combineHeaders)(await (0,o.resolve)(this.config.headers),e.size>0?{"anthropic-beta":Array.from(e).join(",")}:{},t)}buildRequestUrl(e){var t,o,n;return null!=(n=null==(o=(t=this.config).buildRequestUrl)?void 0:o.call(t,this.config.baseURL,e))?n:`${this.config.baseURL}/messages`}transformRequestBody(e){var t,o,n;return null!=(n=null==(o=(t=this.config).transformRequestBody)?void 0:o.call(t,e))?n:e}extractCitationDocuments(e){return e.filter(e=>"user"===e.role).flatMap(e=>e.content).filter(e=>{var t,o;if("file"!==e.type||"application/pdf"!==e.mediaType&&"text/plain"!==e.mediaType)return!1;let n=null==(t=e.providerOptions)?void 0:t.anthropic,r=null==n?void 0:n.citations;return null!=(o=null==r?void 0:r.enabled)&&o}).map(e=>{var t;return{title:null!=(t=e.filename)?t:"Untitled Document",filename:e.filename,mediaType:e.mediaType}})}async doGenerate(e){var t,n,r,l,s,c,u,d;let{args:p,warnings:_,betas:h,usesJsonResponseTool:z}=await this.getArgs(e),m=this.extractCitationDocuments(e.prompt),{responseHeaders:y,value:g,rawValue:b}=await (0,o.postJsonToApi)({url:this.buildRequestUrl(!1),headers:await this.getHeaders({betas:h,headers:e.headers}),body:this.transformRequestBody(p),failedResponseHandler:i,successfulResponseHandler:(0,o.createJsonResponseHandler)(a),abortSignal:e.abortSignal,fetch:this.config.fetch}),x=[];for(let e of g.content)switch(e.type){case"text":if(!z&&(x.push({type:"text",text:e.text}),e.citations))for(let t of e.citations){let e=E(t,m,this.generateId);e&&x.push(e)}break;case"thinking":x.push({type:"reasoning",text:e.thinking,providerMetadata:{anthropic:{signature:e.signature}}});break;case"redacted_thinking":x.push({type:"reasoning",text:"",providerMetadata:{anthropic:{redactedData:e.data}}});break;case"tool_use":x.push(z?{type:"text",text:JSON.stringify(e.input)}:{type:"tool-call",toolCallId:e.id,toolName:e.name,input:JSON.stringify(e.input)});break;case"server_tool_use":"text_editor_code_execution"===e.name||"bash_code_execution"===e.name?x.push({type:"tool-call",toolCallId:e.id,toolName:"code_execution",input:JSON.stringify({type:e.name,...e.input}),providerExecuted:!0}):("web_search"===e.name||"code_execution"===e.name||"web_fetch"===e.name)&&x.push({type:"tool-call",toolCallId:e.id,toolName:e.name,input:JSON.stringify(e.input),providerExecuted:!0});break;case"web_fetch_tool_result":"web_fetch_result"===e.content.type?x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_fetch",result:{type:"web_fetch_result",url:e.content.url,retrievedAt:e.content.retrieved_at,content:{type:e.content.content.type,title:e.content.content.title,citations:e.content.content.citations,source:{type:e.content.content.source.type,mediaType:e.content.content.source.media_type,data:e.content.content.source.data}}},providerExecuted:!0}):"web_fetch_tool_result_error"===e.content.type&&x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_fetch",isError:!0,result:{type:"web_fetch_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});break;case"web_search_tool_result":if(Array.isArray(e.content))for(let o of(x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_search",result:e.content.map(e=>{var t;return{url:e.url,title:e.title,pageAge:null!=(t=e.page_age)?t:null,encryptedContent:e.encrypted_content,type:e.type}}),providerExecuted:!0}),e.content))x.push({type:"source",sourceType:"url",id:this.generateId(),url:o.url,title:o.title,providerMetadata:{anthropic:{pageAge:null!=(t=o.page_age)?t:null}}});else x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_search",isError:!0,result:{type:"web_search_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});break;case"code_execution_tool_result":"code_execution_result"===e.content.type?x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",result:{type:e.content.type,stdout:e.content.stdout,stderr:e.content.stderr,return_code:e.content.return_code},providerExecuted:!0}):"code_execution_tool_result_error"===e.content.type&&x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",isError:!0,result:{type:"code_execution_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});break;case"bash_code_execution_tool_result":case"text_editor_code_execution_tool_result":x.push({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",result:e.content,providerExecuted:!0})}return{content:x,finishReason:U({finishReason:g.stop_reason,isJsonResponseFromTool:z}),usage:{inputTokens:g.usage.input_tokens,outputTokens:g.usage.output_tokens,totalTokens:g.usage.input_tokens+g.usage.output_tokens,cachedInputTokens:null!=(n=g.usage.cache_read_input_tokens)?n:void 0},request:{body:p},response:{id:null!=(r=g.id)?r:void 0,modelId:null!=(l=g.model)?l:void 0,headers:y,body:b},warnings:_,providerMetadata:{anthropic:{usage:g.usage,cacheCreationInputTokens:null!=(s=g.usage.cache_creation_input_tokens)?s:null,stopSequence:null!=(c=g.stop_sequence)?c:null,container:g.container?{expiresAt:g.container.expires_at,id:g.container.id,skills:null!=(d=null==(u=g.container.skills)?void 0:u.map(e=>({type:e.type,skillId:e.skill_id,version:e.version})))?d:null}:null}}}}async doStream(e){let t,n,{args:r,warnings:a,betas:s,usesJsonResponseTool:c}=await this.getArgs(e),u=this.extractCitationDocuments(e.prompt),d={...r,stream:!0},{responseHeaders:p,value:_}=await (0,o.postJsonToApi)({url:this.buildRequestUrl(!0),headers:await this.getHeaders({betas:s,headers:e.headers}),body:this.transformRequestBody(d),failedResponseHandler:i,successfulResponseHandler:(0,o.createEventSourceResponseHandler)(l),abortSignal:e.abortSignal,fetch:this.config.fetch}),h="unknown",z={inputTokens:void 0,outputTokens:void 0,totalTokens:void 0},m={},y=null,g=null,b=null,x=this.generateId;return{stream:_.pipeThrough(new TransformStream({start(e){e.enqueue({type:"stream-start",warnings:a})},transform(o,r){var i,a,l,s,d,p,_,v,f,k;if(e.includeRawChunks&&r.enqueue({type:"raw",rawValue:o.rawValue}),!o.success)return void r.enqueue({type:"error",error:o.error});let w=o.value;switch(w.type){case"ping":return;case"content_block_start":{let e=w.content_block.type;switch(n=e,e){case"text":m[w.index]={type:"text"},r.enqueue({type:"text-start",id:String(w.index)});return;case"thinking":m[w.index]={type:"reasoning"},r.enqueue({type:"reasoning-start",id:String(w.index)});return;case"redacted_thinking":m[w.index]={type:"reasoning"},r.enqueue({type:"reasoning-start",id:String(w.index),providerMetadata:{anthropic:{redactedData:w.content_block.data}}});return;case"tool_use":m[w.index]=c?{type:"text"}:{type:"tool-call",toolCallId:w.content_block.id,toolName:w.content_block.name,input:"",firstDelta:!0},r.enqueue(c?{type:"text-start",id:String(w.index)}:{type:"tool-input-start",id:w.content_block.id,toolName:w.content_block.name});return;case"server_tool_use":if(["web_fetch","web_search","code_execution","text_editor_code_execution","bash_code_execution"].includes(w.content_block.name)){m[w.index]={type:"tool-call",toolCallId:w.content_block.id,toolName:w.content_block.name,input:"",providerExecuted:!0,firstDelta:!0};let e="text_editor_code_execution"===w.content_block.name||"bash_code_execution"===w.content_block.name?"code_execution":w.content_block.name;r.enqueue({type:"tool-input-start",id:w.content_block.id,toolName:e,providerExecuted:!0})}return;case"web_fetch_tool_result":{let e=w.content_block;"web_fetch_result"===e.content.type?r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_fetch",result:{type:"web_fetch_result",url:e.content.url,retrievedAt:e.content.retrieved_at,content:{type:e.content.content.type,title:e.content.content.title,citations:e.content.content.citations,source:{type:e.content.content.source.type,mediaType:e.content.content.source.media_type,data:e.content.content.source.data}}},providerExecuted:!0}):"web_fetch_tool_result_error"===e.content.type&&r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_fetch",isError:!0,result:{type:"web_fetch_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});return}case"web_search_tool_result":{let e=w.content_block;if(Array.isArray(e.content))for(let t of(r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_search",result:e.content.map(e=>{var t;return{url:e.url,title:e.title,pageAge:null!=(t=e.page_age)?t:null,encryptedContent:e.encrypted_content,type:e.type}}),providerExecuted:!0}),e.content))r.enqueue({type:"source",sourceType:"url",id:x(),url:t.url,title:t.title,providerMetadata:{anthropic:{pageAge:null!=(i=t.page_age)?i:null}}});else r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"web_search",isError:!0,result:{type:"web_search_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});return}case"code_execution_tool_result":{let e=w.content_block;"code_execution_result"===e.content.type?r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",result:{type:e.content.type,stdout:e.content.stdout,stderr:e.content.stderr,return_code:e.content.return_code},providerExecuted:!0}):"code_execution_tool_result_error"===e.content.type&&r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",isError:!0,result:{type:"code_execution_tool_result_error",errorCode:e.content.error_code},providerExecuted:!0});return}case"bash_code_execution_tool_result":case"text_editor_code_execution_tool_result":{let e=w.content_block;r.enqueue({type:"tool-result",toolCallId:e.tool_use_id,toolName:"code_execution",result:e.content,providerExecuted:!0});return}default:throw Error(`Unsupported content block type: ${e}`)}}case"content_block_stop":if(null!=m[w.index]){let e=m[w.index];switch(e.type){case"text":r.enqueue({type:"text-end",id:String(w.index)});break;case"reasoning":r.enqueue({type:"reasoning-end",id:String(w.index)});break;case"tool-call":if(!c){r.enqueue({type:"tool-input-end",id:e.toolCallId});let t="text_editor_code_execution"===e.toolName||"bash_code_execution"===e.toolName?"code_execution":e.toolName;r.enqueue({type:"tool-call",toolCallId:e.toolCallId,toolName:t,input:e.input,providerExecuted:e.providerExecuted})}}delete m[w.index]}n=void 0;return;case"content_block_delta":{let e=w.delta.type;switch(e){case"text_delta":if(c)return;r.enqueue({type:"text-delta",id:String(w.index),delta:w.delta.text});return;case"thinking_delta":return void r.enqueue({type:"reasoning-delta",id:String(w.index),delta:w.delta.thinking});case"signature_delta":"thinking"===n&&r.enqueue({type:"reasoning-delta",id:String(w.index),delta:"",providerMetadata:{anthropic:{signature:w.delta.signature}}});return;case"input_json_delta":{let e=m[w.index],t=w.delta.partial_json;if(0===t.length)return;if(c){if((null==e?void 0:e.type)!=="text")return;r.enqueue({type:"text-delta",id:String(w.index),delta:t})}else{if((null==e?void 0:e.type)!=="tool-call")return;e.firstDelta&&("bash_code_execution"===e.toolName||"text_editor_code_execution"===e.toolName)&&(t=`{"type": "${e.toolName}",${t.substring(1)}`),r.enqueue({type:"tool-input-delta",id:e.toolCallId,delta:t}),e.input+=t,e.firstDelta=!1}return}case"citations_delta":{let e=E(w.delta.citation,u,x);e&&r.enqueue(e);return}default:throw Error(`Unsupported delta type: ${e}`)}}case"message_start":z.inputTokens=w.message.usage.input_tokens,z.cachedInputTokens=null!=(a=w.message.usage.cache_read_input_tokens)?a:void 0,t={...w.message.usage},y=null!=(l=w.message.usage.cache_creation_input_tokens)?l:null,r.enqueue({type:"response-metadata",id:null!=(s=w.message.id)?s:void 0,modelId:null!=(d=w.message.model)?d:void 0});return;case"message_delta":z.outputTokens=w.usage.output_tokens,z.totalTokens=(null!=(p=z.inputTokens)?p:0)+(null!=(_=w.usage.output_tokens)?_:0),h=U({finishReason:w.delta.stop_reason,isJsonResponseFromTool:c}),g=null!=(v=w.delta.stop_sequence)?v:null,b=null!=w.delta.container?{expiresAt:w.delta.container.expires_at,id:w.delta.container.id,skills:null!=(k=null==(f=w.delta.container.skills)?void 0:f.map(e=>({type:e.type,skillId:e.skill_id,version:e.version})))?k:null}:null,t={...t,...w.usage};return;case"message_stop":return void r.enqueue({type:"finish",finishReason:h,usage:z,providerMetadata:{anthropic:{usage:null!=t?t:null,cacheCreationInputTokens:y,stopSequence:g,container:b}}});case"error":return void r.enqueue({type:"error",error:w.error});default:throw Error(`Unsupported chunk type: ${w}`)}}})),request:{body:d},response:{headers:p}}}},O=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({command:n.z.string(),restart:n.z.boolean().optional()}))),R=(0,o.createProviderDefinedToolFactory)({id:"anthropic.bash_20241022",name:"bash",inputSchema:O}),D=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({command:n.z.string(),restart:n.z.boolean().optional()}))),P=(0,o.createProviderDefinedToolFactory)({id:"anthropic.bash_20250124",name:"bash",inputSchema:D}),A=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({action:n.z.enum(["key","type","mouse_move","left_click","left_click_drag","right_click","middle_click","double_click","screenshot","cursor_position"]),coordinate:n.z.array(n.z.number().int()).optional(),text:n.z.string().optional()}))),$=(0,o.createProviderDefinedToolFactory)({id:"anthropic.computer_20241022",name:"computer",inputSchema:A}),M=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({action:n.z.enum(["key","hold_key","type","cursor_position","mouse_move","left_mouse_down","left_mouse_up","left_click","left_click_drag","right_click","middle_click","double_click","triple_click","scroll","wait","screenshot"]),coordinate:n.z.tuple([n.z.number().int(),n.z.number().int()]).optional(),duration:n.z.number().optional(),scroll_amount:n.z.number().optional(),scroll_direction:n.z.enum(["up","down","left","right"]).optional(),start_coordinate:n.z.tuple([n.z.number().int(),n.z.number().int()]).optional(),text:n.z.string().optional()}))),F=(0,o.createProviderDefinedToolFactory)({id:"anthropic.computer_20250124",name:"computer",inputSchema:M}),H=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.discriminatedUnion("command",[n.z.object({command:n.z.literal("view"),path:n.z.string(),view_range:n.z.tuple([n.z.number(),n.z.number()]).optional()}),n.z.object({command:n.z.literal("create"),path:n.z.string(),file_text:n.z.string()}),n.z.object({command:n.z.literal("str_replace"),path:n.z.string(),old_str:n.z.string(),new_str:n.z.string()}),n.z.object({command:n.z.literal("insert"),path:n.z.string(),insert_line:n.z.number(),insert_text:n.z.string()}),n.z.object({command:n.z.literal("delete"),path:n.z.string()}),n.z.object({command:n.z.literal("rename"),old_path:n.z.string(),new_path:n.z.string()})]))),J=(0,o.createProviderDefinedToolFactory)({id:"anthropic.memory_20250818",name:"memory",inputSchema:H}),L=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({command:n.z.enum(["view","create","str_replace","insert","undo_edit"]),path:n.z.string(),file_text:n.z.string().optional(),insert_line:n.z.number().int().optional(),new_str:n.z.string().optional(),old_str:n.z.string().optional(),view_range:n.z.array(n.z.number().int()).optional()}))),W=(0,o.createProviderDefinedToolFactory)({id:"anthropic.text_editor_20241022",name:"str_replace_editor",inputSchema:L}),B=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({command:n.z.enum(["view","create","str_replace","insert","undo_edit"]),path:n.z.string(),file_text:n.z.string().optional(),insert_line:n.z.number().int().optional(),new_str:n.z.string().optional(),old_str:n.z.string().optional(),view_range:n.z.array(n.z.number().int()).optional()}))),V=(0,o.createProviderDefinedToolFactory)({id:"anthropic.text_editor_20250124",name:"str_replace_editor",inputSchema:B}),K=(0,o.lazySchema)(()=>(0,o.zodSchema)(n.z.object({command:n.z.enum(["view","create","str_replace","insert"]),path:n.z.string(),file_text:n.z.string().optional(),insert_line:n.z.number().int().optional(),new_str:n.z.string().optional(),old_str:n.z.string().optional(),view_range:n.z.array(n.z.number().int()).optional()}))),G={bash_20241022:R,bash_20250124:P,codeExecution_20250522:(e={})=>S(e),codeExecution_20250825:(e={})=>N(e),computer_20241022:$,computer_20250124:F,memory_20250818:J,textEditor_20241022:W,textEditor_20250124:V,textEditor_20250429:(0,o.createProviderDefinedToolFactory)({id:"anthropic.text_editor_20250429",name:"str_replace_based_edit_tool",inputSchema:K}),textEditor_20250728:(e={})=>h(e),webFetch_20250910:(e={})=>f(e),webSearch_20250305:(e={})=>g(e)},Y=function(e={}){var n,r;let i=null!=(n=(0,o.withoutTrailingSlash)((0,o.loadOptionalSetting)({settingValue:e.baseURL,environmentVariableName:"ANTHROPIC_BASE_URL"})))?n:"https://api.anthropic.com/v1",a=null!=(r=e.name)?r:"anthropic.messages",l=()=>(0,o.withUserAgentSuffix)({"anthropic-version":"2023-06-01","x-api-key":(0,o.loadApiKey)({apiKey:e.apiKey,environmentVariableName:"ANTHROPIC_API_KEY",description:"Anthropic"}),...e.headers},"ai-sdk/anthropic/2.0.44"),s=t=>{var n;return new q(t,{provider:a,baseURL:i,headers:l,fetch:e.fetch,generateId:null!=(n=e.generateId)?n:o.generateId,supportedUrls:()=>({"image/*":[/^https?:\/\/.*$/]})})},c=function(e){if(new.target)throw Error("The Anthropic model function cannot be called with the new keyword.");return s(e)};return c.languageModel=s,c.chat=s,c.messages=s,c.textEmbeddingModel=e=>{throw new t.NoSuchModelError({modelId:e,modelType:"textEmbeddingModel"})},c.imageModel=e=>{throw new t.NoSuchModelError({modelId:e,modelType:"imageModel"})},c.tools=G,c}();e.s(["anthropic",()=>Y])}];

//# sourceMappingURL=3f493_%40ai-sdk_anthropic_dist_index_mjs_50e90488._.js.map