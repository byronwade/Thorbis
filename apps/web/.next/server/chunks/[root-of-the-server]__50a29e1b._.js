module.exports=[120267,e=>e.a(async(t,n)=>{try{let t=await e.y("@react-pdf/renderer");e.n(t),n()}catch(e){n(e)}},!0),329315,e=>e.a(async(t,n)=>{try{var a=e.i(660198),o=e.i(120267),i=t([o]);[o]=i.then?(await i)():i,o.Font.register({family:"Helvetica",fonts:[{src:"https://cdn.jsdelivr.net/npm/@canvas-fonts/helvetica@1.0.4/Helvetica.ttf"},{src:"https://cdn.jsdelivr.net/npm/@canvas-fonts/helvetica@1.0.4/Helvetica-Bold.ttf",fontWeight:"bold"}]});let r="#000000",s="#666666",c="#E5E7EB",d=o.StyleSheet.create({page:{padding:72,fontFamily:"Helvetica",fontSize:11,backgroundColor:"#FFFFFF"},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:48,paddingBottom:24,borderBottom:`2px solid ${r}`},headerLeft:{flex:1},companyName:{fontSize:24,fontWeight:"bold",textTransform:"uppercase",marginBottom:8},companyInfo:{fontSize:10,marginBottom:2,color:"#333333"},headerRight:{alignItems:"flex-end"},invoiceTitle:{fontSize:40,fontWeight:"bold",marginBottom:16},invoiceMeta:{fontSize:10,marginBottom:4},metaLabel:{color:s},metaValue:{fontWeight:"bold"},billToSection:{marginBottom:36},sectionTitle:{fontSize:9,fontWeight:"bold",textTransform:"uppercase",color:s,marginBottom:12,letterSpacing:.5},customerName:{fontWeight:"bold",marginBottom:4},customerInfo:{fontSize:10,marginBottom:2,color:"#333333"},table:{marginBottom:36},tableHeader:{flexDirection:"row",borderBottom:`2px solid ${r}`,paddingBottom:8,marginBottom:8},tableHeaderCell:{fontSize:9,fontWeight:"bold",textTransform:"uppercase"},tableRow:{flexDirection:"row",borderBottom:`1px solid ${c}`,paddingVertical:12},tableCell:{fontSize:10},tableCellRight:{textAlign:"right"},tableCellBold:{fontWeight:"bold"},colDescription:{flex:1},colQty:{width:60},colRate:{width:100},colAmount:{width:120},totalsSection:{alignItems:"flex-end",marginBottom:36},totalsBox:{width:300},totalRow:{flexDirection:"row",justifyContent:"space-between",paddingVertical:4},totalLabel:{fontSize:10,color:s},totalValue:{fontSize:10},grandTotalRow:{flexDirection:"row",justifyContent:"space-between",borderTop:`2px solid ${r}`,paddingTop:12,marginTop:8},grandTotalLabel:{fontSize:11,fontWeight:"bold",textTransform:"uppercase"},grandTotalValue:{fontSize:16,fontWeight:"bold"},notesSection:{marginBottom:24},notesText:{fontSize:10,lineHeight:1.5,color:"#333333"},footer:{marginTop:48,paddingTop:16,borderTop:`1px solid ${c}`,alignItems:"center"},footerText:{fontSize:10,color:s}});function l({invoice:e,customer:t,company:n}){let i=e.line_items||[],l=e.subtotal||e.total_amount,r=e.tax_amount||0,s=e.discount_amount||0,c=e.total_amount,u=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e/100),p=e=>new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return(0,a.jsx)(o.Document,{children:(0,a.jsxs)(o.Page,{size:"LETTER",style:d.page,children:[(0,a.jsxs)(o.View,{style:d.header,children:[(0,a.jsxs)(o.View,{style:d.headerLeft,children:[(0,a.jsx)(o.Text,{style:d.companyName,children:n.name||"Company Name"}),n.address_line1&&(0,a.jsx)(o.Text,{style:d.companyInfo,children:n.address_line1}),n.city&&(0,a.jsxs)(o.Text,{style:d.companyInfo,children:[n.city,", ",n.state," ",n.postal_code]}),n.phone&&(0,a.jsx)(o.Text,{style:d.companyInfo,children:n.phone}),n.email&&(0,a.jsx)(o.Text,{style:d.companyInfo,children:n.email})]}),(0,a.jsxs)(o.View,{style:d.headerRight,children:[(0,a.jsx)(o.Text,{style:d.invoiceTitle,children:"INVOICE"}),(0,a.jsxs)(o.View,{children:[(0,a.jsxs)(o.Text,{style:d.invoiceMeta,children:[(0,a.jsx)(o.Text,{style:d.metaLabel,children:"Invoice #: "}),(0,a.jsx)(o.Text,{style:d.metaValue,children:e.invoice_number})]}),(0,a.jsxs)(o.Text,{style:d.invoiceMeta,children:[(0,a.jsx)(o.Text,{style:d.metaLabel,children:"Date: "}),p(e.created_at)]}),e.due_date&&(0,a.jsxs)(o.Text,{style:d.invoiceMeta,children:[(0,a.jsx)(o.Text,{style:d.metaLabel,children:"Due: "}),(0,a.jsx)(o.Text,{style:d.metaValue,children:p(e.due_date)})]})]})]})]}),(0,a.jsxs)(o.View,{style:d.billToSection,children:[(0,a.jsx)(o.Text,{style:d.sectionTitle,children:"Bill To"}),(0,a.jsx)(o.Text,{style:d.customerName,children:t.display_name||`${t.first_name} ${t.last_name}`}),t.company_name&&(0,a.jsx)(o.Text,{style:d.customerInfo,children:t.company_name}),t.billing_address&&(0,a.jsx)(o.Text,{style:d.customerInfo,children:t.billing_address}),t.billing_city&&(0,a.jsxs)(o.Text,{style:d.customerInfo,children:[t.billing_city,", ",t.billing_state," ",t.billing_zip]}),t.email&&(0,a.jsx)(o.Text,{style:d.customerInfo,children:t.email}),t.phone&&(0,a.jsx)(o.Text,{style:d.customerInfo,children:t.phone})]}),(0,a.jsxs)(o.View,{style:d.table,children:[(0,a.jsxs)(o.View,{style:d.tableHeader,children:[(0,a.jsx)(o.Text,{style:[d.tableHeaderCell,d.colDescription],children:"Description"}),(0,a.jsx)(o.Text,{style:[d.tableHeaderCell,d.colQty,d.tableCellRight],children:"Qty"}),(0,a.jsx)(o.Text,{style:[d.tableHeaderCell,d.colRate,d.tableCellRight],children:"Rate"}),(0,a.jsx)(o.Text,{style:[d.tableHeaderCell,d.colAmount,d.tableCellRight],children:"Amount"})]}),i.map((e,t)=>(0,a.jsxs)(o.View,{style:d.tableRow,children:[(0,a.jsx)(o.Text,{style:[d.tableCell,d.colDescription],children:e.description}),(0,a.jsx)(o.Text,{style:[d.tableCell,d.colQty,d.tableCellRight],children:e.quantity}),(0,a.jsx)(o.Text,{style:[d.tableCell,d.colRate,d.tableCellRight],children:u(e.unit_price||e.unitPrice)}),(0,a.jsx)(o.Text,{style:[d.tableCell,d.colAmount,d.tableCellRight,d.tableCellBold],children:u(e.amount||e.quantity*e.unit_price)})]},t))]}),(0,a.jsx)(o.View,{style:d.totalsSection,children:(0,a.jsxs)(o.View,{style:d.totalsBox,children:[(0,a.jsxs)(o.View,{style:d.totalRow,children:[(0,a.jsx)(o.Text,{style:d.totalLabel,children:"Subtotal"}),(0,a.jsx)(o.Text,{style:d.totalValue,children:u(l)})]}),r>0&&(0,a.jsxs)(o.View,{style:d.totalRow,children:[(0,a.jsx)(o.Text,{style:d.totalLabel,children:"Tax"}),(0,a.jsx)(o.Text,{style:d.totalValue,children:u(r)})]}),s>0&&(0,a.jsxs)(o.View,{style:d.totalRow,children:[(0,a.jsx)(o.Text,{style:d.totalLabel,children:"Discount"}),(0,a.jsxs)(o.Text,{style:d.totalValue,children:["-",u(s)]})]}),(0,a.jsxs)(o.View,{style:d.grandTotalRow,children:[(0,a.jsx)(o.Text,{style:d.grandTotalLabel,children:"Total"}),(0,a.jsx)(o.Text,{style:d.grandTotalValue,children:u(c)})]})]})}),e.notes&&(0,a.jsxs)(o.View,{style:d.notesSection,children:[(0,a.jsx)(o.Text,{style:d.sectionTitle,children:"Notes"}),(0,a.jsx)(o.Text,{style:d.notesText,children:e.notes})]}),(0,a.jsx)(o.View,{style:d.footer,children:(0,a.jsx)(o.Text,{style:d.footerText,children:"Thank you for your business!"})})]})})}e.s(["InvoicePDFDocument",()=>l]),n()}catch(e){n(e)}},!1),829143,e=>e.a(async(t,n)=>{try{var a=e.i(120267),o=e.i(297676),i=e.i(329315),l=e.i(511368),r=t([a,i]);async function s(e,{params:t}){try{let{id:e}=await t,n=await (0,l.createClient)();if(!n)return o.NextResponse.json({error:"Unable to connect to database"},{status:500});let{data:r,error:s}=await n.from("invoices").select(`
        *,
        customer:customers!customer_id(
          id,
          first_name,
          last_name,
          display_name,
          email,
          phone,
          company_name,
          billing_address,
          billing_city,
          billing_state,
          billing_zip
        ),
        company:companies!company_id(
          id,
          name,
          email,
          phone,
          address_line1,
          address_line2,
          city,
          state,
          postal_code
        )
      `).eq("id",e).single();if(s||!r)return o.NextResponse.json({error:"Invoice not found"},{status:404});let c=Array.isArray(r.customer)?r.customer[0]:r.customer,d=Array.isArray(r.company)?r.company[0]:r.company;if(!(c&&d))return o.NextResponse.json({error:"Invoice data incomplete"},{status:400});let u=(0,i.InvoicePDFDocument)({invoice:r,customer:c,company:d}),p=await (0,a.renderToBuffer)(u);return new o.NextResponse(new Uint8Array(p),{status:200,headers:{"Content-Type":"application/pdf","Content-Disposition":`attachment; filename="invoice-${r.invoice_number}.pdf"`}})}catch(e){return o.NextResponse.json({error:"Failed to generate PDF"},{status:500})}}[a,i]=r.then?(await r)():r,e.s(["GET",()=>s]),n()}catch(e){n(e)}},!1),989863,e=>e.a(async(t,n)=>{try{var a=e.i(755535),o=e.i(377233),i=e.i(490003),l=e.i(492991),r=e.i(241970),s=e.i(357699),c=e.i(212454),d=e.i(48717),u=e.i(798301),p=e.i(986366),h=e.i(983537),m=e.i(147475),x=e.i(561930),y=e.i(803747),f=e.i(368557),g=e.i(42037),T=e.i(193695);e.i(432036);var b=e.i(573881),w=e.i(829143),R=t([w]);[w]=R.then?(await R)():R;let C=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/invoices/[id]/pdf/route",pathname:"/api/invoices/[id]/pdf",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/apps/web/src/app/api/invoices/[id]/pdf/route.ts",nextConfigOutput:"",userland:w}),{workAsyncStorage:_,workUnitAsyncStorage:S,serverHooks:E}=C;function v(){return(0,i.patchFetch)({workAsyncStorage:_,workUnitAsyncStorage:S})}async function j(e,t,n){C.isDev&&(0,l.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let a="/api/invoices/[id]/pdf/route";a=a.replace(/\/index$/,"")||"/";let i=await C.prepare(e,t,{srcPage:a,multiZoneDraftMode:!1});if(!i)return t.statusCode=400,t.end("Bad Request"),null==n.waitUntil||n.waitUntil.call(n,Promise.resolve()),null;let{buildId:w,params:R,nextConfig:v,parsedUrl:j,isDraftMode:_,prerenderManifest:S,routerServerContext:E,isOnDemandRevalidate:A,revalidateOnlyGenerated:I,resolvedPathname:N,clientReferenceManifest:D,serverActionsManifest:B}=i,V=(0,d.normalizeAppPath)(a),H=!!(S.dynamicRoutes[V]||S.routes[N]),P=async()=>((null==E?void 0:E.render404)?await E.render404(e,t,j,!1):t.end("This page could not be found"),null);if(H&&!_){let e=!!S.routes[N],t=S.dynamicRoutes[V];if(t&&!1===t.fallback&&!e){if(v.experimental.adapterPath)return await P();throw new T.NoFallbackError}}let O=null;!H||C.isDev||_||(O=N,O="/index"===O?"/":O);let F=!0===C.isDev||!H,U=H&&!F;B&&D&&(0,s.setReferenceManifestsSingleton)({page:a,clientReferenceManifest:D,serverActionsManifest:B,serverModuleMap:(0,c.createServerModuleMap)({serverActionsManifest:B})});let M=e.method||"GET",z=(0,r.getTracer)(),L=z.getActiveScopeSpan(),q={params:R,prerenderManifest:S,renderOpts:{experimental:{authInterrupts:!!v.experimental.authInterrupts},cacheComponents:!!v.cacheComponents,supportsDynamicResponse:F,incrementalCache:(0,l.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:v.cacheLife,waitUntil:n.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,n,a)=>C.onRequestError(e,t,a,E)},sharedContext:{buildId:w}},$=new u.NodeNextRequest(e),k=new u.NodeNextResponse(t),W=p.NextRequestAdapter.fromNodeNextRequest($,(0,p.signalFromNodeResponse)(t));try{let i=async e=>C.handle(W,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let n=z.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==h.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let o=n.get("next.route");if(o){let t=`${M} ${o}`;e.setAttributes({"next.route":o,"http.route":o,"next.span_name":t}),e.updateName(t)}else e.updateName(`${M} ${a}`)}),s=!!(0,l.getRequestMeta)(e,"minimalMode"),c=async l=>{var r,c;let d=async({previousCacheEntry:o})=>{try{if(!s&&A&&I&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let a=await i(l);e.fetchMetrics=q.renderOpts.fetchMetrics;let r=q.renderOpts.pendingWaitUntil;r&&n.waitUntil&&(n.waitUntil(r),r=void 0);let c=q.renderOpts.collectedTags;if(!H)return await (0,x.sendResponse)($,k,a,q.renderOpts.pendingWaitUntil),null;{let e=await a.blob(),t=(0,y.toNodeOutgoingHttpHeaders)(a.headers);c&&(t[g.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let n=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=g.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,o=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=g.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:b.CachedRouteKind.APP_ROUTE,status:a.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:n,expire:o}}}}catch(t){throw(null==o?void 0:o.isStale)&&await C.onRequestError(e,t,{routerKind:"App Router",routePath:a,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:A})},E),t}},u=await C.handleResponse({req:e,nextConfig:v,cacheKey:O,routeKind:o.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:S,isRoutePPREnabled:!1,isOnDemandRevalidate:A,revalidateOnlyGenerated:I,responseGenerator:d,waitUntil:n.waitUntil,isMinimalMode:s});if(!H)return null;if((null==u||null==(r=u.value)?void 0:r.kind)!==b.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==u||null==(c=u.value)?void 0:c.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",A?"REVALIDATED":u.isMiss?"MISS":u.isStale?"STALE":"HIT"),_&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let p=(0,y.fromNodeOutgoingHttpHeaders)(u.value.headers);return s&&H||p.delete(g.NEXT_CACHE_TAGS_HEADER),!u.cacheControl||t.getHeader("Cache-Control")||p.get("Cache-Control")||p.set("Cache-Control",(0,f.getCacheControlHeader)(u.cacheControl)),await (0,x.sendResponse)($,k,new Response(u.value.body,{headers:p,status:u.value.status||200})),null};L?await c(L):await z.withPropagatedContext(e.headers,()=>z.trace(h.BaseServerSpan.handleRequest,{spanName:`${M} ${a}`,kind:r.SpanKind.SERVER,attributes:{"http.method":M,"http.target":e.url}},c))}catch(t){if(t instanceof T.NoFallbackError||await C.onRequestError(e,t,{routerKind:"App Router",routePath:V,routeType:"route",revalidateReason:(0,m.getRevalidateReason)({isStaticGeneration:U,isOnDemandRevalidate:A})}),H)throw t;return await (0,x.sendResponse)($,k,new Response(null,{status:500})),null}}e.s(["handler",()=>j,"patchFetch",()=>v,"routeModule",()=>C,"serverHooks",()=>E,"workAsyncStorage",()=>_,"workUnitAsyncStorage",()=>S]),n()}catch(e){n(e)}},!1)];

//# sourceMappingURL=%5Broot-of-the-server%5D__50a29e1b._.js.map