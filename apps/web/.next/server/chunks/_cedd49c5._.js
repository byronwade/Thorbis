module.exports=[479404,(e,t,r)=>{"use strict";t.exports=e.r(664598).vendored["react-rsc"].ReactServerDOMTurbopackServer},471312,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"registerServerReference",{enumerable:!0,get:function(){return a.registerServerReference}});let a=e.r(479404)},798348,(e,t,r)=>{"use strict";function a(e){for(let t=0;t<e.length;t++){let r=e[t];if("function"!=typeof r)throw Object.defineProperty(Error(`A "use server" file can only export async functions, found ${typeof r}.
Read more: https://nextjs.org/docs/messages/invalid-use-server-value`),"__NEXT_ERROR_CODE",{value:"E352",enumerable:!1,configurable:!0})}}Object.defineProperty(r,"__esModule",{value:!0}),Object.defineProperty(r,"ensureServerEntryExports",{enumerable:!0,get:function(){return a}})},273568,e=>{"use strict";var t=e.i(471312),r=e.i(381259);async function a(){let e=process.env.SUPABASE_POOLER_URL||process.env.WEB_SUPABASE_URL||"https://togejqdwggezkxahomeh.supabase.co",t=process.env.SUPABASE_SERVICE_ROLE_KEY||process.env.WEB_SUPABASE_SERVICE_ROLE_KEY||process.env.ADMIN_SUPABASE_SERVICE_ROLE_KEY;return e&&t?(0,r.createClient)(e,t,{auth:{persistSession:!1,autoRefreshToken:!1},db:{schema:"public"},global:{headers:{"x-my-custom-header":"service-role"}}}):(console.error("[Service Client] Missing env vars:",{hasUrl:!!e,hasKey:!!t}),null)}(0,e.i(798348).ensureServerEntryExports)([a]),(0,t.registerServerReference)(a,"0019fc87e7e6431afdf7d20a35eba18ff0e93dd810",null),e.s(["createServiceSupabaseClient",()=>a])},985647,e=>{"use strict";var t=e.i(511368),r=e.i(273568),a=e.i(849614),i=e.i(177585);let n="active_company_id",s=(0,a.cache)(async()=>{let t,{cookies:r}=await e.A(226115);try{t=await r()}catch(e){if(e instanceof Error&&(e.message.includes("During prerendering")||e.message.includes("prerendering")||e.message.includes("cookies()")))return null;throw e}let a=t.get(n)?.value;if(a&&await m(a))return a;let i=await u();return i[0]?.id?i[0].id:process.env.DEFAULT_COMPANY_ID||null}),o=(0,a.cache)(async()=>{let e=await s();if(!e)return null;let r=await (0,t.createClient)();if(!r)return null;let{data:a}=await r.from("companies").select("id, name, logo, phone, email").eq("id",e).is("deleted_at",null).single();return a});async function c(t){if(!await m(t))throw Error("You don't have access to this company");let{cookies:r}=await e.A(226115);(await r()).set(n,t,{httpOnly:!0,secure:!0,sameSite:"lax",maxAge:2592e3,path:"/"})}async function l(){let{cookies:t}=await e.A(226115);(await t()).delete(n)}let u=(0,a.cache)(async()=>{let e=await (0,i.getCurrentUser)();if(!e)return[];let t=await (0,r.createServiceSupabaseClient)();if(!t)return[];let{data:a}=await t.from("company_memberships").select(`
      company_id,
      companies!inner (
        id,
        name,
        logo,
        deleted_at,
        onboarding_completed_at
      )
    `).eq("user_id",e.id).eq("status","active").is("companies.deleted_at",null);return a?a.sort((e,t)=>{let r=!!e.companies.onboarding_completed_at,a=!!t.companies.onboarding_completed_at;return r&&!a?-1:!r&&a?1:e.companies.name.localeCompare(t.companies.name)}).map(e=>({id:e.companies.id,name:e.companies.name,logo:e.companies.logo})):[]}),m=(0,a.cache)(async e=>{let r=await (0,i.getCurrentUser)();if(!r)return!1;let a=await (0,t.createClient)();if(!a)return!1;let[n,s]=await Promise.all([a.from("companies").select("id").eq("id",e).is("deleted_at",null).single(),a.from("company_memberships").select("id").eq("user_id",r.id).eq("company_id",e).eq("status","active").single()]);return!!(n.data&&s.data)}),p=(0,a.cache)(async()=>{let e=await (0,i.getCurrentUser)();if(!e)return null;let r=await s();if(!r)return null;let a=await (0,t.createClient)();if(!a)return null;let{data:n}=await a.from("team_members").select("id").eq("user_id",e.id).eq("company_id",r).eq("status","active").single();return n?.id||null});async function d(){let e=await s();if(!e)throw Error("No active company selected. Please select a company.");return e}async function v(){let e=await (0,i.getCurrentUser)();if(!e)return!1;let t=await s();if(!t)return!1;let a=await (0,r.createServiceSupabaseClient)();if(!a)return!1;let{data:n}=await a.from("company_memberships").select("company_id, companies!inner(stripe_subscription_status, onboarding_progress, onboarding_completed_at)").eq("user_id",e.id).eq("company_id",t).eq("status","active").maybeSingle();if(!n)return!1;let o=Array.isArray(n.companies)?n.companies[0]:n.companies,c=o?.stripe_subscription_status,l=function(e){let{progress:t,completedAt:r}=e;if(r)return!0;if(!t||"object"!=typeof t)return!1;if(!0===t.onboardingCompleted)return!0;let a=t.completedSteps;return!!(Array.isArray(a)&&a.includes("complete"))}({progress:o?.onboarding_progress||null,completedAt:o?.onboarding_completed_at??null});return("active"===c||"trialing"===c)&&l||!1}e.s(["clearActiveCompany",()=>l,"getActiveCompany",0,o,"getActiveCompanyId",0,s,"getActiveTeamMemberId",0,p,"getUserCompanies",0,u,"isActiveCompanyOnboardingComplete",()=>v,"requireActiveCompany",()=>d,"setActiveCompany",()=>c],985647)},16106,e=>{"use strict";e.i(985647),e.s([])},907631,e=>{"use strict";e.i(16106);var t=e.i(985647);e.s(["clearActiveCompany",()=>t.clearActiveCompany,"getActiveCompany",()=>t.getActiveCompany,"getActiveCompanyId",()=>t.getActiveCompanyId,"getActiveTeamMemberId",()=>t.getActiveTeamMemberId,"getUserCompanies",()=>t.getUserCompanies,"isActiveCompanyOnboardingComplete",()=>t.isActiveCompanyOnboardingComplete,"requireActiveCompany",()=>t.requireActiveCompany,"setActiveCompany",()=>t.setActiveCompany])},226115,e=>{e.v(t=>Promise.all(["server/chunks/3c0ae_next_09aa2dd0._.js"].map(t=>e.l(t))).then(()=>t(766988)))}];

//# sourceMappingURL=_cedd49c5._.js.map