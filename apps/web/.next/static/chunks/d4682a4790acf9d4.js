(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,330557,e=>{"use strict";let s=(0,e.i(383206).default)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);e.s(["default",()=>s])},181893,e=>{"use strict";var s=e.i(330557);e.s(["Zap",()=>s.default])},789067,e=>{"use strict";e.i(116233),e.s([])},920312,e=>{"use strict";let s=(0,e.i(383206).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["default",()=>s])},148347,e=>{"use strict";var s=e.i(920312);e.s(["Filter",()=>s.default])},707306,e=>{"use strict";let s=(0,e.i(383206).default)("rotate-ccw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);e.s(["default",()=>s])},465333,e=>{"use strict";var s=e.i(707306);e.s(["RotateCcw",()=>s.default])},330735,e=>{"use strict";var s=e.i(40498);e.s(["Edit3",()=>s.default])},242951,e=>{"use strict";let s=(0,e.i(383206).default)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);e.s(["default",()=>s])},840044,e=>{"use strict";var s=e.i(242951);e.s(["Database",()=>s.default])},982759,e=>{"use strict";var s=e.i(111043),t=e.i(970799),a=e.i(581435),i=e.i(751139),l=e.i(852648),r=e.i(512710),n=e.i(136764),c=e.i(148347),d=e.i(465333),o=e.i(710575),x=e.i(142642),u=e.i(532727),h=e.i(330735),m=e.i(371526),v=e.i(840044),j=e.i(181893);e.i(889265);var p=e.i(677607);e.i(553153);var g=e.i(363712);e.i(244242);var f=e.i(563078);e.i(539870);var b=e.i(846358);e.i(526120);var N=e.i(610120),y=e.i(152088),w=e.i(552038),S=(0,w.createServerReference)("40ab9d70d6580ff2961c19a49b16b0d79fb154a980",w.callServer,void 0,w.findSourceMapURL,"getActivityLogAction"),C=(0,w.createServerReference)("407af3536fdb297e86672e08c42b1cbcc44605b218",w.callServer,void 0,w.findSourceMapURL,"getActivityStatsAction"),k=(0,w.createServerReference)("402e94d78c610a36a4222e56d34f753c7b90de4f2a",w.callServer,void 0,w.findSourceMapURL,"previewUndoAction"),A=(0,w.createServerReference)("605b87bf15aa040b179e0be36b8187647d08cd6ade",w.callServer,void 0,w.findSourceMapURL,"undoActionAction");let D={low:{label:"Low",color:"bg-slate-500",icon:l.CheckCircle2},medium:{label:"Medium",color:"bg-blue-500",icon:n.Clock},high:{label:"High",color:"bg-amber-500",icon:i.AlertTriangle},critical:{label:"Critical",color:"bg-red-500",icon:o.Shield}},M={create:{label:"Created",icon:m.Plus},update:{label:"Updated",icon:h.Edit3},delete:{label:"Deleted",icon:u.Trash2},query:{label:"Queried",icon:v.Database},tool_call:{label:"Tool Call",icon:j.Zap}};function R(){let[e,l]=(0,t.useState)([]),[n,o]=(0,t.useState)(0),[u,h]=(0,t.useState)(null),[m,w]=(0,t.useTransition)(),[R,z]=(0,t.useState)([]),[T,F]=(0,t.useState)([]),[L,B]=(0,t.useState)(0),[U,I]=(0,t.useState)(null),[O,P]=(0,t.useState)(""),[q,E]=(0,t.useState)(!1),H=(0,t.useCallback)(()=>{w(async()=>{let[e,s]=await Promise.all([S({limit:50,offset:50*L,severityFilter:R.length>0?R:void 0,actionFilter:T.length>0?T:void 0}),C()]);e.error||(l(e.entries),o(e.total)),!s.error&&s.stats&&h({totalActions:s.stats.totalActions,bySeverity:s.stats.bySeverity,criticalActionsCount:s.stats.criticalActionsCount,reversalRate:s.stats.reversalRate})})},[L,R,T]);(0,t.useEffect)(()=>{H()},[H]);let Z=async e=>{let{preview:s}=await k(e.id);I({entry:e,preview:s}),P("")},K=async()=>{U&&(E(!0),(await A(U.entry.id,O||"User requested undo")).success&&(I(null),H()),E(!1))};return(0,s.jsxs)("div",{className:"flex flex-col h-full p-4 space-y-4",children:[u&&(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-card",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Total Actions (7d)"}),(0,s.jsx)("div",{className:"text-2xl font-semibold",children:u.totalActions.toLocaleString()})]}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-card",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Critical Actions"}),(0,s.jsx)("div",{className:"text-2xl font-semibold text-red-500",children:u.criticalActionsCount})]}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-card",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"Reversal Rate"}),(0,s.jsxs)("div",{className:"text-2xl font-semibold",children:[u.reversalRate.toFixed(1),"%"]})]}),(0,s.jsxs)("div",{className:"p-4 border rounded-lg bg-card",children:[(0,s.jsx)("div",{className:"text-xs text-muted-foreground",children:"High Severity"}),(0,s.jsx)("div",{className:"text-2xl font-semibold text-amber-500",children:(u.bySeverity.high||0)+(u.bySeverity.critical||0)})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(f.DropdownMenu,{children:[(0,s.jsx)(f.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(p.Button,{variant:"outline",size:"sm",className:"gap-2",children:[(0,s.jsx)(c.Filter,{className:"size-4"}),"Severity",R.length>0&&(0,s.jsx)(g.Badge,{variant:"secondary",className:"ml-1",children:R.length}),(0,s.jsx)(r.ChevronDown,{className:"size-3"})]})}),(0,s.jsxs)(f.DropdownMenuContent,{children:[(0,s.jsx)(f.DropdownMenuLabel,{children:"Filter by Severity"}),(0,s.jsx)(f.DropdownMenuSeparator,{}),Object.keys(D).map(e=>(0,s.jsxs)(f.DropdownMenuCheckboxItem,{checked:R.includes(e),onCheckedChange:()=>{z(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]),B(0)},children:[(0,s.jsx)("span",{className:(0,y.cn)("size-2 rounded-full mr-2",D[e].color)}),D[e].label]},e))]})]}),(0,s.jsxs)(f.DropdownMenu,{children:[(0,s.jsx)(f.DropdownMenuTrigger,{asChild:!0,children:(0,s.jsxs)(p.Button,{variant:"outline",size:"sm",className:"gap-2",children:[(0,s.jsx)(j.Zap,{className:"size-4"}),"Action",T.length>0&&(0,s.jsx)(g.Badge,{variant:"secondary",className:"ml-1",children:T.length}),(0,s.jsx)(r.ChevronDown,{className:"size-3"})]})}),(0,s.jsxs)(f.DropdownMenuContent,{children:[(0,s.jsx)(f.DropdownMenuLabel,{children:"Filter by Action"}),(0,s.jsx)(f.DropdownMenuSeparator,{}),Object.keys(M).map(e=>(0,s.jsx)(f.DropdownMenuCheckboxItem,{checked:T.includes(e),onCheckedChange:()=>{F(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e]),B(0)},children:M[e].label},e))]})]}),(R.length>0||T.length>0)&&(0,s.jsx)(p.Button,{variant:"ghost",size:"sm",onClick:()=>{z([]),F([])},children:"Clear filters"}),(0,s.jsx)("div",{className:"flex-1"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[n.toLocaleString()," entries"]})]}),(0,s.jsx)("div",{className:"flex-1 border rounded-lg overflow-hidden",children:(0,s.jsx)("div",{className:"divide-y overflow-auto h-full",children:m&&0===e.length?(0,s.jsxs)("div",{className:"flex items-center justify-center h-40 text-muted-foreground",children:[(0,s.jsx)(x.Sparkles,{className:"size-5 animate-pulse mr-2"}),"Loading activity..."]}):0===e.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center h-40 text-muted-foreground",children:[(0,s.jsx)(v.Database,{className:"size-8 mb-2 opacity-40"}),(0,s.jsx)("p",{className:"text-sm",children:"No activity found"}),(0,s.jsx)("p",{className:"text-xs",children:"AI actions will appear here when performed"})]}):e.map(e=>{let t=D[e.severity]||D.low,i=M[e.action]||{label:e.action,icon:j.Zap},l=i.icon,r=t.icon;return(0,s.jsxs)("div",{className:(0,y.cn)("p-4 flex items-start gap-4 hover:bg-muted/50 transition-colors",e.reversed&&"opacity-50"),children:[(0,s.jsx)("div",{className:(0,y.cn)("size-8 rounded-full flex items-center justify-center shrink-0",t.color,"bg-opacity-20"),children:(0,s.jsx)(l,{className:(0,y.cn)("size-4",`text-${t.color.replace("bg-","")}`)})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"font-medium",children:i.label}),(0,s.jsx)("span",{className:"text-muted-foreground",children:e.entityType}),e.entityId&&(0,s.jsxs)("code",{className:"text-xs bg-muted px-1.5 py-0.5 rounded",children:[e.entityId.slice(0,8),"..."]}),e.reversed&&(0,s.jsx)(g.Badge,{variant:"outline",className:"text-xs",children:"Reversed"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1 text-xs text-muted-foreground",children:[(0,s.jsx)(r,{className:"size-3"}),(0,s.jsx)("span",{children:t.label}),e.toolName&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"•"}),(0,s.jsxs)("span",{children:["Tool: ",e.toolName]})]}),e.changedFields.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{children:"•"}),(0,s.jsxs)("span",{children:["Fields: ",e.changedFields.join(", ")]})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,s.jsx)("span",{className:"text-xs text-muted-foreground",children:(0,a.formatDistanceToNow)(new Date(e.createdAt),{addSuffix:!0})}),e.isReversible&&!e.reversed&&(0,s.jsxs)(p.Button,{variant:"ghost",size:"sm",onClick:()=>Z(e),className:"gap-1.5 h-7 text-xs",children:[(0,s.jsx)(d.RotateCcw,{className:"size-3"}),"Undo"]})]})]},e.id)})})}),n>50&&(0,s.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,s.jsx)(p.Button,{variant:"outline",size:"sm",disabled:0===L,onClick:()=>B(e=>e-1),children:"Previous"}),(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",L+1," of ",Math.ceil(n/50)]}),(0,s.jsx)(p.Button,{variant:"outline",size:"sm",disabled:(L+1)*50>=n,onClick:()=>B(e=>e+1),children:"Next"})]}),(0,s.jsx)(b.Dialog,{open:!!U,onOpenChange:e=>!e&&I(null),children:(0,s.jsxs)(b.DialogContent,{children:[(0,s.jsxs)(b.DialogHeader,{children:[(0,s.jsx)(b.DialogTitle,{children:"Undo AI Action"}),(0,s.jsx)(b.DialogDescription,{children:"This will restore the entity to its previous state. This action is logged."})]}),U?.preview&&(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"p-3 bg-muted rounded-lg space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Entity Type"}),(0,s.jsx)("span",{className:"font-medium",children:U.preview.entityType})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Operation"}),(0,s.jsx)("span",{className:"font-medium",children:U.preview.operation})]}),U.preview.changedFields.length>0&&(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-muted-foreground",children:"Fields to Restore"}),(0,s.jsx)("span",{className:"font-medium",children:U.preview.changedFields.join(", ")})]})]}),!U.preview.canRevert&&(0,s.jsxs)("div",{className:"p-3 bg-destructive/10 border border-destructive/20 rounded-lg text-sm text-destructive",children:[(0,s.jsx)(i.AlertTriangle,{className:"size-4 inline mr-2"}),U.preview.reason||"Cannot revert this action"]}),(0,s.jsx)(N.Textarea,{placeholder:"Reason for undo (optional)",value:O,onChange:e=>P(e.target.value),rows:2})]}),(0,s.jsxs)(b.DialogFooter,{children:[(0,s.jsx)(p.Button,{variant:"outline",onClick:()=>I(null),children:"Cancel"}),(0,s.jsx)(p.Button,{onClick:K,disabled:q||!U?.preview?.canRevert,variant:"destructive",children:q?"Reverting...":"Confirm Undo"})]})]})})]})}e.s(["ActivityLogContent",()=>R],982759)},676492,e=>{"use strict";var s=e.i(111043);e.i(789067);var t=e.i(861308);function a(){return(0,s.jsxs)("div",{className:"flex flex-col h-full p-4 space-y-4",children:[(0,s.jsx)("div",{className:"grid grid-cols-4 gap-4",children:Array.from({length:4}).map((e,a)=>(0,s.jsxs)("div",{className:"p-4 border rounded-lg",children:[(0,s.jsx)(t.Skeleton,{className:"h-4 w-20 mb-2"}),(0,s.jsx)(t.Skeleton,{className:"h-8 w-16"})]},a))}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(t.Skeleton,{className:"h-9 w-32"}),(0,s.jsx)(t.Skeleton,{className:"h-9 w-32"}),(0,s.jsx)(t.Skeleton,{className:"h-9 w-40"})]}),(0,s.jsx)("div",{className:"border rounded-lg divide-y",children:Array.from({length:8}).map((e,a)=>(0,s.jsxs)("div",{className:"p-4 flex items-center gap-4",children:[(0,s.jsx)(t.Skeleton,{className:"size-8 rounded-full"}),(0,s.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,s.jsx)(t.Skeleton,{className:"h-4 w-48"}),(0,s.jsx)(t.Skeleton,{className:"h-3 w-32"})]}),(0,s.jsx)(t.Skeleton,{className:"h-8 w-20"})]},a))})]})}e.s(["ActivityLogSkeleton",()=>a])}]);