(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,306466,e=>{"use strict";let s=(0,e.i(383206).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["default",()=>s])},598870,e=>{"use strict";var s=e.i(306466);e.s(["Save",()=>s.default])},75919,e=>{"use strict";e.s([])},847301,914239,575373,e=>{"use strict";var s=e.i(111043),t=e.i(79254),r=e.i(288413),a=e.i(641304),n=e.i(598870),i=e.i(904653);e.i(553153);var d=e.i(363712);e.i(889265);var l=e.i(677607);e.i(794747);var c=e.i(513990);function o({title:e,description:o,helpText:u,hasChanges:m=!1,isPending:x=!1,isLoading:p=!1,onSave:h,onCancel:g,saveButtonText:j="Save Settings",children:v}){let f=(0,i.useRouter)();return p?(0,s.jsx)("div",{className:"flex h-[50vh] items-center justify-center",children:(0,s.jsx)(a.Loader2,{className:"text-muted-foreground size-8 animate-spin"})}):(0,s.jsxs)("div",{className:"space-y-8 py-8",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold tracking-tight",children:e}),u&&(0,s.jsxs)(c.Tooltip,{children:[(0,s.jsx)(c.TooltipTrigger,{asChild:!0,children:(0,s.jsx)("button",{className:"flex-shrink-0",type:"button",children:(0,s.jsx)(r.HelpCircle,{className:"text-muted-foreground h-3.5 w-3.5"})})}),(0,s.jsx)(c.TooltipContent,{className:"max-w-xs",children:(0,s.jsx)("p",{className:"text-sm",children:u})})]})]}),m&&(0,s.jsx)(d.Badge,{className:"bg-warning hover:bg-warning",children:"Unsaved Changes"})]}),(0,s.jsx)("p",{className:"text-muted-foreground text-lg",children:o})]}),(0,s.jsx)("div",{className:"space-y-6",children:v}),(0,s.jsx)("div",{className:"bg-card sticky bottom-0 z-10 rounded-xl border p-6 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"flex items-center gap-3",children:m?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-warning dark:bg-warning/30 flex h-8 w-8 items-center justify-center rounded-full",children:(0,s.jsx)("div",{className:"bg-warning h-2 w-2 animate-pulse rounded-full"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Unsaved Changes"}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Save your changes or discard them"})]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"bg-success dark:bg-success/30 flex h-8 w-8 items-center justify-center rounded-full",children:(0,s.jsx)(t.Check,{className:"text-success dark:text-success h-4 w-4"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"All Changes Saved"}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Your settings are up to date"})]})]})}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)(l.Button,{disabled:x,onClick:g||(()=>f.refresh()),type:"button",variant:"outline",children:"Cancel"}),(0,s.jsx)(l.Button,{disabled:x||!m,onClick:h,type:"button",children:x?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(a.Loader2,{className:"mr-2 size-4 animate-spin"}),"Saving..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.Save,{className:"mr-2 size-4"}),j]})})]})]})})]})}e.i(254851),e.i(605278),e.s(["SettingsPageLayout",()=>o],847301),e.i(116233),e.s([],914239);var u=e.i(970799),m=e.i(51052);function x({getter:e,setter:s,initialState:t,settingsName:r,transformLoad:a,transformSave:n,prefetchedData:i}){let{toast:d}=(0,m.useToast)(),[l,c]=(0,u.useTransition)(),o=(0,u.useRef)(!!i),x=(0,u.useRef)({...t,...i??{}}),[p,h]=(0,u.useState)(x.current),[g,j]=(0,u.useState)(x.current),[v,f]=(0,u.useState)(!i),[b,y]=(0,u.useState)(!1);async function S(){f(!0);try{let s=await e();if(s.success&&s.data){let e=a?a(s.data):s.data,r={...t,...e};h(r),j(r),y(!1)}}catch(e){d.error(`Failed to load ${r} settings`)}finally{f(!1)}}(0,u.useEffect)(()=>{if(o.current){o.current=!1;return}S()},[S]);let N=async e=>{c(async()=>{try{let t=e||(n?n(p):new FormData),a=await s(t);a.success?(j(p),y(!1),d.success(`${r.charAt(0).toUpperCase()+r.slice(1)} settings saved successfully`)):d.error(a.error||`Failed to save ${r} settings`)}catch(e){d.error(`An unexpected error occurred while saving ${r} settings`)}})};return{settings:p,isLoading:v,isPending:l,hasUnsavedChanges:b,updateSetting:(e,s)=>{h(t=>({...t,[e]:s})),y(!0)},updateSettings:e=>{h(s=>({...s,...e})),y(!0)},saveSettings:N,reset:()=>{h(g),y(!1)},reload:async()=>{await S()}}}e.s(["useSettings",()=>x],575373)},724531,e=>{"use strict";var s=e.i(111043),t=e.i(751139),r=e.i(288413),a=e.i(939397),n=e.i(121085),i=e.i(176378),d=e.i(970799);e.i(75919);var l=e.i(552038),c=(0,l.createServerReference)("001e268d704c80f5b89fb479dd6938d6e80fdd51dc",l.callServer,void 0,l.findSourceMapURL,"getSmsSettings"),o=(0,l.createServerReference)("40703142390e16b4c8335ffe2f874a170ff11db169",l.callServer,void 0,l.findSourceMapURL,"updateSmsSettings"),u=e.i(847301);e.i(914239);var m=e.i(342640);e.i(889265);var x=e.i(677607);e.i(254851);var p=e.i(605278);e.i(51478);var h=e.i(635613);e.i(149989);var g=e.i(880177);e.i(287133);var j=e.i(120109),v=e.i(220168);e.i(223342);var f=e.i(395645);e.i(526120);var b=e.i(610120);e.i(794747);var y=e.i(513990),S=e.i(575373);let N={provider:"telnyx",providerApiKey:"",senderNumber:"",autoReplyEnabled:!1,autoReplyMessage:"",optOutMessage:"Reply STOP to unsubscribe",includeOptOut:!0,consentRequired:!0};e.s(["default",0,function({initialSettings:e}){let{settings:l,isLoading:C,isPending:w,hasUnsavedChanges:T,updateSetting:k,saveSettings:R,reload:O}=(0,S.useSettings)({getter:c,setter:o,initialState:N,settingsName:"sms",prefetchedData:e??void 0,transformLoad:e=>e?{provider:e.provider??"telnyx",senderNumber:e.sender_number??"",autoReplyEnabled:e.auto_reply_enabled??!1,autoReplyMessage:e.auto_reply_message??"",optOutMessage:e.opt_out_message??"Reply STOP to unsubscribe",includeOptOut:e.include_opt_out??!0,consentRequired:e.consent_required??!0}:{},transformSave:e=>{let s=new FormData;return s.append("provider",e.provider),s.append("providerApiKey",e.providerApiKey),s.append("senderNumber",e.senderNumber),s.append("autoReplyEnabled",e.autoReplyEnabled.toString()),s.append("autoReplyMessage",e.autoReplyMessage),s.append("optOutMessage",e.optOutMessage),s.append("includeOptOut",e.includeOptOut.toString()),s.append("consentRequired",e.consentRequired.toString()),s}}),F=(0,d.useCallback)(()=>{R()},[R]),M=(0,d.useCallback)(()=>{O()},[O]);return(0,s.jsx)(y.TooltipProvider,{children:(0,s.jsxs)(u.SettingsPageLayout,{description:"Configure SMS sending numbers, auto-responses, and compliance defaults.",hasChanges:T,helpText:"Applies to all outbound text messages and automation.",isLoading:C,isPending:w,onCancel:M,onSave:F,saveButtonText:"Save SMS settings",title:"SMS & Text",children:[(0,s.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,s.jsx)(m.Breadcrumb,{children:(0,s.jsxs)(m.BreadcrumbList,{children:[(0,s.jsx)(m.BreadcrumbItem,{children:(0,s.jsx)(m.BreadcrumbLink,{asChild:!0,children:(0,s.jsx)(i.default,{href:"/dashboard/settings",children:"Settings"})})}),(0,s.jsx)(m.BreadcrumbSeparator,{}),(0,s.jsx)(m.BreadcrumbItem,{children:(0,s.jsx)(m.BreadcrumbLink,{asChild:!0,children:(0,s.jsx)(i.default,{href:"/dashboard/settings/communications",children:"Communications"})})}),(0,s.jsx)(m.BreadcrumbSeparator,{}),(0,s.jsx)(m.BreadcrumbItem,{children:(0,s.jsx)(m.BreadcrumbPage,{children:"SMS"})})]})}),(0,s.jsx)(x.Button,{asChild:!0,variant:"ghost",children:(0,s.jsxs)(i.default,{href:"/dashboard/settings/communications",children:[(0,s.jsx)(n.Settings,{className:"mr-2 size-4"}),"Back to communications"]})})]}),(0,s.jsxs)(p.Card,{children:[(0,s.jsxs)(p.CardHeader,{children:[(0,s.jsxs)(p.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(a.Phone,{className:"size-4"}),"Sender Identity"]}),(0,s.jsx)(p.CardDescription,{children:"Number and name customers see"})]}),(0,s.jsx)(p.CardContent,{className:"space-y-4",children:(0,s.jsxs)(v.StandardFormRow,{cols:2,children:[(0,s.jsxs)(v.StandardFormField,{label:"SMS phone number",htmlFor:"sms-phone",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsxs)(y.Tooltip,{children:[(0,s.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(r.HelpCircle,{className:"text-muted-foreground size-3"})}),(0,s.jsx)(y.TooltipContent,{children:"Provisioned number used to send all texts."})]}),(0,s.jsx)("span",{className:"text-sm text-muted-foreground",children:"Provisioned number used to send all texts"})]}),(0,s.jsx)(h.Input,{id:"sms-phone",onChange:e=>k("senderNumber",e.target.value),placeholder:"(555) 123-4567",type:"tel",value:l.senderNumber}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Must match an active Telnyx or Twilio number."})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)(v.StandardFormField,{label:"Provider",htmlFor:"sms-provider",children:(0,s.jsxs)("select",{id:"sms-provider",className:"border-input bg-background block w-full rounded-md border px-3 py-2 text-sm",onChange:e=>k("provider",e.target.value),value:l.provider,children:[(0,s.jsx)("option",{value:"telnyx",children:"Telnyx"}),(0,s.jsx)("option",{value:"twilio",children:"Twilio"}),(0,s.jsx)("option",{value:"other",children:"Other"})]})}),(0,s.jsxs)(v.StandardFormField,{label:"Provider API Key",htmlFor:"sms-api-key",children:[(0,s.jsx)(h.Input,{id:"sms-api-key",onChange:e=>k("providerApiKey",e.target.value),placeholder:"Provider API key",type:"password",value:l.providerApiKey}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Stored securely; leave blank to keep existing."})]})]})]})})]}),(0,s.jsxs)(p.Card,{children:[(0,s.jsxs)(p.CardHeader,{children:[(0,s.jsx)(p.CardTitle,{children:"Auto-response"}),(0,s.jsx)(p.CardDescription,{children:"Automatically reply when a customer texts you"})]}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between rounded-lg border p-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Enable auto-response"}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Sends an immediate acknowledgment outside business hours."})]}),(0,s.jsx)(f.Switch,{checked:l.autoReplyEnabled,onCheckedChange:e=>k("autoReplyEnabled",e)})]}),l.autoReplyEnabled&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.Separator,{}),(0,s.jsxs)(v.StandardFormField,{label:"Auto-response message",htmlFor:"auto-response-msg",children:[(0,s.jsx)(b.Textarea,{id:"auto-response-msg",className:"min-h-[120px] resize-none",onChange:e=>k("autoReplyMessage",e.target.value),placeholder:"Thanks for texting! We'll respond during business hours.",value:l.autoReplyMessage}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Sent once per conversation when an incoming SMS is received."})]})]})]})]}),(0,s.jsxs)(p.Card,{children:[(0,s.jsxs)(p.CardHeader,{children:[(0,s.jsx)(p.CardTitle,{children:"Compliance"}),(0,s.jsx)(p.CardDescription,{children:"Required messaging disclosures and consent tracking"})]}),(0,s.jsxs)(p.CardContent,{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)(g.Label,{className:"flex items-center gap-2 text-sm font-medium",children:["Include opt-out instructions",(0,s.jsxs)(y.Tooltip,{children:[(0,s.jsx)(y.TooltipTrigger,{asChild:!0,children:(0,s.jsx)(r.HelpCircle,{className:"text-muted-foreground size-3"})}),(0,s.jsx)(y.TooltipContent,{children:"Automatically append “Reply STOP to unsubscribe”."})]})]}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Required for promotional messaging in most regions."})]}),(0,s.jsx)(f.Switch,{checked:l.includeOptOut,onCheckedChange:e=>k("includeOptOut",e)})]}),(0,s.jsx)(j.Separator,{}),(0,s.jsxs)(v.StandardFormField,{label:"Opt-out message",htmlFor:"opt-out-msg",children:[(0,s.jsx)(b.Textarea,{id:"opt-out-msg",className:"min-h-[80px] resize-none",onChange:e=>k("optOutMessage",e.target.value),value:l.optOutMessage}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Displayed after any outgoing SMS when opt-out instructions are enabled."})]}),(0,s.jsx)(j.Separator,{}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Consent required"}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"Only send messages to contacts with documented consent."})]}),(0,s.jsx)(f.Switch,{checked:l.consentRequired,onCheckedChange:e=>k("consentRequired",e)})]})]})]}),(0,s.jsx)(p.Card,{className:"border-warning/40 bg-warning/5",children:(0,s.jsxs)(p.CardContent,{className:"flex items-start gap-3 pt-6",children:[(0,s.jsx)(t.AlertTriangle,{className:"text-warning size-5"}),(0,s.jsxs)("div",{className:"space-y-1",children:[(0,s.jsx)("p",{className:"text-warning text-sm font-semibold",children:"Compliance reminder"}),(0,s.jsx)("p",{className:"text-muted-foreground text-sm",children:"Follow TCPA/CTIA guidelines: honor STOP requests immediately, keep quiet hours, and collect explicit consent before sending marketing texts. Configure opt-outs and consent policies here so Thorbis can enforce them automatically."})]})]})})]})})}],724531)}]);