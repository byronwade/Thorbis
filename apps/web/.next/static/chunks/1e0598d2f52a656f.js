(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672573,e=>{"use strict";let s=(0,e.i(383206).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["default",()=>s])},15751,e=>{"use strict";var s=e.i(672573);e.s(["MapPin",()=>s.default])},686787,e=>{"use strict";e.i(116233),e.s([])},374862,e=>{"use strict";var s=e.i(552038),t=(0,s.createServerReference)("406ba1c9655fc9a1b2015aea1e701e0412af96ce58",s.callServer,void 0,s.findSourceMapURL,"createJob");e.s(["createJob",()=>t])},756286,e=>{"use strict";var s=e.i(111043),t=e.i(230902),a=e.i(818796),l=e.i(327149),i=e.i(276389),r=e.i(606661),c=e.i(641304),n=e.i(15751),d=e.i(14435),o=e.i(904653),h=e.i(970799),m=e.i(374862);e.i(686787);var u=e.i(519539);e.i(889265);var x=e.i(677607);e.i(254851);var j=e.i(605278);e.i(51478);var p=e.i(635613);e.i(149989);var v=e.i(880177);e.i(868198);var S=e.i(798764);e.i(526120);var g=e.i(610120),y=e.i(152088);function b({customers:e,properties:b,teamMembers:N,defaultValues:C}){let f=(0,o.useRouter)(),[T,w]=(0,h.useTransition)(),[I,F]=(0,h.useState)(null),[L,V]=(0,h.useState)(C?.customerId||""),[k,D]=(0,h.useState)(C?.propertyId||""),[M,P]=(0,h.useState)(C?.assignedTo||""),[_,A]=(0,h.useState)(C?.title||""),[J,R]=(0,h.useState)(C?.description||""),[U,B]=(0,h.useState)(C?.priority||"medium"),[H,E]=(0,h.useState)(C?.jobType||""),[$,K]=(0,h.useState)(C?.scheduledStart?(0,t.format)(new Date(C.scheduledStart),"yyyy-MM-dd'T'HH:mm"):""),[O,q]=(0,h.useState)(""),[z,G]=(0,h.useState)(C?.notes||""),Q=(0,h.useMemo)(()=>L?b.filter(e=>e.customer_id===L):b,[b,L]),W=async e=>{(e.preventDefault(),F(null),k)?_.trim()?w(async()=>{let e=new FormData;e.set("propertyId",k),L&&e.set("customerId",L),e.set("title",_),J&&e.set("description",J),e.set("priority",U),H&&e.set("jobType",H),$&&e.set("scheduledStart",$),O&&e.set("scheduledEnd",O),M&&e.set("assignedTo",M),z&&e.set("notes",z);let s=await (0,m.createJob)(e);s.success?s.data?f.push(`/dashboard/work/${s.data}`):f.push("/dashboard/work"):F(s.error||"Failed to create job")}):F("Please enter a job title"):F("Please select a property for this job")};return(0,s.jsx)("div",{className:"container max-w-3xl py-6",children:(0,s.jsxs)(j.Card,{children:[(0,s.jsxs)(j.CardHeader,{children:[(0,s.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(l.Briefcase,{className:"h-5 w-5"}),"Create New Job"]}),(0,s.jsx)(j.CardDescription,{children:"Fill in the details below to create a new work order"})]}),(0,s.jsx)(j.CardContent,{children:(0,s.jsxs)("form",{onSubmit:W,className:"space-y-6",children:[I&&(0,s.jsxs)(u.Alert,{variant:"destructive",children:[(0,s.jsx)(a.AlertCircle,{className:"h-4 w-4"}),(0,s.jsx)(u.AlertDescription,{children:I})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,s.jsx)(d.User,{className:"h-4 w-4"}),"Customer & Location"]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"customer",children:"Customer"}),(0,s.jsxs)(S.Select,{value:L,onValueChange:e=>{if(V(e),k){let s=b.find(e=>e.id===k);s&&s.customer_id!==e&&D("")}let s=b.filter(s=>s.customer_id===e);1===s.length&&D(s[0].id)},children:[(0,s.jsx)(S.SelectTrigger,{id:"customer",children:(0,s.jsx)(S.SelectValue,{placeholder:"Select customer"})}),(0,s.jsx)(S.SelectContent,{children:e.map(e=>(0,s.jsx)(S.SelectItem,{value:e.id,children:e.display_name?e.display_name:e.first_name||e.last_name?`${e.first_name||""} ${e.last_name||""}`.trim():e.email||"Unknown"},e.id))})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(v.Label,{htmlFor:"property",children:["Property ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsxs)(S.Select,{value:k,onValueChange:D,children:[(0,s.jsx)(S.SelectTrigger,{id:"property",className:(0,y.cn)(!k&&"text-muted-foreground"),children:(0,s.jsx)(S.SelectValue,{placeholder:"Select property"})}),(0,s.jsx)(S.SelectContent,{children:Q.map(e=>(0,s.jsx)(S.SelectItem,{value:e.id,children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(n.MapPin,{className:"h-3 w-3 text-muted-foreground"}),[e.address,e.city,e.state].filter(Boolean).join(", ")||"Unknown address"]})},e.id))})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,s.jsx)(r.FileText,{className:"h-4 w-4"}),"Job Details"]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(v.Label,{htmlFor:"title",children:["Title ",(0,s.jsx)("span",{className:"text-destructive",children:"*"})]}),(0,s.jsx)(p.Input,{id:"title",placeholder:"e.g., HVAC Maintenance, Plumbing Repair",value:_,onChange:e=>A(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"description",children:"Description"}),(0,s.jsx)(g.Textarea,{id:"description",placeholder:"Describe the work to be done...",value:J,onChange:e=>R(e.target.value),rows:3})]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"jobType",children:"Job Type"}),(0,s.jsxs)(S.Select,{value:H,onValueChange:E,children:[(0,s.jsx)(S.SelectTrigger,{id:"jobType",children:(0,s.jsx)(S.SelectValue,{placeholder:"Select type"})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"service",children:"Service"}),(0,s.jsx)(S.SelectItem,{value:"installation",children:"Installation"}),(0,s.jsx)(S.SelectItem,{value:"repair",children:"Repair"}),(0,s.jsx)(S.SelectItem,{value:"maintenance",children:"Maintenance"}),(0,s.jsx)(S.SelectItem,{value:"inspection",children:"Inspection"}),(0,s.jsx)(S.SelectItem,{value:"consultation",children:"Consultation"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"priority",children:"Priority"}),(0,s.jsxs)(S.Select,{value:U,onValueChange:B,children:[(0,s.jsx)(S.SelectTrigger,{id:"priority",children:(0,s.jsx)(S.SelectValue,{placeholder:"Select priority"})}),(0,s.jsxs)(S.SelectContent,{children:[(0,s.jsx)(S.SelectItem,{value:"low",children:"Low"}),(0,s.jsx)(S.SelectItem,{value:"medium",children:"Medium"}),(0,s.jsx)(S.SelectItem,{value:"high",children:"High"}),(0,s.jsx)(S.SelectItem,{value:"urgent",children:"Urgent"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2 text-sm font-medium",children:[(0,s.jsx)(i.Calendar,{className:"h-4 w-4"}),"Schedule"]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"scheduledStart",children:"Start Date & Time"}),(0,s.jsx)(p.Input,{id:"scheduledStart",type:"datetime-local",value:$,onChange:e=>K(e.target.value)})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"scheduledEnd",children:"End Date & Time"}),(0,s.jsx)(p.Input,{id:"scheduledEnd",type:"datetime-local",value:O,onChange:e=>q(e.target.value)})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"assignedTo",children:"Assign To"}),(0,s.jsxs)(S.Select,{value:M,onValueChange:P,children:[(0,s.jsx)(S.SelectTrigger,{id:"assignedTo",children:(0,s.jsx)(S.SelectValue,{placeholder:"Select team member"})}),(0,s.jsx)(S.SelectContent,{children:N.map(e=>(0,s.jsxs)(S.SelectItem,{value:e.id,children:[e.name,e.jobTitle&&(0,s.jsxs)("span",{className:"text-muted-foreground",children:[" ","- ",e.jobTitle]})]},e.id))})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(v.Label,{htmlFor:"notes",children:"Internal Notes"}),(0,s.jsx)(g.Textarea,{id:"notes",placeholder:"Add any internal notes...",value:z,onChange:e=>G(e.target.value),rows:2})]}),(0,s.jsxs)("div",{className:"flex items-center justify-end gap-3 pt-4",children:[(0,s.jsx)(x.Button,{type:"button",variant:"outline",onClick:()=>f.back(),disabled:T,children:"Cancel"}),(0,s.jsx)(x.Button,{type:"submit",disabled:T,children:T?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create Job"})]})]})})]})})}e.s(["JobCreateForm",()=>b])}]);