(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672573,e=>{"use strict";let t=(0,e.i(383206).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["default",()=>t])},15751,e=>{"use strict";var t=e.i(672573);e.s(["MapPin",()=>t.default])},221999,e=>{"use strict";let t=(0,e.i(383206).default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);e.s(["default",()=>t])},560149,e=>{"use strict";var t=e.i(221999);e.s(["CalendarDays",()=>t.default])},52573,e=>{"use strict";let t=(0,e.i(383206).default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);e.s(["default",()=>t])},694288,e=>{"use strict";var t=e.i(52573);e.s(["Link",()=>t.default])},519131,e=>{"use strict";let t=(0,e.i(383206).default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);e.s(["default",()=>t])},233654,e=>{"use strict";var t=e.i(519131);e.s(["Paperclip",()=>t.default])},711448,e=>{"use strict";e.i(116233),e.s([])},305549,585506,e=>{"use strict";var t=e.i(111043),s=e.i(868422),a=e.i(227009);e.i(670258);var r=e.i(921251);e.i(711448);var i=e.i(157222);function l({activities:e}){return e&&0!==e.length?(0,t.jsx)(i.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"max-h-96 space-y-3 overflow-y-auto",children:e.map(e=>(0,t.jsxs)("div",{className:"hover:bg-muted/50 flex gap-3 rounded-lg border p-3 transition-colors",children:[(0,t.jsxs)(r.Avatar,{className:"size-8 flex-shrink-0",children:[(0,t.jsx)(r.AvatarImage,{src:e.user?.avatar}),(0,t.jsx)(r.AvatarFallback,{children:e.user?.name?.charAt(0)||"?"})]}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm break-words",children:e.description}),(0,t.jsxs)("p",{className:"text-muted-foreground mt-1 text-xs",children:[e.user?.name," •"," ",(0,s.formatDistance)(new Date(e.created_at),new Date,{addSuffix:!0})]})]})]},e.id))})}):(0,t.jsx)(i.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(a.Activity,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No activity yet"})]})})})}e.s(["ActivityLogSection",()=>l],305549);var n=e.i(882896),d=e.i(606661),c=e.i(233654),o=e.i(371526),m=e.i(826463),u=e.i(970799);e.i(889265);var x=e.i(677607),h=e.i(51052);function g({attachments:e,entityType:s,entityId:a,onUpload:r}){let{toast:l}=(0,h.useToast)(),[g,p]=(0,u.useState)(!1),f=async e=>{let t=e.target.files;if(t&&0!==t.length){p(!0);try{r&&await r(t),l.success(`${t.length} file(s) uploaded successfully`)}catch(e){l.error("Failed to upload files")}finally{p(!1),e.target.value=""}}};return(0,t.jsx)(i.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[r&&(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"hidden",disabled:g,id:"file-upload",multiple:!0,onChange:f,type:"file"}),(0,t.jsx)("label",{htmlFor:"file-upload",children:(0,t.jsx)(x.Button,{asChild:!0,className:"w-full cursor-pointer",disabled:g,size:"sm",variant:"outline",children:(0,t.jsx)("span",{children:g?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Upload,{className:"mr-2 size-4 animate-pulse"}),"Uploading..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Plus,{className:"mr-2 size-4"}),"Upload Files"]})})})})]}),e&&e.length>0?(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsxs)("div",{className:"hover:bg-muted/50 flex items-center justify-between rounded-lg border p-3 transition-colors",children:[(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-3",children:[(0,t.jsx)(d.FileText,{className:"text-muted-foreground size-4 flex-shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium",children:e.original_file_name||e.file_name||"Untitled"}),(0,t.jsxs)("p",{className:"text-muted-foreground text-xs",children:[e.file_size?`${(e.file_size/1024).toFixed(1)} KB`:"",e.category&&` • ${e.category}`]})]})]}),(0,t.jsx)(x.Button,{asChild:!0,className:"flex-shrink-0",size:"sm",variant:"ghost",children:(0,t.jsx)("a",{download:!0,href:e.storage_url||e.url,rel:"noopener noreferrer",target:"_blank",children:(0,t.jsx)(n.Download,{className:"size-4"})})})]},e.id))}):(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(c.Paperclip,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No attachments yet"})]})})]})})}e.s(["AttachmentsSection",()=>g],585506)},821305,278633,e=>{"use strict";var t=e.i(111043),s=e.i(227009),a=e.i(606661),r=e.i(694288),i=e.i(233654),l=e.i(702948),n=e.i(152088);function d({header:e,customHeader:s,metadata:a,beforeContent:r,afterContent:i,children:l,className:d,contentGapClassName:c,statsBar:o}){let m=a??e?.metadata??[];return(0,t.jsxs)("div",{className:(0,n.cn)("flex w-full flex-col gap-4 pb-24 lg:gap-5",d),"data-detail-shell":"",children:[o,s??(e?(0,t.jsx)(u,{section:e}):null),m.length>0?(0,t.jsx)(x,{items:m}):null,r,l?(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col gap-4",c),children:l}):null,i]})}let c={none:"p-0",sm:"p-4",md:"p-6",lg:"p-8"},o={default:"border border-border/60 bg-card shadow-sm",muted:"border border-border/60 bg-muted/40 shadow-sm",subtle:"border border-border/40 bg-card/80 shadow-sm",ghost:"border border-border/50 bg-transparent shadow-none"};function m({children:e,className:s,padding:a="md",variant:r="default"}){return(0,t.jsx)("section",{className:(0,n.cn)("rounded-xl",o[r],s),children:(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col gap-4",c[a]),children:e})})}function u({section:e}){var s;let{breadcrumbs:a,leadingVisual:r,title:i,subtitle:l,description:n,badges:d,actions:c,secondaryActions:o}=e;return(0,t.jsxs)("header",{className:"flex flex-col gap-4 lg:gap-6",children:[a?(0,t.jsx)("div",{className:"text-muted-foreground text-sm",children:a}):null,(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between lg:gap-8",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4",children:[r?(0,t.jsx)("div",{className:"flex items-center justify-center",children:r}):null,(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(s=i)?"string"==typeof s?(0,t.jsx)("h1",{className:"text-2xl font-semibold tracking-tight md:text-3xl",children:s}):(0,t.jsx)("div",{className:"text-2xl font-semibold tracking-tight md:text-3xl",children:s}):null,l?(0,t.jsx)("div",{className:"text-muted-foreground max-w-3xl text-sm md:text-base",children:l}):null]})]}),n?(0,t.jsx)("div",{className:"text-muted-foreground max-w-3xl text-sm",children:n}):null]})}),d&&d.length>0?(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:d}):null]}),h(c,o)?(0,t.jsxs)("div",{className:"hidden flex-wrap items-center gap-2 lg:flex",children:[c?.map((e,s)=>(0,t.jsx)("span",{className:"inline-flex",children:e},s)),o?.map((e,s)=>(0,t.jsx)("span",{className:"inline-flex",children:e},`secondary-${s}`))]}):null]}),h(c,o)?(0,t.jsxs)("div",{className:"flex flex-col gap-2 lg:hidden",children:[c&&c.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:c.map((e,s)=>(0,t.jsx)("span",{className:"flex-1",children:e},s))}):null,o&&o.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:o.map((e,s)=>(0,t.jsx)("span",{className:"flex-1",children:e},`secondary-mobile-${s}`))}):null]}):null]})}function x({items:e}){return(0,t.jsx)("section",{className:"@xl-page:grid-cols-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:e.map((e,s)=>(0,t.jsxs)("div",{className:"border-border/50 bg-card/60 flex flex-col gap-1 rounded-lg border px-4 py-3 shadow-sm",children:[(0,t.jsxs)("span",{className:"text-muted-foreground flex items-center gap-2 text-xs font-medium tracking-wide uppercase",children:[e.icon,e.label]}),(0,t.jsx)("div",{className:"text-foreground text-sm font-semibold",children:e.value}),e.helperText?(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:e.helperText}):null]},s))})}function h(e,t){return!!(e&&e.length>0||t&&t.length>0)}e.s(["DetailPageShell",()=>d,"DetailPageSurface",()=>m],278633);var g=e.i(305549),p=e.i(585506),f=e.i(868422),v=e.i(371526),b=e.i(970799);e.i(670258);var j=e.i(921251);e.i(889265);var N=e.i(677607);e.i(526120);var y=e.i(610120);e.i(711448);var k=e.i(157222),w=e.i(51052);function A({notes:e,entityType:s,entityId:r,onAddNote:i}){let{toast:l}=(0,w.useToast)(),[n,d]=(0,b.useState)(!1),[c,o]=(0,b.useState)(""),[m,u]=(0,b.useState)(!1),x=async()=>{if(i){if(!c.trim())return void l.error("Please enter a note");u(!0);try{await i(c),l.success("Note added successfully"),o(""),d(!1)}catch(e){l.error("Failed to add note")}finally{u(!1)}}};return(0,t.jsx)(k.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[i&&(n?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.Textarea,{autoFocus:!0,onChange:e=>o(e.target.value),placeholder:"Enter your note...",rows:3,value:c}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(N.Button,{disabled:m,onClick:x,size:"sm",children:m?"Saving...":"Save Note"}),(0,t.jsx)(N.Button,{onClick:()=>{d(!1),o("")},size:"sm",variant:"outline",children:"Cancel"})]})]}):(0,t.jsxs)(N.Button,{className:"w-full",onClick:()=>d(!0),size:"sm",variant:"outline",children:[(0,t.jsx)(v.Plus,{className:"mr-2 size-4"}),"Add Note"]})),e&&e.length>0?(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsx)("div",{className:"hover:bg-muted/50 rounded-lg border p-3 transition-colors",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(j.Avatar,{className:"size-8 flex-shrink-0",children:[(0,t.jsx)(j.AvatarImage,{src:e.user?.avatar}),(0,t.jsx)(j.AvatarFallback,{children:e.user?.name?.charAt(0)||"?"})]}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium",children:e.user?.name}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:(0,f.formatDistance)(new Date(e.created_at),new Date,{addSuffix:!0})})]}),(0,t.jsx)("p",{className:"mt-1 text-sm break-words whitespace-pre-wrap",children:e.content||e.note})]})]})},e.id))}):(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(a.FileText,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No notes yet"})]})})]})})}var C=e.i(87912),S=e.i(176378);e.i(553153);var z=e.i(363712);function T({relatedItems:e}){return e&&0!==e.length?(0,t.jsx)(k.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsxs)(S.default,{className:"group hover:bg-muted/50 flex items-center justify-between rounded-lg border p-3 transition-colors",href:e.href,children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium",children:e.title}),e.badge&&(0,t.jsx)(z.Badge,{className:"flex-shrink-0",variant:e.badge.variant||"default",children:e.badge.label})]}),e.subtitle&&(0,t.jsx)("p",{className:"text-muted-foreground truncate text-xs",children:e.subtitle})]}),(0,t.jsx)(C.ChevronRight,{className:"text-muted-foreground size-4 flex-shrink-0 transition-transform group-hover:translate-x-0.5"})]},e.id))})}):(0,t.jsx)(k.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(r.Link,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No related items"})]})})})}let $=(0,l.default)(()=>e.A(134181).then(e=>e.UnifiedAccordion),{loadableGenerated:{modules:[388024]},ssr:!1});function D({header:e,customHeader:l,customSections:c,activities:o=[],notes:u=[],attachments:x=[],relatedItems:h=[],showStandardSections:f={activities:!0,notes:!0,attachments:!0,relatedItems:!0},className:v,defaultOpenSection:b,beforeContent:j,afterContent:N,statsBar:y,contentGapClassName:k,surfacePadding:w="none",surfaceVariant:C="default",surfaceClassName:S,storageKey:z,enableReordering:D=!0}){let _=[];!1!==f.activities&&_.push({id:"activity-log",title:"Activity Log",icon:(0,t.jsx)(s.Activity,{className:"size-4"}),count:o.length,content:(0,t.jsx)(g.ActivityLogSection,{activities:o})}),!1!==f.notes&&_.push({id:"notes",title:"Notes",icon:(0,t.jsx)(a.FileText,{className:"size-4"}),count:u.length,content:(0,t.jsx)(A,{notes:u})}),!1!==f.attachments&&_.push({id:"attachments",title:"Attachments",icon:(0,t.jsx)(i.Paperclip,{className:"size-4"}),count:x.length,content:(0,t.jsx)(p.AttachmentsSection,{attachments:x})}),!1!==f.relatedItems&&h.length>0&&_.push({id:"related-items",title:"Related Items",icon:(0,t.jsx)(r.Link,{className:"size-4"}),count:h.length,content:(0,t.jsx)(T,{relatedItems:h})});let M=[...c||[],..._];return(0,t.jsx)(d,{afterContent:N,beforeContent:j,className:(0,n.cn)("w-full",v),contentGapClassName:k??"gap-4",customHeader:l,header:e,statsBar:y,children:(0,t.jsx)(m,{className:(0,n.cn)("overflow-hidden",S),padding:w,variant:C,children:(0,t.jsx)($,{defaultOpenSection:b||M[0]?.id,enableReordering:D,sections:M,storageKey:z})})})}e.s(["DetailPageContentLayout",()=>D],821305)},431111,e=>{"use strict";var t=e.i(111043),s=e.i(904653),a=e.i(970799),r=e.i(146798);function i({stats:e,children:i}){let l=(0,s.usePathname)()||"/dashboard",n=(0,r.useToolbarStatsStore)(e=>e.setStats),d=(0,r.useToolbarStatsStore)(e=>e.clearStats);return(0,a.useLayoutEffect)(()=>(e?n(l,e):d(l),()=>{d(l)}),[l,e,n,d]),(0,t.jsx)(t.Fragment,{children:i})}e.s(["ToolbarStatsProvider",()=>i])},235670,e=>{"use strict";e.i(116233),e.s([])},49718,307033,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("70ff12ee81a60340f786414d0baa7af58484dd7488",t.callServer,void 0,t.findSourceMapURL,"updateEntityTags");e.s(["updateEntityTags",()=>s],49718);var a=e.i(111043),r=e.i(371526),i=e.i(540374),l=e.i(212409),n=e.i(904653),d=e.i(970799),c=e.i(995403);e.i(235670);var o=e.i(360648);e.i(889265);var m=e.i(677607);e.i(51478);var u=e.i(635613);e.i(149989);var x=e.i(880177);e.i(220474);var h=e.i(171056);e.i(868198);var g=e.i(798764),p=e.i(220168);let f=[{name:"Red",value:"red",class:"bg-red-100 text-red-700 border-red-200 dark:bg-red-900/20 dark:text-red-400 dark:border-red-900/30"},{name:"Orange",value:"orange",class:"bg-orange-100 text-orange-700 border-orange-200 dark:bg-orange-900/20 dark:text-orange-400 dark:border-orange-900/30"},{name:"Amber",value:"amber",class:"bg-amber-100 text-amber-700 border-amber-200 dark:bg-amber-900/20 dark:text-amber-400 dark:border-amber-900/30"},{name:"Yellow",value:"yellow",class:"bg-yellow-100 text-yellow-700 border-yellow-200 dark:bg-yellow-900/20 dark:text-yellow-400 dark:border-yellow-900/30"},{name:"Green",value:"green",class:"bg-green-100 text-green-700 border-green-200 dark:bg-green-900/20 dark:text-green-400 dark:border-green-900/30"},{name:"Emerald",value:"emerald",class:"bg-emerald-100 text-emerald-700 border-emerald-200 dark:bg-emerald-900/20 dark:text-emerald-400 dark:border-emerald-900/30"},{name:"Teal",value:"teal",class:"bg-teal-100 text-teal-700 border-teal-200 dark:bg-teal-900/20 dark:text-teal-400 dark:border-teal-900/30"},{name:"Blue",value:"blue",class:"bg-blue-100 text-blue-700 border-blue-200 dark:bg-blue-900/20 dark:text-blue-400 dark:border-blue-900/30"},{name:"Indigo",value:"indigo",class:"bg-indigo-100 text-indigo-700 border-indigo-200 dark:bg-indigo-900/20 dark:text-indigo-400 dark:border-indigo-900/30"},{name:"Purple",value:"purple",class:"bg-purple-100 text-purple-700 border-purple-200 dark:bg-purple-900/20 dark:text-purple-400 dark:border-purple-900/30"},{name:"Pink",value:"pink",class:"bg-pink-100 text-pink-700 border-pink-200 dark:bg-pink-900/20 dark:text-pink-400 dark:border-pink-900/30"},{name:"Gray",value:"gray",class:"bg-gray-100 text-gray-700 border-gray-200 dark:bg-gray-900/20 dark:text-gray-400 dark:border-gray-900/30"}],v=f.reduce((e,t)=>({...e,[t.value]:t.class}),{});function b({entityId:e,entityType:t,tags:s,onUpdateTags:b,readOnly:j=!1}){(0,n.useRouter)();let[N,y]=(0,d.useState)(!1),[k,w]=(0,d.useState)(""),[A,C]=(0,d.useState)("blue"),[S,z]=(0,d.useState)(!1),[T,$]=(0,d.useState)(null),D=e=>"string"==typeof e?e:e.label,_=async()=>{if(!k.trim())return void c.toast.error("Please enter a tag name");z(!0);try{let t={label:k.trim(),color:A},a=[...s,t],r=await b(e,a);r.success?(c.toast.success("Tag added"),y(!1),w(""),C("blue")):c.toast.error(r.error||"Failed to add tag")}catch(e){c.toast.error("Failed to add tag")}finally{z(!1)}},M=async t=>{try{let a=s.filter(e=>{let s=D(e),a=D(t);return s!==a}),r=await b(e,a);r.success?c.toast.success("Tag removed"):c.toast.error(r.error||"Failed to remove tag")}catch(e){c.toast.error("Failed to remove tag")}finally{$(null)}},F=f.find(e=>e.value===A);return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[s.map((e,t)=>{let s=D(e),r="string"==typeof e?void 0:e.color,n=r&&v[r]?v[r]:v.blue;return(0,a.jsxs)("div",{className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-sm font-medium transition-colors ${n}`,children:[(0,a.jsx)(i.Tag,{className:"size-3"}),(0,a.jsx)("span",{children:s}),!j&&(0,a.jsx)(m.Button,{className:"ml-1 size-4 p-0 hover:bg-black/10 dark:hover:bg-white/10",onClick:()=>$(e),size:"icon",variant:"ghost",children:(0,a.jsx)(l.X,{className:"size-3"})})]},`${s}-${t}`)}),!j&&(0,a.jsxs)(h.Popover,{onOpenChange:y,open:N,children:[(0,a.jsx)(h.PopoverTrigger,{asChild:!0,children:(0,a.jsxs)("button",{className:"border-border/60 bg-background hover:border-primary/50 hover:bg-primary/5 inline-flex items-center gap-1.5 rounded-full border border-dashed px-3 py-1.5 text-sm font-medium transition-colors",children:[(0,a.jsx)(r.Plus,{className:"size-3"}),(0,a.jsx)("span",{children:"Add Tag"})]})}),(0,a.jsx)(h.PopoverContent,{align:"start",className:"w-80",side:"bottom",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold",children:"Create Custom Tag"}),(0,a.jsxs)("p",{className:"text-muted-foreground text-xs",children:["Add a custom tag for this ",t]})]}),(0,a.jsx)(p.StandardFormField,{label:"Tag Name",htmlFor:"tag-label",children:(0,a.jsx)(u.Input,{id:"tag-label",onChange:e=>w(e.target.value),onKeyDown:e=>{"Enter"===e.key&&_()},placeholder:"e.g., High Priority, VIP, etc.",value:k})}),(0,a.jsx)(p.StandardFormField,{label:"Color",htmlFor:"tag-color",children:(0,a.jsxs)(g.Select,{onValueChange:C,value:A,children:[(0,a.jsx)(g.SelectTrigger,{id:"tag-color",children:(0,a.jsx)(g.SelectValue,{children:F&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:`h-4 w-4 rounded-full ${F.class}`}),(0,a.jsx)("span",{children:F.name})]})})}),(0,a.jsx)(g.SelectContent,{children:f.map(e=>(0,a.jsx)(g.SelectItem,{value:e.value,children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("div",{className:`h-4 w-4 rounded-full ${e.class}`}),(0,a.jsx)("span",{children:e.name})]})},e.value))})]})}),k&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(x.Label,{children:"Preview"}),(0,a.jsxs)("div",{className:`inline-flex items-center gap-1.5 rounded-full border px-3 py-1.5 text-sm font-medium ${F?.class}`,children:[(0,a.jsx)(i.Tag,{className:"size-3"}),(0,a.jsx)("span",{children:k})]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(m.Button,{className:"flex-1",onClick:()=>y(!1),variant:"outline",children:"Cancel"}),(0,a.jsx)(m.Button,{className:"flex-1",disabled:S||!k.trim(),onClick:_,children:S?"Saving...":"Add Tag"})]})]})})]})]}),(0,a.jsx)(o.AlertDialog,{onOpenChange:()=>$(null),open:!!T,children:(0,a.jsxs)(o.AlertDialogContent,{children:[(0,a.jsxs)(o.AlertDialogHeader,{children:[(0,a.jsx)(o.AlertDialogTitle,{children:"Remove Tag"}),(0,a.jsxs)(o.AlertDialogDescription,{children:['Are you sure you want to remove the tag "',T?D(T):"",'"? This action cannot be undone.']})]}),(0,a.jsxs)(o.AlertDialogFooter,{children:[(0,a.jsx)(o.AlertDialogCancel,{children:"Cancel"}),(0,a.jsx)(o.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:()=>T&&M(T),children:"Remove"})]})]})})]})}e.s(["EntityTags",()=>b],307033)},933234,e=>{"use strict";var t=e.i(970799);function s(e){(0,t.useEffect)(()=>{let t=t=>{if(!t.ctrlKey||t.shiftKey||t.altKey||t.metaKey)return;let s=e[t.key];s&&(t.preventDefault(),s())};return window.addEventListener("keydown",t),()=>{window.removeEventListener("keydown",t)}},[e])}e.s(["useSectionShortcuts",()=>s])},14886,e=>{"use strict";e.i(116233),e.s([])},210298,e=>{"use strict";let t=(0,e.i(383206).default)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);e.s(["default",()=>t])},73905,e=>{"use strict";var t=e.i(210298);e.s(["GitBranch",()=>t.default])},699019,e=>{"use strict";let t=(0,e.i(383206).default)("notebook-pen",[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]]);e.s(["default",()=>t])},476171,e=>{"use strict";var t=e.i(111043),s=e.i(276389),a=e.i(560149),r=e.i(695877),i=e.i(606661),l=e.i(73905),n=e.i(15751),d=e.i(699019),d=d,c=e.i(60179),o=e.i(154115),m=e.i(14435),u=e.i(176378),x=e.i(904653),h=e.i(970799),g=e.i(995403),p=e.i(49718),f=e.i(821305),v=e.i(307033);e.i(553153);var b=e.i(363712);e.i(711448);var j=e.i(157222);e.i(14886);var N=e.i(362501),y=e.i(933234),k=e.i(871509),w=e.i(152088);function A(e){return e?e.toString().split("_").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Draft"}function C(e,t){if(!e)return t||"Unknown Customer";if(e.display_name)return e.display_name;let s=`${e.first_name||""} ${e.last_name||""}`.trim();return s||t||"Unknown Customer"}function S(e){return e&&(e.address||e.name||[e.city,e.state].filter(Boolean).join(", "))||"Property"}function z({entityData:e}){let z,$,D=(0,x.useRouter)(),{contract:F,customer:P,property:I,estimate:B,invoice:U,job:E,appointments:R=[]}=e,L=C(P,F.customerName),V=A(F.status),O=F.status?(0,t.jsx)(b.Badge,{className:(0,w.cn)("capitalize",function(e){switch(e){case"signed":return"bg-green-500/90 text-white hover:bg-green-600";case"sent":return"bg-primary/10 text-primary";case"viewed":return"bg-accent/10 text-accent-foreground";case"rejected":return"bg-destructive/10 text-destructive";case"expired":return"bg-warning/10 text-warning";default:return"bg-muted text-foreground"}}(F.status)),variant:"outline",children:V},"status-badge"):null,K=(z=F.contractNumber||`CON-${F.id.slice(0,8).toUpperCase()}`,$=[(0,t.jsx)(b.Badge,{variant:"outline",children:z},"contract-number")],O&&$.push(O),F.contractType&&$.push((0,t.jsx)(b.Badge,{className:"capitalize",variant:"secondary",children:F.contractType},"contract-type")),{title:F.title||z,subtitle:L,badges:$}),q=(0,h.useMemo)(()=>F?.contract_tags?F.contract_tags.map(e=>({id:e.id,name:e.name,slug:e.slug,color:e.color,category:e.category,icon:e.icon})):[],[F?.contract_tags]),G=(0,h.useMemo)(()=>({1:()=>{document.getElementById("contract-overview")?.scrollIntoView({behavior:"smooth"})},2:()=>{document.getElementById("contract-terms")?.scrollIntoView({behavior:"smooth"})},3:()=>{document.getElementById("signature")?.scrollIntoView({behavior:"smooth"})},4:()=>{document.getElementById("engagement-history")?.scrollIntoView({behavior:"smooth"})},5:()=>{document.getElementById("appointments")?.scrollIntoView({behavior:"smooth"})},9:()=>{document.getElementById("tags")?.scrollIntoView({behavior:"smooth"})}}),[]);(0,y.useSectionShortcuts)(G);let H=(0,h.useMemo)(()=>{let e=[];return e.push({key:"status",icon:l.GitBranch,label:"Status",value:V}),e.push({key:"sent",icon:o.Send,label:"Sent At",value:F.sentAt&&""!==F.sentAt?(0,k.formatDate)(F.sentAt,{preset:"datetime"}):"Not sent"}),e.push({key:"viewed",icon:a.CalendarDays,label:"Viewed",value:F.viewedAt&&""!==F.viewedAt?(0,k.formatDate)(F.viewedAt,{preset:"datetime"}):"Not viewed"}),e.push({key:"signed",icon:r.FileSignature,label:"Signed",value:F.signedAt&&""!==F.signedAt?(0,k.formatDate)(F.signedAt,{preset:"datetime"}):"Awaiting signature"}),e},[F.sentAt,F.viewedAt,F.signedAt,V]),J=(0,h.useMemo)(()=>{let e=[];return P?e.push({id:`customer-${P.id}`,type:"customer",title:C(P,F.customerName),subtitle:P.email||P.phone||void 0,href:`/dashboard/customers/${P.id}`}):F.customerId&&e.push({id:`customer-${F.customerId}`,type:"customer",title:F.customerName,href:`/dashboard/customers/${F.customerId}`}),I&&e.push({id:`property-${I.id}`,type:"property",title:S(I),subtitle:[I.city,I.state].filter(Boolean).join(", ")||void 0,href:`/dashboard/work/properties/${I.id}`}),E&&e.push({id:`job-${E.id}`,type:"job",title:E.title||`Job #${E.job_number||E.id.slice(0,8)}`,subtitle:E.status||void 0,href:`/dashboard/work/${E.id}`,badge:E.status?{label:A(E.status),variant:"outline"}:void 0}),B&&e.push({id:`estimate-${B.id}`,type:"estimate",title:B.title||`Estimate #${B.estimate_number||B.id.slice(0,8)}`,subtitle:B.status||void 0,href:`/dashboard/work/estimates/${B.id}`,badge:B.status?{label:A(B.status),variant:"secondary"}:void 0}),U&&e.push({id:`invoice-${U.id}`,type:"invoice",title:U.title||`Invoice #${U.invoice_number||U.id.slice(0,8)}`,subtitle:U.status||void 0,href:`/dashboard/work/invoices/${U.id}`,badge:U.status?{label:A(U.status),variant:"outline"}:void 0}),e},[F,P,B,U,E,I]),W=(0,h.useMemo)(()=>B||U?[{id:"estimate",label:"Estimate Created",status:B?"completed":"pending",date:B?.created_at||void 0,href:B?.id?`/dashboard/work/estimates/${B.id}`:void 0,description:B?.estimate_number?`#${B.estimate_number}`:void 0},{id:"contract",label:"Contract Generated",status:"completed",date:F.createdAt||void 0,href:`/dashboard/work/contracts/${F.id}`,description:"signed"===F.status?"Signed":"Pending signature"},{id:"invoice",label:"Invoice Created",status:U?"completed":"pending",date:U?.created_at||void 0,href:U?.id?`/dashboard/work/invoices/${U.id}`:void 0,description:U?.invoice_number?`#${U.invoice_number}`:void 0},{id:"payment",label:"Payment Received",status:U?.status==="paid"?"completed":U?"current":"pending",date:U?.paid_at||void 0,description:U?.paid_at?"Completed":U?`Balance: ${(0,k.formatCurrency)(U.balance_amount??0)}`:void 0}]:[],[F,B,U]),X=(0,h.useMemo)(()=>{let e=F.contractNumber||`CON-${F.id.slice(0,8).toUpperCase()}`;return{id:"contract-overview",title:"Contract Overview",icon:(0,t.jsx)(i.FileText,{className:"size-4"}),defaultOpen:!0,content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"grid gap-6 md:grid-cols-2",children:[(0,t.jsx)(_,{label:"Contract Number",value:`#${e}`}),(0,t.jsx)(_,{label:"Status",value:V}),(0,t.jsx)(_,{label:"Contract Type",value:F.contractType?F.contractType:"Not specified"}),(0,t.jsx)(_,{label:"Created",value:(0,k.formatDate)(F.createdAt,{preset:"datetime"})}),(0,t.jsx)(_,{label:"Valid From",value:(0,k.formatDate)(F.validFrom,{preset:"long"})}),(0,t.jsx)(_,{label:"Valid Until",value:(0,k.formatDate)(F.validUntil,{preset:"long"})}),(0,t.jsx)(_,{label:"Customer",value:P?(0,t.jsxs)(u.default,{className:"text-primary inline-flex items-center gap-2 text-sm font-medium hover:underline",href:`/dashboard/customers/${P.id}`,children:[(0,t.jsx)(m.User,{className:"size-4"}),C(P,F.customerName)]}):F.customerName}),I&&(0,t.jsx)(_,{label:"Property",value:(0,t.jsxs)(u.default,{className:"text-primary inline-flex items-center gap-2 text-sm font-medium hover:underline",href:`/dashboard/work/properties/${I.id}`,children:[(0,t.jsx)(n.MapPin,{className:"size-4"}),S(I)]})})]})})}},[F,P,I,V]),Y=(0,h.useMemo)(()=>({id:"contract-terms",title:"Contract Terms",icon:(0,t.jsx)(r.FileSignature,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"border-border/60 bg-muted/30 rounded-lg border p-5 text-sm leading-relaxed",children:F.content&&F.content.trim().length>0?(0,t.jsx)("p",{className:"whitespace-pre-wrap",children:F.content}):(0,t.jsx)("p",{className:"text-muted-foreground",children:"No contract terms provided."})})})}),[F.content]),Q=(0,h.useMemo)(()=>F.signerName||F.signedAt?{id:"signature",title:"Signature",icon:(0,t.jsx)(r.FileSignature,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"border-border/60 bg-muted/20 flex items-start gap-4 rounded-lg border p-4",children:[(0,t.jsx)("div",{className:"bg-background rounded-lg p-3 shadow-sm",children:(0,t.jsx)(r.FileSignature,{className:"text-muted-foreground size-6"})}),(0,t.jsxs)("div",{className:"flex-1 space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:F.signerName||"Signer name not provided"}),F.signerTitle&&(0,t.jsxs)("p",{className:"text-muted-foreground text-sm",children:[F.signerTitle,F.signerCompany?` at ${F.signerCompany}`:""]}),F.signerEmail&&(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:F.signerEmail}),(0,t.jsxs)("div",{className:"text-muted-foreground text-xs",children:[(0,t.jsxs)("p",{children:["Signed on"," ",(0,k.formatDate)(F.signedAt,{preset:"datetime"})]}),F.ipAddress&&(0,t.jsxs)("p",{children:["IP: ",F.ipAddress]})]})]})]})})}:null,[F.ipAddress,F.signerCompany,F.signerEmail,F.signerName,F.signerTitle,F.signedAt]),Z=(0,h.useMemo)(()=>{let e=[{id:"signed",label:"Signed",value:(0,k.formatDate)(F.signedAt,{preset:"datetime"}),icon:r.FileSignature,tone:"success"},{id:"viewed",label:"Viewed",value:(0,k.formatDate)(F.viewedAt,{preset:"datetime"}),icon:a.CalendarDays,tone:"accent"},{id:"sent",label:"Sent",value:(0,k.formatDate)(F.sentAt,{preset:"datetime"}),icon:o.Send,tone:"default"},{id:"created",label:"Created",value:(0,k.formatDate)(F.createdAt,{preset:"datetime"}),icon:s.Calendar,tone:"muted"}];return{id:"engagement-history",title:"Engagement History",icon:(0,t.jsx)(l.GitBranch,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsx)(M,{event:e},e.id))})})}},[F.createdAt,F.sentAt,F.signedAt,F.viewedAt]),ee=(0,h.useMemo)(()=>0===R.length?null:{id:"appointments",title:"Recent Appointments",icon:(0,t.jsx)(s.Calendar,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:R.map(e=>(0,t.jsxs)(u.default,{className:"border-border/60 hover:bg-muted/40 flex items-center justify-between gap-3 rounded-lg border p-3 transition-colors",href:`/dashboard/appointments/${e.id}`,children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:(0,k.formatDate)(e.scheduled_start,{preset:"long"})}),(0,t.jsxs)("p",{className:"text-muted-foreground text-xs",children:[(0,k.formatDate)(e.scheduled_start,{preset:"time"}),e.scheduled_end?` – ${(0,k.formatDate)(e.scheduled_end,{preset:"time"})}`:""]})]}),(0,t.jsx)(b.Badge,{variant:"outline",children:A(e.status||"scheduled")})]},e.id))})})},[R]),et=(0,h.useMemo)(()=>F.terms&&0!==F.terms.trim().length?{id:"additional-terms",title:"Additional Terms",icon:(0,t.jsx)(d.default,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)("p",{className:"text-sm leading-relaxed whitespace-pre-wrap",children:F.terms})})}:null,[F.terms]),es=(0,h.useMemo)(()=>F.notes&&0!==F.notes.trim().length?{id:"internal-notes",title:"Internal Notes",icon:(0,t.jsx)(d.default,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)("p",{className:"text-muted-foreground text-sm whitespace-pre-wrap",children:F.notes})})}:null,[F.notes]),ea=(0,h.useMemo)(()=>({id:"tags",title:"Tags",icon:(0,t.jsx)(c.Package,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)(v.EntityTags,{entityId:F.id,entityType:"contract",onUpdateTags:async(e,t)=>{let s=await (0,p.updateEntityTags)("contract",e,t);s.success?D.refresh():g.toast.error(s.error||"Failed to update tags")},tags:q})})}),[F.id,q,D]),er=(0,h.useMemo)(()=>[X,Y,Q,Z,ee,et,es,ea].filter(Boolean),[et,ee,Z,X,Q,Y,es,ea]),ei=W.length>0;return(0,t.jsx)(f.DetailPageContentLayout,{beforeContent:ei?(0,t.jsx)("div",{className:"w-full px-2 sm:px-0",children:(0,t.jsx)("div",{className:"mx-auto max-w-7xl",children:(0,t.jsx)(N.WorkflowTimeline,{stages:W})})}):void 0,customHeader:(0,t.jsx)(T,{config:K,quickInfo:H}),customSections:er,defaultOpenSection:"contract-overview",relatedItems:J,showStandardSections:{activities:!1,notes:!1,attachments:!1,relatedItems:J.length>0},storageKey:"contract-details"})}function T({config:e,quickInfo:s}){return(0,t.jsx)("div",{className:"w-full px-2 sm:px-0",children:(0,t.jsx)("div",{className:"border-border/60 bg-card mx-auto max-w-7xl rounded-xl border shadow-sm",children:(0,t.jsxs)("div",{className:"flex flex-col gap-6 p-6 md:p-8",children:[(0,t.jsx)($,{config:e}),(0,t.jsx)(D,{items:s})]})})})}function $({config:e}){return(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[e.title?(0,t.jsx)("h1",{className:"text-2xl leading-tight font-semibold md:text-3xl",children:e.title}):null,e.subtitle?(0,t.jsx)("p",{className:"text-muted-foreground text-sm md:text-base",children:e.subtitle}):null,e.description?(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:e.description}):null]}),e.badges&&e.badges.length>0?(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:e.badges}):null]})}function D({items:e}){return 0===e.length?null:(0,t.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:e.map(e=>{let s=e.icon;return(0,t.jsxs)("div",{className:"border-border/60 bg-muted/30 flex items-start gap-3 rounded-lg border p-3",children:[(0,t.jsx)("div",{className:"bg-background rounded-md p-2 shadow-sm",children:(0,t.jsx)(s,{className:"text-muted-foreground size-4"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:e.label}),(0,t.jsx)("span",{className:"text-sm font-medium",children:e.value})]})]},e.key)})})}function _({label:e,value:s}){return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:e}),(0,t.jsx)("div",{className:"text-sm font-medium",children:s})]})}function M({event:e}){if("—"===e.value)return null;let s=e.icon;return(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("span",{className:(0,w.cn)("flex size-10 shrink-0 items-center justify-center rounded-full",{default:"bg-primary/10 text-primary dark:bg-primary/20 dark:text-primary-foreground",accent:"bg-accent/10 text-accent-foreground dark:bg-accent/20 dark:text-accent-foreground",success:"bg-success/10 text-success dark:bg-success/20 dark:text-success",muted:"bg-muted text-muted-foreground"}[e.tone]),children:(0,t.jsx)(s,{className:"size-4"})}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.label}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:e.value})]})]})}e.s(["ContractPageContent",()=>z],476171)},134181,e=>{e.v(t=>Promise.all(["static/chunks/6680116ea3e49da7.js"].map(t=>e.l(t))).then(()=>t(388024)))}]);