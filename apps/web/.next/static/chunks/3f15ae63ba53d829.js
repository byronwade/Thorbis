(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672573,e=>{"use strict";let t=(0,e.i(383206).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["default",()=>t])},15751,e=>{"use strict";var t=e.i(672573);e.s(["MapPin",()=>t.default])},221999,e=>{"use strict";let t=(0,e.i(383206).default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);e.s(["default",()=>t])},560149,e=>{"use strict";var t=e.i(221999);e.s(["CalendarDays",()=>t.default])},52573,e=>{"use strict";let t=(0,e.i(383206).default)("link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);e.s(["default",()=>t])},694288,e=>{"use strict";var t=e.i(52573);e.s(["Link",()=>t.default])},519131,e=>{"use strict";let t=(0,e.i(383206).default)("paperclip",[["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 2.829 2.829l8.414-8.586a4 4 0 1 0-5.657-5.657l-8.379 8.551a6 6 0 1 0 8.485 8.485l8.379-8.551",key:"1miecu"}]]);e.s(["default",()=>t])},233654,e=>{"use strict";var t=e.i(519131);e.s(["Paperclip",()=>t.default])},711448,e=>{"use strict";e.i(116233),e.s([])},305549,585506,e=>{"use strict";var t=e.i(111043),s=e.i(868422),a=e.i(227009);e.i(670258);var l=e.i(921251);e.i(711448);var r=e.i(157222);function i({activities:e}){return e&&0!==e.length?(0,t.jsx)(r.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"max-h-96 space-y-3 overflow-y-auto",children:e.map(e=>(0,t.jsxs)("div",{className:"hover:bg-muted/50 flex gap-3 rounded-lg border p-3 transition-colors",children:[(0,t.jsxs)(l.Avatar,{className:"size-8 flex-shrink-0",children:[(0,t.jsx)(l.AvatarImage,{src:e.user?.avatar}),(0,t.jsx)(l.AvatarFallback,{children:e.user?.name?.charAt(0)||"?"})]}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm break-words",children:e.description}),(0,t.jsxs)("p",{className:"text-muted-foreground mt-1 text-xs",children:[e.user?.name," •"," ",(0,s.formatDistance)(new Date(e.created_at),new Date,{addSuffix:!0})]})]})]},e.id))})}):(0,t.jsx)(r.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(a.Activity,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No activity yet"})]})})})}e.s(["ActivityLogSection",()=>i],305549);var n=e.i(882896),d=e.i(606661),c=e.i(233654),m=e.i(371526),o=e.i(826463),x=e.i(970799);e.i(889265);var u=e.i(677607),h=e.i(51052);function p({attachments:e,entityType:s,entityId:a,onUpload:l}){let{toast:i}=(0,h.useToast)(),[p,f]=(0,x.useState)(!1),g=async e=>{let t=e.target.files;if(t&&0!==t.length){f(!0);try{l&&await l(t),i.success(`${t.length} file(s) uploaded successfully`)}catch(e){i.error("Failed to upload files")}finally{f(!1),e.target.value=""}}};return(0,t.jsx)(r.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[l&&(0,t.jsxs)("div",{children:[(0,t.jsx)("input",{className:"hidden",disabled:p,id:"file-upload",multiple:!0,onChange:g,type:"file"}),(0,t.jsx)("label",{htmlFor:"file-upload",children:(0,t.jsx)(u.Button,{asChild:!0,className:"w-full cursor-pointer",disabled:p,size:"sm",variant:"outline",children:(0,t.jsx)("span",{children:p?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(o.Upload,{className:"mr-2 size-4 animate-pulse"}),"Uploading..."]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(m.Plus,{className:"mr-2 size-4"}),"Upload Files"]})})})})]}),e&&e.length>0?(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsxs)("div",{className:"hover:bg-muted/50 flex items-center justify-between rounded-lg border p-3 transition-colors",children:[(0,t.jsxs)("div",{className:"flex min-w-0 flex-1 items-center gap-3",children:[(0,t.jsx)(d.FileText,{className:"text-muted-foreground size-4 flex-shrink-0"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium",children:e.original_file_name||e.file_name||"Untitled"}),(0,t.jsxs)("p",{className:"text-muted-foreground text-xs",children:[e.file_size?`${(e.file_size/1024).toFixed(1)} KB`:"",e.category&&` • ${e.category}`]})]})]}),(0,t.jsx)(u.Button,{asChild:!0,className:"flex-shrink-0",size:"sm",variant:"ghost",children:(0,t.jsx)("a",{download:!0,href:e.storage_url||e.url,rel:"noopener noreferrer",target:"_blank",children:(0,t.jsx)(n.Download,{className:"size-4"})})})]},e.id))}):(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(c.Paperclip,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No attachments yet"})]})})]})})}e.s(["AttachmentsSection",()=>p],585506)},821305,278633,e=>{"use strict";var t=e.i(111043),s=e.i(227009),a=e.i(606661),l=e.i(694288),r=e.i(233654),i=e.i(702948),n=e.i(152088);function d({header:e,customHeader:s,metadata:a,beforeContent:l,afterContent:r,children:i,className:d,contentGapClassName:c,statsBar:m}){let o=a??e?.metadata??[];return(0,t.jsxs)("div",{className:(0,n.cn)("flex w-full flex-col gap-4 pb-24 lg:gap-5",d),"data-detail-shell":"",children:[m,s??(e?(0,t.jsx)(x,{section:e}):null),o.length>0?(0,t.jsx)(u,{items:o}):null,l,i?(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col gap-4",c),children:i}):null,r]})}let c={none:"p-0",sm:"p-4",md:"p-6",lg:"p-8"},m={default:"border border-border/60 bg-card shadow-sm",muted:"border border-border/60 bg-muted/40 shadow-sm",subtle:"border border-border/40 bg-card/80 shadow-sm",ghost:"border border-border/50 bg-transparent shadow-none"};function o({children:e,className:s,padding:a="md",variant:l="default"}){return(0,t.jsx)("section",{className:(0,n.cn)("rounded-xl",m[l],s),children:(0,t.jsx)("div",{className:(0,n.cn)("flex flex-col gap-4",c[a]),children:e})})}function x({section:e}){var s;let{breadcrumbs:a,leadingVisual:l,title:r,subtitle:i,description:n,badges:d,actions:c,secondaryActions:m}=e;return(0,t.jsxs)("header",{className:"flex flex-col gap-4 lg:gap-6",children:[a?(0,t.jsx)("div",{className:"text-muted-foreground text-sm",children:a}):null,(0,t.jsxs)("div",{className:"flex flex-col gap-4 lg:flex-row lg:items-center lg:justify-between lg:gap-8",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsx)("div",{className:"flex flex-col gap-3",children:(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-3 sm:flex-row sm:items-center sm:gap-4",children:[l?(0,t.jsx)("div",{className:"flex items-center justify-center",children:l}):null,(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(s=r)?"string"==typeof s?(0,t.jsx)("h1",{className:"text-2xl font-semibold tracking-tight md:text-3xl",children:s}):(0,t.jsx)("div",{className:"text-2xl font-semibold tracking-tight md:text-3xl",children:s}):null,i?(0,t.jsx)("div",{className:"text-muted-foreground max-w-3xl text-sm md:text-base",children:i}):null]})]}),n?(0,t.jsx)("div",{className:"text-muted-foreground max-w-3xl text-sm",children:n}):null]})}),d&&d.length>0?(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:d}):null]}),h(c,m)?(0,t.jsxs)("div",{className:"hidden flex-wrap items-center gap-2 lg:flex",children:[c?.map((e,s)=>(0,t.jsx)("span",{className:"inline-flex",children:e},s)),m?.map((e,s)=>(0,t.jsx)("span",{className:"inline-flex",children:e},`secondary-${s}`))]}):null]}),h(c,m)?(0,t.jsxs)("div",{className:"flex flex-col gap-2 lg:hidden",children:[c&&c.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:c.map((e,s)=>(0,t.jsx)("span",{className:"flex-1",children:e},s))}):null,m&&m.length>0?(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:m.map((e,s)=>(0,t.jsx)("span",{className:"flex-1",children:e},`secondary-mobile-${s}`))}):null]}):null]})}function u({items:e}){return(0,t.jsx)("section",{className:"@xl-page:grid-cols-4 grid grid-cols-1 gap-4 md:grid-cols-2",children:e.map((e,s)=>(0,t.jsxs)("div",{className:"border-border/50 bg-card/60 flex flex-col gap-1 rounded-lg border px-4 py-3 shadow-sm",children:[(0,t.jsxs)("span",{className:"text-muted-foreground flex items-center gap-2 text-xs font-medium tracking-wide uppercase",children:[e.icon,e.label]}),(0,t.jsx)("div",{className:"text-foreground text-sm font-semibold",children:e.value}),e.helperText?(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:e.helperText}):null]},s))})}function h(e,t){return!!(e&&e.length>0||t&&t.length>0)}e.s(["DetailPageShell",()=>d,"DetailPageSurface",()=>o],278633);var p=e.i(305549),f=e.i(585506),g=e.i(868422),j=e.i(371526),v=e.i(970799);e.i(670258);var N=e.i(921251);e.i(889265);var b=e.i(677607);e.i(526120);var y=e.i(610120);e.i(711448);var w=e.i(157222),k=e.i(51052);function _({notes:e,entityType:s,entityId:l,onAddNote:r}){let{toast:i}=(0,k.useToast)(),[n,d]=(0,v.useState)(!1),[c,m]=(0,v.useState)(""),[o,x]=(0,v.useState)(!1),u=async()=>{if(r){if(!c.trim())return void i.error("Please enter a note");x(!0);try{await r(c),i.success("Note added successfully"),m(""),d(!1)}catch(e){i.error("Failed to add note")}finally{x(!1)}}};return(0,t.jsx)(w.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"space-y-4",children:[r&&(n?(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(y.Textarea,{autoFocus:!0,onChange:e=>m(e.target.value),placeholder:"Enter your note...",rows:3,value:c}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsx)(b.Button,{disabled:o,onClick:u,size:"sm",children:o?"Saving...":"Save Note"}),(0,t.jsx)(b.Button,{onClick:()=>{d(!1),m("")},size:"sm",variant:"outline",children:"Cancel"})]})]}):(0,t.jsxs)(b.Button,{className:"w-full",onClick:()=>d(!0),size:"sm",variant:"outline",children:[(0,t.jsx)(j.Plus,{className:"mr-2 size-4"}),"Add Note"]})),e&&e.length>0?(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsx)("div",{className:"hover:bg-muted/50 rounded-lg border p-3 transition-colors",children:(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsxs)(N.Avatar,{className:"size-8 flex-shrink-0",children:[(0,t.jsx)(N.AvatarImage,{src:e.user?.avatar}),(0,t.jsx)(N.AvatarFallback,{children:e.user?.name?.charAt(0)||"?"})]}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium",children:e.user?.name}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:(0,g.formatDistance)(new Date(e.created_at),new Date,{addSuffix:!0})})]}),(0,t.jsx)("p",{className:"mt-1 text-sm break-words whitespace-pre-wrap",children:e.content||e.note})]})]})},e.id))}):(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(a.FileText,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No notes yet"})]})})]})})}var C=e.i(87912),A=e.i(176378);e.i(553153);var S=e.i(363712);function z({relatedItems:e}){return e&&0!==e.length?(0,t.jsx)(w.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:e.map(e=>(0,t.jsxs)(A.default,{className:"group hover:bg-muted/50 flex items-center justify-between rounded-lg border p-3 transition-colors",href:e.href,children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium",children:e.title}),e.badge&&(0,t.jsx)(S.Badge,{className:"flex-shrink-0",variant:e.badge.variant||"default",children:e.badge.label})]}),e.subtitle&&(0,t.jsx)("p",{className:"text-muted-foreground truncate text-xs",children:e.subtitle})]}),(0,t.jsx)(C.ChevronRight,{className:"text-muted-foreground size-4 flex-shrink-0 transition-transform group-hover:translate-x-0.5"})]},e.id))})}):(0,t.jsx)(w.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"flex h-32 items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(l.Link,{className:"text-muted-foreground/50 mx-auto size-8"}),(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-sm",children:"No related items"})]})})})}let $=(0,i.default)(()=>e.A(134181).then(e=>e.UnifiedAccordion),{loadableGenerated:{modules:[388024]},ssr:!1});function D({header:e,customHeader:i,customSections:c,activities:m=[],notes:x=[],attachments:u=[],relatedItems:h=[],showStandardSections:g={activities:!0,notes:!0,attachments:!0,relatedItems:!0},className:j,defaultOpenSection:v,beforeContent:N,afterContent:b,statsBar:y,contentGapClassName:w,surfacePadding:k="none",surfaceVariant:C="default",surfaceClassName:A,storageKey:S,enableReordering:D=!0}){let T=[];!1!==g.activities&&T.push({id:"activity-log",title:"Activity Log",icon:(0,t.jsx)(s.Activity,{className:"size-4"}),count:m.length,content:(0,t.jsx)(p.ActivityLogSection,{activities:m})}),!1!==g.notes&&T.push({id:"notes",title:"Notes",icon:(0,t.jsx)(a.FileText,{className:"size-4"}),count:x.length,content:(0,t.jsx)(_,{notes:x})}),!1!==g.attachments&&T.push({id:"attachments",title:"Attachments",icon:(0,t.jsx)(r.Paperclip,{className:"size-4"}),count:u.length,content:(0,t.jsx)(f.AttachmentsSection,{attachments:u})}),!1!==g.relatedItems&&h.length>0&&T.push({id:"related-items",title:"Related Items",icon:(0,t.jsx)(l.Link,{className:"size-4"}),count:h.length,content:(0,t.jsx)(z,{relatedItems:h})});let M=[...c||[],...T];return(0,t.jsx)(d,{afterContent:b,beforeContent:N,className:(0,n.cn)("w-full",j),contentGapClassName:w??"gap-4",customHeader:i,header:e,statsBar:y,children:(0,t.jsx)(o,{className:(0,n.cn)("overflow-hidden",A),padding:k,variant:C,children:(0,t.jsx)($,{defaultOpenSection:v||M[0]?.id,enableReordering:D,sections:M,storageKey:S})})})}e.s(["DetailPageContentLayout",()=>D],821305)},431111,e=>{"use strict";var t=e.i(111043),s=e.i(904653),a=e.i(970799),l=e.i(146798);function r({stats:e,children:r}){let i=(0,s.usePathname)()||"/dashboard",n=(0,l.useToolbarStatsStore)(e=>e.setStats),d=(0,l.useToolbarStatsStore)(e=>e.clearStats);return(0,a.useLayoutEffect)(()=>(e?n(i,e):d(i),()=>{d(i)}),[i,e,n,d]),(0,t.jsx)(t.Fragment,{children:r})}e.s(["ToolbarStatsProvider",()=>r])},213075,e=>{"use strict";let t=(0,e.i(383206).default)("receipt",[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]]);e.s(["default",()=>t])},868106,e=>{"use strict";var t=e.i(213075);e.s(["Receipt",()=>t.default])},510651,e=>{"use strict";let t=(0,e.i(383206).default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["default",()=>t])},123891,e=>{"use strict";var t=e.i(510651);e.s(["ShieldCheck",()=>t.default])},468262,e=>{"use strict";var t=e.i(111043),s=e.i(560149),a=e.i(852648),l=e.i(982686),r=e.i(695877),i=e.i(15751),n=e.i(60179),d=e.i(868106),c=e.i(160424),m=e.i(123891),o=e.i(14435),x=e.i(501651),u=e.i(176378),h=e.i(970799),p=e.i(821305);e.i(553153);var f=e.i(363712);e.i(889265);var g=e.i(677607);e.i(711448);var j=e.i(157222),v=e.i(871509),N=e.i(152088);function b({label:e,value:s,helper:a}){return(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:e}),(0,t.jsx)("div",{className:"text-foreground text-sm font-medium",children:s}),a?(0,t.jsx)("div",{className:"text-muted-foreground text-xs",children:a}):null]})}function y(e){return e.slice(0,8)}function w(e){return e.replaceAll("_"," ")}function k({entityData:e}){let{agreement:k,customer:_,property:C,generatedInvoices:A=[],generatedJobs:S=[],equipment:z=[],notes:$=[],activities:D=[],attachments:T=[]}=e,M=k.plan_number||k.agreement_number||k.agreementNumber||("string"==typeof k.id?`AG-${y(k.id).toUpperCase()}`:"Service Agreement"),U=(0,h.useMemo)(()=>{var e;let s,a=[(0,t.jsx)(f.Badge,{variant:"outline",children:M},"number"),(e=k.status||"draft",s=({draft:{className:"bg-muted text-foreground dark:bg-foreground/20 dark:text-muted-foreground",label:"Draft"},active:{className:"bg-success text-white",label:"Active"},expired:{className:"bg-warning text-white",label:"Expired"},cancelled:{className:"bg-destructive text-white",label:"Cancelled"}})[e]||{className:"bg-muted text-foreground",label:e},(0,t.jsx)(f.Badge,{className:s.className,variant:"outline",children:s.label},"status"))];return k.billing_frequency&&a.push((0,t.jsx)(f.Badge,{className:"capitalize",variant:"outline",children:w(String(k.billing_frequency))},"billing")),k.auto_renew&&a.push((0,t.jsx)(f.Badge,{className:"border-success/40 bg-success/10 text-success",variant:"outline",children:"Auto-Renew"},"auto-renew")),a},[M,k.status,k.billing_frequency,k.auto_renew]),P=(0,h.useMemo)(()=>{let e;return[!k.start_date?null:{key:"start",icon:s.CalendarDays,label:"Starts",value:(0,v.formatDate)(k.start_date,{preset:"medium"})},function(e){let t=e.renewal_date||e.end_date;if(!t)return null;let s=new Date(t);if(Number.isNaN(s.getTime()))return null;let a=Math.ceil((s.getTime()-Date.now())/864e5),l="",r="default";return a<0?(l=`${Math.abs(a)} days overdue`,r="destructive"):0===a?(l="Renews today",r="warning"):(l=`${a} days remaining`,a<=30&&(r="warning")),{key:"renewal",icon:c.RefreshCw,label:"Renews",value:(0,v.formatDate)(s,{preset:"medium"}),helper:l,tone:r}}(k),(e=k.contract_value??k.price??k.value??0)<=0?null:{key:"contract-value",icon:l.DollarSign,label:"Contract Value",value:(0,v.formatCurrency)(e)},!k.billing_frequency?null:{key:"billing-frequency",icon:m.ShieldCheck,label:"Billing",value:w(String(k.billing_frequency))},function(e){if(0===e.length)return null;let t=e.reduce((e,t)=>e+(t.total_amount??0),0),s=e.reduce((e,t)=>e+(t.balance_amount??0),0);return{key:"invoices",icon:d.Receipt,label:1===e.length?"Invoice Generated":"Invoices Generated",value:`${e.length}`,helper:s>0?`${(0,v.formatCurrency)(t)} • ${(0,v.formatCurrency)(s)} due`:(0,v.formatCurrency)(t),tone:s>0?"warning":"success"}}(A),function(e){if(0===e.length)return null;let t=e.filter(e=>"completed"===e.status).length;return{key:"jobs",icon:x.Wrench,label:1===e.length?"Linked Job":"Linked Jobs",value:`${e.length}`,helper:t>0?`${t} completed`:"In progress"}}(S),0===z.length?null:{key:"equipment",icon:n.Package,label:1===z.length?"Covered Asset":"Covered Assets",value:`${z.length}`}].filter(Boolean)},[k,z,A,S]),B="border border-border/60 bg-background font-medium inline-flex items-center gap-2 rounded-full px-4 py-2 text-sm transition-colors hover:border-primary/50 hover:bg-primary/5",q=(0,t.jsx)("div",{className:"w-full px-2 sm:px-0",children:(0,t.jsx)("div",{className:"bg-muted/40 mx-auto max-w-7xl rounded-xl shadow-sm",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 p-4 sm:p-6",children:[(0,t.jsx)("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-start sm:justify-between",children:(0,t.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:U}),(0,t.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,t.jsx)("h1",{className:"text-2xl font-semibold sm:text-3xl",children:k.name||k.title||`Agreement ${M}`}),k.description?(0,t.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:k.description}):null]})]})}),(_||C)&&(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[_?(0,t.jsxs)(u.default,{className:B,href:`/dashboard/customers/${_.id}`,children:[(0,t.jsx)(o.User,{className:"size-4"}),_.display_name||`${_.first_name||""} ${_.last_name||""}`.trim()||"Unknown Customer"]}):null,C?(0,t.jsxs)(u.default,{className:B,href:`/dashboard/work/properties/${C.id}`,children:[(0,t.jsx)(i.MapPin,{className:"size-4"}),C.address||C.name||[C.city,C.state].filter(Boolean).join(", ")||"Property"]}):null]}),P.length>0?(0,t.jsx)("div",{className:"flex flex-wrap items-center gap-2",children:P.map(({key:e,icon:s,label:a,value:l,helper:r,tone:i})=>(0,t.jsxs)("div",{className:function(e="default"){return(0,N.cn)("inline-flex min-h-[3.25rem] items-center gap-3 rounded-full border border-border/60 bg-background px-4 py-2 transition-colors hover:border-primary/50 hover:bg-primary/5 dark:border-border/40","warning"===e&&"border-amber-200 bg-amber-50 text-amber-700 hover:border-amber-300 hover:bg-amber-100 dark:border-amber-900/30 dark:bg-amber-900/20 dark:text-amber-300","destructive"===e&&"border-destructive/40 bg-destructive/10 text-destructive hover:border-destructive/60 hover:bg-destructive/15 dark:text-destructive","success"===e&&"border-emerald-200 bg-emerald-50 text-emerald-700 hover:border-emerald-300 hover:bg-emerald-100 dark:border-emerald-900/30 dark:bg-emerald-900/20 dark:text-emerald-300")}(i),children:[(0,t.jsx)(s,{className:"text-muted-foreground size-4"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:a}),(0,t.jsx)("span",{className:"text-foreground text-sm font-medium",children:l}),r?(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:r}):null]})]},e))}):null]})})}),F=(0,h.useMemo)(()=>{var e;let t;return Array.isArray(t="string"==typeof(e=k.service_levels)?function(e){try{return JSON.parse(e)}catch{return null}}(e):e)?t.reduce((e,t,s)=>{if("string"==typeof t){let a=t.trim();return a&&e.push({id:`${a}-${s}`,label:a}),e}if(t&&"object"==typeof t){let a=t.name?.toString()??t.description?.toString()??`Service Level ${s+1}`;e.push({id:t.id?.toString()??`${a}-${s}`,label:a,responseTime:t.response_time?.toString()})}return e},[]):[]},[k.service_levels]),R=(0,h.useMemo)(()=>{let e,s;return[(s=(e=k.contract_value??0)>0,{id:"contract-terms",title:"Contract Terms",icon:(0,t.jsx)(r.FileSignature,{className:"size-4"}),defaultOpen:!0,content:(0,t.jsxs)(j.UnifiedAccordionContent,{children:[(0,t.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[(0,t.jsx)(b,{label:"Start Date",value:k.start_date?(0,v.formatDate)(k.start_date,{preset:"medium"}):"Not set"}),k.end_date?(0,t.jsx)(b,{label:"End Date",value:(0,v.formatDate)(k.end_date,{preset:"medium"})}):null,s?(0,t.jsx)(b,{label:"Contract Value",value:(0,v.formatCurrency)(e)}):null,k.payment_terms?(0,t.jsx)(b,{label:"Payment Terms",value:k.payment_terms}):null]}),k.terms?(0,t.jsxs)("div",{className:"mt-6 space-y-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:"Terms & Conditions"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm whitespace-pre-wrap",children:k.terms})]}):null]})}),0===F.length?null:{id:"service-levels",title:"Service Levels",icon:(0,t.jsx)(m.ShieldCheck,{className:"size-4"}),count:F.length,content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsx)("div",{className:"space-y-2",children:F.map(e=>(0,t.jsxs)("div",{className:"border-border/60 bg-background flex items-center gap-3 rounded-lg border px-4 py-3",children:[(0,t.jsx)(a.CheckCircle2,{className:"text-success size-4"}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-foreground text-sm font-medium",children:e.label}),e.responseTime?(0,t.jsxs)("span",{className:"text-muted-foreground text-xs",children:["Response: ",e.responseTime]}):null]})]},e.id))})})},!(k.renewal_type||k.renewal_date||k.renewal_notice_days)?null:{id:"renewal",title:"Renewal",icon:(0,t.jsx)(c.RefreshCw,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"grid gap-6 sm:grid-cols-2",children:[k.renewal_type?(0,t.jsx)(b,{label:"Renewal Type",value:String(k.renewal_type).replaceAll("_"," ")}):null,k.renewal_date?(0,t.jsx)(b,{label:"Renewal Date",value:(0,v.formatDate)(k.renewal_date,{preset:"medium"})}):null,k.renewal_notice_days?(0,t.jsx)(b,{label:"Notice Window",value:`${k.renewal_notice_days} days`}):null]})})},!_?null:{id:"customer-details",title:"Customer Details",icon:(0,t.jsx)(o.User,{className:"size-4"}),content:(0,t.jsx)(j.UnifiedAccordionContent,{children:(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-start md:justify-between",children:[(0,t.jsxs)("div",{className:"grid flex-1 gap-6 sm:grid-cols-2",children:[(0,t.jsx)(b,{label:"Name",value:_.display_name||`${_.first_name||""} ${_.last_name||""}`.trim()||"Unknown"}),(0,t.jsx)(b,{label:"Email",value:_.email||"N/A"})]}),(0,t.jsx)(g.Button,{asChild:!0,size:"sm",variant:"ghost",children:(0,t.jsx)(u.default,{href:`/dashboard/customers/${_.id}`,children:"View Full Profile"})})]})})},0===A.length?null:{id:"generated-invoices",title:"Generated Invoices",icon:(0,t.jsx)(d.Receipt,{className:"size-4"}),count:A.length,content:(0,t.jsxs)(j.UnifiedAccordionContent,{className:"p-0",children:[(0,t.jsx)("div",{className:"text-muted-foreground border-b px-6 py-4 text-sm",children:"Invoices created from this service agreement."}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-muted/50 border-b",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Invoice #"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Title"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Date"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Total"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Balance"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:A.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-muted/30 border-b",children:[(0,t.jsxs)("td",{className:"px-6 py-4 text-sm",children:["#",e.invoice_number||y(e.id)]}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:e.title||"—"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,v.formatDate)(e.created_at,{preset:"medium"})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium",children:(0,v.formatCurrency)(e.total_amount)}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium",children:(0,v.formatCurrency)(e.balance_amount)}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,t.jsx)(f.Badge,{variant:"paid"===e.status?"default":"outline",children:e.status||"pending"})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,t.jsx)(u.default,{className:"text-primary hover:underline",href:`/dashboard/work/invoices/${e.id}`,children:"View"})})]},e.id))})]})})]})},0===S.length?null:{id:"generated-jobs",title:"Generated Jobs",icon:(0,t.jsx)(x.Wrench,{className:"size-4"}),count:S.length,content:(0,t.jsxs)(j.UnifiedAccordionContent,{className:"p-0",children:[(0,t.jsx)("div",{className:"text-muted-foreground border-b px-6 py-4 text-sm",children:"Jobs created from this service agreement."}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-muted/50 border-b",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Job #"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Title"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Date"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Status"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Completed"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:S.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-muted/30 border-b",children:[(0,t.jsxs)("td",{className:"px-6 py-4 text-sm",children:["#",e.job_number||y(e.id)]}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium",children:e.title||"—"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,v.formatDate)(e.created_at,{preset:"medium"})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,t.jsx)(f.Badge,{variant:"outline",children:e.status||"scheduled"})}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:e.completed_at?(0,v.formatDate)(e.completed_at,{preset:"medium"}):"—"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,t.jsx)(u.default,{className:"text-primary hover:underline",href:`/dashboard/work/${e.id}`,children:"View"})})]},e.id))})]})})]})},0===z.length?null:{id:"equipment-covered",title:"Equipment Covered",icon:(0,t.jsx)(n.Package,{className:"size-4"}),count:z.length,content:(0,t.jsxs)(j.UnifiedAccordionContent,{className:"p-0",children:[(0,t.jsx)("div",{className:"text-muted-foreground border-b px-6 py-4 text-sm",children:"Equipment included in this service agreement."}),(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-muted/50 border-b",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Equipment #"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Name"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Type"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Manufacturer"}),(0,t.jsx)("th",{className:"px-6 py-3 text-left text-sm font-medium",children:"Actions"})]})}),(0,t.jsx)("tbody",{children:z.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-muted/30 border-b",children:[(0,t.jsxs)("td",{className:"px-6 py-4 text-sm",children:["#",e.equipment_number||y(e.id)]}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm font-medium",children:e.name||"—"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:e.type||"—"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:e.manufacturer||"—"}),(0,t.jsx)("td",{className:"px-6 py-4 text-sm",children:(0,t.jsx)(u.default,{className:"text-primary hover:underline",href:`/dashboard/work/equipment/${e.id}`,children:"View"})})]},e.id))})]})})]})}].filter(Boolean)},[k,_,z,A,S,F]),I=(0,h.useMemo)(()=>{let e=[];return _&&e.push({id:`customer-${_.id}`,type:"customer",title:_.display_name||`${_.first_name||""} ${_.last_name||""}`.trim()||"Unknown Customer",subtitle:_.email||_.phone||void 0,href:`/dashboard/customers/${_.id}`}),C&&e.push({id:`property-${C.id}`,type:"property",title:C.address||C.name||"Property",subtitle:`${C.city||""}, ${C.state||""}`.trim()||void 0,href:`/dashboard/work/properties/${C.id}`}),e},[_,C]);return(0,t.jsx)(t.Fragment,{children:(0,t.jsx)(p.DetailPageContentLayout,{activities:D,attachments:T,customHeader:q,customSections:R,defaultOpenSection:"contract-terms",notes:$,relatedItems:I,showStandardSections:{activities:!0,notes:!0,attachments:!0,relatedItems:!0}})})}e.s(["ServiceAgreementPageContent",()=>k])},134181,e=>{e.v(t=>Promise.all(["static/chunks/6680116ea3e49da7.js"].map(t=>e.l(t))).then(()=>t(388024)))}]);