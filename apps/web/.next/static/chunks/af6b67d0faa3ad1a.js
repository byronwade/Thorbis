(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,686787,e=>{"use strict";e.i(116233),e.s([])},486882,e=>{"use strict";let s=(0,e.i(383206).default)("arrow-right",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);e.s(["default",()=>s])},486506,e=>{"use strict";var s=e.i(486882);e.s(["ArrowRight",()=>s.default])},769588,e=>{"use strict";e.i(116233),e.s([])},331474,e=>{"use strict";let s=(0,e.i(383206).default)("test-tube-diagonal",[["path",{d:"M21 7 6.82 21.18a2.83 2.83 0 0 1-3.99-.01a2.83 2.83 0 0 1 0-4L17 3",key:"1ub6xw"}],["path",{d:"m16 2 6 6",key:"1gw87d"}],["path",{d:"M12 16H4",key:"1cjfip"}]]);e.s(["default",()=>s])},322979,e=>{"use strict";var s=e.i(313550),t=e.i(111043),i=e.i(970799),a=e.i(852648),c=e.i(559586),l=e.i(710575),r=e.i(331474),r=r,n=e.i(486506),o=e.i(910685),d=e.i(969098),m=e.i(641304),h=e.i(121085),x=e.i(202724),u=e.i(782193);e.i(889265);var p=e.i(677607);e.i(254851);var j=e.i(605278);e.i(51478);var g=e.i(635613);e.i(149989);var f=e.i(880177);e.i(553153);var y=e.i(363712);e.i(287133);var N=e.i(120109);e.i(686787);var C=e.i(519539);e.i(769588);var b=e.i(1414),w=e.i(152088),v=e.i(995403);let k=[{number:1,title:"Connect Google Workspace",description:"Authorize access to your Gmail account",icon:c.Mail},{number:2,title:"Select Email Addresses",description:"Choose which workspace emails to sync",icon:u.Inbox},{number:3,title:"Assign Permissions",description:"Set up team access to email categories",icon:l.Shield},{number:4,title:"Test Connection",description:"Verify everything is working",icon:r.default}],A=[{id:"support",name:"Support",description:"Customer support and help requests",placeholder:"support@yourcompany.com"},{id:"sales",name:"Sales",description:"Sales inquiries and leads",placeholder:"sales@yourcompany.com"},{id:"billing",name:"Billing",description:"Invoices and payment-related emails",placeholder:"billing@yourcompany.com"},{id:"general",name:"General",description:"General company emails",placeholder:"info@yourcompany.com"}];function S({companyId:e,onComplete:S}){let[T,G]=(0,i.useState)(1),[B,O]=(0,i.useState)(!1),[E,L]=(0,i.useState)(!1),[W,_]=(0,i.useState)(""),[z,I]=(0,i.useState)({}),D=async()=>{O(!0);try{let t=s.default.env.NEXT_PUBLIC_GOOGLE_CLIENT_ID,i=`${window.location.origin}/api/auth/gmail/callback`,a=`https://accounts.google.com/o/oauth2/v2/auth?client_id=${t}&redirect_uri=${i}&response_type=code&scope=https://www.googleapis.com/auth/gmail.readonly https://www.googleapis.com/auth/gmail.send&access_type=offline&prompt=consent&state=${e}`;window.location.href=a}catch(e){console.error("OAuth connection failed:",e),v.toast.error("Failed to connect to Google Workspace"),O(!1)}},M=async()=>{O(!0);try{let s=await fetch("/api/gmail/test-connection",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({companyId:e})}),t=await s.json();t.success?(v.toast.success("Connection test successful!"),S&&S()):v.toast.error(t.error||"Connection test failed")}catch(e){console.error("Connection test failed:",e),v.toast.error("Failed to test connection")}finally{O(!1)}};return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:k.map((e,s)=>{let i=e.icon,c=T===e.number,l=T>e.number;return(0,t.jsxs)("div",{className:"flex items-center flex-1",children:[(0,t.jsxs)("div",{className:"flex flex-col items-center gap-2 flex-1",children:[(0,t.jsx)("div",{className:(0,w.cn)("h-10 w-10 rounded-full flex items-center justify-center transition-all",c&&"bg-primary text-primary-foreground",l&&"bg-green-500 text-white",!c&&!l&&"bg-muted text-muted-foreground"),children:l?(0,t.jsx)(a.CheckCircle2,{className:"h-5 w-5"}):(0,t.jsx)(i,{className:"h-5 w-5"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:(0,w.cn)("text-sm font-medium",c&&"text-primary",l&&"text-green-600",!c&&!l&&"text-muted-foreground"),children:e.title}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground hidden sm:block",children:e.description})]})]}),s<k.length-1&&(0,t.jsx)(N.Separator,{className:(0,w.cn)("flex-1 max-w-24",l&&"bg-green-500",!l&&"bg-muted")})]},e.number)})}),(0,t.jsxs)(j.Card,{children:[(0,t.jsxs)(j.CardHeader,{children:[(0,t.jsxs)(j.CardTitle,{className:"flex items-center gap-2",children:[React.createElement(k[T-1].icon,{className:"h-5 w-5"}),k[T-1].title]}),(0,t.jsx)(j.CardDescription,{children:k[T-1].description})]}),(0,t.jsxs)(j.CardContent,{className:"min-h-[400px]",children:[1===T&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(C.Alert,{children:[(0,t.jsx)(h.Settings,{className:"h-4 w-4"}),(0,t.jsx)(C.AlertTitle,{children:"Before you begin"}),(0,t.jsx)(C.AlertDescription,{children:(0,t.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-sm mt-2",children:[(0,t.jsx)("li",{children:"You need admin access to your Google Workspace account"}),(0,t.jsx)("li",{children:"Make sure you're signed into the correct Google account"}),(0,t.jsx)("li",{children:"We'll request read and send permissions for Gmail"}),(0,t.jsx)("li",{children:"You can revoke access at any time"})]})})]}),E?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 space-y-4",children:[(0,t.jsx)("div",{className:"h-16 w-16 rounded-full bg-green-500/10 flex items-center justify-center",children:(0,t.jsx)(a.CheckCircle2,{className:"h-8 w-8 text-green-600"})}),(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("p",{className:"font-semibold text-lg",children:"Connected Successfully!"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:W})]}),(0,t.jsxs)(y.Badge,{variant:"secondary",className:"gap-1",children:[(0,t.jsx)(a.CheckCircle2,{className:"h-3 w-3"}),"Google Workspace Connected"]})]}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center p-8 space-y-6",children:[(0,t.jsxs)("div",{className:"text-center max-w-md",children:[(0,t.jsx)("h3",{className:"font-semibold text-lg mb-2",children:"Connect Your Google Workspace"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Click the button below to authorize Stratos to access your Gmail account. You'll be redirected to Google's secure login page."})]}),(0,t.jsxs)(p.Button,{size:"lg",onClick:D,disabled:B,children:[B&&(0,t.jsx)(m.Loader2,{className:"h-5 w-5 mr-2 animate-spin"}),(0,t.jsx)(c.Mail,{className:"h-5 w-5 mr-2"}),"Connect Google Workspace"]}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[(0,t.jsx)(l.Shield,{className:"h-4 w-4"}),"Secured by Google OAuth 2.0"]})]})]}),2===T&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(C.Alert,{children:[(0,t.jsx)(u.Inbox,{className:"h-4 w-4"}),(0,t.jsx)(C.AlertTitle,{children:"Configure Email Categories"}),(0,t.jsx)(C.AlertDescription,{children:"Enter the Gmail addresses for each category. These will be synced to your company inbox and accessible to assigned team members."})]}),(0,t.jsx)("div",{className:"space-y-4",children:A.map(e=>(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(b.Checkbox,{id:e.id,checked:!!z[e.id],onCheckedChange:s=>{if(s)I({...z,[e.id]:""});else{let s={...z};delete s[e.id],I(s)}}}),(0,t.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,t.jsxs)(f.Label,{htmlFor:e.id,className:"cursor-pointer",children:[(0,t.jsx)("span",{className:"font-semibold",children:e.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground font-normal",children:e.description})]}),void 0!==z[e.id]&&(0,t.jsx)(g.Input,{placeholder:e.placeholder,value:z[e.id]||"",onChange:s=>I({...z,[e.id]:s.target.value}),className:"mt-2"})]})]}),e.id!==A[A.length-1].id&&(0,t.jsx)(N.Separator,{className:"mt-4"})]},e.id))})]}),3===T&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(C.Alert,{children:[(0,t.jsx)(x.Users,{className:"h-4 w-4"}),(0,t.jsx)(C.AlertTitle,{children:"Team Access (Optional)"}),(0,t.jsx)(C.AlertDescription,{children:"Configure which team members can access each email category. You can skip this step and configure permissions later in team settings."})]}),(0,t.jsxs)("div",{className:"text-center p-8",children:[(0,t.jsx)(x.Users,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Team permission management will be available after setup is complete."}),(0,t.jsx)(p.Button,{variant:"outline",size:"sm",asChild:!0,children:(0,t.jsxs)("a",{href:"/dashboard/settings/team/email-permissions",children:[(0,t.jsx)(d.ExternalLink,{className:"h-4 w-4 mr-2"}),"Learn About Email Permissions"]})})]})]}),4===T&&(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(C.Alert,{children:[(0,t.jsx)(r.default,{className:"h-4 w-4"}),(0,t.jsx)(C.AlertTitle,{children:"Test Your Gmail Connection"}),(0,t.jsx)(C.AlertDescription,{children:"We'll verify that we can successfully connect to your Gmail account and sync emails."})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,t.jsxs)(j.Card,{children:[(0,t.jsx)(j.CardHeader,{children:(0,t.jsx)(j.CardTitle,{className:"text-sm",children:"Connected Account"})}),(0,t.jsx)(j.CardContent,{children:(0,t.jsx)("p",{className:"font-mono text-sm",children:W||"Not connected"})})]}),(0,t.jsxs)(j.Card,{children:[(0,t.jsx)(j.CardHeader,{children:(0,t.jsx)(j.CardTitle,{className:"text-sm",children:"Email Categories"})}),(0,t.jsx)(j.CardContent,{children:(0,t.jsxs)("p",{className:"text-sm",children:[Object.keys(z).length," categories configured"]})})]})]}),(0,t.jsx)("div",{className:"flex flex-col items-center justify-center p-8",children:(0,t.jsxs)(p.Button,{size:"lg",onClick:M,disabled:B,children:[B&&(0,t.jsx)(m.Loader2,{className:"h-5 w-5 mr-2 animate-spin"}),(0,t.jsx)(r.default,{className:"h-5 w-5 mr-2"}),"Test Connection Now"]})})]})]})]}),(0,t.jsxs)(j.CardFooter,{className:"flex justify-between",children:[(0,t.jsxs)(p.Button,{variant:"outline",onClick:()=>{T>1&&G(T-1)},disabled:1===T||B,children:[(0,t.jsx)(o.ArrowLeft,{className:"h-4 w-4 mr-2"}),"Back"]}),T<4?(0,t.jsxs)(p.Button,{onClick:()=>{T<4&&G(T+1)},disabled:!(()=>{switch(T){case 1:return E&&W.length>0;case 2:return Object.values(z).some(e=>e&&e.length>0);case 3:case 4:return!0;default:return!1}})()||B,children:["Next",(0,t.jsx)(n.ArrowRight,{className:"h-4 w-4 ml-2"})]}):(0,t.jsxs)(p.Button,{onClick:()=>S?.(),disabled:B,children:[(0,t.jsx)(a.CheckCircle2,{className:"h-4 w-4 mr-2"}),"Complete Setup"]})]})]})]})}e.s(["GmailSetupWizard",()=>S],322979)}]);