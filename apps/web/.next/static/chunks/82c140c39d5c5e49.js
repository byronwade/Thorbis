(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672573,e=>{"use strict";let t=(0,e.i(383206).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["default",()=>t])},15751,e=>{"use strict";var t=e.i(672573);e.s(["MapPin",()=>t.default])},686787,e=>{"use strict";e.i(116233),e.s([])},923225,e=>{"use strict";let t=(0,e.i(383206).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t])},630754,e=>{"use strict";var t=e.i(923225);e.s(["CheckCircle",()=>t.default])},789067,e=>{"use strict";e.i(116233),e.s([])},969249,e=>{"use strict";let t=(0,e.i(383206).default)("navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);e.s(["default",()=>t])},332845,e=>{"use strict";var t=e.i(969249);e.s(["Navigation",()=>t.default])},920312,e=>{"use strict";let t=(0,e.i(383206).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["default",()=>t])},148347,e=>{"use strict";var t=e.i(920312);e.s(["Filter",()=>t.default])},926624,e=>{"use strict";let t=(0,e.i(383206).default)("list",[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]]);e.s(["default",()=>t])},623380,e=>{"use strict";var t=e.i(926624);e.s(["List",()=>t.default])},66763,e=>{"use strict";let t=(0,e.i(383206).default)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);e.s(["default",()=>t])},604501,e=>{"use strict";var t=e.i(66763);e.s(["Truck",()=>t.default])},119470,e=>{"use strict";var t=e.i(598279);function a(e,a,s){return(0,t.addDays)(e,-a,s)}e.s(["subDays",()=>a])},643023,e=>{"use strict";function t(e){return{companyId:e.companyId,range:{start:new Date(e.range.start),end:new Date(e.range.end)},lastSync:new Date(e.lastSync),jobs:e.jobs.map(a),technicians:e.technicians.map(s),unassignedMeta:e.unassignedMeta}}function a(e){var t;return{...e,startTime:new Date(e.startTime),endTime:new Date(e.endTime),createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),customer:{...e.customer,createdAt:new Date(e.customer.createdAt),updatedAt:new Date(e.customer.updatedAt)},recurrence:e.recurrence?{...t=e.recurrence,endDate:t.endDate?new Date(t.endDate):void 0}:void 0}}function s(e){var t;return{...e,createdAt:new Date(e.createdAt),updatedAt:new Date(e.updatedAt),schedule:{...t=e.schedule,daysOff:t.daysOff.map(e=>new Date(e))}}}e.s(["deserializeJob",()=>a,"deserializeScheduleBootstrap",()=>t])},83690,e=>{"use strict";e.i(598279),e.i(119470);let t={maxRetries:3,initialDelay:500,maxDelay:5e3,backoffFactor:2,shouldRetry:e=>{if(e instanceof Error){let t=e.message.toLowerCase();return t.includes("network")||t.includes("timeout")||t.includes("connection")||t.includes("fetch failed")||t.includes("econnreset")||t.includes("500")||t.includes("502")||t.includes("503")||t.includes("504")}return!1}};async function a(e,s,n={}){let i,r={...t,...n},d=r.initialDelay;for(let t=0;t<=r.maxRetries;t++)try{return await e()}catch(e){if(i=e,t===r.maxRetries||!r.shouldRetry(e))throw console.error(`[Schedule] ${s} failed after ${t+1} attempt(s):`,e instanceof Error?e.message:String(e)),e;console.warn(`[Schedule] ${s} attempt ${t+1} failed, retrying in ${d}ms...`,e instanceof Error?e.message:String(e)),await new Promise(e=>setTimeout(e,d)),d=Math.min(d*r.backoffFactor,r.maxDelay)}throw i}let s=`
  *,
  customer:customers(
    id,
    first_name,
    last_name,
    email,
    phone
  ),
  job:jobs(
    id,
    job_number,
    title,
    job_type,
    company_id,
    job_team_assignments:job_team_assignments!job_team_assignments_job_id_fkey(
      id,
      role,
      team_member_id,
      removed_at,
      team_member:team_members(
        id,
        company_id,
        status,
        job_title,
        department,
        archived_at,
        user_id,
        phone,
        email,
        invited_name,
        created_at,
        updated_at
      )
    )
  )
`,n=`
  *,
  customer:customers!customer_id(
    id,
    first_name,
    last_name,
    email,
    phone,
    created_at,
    updated_at
  ),
  property:properties!property_id(
    id,
    name,
    address,
    address2,
    city,
    state,
    zip_code,
    country,
    lat,
    lon
  ),
  job_team_assignments:job_team_assignments!job_team_assignments_job_id_fkey(
    id,
    role,
    team_member_id,
    removed_at,
    team_member:team_members(
      id,
      company_id,
      status,
      job_title,
      department,
      archived_at,
      user_id,
      phone,
      email,
      invited_name,
      created_at,
      updated_at
    )
  )
`,i={workingHours:{start:"08:00",end:"17:00"},daysOff:[],availableHours:{start:0,end:40}},r={address:{street:"",city:"",state:"",zip:"",country:""},coordinates:{lat:0,lng:0}};async function d({supabase:e,companyId:t,range:n,unscheduledLimit:d=50,unscheduledOffset:o=0,unscheduledSearch:f=""}){var y;let g,b,_,v,w,j,M,I,A=e.from("appointments").select(s).eq("company_id",t).is("deleted_at",null).is("archived_at",null).order("start_time",{ascending:!0});n&&(A.lte("start_time",n.end.toISOString()),A.gte("end_time",n.start.toISOString()));try{[w,j,M]=await a(()=>Promise.all([A,c(e,t),l(e,t,{limit:d,offset:o,search:f})]),"fetchScheduleData parallel queries")}catch(e){throw console.error("[Schedule] Failed to fetch schedule data:",e),Error(`Schedule data query failed: ${e instanceof Error?e.message:String(e)}`)}let T=w.data??[],D=w.error;if(D)throw console.error("Appointments query error:",D),Error(`Appointments query failed: ${D.message}`);let k=new Set(T.map(e=>e.job_id).filter(e=>!!e)),S=M.rows.filter(e=>!k.has(e.id)),J={totalCount:M.totalCount,hasMore:M.hasMore,fetchedCount:M.rows.length};try{I=await a(()=>{var t,a;let s;return u(e,(t=T,a=S,s=new Set,t.forEach(e=>{e.property_id&&s.add(e.property_id)}),a.forEach(e=>{e.property_id&&s.add(e.property_id)}),Array.from(s)))},"fetchPropertiesByIds")}catch(e){console.error("[Schedule] Failed to fetch properties:",e),I=new Map}let U=(y=j,g=[],b=new Map,_=new Map,v=new Map,y.forEach(e=>{let t=e.user_id??e.id;if(!t)return;let a=e.users,s={id:t,userId:e.user_id??void 0,teamMemberId:e.id,name:a?.name||e.invited_name||e.job_title||"Team Member",email:a?.email||e.email||void 0,phone:a?.phone||e.phone||void 0,avatar:a?.avatar||void 0,role:e.job_title||e.role||"Team Member",department:e.department||void 0,status:"active"===e.status?"available":"offline",isActive:"active"===e.status&&!e.archived_at,schedule:{...i},color:"#3B82F6",createdAt:new Date(e.created_at),updatedAt:new Date(e.updated_at)};g.push(s),b.set(s.id,s),s.userId&&_.set(s.userId,s),s.teamMemberId&&v.set(s.teamMemberId,s)}),{technicians:g,byId:b,byUserId:_,byTeamMemberId:v});return{jobs:[...T.map(e=>{var t,a,s,n;let i,d,c,o,l,u,f;return t=e,a=U,c=h(I.get(e.property_id??"")??null),o=(s=t,n=c.address.street,d=(i=s.customer)&&`${i.first_name??""} ${i.last_name??""}`.trim(),{id:i?.id||s.customer_id||`customer-${s.id}`,name:d&&d.length>0?d:"Unspecified Customer",email:i?.email||void 0,phone:i?.phone||void 0,location:{...r,address:{...r.address,street:n}},createdAt:new Date(s.created_at),updatedAt:new Date(s.updated_at)}),u=(l=function(e,t){let a=[];if(e.assigned_to){let s=t.byUserId.get(e.assigned_to)||t.byId.get(e.assigned_to);a.push({technicianId:s?.id??e.assigned_to,teamMemberId:s?.teamMemberId,displayName:s?.name||"Primary Technician",avatar:s?.avatar||null,role:"primary",status:s?.status??"available",isActive:s?.isActive??!0})}return(e.job?.job_team_assignments?.filter(e=>!e.removed_at)??[]).forEach(e=>{let s=e.team_member;if(!s)return;let n=s.user_id&&t.byUserId.get(s.user_id)||t.byTeamMemberId.get(s.id),i=n?.name||s.invited_name||s.job_title||"Crew Member";a.push({technicianId:n?.id??s.user_id??s.id,teamMemberId:s.id,displayName:i,avatar:n?.avatar||null,role:e.role||"crew",status:n?.status??p(s.status),isActive:n?.isActive??"active"===s.status})}),m(a)}(t,a)).find(e=>"primary"===e.role),f=u?.technicianId??"",{id:t.id,jobId:t.job_id||void 0,technicianId:f,assignments:l,isUnassigned:0===l.length,title:t.title||t.job?.title||"Appointment",description:t.description||void 0,jobType:t.job?.job_type||void 0,appointmentType:t.type||void 0,appointmentCategory:function(e,t){if(t)return"event";switch(e?.toLowerCase()){case"meeting":case"appointment":case"follow_up":case"consultation":case"call":return"meeting";case"event":case"training":case"conference":case"holiday":return"event";default:return"job"}}(t.type,t.all_day??!1),customer:o,location:c,startTime:new Date(t.start_time),endTime:new Date(t.end_time),allDay:t.all_day,status:t.status&&["scheduled","dispatched","arrived","in-progress","closed","completed","cancelled"].includes(t.status)?t.status:"scheduled",priority:"medium",recurrence:t.is_recurring?{frequency:"weekly",interval:1,endDate:t.recurrence_end_date?new Date(t.recurrence_end_date):void 0}:void 0,metadata:{estimatedDuration:t.duration,notes:t.notes||void 0},createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}}),...S.map(e=>{var t,a,s,n,i,d;let c,o,l,u,f,y,g,b;return t=e,a=U,l=h(I.get(e.property_id??"")??null),u=(s=t,n=l.address.street,c=Array.isArray(i=s.customer)?i[0]??null:i??null,o=[c?.first_name?.trim()??"",c?.last_name?.trim()??""].filter(Boolean).join(" ").trim(),{id:c?.id||s.customer_id||`customer-${s.id}`,name:o||s.title||"Unspecified Customer",email:c?.email||void 0,phone:c?.phone||void 0,location:{...r,address:{...r.address,street:n}},createdAt:new Date(c?.created_at??s.created_at),updatedAt:new Date(c?.updated_at??s.updated_at)}),f=function(e,t){let a=[];if(e.assigned_to){let s=t.byUserId.get(e.assigned_to)||t.byId.get(e.assigned_to);a.push({technicianId:null,teamMemberId:s?.teamMemberId,displayName:s?.name||"Primary Technician",avatar:s?.avatar??null,role:"primary",status:s?.status??"available",isActive:s?.isActive??!0})}return(Array.isArray(e.job_team_assignments)?e.job_team_assignments:e.job_team_assignments?[e.job_team_assignments]:[]).filter(e=>!e.removed_at).forEach(e=>{let s=e.team_member;if(!s)return;let n=s.user_id&&t.byUserId.get(s.user_id)||t.byTeamMemberId.get(s.id);a.push({technicianId:null,teamMemberId:s.id,displayName:n?.name||s.invited_name||s.job_title||"Crew Member",avatar:n?.avatar??null,role:e.role||"crew",status:n?.status??p(s.status),isActive:n?.isActive??"active"===s.status})}),m(a)}(t,a),y=new Date(t.scheduled_start?t.scheduled_start:t.created_at),g=new Date(t.scheduled_end?t.scheduled_end:y.getTime()+36e5),{id:t.id,jobId:t.id,technicianId:"",assignments:f,isUnassigned:!0,title:t.title||t.job_number||"Job",description:t.description||void 0,jobType:t.job_type||void 0,customer:u,location:l,startTime:y,endTime:g,status:function(e){if(!e)return"scheduled";let t=e.toLowerCase();switch(t){case"scheduled":case"dispatched":case"arrived":case"closed":case"cancelled":return t;case"in-progress":case"in_progress":case"inprogress":return"in-progress";case"completed":case"complete":case"done":return"completed";default:return"scheduled"}}(t.status),priority:function(e){if(!e)return"medium";let t=e.toLowerCase();switch(t){case"low":case"medium":case"high":case"urgent":return t;case"critical":case"emergency":return"urgent";default:return"medium"}}(t.priority),metadata:(b={...(d=t).metadata&&"object"==typeof d.metadata?d.metadata:{}},d.notes&&(b.notes=d.notes),b),createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at)}})],technicians:U.technicians,unassignedMeta:{limit:d,nextOffset:o+J.fetchedCount,hasMore:J.hasMore,search:f,totalCount:J.totalCount}}}async function c(e,t){let{data:a,error:s}=await e.from("company_memberships").select(`
			*,
			users:profiles!company_memberships_profile_id_fkey(
				id,
				full_name,
				email,
				phone,
				avatar_url
			)
		`).eq("company_id",t).eq("status","active").is("archived_at",null);return s?(console.warn("Join query failed, falling back to sequential queries:",s.message),o(e,t)):(a??[]).map(e=>({...e,users:e.users?{id:e.users.id,name:e.users.full_name,email:e.users.email,phone:e.users.phone,avatar:e.users.avatar_url}:null}))}async function o(e,t){let{data:a,error:s}=await e.from("company_memberships").select("*").eq("company_id",t).eq("status","active").is("archived_at",null);if(s)throw s;let n=Array.from(new Set((a??[]).map(e=>e.user_id).filter(e=>!!e))),i=new Map;if(n.length>0){let{data:t,error:a}=await e.from("profiles").select("id, full_name, email, phone, avatar_url").in("id",n);if(a)throw a;(t??[]).forEach(e=>{i.set(e.id,e)})}return(a??[]).map(e=>({...e,users:e.user_id?i.get(e.user_id)??null:null}))}async function l(e,t,a){let s,i,r,d=a.limit??50,c=a.offset??0,o=e.from("jobs").select(n,{count:"exact"}).eq("company_id",t).is("deleted_at",null).is("archived_at",null).is("scheduled_start",null).is("scheduled_end",null).not("status","in",'("completed","cancelled")').order("created_at",{ascending:!1}).range(c,c+d-1);if(a.search?.trim()){let e=a.search.trim().replace(/,/g,"\\,"),t=`%${e}%`;o=o.or(`title.ilike.${t},job_number.ilike.${t},description.ilike.${t}`)}try{let e=await o;s=e.data,i=e.count,r=e.error}catch(e){return console.error("[Schedule] Unscheduled jobs fetch failed:",e),{rows:[],totalCount:0,hasMore:!1}}if(r)return console.error("[Schedule] Unscheduled jobs query error:",r),{rows:[],totalCount:0,hasMore:!1};let l=s??[],u="number"==typeof i?i:l.length,m=c+l.length<u;return{rows:l,totalCount:u,hasMore:m}}async function u(e,t){let a=new Map;if(0===t.length)return a;for(let s=0;s<t.length;s+=100){let n=t.slice(s,s+100);try{let{data:t,error:s}=await e.from("properties").select("id, name, address, address2, city, state, zip_code, country, lat, lon").in("id",n);if(s){console.error("[Schedule] Properties query error:",s);continue}(t??[]).forEach(e=>a.set(e.id,e))}catch(e){console.error(`[Schedule] Failed to fetch properties chunk ${s/100+1}:`,e);continue}}return a}function m(e){let t=new Set;return e.filter(e=>{let a=`${e.role}-${e.technicianId??e.teamMemberId??""}`;return!t.has(a)&&(t.add(a),!0)})}function h(e){return e?{address:{street:e.address||e.address2||e.name||"",city:e.city||"",state:e.state||"",zip:e.zip_code||"",country:e.country||""},coordinates:{lat:e.lat||0,lng:e.lon||0}}:{...r}}function p(e){return"active"===e?"available":"offline"}e.s(["fetchScheduleData",()=>d],83690)},899117,e=>{"use strict";var t=e.i(399168),a=e.i(781403),s=e.i(643023),n=e.i(83690),i=e.i(830891);let r=(0,t.create)()((0,a.devtools)((0,a.persist)((e,t)=>({technicians:new Map,jobs:new Map,companyId:null,lastFetchedRange:null,isLoading:!1,error:null,lastSync:null,isLoadingUnassigned:!1,unassignedSearch:"",unassignedHasMore:!1,unassignedNextOffset:0,unassignedLimit:50,unassignedTotalCount:0,selectedJobId:null,selectedTechnicianId:null,setTechnicians:t=>{e({technicians:new Map(t.map(e=>[e.id,e]))})},addTechnician:t=>{e(e=>{let a=new Map(e.technicians);return a.set(t.id,t),{technicians:a}})},updateTechnician:(t,a)=>{e(e=>{let s=new Map(e.technicians),n=s.get(t);return n&&s.set(t,{...n,...a}),{technicians:s}})},removeTechnician:t=>{e(e=>{let a=new Map(e.technicians);a.delete(t);let s=new Map(e.jobs);for(let[e,a]of s){let n=a.assignments.filter(e=>e.technicianId!==t);n.length!==a.assignments.length&&s.set(e,{...a,assignments:n,technicianId:n.find(e=>"primary"===e.role)?.technicianId??"",isUnassigned:0===n.length})}return{technicians:a,jobs:s,selectedTechnicianId:e.selectedTechnicianId===t?null:e.selectedTechnicianId}})},setJobs:t=>{e({jobs:new Map(t.map(e=>[e.id,e]))})},addJob:t=>{e(e=>{let a=new Map(e.jobs);return a.set(t.id,t),{jobs:a}})},updateJob:(t,a)=>{e(e=>{let s=new Map(e.jobs),n=s.get(t);return n&&s.set(t,{...n,...a}),{jobs:s}})},moveJob:(t,a,s,n)=>{e(e=>{let i=new Map(e.jobs),r=i.get(t);if(r){let d=e.technicians.get(a),c=r.assignments.length>0?r.assignments.map(e=>"primary"===e.role?{...e,technicianId:a,teamMemberId:d?.teamMemberId,displayName:d?.name||e.displayName,avatar:d?.avatar??e.avatar??null,status:d?.status??e.status,isActive:d?.isActive??!0}:e):[{technicianId:a,teamMemberId:d?.teamMemberId,displayName:d?.name||"Primary Technician",avatar:d?.avatar??null,role:"primary",status:d?.status??"available",isActive:!0}];i.set(t,{...r,technicianId:a,assignments:c,isUnassigned:0===c.length,startTime:s,endTime:n})}return{jobs:i}})},deleteJob:t=>{e(e=>{let a=new Map(e.jobs);return a.delete(t),{jobs:a,selectedJobId:e.selectedJobId===t?null:e.selectedJobId}})},duplicateJob:(e,a)=>{let s=t().jobs.get(e);if(!s)return;let n=s.endTime.getTime()-s.startTime.getTime(),i=new Date(a.getTime()+n),r={...s,id:`${s.id}-copy-${Date.now()}`,startTime:a,endTime:i,status:"scheduled",assignments:s.assignments.map(e=>({...e})),createdAt:new Date,updatedAt:new Date};t().addJob(r)},selectJob:t=>e({selectedJobId:t}),selectTechnician:t=>e({selectedTechnicianId:t}),bulkUpdateJobs:t=>{e(e=>{let a=new Map(e.jobs);return t.forEach(({jobId:e,updates:t})=>{let s=a.get(e);s&&a.set(e,{...s,...t})}),{jobs:a}})},bulkDeleteJobs:t=>{e(e=>{let a=new Map(e.jobs);return t.forEach(e=>a.delete(e)),{jobs:a,selectedJobId:t.includes(e.selectedJobId||"")?null:e.selectedJobId}})},hydrateFromServer:a=>{e(e=>{let t=new Map(a.jobs.map(e=>[e.id,e])),s=new Map(a.technicians.map(e=>[e.id,e]));return{...e,companyId:a.companyId,jobs:t,technicians:s,lastFetchedRange:{start:a.range.start,end:a.range.end},lastSync:a.lastSync,isLoading:!1,error:null,selectedTechnicianId:null,selectedJobId:null}});let s=a.jobs.filter(e=>e.isUnassigned).length;t().setUnassignedMeta(a.unassignedMeta,s)},syncWithServer:async()=>{e({isLoading:!0,error:null});try{let a=(0,i.createClient)();if(!a)throw Error("Database connection not available");let s=t().companyId;if(!s)throw Error("Company context is missing");let r=t().lastFetchedRange??{start:new Date(Date.now()-2592e6),end:new Date(Date.now()+2592e6)},{unassignedLimit:d,unassignedSearch:c}=t(),{jobs:o,technicians:l,unassignedMeta:u}=await (0,n.fetchScheduleData)({supabase:a,companyId:s,range:r,unscheduledLimit:d,unscheduledOffset:0,unscheduledSearch:c});t().setTechnicians(l),t().setJobs(o),e({lastSync:new Date,lastFetchedRange:{start:new Date(r.start),end:new Date(r.end)}});let m=o.filter(e=>e.isUnassigned).length;t().setUnassignedMeta(u,m)}catch(t){e({error:t instanceof Error?t.message:"Unknown error"})}finally{e({isLoading:!1})}},setLoading:t=>e({isLoading:t}),setError:t=>e({error:t}),setLastSync:t=>e({lastSync:t}),setCompanyId:t=>e({companyId:t}),setLastFetchedRange:t=>e({lastFetchedRange:t}),setUnassignedMeta:(t,a=0)=>e(e=>{let s=Math.max(a,Array.from(e.jobs.values()).filter(e=>e.isUnassigned).length);return{unassignedSearch:t&&"string"==typeof t.search?t.search:e.unassignedSearch??"",unassignedHasMore:"boolean"==typeof t?.hasMore?t.hasMore:e.unassignedHasMore??!1,unassignedNextOffset:t?.nextOffset??s,unassignedLimit:t?.limit??e.unassignedLimit??50,unassignedTotalCount:t?.totalCount??s,isLoadingUnassigned:!1}}),loadMoreUnassignedJobs:async({reset:a=!1,search:n}={})=>{let{unassignedLimit:i}=t(),r="string"==typeof n?n:t().unassignedSearch,d=a?0:t().unassignedNextOffset;e({isLoadingUnassigned:!0,error:null,unassignedSearch:r});try{let n=await fetch("/api/schedule/unscheduled",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({search:r,offset:d,limit:i})}),c=await n.json();if(!n.ok)throw Error(c?.error||"Failed to load unscheduled jobs");let o=Array.isArray(c?.jobs)?c.jobs.map(s.deserializeJob):[],l=c?.meta;e(e=>{let t=new Map(e.jobs);if(a)for(let[e,a]of t)a.isUnassigned&&t.delete(e);return o.forEach(e=>{t.set(e.id,e)}),{jobs:t}});let u=Array.from(t().jobs.values()).filter(e=>e.isUnassigned).length;t().setUnassignedMeta(l,u)}catch(t){throw e({error:t instanceof Error?t.message:"Failed to load unscheduled jobs"}),t}finally{e({isLoadingUnassigned:!1})}},getJobsByTechnician:e=>Array.from(t().jobs.values()).filter(t=>t.assignments.some(t=>t.technicianId===e)),getJobsByDateRange:(e,a)=>Array.from(t().jobs.values()).filter(t=>t.startTime<=a&&t.endTime>=e),getTechnicianById:e=>t().technicians.get(e),getJobById:e=>t().jobs.get(e),hasConflict:(e,a,s,n)=>t().getJobsByTechnician(e).some(e=>(!n||e.id!==n)&&(a>=e.startTime&&a<e.endTime||s>e.startTime&&s<=e.endTime||a<=e.startTime&&s>=e.endTime)),getUnassignedJobs:()=>Array.from(t().jobs.values()).filter(e=>e.isUnassigned),getJobsGroupedByTechnician:()=>{let e={};for(let a of t().jobs.values())a.assignments.forEach(t=>{t.technicianId&&(e[t.technicianId]||(e[t.technicianId]=[]),e[t.technicianId].push(a))});return e}}),{name:"schedule-storage",skipHydration:!0,partialize:e=>({technicians:Array.from(e.technicians.values()),jobs:Array.from(e.jobs.values()),lastSync:e.lastSync}),merge:(e,t)=>{let a=e?.technicians?new Map(e.technicians.map(e=>[e.id,e])):t.technicians,s=e?.jobs?new Map(e.jobs.map(e=>[e.id,e])):t.jobs;return{...t,...e,technicians:a,jobs:s}}})));e.s(["useScheduleStore",0,r])},133593,e=>{"use strict";let t=(0,e.i(383206).default)("circle-user",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);e.s(["default",()=>t])},614035,e=>{e.v(t=>Promise.all(["static/chunks/b0e67fd8e87bd72c.js","static/chunks/8fd0186b58f94c2a.js","static/chunks/62e09d9c575d19fd.js"].map(t=>e.l(t))).then(()=>t(915024)))},168481,e=>{e.v(t=>Promise.all(["static/chunks/4839916519df1b0b.js","static/chunks/74df0f18ee63c3b6.js"].map(t=>e.l(t))).then(()=>t(823591)))},805737,e=>{e.v(t=>Promise.all(["static/chunks/b38eb0e05b763b4c.js"].map(t=>e.l(t))).then(()=>t(773915)))},646739,e=>{e.v(t=>Promise.all(["static/chunks/7e8d6777a0dcdd2e.js"].map(t=>e.l(t))).then(()=>t(199978)))},604099,e=>{e.v(t=>Promise.all(["static/chunks/a2e64fd2b62c1781.js","static/chunks/0c5080b2967df64c.js"].map(t=>e.l(t))).then(()=>t(5456)))}]);