(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,169741,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("00ebc03a4ffc993aea7ec2e541686105c2bace2437",t.callServer,void 0,t.findSourceMapURL,"getTotalUnreadCountAction");e.s(["getTotalUnreadCountAction",()=>s])},26972,e=>{"use strict";var t=e.i(111043),s=e.i(517816),s=s,r=e.i(74141),r=r,a=e.i(823167),n=e.i(176378),i=e.i(904653),l=e.i(970799),o=e.i(343511),c=e.i(204574),d=e.i(969098),m=e.i(288413),u=e.i(220415),u=u,x=e.i(90114),h=e.i(181947);let p=[{label:"Documentation",description:"Guides and tutorials for all features",href:"/docs",icon:c.BookOpen},{label:"Video Tutorials",description:"Step-by-step video guides",href:"/docs/videos",icon:h.Video},{label:"Support Center",description:"Get help from our support team",href:"/support",icon:u.default},{label:"Contact Support",description:"Chat with our support team",href:"/support/contact",icon:x.MessageCircle},{label:"What's New",description:"Latest features and updates",href:"/changelog",icon:m.HelpCircle}];function f(){let[e,s]=(0,l.useState)(!1),r=(0,l.useRef)(null);return(0,l.useEffect)(()=>{let t=e=>{r.current&&!r.current.contains(e.target)&&s(!1)};return e&&document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[e]),(0,t.jsxs)("div",{className:"relative",ref:r,children:[(0,t.jsxs)("button",{className:"hover-gradient hover:border-primary/20 hover:bg-primary/10 hover:text-primary focus-visible:ring-ring/50 flex h-8 w-8 items-center justify-center rounded-md border border-transparent transition-all outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50",onClick:()=>s(!e),title:"Help",type:"button",children:[(0,t.jsx)(m.HelpCircle,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Help"})]}),e&&(0,t.jsxs)("div",{className:"bg-popover text-popover-foreground absolute top-full right-0 z-50 mt-2 w-80 rounded-lg border p-2 shadow-lg",children:[(0,t.jsxs)("div",{className:"mb-2 border-b px-3 py-2",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold",children:"Help & Support"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"Find answers and get assistance"})]}),(0,t.jsx)("div",{className:"space-y-1",children:p.map(e=>{let r=e.icon;return(0,t.jsxs)(n.default,{className:"hover:bg-accent flex items-start gap-3 rounded-md px-3 py-2.5 transition-colors",href:e.href,onClick:()=>s(!1),rel:e.external?"noopener noreferrer":void 0,target:e.external?"_blank":void 0,children:[(0,t.jsx)(r,{className:"text-muted-foreground mt-0.5 size-4 shrink-0"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.label}),e.external&&(0,t.jsx)(d.ExternalLink,{className:"text-muted-foreground size-3"})]}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:e.description})]})]},e.label)})}),(0,t.jsx)("div",{className:"mt-2 border-t pt-2",children:(0,t.jsxs)("div",{className:"bg-accent/50 rounded-md px-3 py-2",children:[(0,t.jsx)("p",{className:"text-xs font-medium",children:"Need more help?"}),(0,t.jsxs)("p",{className:"text-muted-foreground text-xs",children:["Email us at"," ",(0,t.jsx)("a",{className:"text-primary hover:underline",href:"mailto:support@thorbis.com",children:"support@thorbis.com"})]})]})})]})]})}var g=e.i(818796),b=e.i(230666),j=e.i(79254),v=e.i(872021),N=e.i(852648),y=e.i(136764),w=e.i(403468),C=e.i(982686),k=e.i(641304),S=e.i(747146),T=e.i(939397),A=e.i(121085),I=e.i(532727),M=e.i(12435),D=e.i(501651),P=e.i(212409),R=e.i(900007),z=e.i(381234),E=e.i(953653),_=e.i(834633),B=e.i(430063),$=e.i(705685),F=e.i(830891);let L={message:S.MessageSquare,alert:g.AlertCircle,payment:C.DollarSign,job:D.Wrench,team:M.UserPlus,system:A.Settings},U={message:"text-primary",alert:"text-warning",payment:"text-success",job:"text-accent-foreground",team:"text-cyan-500",system:"text-muted-foreground"};function O({count:e}){return 0===e?null:(0,t.jsx)("span",{className:"bg-destructive absolute -top-1 -right-1 flex h-[18px] min-w-[18px] items-center justify-center rounded-full px-1.5 text-[0.625rem] leading-none font-bold text-white",children:e<=9?e.toString():e<=99?"99+":e<=999?"999+":"1K+"})}function W(){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)(b.Bell,{className:"text-muted-foreground/30 mb-3 size-12"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm font-medium",children:"All caught up!"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"No new notifications"})]})}function H({hasPhoneNumbers:e=!1,hasPayrixAccount:s=!1,payrixStatus:r=null}={}){let[a,i]=(0,l.useState)(!1),o=(0,l.useRef)(null),c=(0,B.useNotificationsStore)(e=>e.notifications),d=(0,B.useNotificationsStore)(e=>e.unreadCount),m=(0,B.useNotificationsStore)(e=>e.setNotifications),u=(0,B.useNotificationsStore)(e=>e.optimisticMarkAsRead),x=(0,B.useNotificationsStore)(e=>e.optimisticMarkAllAsRead),h=(0,B.useNotificationsStore)(e=>e.optimisticDelete),p=(0,B.useNotificationsStore)(e=>e.subscribe),f=(0,B.useNotificationsStore)(e=>e.unsubscribe),C=(0,$.useSyncStore)(e=>e.operations??[]),S=(0,$.useSyncStore)(e=>e.offlineQueue??[]),A=(0,$.useSyncStore)(e=>e.clearCompleted),M=C.filter(e=>"in_progress"===e.status),D=C.filter(e=>"completed"===e.status||"failed"===e.status),q=M.length>0||S.length>0,V=M.length+S.length,K=(0,l.useRef)(!1);(0,l.useEffect)(()=>{if(!a||K.current)return;let e=!1;return async function(){try{let t=(0,F.createClient)();if(!t)return;let{data:{user:s}}=await t.auth.getUser();if(!s)return;let{data:r,error:a}=await t.from("notifications").select("*").eq("user_id",s.id).order("created_at",{ascending:!1}).range(0,49);e||a||!r||m(r),e||(await p(s.id),K.current=!0)}catch(e){}}(),()=>{e=!0}},[a,m,p]),(0,l.useEffect)(()=>()=>{f()},[f]),(0,l.useEffect)(()=>{let e=e=>{o.current&&!o.current.contains(e.target)&&i(!1)};return a&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[a]);let G=async e=>{u(e);let t=await (0,_.markAsRead)(e);t.success||console.error("Failed to mark notification as read:",t.error)},Q=async()=>{x();let e=await (0,E.markAllAsRead)();e.success||console.error("Failed to mark all notifications as read:",e.error)},X=async e=>{h(e);let t=await (0,z.deleteNotification)(e);t.success||console.error("Failed to delete notification:",t.error)};return(0,t.jsxs)("div",{className:"relative overflow-visible",ref:o,children:[(0,t.jsxs)("button",{className:"hover-gradient hover:border-primary/20 hover:bg-primary/10 hover:text-primary focus-visible:ring-ring/50 relative flex h-8 w-8 items-center justify-center rounded-md border border-transparent transition-all outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50",onClick:()=>i(!a),title:q?"Notifications & Sync Status":"Notifications",type:"button",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(b.Bell,{className:"size-4"}),q&&(0,t.jsx)(k.Loader2,{className:"text-primary absolute -top-1 -right-1 size-2.5 animate-spin"})]}),(0,t.jsx)(O,{count:d+V}),(0,t.jsxs)("span",{className:"sr-only",children:["Notifications ",d>0&&`(${d} unread)`,q&&` • ${V} syncing`]})]}),a&&(0,t.jsxs)("div",{className:"bg-popover text-popover-foreground absolute top-full right-0 z-50 mt-2 flex w-[380px] max-w-[calc(100vw-2rem)] flex-col rounded-lg border shadow-lg",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b px-4 py-2.5",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"text-sm font-semibold",children:q?"Sync & Notifications":"Notifications"}),(d>0||q)&&(0,t.jsxs)("p",{className:"text-muted-foreground text-xs",children:[q&&`${V} syncing`,q&&d>0&&" • ",d>0&&`${d} unread`]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[d>0&&(0,t.jsx)("button",{className:"hover:bg-accent flex h-7 w-7 items-center justify-center rounded-md transition-colors",onClick:Q,title:"Mark all as read",type:"button",children:(0,t.jsx)(v.CheckCheck,{className:"size-3.5"})}),(0,t.jsx)("button",{className:"hover:bg-accent flex h-7 w-7 items-center justify-center rounded-md transition-colors",onClick:()=>i(!1),type:"button",children:(0,t.jsx)(P.X,{className:"size-3.5"})})]})]}),(M.length>0||S.length>0||D.length>0)&&(0,t.jsxs)("div",{className:"border-b",children:[M.length>0&&(0,t.jsxs)("div",{className:"space-y-1 px-4 py-3",children:[(0,t.jsx)("p",{className:"text-muted-foreground mb-2 text-xs font-medium tracking-wider uppercase",children:"Active"}),M.map(e=>(0,t.jsxs)("div",{className:"bg-primary/5 flex items-start gap-2 rounded-md p-2",children:[(0,t.jsx)(k.Loader2,{className:"text-primary mt-0.5 size-3.5 shrink-0 animate-spin"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm leading-tight font-medium",children:e.title}),e.description&&(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:e.description}),e.total&&e.total>0&&(0,t.jsxs)("div",{className:"mt-1 space-y-0.5",children:[(0,t.jsx)("div",{className:"bg-muted h-1 overflow-hidden rounded-full",children:(0,t.jsx)("div",{className:"bg-primary h-full transition-all",style:{width:`${(e.current??0)/e.total*100}%`}})}),(0,t.jsxs)("p",{className:"text-muted-foreground text-[0.625rem]",children:[e.current??0," / ",e.total]})]})]})]},e.id))]}),S.length>0&&(0,t.jsxs)("div",{className:"space-y-1 px-4 py-3",children:[(0,t.jsxs)("p",{className:"text-muted-foreground mb-2 flex items-center gap-1.5 text-xs font-medium tracking-wider uppercase",children:[(0,t.jsx)("span",{className:"size-1.5 animate-pulse rounded-full bg-orange-500"}),"Queued (Offline)"]}),S.map(e=>(0,t.jsxs)("div",{className:"flex items-start gap-2 rounded-md bg-orange-50 p-2 dark:bg-orange-950/20",children:[(0,t.jsx)(y.Clock,{className:"mt-0.5 size-3.5 shrink-0 text-orange-500"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm leading-tight font-medium",children:e.action}),(0,t.jsx)("p",{className:"mt-0.5 text-[0.625rem] text-orange-600 dark:text-orange-400",children:"Will sync when online"})]})]},e.id))]}),D.length>0&&(0,t.jsxs)("div",{className:"space-y-1 px-4 py-3",children:[(0,t.jsxs)("div",{className:"mb-2 flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs font-medium tracking-wider uppercase",children:"Recent"}),(0,t.jsx)("button",{className:"text-muted-foreground hover:text-foreground text-xs",onClick:A,type:"button",children:"Clear"})]}),D.map(e=>(0,t.jsxs)("div",{className:`flex items-start gap-2 rounded-md p-2 ${"completed"===e.status?"bg-green-50 dark:bg-green-950/20":"bg-red-50 dark:bg-red-950/20"}`,children:["completed"===e.status?(0,t.jsx)(N.CheckCircle2,{className:"mt-0.5 size-3.5 shrink-0 text-green-600 dark:text-green-400"}):(0,t.jsx)(R.XCircle,{className:"mt-0.5 size-3.5 shrink-0 text-red-600 dark:text-red-400"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm leading-tight font-medium",children:e.title}),e.error&&(0,t.jsx)("p",{className:"text-xs text-red-600 dark:text-red-400",children:e.error})]})]},e.id))]})]}),(0,t.jsxs)("div",{className:"max-h-[450px] overflow-y-auto",children:[!e&&(0,t.jsx)("div",{className:"border-b",children:(0,t.jsxs)("div",{className:"group bg-warning/10 hover:bg-warning/15 relative px-4 py-3 transition-colors",children:[(0,t.jsx)("div",{className:"bg-warning absolute top-0 left-0 h-full w-0.5"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("div",{className:"text-warning mt-0.5 shrink-0",children:(0,t.jsx)(T.Phone,{className:"size-4"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 space-y-1",children:[(0,t.jsx)("p",{className:"text-sm leading-snug font-medium",children:"Phone System Not Configured"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs leading-relaxed",children:"You cannot use calling, texting, or communication features without setting up phone numbers. Complete the setup to enable phone system capabilities."}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 pt-1",children:[(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[(0,t.jsx)(g.AlertCircle,{className:"size-3"}),"System Alert"]}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)(n.default,{className:"bg-warning/20 text-warning hover:bg-warning/30 rounded px-2 py-1 text-xs font-medium transition-colors",href:"/welcome?step=3",onClick:()=>i(!1),children:"Complete Setup"})})]})]})]})]})}),!s&&(0,t.jsx)("div",{className:"border-b",children:(0,t.jsxs)("div",{className:"group bg-warning/10 hover:bg-warning/15 relative px-4 py-3 transition-colors",children:[(0,t.jsx)("div",{className:"bg-warning absolute top-0 left-0 h-full w-0.5"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("div",{className:"text-warning mt-0.5 shrink-0",children:(0,t.jsx)(w.CreditCard,{className:"size-4"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 space-y-1",children:[(0,t.jsx)("p",{className:"text-sm leading-snug font-medium",children:"Payment Processing Not Configured"}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs leading-relaxed",children:"You cannot collect payments from customers without setting up your merchant account. Complete the setup to start accepting payments on invoices and estimates."}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 pt-1",children:[(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[(0,t.jsx)(g.AlertCircle,{className:"size-3"}),"System Alert"]}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)(n.default,{className:"bg-warning/20 text-warning hover:bg-warning/30 rounded px-2 py-1 text-xs font-medium transition-colors",href:"/welcome?step=5",onClick:()=>i(!1),children:"Complete Setup"})})]})]})]})]})}),0===c.length&&e&&s?(0,t.jsx)(W,{}):c.length>0?(0,t.jsx)("div",{className:"divide-y",children:c.map(e=>{var s;let r,a,l,o,c=L[e.type];return(0,t.jsxs)("div",{className:`group hover:bg-accent/50 relative px-4 py-3 transition-colors ${e.read?"":"bg-primary/5"}`,children:[!e.read&&(0,t.jsx)("div",{className:"bg-primary absolute top-0 left-0 h-full w-0.5"}),(0,t.jsxs)("div",{className:"flex gap-3",children:[(0,t.jsx)("div",{className:`mt-0.5 shrink-0 ${U[e.type]}`,children:(0,t.jsx)(c,{className:"size-4"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 space-y-1",children:[(0,t.jsx)("p",{className:"text-sm leading-snug font-medium",children:e.title}),(0,t.jsx)("p",{className:"text-muted-foreground text-xs leading-relaxed",children:e.message}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 pt-1",children:[(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[(0,t.jsx)(y.Clock,{className:"size-3"}),(s=new Date(e.created_at),a=Math.floor((r=new Date().getTime()-s.getTime())/6e4),l=Math.floor(r/36e5),o=Math.floor(r/864e5),a<1?"Just now":a<60?`${a}m ago`:l<24?`${l}h ago`:o<7?`${o}d ago`:s.toLocaleDateString())]}),(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[e.action_url&&(0,t.jsx)(n.default,{className:"text-primary hover:bg-primary/10 rounded px-2 py-1 text-xs font-medium transition-colors",href:e.action_url,onClick:()=>{G(e.id),i(!1)},children:e.action_label||"View"}),!e.read&&(0,t.jsx)("button",{className:"hover:bg-accent flex h-6 w-6 items-center justify-center rounded transition-colors",onClick:()=>G(e.id),title:"Mark as read",type:"button",children:(0,t.jsx)(j.Check,{className:"size-3"})}),(0,t.jsx)("button",{className:"hover:bg-destructive/10 hover:text-destructive flex h-6 w-6 items-center justify-center rounded transition-colors",onClick:()=>X(e.id),title:"Delete",type:"button",children:(0,t.jsx)(I.Trash2,{className:"size-3"})})]})]})]})]})]},e.id)})}):null]}),c.length>0&&(0,t.jsx)("div",{className:"border-t px-4 py-2",children:(0,t.jsx)(n.default,{className:"text-primary hover:bg-accent flex items-center justify-center rounded-md py-1.5 text-xs font-medium transition-colors",href:"/dashboard/notifications",onClick:()=>i(!1),children:"View all notifications"})})]})]})}e.i(313550);var q=e.i(139324),V=e.i(193822),K=e.i(126256),G=e.i(311003),Q=e.i(890841),X=e.i(365707),J=e.i(14100),Y=e.i(511172),Z=e.i(224262),ee=e.i(160424),et=e.i(577141),et=et,es=e.i(14435),er=e.i(721855),ea=e.i(452865),en=e.i(119249);e.i(553153);var ei=e.i(363712);e.i(889265);var el=e.i(677607);e.i(733296);var eo=e.i(993665);e.i(244242);var ec=e.i(563078);e.i(51478);var ed=e.i(635613);e.i(220474);var em=e.i(171056);e.i(868198);var eu=e.i(798764);e.i(223342);var ex=e.i(395645);e.i(794747);var eh=e.i(513990);let ep=null,ef=0;var eg=e.i(468849),eb=e.i(51052),ej=e.i(539900),ev=e.i(334992),eN=e.i(152088);let ey=e=>(e??"").trim(),ew=e=>e.display_name?.trim()?e.display_name.trim():[e.first_name,e.last_name].map(ey).filter(Boolean).join(" ")||e.email?.trim()||"Unknown",eC=e=>{let t=e.replace(/\D/g,"");return 11===t.length&&"1"===t[0]?`+1 (${t.slice(1,4)}) ${t.slice(4,7)}-${t.slice(7)}`:10===t.length?`(${t.slice(0,3)}) ${t.slice(3,6)}-${t.slice(6)}`:e};function ek({status:e,mode:s,onRetry:r,className:a}){if("api"===s)return(0,t.jsxs)(ei.Badge,{variant:"outline",className:(0,eN.cn)("gap-1 text-[10px]",a),children:[(0,t.jsx)(et.default,{className:"h-3 w-3"}),"API Mode"]});let n={disconnected:{icon:ea.WifiOff,label:"Disconnected",variant:"outline",className:"text-muted-foreground"},connecting:{icon:k.Loader2,label:"Connecting...",variant:"outline",className:"text-warning",animate:!0},connected:{icon:er.Wifi,label:"WebRTC Ready",variant:"outline",className:"text-success border-success/30"},error:{icon:g.AlertCircle,label:"Connection Error",variant:"destructive",className:""}}[e],i=n.icon;return(0,t.jsxs)("div",{className:(0,eN.cn)("flex items-center gap-1",a),children:[(0,t.jsxs)(ei.Badge,{variant:n.variant,className:(0,eN.cn)("gap-1 text-[10px]",n.className),children:[(0,t.jsx)(i,{className:(0,eN.cn)("h-3 w-3",!0===n.animate&&"animate-spin")}),n.label]}),("error"===e||"disconnected"===e)&&r&&(0,t.jsx)(el.Button,{variant:"ghost",size:"icon",className:"h-5 w-5",onClick:r,children:(0,t.jsx)(ee.RefreshCw,{className:"h-3 w-3"})})]})}function eS({call:e,onMute:s,onHold:r,onEnd:a,className:n}){let i,[o,c]=(0,l.useState)(0);(0,l.useEffect)(()=>{if("active"!==e.state)return void c(0);let t=e.startTime?.getTime()||Date.now(),s=setInterval(()=>{c(Math.floor((Date.now()-t)/1e3))},1e3);return()=>clearInterval(s)},[e.state,e.startTime]);let d={idle:{label:"Idle",color:"text-muted-foreground",icon:T.Phone},connecting:{label:"Connecting...",color:"text-warning",icon:Y.PhoneOutgoing},ringing:{label:"Ringing...",color:"text-primary",icon:Y.PhoneOutgoing},active:{label:"Active",color:"text-success",icon:Q.PhoneCall},held:{label:"On Hold",color:"text-warning",icon:G.Pause},ended:{label:"Call Ended",color:"text-muted-foreground",icon:J.PhoneOff}}[e.state],m=d.icon;return(0,t.jsxs)("div",{className:(0,eN.cn)("rounded-lg border bg-card p-3",n),children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:(0,eN.cn)("rounded-full bg-primary/10 p-2",d.color),children:(0,t.jsx)(m,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"text-sm font-medium",children:e.remoteName||eC(e.remoteNumber)}),(0,t.jsx)("p",{className:(0,eN.cn)("text-xs",d.color),children:d.label})]})]}),"active"===e.state&&(0,t.jsx)(ei.Badge,{variant:"outline",className:"text-xs tabular-nums",children:(i=Math.floor(o/60),`${i}:${(o%60).toString().padStart(2,"0")}`)})]}),("active"===e.state||"held"===e.state)&&(0,t.jsxs)("div",{className:"flex items-center justify-center gap-2",children:[(0,t.jsxs)(eh.Tooltip,{children:[(0,t.jsx)(eh.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(el.Button,{variant:e.isMuted?"destructive":"outline",size:"icon",className:"h-9 w-9 rounded-full",onClick:s,children:e.isMuted?(0,t.jsx)(K.MicOff,{className:"h-4 w-4"}):(0,t.jsx)(V.Mic,{className:"h-4 w-4"})})}),(0,t.jsx)(eh.TooltipContent,{children:e.isMuted?"Unmute":"Mute"})]}),(0,t.jsxs)(eh.Tooltip,{children:[(0,t.jsx)(eh.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(el.Button,{variant:e.isHeld?"secondary":"outline",size:"icon",className:"h-9 w-9 rounded-full",onClick:r,children:e.isHeld?(0,t.jsx)(Z.Play,{className:"h-4 w-4"}):(0,t.jsx)(G.Pause,{className:"h-4 w-4"})})}),(0,t.jsx)(eh.TooltipContent,{children:e.isHeld?"Resume":"Hold"})]}),(0,t.jsxs)(eh.Tooltip,{children:[(0,t.jsx)(eh.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(el.Button,{variant:"destructive",size:"icon",className:"h-9 w-9 rounded-full",onClick:a,children:(0,t.jsx)(J.PhoneOff,{className:"h-4 w-4"})})}),(0,t.jsx)(eh.TooltipContent,{children:"End Call"})]})]}),("connecting"===e.state||"ringing"===e.state)&&(0,t.jsx)("div",{className:"flex items-center justify-center gap-2",children:(0,t.jsxs)(el.Button,{variant:"destructive",size:"sm",className:"gap-2",onClick:a,children:[(0,t.jsx)(J.PhoneOff,{className:"h-4 w-4"}),"Cancel"]})})]})}function eT({companyId:e,companyPhones:s=[],incomingCallsCount:r}){let{toast:a}=(0,eb.useToast)(),[i,c]=(0,l.useState)(!1),[d,m]=(0,l.useTransition)(),[u,x]=(0,l.useState)(!1),{customers:h,isLoading:p}=function(e=!1){let[t,s]=(0,l.useState)([]),[r,a]=(0,l.useState)(!1),[n,i]=(0,l.useState)(null);return(0,l.useEffect)(()=>{if(!e)return;let t=Date.now();if(ep&&t-ef<3e5)return void s(ep);let r=new AbortController;return(async()=>{a(!0),i(null);try{let e=await fetch("/api/dialer/customers",{signal:r.signal,cache:"no-store"});if(!e.ok){let t=await e.json().catch(()=>({}));throw Error(t.error||"Failed to load customers")}let t=await e.json();ep=t.customers,ef=Date.now(),s(t.customers)}catch(e){if(r.signal.aborted)return;i(e instanceof Error?e.message:"Failed to load customers")}finally{r.signal.aborted||a(!1)}})(),()=>{r.abort()}},[e]),{customers:t,isLoading:r,error:n}}(u),f=(0,o.useDialerStore)(),[g,b]=(0,l.useState)(""),[v,N]=(0,l.useState)(s[0]?.number||""),[w,C]=(0,l.useState)(null),[A,I]=(0,l.useState)(!1),[M,D]=(0,l.useState)(""),[R,z]=(0,l.useState)("webrtc"),[E,_]=(0,l.useState)(null),[B,$]=(0,l.useState)("disconnected"),[F,L]=(0,l.useState)(null),U=(0,l.useRef)(null),O=(0,l.useRef)(0),W=(0,l.useRef)(null),H=(0,ej.useUIStore)(e=>e.call.status),V=(0,ej.useUIStore)(e=>e.call.caller),K="incoming"===H,G=r??+!!K,J=(0,eg.useTelnyxWebRTC)({username:E?.username||"",password:E?.password||"",autoConnect:!1,debug:!1,onIncomingCall:e=>{a.info(`Incoming call from ${e.remoteName||e.remoteNumber}`)},onCallEnded:()=>{a.info("Call ended")}});(0,l.useEffect)(()=>{if(c(!0),!W.current){let e=document.createElement("audio");e.id="telnyx-remote-audio",e.autoplay=!0,e.style.display="none",document.body.appendChild(e),W.current=e}return()=>{W.current&&(W.current.remove(),W.current=null)}},[]),(0,l.useEffect)(()=>{!v&&s.length>0&&N(s[0].number)},[s,v]),(0,l.useEffect)(()=>x(f.isOpen),[f.isOpen]),(0,l.useEffect)(()=>b(f.phoneNumber),[f.phoneNumber]),(0,l.useEffect)(()=>{if(f.customerId&&h.length>0){let e=h.find(e=>e.id===f.customerId);e&&e.id!==w?.id&&C(e)}},[f.customerId,h,w?.id]),(0,l.useEffect)(()=>{i&&(async()=>{try{let e=await (0,ev.fetchWebRTCCredentialsOnce)();e.success&&e.credential?_({username:e.credential.username,password:e.credential.password}):(console.warn("Failed to get WebRTC credentials, using API mode"),z("api"))}catch(e){console.error("Failed to fetch WebRTC credentials:",e),z("api")}})()},[i]),(0,l.useEffect)(()=>{if(E&&"webrtc"===R)return(async()=>{U.current&&clearTimeout(U.current),$("connecting"),L(null),U.current=setTimeout(()=>{"connecting"===B&&($("error"),L("Connection timeout - WebRTC may require Level 2 verification"),O.current>=3&&(a.warning("WebRTC unavailable, switching to API mode"),z("api")))},15e3);try{await J.connect()}catch(e){console.error("WebRTC connection error:",e),$("error"),L(e instanceof Error?e.message:"Connection failed")}})(),()=>{U.current&&clearTimeout(U.current)}},[E,R]),(0,l.useEffect)(()=>{J.isConnected?(U.current&&clearTimeout(U.current),$("connected"),L(null),O.current=0):J.connectionError?($("error"),L(J.connectionError)):J.isConnecting&&$("connecting")},[J.isConnected,J.isConnecting,J.connectionError]);let Z=(0,l.useCallback)(e=>{x(e),e?f.openDialer():(f.closeDialer(),b(""),C(null),D(""))},[f]),ee=(0,l.useCallback)(e=>{C(e),e?.phone&&b(e.phone),D(""),I(!1)},[]),er=(0,l.useCallback)(()=>{if(O.current+=1,O.current>3){a.warning("Max retries reached, switching to API mode"),z("api");return}(0,ev.resetWebRTCCredentialsCache)(),_(null),$("disconnected"),L(null),(0,ev.fetchWebRTCCredentialsOnce)().then(e=>{e.success&&e.credential&&_({username:e.credential.username,password:e.credential.password})})},[a]),ea=(0,l.useCallback)(e=>{z(e?"webrtc":"api")},[]),eT=(0,l.useMemo)(()=>{let e=M.trim().toLowerCase();if(!e)return h.slice(0,50);let t=e.replace(/\D/g,"");return h.filter(s=>!!([s.first_name,s.last_name,s.display_name,s.email,s.phone,s.secondary_phone,s.company_name].map(e=>ey(e).toLowerCase()).some(t=>t.includes(e))||t&&[s.phone,s.secondary_phone].map(e=>ey(e).replace(/\D/g,"")).filter(Boolean).some(e=>e.includes(t)))||!1)},[h,M]),eA=(0,l.useCallback)(async()=>{if(d)return;if(!e)return void a.error("No company selected. Please select a company first.");let t=g.replace(/\D/g,"");t?v?m(async()=>{try{let s=await (0,en.makeCall)({to:t,from:v,companyId:e,customerId:w?.id});if(!s.success)return void a.error(s.error||"Failed to start call");a.success(w?`Calling ${ew(w)}`:`Calling ${eC(g)}`);let r=new URLSearchParams({callControlId:s.callControlId||"",companyId:e,to:t,from:v,direction:"outbound",...w?.id&&{customerId:w.id}});window.open(`/call?${r}`,"_blank","noopener,noreferrer"),Z(!1)}catch{a.error("Failed to start call. Please try again.")}}):a.error("Please select a company phone number"):a.error("Please enter a valid phone number")},[e,g,v,w,d,a,Z]),eI=(0,l.useCallback)(async()=>{let e=g.replace(/\D/g,"");if(!e)return void a.error("Please enter a valid phone number");if(!J.isConnected){a.error("WebRTC not connected. Trying API mode..."),eA();return}if(!v)return void a.error("Please select a company phone number");try{await J.makeCall(e,v),a.success(w?`Calling ${ew(w)}`:`Calling ${eC(g)}`)}catch(e){console.error("WebRTC call error:",e),a.error("Failed to start call via WebRTC"),a.info("Falling back to API mode..."),eA()}},[g,v,w,J,a,eA]),eM=(0,l.useCallback)(()=>{"webrtc"===R&&J.isConnected?eI():eA()},[R,J.isConnected,eI,eA]),eD=(0,l.useCallback)(async()=>{try{J.currentCall?.isMuted?await J.unmuteCall():await J.muteCall()}catch(e){console.error("Mute toggle error:",e)}},[J]),eP=(0,l.useCallback)(async()=>{try{J.currentCall?.isHeld?await J.unholdCall():await J.holdCall()}catch(e){console.error("Hold toggle error:",e)}},[J]),eR=(0,l.useCallback)(async()=>{try{await J.endCall()}catch(e){console.error("End call error:",e)}},[J]),ez=!!(g.trim()&&v&&s.length>0),eE="webrtc"===R&&"connected"===B,e_=J.currentCall&&"idle"!==J.currentCall.state&&"ended"!==J.currentCall.state;return i?(0,t.jsx)(eh.TooltipProvider,{delayDuration:200,children:(0,t.jsxs)(ec.DropdownMenu,{open:u,onOpenChange:Z,children:[(0,t.jsxs)(eh.Tooltip,{children:[(0,t.jsx)(eh.TooltipTrigger,{asChild:!0,children:(0,t.jsx)(ec.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{className:(0,eN.cn)("relative flex h-8 w-8 items-center justify-center rounded-md","border border-transparent transition-all","hover:border-primary/20 hover:bg-primary/10 hover:text-primary","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring/50",K&&"animate-pulse text-primary",e_&&"text-success"),type:"button",children:[e_?(0,t.jsx)(Q.PhoneCall,{className:"h-4 w-4"}):K?(0,t.jsx)(X.PhoneIncoming,{className:"h-4 w-4"}):(0,t.jsx)(T.Phone,{className:"h-4 w-4"}),G>0&&(0,t.jsx)(ei.Badge,{variant:"destructive",className:"absolute -right-1 -top-1 flex h-5 w-5 items-center justify-center rounded-full p-0 text-[10px]",children:G>9?"9+":G})]})})}),(0,t.jsx)(eh.TooltipContent,{side:"bottom",children:e_?"Call in Progress":K?"Incoming Call":"Make a Call"})]}),(0,t.jsx)(ec.DropdownMenuContent,{align:"end",className:"w-80 p-0",children:(0,t.jsxs)("div",{className:"space-y-3 p-4",children:[(0,t.jsx)("div",{className:"flex items-center justify-between",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"flex h-10 w-10 shrink-0 items-center justify-center rounded-full bg-primary/10",children:(0,t.jsx)(Q.PhoneCall,{className:"h-5 w-5 text-primary"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("h3",{className:"text-sm font-semibold",children:"Make a Call"}),(0,t.jsx)(ek,{status:B,mode:R,onRetry:er})]})]})}),(0,t.jsxs)("div",{className:"flex items-center justify-between rounded-lg border bg-muted/30 p-2",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(et.default,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"API Mode"})]}),(0,t.jsx)(ex.Switch,{checked:"webrtc"===R,onCheckedChange:ea,disabled:!E}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-xs text-muted-foreground",children:"Browser Audio"}),(0,t.jsx)(q.Headphones,{className:"h-4 w-4 text-muted-foreground"})]})]}),e_&&J.currentCall&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(eS,{call:J.currentCall,onMute:eD,onHold:eP,onEnd:eR}),(0,t.jsx)(ec.DropdownMenuSeparator,{})]}),K&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 rounded-lg border border-destructive/30 bg-destructive/10 p-3",children:[(0,t.jsx)(X.PhoneIncoming,{className:"h-5 w-5 shrink-0 animate-pulse text-destructive"}),(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-sm font-semibold text-destructive",children:"Incoming Call"}),(0,t.jsx)("p",{className:"truncate text-xs text-destructive/80",children:V?.name||V?.number||"Unknown"})]})]}),(0,t.jsx)(ec.DropdownMenuSeparator,{})]}),F&&"webrtc"===R&&(0,t.jsxs)("div",{className:"rounded-lg border border-warning/30 bg-warning/10 p-2",children:[(0,t.jsx)("p",{className:"text-xs text-warning",children:F}),(0,t.jsx)("p",{className:"mt-1 text-xs text-muted-foreground",children:"Calls will use API mode (opens in new window)"})]}),!e_&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Customer (optional)"}),(0,t.jsxs)(em.Popover,{open:A,onOpenChange:I,children:[(0,t.jsx)(em.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(el.Button,{variant:"outline",className:"h-9 w-full justify-start gap-2 px-3 font-normal",disabled:p,children:[(0,t.jsx)(es.User,{className:"h-4 w-4 shrink-0 text-muted-foreground"}),(0,t.jsx)("span",{className:"min-w-0 flex-1 truncate text-left",children:w?ew(w):"Search..."}),w&&(0,t.jsx)(P.X,{className:"h-4 w-4 shrink-0 text-muted-foreground hover:text-foreground",onClick:e=>{e.stopPropagation(),ee(null)}})]})}),(0,t.jsx)(em.PopoverContent,{align:"start",className:"w-80 p-0",sideOffset:4,children:(0,t.jsxs)(eo.Command,{shouldFilter:!1,children:[(0,t.jsx)(eo.CommandInput,{placeholder:"Name, phone, or email...",value:M,onValueChange:D}),(0,t.jsxs)(eo.CommandList,{className:"max-h-[200px]",children:[(0,t.jsx)(eo.CommandEmpty,{className:"py-4 text-center text-sm text-muted-foreground",children:"No customers found"}),(0,t.jsx)(eo.CommandGroup,{children:eT.map(e=>(0,t.jsxs)(eo.CommandItem,{value:e.id,onSelect:()=>ee(e),className:"flex cursor-pointer items-center gap-2 px-3 py-2",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"truncate text-sm font-medium",children:ew(e)}),e.phone&&(0,t.jsx)("p",{className:"truncate text-xs text-muted-foreground",children:eC(e.phone)})]}),w?.id===e.id&&(0,t.jsx)(j.Check,{className:"h-4 w-4 shrink-0 text-primary"})]},e.id))})]})]})})]})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{htmlFor:"phone-to",className:"text-xs font-medium text-muted-foreground",children:"Phone Number"}),(0,t.jsx)(ed.Input,{id:"phone-to",placeholder:"(555) 123-4567",value:g,onChange:e=>b(e.target.value),className:"h-9"})]}),(0,t.jsxs)("div",{className:"space-y-1.5",children:[(0,t.jsx)("label",{htmlFor:"phone-from",className:"text-xs font-medium text-muted-foreground",children:"Your Company Line"}),(0,t.jsxs)(eu.Select,{value:v,onValueChange:N,children:[(0,t.jsx)(eu.SelectTrigger,{id:"phone-from",className:"h-9",children:(0,t.jsx)(eu.SelectValue,{placeholder:"Select line..."})}),(0,t.jsx)(eu.SelectContent,{children:s.map(e=>(0,t.jsx)(eu.SelectItem,{value:e.number,children:e.label||eC(e.number)},e.id))})]}),0===s.length&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"No phone numbers configured"})]}),(0,t.jsx)(el.Button,{className:"w-full gap-2",disabled:!ez||d,onClick:eM,children:d?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(k.Loader2,{className:"h-4 w-4 animate-spin"}),"Starting..."]}):eE?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(q.Headphones,{className:"h-4 w-4"}),"Call (Browser Audio)"]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(Y.PhoneOutgoing,{className:"h-4 w-4"}),"Call (Opens Window)"]})})]}),(0,t.jsx)(ec.DropdownMenuSeparator,{}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(n.default,{href:"/dashboard/communication?filter=calls",onClick:()=>Z(!1),className:"flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1.5 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",children:[(0,t.jsx)(y.Clock,{className:"h-3.5 w-3.5"}),"History"]}),(0,t.jsxs)(n.default,{href:"/dashboard/communication",onClick:()=>Z(!1),className:"flex flex-1 items-center justify-center gap-1.5 rounded-md px-2 py-1.5 text-xs font-medium text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",children:[(0,t.jsx)(S.MessageSquare,{className:"h-3.5 w-3.5"}),"Messages"]})]})]})})]})}):(0,t.jsx)("button",{className:"flex h-8 w-8 items-center justify-center rounded-md border border-transparent opacity-50",disabled:!0,type:"button",children:(0,t.jsx)(T.Phone,{className:"h-4 w-4"})})}var eA=e.i(327149),eI=e.i(276389),eM=e.i(695877),eD=e.i(45834),eP=e.i(606661),eR=e.i(371526),ez=e.i(540374);let eE={Work:[{label:"New Job",href:"/dashboard/work/new",icon:eA.Briefcase,shortcut:"⌘J",description:"Create a new work order"},{label:"New Invoice",href:"/dashboard/work/invoices/new",icon:eP.FileText,shortcut:"⌘I",description:"Generate an invoice"},{label:"New Estimate",href:"/dashboard/work/estimates/new",icon:eD.FileSpreadsheet,shortcut:"⌘E",description:"Create a quote"},{label:"New Contract",href:"/dashboard/work/contracts/new",icon:eM.FileSignature,description:"Draft a service contract"}],Customers:[{label:"New Customer",href:"/dashboard/customers/new",icon:M.UserPlus,shortcut:"⌘K",description:"Add a customer"}],Finance:[{label:"Record Payment",href:"/dashboard/finance/payments/new",icon:C.DollarSign,description:"Log a payment"}],Other:[{label:"Schedule Job",href:"/dashboard/schedule/new",icon:eI.Calendar,description:"Add to schedule"},{label:"Price Book Item",href:"/dashboard/work/pricebook/new",icon:ez.Tag,description:"Add inventory item"}]};function e_(){let[e,s]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{s(!0)},[]),e)?(0,t.jsxs)(ec.DropdownMenu,{children:[(0,t.jsx)(ec.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{className:"hover-gradient hover:border-primary/20 hover:bg-primary/10 hover:text-primary focus-visible:ring-ring/50 flex h-8 w-8 items-center justify-center rounded-md border border-transparent transition-all outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50",title:"Quick Add",type:"button",children:[(0,t.jsx)(eR.Plus,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Quick Add Menu"})]})}),(0,t.jsxs)(ec.DropdownMenuContent,{align:"end",className:"w-64 rounded-lg",children:[(0,t.jsx)(ec.DropdownMenuLabel,{className:"font-semibold",children:"Quick Add"}),(0,t.jsx)(ec.DropdownMenuSeparator,{}),Object.entries(eE).map(([e,s],r)=>(0,t.jsxs)("div",{children:[r>0&&(0,t.jsx)(ec.DropdownMenuSeparator,{}),(0,t.jsx)(ec.DropdownMenuLabel,{className:"text-muted-foreground text-xs",children:e}),(0,t.jsx)(ec.DropdownMenuGroup,{children:s.map(e=>{let s=e.icon;return(0,t.jsx)(ec.DropdownMenuItem,{asChild:!0,children:(0,t.jsxs)(n.default,{className:"flex items-center gap-2",href:e.href,children:[(0,t.jsx)(s,{className:"size-4"}),(0,t.jsxs)("div",{className:"flex flex-1 flex-col",children:[(0,t.jsx)("span",{className:"text-sm",children:e.label}),e.description&&(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:e.description})]}),e.shortcut&&(0,t.jsx)(ec.DropdownMenuShortcut,{children:e.shortcut})]})},e.href)})})]},e))]})]}):(0,t.jsxs)("button",{className:"hover-gradient hover:border-primary/20 hover:bg-primary/10 hover:text-primary focus-visible:ring-ring/50 flex h-8 w-8 items-center justify-center rounded-md border border-transparent transition-all outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50",disabled:!0,title:"Quick Add",type:"button",children:[(0,t.jsx)(eR.Plus,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Quick Add Menu"})]})}var eB=e.i(552038),e$=(0,eB.createServerReference)("0043ae510c3322ea499beb9e1bb77d06afb4ef19bd",eB.callServer,void 0,eB.findSourceMapURL,"signOut"),eF=(0,eB.createServerReference)("4097c3c574342661f9a3c8244961d001234449f36f",eB.callServer,void 0,eB.findSourceMapURL,"switchCompany"),eL=(0,eB.createServerReference)("4081009dd4dff14ff4ece62648bad23a83f2f9f63c",eB.callServer,void 0,eB.findSourceMapURL,"updateUserStatus");e.i(670258);var eU=e.i(921251),eO=e.i(263942),eW=e.i(87912),eH=e.i(808529),eq=e.i(30788),eq=eq,eV=e.i(125903),eK=e.i(938965),eG=e.i(849500),eQ=e.i(81795);let eX={online:{label:"Online",color:"bg-green-500",description:"Available for work"},available:{label:"Away",color:"bg-yellow-500",description:"Temporarily unavailable"},busy:{label:"Do not disturb",color:"bg-red-500",description:"Only urgent matters"},offline:{label:"Offline",color:"bg-gray-400",description:"Appear offline"}};function eJ({user:e,teams:s,activeCompanyId:r}){let{theme:i,setTheme:o}=(0,eQ.useTheme)(),[c,d]=(0,l.useState)(!1),[u,x]=(0,l.useState)(e.status||"online"),[h,p]=(0,l.useState)(!1),[f,g]=(0,l.useState)(!1),b=s.find(e=>e.id===r)||s[0],[v,N]=(0,l.useState)(b);(0,l.useEffect)(()=>{d(!0)},[]);let y=async e=>{v?.id===e.id||(await eF(e.id)).success&&N(e)},C=async()=>{await e$()},k=async e=>{p(!0);try{(await eL(e)).success&&x(e)}finally{p(!1)}},S=(e,t)=>e?e.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):t?.substring(0,2).toUpperCase()||"U",T=eX[u];return(0,t.jsxs)(ec.DropdownMenu,{open:f,onOpenChange:g,children:[(0,t.jsx)(ec.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)("button",{className:(0,eN.cn)("flex h-8 items-center gap-2 rounded-lg px-2 transition-all duration-150","hover:bg-accent/80 focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","outline-none disabled:pointer-events-none disabled:opacity-50",f&&"bg-accent"),type:"button",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsxs)(eU.Avatar,{className:"size-6 rounded-md ring-1 ring-border/50",children:[(0,t.jsx)(eU.AvatarImage,{alt:e.name||e.email,src:e.avatar}),(0,t.jsx)(eU.AvatarFallback,{className:"rounded-md text-[10px] font-medium bg-muted",children:S(e.name,e.email)})]}),(0,t.jsx)("div",{className:(0,eN.cn)("absolute -bottom-0.5 -right-0.5 size-2.5 rounded-full ring-2 ring-background",T.color)})]}),(0,t.jsx)("span",{className:"hidden text-sm font-medium md:inline-block truncate max-w-28",children:e.name?.split(" ")[0]||e.email?.split("@")[0]||"User"}),(0,t.jsx)("span",{className:"sr-only",children:"Open user menu"})]})}),(0,t.jsxs)(ec.DropdownMenuContent,{align:"end",sideOffset:8,className:"w-80 p-0 overflow-hidden",children:[(0,t.jsx)("div",{className:"bg-muted/30 border-b border-border/50 p-4",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsxs)("div",{className:"relative shrink-0",children:[(0,t.jsxs)(eU.Avatar,{className:"size-11 rounded-xl ring-2 ring-background shadow-sm",children:[(0,t.jsx)(eU.AvatarImage,{alt:e.name||e.email,src:e.avatar}),(0,t.jsx)(eU.AvatarFallback,{className:"rounded-xl text-sm font-semibold bg-primary/10 text-primary",children:S(e.name,e.email)})]}),(0,t.jsx)("div",{className:(0,eN.cn)("absolute -bottom-0.5 -right-0.5 size-3 rounded-full ring-2 ring-background",T.color)})]}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 space-y-0.5",children:[(0,t.jsx)("p",{className:"text-sm font-semibold truncate",children:e.name||e.email?.split("@")[0]||"User"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.email}),v&&(0,t.jsxs)("p",{className:"text-xs text-muted-foreground truncate flex items-center gap-1",children:[(0,t.jsx)(eO.Building2,{className:"size-3"}),v.name]})]})]})}),(0,t.jsxs)("div",{className:"p-2 border-b border-border/50",children:[(0,t.jsx)("p",{className:"text-[11px] font-medium text-muted-foreground uppercase tracking-wider px-2 py-1.5",children:"Set Status"}),(0,t.jsx)("div",{className:"space-y-0.5",children:Object.entries(eX).map(([e,s])=>(0,t.jsxs)("button",{disabled:h,onClick:()=>k(e),className:(0,eN.cn)("flex w-full items-center gap-3 rounded-md px-2 py-2 text-sm transition-colors","hover:bg-accent disabled:opacity-50",u===e&&"bg-accent"),type:"button",children:[(0,t.jsx)("div",{className:(0,eN.cn)("size-2.5 rounded-full shrink-0",s.color)}),(0,t.jsx)("div",{className:"flex-1 text-left",children:(0,t.jsx)("span",{className:"font-medium",children:s.label})}),u===e&&(0,t.jsx)(j.Check,{className:"size-4 text-primary shrink-0"})]},e))})]}),(0,t.jsxs)("div",{className:"p-2 border-b border-border/50",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between px-2 py-1.5",children:[(0,t.jsx)("p",{className:"text-[11px] font-medium text-muted-foreground uppercase tracking-wider",children:"Workspaces"}),(0,t.jsxs)(n.default,{href:"/dashboard/welcome?new=true",className:"text-[11px] font-medium text-primary hover:underline flex items-center gap-0.5",onClick:()=>g(!1),children:[(0,t.jsx)(eR.Plus,{className:"size-3"}),"Add"]})]}),(0,t.jsx)("div",{className:"max-h-36 overflow-y-auto space-y-0.5",children:s.map(e=>{let s=v?.id===e.id;return(0,t.jsxs)("button",{onClick:()=>y(e),className:(0,eN.cn)("flex w-full items-center gap-3 rounded-md px-2 py-2 transition-colors","hover:bg-accent",s&&"bg-accent"),type:"button",children:[(0,t.jsx)("div",{className:"flex size-8 items-center justify-center rounded-lg bg-muted shrink-0",children:e.logo?(0,t.jsx)(a.default,{src:e.logo,alt:e.name,width:20,height:20,className:"size-5 object-contain"}):(0,t.jsx)(eO.Building2,{className:"size-4 text-muted-foreground"})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0 text-left",children:[(0,t.jsx)("p",{className:(0,eN.cn)("text-sm truncate",s&&"font-medium"),children:e.name}),(0,t.jsx)("div",{className:"flex items-center gap-1.5",children:!1===e.onboardingComplete?(0,t.jsx)("span",{className:"text-[10px] text-amber-600 dark:text-amber-400",children:"Setup required"}):(0,t.jsx)("span",{className:"text-[10px] text-muted-foreground capitalize",children:e.plan})})]}),s&&(0,t.jsx)("div",{className:"size-1.5 rounded-full bg-primary shrink-0"})]},e.id)})})]}),(0,t.jsxs)("div",{className:"p-2 border-b border-border/50",children:[(0,t.jsx)(eY,{href:"/dashboard/settings/profile/personal",icon:es.User,label:"Profile & Account",shortcut:"⇧⌘P",onClick:()=>g(!1)}),(0,t.jsx)(eY,{href:"/dashboard/settings/billing",icon:w.CreditCard,label:"Plans & Billing",onClick:()=>g(!1)}),(0,t.jsx)(eY,{href:"/dashboard/settings",icon:A.Settings,label:"Settings",shortcut:"⌘,",onClick:()=>g(!1)})]}),(0,t.jsxs)("div",{className:"p-2 border-b border-border/50",children:[(0,t.jsx)("p",{className:"text-[11px] font-medium text-muted-foreground uppercase tracking-wider px-2 py-1.5",children:"Appearance"}),(0,t.jsx)("div",{className:"px-2 py-1",children:(0,t.jsx)("div",{className:"flex items-center gap-1 p-0.5 rounded-lg bg-muted/50",children:[{value:"light",icon:eG.Sun,label:"Light"},{value:"dark",icon:eK.Moon,label:"Dark"},{value:"system",icon:eV.Monitor,label:"System"}].map(e=>{let s=e.icon,r=(c?"light"===i?"light":"dark"===i?"dark":"system":"system")===e.value;return(0,t.jsxs)("button",{disabled:!c,onClick:()=>o(e.value),className:(0,eN.cn)("flex flex-1 items-center justify-center gap-1.5 rounded-md px-3 py-1.5 text-xs font-medium transition-all",r?"bg-background text-foreground shadow-sm":"text-muted-foreground hover:text-foreground"),type:"button",children:[(0,t.jsx)(s,{className:"size-3.5"}),e.label]},e.value)})})})]}),(0,t.jsxs)("div",{className:"p-2 border-b border-border/50",children:[(0,t.jsx)(eY,{href:"/help",icon:m.HelpCircle,label:"Help & Support",external:!0,onClick:()=>g(!1)}),(0,t.jsx)(eY,{href:"/dashboard/settings/shortcuts",icon:eH.Keyboard,label:"Keyboard Shortcuts",shortcut:"⌘/",onClick:()=>g(!1)})]}),(0,t.jsx)("div",{className:"p-2",children:(0,t.jsxs)("button",{onClick:C,className:(0,eN.cn)("flex w-full items-center gap-3 rounded-md px-2 py-2 text-sm transition-colors","text-muted-foreground hover:bg-destructive/10 hover:text-destructive"),type:"button",children:[(0,t.jsx)(eq.default,{className:"size-4"}),(0,t.jsx)("span",{children:"Sign out"}),(0,t.jsx)("kbd",{className:"ml-auto hidden sm:inline-flex h-5 items-center rounded border border-border/50 bg-muted/50 px-1.5 font-mono text-[10px] text-muted-foreground",children:"⇧⌘Q"})]})})]})]})}function eY({href:e,icon:s,label:r,shortcut:a,external:i,onClick:l}){return(0,t.jsxs)(n.default,{href:e,onClick:l,className:(0,eN.cn)("flex items-center gap-3 rounded-md px-2 py-2 text-sm transition-colors","text-foreground/80 hover:bg-accent hover:text-foreground"),...i&&{target:"_blank",rel:"noopener noreferrer"},children:[(0,t.jsx)(s,{className:"size-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"flex-1",children:r}),a&&(0,t.jsx)("kbd",{className:"hidden sm:inline-flex h-5 items-center rounded border border-border/50 bg-muted/50 px-1.5 font-mono text-[10px] text-muted-foreground",children:a}),i&&(0,t.jsx)(eW.ChevronRight,{className:"size-3.5 text-muted-foreground"})]})}var eZ=e.i(169741);e.i(254978);var e0=e.i(375308);e.i(287133);var e1=e.i(120109),e5=e.i(710575),e2=e.i(751139),e4=e.i(559586),e3=(0,eB.createServerReference)("40e9589cb639f2902eb841bedc1247d966486d6fd7",eB.callServer,void 0,eB.findSourceMapURL,"getCompanyPendingActions"),e6=e.i(964907);let e9={low:"bg-blue-500",medium:"bg-yellow-500",high:"bg-orange-500",critical:"bg-red-500"},e8={send_communication:e4.Mail,financial:C.DollarSign,scheduling:eI.Calendar,customer:es.User};function e7({className:e,showPopover:s=!0,onActionClick:r}){let[a,n]=(0,l.useState)([]),[i,o]=(0,l.useState)(!1),[c,d]=(0,l.useState)(!0);if((0,l.useEffect)(()=>{let e=async()=>{d(!0);try{let[e,t]=await Promise.all([(0,e6.checkIsCompanyOwner)(),e3({status:"pending",limit:10})]);e.success&&e.data&&o(e.data),t.success&&t.data&&n(t.data)}catch(e){console.error("Failed to fetch pending actions:",e)}finally{d(!1)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[]),!i||0===a.length)return null;let m=a.filter(e=>"critical"===e.riskLevel).length,u=a.filter(e=>"high"===e.riskLevel).length,x=(0,t.jsx)("div",{className:(0,eN.cn)("relative inline-flex",e),children:(0,t.jsxs)(el.Button,{variant:"ghost",size:"icon",className:"relative h-9 w-9",children:[(0,t.jsx)(e5.Shield,{className:"h-5 w-5"}),(0,t.jsx)("span",{className:(0,eN.cn)("absolute -top-1 -right-1 flex h-5 w-5 items-center justify-center rounded-full text-[10px] font-bold text-white",m>0?"bg-red-500":u>0?"bg-orange-500":"bg-yellow-500"),children:a.length})]})});return s?(0,t.jsxs)(em.Popover,{children:[(0,t.jsx)(em.PopoverTrigger,{asChild:!0,children:x}),(0,t.jsxs)(em.PopoverContent,{className:"w-80 p-0",align:"end",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 border-b",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(e5.Shield,{className:"h-4 w-4 text-primary"}),(0,t.jsx)("span",{className:"font-semibold text-sm",children:"Pending Approvals"})]}),(0,t.jsx)(ei.Badge,{variant:"secondary",children:a.length})]}),(0,t.jsx)(e0.ScrollArea,{className:"max-h-[300px]",children:(0,t.jsx)("div",{className:"divide-y",children:a.map(e=>{let s=e8[e.actionType]||e2.AlertTriangle;return(0,t.jsx)("button",{className:"w-full p-3 text-left hover:bg-muted/50 transition-colors",onClick:()=>r?.(e),children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:(0,eN.cn)("rounded-full p-1.5",e9[e.riskLevel]+"/10"),children:(0,t.jsx)(s,{className:(0,eN.cn)("h-4 w-4",e9[e.riskLevel].replace("bg-","text-"))})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm font-medium truncate",children:e.toolName.replace(/([A-Z])/g," $1").replace(/^./,e=>e.toUpperCase())}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.affectedEntityType.replace(/_/g," ")}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(ei.Badge,{variant:"outline",className:(0,eN.cn)("text-[10px] px-1.5 py-0",e9[e.riskLevel].replace("bg-","border-"),e9[e.riskLevel].replace("bg-","text-")),children:e.riskLevel}),(0,t.jsxs)("span",{className:"flex items-center gap-1 text-[10px] text-muted-foreground",children:[(0,t.jsx)(y.Clock,{className:"h-3 w-3"}),function(e){let t=new Date,s=new Date(e).getTime()-t.getTime();if(s<=0)return"Expired";let r=Math.floor(s/36e5),a=Math.floor(s%36e5/6e4);return r>0?`${r}h ${a}m`:`${a}m`}(e.expiresAt)]})]})]})]})},e.id)})})}),a.length>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e1.Separator,{}),(0,t.jsx)("div",{className:"p-2",children:(0,t.jsx)(el.Button,{variant:"ghost",size:"sm",className:"w-full text-xs",onClick:()=>{window.location.href="/dashboard/settings/ai"},children:"View All Pending Actions"})})]})]})]}):x}let te=[{label:"Ask Thorbis",href:"/dashboard/ai",status:"beta",isSpecial:!0,mobileIcon:"AI",mobileIconBg:"bg-primary/10",mobileIconColor:"text-primary"},{label:"Today",href:"/dashboard",mobileIcon:"T",mobileIconBg:"bg-primary/10",mobileIconColor:"text-primary"},{label:"Schedule",href:"/dashboard/schedule",mobileIcon:"S",mobileIconBg:"bg-accent/10",mobileIconColor:"text-accent-foreground"},{label:"Communication",href:"/dashboard/communication",mobileIcon:"C",mobileIconBg:"bg-success/10",mobileIconColor:"text-success"},{label:"Work",href:"/dashboard/work",status:"beta",mobileIcon:"W",mobileIconBg:"bg-teal-500/10",mobileIconColor:"text-teal-600"},{label:"Finances",href:"/dashboard/finance",status:"coming-soon",mobileIcon:"F",mobileIconBg:"bg-emerald-500/10",mobileIconColor:"text-emerald-600"},{label:"Reporting",href:"/dashboard/reporting",status:"coming-soon",mobileIcon:"R",mobileIconBg:"bg-primary/10",mobileIconColor:"text-primary"},{label:"Marketing",href:"/dashboard/marketing",status:"coming-soon",mobileIcon:"M",mobileIconBg:"bg-accent/10",mobileIconColor:"text-accent-foreground"},{label:"Training",href:"/dashboard/training",status:"coming-soon",mobileIcon:"T",mobileIconBg:"bg-accent/10",mobileIconColor:"text-accent-foreground"}];function tt({status:e}){return e?"beta"===e?(0,t.jsx)("span",{className:"absolute -top-1.5 right-0 rounded bg-blue-500 px-1 py-0.5 text-[0.5rem] leading-none font-semibold tracking-wide text-white uppercase shadow-sm",children:"Beta"}):"coming-soon"===e?(0,t.jsx)("span",{className:"absolute -top-1.5 right-0 rounded bg-purple-500 px-1 py-0.5 text-[0.5rem] leading-none font-semibold tracking-wide whitespace-nowrap text-white uppercase shadow-sm",children:"Soon"}):"new"===e?(0,t.jsx)("span",{className:"absolute -top-1.5 right-0 rounded bg-green-500 px-1 py-0.5 text-[0.5rem] leading-none font-semibold tracking-wide text-white uppercase shadow-sm",children:"New"}):(0,t.jsx)("span",{className:"absolute -top-1 right-0 size-2 rounded-full bg-blue-500 shadow-sm",title:"Updated"}):null}function ts({count:e}){return 0===e?null:(0,t.jsx)("span",{className:"absolute -top-1.5 right-0 rounded bg-red-500 px-1 py-0.5 text-[0.5rem] leading-none font-semibold tracking-wide text-white shadow-sm whitespace-nowrap",children:e<=9?e.toString():e<=99?"99+":e<=999?"999+":"1K+"})}function tr({userProfile:e,companies:s,activeCompanyId:c,customers:d=[],companyPhones:m=[],hasPhoneNumbers:u=!1,hasPayrixAccount:x=!1,payrixStatus:h=null,subHeader:p}){let g,b,j,v=(0,i.usePathname)(),N="/dashboard/tv"===v;g=(0,o.useDialerStore)(e=>e.openDialer),b=(0,o.useDialerStore)(e=>e.closeDialer),j=(0,o.useDialerStore)(e=>e.isOpen),(0,l.useEffect)(()=>{let e=e=>{(e.ctrlKey||e.metaKey)&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),j?b():g())};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}},[g,b,j]);let[y,w]=(0,l.useState)(0);return((0,l.useEffect)(()=>{let e=async()=>{try{let e=await (0,eZ.getTotalUnreadCountAction)();e.success&&void 0!==e.count&&w(e.count)}catch(e){console.error("Failed to fetch unread count:",e)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[v]),N)?null:(0,t.jsx)(t.Fragment,{children:(0,t.jsx)("header",{className:"safe-top bg-header-bg sticky top-0 z-50 w-full",children:(0,t.jsxs)("div",{className:"flex h-14 items-center gap-2 px-4 md:px-6",children:[(0,t.jsxs)(n.default,{className:"hover:border-primary/20 hover:bg-primary/10 hover:text-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:border-destructive aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 dark:hover:bg-accent/50 flex shrink-0 items-center justify-center gap-2 rounded-md text-sm font-medium whitespace-nowrap transition-all outline-none focus-visible:ring-[3px] disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 size-10 md:size-8","data-slot":"button",href:"/",children:[(0,t.jsx)(a.default,{alt:"Thorbis",className:"size-5",height:20,src:"/ThorbisLogo.webp",width:20}),(0,t.jsx)("span",{className:"sr-only",children:"Thorbis"})]}),(0,t.jsx)("nav",{className:"hidden items-center gap-0.5 ml-2 lg:flex",children:te.map(e=>{let s="/dashboard"===e.href?"/dashboard"===v:v?.startsWith(e.href);return e.isSpecial?(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(n.default,{className:`focus-visible:ring-ring/50 relative inline-flex h-8 shrink-0 items-center justify-center gap-1.5 rounded-md px-3 text-sm font-medium whitespace-nowrap transition-all duration-150 outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 ${s?"bg-primary/15 text-primary dark:bg-primary/25 shadow-sm":"text-muted-foreground hover:bg-muted/70 hover:text-foreground"}`,"data-slot":"button",href:e.href,children:e.label}),(0,t.jsx)(tt,{status:e.status})]},e.href):(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(n.default,{className:`focus-visible:ring-ring/50 relative inline-flex h-8 shrink-0 items-center justify-center gap-1.5 rounded-md px-3 text-sm font-medium whitespace-nowrap transition-all duration-150 outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 ${s?"bg-primary/15 text-primary dark:bg-primary/25 shadow-sm":"text-muted-foreground hover:bg-muted/70 hover:text-foreground"}`,"data-slot":"button",href:e.href,children:e.label}),(0,t.jsx)(tt,{status:e.status}),"/dashboard/communication"===e.href&&(0,t.jsx)(ts,{count:y})]},e.href)})}),(0,t.jsxs)("div",{className:"ml-auto flex items-center gap-2 overflow-visible md:flex-1 md:justify-end",children:[(0,t.jsx)(e_,{}),(0,t.jsx)(eT,{companyId:c||"",companyPhones:m}),(0,t.jsx)(n.default,{href:"/dashboard/tv",title:"TV Display",children:(0,t.jsxs)("button",{className:"hover-gradient hover:border-primary/20 hover:bg-primary/10 hover:text-primary focus-visible:ring-ring/50 flex items-center justify-center rounded-md border border-transparent transition-all outline-none focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 size-10 md:size-8",type:"button",children:[(0,t.jsx)(r.default,{className:"size-4"}),(0,t.jsx)("span",{className:"sr-only",children:"TV Display"})]})}),(0,t.jsx)(e7,{}),(0,t.jsx)(H,{hasPhoneNumbers:u,hasPayrixAccount:x,payrixStatus:h}),(0,t.jsx)(f,{}),(0,t.jsx)(eJ,{activeCompanyId:c,teams:Array.from(new Map(s.map(e=>[e.id,{id:e.id,name:e.name,logo:e.logo,plan:e.plan,onboardingComplete:e.onboardingComplete,hasPayment:e.hasPayment}])).values()),user:{name:e.name,email:e.email,avatar:e.avatar,status:e.status}})]})]})})})}s.default,e.s(["AppHeaderClient",()=>tr],26972)},623112,e=>{"use strict";var t=e.i(111043),s=e.i(818796),r=e.i(160424),a=e.i(970799);e.i(889265);var n=e.i(677607);class i extends a.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("AppHeader Error:",e,t)}handleReset=()=>{this.setState({hasError:!1,error:null}),window.location.reload()};render(){return this.state.hasError?(0,t.jsx)(l,{onReset:this.handleReset}):this.props.children}}function l({onReset:e}){return(0,t.jsx)("header",{className:"border-border/40 bg-background/95 supports-[backdrop-filter]:bg-background/60 sticky top-0 z-50 w-full border-b backdrop-blur",children:(0,t.jsxs)("div",{className:"flex h-14 items-center justify-between px-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"bg-destructive/10 flex h-8 w-8 items-center justify-center rounded-md",children:(0,t.jsx)(s.AlertCircle,{className:"text-destructive h-4 w-4","aria-hidden":"true"})}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("span",{className:"text-sm font-medium",children:"Unable to load header"}),(0,t.jsx)("span",{className:"text-muted-foreground text-xs hidden sm:inline",children:"An error occurred while loading the navigation"})]})]}),(0,t.jsxs)(n.Button,{variant:"outline",size:"sm",onClick:e,className:"gap-2","aria-label":"Retry loading header",children:[(0,t.jsx)(r.RefreshCw,{className:"h-3.5 w-3.5","aria-hidden":"true"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Retry"})]})]})})}e.s(["AppHeaderErrorBoundary",()=>i])},439641,e=>{"use strict";var t=e.i(111043),s=e.i(702948),r=e.i(970799);let a=(0,s.default)(()=>e.A(653908).then(e=>e.IncomingCallNotification),{loadableGenerated:{modules:[809423]},loading:()=>null,ssr:!1});function n(){return(0,t.jsx)(r.Suspense,{fallback:null,children:(0,t.jsx)(a,{})})}e.s(["IncomingCallNotificationWrapper",()=>n])},403400,e=>{"use strict";var t=e.i(111043),s=e.i(970799),r=e.i(904653),a=e.i(169741),n=e.i(276389),i=e.i(201710),l=e.i(747146),o=e.i(38614),c=e.i(327149),d=e.i(212409),m=e.i(142642),u=e.i(982686),x=e.i(935682),h=e.i(639708),p=e.i(607384),f=e.i(121085),g=e.i(288413),b=e.i(87912),j=e.i(176378),v=e.i(498440);let N=[{label:"Ask Thorbis",href:"/dashboard/ai",icon:m.Sparkles,status:"beta",iconBg:"bg-primary/10",iconColor:"text-primary",description:"AI-powered assistant"},{label:"Finances",href:"/dashboard/finance",icon:u.DollarSign,status:"coming-soon",iconBg:"bg-emerald-500/10",iconColor:"text-emerald-600",description:"Financial management"},{label:"Reporting",href:"/dashboard/reporting",icon:x.BarChart3,status:"coming-soon",iconBg:"bg-primary/10",iconColor:"text-primary",description:"Analytics and reports"},{label:"Marketing",href:"/dashboard/marketing",icon:h.Megaphone,status:"coming-soon",iconBg:"bg-accent/10",iconColor:"text-accent-foreground",description:"Marketing campaigns"},{label:"Training",href:"/dashboard/training",icon:p.GraduationCap,status:"coming-soon",iconBg:"bg-accent/10",iconColor:"text-accent-foreground",description:"Learning center"},{label:"Settings",href:"/dashboard/settings",icon:f.Settings,iconBg:"bg-muted/50",iconColor:"text-muted-foreground",description:"App preferences"},{label:"Help",href:"/help",icon:g.HelpCircle,iconBg:"bg-muted/50",iconColor:"text-muted-foreground",description:"Get support"}];function y({status:e}){return e?(0,t.jsx)("span",{className:`inline-flex items-center rounded-full px-2 py-0.5 text-[0.65rem] font-semibold tracking-wide uppercase ${{beta:"bg-blue-500 text-white",new:"bg-green-500 text-white",updated:"bg-purple-500 text-white","coming-soon":"bg-purple-500 text-white"}[e]}`,children:{beta:"Beta",new:"New",updated:"Updated","coming-soon":"Soon"}[e]}):null}function w({unreadCount:e=0}){let a=(0,r.usePathname)(),[m,u]=(0,s.useState)(!1),x="/dashboard/tv"===a,h="/welcome"===a;if(x||h)return null;let p=[{label:"Today",href:"/dashboard",icon:i.Home},{label:"Messages",href:"/dashboard/communication/mobile",icon:l.MessageSquare,badge:e},{label:"Work",href:"/dashboard/work/mobile",icon:c.Briefcase},{label:"Schedule",href:"/dashboard/schedule",icon:n.Calendar},{label:"More",icon:o.MoreHorizontal,onClick:()=>u(!0)}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("nav",{className:"safe-bottom bg-background fixed bottom-0 left-0 right-0 z-40 border-t border-border lg:hidden",children:(0,t.jsx)("div",{className:"grid h-16 grid-cols-5",children:p.map(e=>{let s=!1;e.href&&(s="/dashboard"===e.href?"/dashboard"===a:"/dashboard/communication/mobile"===e.href?a?.startsWith("/dashboard/communication"):"/dashboard/work/mobile"===e.href?a?.startsWith("/dashboard/work")||a?.startsWith("/dashboard/customers"):a?.startsWith(e.href));let r=e.icon;return e.onClick?(0,t.jsxs)("button",{className:`flex flex-col items-center justify-center gap-1 transition-colors ${m?"text-primary":"text-muted-foreground hover:text-foreground active:text-primary"}`,onClick:e.onClick,type:"button","aria-label":"Open more menu","aria-expanded":m,children:[(0,t.jsx)("div",{className:"relative",children:(0,t.jsx)(r,{className:"h-6 w-6"})}),(0,t.jsx)("span",{className:"text-[0.65rem] font-medium leading-tight",children:e.label})]},e.label):(0,t.jsxs)(j.default,{className:`flex flex-col items-center justify-center gap-1 transition-colors ${s?"text-primary":"text-muted-foreground hover:text-foreground active:text-primary"}`,href:e.href,children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(r,{className:"h-6 w-6"}),"number"==typeof e.badge&&e.badge>0&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("span",{className:"absolute top-0 right-0 flex h-2 w-2",children:[(0,t.jsx)("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-red-400 opacity-75"}),(0,t.jsx)("span",{className:"relative inline-flex rounded-full h-2 w-2 bg-red-500"})]}),(0,t.jsxs)("span",{className:"sr-only",children:[e.badge," unread ",1===e.badge?"message":"messages"]})]}),s&&(0,t.jsx)("div",{className:"absolute -bottom-1.5 left-1/2 h-1 w-1 -translate-x-1/2 rounded-full bg-primary"})]}),(0,t.jsx)("span",{className:"text-[0.65rem] font-medium leading-tight",children:e.label})]},e.label)})})}),(0,t.jsx)(v.Root,{open:m,onOpenChange:u,children:(0,t.jsxs)(v.Portal,{children:[(0,t.jsx)(v.Overlay,{className:"fixed inset-0 z-50 bg-background/95 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 lg:hidden"}),(0,t.jsxs)(v.Content,{className:"fixed inset-0 z-50 flex flex-col bg-background lg:hidden data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",children:[(0,t.jsx)("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur-sm border-b border-border",children:(0,t.jsxs)("div",{className:"flex items-center justify-between px-4 h-14",children:[(0,t.jsx)(v.Title,{className:"text-lg font-bold tracking-tight",children:"More"}),(0,t.jsx)(v.Close,{className:"flex h-10 w-10 items-center justify-center rounded-full hover:bg-accent/80 transition-colors active:scale-95","aria-label":"Close menu",children:(0,t.jsx)(d.X,{className:"h-6 w-6"})})]})}),(0,t.jsx)("div",{className:"h-[calc(100vh-3.5rem)] overflow-y-auto px-4 py-6",children:(0,t.jsx)("div",{className:"space-y-3 pb-safe",children:N.map(e=>{let s=a?.startsWith(e.href),r=e.icon;return(0,t.jsxs)(j.default,{className:`group flex items-center gap-4 rounded-2xl border-2 p-5 transition-all duration-200 active:scale-[0.98] ${s?"border-primary/40 bg-primary/10 text-primary shadow-lg shadow-primary/20":"border-border bg-card text-card-foreground hover:border-primary/30 hover:bg-primary/5 hover:shadow-md"}`,href:e.href,onClick:()=>u(!1),children:[(0,t.jsx)("div",{className:`flex h-14 w-14 shrink-0 items-center justify-center rounded-xl transition-all duration-200 ${e.iconBg} ${s?"scale-105":"group-hover:scale-105"}`,children:(0,t.jsx)(r,{className:`h-7 w-7 ${e.iconColor}`})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,t.jsx)("span",{className:"font-semibold text-base",children:e.label}),e.status&&(0,t.jsx)(y,{status:e.status})]}),e.description&&(0,t.jsx)("p",{className:"text-muted-foreground text-sm leading-snug",children:e.description})]}),(0,t.jsx)(b.ChevronRight,{className:`h-5 w-5 text-muted-foreground/50 transition-all ${s?"text-primary":"group-hover:translate-x-1"}`})]},e.href)})})})]})]})})]})}function C(){let e=(0,r.usePathname)(),[n,i]=(0,s.useState)(0);return(0,s.useEffect)(()=>{let e=async()=>{try{let e=await (0,a.getTotalUnreadCountAction)();e.success&&void 0!==e.count&&i(e.count)}catch(e){console.error("Failed to fetch unread count:",e)}};e();let t=setInterval(e,3e4);return()=>clearInterval(t)},[e]),(0,t.jsx)(w,{unreadCount:n})}e.s(["MobileBottomTabsWrapper",()=>C],403400)},626565,e=>{"use strict";var t=e.i(970799),s=e.i(834997),r=e.i(430063),a=e.i(830891);let n="communication_desktop_prompted";function i(){let e=(0,r.useNotificationsStore)(e=>e.subscribe),i=(0,r.useNotificationsStore)(e=>e.unsubscribe),l=(0,s.useCommunicationNotificationsStore)(e=>e.requestDesktopNotificationPermission),o=(0,s.useCommunicationNotificationsStore)(e=>e.desktopNotificationsEnabled),c=(0,s.useCommunicationNotificationsStore)(e=>e.setDesktopNotificationsEnabled),d=(0,t.useRef)(!1);return(0,t.useEffect)(()=>{if(d.current)return;d.current=!0;let t=!1,s=(0,a.createClient)();return(async()=>{if(!s)return;let{data:{user:r}}=await s.auth.getUser();r&&!t&&await e(r.id)})(),()=>{t=!0,i()}},[e,i]),(0,t.useEffect)(()=>{if(!("Notification"in window))return;let e="true"===window.localStorage.getItem(n),t=e=>{window.localStorage.setItem(n,"true"),!e&&o&&c(!1)};if("granted"===Notification.permission){e||window.localStorage.setItem(n,"true");return}if("denied"===Notification.permission){e||window.localStorage.setItem(n,"true"),o&&c(!1);return}if(e)return;let s=window.setTimeout(()=>{l().then(e=>t(e)).catch(()=>t(!1))},1500);return()=>window.clearTimeout(s)},[o,l,c]),null}e.s(["NotificationsInitializer",()=>i])},824039,e=>{"use strict";var t=e.i(111043),s=e.i(970799),r=e.i(552038),a=(0,r.createServerReference)("000f90f949d6a2f5484d061d5a738a59a8c846aeaa",r.callServer,void 0,r.findSourceMapURL,"getPendingSupportSessions"),n=(0,r.createServerReference)("00665c1bbcd52d612d5bb4bf3be5e7fc75554132e6",r.callServer,void 0,r.findSourceMapURL,"getActiveSupportSessions");e.i(539870);var i=e.i(846358);e.i(889265);var l=e.i(677607);e.i(868198);var o=e.i(798764),c=e.i(710575),d=e.i(136764),m=e.i(14435),u=e.i(586322),u=u,x=e.i(818796),h=(0,r.createServerReference)("602e89ae7ace85fc30cd3b4b1dd865d517c0cb1cd5",r.callServer,void 0,r.findSourceMapURL,"approveSupportSessionRequest"),p=(0,r.createServerReference)("60886af124323873afd4d5b64bb4143abbcba2c154",r.callServer,void 0,r.findSourceMapURL,"rejectSupportSessionRequest"),f=e.i(995403);function g({session:e,open:r,onOpenChange:a,onApproved:n,onRejected:g}){let[b,j]=(0,s.useState)(!1),[v,N]=(0,s.useState)(!1),[y,w]=(0,s.useState)("60");if(!e)return null;let C=async()=>{j(!0);try{let t=await h(e.id,parseInt(y));t.success?(f.toast.success("Support access approved",{description:`Access granted for ${y} minutes`}),a(!1),n?.()):f.toast.error("Failed to approve access",{description:t.error||"Please try again"})}catch(e){f.toast.error("Error approving access"),console.error(e)}finally{j(!1)}},k=async()=>{N(!0);try{let t=await p(e.id,"Declined by customer");t.success?(f.toast.success("Support access denied"),a(!1),g?.()):f.toast.error("Failed to deny access",{description:t.error||"Please try again"})}catch(e){f.toast.error("Error denying access"),console.error(e)}finally{N(!1)}},S={view:"View your account data",edit_jobs:"Modify jobs",edit_invoices:"Modify invoices",edit_payments:"Manage payments",refund:"Issue refunds",edit_team:"Manage team members",reset_password:"Reset passwords",edit_company:"Update company settings"};return(0,t.jsx)(i.Dialog,{open:r,onOpenChange:a,children:(0,t.jsxs)(i.DialogContent,{className:"sm:max-w-[500px]",children:[(0,t.jsxs)(i.DialogHeader,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("div",{className:"rounded-full bg-orange-100 dark:bg-orange-900/20 p-2",children:(0,t.jsx)(c.Shield,{className:"h-5 w-5 text-orange-600"})}),(0,t.jsx)(i.DialogTitle,{children:"Support Access Request"})]}),(0,t.jsx)(i.DialogDescription,{children:"A support team member is requesting access to your account to assist you."})]}),(0,t.jsxs)("div",{className:"space-y-4 py-4",children:[(0,t.jsxs)("div",{className:"rounded-lg border bg-muted/50 p-4 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.User,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsx)("span",{className:"text-sm font-medium",children:"Support Representative"})]}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:e.admin_name||e.admin_email||e.admin_user_id}),e.ticket_id&&(0,t.jsxs)("div",{className:"flex items-center gap-2 pt-2 border-t",children:[(0,t.jsx)(u.default,{className:"h-4 w-4 text-muted-foreground"}),(0,t.jsxs)("span",{className:"text-sm",children:["Ticket: ",(0,t.jsx)("span",{className:"font-mono",children:e.ticket_id})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Reason for Access"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground rounded-md border p-3 bg-muted/30",children:e.reason})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Requested Permissions"}),(0,t.jsx)("div",{className:"space-y-1",children:e.requested_permissions.map(e=>(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-orange-500"}),(0,t.jsx)("span",{children:S[e]||e})]},e))})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsxs)("label",{className:"text-sm font-medium flex items-center gap-2",children:[(0,t.jsx)(d.Clock,{className:"h-4 w-4"}),"Access Duration"]}),(0,t.jsxs)(o.Select,{value:y,onValueChange:w,children:[(0,t.jsx)(o.SelectTrigger,{children:(0,t.jsx)(o.SelectValue,{})}),(0,t.jsxs)(o.SelectContent,{children:[(0,t.jsx)(o.SelectItem,{value:"30",children:"30 minutes"}),(0,t.jsx)(o.SelectItem,{value:"60",children:"1 hour (recommended)"}),(0,t.jsx)(o.SelectItem,{value:"120",children:"2 hours"}),(0,t.jsx)(o.SelectItem,{value:"240",children:"4 hours"})]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Support access will automatically expire after this time."})]}),(0,t.jsx)("div",{className:"rounded-lg border border-orange-200 dark:border-orange-800 bg-orange-50 dark:bg-orange-950/20 p-3 space-y-1",children:(0,t.jsxs)("div",{className:"flex items-start gap-2",children:[(0,t.jsx)(x.AlertCircle,{className:"h-4 w-4 text-orange-600 mt-0.5 flex-shrink-0"}),(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-xs font-medium text-orange-900 dark:text-orange-100",children:"Security Notice"}),(0,t.jsx)("p",{className:"text-xs text-orange-800 dark:text-orange-200",children:"All actions taken by support will be logged and visible in your account audit trail."})]})]})})]}),(0,t.jsxs)(i.DialogFooter,{className:"flex-col sm:flex-row gap-2",children:[(0,t.jsx)(l.Button,{type:"button",variant:"outline",onClick:k,disabled:b||v,className:"w-full sm:w-auto",children:v?"Denying...":"Deny Access"}),(0,t.jsx)(l.Button,{type:"button",onClick:C,disabled:b||v,className:"w-full sm:w-auto bg-orange-600 hover:bg-orange-700",children:b?"Approving...":`Approve for ${"60"===y?"1 hour":"30"===y?"30 min":"120"===y?"2 hours":"4 hours"}`})]})]})})}var b=e.i(212409),j=e.i(969098),v=(0,r.createServerReference)("40369e8ea4eced7bdaef8203d369469ee7b630db8c",r.callServer,void 0,r.findSourceMapURL,"endActiveSupportSession"),N=e.i(176378);function y({session:e,onSessionEnded:r}){let a,n,[i,o]=(0,s.useState)(""),[m,u]=(0,s.useState)(!1),[x,h]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let t=()=>{let t=new Date,s=new Date(e.expires_at).getTime()-t.getTime();if(s<=0){o("Expired"),h(!0);return}let r=Math.floor(s/1e3/60),a=Math.floor(s/1e3%60);r>0?o(`${r}:${a.toString().padStart(2,"0")}`):o(`${a}s`)};t();let s=setInterval(t,1e3);return()=>clearInterval(s)},[e.expires_at]);let p=async()=>{if(confirm("Are you sure you want to end support access?")){u(!0);try{let t=await v(e.id);t.success?(f.toast.success("Support access ended"),r?.()):f.toast.error("Failed to end access",{description:t.error})}catch(e){f.toast.error("Error ending support access"),console.error(e)}finally{u(!1)}}};return x?null:(0,t.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-gradient-to-r from-orange-500 to-orange-600 dark:from-orange-600 dark:to-orange-700 text-white shadow-lg",children:(0,t.jsx)("div",{className:"container mx-auto px-4 py-2",children:(0,t.jsxs)("div",{className:"flex items-center justify-between gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"rounded-full bg-white/20 p-1.5",children:(0,t.jsx)(c.Shield,{className:"h-4 w-4"})}),(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[(0,t.jsx)("span",{className:"font-medium",children:"Support Access Active"}),(0,t.jsx)("span",{className:"opacity-90",children:"•"}),(0,t.jsx)("span",{className:"opacity-90",children:e.admin_name||e.admin_email||"Support Team"}),e.ticket_id&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"opacity-90",children:"•"}),(0,t.jsxs)("span",{className:"opacity-90",children:["Ticket: ",e.ticket_id]})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-sm",children:[(0,t.jsx)(d.Clock,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{className:`font-mono font-medium ${(a=new Date,(n=(new Date(e.expires_at).getTime()-a.getTime())/1e3/60)<=5?"text-red-600 dark:text-red-400":n<=10?"text-yellow-600 dark:text-yellow-400":"text-green-600 dark:text-green-400")}`,children:i}),(0,t.jsx)("span",{className:"opacity-90 text-xs",children:"remaining"})]}),(0,t.jsx)(N.default,{href:"/dashboard/settings/support-activity",className:"hidden sm:flex",children:(0,t.jsxs)(l.Button,{variant:"ghost",size:"sm",className:"h-7 gap-1.5 text-white hover:bg-white/20",children:[(0,t.jsx)(j.ExternalLink,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{className:"text-xs",children:"View Activity"})]})}),(0,t.jsxs)(l.Button,{variant:"ghost",size:"sm",onClick:p,disabled:m,className:"h-7 gap-1.5 text-white hover:bg-white/20 border border-white/30",children:[(0,t.jsx)(b.X,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{className:"text-xs",children:m?"Ending...":"End Access"})]})]})]})})})}var w=e.i(830891),C=e.i(982686),k=e.i(202724),S=e.i(606661),T=e.i(327149);function A(){let e=(0,s.useRef)(null),r=(0,s.useRef)(!1);return(0,s.useEffect)(()=>{let s=async()=>{if(!r.current){r.current=!0;try{let s=(0,w.createClient)(),{data:{user:r}}=await s.auth.getUser();if(!r)return;let{data:a}=await s.from("team_members").select("company_id").eq("user_id",r.id).single();if(!a)return;let{data:n}=await s.from("support_sessions").select("id").eq("company_id",a.company_id).eq("status","active");if(!n||0===n.length)return;let i=n.map(e=>e.id),l=s.from("support_session_actions").select("id, action, resource_type, resource_id, reason, created_at, session_id").in("session_id",i).order("created_at",{ascending:!1}).limit(10);e.current&&(l=l.gt("created_at",e.current));let{data:o}=await l;o&&o.length>0&&(e.current=o[0].created_at,o.reverse().forEach(e=>{var s,r;let a,n,i,l,o;s=e,l=function(e){switch(e){case"payment":return(0,t.jsx)(C.DollarSign,{className:"h-4 w-4"});case"invoice":return(0,t.jsx)(S.FileText,{className:"h-4 w-4"});case"job":return(0,t.jsx)(T.Briefcase,{className:"h-4 w-4"});case"team":return(0,t.jsx)(k.Users,{className:"h-4 w-4"});default:return(0,t.jsx)(c.Shield,{className:"h-4 w-4"})}}(s.resource_type),o=(a=(r=s).resource_type.charAt(0).toUpperCase()+r.resource_type.slice(1),n=r.action.replace(/_/g," ").toLowerCase(),i=r.resource_id.slice(0,8),`Support ${n} on ${a} (${i}...)`),f.toast.info(o,{description:s.reason||"Support action performed",icon:l,duration:8e3,action:{label:"View Activity",onClick:()=>{window.location.href="/dashboard/settings/support-activity"}}})}))}catch(e){console.error("Error checking for support actions:",e)}finally{r.current=!1}}};s();let a=setInterval(s,1e4);return()=>clearInterval(a)},[]),null}function I({children:e}){let[r,i]=(0,s.useState)([]),[l,o]=(0,s.useState)([]),[c,d]=(0,s.useState)(!1),[m,u]=(0,s.useState)(0),x=async()=>{try{let e=await a();e.success&&e.sessions&&(i(e.sessions),e.sessions.length>0&&!c&&(d(!0),u(0)));let t=await n();t.success&&t.sessions&&o(t.sessions)}catch(e){console.error("Error fetching support sessions:",e)}};(0,s.useEffect)(()=>{x();let e=setInterval(x,1e4);return()=>clearInterval(e)},[]);let h=r[m]||null,p=l[0]||null;return(0,t.jsxs)(t.Fragment,{children:[p&&(0,t.jsx)(y,{session:p,onSessionEnded:()=>{x()}}),(0,t.jsx)(g,{session:h,open:c,onOpenChange:d,onApproved:()=>{x(),m<r.length-1?u(m+1):d(!1)},onRejected:()=>{x(),m<r.length-1?u(m+1):d(!1)}}),(0,t.jsx)(A,{}),(0,t.jsx)("div",{className:p?"pt-12":"",children:e})]})}e.s(["SupportSessionProvider",()=>I],824039)}]);