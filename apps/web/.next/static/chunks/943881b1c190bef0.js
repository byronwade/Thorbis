(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,51052,e=>{"use strict";var r=e.i(995403);function s(){return{toast:{success:(e,s)=>r.toast.success(e,{duration:3e3,...s}),error:(e,s)=>r.toast.error(e,{duration:5e3,...s}),loading:(e,s)=>r.toast.loading(e,s),info:(e,s)=>r.toast.info(e,{duration:3e3,...s}),warning:(e,s)=>r.toast.warning(e,{duration:4e3,...s}),promise:(e,s)=>r.toast.promise(e,s),dismiss:e=>{r.toast.dismiss(e)},fromActionResult:e=>{e.success?r.toast.success(e.message||"Operation completed successfully"):r.toast.error(e.error||"Operation failed")}}}}e.s(["useToast",()=>s])},112698,e=>{"use strict";let r=(0,e.i(383206).default)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);e.s(["default",()=>r])},367571,e=>{"use strict";var r=e.i(112698);e.s(["Eye",()=>r.default])},383206,910799,e=>{"use strict";var r=e.i(970799);let s=e=>{let r=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,r,s)=>s?s.toUpperCase():r.toLowerCase());return r.charAt(0).toUpperCase()+r.slice(1)},t=(...e)=>e.filter((e,r,s)=>!!e&&""!==e.trim()&&s.indexOf(e)===r).join(" ").trim();var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)(({color:e="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:n,className:o="",children:l,iconNode:c,...d},u)=>(0,r.createElement)("svg",{ref:u,...a,width:s,height:s,stroke:e,strokeWidth:n?24*Number(i)/Number(s):i,className:t("lucide",o),...!l&&!(e=>{for(let r in e)if(r.startsWith("aria-")||"role"===r||"title"===r)return!0})(d)&&{"aria-hidden":"true"},...d},[...c.map(([e,s])=>(0,r.createElement)(e,s)),...Array.isArray(l)?l:[l]]));e.s(["default",()=>i],910799);let n=(e,a)=>{let n=(0,r.forwardRef)(({className:n,...o},l)=>(0,r.createElement)(i,{ref:l,iconNode:a,className:t(`lucide-${s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...o}));return n.displayName=s(e),n};e.s(["default",()=>n],383206)},889265,e=>{"use strict";e.i(116233),e.s([])},254851,e=>{"use strict";e.i(116233),e.s([])},751966,e=>{"use strict";let r=(0,e.i(383206).default)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);e.s(["default",()=>r])},818796,e=>{"use strict";var r=e.i(751966);e.s(["AlertCircle",()=>r.default])},608635,e=>{"use strict";let r=(0,e.i(383206).default)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);e.s(["default",()=>r])},14435,e=>{"use strict";var r=e.i(608635);e.s(["User",()=>r.default])},911194,e=>{"use strict";let r=(0,e.i(383206).default)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);e.s(["default",()=>r])},641304,e=>{"use strict";var r=e.i(911194);e.s(["Loader2",()=>r.default])},552038,(e,r,s)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0});var t={callServer:function(){return i.callServer},createServerReference:function(){return o.createServerReference},findSourceMapURL:function(){return n.findSourceMapURL}};for(var a in t)Object.defineProperty(s,a,{enumerable:!0,get:t[a]});let i=e.r(447802),n=e.r(528674),o=e.r(504331)},51478,e=>{"use strict";e.i(116233),e.s([])},686787,e=>{"use strict";e.i(116233),e.s([])},923225,e=>{"use strict";let r=(0,e.i(383206).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>r])},630754,e=>{"use strict";var r=e.i(923225);e.s(["CheckCircle",()=>r.default])},413336,e=>{"use strict";let r=(0,e.i(383206).default)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);e.s(["default",()=>r])},269588,e=>{"use strict";var r=e.i(413336);e.s(["EyeOff",()=>r.default])},469594,903148,e=>{"use strict";var r=e.i(820713);let s=(e,s,t)=>{if(e&&"reportValidity"in e){let a=(0,r.get)(t,s);e.setCustomValidity(a&&a.message||""),e.reportValidity()}},t=(e,r)=>{for(let t in r.fields){let a=r.fields[t];a&&a.ref&&"reportValidity"in a.ref?s(a.ref,t,e):a&&a.refs&&a.refs.forEach(r=>s(r,t,e))}},a=(e,s)=>{s.shouldUseNativeValidation&&t(e,s);let a={};for(let t in e){let n=(0,r.get)(s.fields,t),o=Object.assign(e[t]||{},{ref:n&&n.ref});if(i(s.names||Object.keys(e),t)){let e=Object.assign({},(0,r.get)(a,t));(0,r.set)(e,"root",o),(0,r.set)(a,t,e)}else(0,r.set)(a,t,o)}return a},i=(e,r)=>{let s=n(r);return e.some(e=>n(e).match(`^${s}\\.\\d+`))};function n(e){return e.replace(/\]|\[/g,"")}var o=e.i(430428),l=e.i(98535);function c(e,r){try{var s=e()}catch(e){return r(e)}return s&&s.then?s.then(void 0,r):s}function d(e,s,i){if(void 0===i&&(i={}),"_def"in e&&"object"==typeof e._def&&"typeName"in e._def)return function(n,o,l){try{return Promise.resolve(c(function(){return Promise.resolve(e["sync"===i.mode?"parse":"parseAsync"](n,s)).then(function(e){return l.shouldUseNativeValidation&&t({},l),{errors:{},values:i.raw?Object.assign({},n):e}})},function(e){if(Array.isArray(null==e?void 0:e.issues))return{values:{},errors:a(function(e,s){for(var t={};e.length;){var a=e[0],i=a.code,n=a.message,o=a.path.join(".");if(!t[o])if("unionErrors"in a){var l=a.unionErrors[0].errors[0];t[o]={message:l.message,type:l.code}}else t[o]={message:n,type:i};if("unionErrors"in a&&a.unionErrors.forEach(function(r){return r.errors.forEach(function(r){return e.push(r)})}),s){var c=t[o].types,d=c&&c[a.code];t[o]=(0,r.appendErrors)(o,s,t,i,d?[].concat(d,a.message):a.message)}e.shift()}return t}(e.errors,!l.shouldUseNativeValidation&&"all"===l.criteriaMode),l)};throw e}))}catch(e){return Promise.reject(e)}};if("_zod"in e&&"object"==typeof e._zod)return function(n,d,u){try{return Promise.resolve(c(function(){return Promise.resolve(("sync"===i.mode?l.parse:l.parseAsync)(e,n,s)).then(function(e){return u.shouldUseNativeValidation&&t({},u),{errors:{},values:i.raw?Object.assign({},n):e}})},function(e){if(e instanceof o.$ZodError)return{values:{},errors:a(function(e,s){for(var t={};e.length;){var a=e[0],i=a.code,n=a.message,o=a.path.join(".");if(!t[o])if("invalid_union"===a.code&&a.errors.length>0){var l=a.errors[0][0];t[o]={message:l.message,type:l.code}}else t[o]={message:n,type:i};if("invalid_union"===a.code&&a.errors.forEach(function(r){return r.forEach(function(r){return e.push(r)})}),s){var c=t[o].types,d=c&&c[a.code];t[o]=(0,r.appendErrors)(o,s,t,i,d?[].concat(d,a.message):a.message)}e.shift()}return t}(e.issues,!u.shouldUseNativeValidation&&"all"===u.criteriaMode),u)};throw e}))}catch(e){return Promise.reject(e)}};throw Error("Invalid input: not a Zod schema")}e.s(["zodResolver",()=>d],469594),e.i(116233),e.s([],903148)},532279,e=>{"use strict";var r=e.i(111043),s=e.i(469594),t=e.i(818796),a=e.i(630754),i=e.i(367571),n=e.i(269588),o=e.i(641304),l=e.i(14435),c=e.i(904653),d=e.i(970799),u=e.i(820713),m=e.i(290583),f=e.i(552038),h=(0,f.createServerReference)("40b17c6e2f31505c0fb75484ff7f8b005e7bcf1c97",f.callServer,void 0,f.findSourceMapURL,"acceptTeamInvitation");e.i(686787);var p=e.i(519539);e.i(889265);var x=e.i(677607);e.i(254851);var v=e.i(605278);e.i(903148);var j=e.i(310205);e.i(51478);var g=e.i(635613),y=e.i(51052);let N=m.z.object({firstName:m.z.string().min(1,"First name is required"),lastName:m.z.string().min(1,"Last name is required"),email:m.z.string().email("Invalid email address"),phone:m.z.string().optional(),password:m.z.string().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number"),confirmPassword:m.z.string().min(1,"Please confirm your password"),photo:m.z.instanceof(File).optional()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords do not match",path:["confirmPassword"]});function w(){let e=(0,c.useRouter)(),m=(0,c.useSearchParams)(),{toast:f}=(0,y.useToast)(),[w,b]=(0,d.useState)(!0),[F,C]=(0,d.useState)(!1),[k,z]=(0,d.useState)(!1),[P,A]=(0,d.useState)(!1),[E,I]=(0,d.useState)(!1),[L,S]=(0,d.useState)(null),[M,R]=(0,d.useState)(null),[V,O]=(0,d.useState)(null),U=(0,u.useForm)({resolver:(0,s.zodResolver)(N),defaultValues:{firstName:"",lastName:"",email:"",phone:"",password:"",confirmPassword:""}}),T=m?.get("token");(0,d.useEffect)(()=>{!async function(){if(!T){S("No invitation token provided"),b(!1);return}try{let e=await fetch(`/api/verify-invitation?token=${encodeURIComponent(T)}`);if(!e.ok)throw Error("Failed to verify invitation");let r=await e.json();if(!r.valid){S(r.error||"Invalid invitation token"),b(!1);return}R(r.invitation),I(!0),U.setValue("email",r.invitation.email),U.setValue("firstName",r.invitation.firstName),U.setValue("lastName",r.invitation.lastName),r.invitation.phone&&U.setValue("phone",r.invitation.phone)}catch(e){S("Failed to verify invitation. Please try again.")}finally{b(!1)}}()},[T,U]);let _=async r=>{if(!T)return void f.error("No invitation token provided");C(!0);try{let s=new FormData;s.append("token",T),s.append("firstName",r.firstName),s.append("lastName",r.lastName),s.append("email",r.email),s.append("phone",r.phone||""),s.append("password",r.password),r.photo&&s.append("photo",r.photo);let t=await h(s);t.success?(f.success("Invitation accepted! Logging you in..."),setTimeout(()=>{e.push("/dashboard")},1500)):f.error(t.error||"Failed to accept invitation")}catch(e){f.error("An unexpected error occurred. Please try again.")}finally{C(!1)}};return w?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,r.jsx)(v.Card,{className:"w-full max-w-md",children:(0,r.jsxs)(v.CardContent,{className:"flex flex-col items-center gap-4 pt-6",children:[(0,r.jsx)(o.Loader2,{className:"text-primary size-8 animate-spin"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Verifying invitation..."})]})})}):!E||L?(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,r.jsxs)(v.Card,{className:"w-full max-w-md",children:[(0,r.jsxs)(v.CardHeader,{children:[(0,r.jsx)(v.CardTitle,{className:"text-center",children:"Invalid Invitation"}),(0,r.jsx)(v.CardDescription,{className:"text-center",children:"This invitation link is invalid or has expired"})]}),(0,r.jsxs)(v.CardContent,{children:[(0,r.jsxs)(p.Alert,{variant:"destructive",children:[(0,r.jsx)(t.AlertCircle,{className:"size-4"}),(0,r.jsx)(p.AlertDescription,{children:L||"The invitation token is invalid"})]}),(0,r.jsxs)("div",{className:"mt-6 space-y-2 text-center text-sm",children:[(0,r.jsx)("p",{children:"If you believe this is an error, please contact the person who invited you."}),(0,r.jsx)(x.Button,{className:"mt-4 w-full",onClick:()=>e.push("/login"),variant:"outline",children:"Go to Login"})]})]})]})}):(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 p-4 dark:bg-gray-900",children:(0,r.jsxs)(v.Card,{className:"w-full max-w-2xl",children:[(0,r.jsxs)(v.CardHeader,{children:[(0,r.jsx)(v.CardTitle,{children:"Accept Team Invitation"}),(0,r.jsxs)(v.CardDescription,{children:["You've been invited to join"," ",(0,r.jsx)("strong",{children:M?.companyName})," as a"," ",(0,r.jsx)("strong",{children:M?.role})]})]}),(0,r.jsx)(v.CardContent,{children:(0,r.jsx)(j.Form,{...U,children:(0,r.jsxs)("form",{className:"space-y-6",onSubmit:U.handleSubmit(_),children:[(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[V?(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("img",{alt:"Profile preview",className:"size-20 rounded-full border object-cover",src:V}),(0,r.jsx)(x.Button,{className:"absolute -top-1 -right-1 size-6 rounded-full p-0",onClick:()=>{U.setValue("photo",void 0),O(null)},size:"icon",type:"button",variant:"destructive",children:"×"})]}):(0,r.jsx)("div",{className:"flex size-20 items-center justify-center rounded-full border border-dashed",children:(0,r.jsx)(l.User,{className:"text-muted-foreground size-8"})}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(g.Input,{accept:"image/*",className:"cursor-pointer",onChange:e=>{let r=e.target.files?.[0];if(r){if(r.size>5242880)return void f.error("Photo size must be less than 5MB");U.setValue("photo",r);let e=new FileReader;e.onloadend=()=>{O(e.result)},e.readAsDataURL(r)}},type:"file"}),(0,r.jsx)("p",{className:"text-muted-foreground mt-1 text-xs",children:"Profile photo (optional, max 5MB)"})]})]}),(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsx)(j.FormField,{control:U.control,name:"firstName",render:({field:e})=>(0,r.jsxs)(j.FormItem,{children:[(0,r.jsx)(j.FormLabel,{children:"First Name *"}),(0,r.jsx)(j.FormControl,{children:(0,r.jsx)(g.Input,{placeholder:"John",...e})}),(0,r.jsx)(j.FormMessage,{})]})}),(0,r.jsx)(j.FormField,{control:U.control,name:"lastName",render:({field:e})=>(0,r.jsxs)(j.FormItem,{children:[(0,r.jsx)(j.FormLabel,{children:"Last Name *"}),(0,r.jsx)(j.FormControl,{children:(0,r.jsx)(g.Input,{placeholder:"Doe",...e})}),(0,r.jsx)(j.FormMessage,{})]})})]}),(0,r.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,r.jsx)(j.FormField,{control:U.control,name:"email",render:({field:e})=>(0,r.jsxs)(j.FormItem,{children:[(0,r.jsx)(j.FormLabel,{children:"Email *"}),(0,r.jsx)(j.FormControl,{children:(0,r.jsx)(g.Input,{disabled:!0,placeholder:"john@example.com",type:"email",...e})}),(0,r.jsx)(j.FormDescription,{children:"This email cannot be changed"}),(0,r.jsx)(j.FormMessage,{})]})}),(0,r.jsx)(j.FormField,{control:U.control,name:"phone",render:({field:e})=>(0,r.jsxs)(j.FormItem,{children:[(0,r.jsx)(j.FormLabel,{children:"Phone (Optional)"}),(0,r.jsx)(j.FormControl,{children:(0,r.jsx)(g.Input,{placeholder:"+1 (555) 123-4567",type:"tel",...e})}),(0,r.jsx)(j.FormMessage,{})]})})]}),(0,r.jsx)(j.FormField,{control:U.control,name:"password",render:({field:e})=>(0,r.jsxs)(j.FormItem,{children:[(0,r.jsx)(j.FormLabel,{children:"Password *"}),(0,r.jsx)(j.FormControl,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(g.Input,{placeholder:"••••••••",type:k?"text":"password",...e}),(0,r.jsx)(x.Button,{className:"absolute top-0 right-0 h-full px-3",onClick:()=>z(!k),size:"sm",type:"button",variant:"ghost",children:k?(0,r.jsx)(n.EyeOff,{className:"size-4"}):(0,r.jsx)(i.Eye,{className:"size-4"})})]})}),(0,r.jsx)(j.FormDescription,{children:"At least 8 characters with uppercase, lowercase, and a number"}),(0,r.jsx)(j.FormMessage,{})]})}),(0,r.jsx)(j.FormField,{control:U.control,name:"confirmPassword",render:({field:e})=>(0,r.jsxs)(j.FormItem,{children:[(0,r.jsx)(j.FormLabel,{children:"Confirm Password *"}),(0,r.jsx)(j.FormControl,{children:(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)(g.Input,{placeholder:"••••••••",type:P?"text":"password",...e}),(0,r.jsx)(x.Button,{className:"absolute top-0 right-0 h-full px-3",onClick:()=>A(!P),size:"sm",type:"button",variant:"ghost",children:P?(0,r.jsx)(n.EyeOff,{className:"size-4"}):(0,r.jsx)(i.Eye,{className:"size-4"})})]})}),(0,r.jsx)(j.FormMessage,{})]})}),(0,r.jsx)(x.Button,{className:"w-full",disabled:F,type:"submit",children:F?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Loader2,{className:"mr-2 size-4 animate-spin"}),"Creating Account..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a.CheckCircle,{className:"mr-2 size-4"}),"Accept Invitation & Create Account"]})})]})})})]})})}function b(){return(0,r.jsx)(d.Suspense,{fallback:(0,r.jsx)("div",{className:"flex min-h-screen items-center justify-center bg-gray-50 dark:bg-gray-900",children:(0,r.jsx)(v.Card,{className:"w-full max-w-md",children:(0,r.jsxs)(v.CardContent,{className:"flex flex-col items-center gap-4 pt-6",children:[(0,r.jsx)(o.Loader2,{className:"text-primary size-8 animate-spin"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Loading..."})]})})}),children:(0,r.jsx)(w,{})})}e.s(["default",()=>b],532279)}]);