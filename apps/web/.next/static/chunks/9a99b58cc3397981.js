(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,254851,e=>{"use strict";e.i(116233),e.s([])},34573,e=>{"use strict";var t=e.i(111043),a=e.i(818796),s=e.i(230666),i=e.i(79254),r=e.i(872021),l=e.i(136764),n=e.i(982686),c=e.i(747146),o=e.i(121085),d=e.i(532727),m=e.i(12435),u=e.i(501651),x=e.i(176378),f=e.i(970799),h=e.i(381234),g=e.i(552038),j=(0,g.createServerReference)("403b2d804793adeb9ca3ae15e25ad95dc7c425f14d",g.callServer,void 0,g.findSourceMapURL,"getNotifications"),p=e.i(953653),N=e.i(834633);e.i(553153);var v=e.i(363712);e.i(889265);var y=e.i(677607);e.i(254851);var b=e.i(605278),k=e.i(430063),w=e.i(830891);let C={message:c.MessageSquare,alert:a.AlertCircle,payment:n.DollarSign,job:u.Wrench,team:m.UserPlus,system:o.Settings},S={message:"text-primary",alert:"text-warning",payment:"text-success",job:"text-accent-foreground",team:"text-cyan-500",system:"text-muted-foreground"},z={low:"bg-muted text-foreground dark:bg-foreground dark:text-muted-foreground",medium:"bg-primary text-primary dark:bg-primary dark:text-primary",high:"bg-warning text-warning dark:bg-warning dark:text-warning",urgent:"bg-destructive text-destructive dark:bg-destructive dark:text-destructive"};function A(){let[e,a]=(0,f.useState)(!1),[n,c]=(0,f.useState)("all"),[o,m]=(0,f.useState)("all"),u=(0,k.useNotificationsStore)(e=>e.notifications),g=(0,k.useNotificationsStore)(e=>e.setNotifications),A=(0,k.useNotificationsStore)(e=>e.optimisticMarkAsRead),B=(0,k.useNotificationsStore)(e=>e.optimisticMarkAllAsRead),R=(0,k.useNotificationsStore)(e=>e.optimisticDelete),M=(0,k.useNotificationsStore)(e=>e.subscribe),T=(0,k.useNotificationsStore)(e=>e.unsubscribe);(0,f.useEffect)(()=>{async function t(){try{let e=(0,w.createClient)();if(!e)return;let{data:{user:t}}=await e.auth.getUser();if(!t)return;let s=await j({limit:100});s.success&&s.data&&g(s.data),await M(t.id),a(!0)}catch(e){}}return e||t(),()=>{T()}},[e,g,M,T]);let U=async e=>{A(e);let t=await (0,N.markAsRead)(e);t.success||console.error("Failed to mark notification as read:",t.error)},D=async()=>{B();let e=await (0,p.markAllAsRead)();e.success||console.error("Failed to mark all notifications as read:",e.error)},$=async e=>{R(e);let t=await (0,h.deleteNotification)(e);t.success||console.error("Failed to delete notification:",t.error)},_=u.filter(e=>("all"===n||e.type===n)&&("unread"!==o||!e.read)&&("read"!==o||!!e.read)),F=u.filter(e=>!e.read).length;return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(b.Card,{className:"p-4",children:[(0,t.jsxs)("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,t.jsx)(y.Button,{onClick:()=>m("all"),size:"sm",variant:"all"===o?"default":"outline",children:"All"}),(0,t.jsxs)(y.Button,{onClick:()=>m("unread"),size:"sm",variant:"unread"===o?"default":"outline",children:["Unread (",F,")"]}),(0,t.jsx)(y.Button,{onClick:()=>m("read"),size:"sm",variant:"read"===o?"default":"outline",children:"Read"})]}),(0,t.jsx)("div",{className:"flex gap-2",children:F>0&&(0,t.jsxs)(y.Button,{onClick:D,size:"sm",variant:"outline",children:[(0,t.jsx)(r.CheckCheck,{className:"mr-2 size-4"}),"Mark All Read"]})})]}),(0,t.jsxs)("div",{className:"mt-4 flex flex-wrap gap-2",children:[(0,t.jsx)(y.Button,{onClick:()=>c("all"),size:"sm",variant:"all"===n?"default":"ghost",children:"All Types"}),["message","alert","payment","job","team","system"].map(e=>{let a=C[e];return(0,t.jsxs)(y.Button,{onClick:()=>c(e),size:"sm",variant:n===e?"default":"ghost",children:[(0,t.jsx)(a,{className:"mr-2 size-3"}),e.charAt(0).toUpperCase()+e.slice(1)]},e)})]})]}),0===_.length?(0,t.jsx)(b.Card,{className:"p-12",children:(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center text-center",children:[(0,t.jsx)(s.Bell,{className:"text-muted-foreground/30 mb-4 size-16"}),(0,t.jsx)("h3",{className:"mb-2 text-lg font-semibold",children:"No notifications"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:"unread"===o?"You're all caught up! No unread notifications.":"all"!==n?`No ${n} notifications found.`:"You don't have any notifications yet."})]})}):(0,t.jsx)("div",{className:"space-y-2",children:_.map(e=>{var a;let s,r,n,c,o=C[e.type];return(0,t.jsx)(b.Card,{className:`p-4 transition-colors ${e.read?"bg-background":"bg-primary/5"}`,children:(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsx)("div",{className:`mt-1 shrink-0 ${S[e.type]}`,children:(0,t.jsx)(o,{className:"size-5"})}),(0,t.jsxs)("div",{className:"min-w-0 flex-1 space-y-2",children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-base font-semibold",children:e.title}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1 text-sm",children:e.message})]}),(0,t.jsx)(v.Badge,{className:z[e.priority],variant:"outline",children:e.priority})]}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2",children:[(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center gap-1 text-xs",children:[(0,t.jsx)(l.Clock,{className:"size-3"}),(a=new Date(e.created_at),r=Math.floor((s=new Date().getTime()-a.getTime())/6e4),n=Math.floor(s/36e5),c=Math.floor(s/864e5),r<1?"Just now":r<60?`${r}m ago`:n<24?`${n}h ago`:c<7?`${c}d ago`:a.toLocaleDateString())]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[e.action_url&&(0,t.jsx)(x.default,{href:e.action_url,children:(0,t.jsx)(y.Button,{onClick:()=>U(e.id),size:"sm",variant:"ghost",children:e.action_label||"View"})}),!e.read&&(0,t.jsx)(y.Button,{onClick:()=>U(e.id),size:"sm",title:"Mark as read",variant:"ghost",children:(0,t.jsx)(i.Check,{className:"size-4"})}),(0,t.jsx)(y.Button,{className:"hover:text-destructive",onClick:()=>$(e.id),size:"sm",title:"Delete",variant:"ghost",children:(0,t.jsx)(d.Trash2,{className:"size-4"})})]})]})]})]})},e.id)})})]})}e.s(["NotificationsList",()=>A],34573)}]);