(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,456554,e=>{"use strict";let t=(0,e.i(383206).default)("pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);e.s(["default",()=>t])},79093,e=>{"use strict";var t=e.i(111043),s=e.i(79254),n=e.i(456554),n=n,a=e.i(142642),l=e.i(540374),r=e.i(212409),i=e.i(970799);e.i(553153);var o=e.i(363712);e.i(889265);var c=e.i(677607);e.i(51478);var m=e.i(635613),d=e.i(948962);let u={customerInfo:{name:null,email:null,phone:null,company:null,address:{street:null,city:null,state:null,zipCode:null,full:null},confidence:0},jobDetails:{title:null,description:null,urgency:null,type:null,estimatedDuration:null,confidence:0},appointmentNeeds:{preferredDate:null,preferredTime:null,timePreference:null,duration:null,specialRequirements:null,confidence:0},callSummary:"",sentiment:"neutral",tags:[],overallConfidence:0};var x=e.i(7107);function f(){var e,f;let{extractedData:p,isExtracting:h}=function(){let e=(0,d.useTranscriptStore)(e=>e.entries),[t,s]=(0,i.useState)(u),[n,a]=(0,i.useState)(!1),[l,r]=(0,i.useState)(0),o=(0,i.useCallback)(async()=>{if(0===e.length)return void s(u);if(e.length!==l){a(!0);try{let n=e.map(e=>({speaker:e.speaker,text:e.text,timestamp:e.timestamp})),a=await fetch("/api/ai/extract-call-data",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({transcript:n,mode:l>0?"update":"full",previousExtraction:l>0?t:null})});if(!a.ok)throw Error("AI extraction failed");let i=a.body?.getReader(),o=new TextDecoder,c="";if(i)for(;;){let{done:e,value:t}=await i.read();if(e)break;c+=o.decode(t)}let m=c.match(/\{[\s\S]*\}/);if(m){let t=JSON.parse(m[0]),n=[t.customerInfo?.confidence||0,t.jobDetails?.confidence||0,t.appointmentNeeds?.confidence||0],a=n.reduce((e,t)=>e+t,0)/n.length;s({customerInfo:{...u.customerInfo,...t.customerInfo},jobDetails:{...u.jobDetails,...t.jobDetails},appointmentNeeds:{...u.appointmentNeeds,...t.appointmentNeeds},callSummary:t.callSummary||"",sentiment:t.sentiment||"neutral",tags:t.tags||[],overallConfidence:Math.round(a)}),r(e.length)}}catch(e){}finally{a(!1)}}},[e,l,t]);return(0,i.useEffect)(()=>{let e=setTimeout(()=>{o()},2e3);return()=>clearTimeout(e)},[o]),{extractedData:t,isExtracting:n,refreshExtraction:o}}(),g=(0,x.useCallPreferencesStore)(e=>e.showAIConfidence),j=p.customerInfo.name||p.customerInfo.email||p.customerInfo.phone||p.jobDetails.title||p.jobDetails.description||p.appointmentNeeds.preferredDate,[b,N]=(0,i.useState)("pending"),[v,y]=(0,i.useState)(p.customerInfo),[I,D]=(0,i.useState)(new Set),[w,C]=(0,i.useState)(null),k=(e,t)=>{y(s=>({...s,[e]:t})),N("edited")};return(0,t.jsxs)("div",{className:"flex h-full flex-col",children:[(0,t.jsxs)("div",{className:"border-border bg-foreground/50 flex items-center justify-between border-b p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.Sparkles,{className:"text-accent-foreground size-4"}),(0,t.jsx)("h3",{className:"text-sm font-semibold text-white",children:"AI Auto-fill"}),h&&(0,t.jsx)("div",{className:"bg-accent size-2 animate-pulse rounded-full"})]}),g&&p.overallConfidence>0&&(0,t.jsxs)("div",{className:`rounded-full px-2.5 py-1 text-xs font-semibold ${(e=p.overallConfidence)>=80?"text-success bg-success/30":e>=60?"text-warning bg-warning/30":"text-destructive bg-destructive/30"}`,children:[(f=p.overallConfidence)>=80?"High":f>=60?"Medium":"Low"," (",p.overallConfidence,"%)"]})]}),(0,t.jsxs)("div",{className:"flex-1 space-y-4 overflow-y-auto p-4",children:[(0,t.jsxs)("div",{className:`rounded-lg border p-4 ${"approved"===b?"border-success bg-success/10":"rejected"===b?"border-destructive bg-destructive/10":"border-border bg-foreground/50"}`,children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,t.jsxs)("h4",{className:"flex items-center gap-2 text-sm font-semibold text-white",children:[(0,t.jsx)(a.Sparkles,{className:"size-3.5"}),"Customer Information"]}),"pending"===b&&(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsxs)(c.Button,{className:"bg-success/30 text-success hover:bg-success/50 hover:text-success h-7 gap-1 px-2",onClick:()=>{N("approved")},size:"sm",variant:"ghost",children:[(0,t.jsx)(s.Check,{className:"size-3"}),"Approve"]}),(0,t.jsxs)(c.Button,{className:"bg-destructive/30 text-destructive hover:bg-destructive/50 hover:text-destructive h-7 gap-1 px-2",onClick:()=>{N("rejected")},size:"sm",variant:"ghost",children:[(0,t.jsx)(r.X,{className:"size-3"}),"Reject"]})]}),"approved"===b&&(0,t.jsx)(o.Badge,{className:"bg-success/50 text-success",children:"Approved"}),"rejected"===b&&(0,t.jsx)(o.Badge,{className:"bg-destructive/50 text-destructive",children:"Rejected"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(p.customerInfo.name||v.name)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Name"}),"name"===w?(0,t.jsx)(m.Input,{autoFocus:!0,className:"h-8 text-sm",onBlur:()=>C(null),onChange:e=>k("name",e.target.value),value:v.name||""}):(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-sm",children:v.name||p.customerInfo.name}),(0,t.jsx)(c.Button,{className:"h-6 w-6 p-0",onClick:()=>{C("name"),y(e=>({...e,name:e.name||p.customerInfo.name}))},size:"sm",variant:"ghost",children:(0,t.jsx)(n.default,{className:"size-3"})})]})]}),(p.customerInfo.email||v.email)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Email"}),"email"===w?(0,t.jsx)(m.Input,{autoFocus:!0,className:"h-8 text-sm",onBlur:()=>C(null),onChange:e=>k("email",e.target.value),value:v.email||""}):(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-sm",children:v.email||p.customerInfo.email}),(0,t.jsx)(c.Button,{className:"h-6 w-6 p-0",onClick:()=>{C("email"),y(e=>({...e,email:e.email||p.customerInfo.email}))},size:"sm",variant:"ghost",children:(0,t.jsx)(n.default,{className:"size-3"})})]})]}),(p.customerInfo.phone||v.phone)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Phone"}),"phone"===w?(0,t.jsx)(m.Input,{autoFocus:!0,className:"h-8 text-sm",onBlur:()=>C(null),onChange:e=>k("phone",e.target.value),value:v.phone||""}):(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-sm",children:v.phone||p.customerInfo.phone}),(0,t.jsx)(c.Button,{className:"h-6 w-6 p-0",onClick:()=>{C("phone"),y(e=>({...e,phone:e.phone||p.customerInfo.phone}))},size:"sm",variant:"ghost",children:(0,t.jsx)(n.default,{className:"size-3"})})]})]}),(p.customerInfo.company||v.company)&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Company"}),"company"===w?(0,t.jsx)(m.Input,{autoFocus:!0,className:"h-8 text-sm",onBlur:()=>C(null),onChange:e=>k("company",e.target.value),value:v.company||""}):(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-sm",children:v.company||p.customerInfo.company}),(0,t.jsx)(c.Button,{className:"h-6 w-6 p-0",onClick:()=>{C("company"),y(e=>({...e,company:e.company||p.customerInfo.company}))},size:"sm",variant:"ghost",children:(0,t.jsx)(n.default,{className:"size-3"})})]})]}),!(p.customerInfo.name||p.customerInfo.email||p.customerInfo.phone||p.customerInfo.company||p.customerInfo.address.full)&&(0,t.jsx)("p",{className:"text-muted-foreground text-xs",children:"No customer information extracted yet"})]})]}),(p.jobDetails.title||p.jobDetails.description)&&(0,t.jsxs)("div",{className:"border-border bg-foreground/50 rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,t.jsx)(l.Tag,{className:"size-3.5 text-blue-500"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-white",children:"Job Details"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[p.jobDetails.title&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Title"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:p.jobDetails.title})]}),p.jobDetails.description&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Description"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:p.jobDetails.description})]}),p.jobDetails.urgency&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Urgency"}),(0,t.jsx)("span",{className:`inline-block rounded px-2 py-1 text-xs ${"emergency"===p.jobDetails.urgency?"bg-red-500/20 text-red-600":"high"===p.jobDetails.urgency?"bg-orange-500/20 text-orange-600":"bg-blue-500/20 text-blue-600"}`,children:p.jobDetails.urgency})]})]})]}),(p.appointmentNeeds.preferredDate||p.appointmentNeeds.timePreference)&&(0,t.jsxs)("div",{className:"border-border bg-foreground/50 rounded-lg border p-4",children:[(0,t.jsxs)("div",{className:"mb-3 flex items-center gap-2",children:[(0,t.jsx)(l.Tag,{className:"size-3.5 text-purple-500"}),(0,t.jsx)("h4",{className:"text-sm font-semibold text-white",children:"Appointment Preferences"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[p.appointmentNeeds.preferredDate&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Preferred Date"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm",children:p.appointmentNeeds.preferredDate})]}),p.appointmentNeeds.timePreference&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"text-muted-foreground mb-1 block text-xxs font-medium",children:"Time Preference"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm capitalize",children:p.appointmentNeeds.timePreference})]})]})]}),p.callSummary&&(0,t.jsxs)("div",{className:"border-border bg-foreground/50 rounded-lg border p-4",children:[(0,t.jsx)("h4",{className:"mb-2 text-sm font-semibold text-white",children:"Call Summary"}),(0,t.jsx)("p",{className:"text-muted-foreground text-sm leading-relaxed",children:p.callSummary}),(0,t.jsxs)("div",{className:"mt-3 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:"Sentiment:"}),(0,t.jsx)(o.Badge,{className:`${"positive"===p.sentiment?"bg-success/50 text-success":"negative"===p.sentiment?"bg-destructive/50 text-destructive":"bg-foreground text-muted-foreground"}`,children:p.sentiment})]})]}),!(j||p.callSummary)&&0===p.customerInfo.confidence&&(0,t.jsxs)("div",{className:"flex h-full flex-col items-center justify-center py-12 text-center",children:[(0,t.jsx)("div",{className:"bg-foreground rounded-full p-4",children:(0,t.jsx)(a.Sparkles,{className:"text-muted-foreground size-8"})}),(0,t.jsx)("p",{className:"text-muted-foreground mt-4 text-sm font-medium",children:"AI is listening..."}),(0,t.jsx)("p",{className:"text-muted-foreground mt-1 text-xs",children:"Data will auto-fill as the conversation progresses"})]})]})]})}e.s(["AIAutofillPreview",()=>f],79093)},600539,e=>{e.n(e.i(79093))}]);