(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672573,e=>{"use strict";let r=(0,e.i(383206).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["default",()=>r])},15751,e=>{"use strict";var r=e.i(672573);e.s(["MapPin",()=>r.default])},235670,e=>{"use strict";e.i(116233),e.s([])},616291,e=>{"use strict";let r=(0,e.i(383206).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);e.s(["default",()=>r])},664136,e=>{"use strict";var r=e.i(616291);e.s(["Edit",()=>r.default])},960876,e=>{"use strict";function r(e,r){if(!e)return r||"Unknown Customer";if(e.display_name)return e.display_name;let t=e.first_name?.trim(),a=e.last_name?.trim();return t&&a?`${t} ${a}`:t||a||(e.company_name?e.company_name:e.email?e.email:r||"Unknown Customer")}function t(e){if(!e)return"?";let t=r(e).split(/\s+/).filter(Boolean);return t.length>=2?(t[0][0]+t[1][0]).toUpperCase():1===t.length&&t[0].length>=2?t[0].slice(0,2).toUpperCase():1===t.length?t[0][0].toUpperCase():"?"}e.s(["getCustomerDisplayName",()=>r,"getCustomerInitials",()=>t])},221999,e=>{"use strict";let r=(0,e.i(383206).default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);e.s(["default",()=>r])},560149,e=>{"use strict";var r=e.i(221999);e.s(["CalendarDays",()=>r.default])},686804,e=>{"use strict";let r=(0,e.i(383206).default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);e.s(["default",()=>r])},550652,e=>{"use strict";var r=e.i(686804);e.s(["ArrowUpRight",()=>r.default])},926991,e=>{"use strict";let r=(0,e.i(383206).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["default",()=>r])},51866,e=>{"use strict";var r=e.i(926991);e.s(["ChevronLeft",()=>r.default])},172506,e=>{"use strict";var r=e.i(306929);e.s(["ArrowDown",()=>r.default])},698684,e=>{"use strict";let r=(0,e.i(383206).default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);e.s(["default",()=>r])},407205,e=>{"use strict";var r=e.i(698684);e.s(["ArrowUp",()=>r.default])},306929,e=>{"use strict";let r=(0,e.i(383206).default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);e.s(["default",()=>r])},573951,e=>{"use strict";let r=(0,e.i(383206).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);e.s(["default",()=>r])},287156,e=>{"use strict";var r=e.i(111043),t=e.i(970799),a=e.i(151213);function s({section:e,table:s,kanban:l,fallback:i=null,forceView:n}){let d=(0,a.useWorkView)(e),o=(0,a.useSetWorkView)(e),c=n??d;return((0,t.useEffect)(()=>{n&&d!==n&&o(n)},[n]),"kanban"===c)?(0,r.jsx)(r.Fragment,{children:l??i}):(0,r.jsx)(r.Fragment,{children:s??i})}e.s(["WorkDataView",()=>s])},430876,e=>{"use strict";var r=e.i(111043),t=e.i(970799);e.i(116233);var a=e.i(363712),s=e.i(999),l=e.i(691225),i=e.i(913532),n=e.i(605278),d=e.i(375308),o=e.i(989239);let c=(0,t.createContext)(null),u=(0,t.createContext)(null),m="kanban-column-";function b(e,r,t){let a=Object.fromEntries(e.map(e=>[e.id,[]]));return r.reduce((e,r)=>{let a=t(r);return e[a]||(e[a]=[]),e[a]=[...e[a],r],e},a)}function g({columns:e,data:a,onDataChange:i,onItemMove:d,getColumnId:u,children:g,className:h,pointerSensorOptions:x,renderDragOverlay:p}){let f=(0,t.useCallback)(u??(e=>e.columnId),[]),[y,k]=(0,t.useState)(()=>b(e,a,f)),[v,w]=(0,t.useState)(null),j=(0,t.useRef)(e);(0,t.useEffect)(()=>{j.current=e},[e]),(0,t.useEffect)(()=>{k(b(e,a,f))},[e,a,f]);let N=(0,s.useSensors)((0,s.useSensor)(s.PointerSensor,{activationConstraint:{distance:6},...x}),(0,s.useSensor)(s.KeyboardSensor,{coordinateGetter:l.sortableKeyboardCoordinates})),C=(0,t.useCallback)(e=>{for(let r of j.current){let t=y[r.id]??[],a=t.findIndex(r=>r.id===e);if(-1!==a)return{columnId:r.id,item:t[a],index:a}}return null},[y]),S=(0,t.useCallback)(e=>{let r=C(e.active.id);r&&w({item:r.item,columnId:r.columnId})},[C]),A=(0,t.useCallback)(e=>{var r;let{active:t,over:a}=e;if(w(null),!a)return;let s=C(t.id);if(!s)return;let l=null,n=null;if("string"==typeof a.id&&a.id.startsWith(m))n=(y[l=a.id.replace(m,"")]??[]).length;else{let e=C(a.id);e&&(l=e.columnId,n=(y[e.columnId]??[]).findIndex(r=>r.id===e.item.id))}if(null===l||null===n||l===s.columnId&&n===s.index)return;let o=Object.fromEntries(Object.entries(y).map(([e,r])=>[e,r.slice()])),c=o[s.columnId]??[],[u]=c.splice(s.index,1);o[s.columnId]=c;let b=o[l]??[],g=s.columnId===l&&s.index<n?n-1:n,h={...u,columnId:l};b.splice(g,0,h),o[l]=b,k(o);let x=(r=j.current,r.flatMap(e=>o[e.id]??[]));i?.(x),d&&d({item:h,fromColumnId:s.columnId,toColumnId:l,toIndex:g})},[C,y,i,d]),D=(0,t.useMemo)(()=>({columns:e,getItems:e=>y[e]??[],findItem:C,activeItem:v}),[e,y,C,v]);return(0,r.jsx)(c.Provider,{value:D,children:(0,r.jsxs)(s.DndContext,{collisionDetection:s.closestCorners,onDragCancel:()=>w(null),onDragEnd:A,onDragStart:S,sensors:N,children:[(0,r.jsx)("div",{className:(0,o.cn)("flex w-full gap-4 overflow-x-auto px-6 py-4 md:px-8 lg:px-10",h),children:g}),(0,r.jsx)(s.DragOverlay,{children:v?p?p(v.item):(0,r.jsx)(n.Card,{className:"border-border/70 bg-background/95 w-[280px] max-w-[320px] border p-3 shadow-lg",children:(0,r.jsx)("p",{className:"text-sm font-medium",children:String(v.item.id)})}):null})]})})}function h({column:e,children:t,className:a}){return(0,r.jsx)(u.Provider,{value:e,children:(0,r.jsx)("section",{"aria-label":`${e.name} column`,className:(0,o.cn)("kanban-column border-border/60 from-background via-background/60 to-muted/40 flex h-full min-w-[320px] flex-1 flex-col rounded-2xl border bg-gradient-to-b shadow-sm ring-1 ring-black/5 backdrop-blur-sm transition hover:shadow-md",a),children:t})})}function x({children:e,className:t}){return(0,r.jsx)("header",{className:(0,o.cn)("bg-background/90 sticky top-0 z-10 flex items-center justify-between gap-2 rounded-t-2xl px-4 py-3 backdrop-blur-sm",t),children:e})}function p({columnId:e,children:a,emptyState:i,className:n,height:u="28rem"}){let{getItems:b}=function(){let e=(0,t.useContext)(c);if(!e)throw Error("useKanbanContext must be used within a KanbanProvider");return e}(),g=b(e),{setNodeRef:h,isOver:x}=(0,s.useDroppable)({id:`${m}${e}`});return(0,r.jsx)(l.SortableContext,{items:g.map(e=>e.id),strategy:l.verticalListSortingStrategy,children:(0,r.jsx)(d.ScrollArea,{className:"kanban-scroll flex-1",children:(0,r.jsxs)("div",{className:(0,o.cn)("kanban-column-cards bg-muted/30 flex min-h-[120px] flex-col gap-3 rounded-2xl p-3 transition",x&&"ring-primary/60 ring-2 ring-offset-2",n),"data-drop-state":x?"active":"inactive",ref:h,style:{minHeight:u},children:[0===g.length&&i,g.map((e,r)=>a(e,r))]})})})}function f({itemId:e,children:t,className:a}){let{attributes:s,listeners:d,setNodeRef:c,transform:u,transition:m,isDragging:b}=(0,l.useSortable)({id:e}),g={transform:i.CSS.Transform.toString(u),transition:m};return(0,r.jsx)(n.Card,{className:(0,o.cn)("border-border/70 bg-background/95 focus-visible:ring-ring grid gap-3 rounded-xl border p-4 text-left shadow-sm ring-0 transition-all outline-none hover:-translate-y-0.5 hover:shadow-md focus-visible:ring-2",b&&"border-primary/60 scale-[1.01] opacity-80 shadow-lg",a),"data-dragging":b?"":void 0,ref:c,style:g,...d,...s,children:t})}function y({data:e,columns:s,mapToKanbanItem:l,updateEntityStatus:i,renderCard:n,renderDragOverlay:d,calculateColumnMeta:o,onItemMove:c,entityName:u="items",emptyStateMessage:m,showTotals:b=!1,formatTotal:y}){let[k,v]=(0,t.useState)(()=>e.map(l)),w=o||((e,r)=>({count:r.filter(r=>r.columnId===e).length})),j=(0,t.useMemo)(()=>{let e={};return s.forEach(r=>{e[r.id]=w(r.id,k)}),e},[s,k,w]),N=(0,t.useMemo)(()=>s.map(e=>({id:e.id,name:e.name,accentColor:e.accentColor})),[s]),C=m||(e=>`No ${u} in ${e}`);return(0,r.jsx)(g,{className:"pb-4",columns:N,data:k,onDataChange:e=>{i?v(e.map(e=>({...e,entity:i(e.entity,e.columnId)}))):v(e)},onItemMove:c,renderDragOverlay:d||(e=>(0,r.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg",children:n(e)})),children:s.map(e=>{let t=j[e.id]??{count:0};return(0,r.jsxs)(h,{className:"min-h-[300px] flex-1",column:N.find(r=>r.id===e.id),children:[(0,r.jsx)(x,{children:(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("span",{"aria-hidden":"true",className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:e.accentColor}}),(0,r.jsx)("span",{className:"text-foreground text-sm font-semibold",children:e.name}),(0,r.jsxs)(a.Badge,{className:"bg-muted text-muted-foreground rounded-full px-2 py-0 text-xs font-medium",variant:"secondary",children:[t.count," ",u]}),b&&void 0!==t.total&&y&&(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:y(t.total)}),b&&void 0!==t.value&&y&&(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:y(t.value)})]})}),(0,r.jsx)(p,{className:"min-h-[200px]",columnId:e.id,emptyState:(0,r.jsx)("div",{className:"border-border/60 bg-background/60 text-muted-foreground rounded-xl border border-dashed p-4 text-center text-xs",children:C(e.name)}),children:e=>(0,r.jsx)(f,{itemId:e.id,children:n(e)},e.id)})]},e.id)})})}e.s(["EntityKanban",()=>y],430876)},951801,e=>{"use strict";e.i(116233),e.s([])},923225,e=>{"use strict";let r=(0,e.i(383206).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>r])},630754,e=>{"use strict";var r=e.i(923225);e.s(["CheckCircle",()=>r.default])},321561,e=>{"use strict";let r=(0,e.i(383206).default)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);e.s(["default",()=>r])},794712,e=>{"use strict";var r=e.i(111043);e.i(116233);var t=e.i(363712),a=e.i(989239),s=e.i(818796),l=e.i(276389),i=e.i(630754),n=e.i(136764),d=e.i(606661),o=e.i(321561),o=o,c=e.i(559586),u=e.i(900007);function m(e){return({quoted:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:"Quoted",icon:d.FileText,ariaLabel:"Job status: Quoted"},scheduled:{className:"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400",label:"Scheduled",icon:l.Calendar,ariaLabel:"Job status: Scheduled"},in_progress:{className:"border-blue-500/50 bg-blue-500 text-white hover:bg-blue-600",label:"In Progress",icon:o.default,ariaLabel:"Job status: In Progress"},completed:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Completed",icon:i.CheckCircle,ariaLabel:"Job status: Completed"},cancelled:{className:"border-red-500/50 bg-red-500 text-white hover:bg-red-600",label:"Cancelled",icon:u.XCircle,ariaLabel:"Job status: Cancelled"}})[e]||{className:"border-border/50 bg-background text-muted-foreground",label:e.replace(/_/g," ")}}function b({status:e,type:l,priority:o,contractType:u,className:b,variant:g="outline"}){let h,x=(h=u?({service:{className:"border-blue-200/50 bg-blue-50/50 text-blue-700 dark:border-blue-900/50 dark:bg-blue-950/30 dark:text-blue-400",label:"Service"},maintenance:{className:"border-green-200/50 bg-green-50/50 text-green-700 dark:border-green-900/50 dark:bg-green-950/30 dark:text-green-400",label:"Maintenance"},custom:{className:"border-purple-200/50 bg-purple-50/50 text-purple-700 dark:border-purple-900/50 dark:bg-purple-950/30 dark:text-purple-400",label:"Custom"}})[u]||{className:"border-purple-200/50 bg-purple-50/50 text-purple-700 dark:border-purple-900/50 dark:bg-purple-950/30 dark:text-purple-400",label:u.replace(/_/g," ")}:o?({low:{className:"border-blue-200/50 bg-blue-50/50 text-blue-700 dark:border-blue-900/50 dark:bg-blue-950/30 dark:text-blue-400",label:"Low"},medium:{className:"border-yellow-200/50 bg-yellow-50/50 text-yellow-700 dark:border-yellow-900/50 dark:bg-yellow-950/30 dark:text-yellow-400",label:"Medium"},high:{className:"border-orange-200/50 bg-orange-50/50 text-orange-700 dark:border-orange-900/50 dark:bg-orange-950/30 dark:text-orange-400",label:"High"},urgent:{className:"border-red-200/50 bg-red-50/50 text-red-700 dark:border-red-900/50 dark:bg-red-950/30 dark:text-red-400",label:"Urgent"}})[o]||{className:"border-border/50 bg-background text-muted-foreground",label:o.replace(/_/g," ")}:"purchase_order"===l?({draft:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:"Draft"},pending:{className:"border-yellow-200/50 bg-yellow-50/50 text-yellow-700 dark:border-yellow-900/50 dark:bg-yellow-950/30 dark:text-yellow-400",label:"Pending"},approved:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Approved"},partially_received:{className:"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400",label:"Partially Received"},received:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Received"},cancelled:{className:"border-red-500/50 bg-red-500 text-white hover:bg-red-600",label:"Cancelled"}})[e]||{className:"border-border/50 bg-background text-muted-foreground",label:e.replace(/_/g," ")}:l?function(e,r){switch(r){case"job":return m(e);case"invoice":return({paid:{className:"border-green-500/30 bg-green-500 text-white hover:bg-green-600 shadow-sm",label:"Paid",icon:i.CheckCircle,ariaLabel:"Invoice status: Paid"},unpaid:{className:"border-yellow-200/50 bg-yellow-50/50 text-yellow-700 dark:border-yellow-900/50 dark:bg-yellow-950/30 dark:text-yellow-400 shadow-sm",label:"Unpaid",icon:n.Clock,ariaLabel:"Invoice status: Unpaid"},overdue:{className:"border-red-500/30 bg-red-500 text-white hover:bg-red-600 shadow-sm ring-1 ring-red-500/20",label:"Overdue",icon:s.AlertCircle,ariaLabel:"Invoice status: Overdue - requires immediate attention"},draft:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50 shadow-sm",label:"Draft",icon:d.FileText,ariaLabel:"Invoice status: Draft"},sent:{className:"border-blue-200/50 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400 shadow-sm",label:"Sent",icon:c.Mail,ariaLabel:"Invoice status: Sent"},pending:{className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400 shadow-sm",label:"Pending",icon:n.Clock,ariaLabel:"Invoice status: Pending"}})[e]||{className:"border-border/50 bg-background text-muted-foreground shadow-sm",label:e.replace(/_/g," ")};case"estimate":return({accepted:{className:"bg-green-500 hover:bg-green-600 text-white",label:"Accepted"},sent:{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",label:"Sent"},draft:{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:"Draft"},declined:{className:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",label:"Declined"}})[e]||{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:e.replace(/_/g," ")};case"contract":return({signed:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Signed"},sent:{className:"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400",label:"Sent"},viewed:{className:"border-purple-200/50 bg-purple-50/50 text-purple-700 dark:border-purple-900/50 dark:bg-purple-950/30 dark:text-purple-400",label:"Viewed"},draft:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:"Draft"},rejected:{className:"border-red-500/50 bg-red-500 text-white hover:bg-red-600",label:"Rejected"},expired:{className:"border-orange-200/50 bg-orange-50/50 text-orange-700 dark:border-orange-900/50 dark:bg-orange-950/30 dark:text-orange-400",label:"Expired"}})[e]||{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:e.replace(/_/g," ")};case"customer":return({active:{className:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",label:"Active"},inactive:{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:"Inactive"},prospect:{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",label:"Prospect"},lead:{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",label:"Lead"}})[e]||{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:e.replace(/_/g," ")};default:return{className:"border-border/50 bg-background text-muted-foreground",label:e.replace(/_/g," ")}}}(e,l):m(e)).icon;return(0,r.jsxs)(t.Badge,{className:(0,a.cn)("inline-flex items-center gap-1 px-2 py-0.5 text-[11px] font-medium transition-all duration-200",h.className,b),variant:g,"aria-label":h.ariaLabel||h.label,children:[x&&(0,r.jsx)(x,{className:"h-3 w-3","aria-hidden":"true"}),h.label]})}function g({status:e,className:t}){return(0,r.jsx)(b,{className:t,status:e,type:"job"})}function h({status:e,className:t}){return(0,r.jsx)(b,{className:t,status:e,type:"invoice"})}function x({status:e,className:t}){return(0,r.jsx)(b,{className:t,status:e,type:"estimate"})}function p({status:e,className:t}){return(0,r.jsx)(b,{className:t,status:e,type:"contract"})}function f({status:e,className:t}){return(0,r.jsx)(b,{className:t,status:e,type:"customer"})}function y({priority:e,className:t}){return(0,r.jsx)(b,{className:t,priority:e,status:""})}function k({type:e,className:t}){return(0,r.jsx)(b,{className:t,contractType:e,status:""})}e.s(["ContractStatusBadge",()=>p,"ContractTypeBadge",()=>k,"CustomerStatusBadge",()=>f,"EstimateStatusBadge",()=>x,"InvoiceStatusBadge",()=>h,"JobStatusBadge",()=>g,"PriorityBadge",()=>y,"StatusBadge",()=>b],794712)},534631,e=>{"use strict";e.i(116233),e.s([])},55029,e=>{"use strict";var r=e.i(111043),t=e.i(946672),a=e.i(327149),s=e.i(664136),l=e.i(367571),i=e.i(606661),n=e.i(371526),d=e.i(176378),o=e.i(970799),c=e.i(8392),u=e.i(559586),m=e.i(939397),b=e.i(14435);e.i(889265);var g=e.i(677607);e.i(951801);var h=e.i(622608);e.i(220474);var x=e.i(171056),p=e.i(960876);function f({customer:e}){let t=(0,p.getCustomerDisplayName)(e);return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-start gap-3",children:[(0,r.jsx)("div",{className:"bg-primary/10 flex h-10 w-10 items-center justify-center rounded-full shrink-0",children:(0,r.jsx)(b.User,{className:"text-primary h-5 w-5"})}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"font-semibold text-sm",children:t}),e.company_name&&(0,r.jsx)("p",{className:"text-muted-foreground text-xs",children:e.company_name})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[e.email&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(u.Mail,{className:"h-3.5 w-3.5 text-muted-foreground shrink-0"}),(0,r.jsx)("a",{href:`mailto:${e.email}`,className:"text-primary hover:underline truncate",onClick:e=>e.stopPropagation(),children:e.email})]}),e.phone&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-xs",children:[(0,r.jsx)(m.Phone,{className:"h-3.5 w-3.5 text-muted-foreground shrink-0"}),(0,r.jsx)("a",{href:`tel:${e.phone}`,className:"text-primary hover:underline",onClick:e=>e.stopPropagation(),children:e.phone})]})]})]})}function y({customer:e,className:t}){let[a,s]=(0,o.useState)(!1),l=(0,p.getCustomerDisplayName)(e);return(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsxs)(h.HoverCard,{children:[(0,r.jsx)(h.HoverCardTrigger,{asChild:!0,children:(0,r.jsxs)(d.default,{href:`/dashboard/customers/${e.id}`,onClick:e=>e.stopPropagation(),className:"text-sm hover:underline hover:text-primary flex items-center gap-1.5 truncate",children:[(0,r.jsx)(b.User,{className:"h-3.5 w-3.5 shrink-0 text-muted-foreground"}),(0,r.jsx)("span",{className:"truncate",children:l})]})}),(0,r.jsx)(h.HoverCardContent,{className:"w-80",align:"start",children:(0,r.jsx)(f,{customer:e})})]}),(0,r.jsxs)(x.Popover,{open:a,onOpenChange:s,children:[(0,r.jsx)(x.PopoverTrigger,{asChild:!0,children:(0,r.jsx)(g.Button,{variant:"ghost",size:"sm",className:"h-5 w-5 p-0 shrink-0","aria-label":`View ${l} contact information`,onClick:e=>e.stopPropagation(),children:(0,r.jsx)(c.Info,{className:"h-3.5 w-3.5 text-muted-foreground"})})}),(0,r.jsx)(x.PopoverContent,{className:"w-80",align:"start",children:(0,r.jsx)(f,{customer:e})})]})]})}e.i(235670);var k=e.i(360648),v=e.i(527756);e.i(534631);var w=e.i(122942),j=e.i(794712),N=e.i(871509),C=e.i(274220);function S({jobs:c,itemsPerPage:u=50,totalCount:m,currentPage:b=1,onJobClick:h,showRefresh:x=!1,initialSearchQuery:f=""}){let S=(0,C.useArchiveStore)(e=>e.filters.jobs),[A,D]=(0,o.useState)(!1),[I,M]=(0,o.useState)(null),[P,_]=(0,o.useState)(!1),[B,T]=(0,o.useState)(new Set),E=c.filter(e=>{let r=!!(e.archived_at??e.deleted_at);return"active"===S?!r:"archived"!==S||r}),U=[{key:"jobNumber",header:"Job Number",width:"w-36",shrink:!0,render:e=>(0,r.jsx)(d.default,{className:"text-foreground hover:text-primary text-sm font-medium transition-colors hover:underline",href:`/dashboard/work/${e.id}`,onClick:e=>e.stopPropagation(),children:e.jobNumber??"—"})},{key:"title",header:"Title",width:"flex-1",render:e=>(0,r.jsxs)(d.default,{className:"block min-w-0",href:`/dashboard/work/${e.id}`,onClick:e=>e.stopPropagation(),children:[(0,r.jsx)("div",{className:"truncate text-sm leading-tight font-medium hover:underline",children:e.title??"Untitled Job"}),e.description?(0,r.jsx)("div",{className:"text-muted-foreground mt-0.5 truncate text-xs leading-tight",children:e.description}):null]})},{key:"customer",header:"Customer",width:"w-48",shrink:!0,hideOnMobile:!0,hideable:!0,render:e=>{let t=e.customer||e.customers;return t?((0,p.getCustomerDisplayName)(t),(0,r.jsx)(y,{customer:t})):(0,r.jsx)("span",{className:"text-muted-foreground text-xs",children:"—"})}},{key:"status",header:"Status",width:"w-32",shrink:!0,hideable:!1,render:e=>(0,r.jsx)(j.JobStatusBadge,{status:e.status??"quoted"})},{key:"priority",header:"Priority",width:"w-28",shrink:!0,hideOnMobile:!0,hideable:!0,render:e=>(0,r.jsx)(j.PriorityBadge,{priority:e.priority??"medium"})},{key:"scheduledStart",header:"Scheduled",width:"w-32",shrink:!0,hideOnMobile:!0,hideable:!0,render:e=>(0,r.jsx)("span",{className:"text-muted-foreground text-sm tabular-nums",children:(0,N.formatDate)(e.scheduledStart??null,"short")})},{key:"totalAmount",header:"Amount",width:"w-32",shrink:!0,align:"right",hideable:!1,render:e=>(0,r.jsx)("span",{className:"font-semibold tabular-nums",children:(0,N.formatCurrency)(e.totalAmount||0,{decimals:2})})},{key:"actions",header:"",width:"w-10",shrink:!0,render:e=>(0,r.jsx)(w.RowActionsDropdown,{actions:[{label:"View Details",icon:l.Eye,href:`/dashboard/work/${e.id}`},{label:"Edit Job",icon:s.Edit,href:`/dashboard/work/${e.id}/edit`},{label:"Create Invoice",icon:i.FileText,href:`/dashboard/work/invoices/new?jobId=${e.id}`,separatorBefore:!0},{label:"Archive Job",icon:t.Archive,variant:"destructive",separatorBefore:!0,onClick:()=>{M(e.id),D(!0)}}]})}],$=[{label:"Archive Selected",icon:(0,r.jsx)(t.Archive,{className:"h-4 w-4"}),onClick:e=>{T(e),_(!0)},variant:"destructive"}];return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.FullWidthDataTable,{bulkActions:$,columns:U,data:E,totalCount:m,currentPageFromServer:b,initialSearchQuery:f,serverPagination:!0,emptyAction:(0,r.jsxs)(g.Button,{onClick:()=>{window.location.href="/dashboard/work/new"},size:"sm",children:[(0,r.jsx)(n.Plus,{className:"mr-2 size-4"}),"Add Job"]}),emptyIcon:(0,r.jsx)(a.Briefcase,{className:"text-muted-foreground h-8 w-8"}),emptyMessage:"No jobs found",enableSelection:!0,entity:"jobs",getItemId:e=>e.id,isArchived:e=>!!(e.archived_at??e.deleted_at),itemsPerPage:u,onRefresh:()=>{window.location.reload()},onRowClick:e=>{h?h(e):window.location.href=`/dashboard/work/${e.id}`},serverSearch:!0,searchParamKey:"search",searchPlaceholder:"Search jobs by customer, category, equipment, service type...",showArchived:"active"!==S,showRefresh:x}),(0,r.jsx)(k.AlertDialog,{onOpenChange:D,open:A,children:(0,r.jsxs)(k.AlertDialogContent,{children:[(0,r.jsxs)(k.AlertDialogHeader,{children:[(0,r.jsx)(k.AlertDialogTitle,{children:"Archive Job?"}),(0,r.jsx)(k.AlertDialogDescription,{children:"This job will be archived and can be restored within 90 days."})]}),(0,r.jsxs)(k.AlertDialogFooter,{children:[(0,r.jsx)(k.AlertDialogCancel,{children:"Cancel"}),(0,r.jsx)(k.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{if(I){let{archiveJob:r}=await e.A(805737);(await r(I)).success&&window.location.reload()}},children:"Archive"})]})]})}),(0,r.jsx)(k.AlertDialog,{onOpenChange:_,open:P,children:(0,r.jsxs)(k.AlertDialogContent,{children:[(0,r.jsxs)(k.AlertDialogHeader,{children:[(0,r.jsxs)(k.AlertDialogTitle,{children:["Archive ",B.size," Job(s)?"]}),(0,r.jsxs)(k.AlertDialogDescription,{children:[B.size," job(s) will be archived and can be restored within 90 days."]})]}),(0,r.jsxs)(k.AlertDialogFooter,{children:[(0,r.jsx)(k.AlertDialogCancel,{children:"Cancel"}),(0,r.jsx)(k.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{let{archiveJob:r}=await e.A(805737),t=0;for(let e of B)(await r(e)).success&&t++;t>0&&window.location.reload()},children:"Archive"})]})]})})]})}e.s(["JobsTable",()=>S],55029)},316173,e=>{"use strict";let r=(0,e.i(383206).default)("briefcase-business",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);e.s(["default",()=>r])},10267,e=>{"use strict";var r=e.i(111043),t=e.i(550652),a=e.i(316173),a=a,s=e.i(560149),l=e.i(15751),i=e.i(176378),n=e.i(970799);e.i(553153);var d=e.i(363712);e.i(889265);var o=e.i(677607),c=e.i(430876),u=e.i(51052),m=e.i(871509),b=e.i(152088);let g=[{id:"quoted",name:"Quoted",accentColor:"#6B7280"},{id:"scheduled",name:"Scheduled",accentColor:"#2563EB"},{id:"in_progress",name:"In Progress",accentColor:"#F97316"},{id:"on_hold",name:"On Hold",accentColor:"#F59E0B"},{id:"completed",name:"Completed",accentColor:"#22C55E"},{id:"cancelled",name:"Cancelled",accentColor:"#EF4444"}],h=new Map(g.map(e=>[e.id,e.name])),x="quoted";function p({priority:e}){let{label:t,className:a}={low:{label:"Low",className:"border-primary/60 bg-primary/60 text-primary dark:border-primary/40 dark:bg-primary/40 dark:text-primary"},medium:{label:"Medium",className:"border-warning/60 bg-warning/60 text-warning dark:border-warning/40 dark:bg-warning/40 dark:text-warning"},high:{label:"High",className:"border-warning/60 bg-warning/60 text-warning dark:border-warning/40 dark:bg-warning/40 dark:text-warning"},urgent:{label:"Urgent",className:"border-destructive/60 bg-destructive/60 text-destructive dark:border-destructive/40 dark:bg-destructive/40 dark:text-destructive"}}[e??"medium"];return(0,r.jsx)(d.Badge,{className:(0,b.cn)("text-xs font-medium",a),variant:"outline",children:t})}function f({item:e}){let n=e.entity,c=e.columnId,u=n.scheduledStart?(0,m.formatDateRange)(n.scheduledStart,n.scheduledEnd??void 0):null,b=function(e){let r=e.properties;if(!r)return null;let t=[r.address],a=[r.city,r.state].filter(Boolean).join(", ");return a&&t.push(a),t.filter(Boolean).join(" • ")}(n);return(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)(i.default,{className:"text-muted-foreground hover:text-primary block text-xs font-semibold tracking-wide uppercase",href:`/dashboard/work/${n.id}`,children:String(n.jobNumber??"—")}),(0,r.jsx)("h3",{className:"text-foreground text-sm leading-snug font-semibold",children:n.title??"Untitled Job"}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[n.jobType&&(0,r.jsx)(d.Badge,{className:"bg-primary/10 text-primary",variant:"secondary",children:n.jobType}),(0,r.jsx)(p,{priority:n.priority??"medium"}),"number"==typeof n.aiPriorityScore&&(0,r.jsxs)(d.Badge,{className:"border-primary/40 bg-primary/5 text-primary border-dashed",variant:"outline",children:["AI Score ",n.aiPriorityScore]})]})]}),(0,r.jsx)("span",{className:"text-foreground text-sm font-semibold",children:(0,m.formatCurrency)(n.totalAmount)})]}),n.description&&(0,r.jsx)("p",{className:"text-muted-foreground line-clamp-3 text-xs",children:n.description}),(0,r.jsxs)("div",{className:"text-muted-foreground space-y-2 text-xs",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(a.default,{className:"text-primary size-4"}),(0,r.jsx)("span",{className:"text-foreground font-medium",children:function(e){let r=e.customers;if(!r)return"Unassigned customer";if(r.display_name)return r.display_name;let t=[r.first_name,r.last_name].filter(Boolean);return t.length>0?t.join(" "):r.company_name||"Unassigned customer"}(n)})]}),b&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(l.MapPin,{className:"text-primary size-4"}),(0,r.jsx)("span",{children:b})]}),u&&(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(s.CalendarDays,{className:"text-primary size-4"}),(0,r.jsx)("span",{children:u})]})]}),(0,r.jsxs)("div",{className:"text-muted-foreground flex items-center justify-between pt-2 text-[11px] tracking-wide",children:[(0,r.jsxs)("span",{children:["Updated ",(0,m.formatDate)(n.updatedAt,{preset:"short"})]}),(0,r.jsx)("span",{className:"uppercase",children:c?h.get(c)??c:"—"})]}),(0,r.jsx)("div",{className:"flex items-center justify-end pt-1",children:(0,r.jsx)(o.Button,{asChild:!0,className:"text-primary gap-1 text-xs",size:"sm",variant:"ghost",children:(0,r.jsxs)(i.default,{href:`/dashboard/work/${n.id}`,children:["View",(0,r.jsx)(t.ArrowUpRight,{className:"size-3.5"})]})})})]})}function y({jobs:t}){let{toast:a}=(0,u.useToast)(),[s,l]=(0,n.useTransition)(),i=async({item:r,fromColumnId:t,toColumnId:s})=>{t!==s&&l(()=>{(async()=>{let{updateJobStatus:t}=await e.A(805737),l=await t(r.entity.id,s);if(!l.success)return a.error("Unable to move job",{description:l.error});a.success(`Job ${r.entity.jobNumber} moved to ${h.get(s)}`)})()})};return(0,r.jsx)(c.EntityKanban,{calculateColumnMeta:(e,r)=>{let t=r.filter(r=>r.columnId===e),a=t.reduce((e,r)=>e+(r.entity.totalAmount??0),0);return{count:t.length,total:a}},columns:g,data:t,entityName:"jobs",formatTotal:e=>(0,m.formatCurrency)(e),mapToKanbanItem:e=>{var r;return{id:e.id,columnId:(r=e.status)&&h.has(r)?r:x,entity:e}},onItemMove:i,renderCard:e=>(0,r.jsx)(f,{item:e}),renderDragOverlay:e=>(0,r.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-md border p-3 shadow-lg",children:(0,r.jsx)(f,{item:e})}),showTotals:!0,updateEntityStatus:(e,r)=>({...e,status:r})})}e.s(["JobsKanban",()=>y],10267)},805737,e=>{e.v(r=>Promise.all(["static/chunks/b38eb0e05b763b4c.js"].map(r=>e.l(r))).then(()=>r(773915)))}]);