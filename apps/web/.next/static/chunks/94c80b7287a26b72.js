(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,883018,e=>{"use strict";let t=(0,e.i(383206).default)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);e.s(["default",()=>t])},848475,e=>{"use strict";var t=e.i(883018);e.s(["MoreVertical",()=>t.default])},237833,e=>{"use strict";let t=(0,e.i(399168).create)(e=>({actions:{},setActions:(t,a)=>e(e=>({actions:{...e.actions,[t]:a}})),clearActions:t=>e(e=>{let a={...e.actions};return delete a[t],{actions:a}}),clearAll:()=>e({actions:{}})}));e.s(["useToolbarActionsStore",0,t])},819260,e=>{"use strict";let t=(0,e.i(383206).default)("panel-left",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]);e.s(["default",()=>t])},243099,e=>{"use strict";var t=e.i(970799);function a(){let[e,a]=t.useState(void 0);return t.useEffect(()=>{let e=window.matchMedia("(max-width: 767px)"),t=()=>{a(window.innerWidth<768)};return e.addEventListener("change",t),a(window.innerWidth<768),()=>e.removeEventListener("change",t)},[]),!!e}e.s(["useIsMobile",()=>a])},24079,e=>{"use strict";var t=e.i(111043),a=e.i(614433),s=e.i(294237),r=e.i(819260),r=r,n=e.i(970799);e.i(116233);var i=e.i(677607);e.i(635613),e.i(120109);var d=e.i(508420);e.i(861308);var c=e.i(513990),o=e.i(989239),l=e.i(243099);let u=n.createContext(null);function m(){let e=n.useContext(u);return e||{state:"expanded",open:!0,setOpen:()=>{},openMobile:!1,setOpenMobile:()=>{},isMobile:!1,toggleSidebar:()=>{}}}function x({defaultOpen:e=!0,open:a,onOpenChange:s,className:r,style:i,children:d,...m}){let x=(0,l.useIsMobile)(),[p,b]=n.useState(!1),[h,f]=n.useState(e),g=a??h,v=n.useCallback(e=>{let t="function"==typeof e?e(g):e;s?s(t):f(t),document.cookie=`sidebar_state=${t}; path=/; max-age=604800`},[s,g]),y=n.useCallback(()=>x?b(e=>!e):v(e=>!e),[x,v]);n.useEffect(()=>{let e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),y())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[y]);let j=g?"expanded":"collapsed",w=n.useMemo(()=>({state:j,open:g,setOpen:v,isMobile:x,openMobile:p,setOpenMobile:b,toggleSidebar:y}),[j,g,v,x,p,y]);return(0,t.jsx)(u.Provider,{value:w,children:(0,t.jsx)(c.TooltipProvider,{delayDuration:0,children:(0,t.jsx)("div",{className:(0,o.cn)("group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full",r),"data-slot":"sidebar-wrapper",style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...i},...m,children:d})})})}function p({side:e="left",variant:a="sidebar",collapsible:s="offcanvas",className:r,children:n,...i}){let{isMobile:c,state:l,openMobile:u,setOpenMobile:x}=m();return"none"===s?(0,t.jsx)("div",{className:(0,o.cn)("bg-sidebar text-sidebar-foreground flex h-full w-(--sidebar-width) flex-col",r),"data-slot":"sidebar",...i,children:n}):c?(0,t.jsx)(d.Sheet,{onOpenChange:x,open:u,...i,children:(0,t.jsxs)(d.SheetContent,{className:"bg-sidebar text-sidebar-foreground w-(--sidebar-width) p-0 [&>button]:hidden","data-mobile":"true","data-sidebar":"sidebar","data-slot":"sidebar",side:e,style:{"--sidebar-width":"18rem"},children:[(0,t.jsxs)(d.SheetHeader,{className:"sr-only",children:[(0,t.jsx)(d.SheetTitle,{children:"Sidebar"}),(0,t.jsx)(d.SheetDescription,{children:"Displays the mobile sidebar."})]}),(0,t.jsx)("div",{className:"flex h-full w-full flex-col",children:n})]})}):(0,t.jsxs)("div",{className:"group peer text-sidebar-foreground hidden md:block","data-collapsible":"collapsed"===l?s:"","data-side":e,"data-slot":"sidebar","data-state":l,"data-variant":a,children:[(0,t.jsx)("div",{className:(0,o.cn)("relative w-(--sidebar-width) bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===a||"inset"===a?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4)))]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)"),"data-slot":"sidebar-gap"}),(0,t.jsx)("div",{className:(0,o.cn)("sidebar"===a?"sticky top-[calc(var(--header-height)+1px)] z-30 hidden h-[calc(100svh-var(--footer-height)-4rem)] overscroll-none bg-transparent lg:flex":"fixed inset-y-0 top-(--header-height) z-10 hidden h-[calc(100svh-var(--header-height))]! h-svh transition-[left,right,width] duration-200 ease-linear md:flex","sidebar"===a?"w-(--sidebar-width) flex-col":"w-(--sidebar-width)","sidebar"!==a&&["left"===e?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===a||"inset"===a?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+(--spacing(4))+2px)]":"group-data-[collapsible=icon]:w-(--sidebar-width-icon)"],r),"data-slot":"sidebar-container",...i,children:(0,t.jsx)("div",{className:(0,o.cn)("flex h-full w-full flex-col","sidebar"===a&&"bg-transparent","sidebar"!==a&&"bg-sidebar group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm"),"data-sidebar":"sidebar","data-slot":"sidebar-inner",children:n})})]})}function b({className:e,onClick:a,...s}){let{toggleSidebar:n}=m();return(0,t.jsxs)(i.Button,{className:(0,o.cn)("size-7",e),"data-sidebar":"trigger","data-slot":"sidebar-trigger",onClick:e=>{a?.(e),n()},size:"icon",variant:"ghost",...s,children:[(0,t.jsx)(r.default,{}),(0,t.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}function h({className:e,...a}){let{toggleSidebar:s}=m();return(0,t.jsx)("button",{"aria-label":"Toggle Sidebar",className:(0,o.cn)("hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex","in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),"data-sidebar":"rail","data-slot":"sidebar-rail",onClick:s,tabIndex:-1,title:"Toggle Sidebar",...a})}function f({className:e,...a}){return(0,t.jsx)("main",{className:(0,o.cn)("bg-background relative flex w-full flex-col overflow-hidden rounded-tl-xl","h-full",e),"data-slot":"sidebar-inset",...a})}function g({className:e,...a}){return(0,t.jsx)("div",{className:(0,o.cn)("flex flex-col gap-2 p-2",e),"data-sidebar":"header","data-slot":"sidebar-header",...a})}function v({className:e,...a}){return(0,t.jsx)("div",{className:(0,o.cn)("flex flex-col gap-2 p-2",e),"data-sidebar":"footer","data-slot":"sidebar-footer",...a})}let y=n.forwardRef(({className:e,children:a,...s},r)=>(0,t.jsx)("div",{ref:r,className:(0,o.cn)("no-scrollbar flex min-h-0 flex-1 flex-col gap-2 overflow-auto overflow-x-hidden px-2 group-data-[collapsible=icon]:overflow-hidden",e),"data-sidebar":"content","data-slot":"sidebar-content",...s,children:a}));function j({className:e,...a}){return(0,t.jsx)("div",{className:(0,o.cn)("relative flex w-full min-w-0 flex-col p-2",e),"data-sidebar":"group","data-slot":"sidebar-group",...a})}function w({className:e,asChild:s=!1,...r}){let n=s?a.Slot:"div";return(0,t.jsx)(n,{className:(0,o.cn)("text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),"data-sidebar":"group-label","data-slot":"sidebar-group-label",...r})}function N({className:e,...a}){return(0,t.jsx)("div",{className:(0,o.cn)("w-full text-sm",e),"data-sidebar":"group-content","data-slot":"sidebar-group-content",...a})}function S({className:e,...a}){return(0,t.jsx)("ul",{className:(0,o.cn)("flex w-full min-w-0 flex-col gap-1",e),"data-sidebar":"menu","data-slot":"sidebar-menu",...a})}function _({className:e,...a}){return(0,t.jsx)("li",{className:(0,o.cn)("group/menu-item relative",e),"data-sidebar":"menu-item","data-slot":"sidebar-menu-item",...a})}y.displayName="SidebarContent";let q=(0,s.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:size-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:p-0!"}},defaultVariants:{variant:"default",size:"default"}});function I({asChild:e=!1,isActive:s=!1,variant:r="default",size:n="default",tooltip:i,className:d,...l}){let u=e?a.Slot:"button",{isMobile:x,state:p}=m(),b=(0,t.jsx)(u,{className:(0,o.cn)(q({variant:r,size:n}),d),"data-active":s,"data-sidebar":"menu-button","data-size":n,"data-slot":"sidebar-menu-button",...l});return i?("string"==typeof i&&(i={children:i}),(0,t.jsxs)(c.Tooltip,{children:[(0,t.jsx)(c.TooltipTrigger,{asChild:!0,children:b}),(0,t.jsx)(c.TooltipContent,{align:"center",hidden:"collapsed"!==p||x,side:"right",...i})]})):b}function k({className:e,asChild:s=!1,showOnHover:r=!1,...n}){let i=s?a.Slot:"button";return(0,t.jsx)(i,{className:(0,o.cn)("text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 md:after:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0",e),"data-sidebar":"menu-action","data-slot":"sidebar-menu-action",...n})}function C({className:e,...a}){return(0,t.jsx)("div",{className:(0,o.cn)("text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),"data-sidebar":"menu-badge","data-slot":"sidebar-menu-badge",...a})}function z({className:e,...a}){return(0,t.jsx)("ul",{className:(0,o.cn)("border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),"data-sidebar":"menu-sub","data-slot":"sidebar-menu-sub",...a})}function E({className:e,...a}){return(0,t.jsx)("li",{className:(0,o.cn)("group/menu-sub-item relative",e),"data-sidebar":"menu-sub-item","data-slot":"sidebar-menu-sub-item",...a})}function T({asChild:e=!1,size:s="md",isActive:r=!1,className:n,...i}){let d=e?a.Slot:"a";return(0,t.jsx)(d,{className:(0,o.cn)("text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px flex-row-reverse items-center justify-end gap-2 overflow-hidden rounded-md px-2 text-right outline-hidden focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===s&&"text-xs","md"===s&&"text-sm","group-data-[collapsible=icon]:hidden",n),"data-active":r,"data-sidebar":"menu-sub-button","data-size":s,"data-slot":"sidebar-menu-sub-button",...i})}e.s(["Sidebar",()=>p,"SidebarContent",()=>y,"SidebarFooter",()=>v,"SidebarGroup",()=>j,"SidebarGroupContent",()=>N,"SidebarGroupLabel",()=>w,"SidebarHeader",()=>g,"SidebarInset",()=>f,"SidebarMenu",()=>S,"SidebarMenuAction",()=>k,"SidebarMenuBadge",()=>C,"SidebarMenuButton",()=>I,"SidebarMenuItem",()=>_,"SidebarMenuSub",()=>z,"SidebarMenuSubButton",()=>T,"SidebarMenuSubItem",()=>E,"SidebarProvider",()=>x,"SidebarRail",()=>h,"SidebarTrigger",()=>b,"useSidebar",()=>m],24079)},306226,e=>{"use strict";e.i(116233),e.s([])},885079,e=>{"use strict";let t=(0,e.i(383206).default)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);e.s(["default",()=>t])},179689,732205,e=>{"use strict";var t=e.i(111043),a=e.i(885079),a=a,s=e.i(848475),r=e.i(287268),n=e.i(212409),i=e.i(970799),d=e.i(237833);function c({pathname:e}){let a=(0,d.useToolbarActionsStore)(t=>t.actions[e]);return((0,i.useEffect)(()=>{a&&document.querySelector(`[data-toolbar-default-actions="${CSS.escape(e)}"]`)?.setAttribute("hidden","true")},[e,a]),a)?(0,t.jsx)(t.Fragment,{children:a}):null}e.i(116233);var o=e.i(231200),l=e.i(146798);function u({pathname:e}){let a=(0,l.useToolbarStatsStore)(t=>t.stats[e]);return((0,i.useEffect)(()=>{a&&a.length>0&&document.querySelector(`[data-toolbar-default-stats="${CSS.escape(e)}"]`)?.setAttribute("hidden","true")},[e,a]),a&&0!==a.length)?(0,t.jsx)(o.ToolbarStats,{stats:a}):null}var m=e.i(818796),x=e.i(852648),p=e.i(160424),b=e.i(452865);function h(){return"undefined"==typeof indexedDB?Promise.reject(Error("IndexedDB not available (server-side rendering)")):new Promise((e,t)=>{let a=indexedDB.open("thorbis-offline",2);a.onerror=()=>{t(Error("Failed to open IndexedDB"))},a.onsuccess=()=>{e(a.result)},a.onupgradeneeded=e=>{let t=e.target.result,a=e.oldVersion;if(!t.objectStoreNames.contains("jobs")){let e=t.createObjectStore("jobs",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1})}if(!t.objectStoreNames.contains("invoices")){let e=t.createObjectStore("invoices",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1})}if(t.objectStoreNames.contains("customers")){if(a<2){let t=e.target.transaction.objectStore("customers");t.indexNames.contains("synced")||t.createIndex("synced","synced",{unique:!1}),t.indexNames.contains("company_id")||t.createIndex("company_id","company_id",{unique:!1}),t.indexNames.contains("status")||t.createIndex("status","status",{unique:!1})}}else{let e=t.createObjectStore("customers",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("email","email",{unique:!1}),e.createIndex("phone","phone",{unique:!1}),e.createIndex("status","status",{unique:!1})}if(a<2){if(!t.objectStoreNames.contains("communications")){let e=t.createObjectStore("communications",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("customer_id","customer_id",{unique:!1}),e.createIndex("type","type",{unique:!1}),e.createIndex("thread_id","thread_id",{unique:!1}),e.createIndex("created_at","created_at",{unique:!1})}if(!t.objectStoreNames.contains("payments")){let e=t.createObjectStore("payments",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("customer_id","customer_id",{unique:!1}),e.createIndex("invoice_id","invoice_id",{unique:!1}),e.createIndex("payment_number","payment_number",{unique:!0}),e.createIndex("status","status",{unique:!1})}if(!t.objectStoreNames.contains("equipment")){let e=t.createObjectStore("equipment",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("customer_id","customer_id",{unique:!1}),e.createIndex("equipment_number","equipment_number",{unique:!0}),e.createIndex("type","type",{unique:!1}),e.createIndex("status","status",{unique:!1})}if(!t.objectStoreNames.contains("schedules")){let e=t.createObjectStore("schedules",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("customer_id","customer_id",{unique:!1}),e.createIndex("job_id","job_id",{unique:!1}),e.createIndex("assigned_to","assigned_to",{unique:!1}),e.createIndex("start_time","start_time",{unique:!1}),e.createIndex("status","status",{unique:!1})}if(!t.objectStoreNames.contains("tags")){let e=t.createObjectStore("tags",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("slug","slug",{unique:!1}),e.createIndex("category","category",{unique:!1})}if(!t.objectStoreNames.contains("attachments")){let e=t.createObjectStore("attachments",{keyPath:"id"});e.createIndex("synced","synced",{unique:!1}),e.createIndex("updated_at","updated_at",{unique:!1}),e.createIndex("company_id","company_id",{unique:!1}),e.createIndex("entity_type","entity_type",{unique:!1}),e.createIndex("entity_id","entity_id",{unique:!1}),e.createIndex("entity",["entity_type","entity_id"],{unique:!1})}}if(!t.objectStoreNames.contains("sync-queue")){let e=t.createObjectStore("sync-queue",{keyPath:"id"});e.createIndex("timestamp","timestamp",{unique:!1}),e.createIndex("retry_count","retry_count",{unique:!1}),e.createIndex("table","table",{unique:!1})}}})}async function f(e,t){let a=await h();return new Promise((s,r)=>{let n=a.transaction([e],"readwrite").objectStore(e).add(t);n.onsuccess=()=>{a.close(),s()},n.onerror=()=>{a.close(),r(Error(`Failed to add record to ${e}`))}})}async function g(e,t){let a=await h();return new Promise((s,r)=>{let n=a.transaction([e],"readwrite").objectStore(e).put(t);n.onsuccess=()=>{a.close(),s()},n.onerror=()=>{a.close(),r(Error(`Failed to update record in ${e}`))}})}async function v(e,t){let a=await h();return new Promise((s,r)=>{let n=a.transaction([e],"readonly").objectStore(e).get(t);n.onsuccess=()=>{a.close(),s(n.result||null)},n.onerror=()=>{a.close(),r(Error(`Failed to get record from ${e}`))}})}async function y(e){let t=await h();return new Promise((a,s)=>{let r=t.transaction([e],"readonly").objectStore(e).getAll();r.onsuccess=()=>{t.close(),a(r.result||[])},r.onerror=()=>{t.close(),s(Error(`Failed to get all records from ${e}`))}})}async function j(e,t){let a=await h();return new Promise((s,r)=>{let n=a.transaction([e],"readwrite").objectStore(e).delete(t);n.onsuccess=()=>{a.close(),s()},n.onerror=()=>{a.close(),r(Error(`Failed to delete record from ${e}`))}})}async function w(e){let t=await h();return new Promise((a,s)=>{let r=t.transaction([e],"readonly").objectStore(e).count();r.onsuccess=()=>{t.close(),a(r.result||0)},r.onerror=()=>{t.close(),s(Error(`Failed to count records in ${e}`))}})}var N=e.i(830891);async function S(){let e=await y("sync-queue");if(0===e.length)return{success:0,failed:0,errors:[]};let t=(0,N.createClient)(),a=0,s=0,r=[];for(let n of e)try{await _(t,n),await j("sync-queue",n.id),a++}catch(a){let e=a instanceof Error?a.message:"Unknown error",t={...n,retry_count:n.retry_count+1,error:e};t.retry_count>=3?(await g("sync-queue",t),s++,r.push({operation:n,error:e})):(await g("sync-queue",t),s++)}return{success:a,failed:s,errors:r}}async function _(e,t){let{operation:a,table:s,data:r}=t;switch(a){case"INSERT":{let{id:t,...a}=r,{data:n,error:i}=await e.from(s).insert(a).select().single();if(i)throw Error(i.message);if(t.startsWith("temp_")){let e=q(s);e&&(await j(e,t),await f(e,{...n,synced:!0}))}break}case"UPDATE":{let{id:t,...a}=r,{error:n}=await e.from(s).update(a).eq("id",t);if(n)throw Error(n.message);let i=q(s);if(i){let e=await v(i,t);e&&await g(i,{...e,...a,synced:!0})}break}case"DELETE":{let{id:t}=r,{error:a}=await e.from(s).delete().eq("id",t);if(a)throw Error(a.message);let n=q(s);n&&await j(n,t);break}default:throw Error(`Unknown operation: ${a}`)}}function q(e){return({jobs:"jobs",invoices:"invoices",customers:"customers",communications:"communications",payments:"payments",equipment:"equipment",schedules:"appointments",tags:"tags",attachments:"attachments"})[e]||null}function I(){let{isOnline:e,pendingOperations:a,isSyncing:s,lastSync:r}=function(){let[e,t]=(0,i.useState)("undefined"==typeof navigator||navigator.onLine),[a,s]=(0,i.useState)(0),[r,n]=(0,i.useState)(null),[d,c]=(0,i.useState)(!1),o=async()=>{try{let e=await w("sync-queue");s(e)}catch(e){}},l=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{o();let e=setInterval(()=>{l.current||o()},1e4),a=async()=>{if(!l.current){t(!0),l.current=!0;try{c(!0),await S(),n(new Date),await o()}catch(e){}finally{c(!1),l.current=!1}}},s=()=>{t(!1)},r=async()=>{if("visible"===document.visibilityState&&navigator.onLine&&!l.current){l.current=!0;try{c(!0),await S(),n(new Date),await o()}catch(e){}finally{c(!1),l.current=!1}}};return window.addEventListener("online",a),window.addEventListener("offline",s),document.addEventListener("visibilitychange",r),()=>{window.removeEventListener("online",a),window.removeEventListener("offline",s),document.removeEventListener("visibilitychange",r),clearInterval(e)}},[o]),{isOnline:e,pendingOperations:a,lastSync:r,isSyncing:d}}(),[n,d]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{d(!0)},[]),n&&(!e||0!==a||s))?e?s?(0,t.jsxs)("div",{className:"bg-primary/10 text-primary dark:text-primary flex items-center gap-2 rounded-md px-3 py-1 text-sm",children:[(0,t.jsx)(p.RefreshCw,{className:"size-4 animate-spin"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Syncing..."}),a>0&&(0,t.jsx)("span",{className:"bg-primary/20 rounded-full px-2 py-0.5 text-xs font-medium",children:a})]}):a>0?(0,t.jsxs)("div",{className:"bg-warning/10 text-warning dark:text-warning flex items-center gap-2 rounded-md px-3 py-1 text-sm",children:[(0,t.jsx)(m.AlertCircle,{className:"size-4"}),(0,t.jsxs)("span",{className:"hidden sm:inline",children:[a," pending"]}),(0,t.jsx)("span",{className:"sm:hidden",children:a})]}):r&&Date.now()-r.getTime()<5e3?(0,t.jsxs)("div",{className:"bg-success/10 text-success dark:text-success flex items-center gap-2 rounded-md px-3 py-1 text-sm",children:[(0,t.jsx)(x.CheckCircle2,{className:"size-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Synced"})]}):null:(0,t.jsxs)("div",{className:"bg-warning/10 text-warning dark:text-warning flex items-center gap-2 rounded-md px-3 py-1 text-sm",children:[(0,t.jsx)(b.WifiOff,{className:"size-4"}),(0,t.jsx)("span",{className:"hidden sm:inline",children:"Offline Mode"}),a>0&&(0,t.jsx)("span",{className:"bg-warning/20 rounded-full px-2 py-0.5 text-xs font-medium",children:a})]}):null}e.i(152088),e.i(889265);var k=e.i(677607);e.i(244242);var C=e.i(563078);e.i(306226);var z=e.i(508420),E=e.i(24079),T=e.i(935682),M=e.i(171056),P=e.i(989239);function A({stats:e,primaryStatIndex:a=0,compact:s=!1}){let[r,n]=(0,i.useState)(!1);if(!e||0===e.length)return null;let d=e[a],c=!!d?.trend;return(0,t.jsxs)(M.Popover,{open:r,onOpenChange:n,children:[(0,t.jsx)(M.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(k.Button,{variant:"ghost",size:"sm",className:(0,P.cn)("h-8 gap-1.5 px-2 transition-all duration-200","hover:bg-primary/10 hover:text-primary","data-[state=open]:bg-primary/10 data-[state=open]:text-primary"),title:`${d?.label}: ${d?.value}`,children:[(0,t.jsx)(T.BarChart3,{className:"h-4 w-4"}),!s&&d&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"hidden text-xs font-medium tabular-nums sm:inline",children:d.value}),c&&d.trend&&(0,t.jsxs)("span",{className:(0,P.cn)("hidden text-xs font-medium tabular-nums lg:inline","up"===d.trend.direction?"text-success":"down"===d.trend.direction?"text-destructive":"text-muted-foreground"),children:["up"===d.trend.direction&&"+",d.trend.value,d.trend.suffix||"%"]})]})]})}),(0,t.jsx)(M.PopoverContent,{className:"w-80 p-4",align:"start",sideOffset:8,children:(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between border-b pb-2",children:[(0,t.jsx)("h4",{className:"text-sm font-semibold",children:"Statistics"}),(0,t.jsxs)("span",{className:"text-muted-foreground text-xs",children:[e.length," ",1===e.length?"metric":"metrics"]})]}),(0,t.jsx)("div",{className:"grid gap-3",children:e.map((e,s)=>(0,t.jsxs)("div",{className:(0,P.cn)("rounded-lg border p-3 transition-colors",s===a?"border-primary/50 bg-primary/5":"border-border/50 hover:border-border"),children:[(0,t.jsxs)("div",{className:"flex items-start justify-between gap-2",children:[(0,t.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,t.jsx)("p",{className:"text-muted-foreground truncate text-xs font-medium",children:e.label}),(0,t.jsx)("p",{className:"mt-1 truncate text-lg font-semibold tabular-nums",children:e.value})]}),e.trend&&(0,t.jsxs)("div",{className:(0,P.cn)("flex shrink-0 items-center gap-1 rounded-md px-2 py-1 text-xs font-medium","up"===e.trend.direction?"bg-success/10 text-success":"down"===e.trend.direction?"bg-destructive/10 text-destructive":"bg-muted text-muted-foreground"),children:[(0,t.jsxs)("span",{children:["up"===e.trend.direction&&"↑","down"===e.trend.direction&&"↓","neutral"===e.trend.direction&&"→"]}),(0,t.jsxs)("span",{className:"tabular-nums",children:[e.trend.value,e.trend.suffix||"%"]})]})]}),e.description&&(0,t.jsx)("p",{className:"text-muted-foreground mt-2 text-xs leading-relaxed",children:e.description})]},s))})]})})]})}e.s(["ToolbarStatsButton",()=>A],732205);var O=e.i(861083);function D({pathname:e,config:d,showLeftSidebar:o=!0,showRightSidebar:l=!1,scope:m="page"}){var x;let p=e||"/dashboard",[b,h]=(0,i.useState)(!1),f=d.stats&&(0,i.isValidElement)(d.stats),g=d.stats&&Array.isArray(d.stats),v=d.statsMode||(d.showInlineStats?"inline":"hidden"),y=!!(d.title||d.subtitle),j=!!(d.stats&&"hidden"!==v),w=!!d.search,N=!!d.pagination;d.actions;let S=(x=d.actions)?Array.isArray(x)?{primary:x.slice(0,2),secondary:x.slice(2)}:{primary:[x],secondary:[]}:{primary:[],secondary:[]};return d.hideOnMobile?(0,t.jsx)("header",{className:"bg-background/80 sticky top-0 z-40 hidden w-full shrink-0 backdrop-blur-xl supports-[backdrop-filter]:bg-background/60 md:flex","data-app-toolbar":!0,"data-app-toolbar-scope":m,children:(0,t.jsxs)("div",{className:"flex h-14 w-full items-center gap-3 px-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-2",children:[o&&(0,t.jsx)(E.SidebarTrigger,{className:"-ml-1"}),d.back&&(0,t.jsx)("div",{className:"flex items-center",children:d.back})]}),!d.breadcrumbs&&y&&(0,t.jsxs)("div",{className:"flex min-w-0 shrink-0 flex-col",children:[d.title&&(0,t.jsx)("div",{className:"flex items-baseline gap-2",children:"string"==typeof d.title?(0,t.jsx)("h1",{className:"truncate text-sm font-semibold lg:text-base",children:d.title}):(0,t.jsx)("div",{className:"text-sm font-semibold lg:text-base",children:d.title})}),d.subtitle&&(0,t.jsx)("p",{className:"text-muted-foreground truncate text-xs",children:d.subtitle})]}),d.breadcrumbs&&(0,t.jsx)("div",{className:"flex min-w-0 items-center",children:d.breadcrumbs}),j&&"inline"===v&&(0,t.jsxs)("div",{className:"hidden items-center xl:flex","data-toolbar-default-stats":p,children:[(0,t.jsx)("div",{className:"bg-border/40 mx-3 h-5 w-px"}),f&&d.stats,g&&d.stats.length>0&&(0,t.jsx)(O.ToolbarStatsInline,{stats:d.stats})]})]}),(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-2",children:[w&&(0,t.jsx)("div",{className:"flex items-center max-w-md",children:d.search}),j&&"button"===v&&(0,t.jsxs)(t.Fragment,{children:[g&&d.stats.length>0&&(0,t.jsx)(A,{stats:d.stats}),f&&d.stats]}),(0,t.jsx)(u,{pathname:p}),N&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"bg-border/40 h-5 w-px"}),d.pagination]}),S.primary.length>0&&(0,t.jsxs)(t.Fragment,{children:[!d.hideActionSeparator&&(0,t.jsx)("div",{className:"bg-border/40 h-5 w-px"}),(0,t.jsx)("div",{className:"flex items-center gap-1.5",children:S.primary.map((e,a)=>(0,t.jsx)("div",{children:e},a))})]}),S.secondary.length>0&&(0,t.jsxs)(C.DropdownMenu,{children:[(0,t.jsx)(C.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[(0,t.jsx)(s.MoreVertical,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"More actions"})]})}),(0,t.jsxs)(C.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,t.jsx)(C.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(C.DropdownMenuSeparator,{}),S.secondary.map((e,a)=>(0,t.jsx)(C.DropdownMenuItem,{asChild:!0,children:e},a))]})]}),(0,t.jsx)(c,{pathname:p}),(0,t.jsx)(I,{})]})]})}):(0,t.jsx)("header",{className:"bg-background/80 sticky top-0 z-40 flex w-full shrink-0 backdrop-blur-xl supports-[backdrop-filter]:bg-background/60","data-app-toolbar":!0,"data-app-toolbar-scope":m,children:(0,t.jsxs)("div",{className:"hidden md:flex h-14 w-full items-center gap-3 px-6",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[o&&(0,t.jsx)(E.SidebarTrigger,{className:"-ml-1"}),d.back&&(0,t.jsx)("div",{className:"flex items-center",children:d.back}),y&&"string"==typeof d.title&&(0,t.jsx)("h1",{className:"truncate text-sm font-semibold",children:d.title}),y&&"string"!=typeof d.title&&(0,t.jsx)("div",{className:"text-sm font-semibold truncate",children:d.title})]}),(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-1",children:[w&&(0,t.jsxs)(z.Sheet,{children:[(0,t.jsx)(z.SheetTrigger,{asChild:!0,children:(0,t.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[(0,t.jsx)(r.Search,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Search"})]})}),(0,t.jsxs)(z.SheetContent,{side:"top",className:"h-[200px]",children:[(0,t.jsx)(z.SheetHeader,{children:(0,t.jsx)(z.SheetTitle,{children:"Search"})}),(0,t.jsx)("div",{className:"mt-4",children:d.search})]})]}),(0,t.jsx)(I,{}),(0,t.jsxs)(z.Sheet,{open:b,onOpenChange:h,children:[(0,t.jsx)(z.SheetTrigger,{asChild:!0,children:(0,t.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:[(0,t.jsx)(a.default,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Menu"})]})}),(0,t.jsxs)(z.SheetContent,{side:"right",className:"w-[300px] sm:w-[400px]",children:[(0,t.jsx)(z.SheetHeader,{children:(0,t.jsxs)(z.SheetTitle,{className:"flex items-center justify-between",children:[(0,t.jsx)("span",{children:"Actions"}),(0,t.jsxs)(k.Button,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",onClick:()=>h(!1),"aria-label":"Close menu",children:[(0,t.jsx)(n.X,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close menu"})]})]})}),(0,t.jsxs)("div",{className:"mt-6 space-y-4",children:[j&&g&&d.stats.length>0&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Statistics"}),(0,t.jsx)("div",{className:"grid gap-2",children:d.stats.map((e,a)=>(0,t.jsxs)("div",{className:"rounded-lg border p-3 space-y-1",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:e.label}),(0,t.jsxs)("div",{className:"flex items-baseline gap-2",children:[(0,t.jsx)("p",{className:"text-2xl font-bold",children:e.value}),e.icon&&(0,t.jsx)("span",{className:"text-muted-foreground",children:e.icon})]})]},a))})]}),(S.primary.length>0||S.secondary.length>0)&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Actions"}),(0,t.jsx)("div",{className:"grid gap-2",children:[...S.primary,...S.secondary].map((e,a)=>(0,t.jsx)("div",{className:"w-full",onClick:()=>h(!1),children:e},a))})]}),N&&(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Navigation"}),(0,t.jsx)("div",{className:"flex items-center justify-center",children:d.pagination})]})]})]})]})]})]})})}e.s(["AppToolbar",()=>D],179689)}]);