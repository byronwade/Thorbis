(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,484942,e=>{"use strict";var s=e.i(111043),t=e.i(970799);e.i(686787);var a=e.i(519539),l=e.i(243099),r=e.i(904653),n=e.i(112668),i=e.i(643023),o=e.i(899117),c=e.i(702948);e.i(789067);var d=e.i(861308);let u=(0,c.default)(()=>e.A(614035).then(e=>({default:e.DispatchTimeline})),{loadableGenerated:{modules:[915024]},loading:()=>(0,s.jsxs)("div",{className:"flex h-full w-full flex-col gap-4 p-4",children:[(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(d.Skeleton,{className:"h-10 w-32"}),(0,s.jsx)(d.Skeleton,{className:"h-10 w-32"}),(0,s.jsx)(d.Skeleton,{className:"h-10 flex-1"})]}),(0,s.jsx)(d.Skeleton,{className:"h-full w-full"})]}),ssr:!1});function m(){return(0,s.jsx)(u,{})}let h=(0,c.default)(()=>e.A(168481).then(e=>({default:e.KanbanView})),{loadableGenerated:{modules:[823591]},loading:()=>(0,s.jsx)("div",{className:"flex h-full w-full gap-4 p-4",children:Array.from({length:7}).map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-1 flex-col gap-2",children:[(0,s.jsx)(d.Skeleton,{className:"h-8 w-full"}),(0,s.jsx)(d.Skeleton,{className:"h-32 w-full"}),(0,s.jsx)(d.Skeleton,{className:"h-32 w-full"})]},t))}),ssr:!1});function x(){return(0,s.jsx)(h,{})}var b=e.i(230902),p=e.i(103882),g=e.i(512710),f=e.i(87912),j=e.i(51866);e.i(889265);var v=e.i(677607),N=e.i(276389),w=e.i(287268),y=e.i(202724),k=e.i(152088);let C={no_jobs:{icon:N.Calendar,title:"No jobs scheduled",description:"Get started by scheduling your first appointment",defaultActionLabel:"Schedule Appointment"},no_results:{icon:w.Search,title:"No jobs found",description:"Try adjusting your search or filters",defaultActionLabel:"Clear Filters"},no_unassigned:{icon:y.Users,title:"All jobs assigned",description:"Great! All jobs have been assigned to technicians",defaultActionLabel:"View Schedule"},no_jobs_today:{icon:N.Calendar,title:"No jobs today",description:"This technician has no scheduled jobs for today",defaultActionLabel:"View Full Schedule"}};function S({variant:e,onAction:t,actionLabel:a,className:l}){let r=C[e],n=r.icon,i=a||r.defaultActionLabel;return(0,s.jsxs)("div",{className:(0,k.cn)("flex flex-col items-center justify-center gap-4 px-6 py-12 text-center",l),children:[(0,s.jsx)("div",{className:"flex h-16 w-16 items-center justify-center rounded-full bg-muted",children:(0,s.jsx)(n,{className:"h-8 w-8 text-muted-foreground"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold",children:r.title}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground max-w-sm",children:r.description})]}),t&&(0,s.jsx)(v.Button,{className:"mt-2",onClick:t,children:i})]})}var T=e.i(486506),M=e.i(852648),_=e.i(136764),D=e.i(15751),A=e.i(332845),I=e.i(817451),z=e.i(532727),B=e.i(14435),U=e.i(212409);e.i(670258);var F=e.i(921251);e.i(553153);var L=e.i(363712),J=e.i(738416),E=e.i(516467);function O(e,s,t){let a=(0,E.toDate)(e,t?.in);return a.setHours(s),a}function P(e,s,t){let a=(0,E.toDate)(e,t?.in);return a.setMinutes(s),a}e.i(847361);var H=e.i(949538);e.i(149989);var $=e.i(880177);e.i(254978);var R=e.i(375308);let V=(()=>{let e=[];for(let s=0;s<24;s++)for(let t=0;t<60;t+=30){let a=new Date;a.setHours(s,t,0,0),e.push({label:(0,b.format)(a,"h:mm a"),time:`${String(s).padStart(2,"0")}:${String(t).padStart(2,"0")}`})}return e})(),G=V.filter(e=>{let[s]=e.time.split(":").map(Number);return s>=6&&s<18});function W({job:e,isOpen:a,onClose:l,onConfirm:r}){let[n,i]=(0,t.useState)(e?.scheduled_start?new Date(e.scheduled_start):new Date),[o,c]=(0,t.useState)(e?.scheduled_start?(0,b.format)(new Date(e.scheduled_start),"HH:mm"):"09:00"),[d,u]=(0,t.useState)(!1),m=(0,t.useMemo)(()=>{if(e?.scheduled_start&&e?.scheduled_end){let s=new Date(e.scheduled_start);return(new Date(e.scheduled_end).getTime()-s.getTime())/36e5}let s=e?.title?.toLowerCase()||"";return s.includes("emergency")?3:s.includes("install")?4:s.includes("inspection")?1:(s.includes("maintenance"),2)},[e]),h=(0,t.useMemo)(()=>{if(!n||!o)return null;let[e,s]=o.split(":").map(Number),t=(0,J.startOfDay)(n);O(t,e),P(t,s);let a=new Date(t);return a.setHours(t.getHours()+Math.floor(m)),a.setMinutes(t.getMinutes()+m%1*60),a},[n,o,m]);if(!e)return null;let x=d?V:G;return(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:l}),(0,s.jsxs)("div",{className:(0,k.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",a?"translate-y-0":"translate-y-full"),style:{maxHeight:"90vh"},children:[(0,s.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,s.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Reschedule Appointment"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.customer?.name||"Unknown Customer"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Current: ",e.scheduled_start?(0,b.format)(new Date(e.scheduled_start),"MMM d, h:mm a"):"Not scheduled"]})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:l,size:"icon",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsx)(R.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(90vh - 240px)"},children:(0,s.jsxs)("div",{className:"p-4 space-y-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)($.Label,{className:"text-sm font-medium mb-2 flex items-center gap-2",children:[(0,s.jsx)(N.Calendar,{className:"h-4 w-4"}),"Select Date"]}),(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(H.Calendar,{disabled:e=>e<(0,J.startOfDay)(new Date),mode:"single",onSelect:i,selected:n})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,s.jsxs)($.Label,{className:"text-sm font-medium flex items-center gap-2",children:[(0,s.jsx)(_.Clock,{className:"h-4 w-4"}),"Select Time"]}),(0,s.jsx)(v.Button,{onClick:()=>u(!d),size:"sm",variant:"ghost",children:d?"Business Hours":"All Hours"})]}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-2",children:x.map(e=>(0,s.jsx)(v.Button,{className:(0,k.cn)("h-12 text-sm font-medium",o===e.time&&"bg-primary text-primary-foreground hover:bg-primary/90"),onClick:()=>c(e.time),variant:o===e.time?"default":"outline",children:e.label},e.time))})]}),n&&o&&h&&(0,s.jsxs)("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"New Schedule Preview"}),(0,s.jsxs)("div",{className:"space-y-1 text-sm text-muted-foreground",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Date:"}),(0,s.jsx)("span",{className:"font-medium text-foreground",children:(0,b.format)(n,"EEEE, MMMM d, yyyy")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Start:"}),(0,s.jsx)("span",{className:"font-medium text-foreground",children:(0,b.format)(O(P(n,parseInt(o.split(":")[1])),parseInt(o.split(":")[0])),"h:mm a")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"End:"}),(0,s.jsx)("span",{className:"font-medium text-foreground",children:(0,b.format)(h,"h:mm a")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{children:"Duration:"}),(0,s.jsxs)("span",{className:"font-medium text-foreground",children:[m,"h"]})]})]})]})]})}),(0,s.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.Button,{className:"flex-1 h-12",onClick:l,size:"lg",variant:"outline",children:"Cancel"}),(0,s.jsx)(v.Button,{className:"flex-1 h-12",disabled:!n||!o,onClick:()=>{if(!e||!n||!o||!h)return;let[s,t]=o.split(":").map(Number),a=(0,J.startOfDay)(n);O(a,s),P(a,t),r(e,a,h),l()},size:"lg",variant:"default",children:"Confirm Reschedule"})]})})]})]})}var X=e.i(79254),K=e.i(133593),K=K;e.i(51478);var Y=e.i(635613);function Z({job:e,isOpen:a,onClose:l,onConfirm:r}){let n=(0,o.useScheduleStore)(e=>e.technicians),i=(0,o.useScheduleStore)(e=>e.jobs),c=(0,t.useMemo)(()=>Array.from(n.values()),[n]),d=(0,t.useMemo)(()=>Array.from(i.values()),[i]),[u,m]=(0,t.useState)(""),[h,x]=(0,t.useState)(e?.assignedTechnicianId||null),b=(0,t.useMemo)(()=>c.map(e=>{let s=d.filter(s=>s.assignedTechnicianId===e.id),t=s.filter(e=>!["completed","cancelled","closed"].includes(e.status?.toLowerCase()||""));return{...e,totalJobs:s.length,activeJobs:t.length}}),[c,d]),p=(0,t.useMemo)(()=>{if(!u.trim())return b;let e=u.toLowerCase();return b.filter(s=>s.name.toLowerCase().includes(e))},[b,u]),g=(0,t.useMemo)(()=>[...p].sort((s,t)=>s.id===e?.assignedTechnicianId?-1:t.id===e?.assignedTechnicianId?1:s.activeJobs-t.activeJobs),[p,e]);return e?(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:l}),(0,s.jsxs)("div",{className:(0,k.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",a?"translate-y-0":"translate-y-full"),style:{maxHeight:"85vh"},children:[(0,s.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,s.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Assign Technician"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.customer?.name||"Unknown Customer"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.title})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:l,size:"icon",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsx)("div",{className:"px-4 pt-4",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(w.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(Y.Input,{className:"h-11 pl-10 text-base",onChange:e=>m(e.target.value),placeholder:"Search technicians...",type:"search",value:u})]})}),e.assignedTechnicianId&&(0,s.jsx)("div",{className:"px-4 pt-3",children:(0,s.jsxs)("button",{className:(0,k.cn)("flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-orange-500/50 active:scale-98",null===h?"border-orange-500 bg-orange-50 dark:bg-orange-950/20":"border-border"),onClick:()=>x(null),type:"button",children:[(0,s.jsx)("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-orange-100 dark:bg-orange-900",children:(0,s.jsx)(K.default,{className:"h-6 w-6 text-orange-600 dark:text-orange-400"})}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsx)("p",{className:"text-base font-semibold",children:"Unassign Technician"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Remove technician from this job"})]}),null===h&&(0,s.jsx)(X.Check,{className:"h-5 w-5 text-orange-600 shrink-0"})]})}),(0,s.jsx)(R.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(85vh - 280px)"},children:(0,s.jsx)("div",{className:"p-4 space-y-2",children:0===g.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)(K.default,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,s.jsx)("p",{className:"text-sm font-medium mb-1",children:"No technicians found"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Try a different search term"})]}):g.map(t=>{let a=h===t.id,l=e.assignedTechnicianId===t.id;return(0,s.jsxs)("button",{className:(0,k.cn)("flex w-full items-center gap-3 rounded-lg border-2 p-3 transition-all hover:border-primary/50 active:scale-98",a?"border-primary bg-primary/5":"border-border"),onClick:()=>x(t.id),type:"button",children:[(0,s.jsx)(F.Avatar,{className:"h-12 w-12",children:(0,s.jsx)(F.AvatarFallback,{className:"text-sm font-medium",children:t.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2)})}),(0,s.jsxs)("div",{className:"flex-1 text-left",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("p",{className:"text-base font-semibold",children:t.name}),l&&(0,s.jsx)(L.Badge,{className:"h-5 px-2 text-[9px]",variant:"secondary",children:"Current"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs text-muted-foreground",children:[(0,s.jsxs)("span",{children:[t.activeJobs," active"]}),(0,s.jsx)("span",{children:"â€¢"}),(0,s.jsxs)("span",{children:[t.totalJobs," total"]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,s.jsx)("div",{className:"flex flex-col items-end",children:(0,s.jsx)("div",{className:(0,k.cn)("h-2 w-16 rounded-full bg-muted overflow-hidden"),children:(0,s.jsx)("div",{className:(0,k.cn)("h-full transition-all",0===t.activeJobs&&"bg-green-500",t.activeJobs>0&&t.activeJobs<=3&&"bg-blue-500",t.activeJobs>3&&t.activeJobs<=6&&"bg-yellow-500",t.activeJobs>6&&"bg-red-500"),style:{width:`${Math.min(t.activeJobs/10*100,100)}%`}})})}),a&&(0,s.jsx)(X.Check,{className:"h-5 w-5 text-primary"})]})]},t.id)})})}),(0,s.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.Button,{className:"flex-1 h-12",onClick:l,size:"lg",variant:"outline",children:"Cancel"}),(0,s.jsx)(v.Button,{className:"flex-1 h-12",disabled:h===e.assignedTechnicianId,onClick:()=>{e&&(r(e,h),l())},size:"lg",variant:"default",children:null===h?"Unassign":"Assign Technician"})]})})]})]}):null}var q=e.i(630754),Q=e.i(604501),ee=e.i(900007);let es=[{id:"unscheduled",label:"Unscheduled",icon:_.Clock,color:"bg-gray-500",borderColor:"border-gray-500",description:"No date/time assigned"},{id:"scheduled",label:"Scheduled",icon:N.Calendar,color:"bg-blue-500",borderColor:"border-blue-500",description:"Date and time confirmed"},{id:"dispatched",label:"Dispatched",icon:Q.Truck,color:"bg-sky-500",borderColor:"border-sky-500",description:"Technician on the way"},{id:"arrived",label:"Arrived",icon:D.MapPin,color:"bg-emerald-400",borderColor:"border-emerald-400",description:"Technician at location"},{id:"in_progress",label:"In Progress",icon:A.Navigation,color:"bg-amber-500 animate-pulse",borderColor:"border-amber-500",description:"Work actively underway"},{id:"closed",label:"Closed",icon:q.CheckCircle,color:"bg-emerald-600",borderColor:"border-emerald-600",description:"Work completed, awaiting review"},{id:"completed",label:"Completed",icon:M.CheckCircle2,color:"bg-green-700",borderColor:"border-green-700",description:"Fully complete and approved"},{id:"cancelled",label:"Cancelled",icon:ee.XCircle,color:"bg-red-500",borderColor:"border-red-500",description:"Job cancelled or abandoned"}];function et({job:e,isOpen:a,onClose:l,onConfirm:r}){let[n,i]=(0,t.useState)(e?.status?.toLowerCase()||null),o=e?.status?.toLowerCase()||"unscheduled",c=(e=>{switch(e?.toLowerCase()||"unscheduled"){case"unscheduled":case"cancelled":default:return["scheduled"];case"scheduled":return["dispatched","cancelled"];case"dispatched":return["arrived","scheduled","cancelled"];case"arrived":return["in_progress","dispatched","cancelled"];case"in_progress":return["closed","arrived"];case"closed":return["completed","in_progress"];case"completed":return[]}})(o);return e?(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:l}),(0,s.jsxs)("div",{className:(0,k.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",a?"translate-y-0":"translate-y-full"),style:{maxHeight:"85vh"},children:[(0,s.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,s.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-1",children:"Change Status"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:e.customer?.name||"Unknown Customer"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground capitalize",children:["Current: ",o.replace(/_/g," ")]})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:l,size:"icon",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsx)(R.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(85vh - 220px)"},children:(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[c.length>0&&(0,s.jsx)("div",{className:"mb-4",children:(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",children:"Suggested Next Steps"})}),es.map(e=>{let t=n===e.id,a=o===e.id,l=c.includes(e.id),r=l&&!a,d=a||!l&&c.length>0,u=e.icon;return(0,s.jsxs)("button",{className:(0,k.cn)("flex w-full items-start gap-3 rounded-lg border-2 p-4 transition-all text-left",d?"opacity-50 cursor-not-allowed":"hover:border-primary/50 active:scale-98",t&&!d&&"border-primary bg-primary/5",r&&!t&&"border-green-500/30 bg-green-50 dark:bg-green-950/20",a&&"border-muted-foreground bg-muted",!t&&!r&&!a&&"border-border"),disabled:d,onClick:()=>!d&&i(e.id),type:"button",children:[(0,s.jsx)("div",{className:(0,k.cn)("flex h-12 w-12 shrink-0 items-center justify-center rounded-full",e.color,d&&"opacity-50"),children:(0,s.jsx)(u,{className:"h-6 w-6 text-white"})}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("p",{className:"text-base font-semibold",children:e.label}),a&&(0,s.jsx)("span",{className:"text-[10px] px-2 py-0.5 bg-muted-foreground/20 rounded-full font-medium",children:"Current"}),r&&!t&&(0,s.jsx)("span",{className:"text-[10px] px-2 py-0.5 bg-green-500 text-white rounded-full font-medium",children:"Recommended"})]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]}),t&&!d&&(0,s.jsx)("div",{className:"flex shrink-0 items-center justify-center h-6 w-6 rounded-full bg-primary",children:(0,s.jsx)(q.CheckCircle,{className:"h-4 w-4 text-primary-foreground"})})]},e.id)}),c.length>0&&(0,s.jsxs)("div",{className:"pt-4 border-t",children:[(0,s.jsx)("p",{className:"text-xs font-medium text-muted-foreground mb-2 uppercase tracking-wide",children:"Other Statuses"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-3",children:"These transitions may not be typical for the current workflow"})]})]})}),(0,s.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.Button,{className:"flex-1 h-12",onClick:l,size:"lg",variant:"outline",children:"Cancel"}),(0,s.jsx)(v.Button,{className:"flex-1 h-12",disabled:!n||n===o,onClick:()=>{e&&n&&(r(e,n),l())},size:"lg",variant:"default",children:"Update Status"})]})})]})]}):null}function ea({isOpen:e,onClose:a,job:l,onAction:r}){let[n,i]=(0,t.useState)(!1),[o,c]=(0,t.useState)(null),[d,u]=(0,t.useState)(null),m=(0,t.useRef)(null),h=(0,t.useCallback)(()=>{i(!0),setTimeout(()=>{a(),i(!1)},300)},[a]);(0,t.useEffect)(()=>{let s=e=>{m.current&&!m.current.contains(e.target)&&h()};return e&&document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[e,h]),(0,t.useEffect)(()=>{let s=e=>{"Escape"===e.key&&h()};return e&&document.addEventListener("keydown",s),()=>{document.removeEventListener("keydown",s)}},[e,h]),(0,t.useEffect)(()=>{e||(u(null),c(null))},[e]);let x=(0,t.useCallback)((e,s)=>{if("reschedule"===e){c(s),u("reschedule");return}if("reassign"===e){c(s),u("reassign");return}if("move_to_status"===e){c(s),u("status");return}r(e,s),h()},[r,h]),p=(0,t.useCallback)((e,s,t)=>{r("reschedule",e,s,t),u(null),c(null),h()},[r,h]),g=(0,t.useCallback)((e,s)=>{r("reassign",e,s),u(null),c(null),h()},[r,h]),f=(0,t.useCallback)((e,s)=>{r("move_to_status",e,s),u(null),c(null),h()},[r,h]),j=(0,t.useCallback)(()=>{u(null),c(null)},[]);if(!e&&!n||!l)return null;let w=l.status?.toLowerCase().replace(/ /g,"_")||"unscheduled",C=[];"scheduled"===w&&C.push("dispatch"),"dispatched"===w&&C.push("arrive"),"arrived"===w&&C.push("start"),"in_progress"===w&&C.push("complete"),C.push("reschedule","reassign","move_to_status"),"cancelled"!==w&&"completed"!==w&&C.push("cancel"),C.unshift("view_details");let S=l.customer?.name||"No Customer",J=l.location?.address?.street||"No location",E=l.startTime?(0,b.format)(new Date(l.startTime),"MMM d, h:mm a"):"Not scheduled",O=l.endTime?(0,b.format)(new Date(l.endTime),"h:mm a"):"",P=O?`${E} - ${O}`:E,H=l.assignments.find(e=>"primary"===e.role),$=H?.displayName?H.displayName.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?",R=l.startTime&&l.endTime?Math.round((new Date(l.endTime).getTime()-new Date(l.startTime).getTime())/36e5):0,V={view_details:{icon:T.ArrowRight,label:"View Full Details"},dispatch:{icon:A.Navigation,label:"Dispatch Job"},arrive:{icon:D.MapPin,label:"Mark as Arrived"},start:{icon:_.Clock,label:"Start Job"},complete:{icon:M.CheckCircle2,label:"Mark as Complete"},reschedule:{icon:N.Calendar,label:"Reschedule"},reassign:{icon:y.Users,label:"Reassign Technician"},move_to_status:{icon:I.Repeat,label:"Move to Status..."},cancel:{icon:z.Trash2,label:"Cancel Job",variant:"destructive"}};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:(0,k.cn)("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm",n?"animate-out fade-out duration-300":"animate-in fade-in duration-300")}),(0,s.jsxs)("div",{className:(0,k.cn)("safe-bottom fixed bottom-0 left-0 right-0 z-50 rounded-t-3xl border-t border-border bg-background shadow-2xl",n?"animate-out slide-out-to-bottom duration-300":"animate-in slide-in-from-bottom duration-300"),ref:m,children:[(0,s.jsx)("div",{className:"flex justify-center py-4",children:(0,s.jsx)("div",{className:"h-1.5 w-10 rounded-full bg-muted"})}),(0,s.jsxs)("div",{className:"max-h-[80vh] overflow-y-auto px-6 pb-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold",children:"Job Actions"}),(0,s.jsxs)(v.Button,{className:"h-9 w-9",onClick:h,size:"icon",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsxs)("div",{className:"mb-6 space-y-3 rounded-lg border bg-muted/50 p-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"text-base font-medium leading-tight",children:S}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground mt-0.5",children:l.title||"Untitled Job"})]}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(_.Clock,{className:"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:P}),R>0&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[R," ",1===R?"hour":"hours"]})]})]}),"No location"!==J&&(0,s.jsxs)("div",{className:"flex items-start gap-2",children:[(0,s.jsx)(D.MapPin,{className:"h-4 w-4 mt-0.5 shrink-0 text-muted-foreground"}),(0,s.jsx)("p",{children:J})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(B.User,{className:"h-4 w-4 shrink-0 text-muted-foreground"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)(F.Avatar,{className:"h-6 w-6",children:[(0,s.jsx)(F.AvatarImage,{alt:H?.displayName||"Unassigned",src:H?.avatar||void 0}),(0,s.jsx)(F.AvatarFallback,{className:"text-xs",children:$})]}),(0,s.jsx)("span",{className:"font-medium",children:H?.displayName||"Unassigned"})]})]}),(0,s.jsx)("div",{className:"flex items-center gap-2",children:(0,s.jsx)(L.Badge,{variant:"secondary",className:"capitalize",children:l.status||"Unscheduled"})})]}),l.description&&(0,s.jsx)("div",{className:"pt-2 border-t",children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground line-clamp-2",children:l.description})})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-muted-foreground mb-3",children:"Actions"}),C.map(e=>{let t=V[e],a=t.icon,r="destructive"===t.variant;return(0,s.jsxs)(v.Button,{className:(0,k.cn)("h-14 w-full justify-start gap-3 text-base font-medium",r&&"text-destructive hover:text-destructive"),onClick:()=>x(e,l),variant:r?"ghost":"outline",children:[(0,s.jsx)(a,{className:"h-5 w-5"}),t.label]},e)})]})]})]}),(0,s.jsx)(W,{isOpen:"reschedule"===d,job:o,onClose:j,onConfirm:p}),(0,s.jsx)(Z,{isOpen:"reassign"===d,job:o,onClose:j,onConfirm:g}),(0,s.jsx)(et,{isOpen:"status"===d,job:o,onClose:j,onConfirm:f})]})}let el={unscheduled:{bg:"bg-gray-100 dark:bg-gray-800",text:"text-gray-700 dark:text-gray-300",label:"Unscheduled"},scheduled:{bg:"bg-blue-100 dark:bg-blue-900/30",text:"text-blue-700 dark:text-blue-300",label:"Scheduled"},dispatched:{bg:"bg-yellow-100 dark:bg-yellow-900/30",text:"text-yellow-700 dark:text-yellow-300",label:"Dispatched"},arrived:{bg:"bg-purple-100 dark:bg-purple-900/30",text:"text-purple-700 dark:text-purple-300",label:"Arrived"},in_progress:{bg:"bg-orange-100 dark:bg-orange-900/30",text:"text-orange-700 dark:text-orange-300",label:"In Progress"},closed:{bg:"bg-green-100 dark:bg-green-900/30",text:"text-green-700 dark:text-green-300",label:"Closed"},completed:{bg:"bg-emerald-100 dark:bg-emerald-900/30",text:"text-emerald-700 dark:text-emerald-300",label:"Completed"},cancelled:{bg:"bg-red-100 dark:bg-red-900/30",text:"text-red-700 dark:text-red-300",label:"Cancelled"}};function er({job:e,onClick:t,className:a,showTechnician:l=!0,showDate:r=!0}){let n=el[e.status?.toLowerCase().replace(/ /g,"_")||"unscheduled"]||el.unscheduled,i=e.startTime?(0,b.format)(new Date(e.startTime),"h:mm a"):"Not scheduled";e.endTime&&(0,b.format)(new Date(e.endTime),"h:mm a"),e.startTime&&(0,b.format)(new Date(e.startTime),"MMM d");let o=e.assignments.find(e=>"primary"===e.role),c=o?.displayName?o.displayName.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2):"?",d=e.customer?.name||"No Customer",u=e.location?.address?.street||"No location";return(0,s.jsxs)("button",{className:(0,k.cn)("group relative flex w-full items-center gap-3 rounded-lg border bg-card p-3 text-left transition-all","min-h-[64px]","hover:border-primary/30 hover:bg-primary/5 hover:shadow-sm","active:scale-[0.99]","focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",a),onClick:t,type:"button",children:[(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center shrink-0 w-16 text-center",children:[(0,s.jsx)("span",{className:"text-sm font-semibold leading-tight",children:"Not scheduled"===i?"--:--":(0,b.format)(new Date(e.startTime),"h:mm")}),(0,s.jsx)("span",{className:"text-[0.65rem] text-muted-foreground uppercase",children:"Not scheduled"===i?"":(0,b.format)(new Date(e.startTime),"a")})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0 space-y-0.5",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold leading-tight truncate",children:d}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground truncate",children:e.title||"Untitled Job"}),"No location"!==u&&(0,s.jsxs)("div",{className:"flex items-center gap-1 text-[0.65rem] text-muted-foreground",children:[(0,s.jsx)(D.MapPin,{className:"h-2.5 w-2.5"}),(0,s.jsx)("span",{className:"truncate",children:u})]})]}),(0,s.jsxs)("div",{className:"flex flex-col items-end gap-1.5 shrink-0",children:[(0,s.jsx)(L.Badge,{className:(0,k.cn)("text-[0.65rem] font-medium h-4 px-1.5",n.bg,n.text),variant:"secondary",children:n.label}),l&&(0,s.jsxs)("div",{className:"flex items-center gap-1",children:[(0,s.jsxs)(F.Avatar,{className:"h-4 w-4",children:[(0,s.jsx)(F.AvatarImage,{alt:o?.displayName||"Unassigned",src:o?.avatar||void 0}),(0,s.jsx)(F.AvatarFallback,{className:"text-[0.5rem] font-medium",children:c})]}),(0,s.jsx)("span",{className:"text-[0.65rem] text-muted-foreground max-w-[60px] truncate",children:o?.displayName||"Unassigned"})]})]})]})}var en=e.i(148347),ei=e.i(371526),eo=e.i(935682),ec=e.i(760091),ed=e.i(623380);e.i(306226);var eu=e.i(508420);function em({isOpen:e,onClose:a,onJobSelect:l}){let[r,n]=(0,t.useState)(""),i=(0,o.useScheduleStore)(e=>e.jobs),c=(0,t.useMemo)(()=>Array.from(i.values()),[i]),d=(0,t.useMemo)(()=>{if(!r.trim())return[];let e=r.toLowerCase();return c.filter(s=>!!((s.customer?.name?.toLowerCase()||"").includes(e)||(s.title?.toLowerCase()||"").includes(e)||(s.location?.address?.street?.toLowerCase()||"").includes(e)||(s.jobNumber?.toString().toLowerCase()||"").includes(e)))},[c,r]);return(0,s.jsx)(eu.Sheet,{open:e,onOpenChange:a,children:(0,s.jsxs)(eu.SheetContent,{side:"top",className:"h-[90vh] flex flex-col",children:[(0,s.jsx)(eu.SheetHeader,{children:(0,s.jsx)(eu.SheetTitle,{children:"Search Jobs"})}),(0,s.jsxs)("div",{className:"relative mt-4",children:[(0,s.jsx)(w.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(Y.Input,{autoFocus:!0,className:"pl-9 pr-9",onChange:e=>n(e.target.value),placeholder:"Search by customer, job title, location...",type:"search",value:r}),r&&(0,s.jsxs)(v.Button,{className:"absolute right-1 top-1/2 h-7 w-7 -translate-y-1/2 p-0",onClick:()=>{n("")},size:"sm",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Clear search"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto mt-4",children:r.trim()?0===d.length?(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(w.Search,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-20"}),(0,s.jsxs)("p",{className:"mt-4 text-sm text-muted-foreground",children:['No jobs found for "',r,'"']})]})}):(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mb-3",children:[d.length," ",1===d.length?"job":"jobs"," found"]}),d.map(e=>(0,s.jsx)(er,{job:e,onClick:()=>{l(e),a()},showDate:!0,showTechnician:!0},e.id))]}):(0,s.jsx)("div",{className:"flex h-full items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(w.Search,{className:"mx-auto h-12 w-12 text-muted-foreground opacity-20"}),(0,s.jsx)("p",{className:"mt-4 text-sm text-muted-foreground",children:"Start typing to search jobs"})]})})})]})})}let eh=[{value:"scheduled",label:"Scheduled",color:"bg-blue-100 text-blue-700 dark:bg-blue-900/30 dark:text-blue-300"},{value:"dispatched",label:"Dispatched",color:"bg-yellow-100 text-yellow-700 dark:bg-yellow-900/30 dark:text-yellow-300"},{value:"arrived",label:"Arrived",color:"bg-purple-100 text-purple-700 dark:bg-purple-900/30 dark:text-purple-300"},{value:"in_progress",label:"In Progress",color:"bg-orange-100 text-orange-700 dark:bg-orange-900/30 dark:text-orange-300"},{value:"completed",label:"Completed",color:"bg-green-100 text-green-700 dark:bg-green-900/30 dark:text-green-300"},{value:"cancelled",label:"Cancelled",color:"bg-red-100 text-red-700 dark:bg-red-900/30 dark:text-red-300"}];function ex({isOpen:e,onClose:a,activeFilters:l,onApplyFilters:r}){let[n,i]=(0,t.useState)(l.statuses),[c,d]=(0,t.useState)(l.technicianIds),[u,m]=(0,t.useState)(l.showUnassignedOnly),h=(0,o.useScheduleStore)(e=>e.technicians),x=(0,t.useMemo)(()=>Array.from(h.values()),[h]),b=n.length>0||c.length>0||u;return(0,s.jsx)(eu.Sheet,{open:e,onOpenChange:a,children:(0,s.jsxs)(eu.SheetContent,{side:"right",className:"w-[300px] sm:w-[400px] flex flex-col",children:[(0,s.jsx)(eu.SheetHeader,{children:(0,s.jsxs)(eu.SheetTitle,{className:"flex items-center justify-between",children:[(0,s.jsx)("span",{children:"Filter Jobs"}),(0,s.jsx)(v.Button,{className:"h-8 w-8 p-0",onClick:a,size:"icon",variant:"ghost",children:(0,s.jsx)(U.X,{className:"h-4 w-4"})})]})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto py-6 space-y-6",children:[(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)($.Label,{className:"text-sm font-semibold",children:"Status"}),(0,s.jsx)("div",{className:"space-y-2",children:eh.map(e=>(0,s.jsxs)("button",{className:(0,k.cn)("flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors",n.includes(e.value)?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),onClick:()=>{var s;return s=e.value,void i(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},type:"button",children:[(0,s.jsx)(L.Badge,{className:(0,k.cn)("text-xs",e.color),variant:"secondary",children:e.label}),n.includes(e.value)&&(0,s.jsx)(X.Check,{className:"h-4 w-4 text-primary"})]},e.value))})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)($.Label,{className:"text-sm font-semibold",children:"Technician"}),(0,s.jsx)("div",{className:"space-y-2",children:x.map(e=>{let t=e.name.split(" ").map(e=>e[0]).join("").toUpperCase().slice(0,2);return(0,s.jsxs)("button",{className:(0,k.cn)("flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors",c.includes(e.id)?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),onClick:()=>{var s;return s=e.id,void d(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s])},type:"button",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(F.Avatar,{className:"h-8 w-8",children:[(0,s.jsx)(F.AvatarImage,{alt:e.name,src:e.avatar||void 0}),(0,s.jsx)(F.AvatarFallback,{className:"text-xs",children:t})]}),(0,s.jsx)("span",{className:"text-sm font-medium",children:e.name})]}),c.includes(e.id)&&(0,s.jsx)(X.Check,{className:"h-4 w-4 text-primary"})]},e.id)})})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)($.Label,{className:"text-sm font-semibold",children:"Special Filters"}),(0,s.jsxs)("button",{className:(0,k.cn)("flex w-full items-center justify-between rounded-lg border p-3 text-left transition-colors",u?"border-yellow-500 bg-yellow-50 dark:bg-yellow-950/20":"border-border hover:bg-muted/50"),onClick:()=>m(!u),type:"button",children:[(0,s.jsx)("span",{className:"text-sm font-medium",children:"Show unassigned only"}),u&&(0,s.jsx)(X.Check,{className:"h-4 w-4 text-yellow-600 dark:text-yellow-400"})]})]})]}),(0,s.jsxs)("div",{className:"shrink-0 space-y-2 border-t pt-4",children:[b&&(0,s.jsx)(v.Button,{className:"w-full",onClick:()=>{i([]),d([]),m(!1)},size:"sm",variant:"outline",children:"Clear All Filters"}),(0,s.jsx)(v.Button,{className:"w-full",onClick:()=>{r({statuses:n,technicianIds:c,showUnassignedOnly:u}),a()},size:"default",children:"Apply Filters"})]})]})})}function eb({onJobSelect:e}){let a=(0,r.useRouter)(),{viewMode:l,setViewMode:i}=(0,n.useScheduleViewStore)(),c=(0,o.useScheduleStore)(e=>e.jobs),[d,u]=(0,t.useState)(!1),[m,h]=(0,t.useState)(!1),[x,b]=(0,t.useState)({statuses:[],technicianIds:[],showUnassignedOnly:!1}),p=(0,t.useMemo)(()=>{let e=Array.from(c.values()),s=new Date;s.setHours(0,0,0,0);let t=e.filter(e=>{let t=new Date(e.startTime);return t.setHours(0,0,0,0),t.getTime()===s.getTime()});return{total:t.length,completed:t.filter(e=>"completed"===e.status).length,inProgress:t.filter(e=>"in_progress"===e.status||"in-progress"===e.status).length,unassigned:t.filter(e=>e.isUnassigned).length}},[c]),g=e=>{i(e)},f=x.statuses.length+x.technicianIds.length+ +!!x.showUnassignedOnly;return(0,s.jsxs)("div",{className:"safe-top sticky top-0 z-35 border-b bg-background/95 backdrop-blur-sm supports-[backdrop-filter]:bg-background/80",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-2 px-4 py-2.5",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-lg border p-1",children:[(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>g("day"),size:"sm",variant:"day"===l?"secondary":"ghost",children:[(0,s.jsx)(N.Calendar,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Day view"})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>g("week"),size:"sm",variant:"week"===l?"secondary":"ghost",children:[(0,s.jsx)(ec.LayoutGrid,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Week view"})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>g("list"),size:"sm",variant:"list"===l?"secondary":"ghost",children:[(0,s.jsx)(ed.List,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"List view"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,s.jsxs)(eu.Sheet,{children:[(0,s.jsx)(eu.SheetTrigger,{asChild:!0,children:(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0",size:"sm",variant:"ghost",children:[(0,s.jsx)(eo.BarChart3,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"View stats"})]})}),(0,s.jsxs)(eu.SheetContent,{side:"bottom",className:"h-[300px]",children:[(0,s.jsx)(eu.SheetHeader,{children:(0,s.jsx)(eu.SheetTitle,{children:"Today's Stats"})}),(0,s.jsxs)("div",{className:"mt-6 grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,s.jsx)("p",{className:"text-2xl font-bold",children:p.total}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Total Jobs"})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-green-600",children:p.completed}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Completed"})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:p.inProgress}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"In Progress"})]}),(0,s.jsxs)("div",{className:"rounded-lg border p-4",children:[(0,s.jsx)("p",{className:"text-2xl font-bold text-yellow-600",children:p.unassigned}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"Unassigned"})]})]})]})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>u(!0),size:"sm",variant:"ghost",children:[(0,s.jsx)(w.Search,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Search jobs"})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0 relative",onClick:()=>h(!0),size:"sm",variant:"ghost",children:[(0,s.jsx)(en.Filter,{className:"h-4 w-4"}),f>0&&(0,s.jsx)(L.Badge,{className:"absolute -top-1 -right-1 h-4 min-w-4 p-0 text-[0.6rem]",variant:"destructive",children:f}),(0,s.jsx)("span",{className:"sr-only",children:"Filter jobs"})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 p-0",onClick:()=>{a.push("/dashboard/work/jobs/new")},size:"sm",variant:"default",children:[(0,s.jsx)(ei.Plus,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Create job"})]})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2 overflow-x-auto px-4 pb-2 scrollbar-none",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border bg-muted/50 px-3 py-1 text-xs whitespace-nowrap",children:[(0,s.jsx)("span",{className:"font-semibold",children:p.total}),(0,s.jsx)("span",{className:"text-muted-foreground",children:"Total"})]}),p.completed>0&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border border-green-200 bg-green-50 px-3 py-1 text-xs whitespace-nowrap dark:border-green-900 dark:bg-green-950",children:[(0,s.jsx)("span",{className:"font-semibold text-green-700 dark:text-green-300",children:p.completed}),(0,s.jsx)("span",{className:"text-green-600 dark:text-green-400",children:"Done"})]}),p.inProgress>0&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border border-orange-200 bg-orange-50 px-3 py-1 text-xs whitespace-nowrap dark:border-orange-900 dark:bg-orange-950",children:[(0,s.jsx)("span",{className:"font-semibold text-orange-700 dark:text-orange-300",children:p.inProgress}),(0,s.jsx)("span",{className:"text-orange-600 dark:text-orange-400",children:"Active"})]}),p.unassigned>0&&(0,s.jsxs)("div",{className:"flex items-center gap-1.5 rounded-full border border-yellow-200 bg-yellow-50 px-3 py-1 text-xs whitespace-nowrap dark:border-yellow-900 dark:bg-yellow-950",children:[(0,s.jsx)("span",{className:"font-semibold text-yellow-700 dark:text-yellow-300",children:p.unassigned}),(0,s.jsx)("span",{className:"text-yellow-600 dark:text-yellow-400",children:"Unassigned"})]})]}),(0,s.jsx)(em,{isOpen:d,onClose:()=>u(!1),onJobSelect:s=>{e&&e(s)}}),(0,s.jsx)(ex,{activeFilters:x,isOpen:m,onApplyFilters:e=>{b(e)},onClose:()=>h(!1)})]})}function ep({isOpen:e,onClose:a,currentDate:l,onDateSelect:r}){let[n,i]=(0,t.useState)(l),o=()=>{i(l),a()};return(0,s.jsx)(eu.Sheet,{open:e,onOpenChange:o,children:(0,s.jsxs)(eu.SheetContent,{side:"bottom",className:"h-[500px] flex flex-col",children:[(0,s.jsx)(eu.SheetHeader,{children:(0,s.jsxs)(eu.SheetTitle,{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"flex items-center gap-2",children:[(0,s.jsx)(N.Calendar,{className:"h-5 w-5"}),"Select Date"]}),(0,s.jsxs)(v.Button,{className:"h-8 w-8 p-0",onClick:o,size:"icon",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})}),(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center overflow-y-auto py-4",children:(0,s.jsx)(H.Calendar,{className:"rounded-md border",mode:"single",onSelect:e=>{e&&i(e)},selected:n})}),(0,s.jsx)("div",{className:"shrink-0 space-y-2 border-t pt-4",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(v.Button,{className:"flex-1",onClick:()=>{let e=new Date;i(e),r(e),a()},size:"default",variant:"outline",children:"Today"}),(0,s.jsxs)(v.Button,{className:"flex-1",onClick:()=>{r(n),a()},size:"default",children:["Go to ",(0,b.format)(n,"MMM d, yyyy")]})]})})]})})}var eg=e.i(995403);function ef(){let a=(0,o.useScheduleStore)(e=>e.jobs),l=(0,o.useScheduleStore)(e=>e.technicians),{currentDate:r,goToToday:i,navigatePrevious:c,navigateNext:d,setCurrentDate:u}=(0,n.useScheduleViewStore)(),m=(0,t.useMemo)(()=>Array.from(a.values()),[a]),h=(0,t.useMemo)(()=>Array.from(l.values()),[l]),[x,N]=(0,t.useState)(null),[w,y]=(0,t.useState)(new Set),[k,C]=(0,t.useState)(!1),[T,M]=(0,t.useState)(!1),_=(0,t.useMemo)(()=>m.filter(e=>{if(!e.startTime)return!1;let s="string"==typeof e.startTime?new Date(e.startTime):e.startTime;return(0,p.isSameDay)(s,r)}),[m,r]),D=(0,t.useMemo)(()=>{let e=new Map;return h.forEach(s=>{e.set(s.id,[])}),_.forEach(s=>{if(s.technicianId){let t=e.get(s.technicianId)||[];t.push(s),e.set(s.technicianId,t)}}),e.forEach(e=>{e.sort((e,s)=>e.startTime?s.startTime?new Date(e.startTime).getTime()-new Date(s.startTime).getTime():-1:1)}),e},[_,h]),A=(0,t.useMemo)(()=>_.filter(e=>e.isUnassigned),[_]),I=(0,t.useCallback)(e=>{y(s=>{let t=new Set(s);return t.has(e)?t.delete(e):t.add(e),t})},[]),z=(0,t.useCallback)(async(s,t,...a)=>{N(null);try{switch(s){case"view_details":window.location.href=`/dashboard/work/jobs/${t.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:l}=await e.A(805737),r="move_to_status"===s?a[0]:s,n=await l(t.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[s]||r);n.success?(eg.toast.success(`Job ${"move_to_status"===s?"moved to "+r:s+"ed"}`),window.location.reload()):eg.toast.error(n.error||"Failed to update job status");break}case"reschedule":{let[s,l]=a,{updateJob:r}=await e.A(805737),n=await r({jobId:t.id,scheduled_start:s.toISOString(),scheduled_end:l.toISOString()});n.success?(eg.toast.success("Job rescheduled"),window.location.reload()):eg.toast.error(n.error||"Failed to reschedule job");break}case"reassign":{let s=a[0];if(s){let{assignJobToTechnician:a}=await e.A(646739),l=await a(t.id,s);l.success?(eg.toast.success("Job reassigned"),window.location.reload()):eg.toast.error(l.error||"Failed to reassign job")}else eg.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:s}=await e.A(646739),a=await s(t.id);a.success?(eg.toast.success("Job cancelled"),window.location.reload()):eg.toast.error(a.error||"Failed to cancel job");break}default:console.warn("Unknown action:",s)}}catch(e){console.error("Job action error:",e),eg.toast.error("An error occurred")}},[]);(0,b.format)(r,"EEEE, MMM d, yyyy");let B=(0,p.isSameDay)(r,new Date);return(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,s.jsx)(eb,{onJobSelect:N}),(0,s.jsxs)("div",{className:"shrink-0 border-b bg-background",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4",children:[(0,s.jsxs)(v.Button,{className:"h-9 w-9",onClick:c,size:"icon",variant:"ghost",children:[(0,s.jsx)(j.ChevronLeft,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Previous day"})]}),(0,s.jsxs)("button",{className:"flex flex-col items-center transition-colors hover:text-primary active:scale-95",onClick:()=>M(!0),type:"button",children:[(0,s.jsx)("h2",{className:"text-sm font-medium text-muted-foreground",children:(0,b.format)(r,"EEEE")}),(0,s.jsx)("p",{className:"text-lg font-semibold",children:(0,b.format)(r,"MMM d, yyyy")})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9",onClick:d,size:"icon",variant:"ghost",children:[(0,s.jsx)(f.ChevronRight,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Next day"})]})]}),!B&&(0,s.jsx)("div",{className:"px-4 pb-3",children:(0,s.jsx)(v.Button,{className:"w-full",onClick:i,size:"sm",variant:"outline",children:"Go to Today"})})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===_.length?(0,s.jsx)(S,{actionLabel:"View Full Schedule",onAction:()=>{window.location.href="/dashboard/schedule"},variant:"no_jobs_today"}):(0,s.jsxs)("div",{className:"space-y-0",children:[h.map(e=>{let t=D.get(e.id)||[],a=w.has(e.id),l=t.length>0;return(0,s.jsxs)("div",{className:"border-b last:border-b-0",children:[(0,s.jsxs)("button",{className:"flex w-full items-center justify-between bg-muted/30 p-4 text-left transition-colors hover:bg-muted/50 active:bg-muted",onClick:()=>I(e.id),type:"button",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[a?(0,s.jsx)(g.ChevronDown,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(f.ChevronRight,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium",children:e.name}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[t.length," ",1===t.length?"job":"jobs"]})]})]}),l&&(0,s.jsx)("div",{className:"flex h-6 min-w-6 items-center justify-center rounded-full bg-primary/10 px-2 text-xs font-semibold text-primary",children:t.length})]}),a&&(0,s.jsx)("div",{className:"bg-background px-4 pb-4",children:0===t.length?(0,s.jsx)("p",{className:"py-8 text-center text-sm text-muted-foreground",children:"No jobs scheduled for today"}):(0,s.jsx)("div",{className:"space-y-1.5",children:t.map(e=>(0,s.jsx)(er,{job:e,onClick:()=>N(e),showDate:!1,showTechnician:!1},e.id))})})]},e.id)}),A.length>0&&(0,s.jsxs)("div",{className:"border-t",children:[(0,s.jsxs)("button",{className:"flex w-full items-center justify-between bg-yellow-50 dark:bg-yellow-950/20 p-4 text-left transition-colors hover:bg-yellow-100 dark:hover:bg-yellow-950/30 active:bg-yellow-100 dark:active:bg-yellow-950/30",onClick:()=>C(!k),type:"button",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[k?(0,s.jsx)(g.ChevronDown,{className:"h-4 w-4 text-muted-foreground"}):(0,s.jsx)(f.ChevronRight,{className:"h-4 w-4 text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-medium",children:"ðŸ“‹ Unassigned"}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[A.length," ",1===A.length?"job":"jobs"," need assignment"]})]})]}),(0,s.jsx)("div",{className:"flex h-6 min-w-6 items-center justify-center rounded-full bg-yellow-500 dark:bg-yellow-600 px-2 text-xs font-semibold text-white",children:A.length})]}),k&&(0,s.jsx)("div",{className:"bg-background px-4 pb-4",children:(0,s.jsx)("div",{className:"space-y-1.5",children:A.map(e=>(0,s.jsx)(er,{job:e,onClick:()=>N(e),showDate:!1,showTechnician:!0},e.id))})})]})]})}),(0,s.jsx)(ea,{isOpen:null!==x,job:x,onAction:z,onClose:()=>N(null)}),(0,s.jsx)(ep,{currentDate:r,isOpen:T,onClose:()=>M(!1),onDateSelect:e=>{u(e),M(!1)}})]})}let ej=[{id:"unscheduled",label:"Unscheduled",color:"bg-gray-500"},{id:"scheduled",label:"Scheduled",color:"bg-blue-500"},{id:"dispatched",label:"Dispatched",color:"bg-yellow-500"},{id:"arrived",label:"Arrived",color:"bg-purple-500"},{id:"in_progress",label:"In Progress",color:"bg-orange-500"},{id:"closed",label:"Closed",color:"bg-green-500"},{id:"completed",label:"Completed",color:"bg-emerald-500"},{id:"cancelled",label:"Cancelled",color:"bg-red-500"}];function ev(){let a=(0,o.useScheduleStore)(e=>e.jobs),l=(0,t.useMemo)(()=>Array.from(a.values()),[a]),[r,n]=(0,t.useState)(2),[i,c]=(0,t.useState)(null),d=ej[r],u=(0,t.useMemo)(()=>l.filter(e=>(e.status||"unscheduled").toLowerCase().replace(/ /g,"_")===d.id),[l,d.id]),m=(0,t.useMemo)(()=>[...u].sort((e,s)=>e.scheduled_start?s.scheduled_start?new Date(e.scheduled_start).getTime()-new Date(s.scheduled_start).getTime():-1:1),[u]),h=(0,t.useCallback)(()=>{n(e=>Math.max(0,e-1))},[]),x=(0,t.useCallback)(()=>{n(e=>Math.min(ej.length-1,e+1))},[]),b=(0,t.useCallback)(e=>{n(e)},[]),p=(0,t.useCallback)(async(s,t,...a)=>{c(null);try{switch(s){case"view_details":window.location.href=`/dashboard/work/jobs/${t.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:l}=await e.A(805737),r="move_to_status"===s?a[0]:s,n=await l(t.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[s]||r);n.success?(eg.toast.success(`Job ${"move_to_status"===s?"moved to "+r:s+"ed"}`),window.location.reload()):eg.toast.error(n.error||"Failed to update job status");break}case"reschedule":{let[s,l]=a,{updateJob:r}=await e.A(805737),n=await r({jobId:t.id,scheduled_start:s.toISOString(),scheduled_end:l.toISOString()});n.success?(eg.toast.success("Job rescheduled"),window.location.reload()):eg.toast.error(n.error||"Failed to reschedule job");break}case"reassign":{let s=a[0];if(s){let{assignJobToTechnician:a}=await e.A(646739),l=await a(t.id,s);l.success?(eg.toast.success("Job reassigned"),window.location.reload()):eg.toast.error(l.error||"Failed to reassign job")}else eg.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:s}=await e.A(646739),a=await s(t.id);a.success?(eg.toast.success("Job cancelled"),window.location.reload()):eg.toast.error(a.error||"Failed to cancel job");break}default:console.warn("Unknown action:",s)}}catch(e){console.error("Job action error:",e),eg.toast.error("An error occurred")}},[]),g=r<ej.length-1;return(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"shrink-0 border-b bg-background p-4",children:[(0,s.jsx)("div",{className:"mb-4 flex items-center justify-center gap-2",children:ej.map((e,t)=>{let a=t===r;return(0,s.jsxs)("button",{className:"transition-transform hover:scale-125 active:scale-110",onClick:()=>b(t),type:"button",children:[(0,s.jsx)("div",{className:`h-2 w-2 rounded-full transition-all ${a?`${e.color} scale-125`:"bg-muted-foreground/30"}`}),(0,s.jsx)("span",{className:"sr-only",children:e.label})]},e.id)})}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)(v.Button,{className:"h-9 w-9",disabled:!(r>0),onClick:h,size:"icon",variant:"ghost",children:[(0,s.jsx)(j.ChevronLeft,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Previous status"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:`mb-1 h-1 w-16 rounded-full ${d.color}`}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:d.label}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[m.length," ",1===m.length?"job":"jobs"]})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9",disabled:!g,onClick:x,size:"icon",variant:"ghost",children:[(0,s.jsx)(f.ChevronRight,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Next status"})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===m.length?(0,s.jsx)("div",{className:"flex h-full items-center justify-center p-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:['No jobs with status "',d.label,'"']}),g&&(0,s.jsxs)(v.Button,{className:"mt-4",onClick:x,size:"sm",variant:"outline",children:["View ",ej[r+1].label]})]})}):(0,s.jsx)("div",{className:"space-y-2 p-4",children:m.map(e=>(0,s.jsx)(er,{job:e,onClick:()=>c(e),showDate:!0,showTechnician:!0},e.id))})}),(0,s.jsx)(ea,{isOpen:null!==i,job:i,onAction:p,onClose:()=>c(null)})]})}var eN=e.i(551685),ew=e.i(598279),ey=e.i(250954);function ek(e,s){return(0,p.isSameDay)(e,(0,ew.addDays)((0,ey.constructNow)(s?.in||e),1),s)}var eC=e.i(511518),eS=e.i(487122);let eT=/[T ]/,eM=/[Z ]/i,e_=/([Z+-].*)$/,eD=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,eA=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,eI=/^([+-])(\d{2})(?::?(\d{2}))?$/;function ez(e){return e?parseInt(e):1}function eB(e){return e&&parseFloat(e.replace(",","."))||0}let eU=[31,null,31,30,31,30,31,31,30,31,30,31];function eF(e){return e%400==0||e%4==0&&e%100!=0}e.i(868198);var eL=e.i(798764);function eJ({statusOptions:e,technicianOptions:t,activeFilters:a,onToggleStatus:l,onToggleTechnician:r,onClearAll:n,onOpenFilters:i,className:o}){let c=a.statuses.length>0||a.technicians.length>0||a.dateRange,d=a.statuses.length+a.technicians.length+ +!!a.dateRange;return(0,s.jsxs)("div",{className:(0,k.cn)("flex items-center gap-2 overflow-x-auto pb-2",o),children:[i&&(0,s.jsxs)(v.Button,{className:"h-9 shrink-0 gap-2",onClick:i,size:"sm",variant:"outline",children:[(0,s.jsx)(en.Filter,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Filters"}),d>0&&(0,s.jsx)(L.Badge,{className:"ml-1 h-5 min-w-5 px-1.5 text-xs",variant:"secondary",children:d})]}),e.map(e=>{let t=a.statuses.includes(e.id);return(0,s.jsxs)(L.Badge,{className:(0,k.cn)("h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all",t?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),onClick:()=>l(e.id),variant:"secondary",children:[(0,s.jsx)("span",{children:e.label}),void 0!==e.count&&(0,s.jsx)("span",{className:(0,k.cn)("rounded-full px-1.5 py-0.5 text-xs font-semibold",t?"bg-primary-foreground/20 text-primary-foreground":"bg-muted text-muted-foreground"),children:e.count})]},e.id)}),t.length>0&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"h-6 w-px bg-border shrink-0"}),t.map(e=>{let t=a.technicians.includes(e.id);return(0,s.jsxs)(L.Badge,{className:(0,k.cn)("h-9 cursor-pointer shrink-0 gap-1.5 px-3 text-sm font-medium transition-all",t?"bg-primary text-primary-foreground hover:bg-primary/90":"bg-secondary text-secondary-foreground hover:bg-secondary/80"),onClick:()=>r(e.id),variant:"secondary",children:[(0,s.jsx)("span",{children:e.label}),void 0!==e.count&&(0,s.jsx)("span",{className:(0,k.cn)("rounded-full px-1.5 py-0.5 text-xs font-semibold",t?"bg-primary-foreground/20 text-primary-foreground":"bg-muted text-muted-foreground"),children:e.count})]},e.id)})]}),c&&(0,s.jsxs)(v.Button,{className:"h-9 shrink-0 gap-2",onClick:n,size:"sm",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-4 w-4"}),(0,s.jsx)("span",{children:"Clear"})]})]})}function eE(){let a=(0,o.useScheduleStore)(e=>e.jobs),l=(0,o.useScheduleStore)(e=>e.technicians),r=(0,t.useMemo)(()=>Array.from(a.values()),[a]),n=(0,t.useMemo)(()=>Array.from(l.values()),[l]),[i,c]=(0,t.useState)(""),[d,u]=(0,t.useState)("date"),[m,h]=(0,t.useState)("start_time"),[x,p]=(0,t.useState)(null),[g,f]=(0,t.useState)({statuses:[],technicians:[]}),j=(0,t.useMemo)(()=>{let e=r.reduce((e,s)=>{let t=s.status||"unscheduled";return e[t]=(e[t]||0)+1,e},{});return[{id:"scheduled",label:"Scheduled",count:e.scheduled||0},{id:"dispatched",label:"Dispatched",count:e.dispatched||0},{id:"arrived",label:"Arrived",count:e.arrived||0},{id:"in_progress",label:"In Progress",count:e.in_progress||0},{id:"completed",label:"Completed",count:e.completed||0}]},[r]),N=(0,t.useMemo)(()=>n.map(e=>{let s=r.filter(s=>s.assignedTechnicianId===e.id).length;return{id:e.id,label:e.name,count:s}}),[n,r]),y=(0,t.useMemo)(()=>{let e=[...r];if(i.trim()){let s=i.toLowerCase();e=e.filter(e=>e.customer?.name.toLowerCase().includes(s)||e.title?.toLowerCase().includes(s)||e.property?.address?.toLowerCase().includes(s)||e.description?.toLowerCase().includes(s))}return g.statuses.length>0&&(e=e.filter(e=>g.statuses.includes(e.status?.toLowerCase()||"unscheduled"))),g.technicians.length>0&&(e=e.filter(e=>!!e.assignedTechnicianId&&g.technicians.includes(e.assignedTechnicianId))),e},[r,i,g]),k=(0,t.useMemo)(()=>{let e=[...y];switch(m){case"start_time":e.sort((e,s)=>e.scheduled_start?s.scheduled_start?new Date(e.scheduled_start).getTime()-new Date(s.scheduled_start).getTime():-1:1);break;case"customer":e.sort((e,s)=>{let t=e.customer?.name||"",a=s.customer?.name||"";return t.localeCompare(a)});break;case"status":e.sort((e,s)=>{let t=e.status||"unscheduled",a=s.status||"unscheduled";return t.localeCompare(a)})}return e},[y,m]),C=(0,t.useMemo)(()=>{let e={};return k.forEach(s=>{let t="";switch(d){case"date":if(s.scheduled_start){let e="string"==typeof s.scheduled_start?function(e,s){let t,a,l=()=>(0,eS.constructFrom)(void 0,NaN),r=function(e){let s,t={},a=e.split(eT);if(a.length>2)return t;if(/:/.test(a[0])?s=a[0]:(t.date=a[0],s=a[1],eM.test(t.date)&&(t.date=e.split(eM)[0],s=e.substr(t.date.length,e.length))),s){let e=e_.exec(s);e?(t.time=s.replace(e[1],""),t.timezone=e[1]):t.time=s}return t}(e);if(r.date){let e=function(e,s){let t=RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),a=e.match(t);if(!a)return{year:NaN,restDateString:""};let l=a[1]?parseInt(a[1]):null,r=a[2]?parseInt(a[2]):null;return{year:null===r?l:100*r,restDateString:e.slice((a[1]||a[2]).length)}}(r.date,(void 0)??2);t=function(e,s){var t,a,l,r,n,i,o,c,d,u;if(null===s)return new Date(NaN);let m=e.match(eD);if(!m)return new Date(NaN);let h=!!m[4],x=ez(m[1]),b=ez(m[2])-1,p=ez(m[3]),g=ez(m[4]),f=ez(m[5])-1;if(h){let e,i;return(t=g,a=f,t>=1&&t<=53&&a>=0&&a<=6)?(l=s,r=g,n=f,(e=new Date(0)).setUTCFullYear(l,0,4),i=e.getUTCDay()||7,e.setUTCDate(e.getUTCDate()+((r-1)*7+n+1-i)),e):new Date(NaN)}{let e=new Date(0);return(i=s,o=b,c=p,o>=0&&o<=11&&c>=1&&c<=(eU[o]||(eF(i)?29:28))&&(d=s,(u=x)>=1&&u<=(eF(d)?366:365)))?(e.setUTCFullYear(s,b,Math.max(x,p)),e):new Date(NaN)}}(e.restDateString,e.year)}if(!t||isNaN(+t))return l();let n=+t,i=0;if(r.time&&isNaN(i=function(e){var s,t,a;let l=e.match(eA);if(!l)return NaN;let r=eB(l[1]),n=eB(l[2]),i=eB(l[3]);return(s=r,t=n,a=i,24===s?0===t&&0===a:a>=0&&a<60&&t>=0&&t<60&&s>=0&&s<25)?r*eC.millisecondsInHour+n*eC.millisecondsInMinute+1e3*i:NaN}(r.time)))return l();if(r.timezone){if(isNaN(a=function(e){var s;if("Z"===e)return 0;let t=e.match(eI);if(!t)return 0;let a="+"===t[1]?-1:1,l=parseInt(t[2]),r=t[3]&&parseInt(t[3])||0;return(s=r)>=0&&s<=59?a*(l*eC.millisecondsInHour+r*eC.millisecondsInMinute):NaN}(r.timezone)))return l()}else{let e=new Date(n+i),s=(0,E.toDate)(0,void 0);return s.setFullYear(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()),s.setHours(e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()),s}return(0,E.toDate)(n+i+a,void 0)}(s.scheduled_start):new Date(s.scheduled_start);t=(0,eN.isToday)(e)?"Today":ek(e)?"Tomorrow":(0,b.format)(e,"EEEE, MMM d")}else t="Unscheduled";break;case"technician":t=s.assignedTechnician?.name||"Unassigned";break;case"status":t=s.status||"Unscheduled";break;case"customer":t=s.customer?.name||"No Customer";break;default:t="All Jobs"}e[t]||(e[t]=[]),e[t].push(s)}),e},[k,d]),T=(0,t.useCallback)(e=>{f(s=>({...s,statuses:s.statuses.includes(e)?s.statuses.filter(s=>s!==e):[...s.statuses,e]}))},[]),M=(0,t.useCallback)(e=>{f(s=>({...s,technicians:s.technicians.includes(e)?s.technicians.filter(s=>s!==e):[...s.technicians,e]}))},[]),_=(0,t.useCallback)(()=>{f({statuses:[],technicians:[]}),c("")},[]),D=(0,t.useCallback)(async(s,t,...a)=>{p(null);try{switch(s){case"view_details":window.location.href=`/dashboard/work/jobs/${t.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:l}=await e.A(805737),r="move_to_status"===s?a[0]:s,n=await l(t.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[s]||r);n.success?(eg.toast.success(`Job ${"move_to_status"===s?"moved to "+r:s+"ed"}`),window.location.reload()):eg.toast.error(n.error||"Failed to update job status");break}case"reschedule":{let[s,l]=a,{updateJob:r}=await e.A(805737),n=await r({jobId:t.id,scheduled_start:s.toISOString(),scheduled_end:l.toISOString()});n.success?(eg.toast.success("Job rescheduled"),window.location.reload()):eg.toast.error(n.error||"Failed to reschedule job");break}case"reassign":{let s=a[0];if(s){let{assignJobToTechnician:a}=await e.A(646739),l=await a(t.id,s);l.success?(eg.toast.success("Job reassigned"),window.location.reload()):eg.toast.error(l.error||"Failed to reassign job")}else eg.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:s}=await e.A(646739),a=await s(t.id);a.success?(eg.toast.success("Job cancelled"),window.location.reload()):eg.toast.error(a.error||"Failed to cancel job");break}default:console.warn("Unknown action:",s)}}catch(e){console.error("Job action error:",e),eg.toast.error("An error occurred")}},[]);return 0!==y.length||i||0!==g.statuses.length?(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"shrink-0 space-y-3 border-b bg-background p-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(w.Search,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),(0,s.jsx)(Y.Input,{className:"h-11 pl-10 text-base",onChange:e=>c(e.target.value),placeholder:"Search jobs, customers, or locations...",type:"search",value:i})]}),(0,s.jsx)(eJ,{activeFilters:g,onClearAll:_,onToggleStatus:T,onToggleTechnician:M,statusOptions:j,technicianOptions:N}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(eL.Select,{onValueChange:e=>u(e),value:d,children:[(0,s.jsx)(eL.SelectTrigger,{className:"h-9 w-[140px] text-sm",children:(0,s.jsx)(eL.SelectValue,{placeholder:"Group by"})}),(0,s.jsxs)(eL.SelectContent,{children:[(0,s.jsx)(eL.SelectItem,{value:"date",children:"Group by Date"}),(0,s.jsx)(eL.SelectItem,{value:"technician",children:"Group by Tech"}),(0,s.jsx)(eL.SelectItem,{value:"status",children:"Group by Status"}),(0,s.jsx)(eL.SelectItem,{value:"customer",children:"Group by Customer"})]})]}),(0,s.jsxs)(eL.Select,{onValueChange:e=>h(e),value:m,children:[(0,s.jsx)(eL.SelectTrigger,{className:"h-9 w-[140px] text-sm",children:(0,s.jsx)(eL.SelectValue,{placeholder:"Sort by"})}),(0,s.jsxs)(eL.SelectContent,{children:[(0,s.jsx)(eL.SelectItem,{value:"start_time",children:"Sort by Time"}),(0,s.jsx)(eL.SelectItem,{value:"customer",children:"Sort by Customer"}),(0,s.jsx)(eL.SelectItem,{value:"status",children:"Sort by Status"})]})]})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===y.length?(0,s.jsx)(S,{actionLabel:"Clear Filters",onAction:_,variant:"no_results"}):(0,s.jsx)("div",{className:"space-y-6 p-4",children:Object.entries(C).map(([e,t])=>(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-3 flex items-center justify-between",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-muted-foreground uppercase tracking-wide",children:e}),(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[t.length," ",1===t.length?"job":"jobs"]})]}),(0,s.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,s.jsx)(er,{job:e,onClick:()=>p(e),showDate:"date"!==d,showTechnician:"technician"!==d},e.id))})]},e))})}),(0,s.jsxs)(v.Button,{className:"fixed right-4 bottom-20 lg:bottom-4 h-14 w-14 rounded-full shadow-lg",onClick:()=>{window.location.href="/dashboard/work/jobs/new"},size:"icon",children:[(0,s.jsx)(ei.Plus,{className:"h-6 w-6"}),(0,s.jsx)("span",{className:"sr-only",children:"Create new job"})]}),(0,s.jsx)(ea,{isOpen:null!==x,job:x,onAction:D,onClose:()=>p(null)})]}):(0,s.jsx)("div",{className:"flex h-full flex-col",children:(0,s.jsx)(S,{onAction:()=>{window.location.href="/dashboard/work/jobs/new"},variant:"no_jobs"})})}var eO=e.i(432286),eP=e.i(936765),eH=e.i(954259),e$=e.i(348793),eR=e.i(983961);function eV({date:e,jobs:t,isOpen:a,onClose:l,onJobTap:r,onAction:n}){if(!e)return null;let i=(0,eN.isToday)(e)?"Today":ek(e)?"Tomorrow":(0,b.format)(e,"EEEE, MMMM d"),o=t.reduce((e,s)=>{if(!s.scheduled_start||!s.scheduled_end)return e;let t=new Date(s.scheduled_start);return e+(new Date(s.scheduled_end).getTime()-t.getTime())/36e5},0);return(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsx)("div",{className:"fixed inset-0 z-50 bg-black/50 animate-in fade-in",onClick:l}),(0,s.jsxs)("div",{className:(0,k.cn)("fixed bottom-0 left-0 right-0 z-50 bg-background rounded-t-2xl shadow-2xl","transform transition-transform duration-300 ease-out",a?"translate-y-0":"translate-y-full"),style:{maxHeight:"85vh"},children:[(0,s.jsx)("div",{className:"flex justify-center pt-3 pb-2",children:(0,s.jsx)("div",{className:"w-12 h-1 bg-muted-foreground/30 rounded-full"})}),(0,s.jsxs)("div",{className:"flex items-start justify-between gap-3 px-4 pb-4 border-b",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)(N.Calendar,{className:"h-5 w-5 text-primary"}),(0,s.jsx)("h2",{className:"text-lg font-semibold",children:i})]}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:(0,b.format)(e,"MMMM d, yyyy")}),t.length>0&&(0,s.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:[t.length," ",1===t.length?"job":"jobs"," Â· ",o.toFixed(1),"h total"]})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9 shrink-0",onClick:l,size:"icon",variant:"ghost",children:[(0,s.jsx)(U.X,{className:"h-5 w-5"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]}),(0,s.jsx)(R.ScrollArea,{className:"flex-1",style:{maxHeight:"calc(85vh - 200px)"},children:(0,s.jsx)("div",{className:"p-4",children:0===t.length?(0,s.jsxs)("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[(0,s.jsx)(N.Calendar,{className:"h-12 w-12 text-muted-foreground/50 mb-3"}),(0,s.jsx)("p",{className:"text-sm font-medium mb-1",children:"No jobs scheduled"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:"Schedule an appointment for this day"}),(0,s.jsxs)(v.Button,{onClick:()=>{n("create_appointment",e)},size:"sm",variant:"default",children:[(0,s.jsx)(ei.Plus,{className:"h-4 w-4 mr-2"}),"New Appointment"]})]}):(0,s.jsx)("div",{className:"space-y-2",children:t.map(e=>(0,s.jsx)(er,{job:e,onClick:()=>r(e),showDate:!1,showTechnician:!0},e.id))})})}),t.length>0&&(0,s.jsx)("div",{className:"border-t bg-muted/30 p-4 safe-bottom",children:(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(v.Button,{className:"flex-1",onClick:()=>{n("create_appointment",e)},size:"default",variant:"outline",children:[(0,s.jsx)(ei.Plus,{className:"h-4 w-4 mr-2"}),"New Appointment"]}),(0,s.jsxs)(v.Button,{className:"flex-1",onClick:()=>{n("view_day",e)},size:"default",variant:"default",children:[(0,s.jsx)(N.Calendar,{className:"h-4 w-4 mr-2"}),"View Day Schedule"]})]})})]})]})}let eG=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],eW=["S","M","T","W","T","F","S"],eX=e=>{switch(e?.toLowerCase()){case"scheduled":return"bg-blue-500";case"dispatched":return"bg-sky-500";case"arrived":return"bg-emerald-400";case"in_progress":return"bg-amber-500";case"closed":case"completed":return"bg-emerald-600";case"cancelled":return"bg-slate-400";default:return"bg-slate-500"}};function eK({date:e,jobs:a,isCurrentMonth:l,onDayTap:r,onJobTap:n}){let i=(0,eN.isToday)(e),o=a.length>0,c=0===e.getDay()||6===e.getDay(),d=(0,t.useMemo)(()=>a.reduce((e,s)=>{let t=s.status?.toLowerCase()||"scheduled";return e[t]=(e[t]||0)+1,e},{}),[a]),u=(0,t.useMemo)(()=>Object.entries(d).sort(([,e],[,s])=>s-e).slice(0,3),[d]);return(0,s.jsxs)("button",{className:(0,k.cn)("flex h-24 sm:h-28 flex-col border-r border-b p-1.5 sm:p-2 text-left transition-all active:scale-95",!l&&"bg-muted/50 opacity-60",i&&"bg-blue-50 ring-2 ring-inset ring-blue-500/50 dark:bg-blue-950/30",c&&!i&&"bg-slate-100/80 dark:bg-slate-800/30"),onClick:()=>r(e,a),type:"button",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between gap-1 mb-1",children:[(0,s.jsx)("span",{className:(0,k.cn)("flex h-6 w-6 sm:h-7 sm:w-7 items-center justify-center rounded-full text-xs sm:text-sm font-bold",i&&"bg-blue-500 text-white shadow-md",!i&&!l&&"text-muted-foreground/60",!i&&l&&"text-foreground"),children:(0,b.format)(e,"d")}),o&&(0,s.jsx)(L.Badge,{className:"h-4 px-1.5 text-[9px] sm:text-[10px] font-semibold",variant:"secondary",children:a.length})]}),o&&(0,s.jsx)("div",{className:"flex flex-wrap gap-0.5",children:u.map(([e,t])=>(0,s.jsxs)("div",{className:"flex items-center gap-0.5",children:[(0,s.jsx)("div",{className:(0,k.cn)("h-1.5 w-1.5 sm:h-2 sm:w-2 rounded-full",eX(e))}),t>1&&(0,s.jsx)("span",{className:"text-[8px] sm:text-[9px] text-muted-foreground font-medium",children:t})]},e))}),o&&(0,s.jsxs)("div",{className:"hidden xs:flex flex-col gap-0.5 mt-1 overflow-hidden",children:[a.slice(0,2).map(e=>(0,s.jsx)("button",{className:(0,k.cn)("flex items-center gap-1 rounded px-1 py-0.5 text-[8px] sm:text-[9px] font-medium transition-colors hover:opacity-80",eX(e.status),"text-white truncate"),onClick:s=>{s.stopPropagation(),n(e)},type:"button",children:(0,s.jsx)("span",{className:"truncate",children:e.customer?.name||e.title})},e.id)),a.length>2&&(0,s.jsxs)("span",{className:"text-[8px] text-muted-foreground ml-1",children:["+",a.length-2," more"]})]})]})}function eY(){let a=(0,o.useScheduleStore)(e=>e.jobs),{currentDate:l,goToToday:r,navigatePrevious:i,navigateNext:c}=(0,n.useScheduleViewStore)(),d=(0,t.useMemo)(()=>Array.from(a.values()),[a]),[u,m]=(0,t.useState)(null),[h,x]=(0,t.useState)(null),[g,N]=(0,t.useState)(!1),w=(0,t.useMemo)(()=>l instanceof Date?l:new Date(l),[l]),y=(0,t.useMemo)(()=>{let e=(0,eO.startOfMonth)(w),s=(0,eP.endOfMonth)(w),t=(0,eH.startOfWeek)(e),a=(0,e$.endOfWeek)(s),l=[],r=t;for(;r<=a;)l.push(r),r=(0,ew.addDays)(r,1);return l},[w]),C=(0,t.useMemo)(()=>{if(!g)return y;let e=(0,eH.startOfWeek)(w),s=[];for(let t=0;t<7;t++)s.push((0,ew.addDays)(e,t));return s},[g,w,y]),S=(0,t.useMemo)(()=>{let e=new Map;return d.forEach(s=>{if(!s.scheduled_start)return;let t=new Date(s.scheduled_start),a=(0,b.format)(t,"yyyy-MM-dd");e.has(a)||e.set(a,[]),e.get(a)?.push(s)}),e.forEach(e=>{e.sort((e,s)=>e.scheduled_start?s.scheduled_start?new Date(e.scheduled_start).getTime()-new Date(s.scheduled_start).getTime():-1:1)}),e},[d]),T=(0,t.useCallback)((e,s)=>{x({date:e,jobs:s})},[]),M=(0,t.useCallback)(e=>{m(e)},[]),_=(0,t.useCallback)(async(s,t,...a)=>{m(null);try{switch(s){case"view_details":window.location.href=`/dashboard/work/jobs/${t.id}`;break;case"dispatch":case"arrive":case"start":case"complete":case"move_to_status":{let{updateJobStatus:l}=await e.A(805737),r="move_to_status"===s?a[0]:s,n=await l(t.id,{dispatch:"dispatched",arrive:"arrived",start:"in_progress",complete:"completed"}[s]||r);n.success?(eg.toast.success(`Job ${"move_to_status"===s?"moved to "+r:s+"ed"}`),window.location.reload()):eg.toast.error(n.error||"Failed to update job status");break}case"reschedule":{let[s,l]=a,{updateJob:r}=await e.A(805737),n=await r({jobId:t.id,scheduled_start:s.toISOString(),scheduled_end:l.toISOString()});n.success?(eg.toast.success("Job rescheduled"),window.location.reload()):eg.toast.error(n.error||"Failed to reschedule job");break}case"reassign":{let s=a[0];if(s){let{assignJobToTechnician:a}=await e.A(646739),l=await a(t.id,s);l.success?(eg.toast.success("Job reassigned"),window.location.reload()):eg.toast.error(l.error||"Failed to reassign job")}else eg.toast.info("Unassigning technician coming soon");break}case"cancel":{let{cancelJobAndAppointment:s}=await e.A(646739),a=await s(t.id);a.success?(eg.toast.success("Job cancelled"),window.location.reload()):eg.toast.error(a.error||"Failed to cancel job");break}default:console.warn("Unknown action:",s)}}catch(e){console.error("Job action error:",e),eg.toast.error("An error occurred")}},[]),D=(0,t.useCallback)((e,s)=>{switch(x(null),e){case"view_day":window.location.href=`/dashboard/schedule?view=day&date=${(0,b.format)(s,"yyyy-MM-dd")}`;break;case"create_appointment":window.location.href=`/dashboard/work/appointments/new?date=${(0,b.format)(s,"yyyy-MM-dd")}`;break;case"create_job":window.location.href=`/dashboard/work/jobs/new?date=${(0,b.format)(s,"yyyy-MM-dd")}`;break;default:console.warn("Unknown day action:",e)}},[]),A=(0,p.isSameDay)(w,new Date);return(0,s.jsxs)("div",{className:"flex h-full flex-col overflow-hidden",children:[(0,s.jsxs)("div",{className:"shrink-0 border-b bg-background",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 sm:p-4",children:[(0,s.jsxs)(v.Button,{className:"h-9 w-9",onClick:i,size:"icon",variant:"ghost",children:[(0,s.jsx)(j.ChevronLeft,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Previous month"})]}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsxs)("h2",{className:"text-base sm:text-lg font-semibold",children:[(0,b.format)(w,g?"MMM d - ":"MMMM yyyy"),g&&(0,b.format)((0,ew.addDays)((0,eH.startOfWeek)(w),6),"MMM d, yyyy")]}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:[S.size," days with jobs"]})]}),(0,s.jsxs)(v.Button,{className:"h-9 w-9",onClick:c,size:"icon",variant:"ghost",children:[(0,s.jsx)(f.ChevronRight,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Next month"})]})]}),(0,s.jsxs)("div",{className:"flex gap-2 px-3 sm:px-4 pb-3",children:[(0,s.jsx)(v.Button,{className:"flex-1 h-8 text-xs",onClick:()=>N(!g),size:"sm",variant:"outline",children:g?"Show Month":"Show Week"}),!A&&(0,s.jsx)(v.Button,{className:"flex-1 h-8 text-xs",onClick:r,size:"sm",variant:"outline",children:"Today"})]})]}),(0,s.jsx)("div",{className:"flex-1 overflow-auto",children:(0,s.jsxs)("div",{className:"grid grid-cols-7 h-full",children:[eG.map((e,t)=>(0,s.jsxs)("div",{className:(0,k.cn)("sticky top-0 z-10 bg-muted/80 backdrop-blur-sm border-r border-b px-1 py-2 text-center text-[10px] sm:text-xs font-bold uppercase",(0===t||6===t)&&"bg-slate-200/80 dark:bg-slate-700/50"),children:[(0,s.jsx)("span",{className:"hidden xs:inline",children:e}),(0,s.jsx)("span",{className:"xs:hidden",children:eW[t]})]},e)),C.map(e=>{let t=(0,b.format)(e,"yyyy-MM-dd"),a=S.get(t)||[],l=(0,eR.isSameMonth)(e,w);return(0,s.jsx)(eK,{date:e,isCurrentMonth:l,jobs:a,onDayTap:T,onJobTap:M},e.toISOString())})]})}),(0,s.jsx)(ea,{isOpen:null!==u,job:u,onAction:_,onClose:()=>m(null)}),(0,s.jsx)(eV,{date:h?.date||null,isOpen:null!==h,jobs:h?.jobs||[],onAction:D,onClose:()=>x(null),onJobTap:M})]})}let eZ=(0,c.default)(()=>e.A(604099).then(e=>({default:e.MonthlyView})),{loadableGenerated:{modules:[5456]},loading:()=>(0,s.jsx)("div",{className:"flex h-full w-full flex-col gap-4 p-4",children:(0,s.jsx)("div",{className:"grid grid-cols-7 gap-2",children:Array.from({length:35}).map((e,t)=>(0,s.jsx)(d.Skeleton,{className:"aspect-square w-full"},t))})}),ssr:!1});function eq(){return(0,s.jsx)(eZ,{})}function eQ({initialData:e,bootstrapError:c}){let d=(0,o.useScheduleStore)(e=>e.hydrateFromServer),{viewMode:u}=(0,n.useScheduleViewStore)(),h=(0,l.useIsMobile)(),b=(0,t.useMemo)(()=>e?(0,i.deserializeScheduleBootstrap)(e):null,[e]);return!function(){let e=(0,r.useRouter)(),{goToToday:s,navigatePrevious:a,navigateNext:l,setViewMode:i}=(0,n.useScheduleViewStore)();(0,t.useEffect)(()=>{let t=t=>{let r=t.target;if("INPUT"!==r.tagName&&"TEXTAREA"!==r.tagName&&!r.isContentEditable&&!t.ctrlKey&&!t.metaKey&&!t.altKey)switch(t.key.toLowerCase()){case"t":t.preventDefault(),s();break;case"n":t.preventDefault(),e.push("/dashboard/work/new");break;case"[":t.preventDefault(),a();break;case"]":t.preventDefault(),l();break;case"1":t.preventDefault(),i("day");break;case"2":t.preventDefault(),i("month");break;case"3":t.preventDefault(),i("week")}};return document.addEventListener("keydown",t),()=>{document.removeEventListener("keydown",t)}},[s,a,l,i,e])}(),(0,t.useEffect)(()=>{b&&d(b)},[d,b]),(0,s.jsxs)("div",{className:"m-0 flex h-full w-full flex-1 flex-col overflow-hidden p-0",children:[c&&(0,s.jsxs)(a.Alert,{className:"mx-3 md:mx-4 mt-2 mb-3 md:mb-4 max-w-2xl self-center",variant:"destructive",children:[(0,s.jsx)(a.AlertTitle,{children:"Live schedule data unavailable"}),(0,s.jsxs)(a.AlertDescription,{children:[c,". Showing the scheduler without preloaded jobsâ€”use the refresh controls after fixing the issue."]})]}),h?(0,s.jsx)(s.Fragment,{children:"list"===u?(0,s.jsx)(eE,{}):"day"===u?(0,s.jsx)(ef,{}):"week"===u?(0,s.jsx)(ev,{}):"month"===u?(0,s.jsx)(eY,{}):(0,s.jsx)(eE,{})}):(0,s.jsx)(s.Fragment,{children:"month"===u?(0,s.jsx)(eq,{}):"week"===u?(0,s.jsx)(x,{}):"list"===u?(0,s.jsx)(eE,{}):(0,s.jsx)(m,{})})]})}e.s(["SchedulePageClient",()=>eQ],484942)}]);