(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,873382,e=>{"use strict";let t=(0,e.i(383206).default)("smile",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]);e.s(["default",()=>t])},524672,e=>{"use strict";var t=e.i(873382);e.s(["Smile",()=>t.default])},231476,e=>{"use strict";var t=e.i(819260);e.s(["PanelLeft",()=>t.default])},665123,e=>{"use strict";var t=e.i(905501);e.s(["ImageIcon",()=>t.default])},666108,e=>{"use strict";let t=(0,e.i(383206).default)("message-square-text",[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}],["path",{d:"M7 11h10",key:"1twpyw"}],["path",{d:"M7 15h6",key:"d9of3u"}],["path",{d:"M7 7h8",key:"af5zfr"}]]);e.s(["default",()=>t])},608423,e=>{"use strict";var t=e.i(111043);e.i(889265);var s=e.i(677607);e.i(244242);var a=e.i(563078);e.i(220474);var r=e.i(171056);e.i(254978);var n=e.i(375308),i=e.i(152088),l=e.i(407205),o=e.i(133279),c=e.i(606661),d=e.i(665123),m=e.i(641304),u=e.i(666108),u=u,h=e.i(371526),p=e.i(524672),x=e.i(212409),f=e.i(970799);let g=[{id:"appointment-reminder",label:"Appointment Reminder",preview:"Reminder about upcoming appointment",build:e=>{let t=e.customerFirstName||"there",s=e.appointmentDate&&e.appointmentTime?`on ${e.appointmentDate} at ${e.appointmentTime}`:e.appointmentDate?`on ${e.appointmentDate}`:"for your upcoming appointment";return`Hi ${t}, this is a reminder about your appointment ${s}. Reply CONFIRM to confirm or call us to reschedule.`}},{id:"on-the-way",label:"On The Way",preview:"Technician en route notification",build:e=>{let t=e.customerFirstName||"there",s=e.technicianName||"Our technician";return`Hi ${t}, ${s} is on the way and should arrive shortly.`}},{id:"running-late",label:"Running Late",preview:"Apology for delay",build:e=>{let t=e.customerFirstName||"there";return`Hi ${t}, we apologize but our technician is running a bit behind schedule. We'll update you when they're on the way.`}},{id:"job-complete",label:"Job Complete",preview:"Work completed notification",build:e=>{let t=e.customerFirstName||"there",s=e.companyName?`choosing ${e.companyName}`:"your business";return`Hi ${t}, the work has been completed. If you have any questions, please don't hesitate to reach out. Thank you for ${s}!`}},{id:"payment-reminder",label:"Payment Reminder",preview:"Friendly payment reminder",build:e=>{let t=e.customerFirstName||"there",s=e.invoiceNumber&&e.amount?`invoice #${e.invoiceNumber} for $${e.amount}`:e.invoiceNumber?`invoice #${e.invoiceNumber}`:"your outstanding invoice";return`Hi ${t}, this is a friendly reminder that ${s} is due. Please let us know if you have any questions.`}},{id:"follow-up",label:"Follow Up",preview:"Service follow-up request",build:e=>{let t=e.customerFirstName||"there";return`Hi ${t}, just following up on our recent service. Is everything working well? We'd love to hear your feedback!`}},{id:"thank-you",label:"Thank You",preview:"Thank you message",build:e=>{let t=e.companyName?`choosing ${e.companyName}`:"your business";return`Thank you for ${t}! We appreciate your trust in us. If you have a moment, we'd love a review!`}},{id:"reschedule",label:"Reschedule Request",preview:"Reschedule appointment request",build:e=>{let t=e.customerFirstName||"there",s=e.companyPhone?`, or call us at ${e.companyPhone}`:"";return`Hi ${t}, we need to reschedule your appointment. Please reply with a date and time that works for you${s}.`}}],v=[{name:"Frequently Used",emojis:["ğŸ˜€","ğŸ˜‚","ğŸ˜","ğŸ¥°","ğŸ˜˜","ğŸ˜Š","ğŸ˜‰","ğŸ˜","ğŸ¤”","ğŸ˜","ğŸ˜’","ğŸ™„","ğŸ˜®","ğŸ¤—","ğŸ˜´","ğŸ˜‹","ğŸ˜","ğŸ¤¤","ğŸ˜ª","ğŸ˜µ"]},{name:"Smileys & People",emojis:["ğŸ˜€","ğŸ˜ƒ","ğŸ˜„","ğŸ˜","ğŸ˜†","ğŸ˜…","ğŸ¤£","ğŸ˜‚","ğŸ™‚","ğŸ™ƒ","ğŸ˜‰","ğŸ˜Š","ğŸ˜‡","ğŸ¥°","ğŸ˜","ğŸ¤©","ğŸ˜˜","ğŸ˜—","ğŸ˜š","ğŸ˜™","ğŸ˜‹","ğŸ˜›","ğŸ˜œ","ğŸ¤ª","ğŸ˜","ğŸ¤‘","ğŸ¤—","ğŸ¤­","ğŸ¤«","ğŸ¤”"]},{name:"Gestures",emojis:["ğŸ‘‹","ğŸ¤š","ğŸ–","âœ‹","ğŸ––","ğŸ‘Œ","ğŸ¤Œ","ğŸ¤","âœŒï¸","ğŸ¤","ğŸ¤Ÿ","ğŸ¤˜","ğŸ¤™","ğŸ‘ˆ","ğŸ‘‰","ğŸ‘†","ğŸ–•","ğŸ‘‡","â˜ï¸","ğŸ‘"]},{name:"Objects",emojis:["ğŸ“±","ğŸ’»","âŒš","ğŸ–¥","âŒ¨ï¸","ğŸ–±","ğŸ–²","ğŸ•¹","ğŸ—œ","ğŸ’¾","ğŸ’¿","ğŸ“€","ğŸ“·","ğŸ“¸","ğŸ“¹","ğŸ¥","ğŸ“½","ğŸ","ğŸ“","â˜ï¸"]},{name:"Symbols",emojis:["â¤ï¸","ğŸ§¡","ğŸ’›","ğŸ’š","ğŸ’™","ğŸ’œ","ğŸ–¤","ğŸ¤","ğŸ¤","ğŸ’”","â£ï¸","ğŸ’•","ğŸ’","ğŸ’“","ğŸ’—","ğŸ’–","ğŸ’˜","ğŸ’","ğŸ’Ÿ","â˜®ï¸"]}];function b({value:e,onChange:b,onSend:w,onAttach:y,sending:j=!1,disabled:N=!1,placeholder:S="Text Message",showSegmentCounter:k=!0,customerName:C,customerFirstName:A,customerId:R,jobType:_,companyName:M,companyPhone:D,technicianName:z,appointmentDate:T,appointmentTime:$,invoiceNumber:F,amount:I,enableAiSuggestions:P=!1}){let[U,E]=(0,f.useState)([]),[L,B]=(0,f.useState)(!1),[O,q]=(0,f.useState)(!1),[H,K]=(0,f.useState)(""),[W,X]=(0,f.useState)(!1),J=(0,f.useRef)(null),V=(0,f.useRef)(null),Z=(0,f.useRef)(null),Q=(0,f.useRef)(null),Y=function(e){if(!e)return{segments:0,charsPerSegment:160,isUnicode:!1};let t=!/^[@Â£$Â¥Ã¨Ã©Ã¹Ã¬Ã²Ã‡\nÃ˜Ã¸\rÃ…Ã¥Î”_Î¦Î“Î›Î©Î Î¨Î£Î˜Î\x1B !"#Â¤%&'()*+,\-./0-9:;<=>?Â¡A-ZÃ„Ã–Ã‘Ü§Â¿a-zÃ¤Ã¶Ã±Ã¼Ã ]*$/.test(e),s=t?70:160,a=t?67:153;return e.length<=s?{segments:1,charsPerSegment:s,isUnicode:t}:{segments:Math.ceil(e.length/a),charsPerSegment:a,isUnicode:t}}(e),G=k&&e.length>0&&(O||e.length>100),ee=(0,f.useCallback)(async e=>{if(!P||e.length<3)return void K("");X(!0);try{let t=await fetch("/api/ai/chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:`You are an SMS autocomplete assistant for a field service company. Complete the user's SMS message naturally and professionally.
Context: ${C?`Customer: ${C}`:""} ${_?`Job type: ${_}`:""} ${M?`Company: ${M}`:""}
IMPORTANT: Only return the completion text (what comes AFTER what the user typed). Keep it short (under 100 chars). No quotes or explanations.`},{role:"user",content:`Complete this SMS message: "${e}"`}],model:"claude-3-5-haiku-20241022",maxTokens:100})});if(t.ok){let e=await t.json(),s=e.content||e.message||"";s&&s.length>0&&s.length<150?K(s.trim()):K("")}}catch(e){console.error("AI suggestion error:",e),K("")}finally{X(!1)}},[P,C,_,M]);(0,f.useEffect)(()=>{if(Q.current&&clearTimeout(Q.current),K(""),P&&!(e.length<5)&&O)return Q.current=setTimeout(()=>{ee(e)},500),()=>{Q.current&&clearTimeout(Q.current)}},[e,P,O,ee]),(0,f.useEffect)(()=>{J.current&&J.current.textContent!==e&&(J.current.textContent=e)},[e]);let et=(0,f.useCallback)(t=>{let s=t+" ",a=J.current;if(a){let t=window.getSelection();if(t&&t.rangeCount>0){let r=t.getRangeAt(0);if(a.contains(r.commonAncestorContainer)){r.deleteContents();let e=document.createTextNode(s);r.insertNode(e);let n=document.createRange();n.setStartAfter(e),n.setEndAfter(e),t.removeAllRanges(),t.addRange(n),b(a.textContent||"")}else b(e+s),requestAnimationFrame(()=>{if(a){a.focus();let e=document.createRange();e.selectNodeContents(a),e.collapse(!1);let t=window.getSelection();t?.removeAllRanges(),t?.addRange(e)}})}else b(e+s),requestAnimationFrame(()=>{if(a){a.focus();let e=document.createRange();e.selectNodeContents(a),e.collapse(!1);let t=window.getSelection();t?.removeAllRanges(),t?.addRange(e)}});a.focus()}else b(e+s);B(!1)},[e,b]),es=(0,f.useCallback)(e=>{if(!e||0===e.length)return;let t=Array.from(e).map(e=>{let t={id:`${Date.now()}-${Math.random()}`,file:e,type:e.type.startsWith("image/")?"image":"file"};return"image"===t.type&&(t.preview=URL.createObjectURL(e)),t});E(e=>[...e,...t]),y&&y(Array.from(e))},[y]),ea=(0,f.useCallback)(e=>{E(t=>{let s=t.find(t=>t.id===e);return s?.preview&&URL.revokeObjectURL(s.preview),t.filter(t=>t.id!==e)})},[]),er=(0,f.useCallback)(()=>{!e.trim()&&0===U.length||j||N||(w(),U.forEach(e=>{e.preview&&URL.revokeObjectURL(e.preview)}),E([]))},[e,U,j,N,w]),en=(0,f.useCallback)(t=>{if("Tab"===t.key&&H){t.preventDefault(),b(e+H),K(""),J.current&&(J.current.textContent=e+H,requestAnimationFrame(()=>{if(J.current){J.current.focus();let e=document.createRange();e.selectNodeContents(J.current),e.collapse(!1);let t=window.getSelection();t?.removeAllRanges(),t?.addRange(e)}}));return}if("Escape"===t.key&&H){t.preventDefault(),K("");return}"Enter"!==t.key||t.shiftKey||(t.preventDefault(),er()),"Enter"===t.key&&(t.metaKey||t.ctrlKey)&&(t.preventDefault(),er())},[er,H,e,b]),ei=(0,f.useCallback)(e=>{e.preventDefault();let t=e.clipboardData.getData("text/plain"),s=window.getSelection();if(s&&s.rangeCount>0){let e=s.getRangeAt(0);e.deleteContents();let a=document.createTextNode(t);e.insertNode(a);let r=document.createRange();r.setStartAfter(a),r.setEndAfter(a),s.removeAllRanges(),s.addRange(r),b(J.current?.textContent||"")}},[b]),el=(0,f.useCallback)((t,s=!1)=>{let a=J.current;if(!a)return void b(s?t:e+t);if(s)b(t),a.textContent=t,requestAnimationFrame(()=>{a.focus();let e=document.createRange();e.selectNodeContents(a),e.collapse(!1);let t=window.getSelection();t?.removeAllRanges(),t?.addRange(e)});else{let s=window.getSelection();if(s&&s.rangeCount>0){let r=s.getRangeAt(0);if(a.contains(r.commonAncestorContainer)){r.deleteContents();let e=document.createTextNode(t);r.insertNode(e);let n=document.createRange();n.setStartAfter(e),n.setEndAfter(e),s.removeAllRanges(),s.addRange(n),b(a.textContent||"")}else b(e+t)}else b(e+t);a.focus()}},[e,b]),eo=(0,f.useCallback)(e=>{let t={customerFirstName:A||C?.split(" ")[0],customerName:C,companyName:M,companyPhone:D,technicianName:z,appointmentDate:T,appointmentTime:$,invoiceNumber:F,amount:I};el(e.build(t),!0)},[el,A,C,M,D,z,T,$,F,I]);return(0,t.jsxs)("div",{className:"bg-card border-t border-border/50",children:[G&&(0,t.jsxs)("div",{className:"flex items-center justify-end gap-2 px-3 pt-2 pb-1",children:[(0,t.jsxs)("span",{className:"text-[10px] text-muted-foreground",children:[e.length," chars"]}),(0,t.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Â·"}),(0,t.jsxs)("span",{className:(0,i.cn)("text-[10px] font-medium",Y.segments>1?"text-amber-500":"text-muted-foreground"),children:[Y.segments," segment",1!==Y.segments?"s":""]}),Y.isUnicode&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("span",{className:"text-[10px] text-muted-foreground",children:"Â·"}),(0,t.jsx)("span",{className:"text-[10px] text-amber-500",children:"Unicode"})]})]}),U.length>0&&(0,t.jsx)("div",{className:"px-3 pt-2",children:(0,t.jsx)(n.ScrollArea,{className:"w-full",children:(0,t.jsx)("div",{className:"flex gap-2",children:U.map(e=>(0,t.jsx)("div",{className:"group relative shrink-0",children:"image"===e.type&&e.preview?(0,t.jsxs)("div",{className:"relative size-16 overflow-hidden rounded-xl border border-border",children:[(0,t.jsx)("img",{src:e.preview,alt:e.file.name,className:"size-full object-cover"}),(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",className:"absolute right-0.5 top-0.5 size-5 rounded-full bg-black/60 p-0 opacity-0 transition-opacity hover:bg-black/80 group-hover:opacity-100",onClick:()=>ea(e.id),children:(0,t.jsx)(x.X,{className:"size-3 text-white"})})]}):(0,t.jsxs)("div",{className:"relative flex size-16 items-center justify-center rounded-xl border border-border bg-muted",children:[(0,t.jsx)(c.FileText,{className:"size-5 text-muted-foreground"}),(0,t.jsx)(s.Button,{variant:"ghost",size:"sm",className:"absolute right-0.5 top-0.5 size-5 rounded-full bg-black/60 p-0 opacity-0 transition-opacity hover:bg-black/80 group-hover:opacity-100",onClick:()=>ea(e.id),children:(0,t.jsx)(x.X,{className:"size-3 text-white"})}),(0,t.jsx)("span",{className:"absolute bottom-1 left-1 right-1 truncate text-[8px] text-muted-foreground",children:e.file.name})]})},e.id))})})}),(0,t.jsxs)("div",{className:"flex items-end gap-1.5 p-2 pb-safe",children:[(0,t.jsxs)(a.DropdownMenu,{children:[(0,t.jsx)(a.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(s.Button,{type:"button",variant:"ghost",size:"icon",className:"mb-0.5 size-10 md:size-8 shrink-0 rounded-full hover:bg-muted",disabled:N,title:"Add attachment",children:(0,t.jsx)(h.Plus,{className:"size-6 md:size-5 text-muted-foreground"})})}),(0,t.jsxs)(a.DropdownMenuContent,{align:"start",side:"top",className:"w-48",children:[(0,t.jsxs)(a.DropdownMenuItem,{onClick:()=>Z.current?.click(),className:"gap-2",children:[(0,t.jsx)(o.Camera,{className:"size-4"}),(0,t.jsx)("span",{children:"Camera"})]}),(0,t.jsxs)(a.DropdownMenuItem,{onClick:()=>{let e=document.createElement("input");e.type="file",e.accept="image/*",e.multiple=!0,e.onchange=e=>es(e.target.files),e.click()},className:"gap-2",children:[(0,t.jsx)(d.ImageIcon,{className:"size-4"}),(0,t.jsx)("span",{children:"Photo Library"})]}),(0,t.jsxs)(a.DropdownMenuItem,{onClick:()=>V.current?.click(),className:"gap-2",children:[(0,t.jsx)(c.FileText,{className:"size-4"}),(0,t.jsx)("span",{children:"Document"})]})]})]}),(0,t.jsxs)(a.DropdownMenu,{children:[(0,t.jsx)(a.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(s.Button,{type:"button",variant:"ghost",size:"icon",className:"mb-0.5 size-10 md:size-8 shrink-0 rounded-full hover:bg-muted",disabled:N,title:"Quick replies",children:(0,t.jsx)(u.default,{className:"size-5 md:size-4 text-muted-foreground"})})}),(0,t.jsxs)(a.DropdownMenuContent,{align:"start",side:"top",className:"w-56",children:[(0,t.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Quick Replies"}),g.map(e=>(0,t.jsxs)(a.DropdownMenuItem,{onClick:()=>eo(e),className:"flex-col items-start gap-0.5",children:[(0,t.jsx)("span",{className:"font-medium",children:e.label}),(0,t.jsx)("span",{className:"line-clamp-1 text-xs text-muted-foreground",children:e.preview})]},e.id))]})]}),(0,t.jsx)("input",{ref:V,type:"file",multiple:!0,accept:"*/*",className:"hidden",onChange:e=>es(e.target.files)}),(0,t.jsx)("input",{ref:Z,type:"file",accept:"image/*",capture:"environment",className:"hidden",onChange:e=>es(e.target.files)}),(0,t.jsx)("div",{className:"relative min-w-0 flex-1",children:(0,t.jsxs)("div",{className:(0,i.cn)("flex w-full items-center overflow-y-auto rounded-[18px] border border-border bg-muted/50 pl-3 pr-1 py-1 transition-colors","min-h-[44px] md:min-h-[36px] max-h-[120px]","focus-within:border-primary/30 focus-within:bg-background focus-within:ring-1 focus-within:ring-primary/20",(N||j)&&"cursor-not-allowed opacity-50"),onClick:()=>J.current?.focus(),children:[(0,t.jsxs)("div",{className:"relative min-w-0 flex-1",children:[(0,t.jsx)("div",{ref:J,contentEditable:!N&&!j,suppressContentEditableWarning:!0,spellCheck:!0,onInput:e=>{b(e.currentTarget.textContent||"")},onKeyDown:en,onPaste:ei,onFocus:()=>q(!0),onBlur:()=>q(!1),"data-placeholder":S,className:(0,i.cn)("w-full min-w-0 whitespace-pre-wrap break-words py-1 leading-5 outline-none","text-base md:text-sm","empty:before:pointer-events-none empty:before:text-muted-foreground/60 empty:before:content-[attr(data-placeholder)]",(N||j)&&"pointer-events-none")}),H&&e&&(0,t.jsxs)("div",{className:"pointer-events-none absolute inset-0 flex items-center overflow-hidden py-1 text-sm leading-5","aria-hidden":"true",children:[(0,t.jsx)("span",{className:"invisible whitespace-pre-wrap",children:e}),(0,t.jsx)("span",{className:"text-muted-foreground/40",children:H})]}),H&&(0,t.jsxs)("div",{className:"absolute -top-5 right-0 flex items-center gap-1 text-[10px] text-muted-foreground",children:[(0,t.jsx)("kbd",{className:"rounded border border-border bg-muted px-1 py-0.5 font-mono text-[9px]",children:"Tab"}),(0,t.jsx)("span",{children:"to accept"})]})]}),(0,t.jsxs)("div",{className:"flex shrink-0 items-center gap-0.5 pl-1",children:[(0,t.jsxs)(r.Popover,{open:L,onOpenChange:B,children:[(0,t.jsx)(r.PopoverTrigger,{asChild:!0,children:(0,t.jsx)("button",{type:"button",className:(0,i.cn)("flex size-9 md:size-7 items-center justify-center rounded-full transition-colors","hover:bg-muted/80",L&&"bg-muted"),disabled:N,title:"Add emoji",children:(0,t.jsx)(p.Smile,{className:"size-5 md:size-4 text-muted-foreground"})})}),(0,t.jsx)(r.PopoverContent,{side:"top",align:"end",className:"w-[300px] p-0",children:(0,t.jsx)(n.ScrollArea,{className:"h-[280px]",children:(0,t.jsx)("div",{className:"p-2",children:v.map((e,s)=>(0,t.jsxs)("div",{className:s>0?"mt-3":"",children:[(0,t.jsx)("h4",{className:"mb-1.5 px-1 text-[10px] font-semibold uppercase tracking-wider text-muted-foreground",children:e.name}),(0,t.jsx)("div",{className:"grid grid-cols-8 gap-0.5",children:e.emojis.map((e,s)=>(0,t.jsx)("button",{type:"button",className:"flex size-8 items-center justify-center rounded-lg text-lg transition-colors hover:bg-muted",onClick:()=>et(e),children:e},`${e}-${s}`))})]},e.name))})})})]}),(0,t.jsx)("button",{type:"button",onClick:er,disabled:!e.trim()&&0===U.length||j||N,className:(0,i.cn)("flex size-9 md:size-7 items-center justify-center rounded-full transition-all duration-200",e.trim()||U.length>0?"bg-primary hover:bg-primary/90 scale-100 active:scale-95":"bg-muted/50 scale-90"),children:j?(0,t.jsx)(m.Loader2,{className:(0,i.cn)("size-5 md:size-4 animate-spin",e.trim()||U.length>0?"text-primary-foreground":"text-muted-foreground")}):(0,t.jsx)(l.ArrowUp,{className:(0,i.cn)("size-5 md:size-4",e.trim()||U.length>0?"text-primary-foreground":"text-muted-foreground")})})]})]})})]})]})}e.s(["SmsMessageInput",()=>b],608423)},482295,365885,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("401da60f1a9391a303a1b16907796e4c0f50d69f2e",t.callServer,void 0,t.findSourceMapURL,"getSmsAction");e.s(["getSmsAction",()=>s],482295);var a=(0,t.createServerReference)("4044b52e9024b2d9706a0fecdc03f2b79b2581d95f",t.callServer,void 0,t.findSourceMapURL,"getSmsByIdAction");e.s(["getSmsByIdAction",()=>a],365885)},66901,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("40641943d0d58e4efdbd5a78b4dee1f49227c7ed47",t.callServer,void 0,t.findSourceMapURL,"getSmsConversationAction");e.s(["getSmsConversationAction",()=>s])},825014,103732,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("40b400ebd66fa044553037f011b7b9f79ac7991a54",t.callServer,void 0,t.findSourceMapURL,"markSmsAsReadAction");e.s(["markSmsAsReadAction",()=>s],825014);var a=(0,t.createServerReference)("40955555a6fefc5cd6fcbb13dbbda08c03e7c12997",t.callServer,void 0,t.findSourceMapURL,"markSmsConversationAsReadAction");e.s(["markSmsConversationAsReadAction",()=>a],103732)},172403,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("00ac96dc81c57c5c0b6ef948993077a34552967467",t.callServer,void 0,t.findSourceMapURL,"getCompanyContextAction");e.s(["getCompanyContextAction",()=>s])},201796,e=>{"use strict";let t=(0,e.i(383206).default)("trash",[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);e.s(["default",()=>t])},316387,e=>{"use strict";var t=e.i(201796);e.s(["Trash",()=>t.default])},863457,e=>{"use strict";var t=e.i(111043),s=e.i(482295),a=e.i(365885),r=e.i(66901),n=e.i(825014),i=e.i(103732),l=e.i(172403),o=e.i(40616);e.i(670258);var c=e.i(921251);e.i(889265);var d=e.i(677607);e.i(51478);var m=e.i(635613);e.i(254978);var u=e.i(375308),h=e.i(608423),p=e.i(152088),x=e.i(24079),f=e.i(231476),g=e.i(751139),v=e.i(946672),b=e.i(910685),w=e.i(641304),y=e.i(747146),j=e.i(38614),N=e.i(233654),S=e.i(371526),k=e.i(160424),C=e.i(175913),A=e.i(316387),R=e.i(212409),_=e.i(970799),M=e.i(995403),D=e.i(904653);function z({initialSms:z,initialFolder:T,initialSmsId:$}){let F=(0,D.useRouter)(),{toggleSidebar:I}=(0,x.useSidebar)(),P=(0,D.useSearchParams)(),U=P.get("folder")||T,E=P.get("id")||$,[L,B]=(0,_.useTransition)(),[O,q]=(0,_.useState)(z),[H,K]=(0,_.useState)(!1),[W,X]=(0,_.useState)(!1),[J,V]=(0,_.useState)(null),[Z,Q]=(0,_.useState)(null),[Y,G]=(0,_.useState)([]),[ee,et]=(0,_.useState)(!1),[es,ea]=(0,_.useState)(""),[er,en]=(0,_.useState)(""),[ei,el]=(0,_.useState)(""),[eo,ec]=(0,_.useState)(!1),[ed,em]=(0,_.useState)([]),[eu,eh]=(0,_.useState)(null),ep=(0,_.useRef)(null),ex=(0,_.useRef)(null),ef=(0,_.useRef)(null),eg=(0,_.useCallback)(async(e=!1)=>{e?X(!0):K(!0),V(null),B(async()=>{try{let e=await (0,s.getSmsAction)({limit:50,offset:0,type:"all",folder:"inbox"===U?void 0:U,search:es||void 0,sortBy:"created_at",sortOrder:"desc"});q(e);let t=ex.current;if(t){let s=e.sms.find(e=>e.id===t.id);s?(Q(s),ex.current=s):(Q(null),ex.current=null,G([]))}}catch(t){let e=t instanceof Error?t.message:"Failed to load SMS";V(e),M.toast.error("Failed to load SMS",{description:e})}finally{K(!1),X(!1)}})},[es,U]),ev=(0,_.useRef)(!0);(0,_.useEffect)(()=>{if(ev.current){ev.current=!1;return}eg()},[U,es]),(0,_.useEffect)(()=>{(0,l.getCompanyContextAction)().then(e=>{e.success&&e.context&&eh(e.context)})},[]),(0,_.useEffect)(()=>(ep.current&&clearTimeout(ep.current),ep.current=setTimeout(()=>{ea(er)},300),()=>{ep.current&&clearTimeout(ep.current)}),[er]);let eb=(0,_.useCallback)(async e=>{if(e){et(!0);try{let t=await (0,r.getSmsConversationAction)(e);t.success&&t.messages&&(G(t.messages),t.messages.filter(e=>!e.read_at&&"inbound"===e.direction).length>0&&(G(e=>e.map(e=>e.read_at||"inbound"!==e.direction?e:{...e,read_at:new Date().toISOString()})),(0,i.markSmsConversationAsReadAction)(e).then(t=>{t.success&&(G(e=>e.map(e=>e.read_at||"inbound"!==e.direction?e:{...e,read_at:new Date().toISOString()})),q(t=>t?{...t,sms:t.sms.map(t=>t.read_at||"inbound"!==t.direction||t.from_address!==e&&t.to_address!==e?t:{...t,read_at:new Date().toISOString()})}:t),window.dispatchEvent(new CustomEvent("sms-read")))}).catch(()=>{})),setTimeout(()=>{ef.current&&(ef.current.scrollTop=ef.current.scrollHeight)},100))}catch(e){M.toast.error("Failed to load conversation")}finally{et(!1)}}},[]),ew=(0,_.useCallback)(e=>{Q(e),ex.current=e;let t=new URLSearchParams;U&&"inbox"!==U&&t.set("folder",U),t.set("id",e.id),F.replace(`/dashboard/communication/sms?${t.toString()}`,{scroll:!1});let s="inbound"===e.direction?e.from_address:e.to_address;s&&eb(s),e.read_at||(q(t=>t?{...t,sms:t.sms.map(t=>t.id===e.id?{...t,read_at:new Date().toISOString()}:t)}:t),(0,n.markSmsAsReadAction)({smsId:e.id}).then(t=>{t&&(q(t=>t?{...t,sms:t.sms.map(t=>t.id===e.id?{...t,read_at:new Date().toISOString()}:t)}:t),window.dispatchEvent(new CustomEvent("sms-read")))}).catch(()=>{}))},[F,U,eb]);(0,_.useEffect)(()=>{if(!E||E!==ex.current?.id)if(E&&O?.sms){let e=O.sms.find(e=>e.id===E);if(e){Q(e),ex.current=e;let t="inbound"===e.direction?e.from_address:e.to_address;t&&eb(t),e.read_at||(q(t=>t?{...t,sms:t.sms.map(t=>t.id===e.id?{...t,read_at:new Date().toISOString()}:t)}:t),(0,n.markSmsAsReadAction)({smsId:e.id}).then(t=>{t&&(q(t=>t?{...t,sms:t.sms.map(t=>t.id===e.id?{...t,read_at:new Date().toISOString()}:t)}:t),window.dispatchEvent(new CustomEvent("sms-read")))}).catch(()=>{}))}else e||B(async()=>{try{let e=await (0,a.getSmsByIdAction)(E);if(e.success&&e.sms){Q(e.sms),ex.current=e.sms;let t="inbound"===e.sms.direction?e.sms.from_address:e.sms.to_address;t&&eb(t)}}catch(e){}})}else!E&&Z&&(Q(null),ex.current=null,G([]))},[E,O?.sms,eb]);let ey=(0,_.useCallback)(()=>{eg(!0),M.toast.success("Refreshing SMS...")},[eg]),ej=(0,_.useCallback)(async e=>{if(confirm("Are you sure you want to delete this SMS?"))try{if(M.toast.success("SMS deleted"),O&&q({...O,sms:O.sms.filter(t=>t.id!==e),total:O.total-1}),Z?.id===e){Q(null),G([]);let e=new URLSearchParams;U&&"inbox"!==U&&e.set("folder",U),F.push(`/dashboard/communication/sms${e.toString()?`?${e.toString()}`:""}`,{scroll:!1})}}catch(e){M.toast.error("Failed to delete SMS",{description:e instanceof Error?e.message:"Unknown error"})}},[O,Z,U,F]),eN=e=>e.customer?.first_name||e.customer?.last_name?`${e.customer.first_name||""} ${e.customer.last_name||""}`.trim():e.from_name||e.from_address||"Unknown",eS=e=>{let t=eN(e);return t[0]?.toUpperCase()||"U"},ek=(0,_.useCallback)(e=>{em(t=>[...t,...e])},[]),eC=(0,_.useCallback)(async()=>{if(!ei.trim()&&0===ed.length||!Z||eo)return;let t="inbound"===Z.direction?Z.from_address:Z.to_address;if(!t)return void M.toast.error("Cannot determine recipient phone number");ec(!0);try{if(ed.length>0){let{uploadSmsAttachments:s}=await e.A(413320),a=await s(ed);if(!a.success||!a.urls){M.toast.error(a.error||"Failed to upload attachments"),ec(!1);return}let{sendMMSMessage:r}=await e.A(852098),n=await r({to:t,from:"",text:ei.trim()||void 0,mediaUrls:a.urls,customerId:Z.customer_id||void 0});n.success?(el(""),em([]),M.toast.success("Message with attachments sent"),eb(t),eg(!0)):M.toast.error(n.error||"Failed to send message")}else{let e=await (0,o.sendTextMessage)({to:t,from:"",text:ei.trim(),customerId:Z.customer_id||void 0});e.success?(el(""),M.toast.success("Message sent"),eb(t),eg(!0)):M.toast.error(e.error||"Failed to send message")}}catch(e){M.toast.error("Failed to send message",{description:e instanceof Error?e.message:"Unknown error"})}finally{ec(!1)}},[ei,ed,Z,eo,eb,eg]),eA=!Z,eR=!!Z;return(0,t.jsx)("div",{className:"flex h-full w-full flex-col overflow-hidden bg-sidebar",children:(0,t.jsxs)("div",{className:"flex flex-1 overflow-hidden min-h-0 md:gap-2",children:[(0,t.jsx)("div",{className:(0,p.cn)("bg-card mb-1 shadow-sm flex flex-col overflow-hidden","w-full h-full","md:w-[400px] lg:w-[480px] md:rounded-tr-2xl",eA?"flex":"hidden md:flex"),children:(0,t.jsxs)("div",{className:"w-full h-full flex flex-col",children:[(0,t.jsx)("div",{className:"sticky top-0 z-15 flex items-center justify-between gap-1.5 p-2 pb-0 transition-colors bg-card",children:(0,t.jsx)("div",{className:"w-full",children:(0,t.jsx)("div",{className:"grid grid-cols-12 gap-2 mt-1",children:(0,t.jsxs)("div",{className:"col-span-12 flex gap-2",children:[(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-8 shrink-0",onClick:I,title:"Toggle sidebar",children:(0,t.jsx)(f.PanelLeft,{className:"h-5 w-5 md:h-4 md:w-4"})}),(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(m.Input,{type:"search",placeholder:"Search SMS...",value:er,onChange:e=>en(e.target.value),className:"h-10 md:h-8 pl-9 pr-20 text-base md:text-sm border-input bg-white dark:bg-[#141414] dark:border-none"}),(0,t.jsx)("svg",{width:"10",height:"10",viewBox:"0 0 10 10",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"absolute left-3 top-1/2 -translate-y-1/2 fill-[#71717A] dark:fill-[#6F6F6F]",children:(0,t.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M6.81038 7.0756C6.18079 7.54011 5.40248 7.81466 4.56004 7.81466C2.46451 7.81466 0.765747 6.11589 0.765747 4.02037C0.765747 1.92484 2.46451 0.226074 4.56004 0.226074C6.65557 0.226074 8.35433 1.92484 8.35433 4.02037C8.35433 4.8628 8.07978 5.64112 7.61527 6.27071L9.70535 8.36078C9.92761 8.58305 9.92761 8.94341 9.70535 9.16568C9.48308 9.38794 9.12272 9.38794 8.90046 9.16568L6.81038 7.0756ZM7.21604 4.02037C7.21604 5.48724 6.02691 6.67637 4.56004 6.67637C3.09317 6.67637 1.90403 5.48724 1.90403 4.02037C1.90403 2.5535 3.09317 1.36436 4.56004 1.36436C6.02691 1.36436 7.21604 2.5535 7.21604 4.02037Z"})}),er&&(0,t.jsx)("button",{onClick:()=>en(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground",children:(0,t.jsx)(R.X,{className:"h-3 w-3"})})]}),(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",onClick:ey,disabled:W,className:"h-10 w-10 p-0 md:h-8 md:w-8",title:"Refresh",children:(0,t.jsx)(k.RefreshCw,{className:`h-5 w-5 md:h-4 md:w-4 text-muted-foreground ${W?"animate-spin":""}`})})]})})})}),(0,t.jsx)("div",{className:"relative z-1 flex-1 overflow-hidden pt-0 min-h-0",children:(0,t.jsx)("div",{className:"hide-link-indicator flex h-full w-full",children:(0,t.jsx)("div",{className:"flex flex-1 flex-col",id:"sms-list-scroll",children:(0,t.jsx)(u.ScrollArea,{className:"scrollbar-none flex-1 overflow-x-hidden h-full",children:H?(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(w.Loader2,{className:"h-8 w-8 animate-spin text-primary mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Loading SMS..."})]})}):J?(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(g.AlertTriangle,{className:"h-8 w-8 text-destructive mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-sm text-destructive mb-2 font-medium",children:"Failed to load SMS"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mb-4",children:J}),(0,t.jsx)(d.Button,{variant:"outline",size:"sm",onClick:()=>eg(),children:"Try Again"})]})}):O?.sms?.length?(0,t.jsx)("div",{className:"min-h-[200px] px-2",children:O.sms.map(e=>{let s=Z?.id===e.id;return(0,t.jsx)("div",{className:"select-none md:my-1",children:(0,t.jsxs)("div",{className:`hover:bg-accent group flex cursor-pointer flex-col items-start rounded-lg py-2 text-left text-sm transition-all hover:opacity-100 relative ${s?"bg-accent opacity-100":""} ${!e.read_at?"opacity-100":"opacity-60"}`,onClick:()=>ew(e),children:[(0,t.jsxs)("div",{className:"dark:bg-panelDark pointer-events-none absolute right-2 z-25 flex -translate-y-1/2 items-center gap-1 rounded-xl border bg-white p-1 opacity-0 shadow-sm group-hover:opacity-100 top-[-1] transition-opacity duration-200",children:[(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",className:"pointer-events-auto h-6 w-6 overflow-visible p-0 hover:bg-accent",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(C.Star,{className:"h-4 w-4 fill-transparent stroke-[#9D9D9D] dark:stroke-[#9D9D9D]"})}),(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",className:"pointer-events-auto h-6 w-6 p-0 hover:bg-accent",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(g.AlertTriangle,{className:"fill-[#9D9D9D] h-3.5 w-3.5"})}),(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",className:"pointer-events-auto h-6 w-6 p-0 hover:bg-accent",onClick:e=>e.stopPropagation(),children:(0,t.jsx)(v.Archive,{className:"fill-[#9D9D9D] h-4 w-4"})}),(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",className:"pointer-events-auto h-6 w-6 p-0 hover:bg-[#FDE4E9] dark:hover:bg-[#411D23]",onClick:t=>{t.stopPropagation(),ej(e.id)},children:(0,t.jsx)(A.Trash,{className:"fill-[#F43F5E] h-4 w-4"})})]}),(0,t.jsxs)("div",{className:"relative flex w-full items-center justify-between gap-4 px-2",children:[(0,t.jsx)(c.Avatar,{className:"h-8 w-8 shrink-0 rounded-full border",children:(0,t.jsx)(c.AvatarFallback,{className:"bg-white dark:bg-[#373737] text-[#9F9F9D] font-bold text-xs",children:eS(e)})}),(0,t.jsx)("div",{className:"flex w-full justify-between",children:(0,t.jsxs)("div",{className:"w-full",children:[(0,t.jsxs)("div",{className:"flex w-full flex-row items-center justify-between",children:[(0,t.jsx)("div",{className:"flex flex-row items-center gap-[4px]",children:(0,t.jsx)("span",{className:`font-${(!e.read_at,"bold")} text-md flex items-baseline gap-1 group-hover:opacity-100`,children:(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)("span",{className:"line-clamp-1 overflow-hidden text-sm",children:eN(e)}),!e.read_at&&(0,t.jsx)("span",{className:"ml-0.5 size-2 rounded-full bg-[#006FFE]"})]})})}),(0,t.jsx)("p",{className:"text-muted-foreground text-nowrap text-xs font-normal opacity-70 transition-opacity group-hover:opacity-100 dark:text-[#8C8C8C]",children:e.created_at?new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),(0,t.jsx)("div",{className:"flex justify-between",children:(0,t.jsx)("p",{className:"mt-1 line-clamp-1 w-[95%] min-w-0 overflow-hidden text-sm text-[#8C8C8C]",children:e.body||"No message"})})]})})]})]})},e.id)})}):(0,t.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(y.MessageSquare,{className:"h-16 w-16 text-muted-foreground opacity-50 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:es?"No SMS found":"No SMS yet"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:es?"Try adjusting your search terms":"SMS messages will appear here when received"})]})})})})})})]})}),(0,t.jsx)("div",{className:(0,p.cn)("bg-card mb-1 shadow-sm flex flex-col min-w-0 overflow-hidden","w-full h-full","md:rounded-tl-2xl md:flex-1",eR?"flex":"hidden md:flex"),children:(0,t.jsx)("div",{className:"relative flex-1 min-h-0 flex flex-col",children:Z?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"sticky top-0 z-15 flex shrink-0 items-center justify-between gap-1.5 p-2 pb-0 transition-colors bg-card",children:[(0,t.jsx)("div",{className:"flex flex-1 items-center gap-2",children:(0,t.jsxs)(d.Button,{variant:"ghost",size:"sm",onClick:()=>{Q(null),ex.current=null,G([]);let e=new URLSearchParams;U&&"inbox"!==U&&e.set("folder",U),F.push(`/dashboard/communication/sms?${e.toString()}`,{scroll:!1})},className:"h-10 w-10 p-0 md:h-8 md:w-8 hover:bg-accent/80 active:bg-accent transition-colors",title:"Back to list",children:[(0,t.jsx)(b.ArrowLeft,{className:"h-5 w-5 md:hidden text-muted-foreground"}),(0,t.jsx)(R.X,{className:"h-4 w-4 hidden md:block text-muted-foreground"})]})}),(0,t.jsx)("div",{className:"flex items-center gap-1",children:(0,t.jsx)(d.Button,{variant:"ghost",size:"sm",className:"h-10 w-10 p-0 md:h-8 md:w-8 hover:bg-accent/80 active:bg-accent transition-colors",title:"More options",children:(0,t.jsx)(j.MoreHorizontal,{className:"h-5 w-5 md:h-4 md:w-4 text-muted-foreground"})})})]}),(0,t.jsx)("div",{className:"border-b border-border/50 px-2 py-4 space-y-3",children:(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(c.Avatar,{className:"h-9 w-9 shrink-0 rounded-md",children:(0,t.jsx)(c.AvatarFallback,{className:"bg-muted text-muted-foreground font-semibold text-sm rounded-md",children:eS(Z)})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("div",{className:"font-semibold text-sm text-foreground",children:eN(Z)}),(0,t.jsx)("div",{className:"text-xs text-muted-foreground",children:"inbound"===Z.direction?Z.from_address||"Unknown":Z.to_address||"Unknown"})]})]})}),(0,t.jsx)("div",{ref:ef,className:"flex-1 overflow-y-auto bg-card px-4 py-4",children:ee?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)(w.Loader2,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):0===Y.length?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(y.MessageSquare,{className:"h-12 w-12 text-muted-foreground opacity-50 mx-auto mb-2"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"No messages yet"})]})}):(0,t.jsx)("div",{className:"space-y-2",children:Y.map((e,s)=>{let a,r,n="outbound"===e.direction,i=0===s||new Date(e.created_at).getTime()-new Date(Y[s-1].created_at).getTime()>3e5;return(0,t.jsxs)("div",{className:"flex flex-col",children:[i&&(0,t.jsx)("div",{className:"flex justify-center my-2",children:(0,t.jsx)("span",{className:"text-xs text-muted-foreground bg-muted/50 px-2 py-1 rounded-full",children:(a=new Date(e.created_at),r=new Date,a.toDateString()===r.toDateString()?a.toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit"}):a.toLocaleDateString("en-US",{month:"short",day:"numeric",hour:"numeric",minute:"2-digit"}))})}),(0,t.jsxs)("div",{className:(0,p.cn)("flex flex-col",n?"items-end":"items-start"),children:[(0,t.jsxs)("div",{className:(0,p.cn)("max-w-[75%] rounded-2xl px-4 py-2 shadow-sm",n?"bg-primary text-primary-foreground rounded-tr-sm":"bg-muted text-foreground rounded-tl-sm"),children:[e.provider_metadata&&"object"==typeof e.provider_metadata&&"attachments"in e.provider_metadata&&Array.isArray(e.provider_metadata.attachments)&&e.provider_metadata.attachments.length>0&&(0,t.jsx)("div",{className:(0,p.cn)("mb-2 space-y-2",(e.body,"")),children:e.provider_metadata.attachments.map((e,s)=>{let a="image"===e.type||e.url&&/\.(jpg|jpeg|png|gif|webp)$/i.test(e.url);return(0,t.jsx)("div",{className:"rounded-lg overflow-hidden",children:a?(0,t.jsx)("img",{src:e.url,alt:e.filename||"Image",className:"max-w-full max-h-64 object-contain rounded-lg",loading:"lazy"}):(0,t.jsxs)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:(0,p.cn)("flex items-center gap-2 p-2 rounded-lg hover:opacity-80 transition-opacity",n?"bg-primary-foreground/20":"bg-background/20"),children:[(0,t.jsx)(N.Paperclip,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"text-xs truncate",children:e.filename||"Attachment"})]})},s)})}),e.body&&(0,t.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:e.body}),!e.body&&(!e.provider_metadata||"object"!=typeof e.provider_metadata||!("attachments"in e.provider_metadata)||!Array.isArray(e.provider_metadata.attachments)||0===e.provider_metadata.attachments.length)&&(0,t.jsx)("p",{className:"text-sm opacity-70 italic",children:"No message content"})]}),(0,t.jsx)("span",{className:(0,p.cn)("text-xs text-muted-foreground mt-0.5",n?"text-right":"text-left"),children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})]},e.id)})})}),(0,t.jsx)(h.SmsMessageInput,{value:ei,onChange:el,onSend:eC,onAttach:ek,sending:eo,disabled:!Z,placeholder:"Text Message",customerId:Z?.customer_id||void 0,customerName:Z?.customer?`${Z.customer.first_name||""} ${Z.customer.last_name||""}`.trim():void 0,customerFirstName:Z?.customer?.first_name||void 0,companyName:eu?.companyName,companyPhone:eu?.companyPhone,enableAiSuggestions:!!Z?.customer_id})]}):(0,t.jsx)("div",{className:"flex flex-col items-center justify-center h-full px-4 py-8",children:(0,t.jsxs)("div",{className:"text-center space-y-4 max-w-md",children:[(0,t.jsx)(y.MessageSquare,{className:"h-16 w-16 text-muted-foreground opacity-50 mx-auto"}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("h3",{className:"text-lg font-semibold text-foreground",children:"No conversation selected"}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select a conversation from the list to view messages, or create a new SMS to get started."})]}),(0,t.jsxs)(d.Button,{onClick:()=>{window.dispatchEvent(new CustomEvent("open-recipient-selector",{detail:{type:"sms"}}))},className:"mt-4 h-12 px-6 md:h-11 md:px-5",size:"lg",children:[(0,t.jsx)(S.Plus,{className:"h-5 w-5 md:h-4 md:w-4 mr-2"}),"Create new SMS"]})]})})})})]})})}e.s(["SmsPageClient",()=>z])}]);