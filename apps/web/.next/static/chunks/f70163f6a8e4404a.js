(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,672573,e=>{"use strict";let t=(0,e.i(383206).default)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);e.s(["default",()=>t])},15751,e=>{"use strict";var t=e.i(672573);e.s(["MapPin",()=>t.default])},960876,e=>{"use strict";function t(e,t){if(!e)return t||"Unknown Customer";if(e.display_name)return e.display_name;let s=e.first_name?.trim(),a=e.last_name?.trim();return s&&a?`${s} ${a}`:s||a||(e.company_name?e.company_name:e.email?e.email:t||"Unknown Customer")}function s(e){if(!e)return"?";let s=t(e).split(/\s+/).filter(Boolean);return s.length>=2?(s[0][0]+s[1][0]).toUpperCase():1===s.length&&s[0].length>=2?s[0].slice(0,2).toUpperCase():1===s.length?s[0][0].toUpperCase():"?"}e.s(["getCustomerDisplayName",()=>t,"getCustomerInitials",()=>s])},568185,e=>{"use strict";let t=(0,e.i(383206).default)("chevrons-up-down",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);e.s(["default",()=>t])},390929,e=>{"use strict";var t=e.i(568185);e.s(["ChevronsUpDown",()=>t.default])},438351,195100,e=>{"use strict";var t=e.i(552038),s=(0,t.createServerReference)("40f01c38bcd0dedd8819f5121a098e2ffd43eb6e19",t.callServer,void 0,t.findSourceMapURL,"createAppointment");e.s(["createAppointment",()=>s],438351);var a=e.i(111043),r=e.i(302324);e.i(670258);var i=e.i(921251);e.i(889265);var l=e.i(677607);e.i(733296);var n=e.i(993665);e.i(220474);var c=e.i(171056);e.i(254978);var d=e.i(375308),o=e.i(152088),m=e.i(960876),u=e.i(263942),h=e.i(79254),x=e.i(390929),p=e.i(641304),j=e.i(559586),g=e.i(939397),f=e.i(371526),v=e.i(287268),S=e.i(14435),N=e.i(970799);function b({value:e,onChange:t,placeholder:s="Search for customer...",className:b,showRecent:C=!0,recentCustomers:y=[],showCreateNew:w=!0,onCreateNew:I,disabled:F=!1,label:k,error:T=!1,errorMessage:A}){let[_,M]=(0,N.useState)(!1),[P,R]=(0,N.useState)(""),[V,D]=(0,N.useState)([]),[q,E]=(0,N.useState)(!1),[H,U]=(0,N.useState)(null);(0,N.useEffect)(()=>{if(P.trim().length<2){D([]),E(!1);return}E(!0);let e=setTimeout(async()=>{try{let e=await (0,r.searchCustomers)(P,{limit:10});if(e.success&&e.data){let t=Array.isArray(e.data)?e.data:[e.data];D(t)}else D([])}catch(e){console.error("Customer search error:",e),D([])}finally{E(!1)}},300);return()=>clearTimeout(e)},[P]);let B=(0,N.useCallback)(e=>{U(e),t(e.id,e),M(!1),R("")},[t]),$=(0,N.useCallback)(()=>{U(null),t(null,null),R("")},[t]),z=H?(0,m.getCustomerDisplayName)(H):s,L=(0,N.useMemo)(()=>{let e=new Map;return V.forEach(t=>e.set(t.id,t)),P.trim().length<2&&C&&y.forEach(t=>e.set(t.id,t)),Array.from(e.values())},[V,y,P,C]),O=({customer:t})=>{let s=(0,m.getCustomerDisplayName)(t),r=(0,m.getCustomerInitials)(t),l=e===t.id;return(0,a.jsxs)(n.CommandItem,{value:t.id,onSelect:()=>B(t),className:"flex items-center gap-3 px-3 py-2.5 cursor-pointer",children:[(0,a.jsx)(i.Avatar,{className:"h-8 w-8 shrink-0",children:(0,a.jsx)(i.AvatarFallback,{className:"text-xs font-semibold",children:r})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("p",{className:"font-medium text-sm truncate",children:s}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[t.email&&(0,a.jsxs)("span",{className:"flex items-center gap-1 truncate",children:[(0,a.jsx)(j.Mail,{className:"h-3 w-3 shrink-0"}),t.email]}),t.phone&&(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(g.Phone,{className:"h-3 w-3 shrink-0"}),t.phone]})]}),t.company_name&&(0,a.jsxs)("p",{className:"text-xs text-muted-foreground flex items-center gap-1 mt-0.5",children:[(0,a.jsx)(u.Building2,{className:"h-3 w-3 shrink-0"}),t.company_name]})]}),l&&(0,a.jsx)(h.Check,{className:"h-4 w-4 text-primary shrink-0"})]},t.id)};return(0,a.jsxs)("div",{className:(0,o.cn)("flex flex-col gap-1.5",b),children:[k&&(0,a.jsx)("label",{className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:k}),(0,a.jsxs)(c.Popover,{open:_,onOpenChange:M,children:[(0,a.jsx)(c.PopoverTrigger,{asChild:!0,children:(0,a.jsxs)(l.Button,{variant:"outline",role:"combobox","aria-expanded":_,disabled:F,className:(0,o.cn)("w-full justify-between",!H&&"text-muted-foreground",T&&"border-destructive focus-visible:ring-destructive"),children:[(0,a.jsx)("span",{className:"flex items-center gap-2 truncate",children:H?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.User,{className:"h-4 w-4 shrink-0"}),(0,a.jsx)("span",{className:"truncate",children:z})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(v.Search,{className:"h-4 w-4 shrink-0"}),(0,a.jsx)("span",{children:s})]})}),(0,a.jsx)(x.ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(c.PopoverContent,{className:"w-[400px] p-0",align:"start",children:(0,a.jsxs)(n.Command,{shouldFilter:!1,children:[(0,a.jsx)(n.CommandInput,{placeholder:"Search customers...",value:P,onValueChange:R}),(0,a.jsx)(n.CommandList,{children:q?(0,a.jsx)("div",{className:"flex items-center justify-center py-6",children:(0,a.jsx)(p.Loader2,{className:"h-5 w-5 animate-spin text-muted-foreground"})}):(0,a.jsxs)(a.Fragment,{children:[L.length>0?(0,a.jsx)(n.CommandGroup,{heading:P.trim().length>=2?"Search Results":C&&y.length>0?"Recent Customers":"All Customers",children:(0,a.jsx)(d.ScrollArea,{className:"max-h-[300px]",children:L.map(e=>(0,a.jsx)(O,{customer:e},e.id))})}):P.trim().length>=2?(0,a.jsx)(n.CommandEmpty,{children:"No customers found."}):C&&0===y.length?(0,a.jsx)(n.CommandEmpty,{children:"Start typing to search for customers..."}):null,w&&I&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n.CommandSeparator,{}),(0,a.jsx)(n.CommandGroup,{children:(0,a.jsxs)(n.CommandItem,{onSelect:()=>{M(!1),I()},className:"flex items-center gap-2 px-3 py-2.5 cursor-pointer text-primary",children:[(0,a.jsx)(f.Plus,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"font-medium",children:"Create New Customer"})]})})]})]})}),H&&!F&&(0,a.jsx)("div",{className:"border-t p-2",children:(0,a.jsx)(l.Button,{variant:"ghost",size:"sm",onClick:$,className:"w-full text-muted-foreground hover:text-destructive",children:"Clear Selection"})})]})})]}),T&&A&&(0,a.jsx)("p",{className:"text-sm text-destructive",children:A})]})}e.s(["CustomerAutocomplete",()=>b],195100)},847361,e=>{"use strict";e.i(116233),e.s([])},956062,e=>{"use strict";var t=e.i(98556);e.s(["CalendarIcon",()=>t.default])},263548,e=>{"use strict";let t=(0,e.i(383206).default)("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);e.s(["default",()=>t])},322259,e=>{"use strict";var t=e.i(111043),s=e.i(511518),a=e.i(516467);function r(e,t,r){let i=(0,a.toDate)(e,r?.in);return i.setTime(i.getTime()+t*s.millisecondsInMinute),i}var i=e.i(230902),l=e.i(818796),n=e.i(230666),c=e.i(327149),d=e.i(263548),d=d,o=e.i(956062),m=e.i(136764),u=e.i(641304),h=e.i(559586),x=e.i(15751),p=e.i(939397),j=e.i(14435),g=e.i(202724),f=e.i(904653),v=e.i(970799),S=e.i(995403),N=e.i(438351),b=e.i(195100),C=e.i(702948);e.i(553153);var y=e.i(363712);e.i(889265);var w=e.i(677607);e.i(847361);var I=e.i(949538);e.i(254851);var F=e.i(605278);e.i(51478);var k=e.i(635613);e.i(149989);var T=e.i(880177);e.i(220474);var A=e.i(171056);e.i(868198);var _=e.i(798764);e.i(287133);var M=e.i(120109),P=e.i(220168);e.i(223342);var R=e.i(395645);e.i(526120);var V=e.i(610120);let D=(0,C.default)(()=>e.A(992301).then(e=>e.CustomerCreateModal),{loadableGenerated:{modules:[646323]},ssr:!1});function q({jobId:e,customerId:s,propertyId:a,customers:C,properties:q,jobs:E,teamMembers:H}){let U=(0,f.useRouter)(),[B,$]=(0,v.useState)(!1),[z,L]=(0,v.useState)(e?"job":"event"),[O,J]=(0,v.useState)(e||""),[W,G]=(0,v.useState)(s||""),[K,Q]=(0,v.useState)(a||""),[X,Y]=(0,v.useState)(""),[Z,ee]=(0,v.useState)(""),[et,es]=(0,v.useState)(!1),[ea,er]=(0,v.useState)("window"),[ei,el]=(0,v.useState)(),[en,ec]=(0,v.useState)("09:00"),[ed,eo]=(0,v.useState)("120"),[em,eu]=(0,v.useState)("60"),[eh,ex]=(0,v.useState)([]),[ep,ej]=(0,v.useState)("normal"),[eg,ef]=(0,v.useState)("scheduled"),[ev,eS]=(0,v.useState)("job_appointment"),[eN,eb]=(0,v.useState)("service_call"),[eC,ey]=(0,v.useState)("1"),[ew,eI]=(0,v.useState)("1"),[eF,ek]=(0,v.useState)(""),[eT,eA]=(0,v.useState)([]),[e_,eM]=(0,v.useState)(!0),[eP,eR]=(0,v.useState)(!0),[eV,eD]=(0,v.useState)([]),[eq,eE]=(0,v.useState)([]),eH=O?E.find(e=>e.id===O):null,eU=W?q.filter(e=>e.customer_id===W):q,eB=(0,v.useMemo)(()=>{if(!ei||!en)return null;let e=new Date(ei),[t,s]=en.split(":");return e.setHours(parseInt(t),parseInt(s)),r(e,"window"===ea?parseInt(ed):parseInt(em))},[ei,en,ea,ed,em]),e$=(0,v.useMemo)(()=>H,[H,eN,K]);(0,v.useEffect)(()=>{if(O){let e=E.find(e=>e.id===O);e&&(Y(e.title||"Service Appointment"),ee(e.description||""),G(e.customer_id),Q(e.property_id),L("job"),eS("job_appointment"))}},[O,E]),(0,v.useEffect)(()=>{W&&1===eU.length&&Q(eU[0].id)},[W,eU]),(0,v.useEffect)(()=>{"event"===z?(eS("event"),er("exact")):"meeting"===z?(eS("meeting"),er("exact"),eu("30")):(eS("job_appointment"),er("window"))},[z]);let ez=async e=>{if(e.preventDefault(),!W||!K||!ei||!X)return void S.toast.error("Please fill in all required fields");$(!0);try{let e=new Date(ei),[t,s]=en.split(":");e.setHours(parseInt(t),parseInt(s));let a="window"===ea?parseInt(ed):parseInt(em),i=r(e,a),l=new FormData;l.append("title",X),l.append("description",Z),l.append("customerId",W),l.append("propertyId",K),l.append("scheduledStart",e.toISOString()),l.append("scheduledEnd",i.toISOString()),l.append("category",ev),l.append("type",eN),l.append("appointmentType",z),l.append("timeMode",ea),l.append("priority",ep),l.append("status",eg),O&&l.append("jobId",O),eh.length>0&&l.append("assignedTo",JSON.stringify(eh)),l.append("metadata",JSON.stringify({estimatedHours:eC,teamSize:ew,specialRequirements:eF,toolsNeeded:eT,sendReminder:eP,customerNotifications:e_,tags:eV,timeMode:ea,windowDuration:"window"===ea?ed:null}));let n=await (0,N.createAppointment)(l);n.success&&n.data?(S.toast.success("Appointment created successfully"),O?U.push(`/dashboard/work/${O}`):U.push("/dashboard/work/appointments")):S.toast.error(n.error||"Failed to create appointment")}catch(e){console.error("Error creating appointment:",e),S.toast.error("An unexpected error occurred")}finally{$(!1)}};return(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)(F.Card,{className:"border-2",children:[(0,t.jsxs)(F.CardHeader,{className:"pb-4",children:[(0,t.jsxs)(F.CardTitle,{className:"text-lg flex items-center gap-2",children:[(0,t.jsx)(d.default,{className:"h-5 w-5 text-primary"}),"What type of appointment is this?"]}),(0,t.jsx)(F.CardDescription,{children:"Select the primary purpose of this appointment"})]}),(0,t.jsx)(F.CardContent,{children:(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3",children:[(0,t.jsx)("button",{type:"button",onClick:()=>L("job"),className:`p-4 rounded-lg border-2 text-left transition-all ${"job"===z?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(c.Briefcase,{className:`h-5 w-5 mt-0.5 ${"job"===z?"text-primary":"text-muted-foreground"}`}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Job Appointment"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Schedule work for an existing job"})]})]})}),(0,t.jsx)("button",{type:"button",onClick:()=>L("meeting"),className:`p-4 rounded-lg border-2 text-left transition-all ${"meeting"===z?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(g.Users,{className:`h-5 w-5 mt-0.5 ${"meeting"===z?"text-primary":"text-muted-foreground"}`}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Meeting"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Customer consultation or team meeting"})]})]})}),(0,t.jsx)("button",{type:"button",onClick:()=>L("event"),className:`p-4 rounded-lg border-2 text-left transition-all ${"event"===z?"border-primary bg-primary/5":"border-border hover:border-primary/50"}`,children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)(o.CalendarIcon,{className:`h-5 w-5 mt-0.5 ${"event"===z?"text-primary":"text-muted-foreground"}`}),(0,t.jsxs)("div",{children:[(0,t.jsx)("p",{className:"font-semibold",children:"Event"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Training, demo, or company event"})]})]})})]})})]}),eH&&(0,t.jsxs)(F.Card,{className:"border-primary/50 bg-primary/5",children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Briefcase,{className:"h-5 w-5 text-primary"}),(0,t.jsxs)(F.CardTitle,{className:"text-base",children:["Linked to Job #",eH.job_number]})]}),(0,t.jsx)(y.Badge,{variant:"secondary",className:"text-xs",children:eH.status})]})}),(0,t.jsx)(F.CardContent,{children:(0,t.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-xs text-muted-foreground font-medium",children:"Job Title"}),(0,t.jsx)("p",{className:"text-sm font-semibold",children:eH.title}),eH.description&&(0,t.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:eH.description})]}),eH.customer&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground font-medium",children:[(0,t.jsx)(j.User,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:"Customer"})]}),(0,t.jsx)("p",{className:"text-sm font-semibold",children:eH.customer.display_name||`${eH.customer.first_name} ${eH.customer.last_name}`}),(0,t.jsxs)("div",{className:"space-y-0.5",children:[eH.customer.email&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[(0,t.jsx)(h.Mail,{className:"h-3 w-3"}),(0,t.jsx)("span",{className:"truncate",children:eH.customer.email})]}),eH.customer.phone&&(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground",children:[(0,t.jsx)(p.Phone,{className:"h-3 w-3"}),(0,t.jsx)("span",{children:eH.customer.phone})]})]})]}),eH.property&&(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-muted-foreground font-medium",children:[(0,t.jsx)(x.MapPin,{className:"h-3.5 w-3.5"}),(0,t.jsx)("span",{children:"Property"})]}),(0,t.jsx)("p",{className:"text-sm font-semibold",children:eH.property.address}),(0,t.jsxs)("p",{className:"text-xs text-muted-foreground",children:[eH.property.city,", ",eH.property.state," ",eH.property.zip_code]})]})]})})]}),(0,t.jsxs)("form",{onSubmit:ez,className:"space-y-4",children:[(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsx)(F.CardTitle,{className:"text-base",children:"Appointment Details"})}),(0,t.jsxs)(F.CardContent,{className:"space-y-3",children:[(0,t.jsx)(P.StandardFormField,{label:"Title",htmlFor:"title",required:!0,children:(0,t.jsx)(k.Input,{id:"title",value:X,onChange:e=>Y(e.target.value),placeholder:"job"===z?"e.g., Annual HVAC Maintenance":"meeting"===z?"e.g., Customer Consultation":"e.g., Team Training Session",required:!0,className:"h-9"})}),"job"===z&&(0,t.jsxs)(P.StandardFormRow,{cols:3,children:[(0,t.jsx)(P.StandardFormField,{label:"Service Category",htmlFor:"category",required:!0,children:(0,t.jsxs)(_.Select,{value:ev,onValueChange:eS,children:[(0,t.jsx)(_.SelectTrigger,{id:"category",className:"h-9",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{children:[(0,t.jsx)(_.SelectItem,{value:"job_appointment",children:"Job Appointment"}),(0,t.jsx)(_.SelectItem,{value:"estimate_appointment",children:"Estimate Appointment"}),(0,t.jsx)(_.SelectItem,{value:"follow_up",children:"Follow-up Visit"}),(0,t.jsx)(_.SelectItem,{value:"recurring_service",children:"Recurring Service"})]})]})}),(0,t.jsx)(P.StandardFormField,{label:"Service Type",htmlFor:"serviceType",required:!0,children:(0,t.jsxs)(_.Select,{value:eN,onValueChange:eb,children:[(0,t.jsx)(_.SelectTrigger,{id:"serviceType",className:"h-9",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{children:[(0,t.jsx)(_.SelectItem,{value:"service_call",children:"Service Call"}),(0,t.jsx)(_.SelectItem,{value:"installation",children:"Installation"}),(0,t.jsx)(_.SelectItem,{value:"maintenance",children:"Maintenance"}),(0,t.jsx)(_.SelectItem,{value:"inspection",children:"Inspection"}),(0,t.jsx)(_.SelectItem,{value:"repair",children:"Repair"}),(0,t.jsx)(_.SelectItem,{value:"estimate",children:"Estimate"}),(0,t.jsx)(_.SelectItem,{value:"winterization",children:"Winterization"}),(0,t.jsx)(_.SelectItem,{value:"emergency",children:"Emergency"})]})]})}),(0,t.jsx)(P.StandardFormField,{label:"Priority",htmlFor:"priority",children:(0,t.jsxs)(_.Select,{value:ep,onValueChange:e=>ej(e),children:[(0,t.jsx)(_.SelectTrigger,{id:"priority",className:"h-9",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{children:[(0,t.jsx)(_.SelectItem,{value:"normal",children:"Normal"}),(0,t.jsx)(_.SelectItem,{value:"high",children:"High"}),(0,t.jsx)(_.SelectItem,{value:"urgent",children:"Urgent"}),(0,t.jsx)(_.SelectItem,{value:"emergency",children:(0,t.jsxs)("span",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.AlertCircle,{className:"h-3.5 w-3.5 text-red-500"}),"Emergency"]})})]})]})})]}),(0,t.jsx)(P.StandardFormField,{label:"Description",htmlFor:"description",children:(0,t.jsx)(V.Textarea,{id:"description",value:Z,onChange:e=>ee(e.target.value),placeholder:"Additional details about this appointment...",rows:3,className:"resize-none text-sm"})})]})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsxs)(F.CardHeader,{className:"pb-3",children:[(0,t.jsxs)(F.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(m.Clock,{className:"h-4 w-4"}),"Schedule"]}),(0,t.jsx)(F.CardDescription,{children:"Choose exact time or a time window for better flexibility"})]}),(0,t.jsxs)(F.CardContent,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-lg border bg-muted/30",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(T.Label,{className:"text-sm font-medium",children:"Scheduling Mode"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"exact"===ea?"Specific start time (better for meetings)":"Arrival window (better for field service)"})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:`text-xs ${"exact"===ea?"font-medium":"text-muted-foreground"}`,children:"Exact Time"}),(0,t.jsx)(R.Switch,{checked:"window"===ea,onCheckedChange:e=>er(e?"window":"exact")}),(0,t.jsx)("span",{className:`text-xs ${"window"===ea?"font-medium":"text-muted-foreground"}`,children:"Time Window"})]})]}),(0,t.jsxs)(P.StandardFormRow,{cols:3,children:[(0,t.jsx)(P.StandardFormField,{label:"Date",htmlFor:"date",required:!0,children:(0,t.jsxs)(A.Popover,{children:[(0,t.jsx)(A.PopoverTrigger,{asChild:!0,children:(0,t.jsxs)(w.Button,{variant:"outline",className:"w-full justify-start text-left font-normal h-9 text-sm",children:[(0,t.jsx)(o.CalendarIcon,{className:"mr-2 h-3.5 w-3.5"}),ei?(0,i.format)(ei,"PPP"):"Pick a date"]})}),(0,t.jsx)(A.PopoverContent,{className:"w-auto p-0",align:"start",children:(0,t.jsx)(I.Calendar,{mode:"single",selected:ei,onSelect:el,initialFocus:!0})})]})}),(0,t.jsx)(P.StandardFormField,{label:"window"===ea?"Window Start":"Start Time",htmlFor:"start-time",required:!0,children:(0,t.jsx)(k.Input,{id:"start-time",type:"time",value:en,onChange:e=>ec(e.target.value),required:!0,className:"h-9"})}),(0,t.jsx)(P.StandardFormField,{label:"window"===ea?"Window Duration":"Duration (minutes)",htmlFor:"duration",required:!0,children:"window"===ea?(0,t.jsxs)(_.Select,{value:ed,onValueChange:eo,children:[(0,t.jsx)(_.SelectTrigger,{id:"duration",className:"h-9",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{children:[(0,t.jsx)(_.SelectItem,{value:"15",children:"15 minutes"}),(0,t.jsx)(_.SelectItem,{value:"30",children:"30 minutes"}),(0,t.jsx)(_.SelectItem,{value:"60",children:"1 hour"}),(0,t.jsx)(_.SelectItem,{value:"120",children:"2 hours (recommended)"}),(0,t.jsx)(_.SelectItem,{value:"240",children:"4 hours"}),(0,t.jsx)(_.SelectItem,{value:"480",children:"8 hours (all day)"})]})]}):(0,t.jsx)(k.Input,{id:"duration",type:"number",value:em,onChange:e=>eu(e.target.value),min:"15",step:"15",required:!0,className:"h-9"})})]}),eB&&(0,t.jsx)("div",{className:"p-3 rounded-lg bg-primary/5 border border-primary/20",children:(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Clock,{className:"h-4 w-4 text-primary"}),(0,t.jsx)("span",{className:"font-medium",children:"window"===ea?"Arrival Window:":"Scheduled Time:"})]}),(0,t.jsxs)("div",{className:"font-semibold",children:[(0,i.format)(new Date(ei.setHours(parseInt(en.split(":")[0]),parseInt(en.split(":")[1]))),"h:mm a")," - ",(0,i.format)(eB,"h:mm a"),"window"===ea&&(0,t.jsxs)("span",{className:"text-xs text-muted-foreground ml-2",children:["(","120"===ed?"2 hr":"60"===ed?"1 hr":"240"===ed?"4 hr":"480"===ed?"8 hr":`${ed} min`," ","window)"]})]})]})})]})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsx)(F.CardTitle,{className:"text-base",children:"Customer & Location"})}),(0,t.jsx)(F.CardContent,{className:"space-y-3",children:(0,t.jsxs)(P.StandardFormRow,{cols:2,children:[(0,t.jsx)("div",{children:(0,t.jsx)(b.CustomerAutocomplete,{value:W,onChange:e=>G(e||""),placeholder:"Search for customer...",label:"Customer",disabled:!!eH,showRecent:!0,showCreateNew:!0,onCreateNew:()=>es(!0),error:!W&&!!eH})}),(0,t.jsx)(P.StandardFormField,{label:"Property",htmlFor:"property",required:!0,children:(0,t.jsxs)(_.Select,{value:K,onValueChange:Q,disabled:!W||!!eH,required:!0,children:[(0,t.jsx)(_.SelectTrigger,{id:"property",className:"h-9",children:(0,t.jsx)(_.SelectValue,{placeholder:"Select property"})}),(0,t.jsx)(_.SelectContent,{children:eU.map(e=>(0,t.jsxs)(_.SelectItem,{value:e.id,children:[e.address,", ",e.city]},e.id))})]})})]})})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsxs)(F.CardHeader,{className:"pb-3",children:[(0,t.jsxs)(F.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(g.Users,{className:"h-4 w-4"}),"Team Assignment"]}),(0,t.jsx)(F.CardDescription,{children:"job"===z?"Assign technicians based on skills and location":"Select team members for this appointment"})]}),(0,t.jsxs)(F.CardContent,{className:"space-y-3",children:[(0,t.jsxs)(P.StandardFormRow,{cols:"job"===z?3:2,children:[(0,t.jsx)(P.StandardFormField,{label:"job"===z?"Technician":"Team Member",htmlFor:"assignedTo",children:(0,t.jsxs)(_.Select,{value:eh[0],onValueChange:e=>ex(e?[e]:[]),children:[(0,t.jsx)(_.SelectTrigger,{id:"assignedTo",className:"h-9",children:(0,t.jsx)(_.SelectValue,{placeholder:"Select team member (optional)"})}),(0,t.jsx)(_.SelectContent,{children:e$.map(e=>(0,t.jsx)(_.SelectItem,{value:e.id,children:e.full_name||e.email},e.id))})]})}),"job"===z&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(P.StandardFormField,{label:"Est. Hours",htmlFor:"estimatedHours",children:(0,t.jsx)(k.Input,{id:"estimatedHours",type:"number",value:eC,onChange:e=>ey(e.target.value),min:"0.5",step:"0.5",className:"h-9"})}),(0,t.jsx)(P.StandardFormField,{label:"Team Size",htmlFor:"teamSize",children:(0,t.jsxs)(_.Select,{value:ew,onValueChange:eI,children:[(0,t.jsx)(_.SelectTrigger,{id:"teamSize",className:"h-9",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{children:[(0,t.jsx)(_.SelectItem,{value:"1",children:"1 technician"}),(0,t.jsx)(_.SelectItem,{value:"2",children:"2 technicians"}),(0,t.jsx)(_.SelectItem,{value:"3",children:"3 technicians"}),(0,t.jsx)(_.SelectItem,{value:"4",children:"4+ technicians"})]})]})})]}),(0,t.jsx)(P.StandardFormField,{label:"Status",htmlFor:"status",children:(0,t.jsxs)(_.Select,{value:eg,onValueChange:ef,children:[(0,t.jsx)(_.SelectTrigger,{id:"status",className:"h-9",children:(0,t.jsx)(_.SelectValue,{})}),(0,t.jsxs)(_.SelectContent,{children:[(0,t.jsx)(_.SelectItem,{value:"scheduled",children:"Scheduled"}),(0,t.jsx)(_.SelectItem,{value:"confirmed",children:"Confirmed"}),(0,t.jsx)(_.SelectItem,{value:"pending",children:"Pending"})]})]})})]}),"job"===z&&(0,t.jsx)(P.StandardFormField,{label:"Special Requirements / Tools Needed",htmlFor:"specialRequirements",children:(0,t.jsx)(V.Textarea,{id:"specialRequirements",value:eF,onChange:e=>ek(e.target.value),placeholder:"e.g., Ladder truck required, asbestos certification needed, bilingual technician...",rows:2,className:"resize-none text-sm"})})]})]}),(0,t.jsxs)(F.Card,{children:[(0,t.jsx)(F.CardHeader,{className:"pb-3",children:(0,t.jsxs)(F.CardTitle,{className:"text-base flex items-center gap-2",children:[(0,t.jsx)(n.Bell,{className:"h-4 w-4"}),"Customer Notifications"]})}),(0,t.jsxs)(F.CardContent,{className:"space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(T.Label,{htmlFor:"customerNotifications",className:"text-sm font-medium",children:"Send Confirmation"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Email/SMS confirmation to customer after booking"})]}),(0,t.jsx)(R.Switch,{id:"customerNotifications",checked:e_,onCheckedChange:eM})]}),(0,t.jsx)(M.Separator,{}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{className:"space-y-0.5",children:[(0,t.jsx)(T.Label,{htmlFor:"sendReminder",className:"text-sm font-medium",children:"Send Reminder"}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground",children:"Reminder 24 hours before scheduled time"})]}),(0,t.jsx)(R.Switch,{id:"sendReminder",checked:eP,onCheckedChange:eR})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between gap-2 pt-2",children:[(0,t.jsx)(w.Button,{type:"button",variant:"ghost",onClick:()=>U.back(),disabled:B,size:"sm",children:"Cancel"}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(y.Badge,{variant:"outline",className:"text-xs",children:"job"===z?"Job Appointment":"meeting"===z?"Meeting":"Event"}),(0,t.jsxs)(w.Button,{type:"submit",disabled:B,size:"default",children:[B&&(0,t.jsx)(u.Loader2,{className:"mr-2 h-4 w-4 animate-spin"}),B?"Creating...":"Create Appointment"]})]})]})]}),(0,t.jsx)(D,{open:et,onOpenChange:es,onCustomerCreated:e=>{G(e.id),es(!1),S.toast.success("Customer created successfully")}})]})}e.s(["AppointmentCreateFormV2",()=>q],322259)},992301,e=>{e.v(t=>Promise.all(["static/chunks/aeef91c0c4327f80.js"].map(t=>e.l(t))).then(()=>t(646323)))}]);