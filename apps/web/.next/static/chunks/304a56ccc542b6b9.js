(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,235670,e=>{"use strict";e.i(116233),e.s([])},221999,e=>{"use strict";let t=(0,e.i(383206).default)("calendar-days",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);e.s(["default",()=>t])},560149,e=>{"use strict";var t=e.i(221999);e.s(["CalendarDays",()=>t.default])},686804,e=>{"use strict";let t=(0,e.i(383206).default)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);e.s(["default",()=>t])},550652,e=>{"use strict";var t=e.i(686804);e.s(["ArrowUpRight",()=>t.default])},926991,e=>{"use strict";let t=(0,e.i(383206).default)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);e.s(["default",()=>t])},51866,e=>{"use strict";var t=e.i(926991);e.s(["ChevronLeft",()=>t.default])},172506,e=>{"use strict";var t=e.i(306929);e.s(["ArrowDown",()=>t.default])},698684,e=>{"use strict";let t=(0,e.i(383206).default)("arrow-up",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);e.s(["default",()=>t])},407205,e=>{"use strict";var t=e.i(698684);e.s(["ArrowUp",()=>t.default])},306929,e=>{"use strict";let t=(0,e.i(383206).default)("arrow-down",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);e.s(["default",()=>t])},573951,e=>{"use strict";let t=(0,e.i(383206).default)("arrow-up-down",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);e.s(["default",()=>t])},287156,e=>{"use strict";var t=e.i(111043),r=e.i(970799),a=e.i(151213);function l({section:e,table:l,kanban:s,fallback:d=null,forceView:i}){let n=(0,a.useWorkView)(e),o=(0,a.useSetWorkView)(e),c=i??n;return((0,r.useEffect)(()=>{i&&n!==i&&o(i)},[i]),"kanban"===c)?(0,t.jsx)(t.Fragment,{children:s??d}):(0,t.jsx)(t.Fragment,{children:l??d})}e.s(["WorkDataView",()=>l])},430876,e=>{"use strict";var t=e.i(111043),r=e.i(970799);e.i(116233);var a=e.i(363712),l=e.i(999),s=e.i(691225),d=e.i(913532),i=e.i(605278),n=e.i(375308),o=e.i(989239);let c=(0,r.createContext)(null),u=(0,r.createContext)(null),b="kanban-column-";function m(e,t,r){let a=Object.fromEntries(e.map(e=>[e.id,[]]));return t.reduce((e,t)=>{let a=r(t);return e[a]||(e[a]=[]),e[a]=[...e[a],t],e},a)}function g({columns:e,data:a,onDataChange:d,onItemMove:n,getColumnId:u,children:g,className:h,pointerSensorOptions:x,renderDragOverlay:p}){let f=(0,r.useCallback)(u??(e=>e.columnId),[]),[v,k]=(0,r.useState)(()=>m(e,a,f)),[y,w]=(0,r.useState)(null),j=(0,r.useRef)(e);(0,r.useEffect)(()=>{j.current=e},[e]),(0,r.useEffect)(()=>{k(m(e,a,f))},[e,a,f]);let N=(0,l.useSensors)((0,l.useSensor)(l.PointerSensor,{activationConstraint:{distance:6},...x}),(0,l.useSensor)(l.KeyboardSensor,{coordinateGetter:s.sortableKeyboardCoordinates})),C=(0,r.useCallback)(e=>{for(let t of j.current){let r=v[t.id]??[],a=r.findIndex(t=>t.id===e);if(-1!==a)return{columnId:t.id,item:r[a],index:a}}return null},[v]),A=(0,r.useCallback)(e=>{let t=C(e.active.id);t&&w({item:t.item,columnId:t.columnId})},[C]),S=(0,r.useCallback)(e=>{var t;let{active:r,over:a}=e;if(w(null),!a)return;let l=C(r.id);if(!l)return;let s=null,i=null;if("string"==typeof a.id&&a.id.startsWith(b))i=(v[s=a.id.replace(b,"")]??[]).length;else{let e=C(a.id);e&&(s=e.columnId,i=(v[e.columnId]??[]).findIndex(t=>t.id===e.item.id))}if(null===s||null===i||s===l.columnId&&i===l.index)return;let o=Object.fromEntries(Object.entries(v).map(([e,t])=>[e,t.slice()])),c=o[l.columnId]??[],[u]=c.splice(l.index,1);o[l.columnId]=c;let m=o[s]??[],g=l.columnId===s&&l.index<i?i-1:i,h={...u,columnId:s};m.splice(g,0,h),o[s]=m,k(o);let x=(t=j.current,t.flatMap(e=>o[e.id]??[]));d?.(x),n&&n({item:h,fromColumnId:l.columnId,toColumnId:s,toIndex:g})},[C,v,d,n]),D=(0,r.useMemo)(()=>({columns:e,getItems:e=>v[e]??[],findItem:C,activeItem:y}),[e,v,C,y]);return(0,t.jsx)(c.Provider,{value:D,children:(0,t.jsxs)(l.DndContext,{collisionDetection:l.closestCorners,onDragCancel:()=>w(null),onDragEnd:S,onDragStart:A,sensors:N,children:[(0,t.jsx)("div",{className:(0,o.cn)("flex w-full gap-4 overflow-x-auto px-6 py-4 md:px-8 lg:px-10",h),children:g}),(0,t.jsx)(l.DragOverlay,{children:y?p?p(y.item):(0,t.jsx)(i.Card,{className:"border-border/70 bg-background/95 w-[280px] max-w-[320px] border p-3 shadow-lg",children:(0,t.jsx)("p",{className:"text-sm font-medium",children:String(y.item.id)})}):null})]})})}function h({column:e,children:r,className:a}){return(0,t.jsx)(u.Provider,{value:e,children:(0,t.jsx)("section",{"aria-label":`${e.name} column`,className:(0,o.cn)("kanban-column border-border/60 from-background via-background/60 to-muted/40 flex h-full min-w-[320px] flex-1 flex-col rounded-2xl border bg-gradient-to-b shadow-sm ring-1 ring-black/5 backdrop-blur-sm transition hover:shadow-md",a),children:r})})}function x({children:e,className:r}){return(0,t.jsx)("header",{className:(0,o.cn)("bg-background/90 sticky top-0 z-10 flex items-center justify-between gap-2 rounded-t-2xl px-4 py-3 backdrop-blur-sm",r),children:e})}function p({columnId:e,children:a,emptyState:d,className:i,height:u="28rem"}){let{getItems:m}=function(){let e=(0,r.useContext)(c);if(!e)throw Error("useKanbanContext must be used within a KanbanProvider");return e}(),g=m(e),{setNodeRef:h,isOver:x}=(0,l.useDroppable)({id:`${b}${e}`});return(0,t.jsx)(s.SortableContext,{items:g.map(e=>e.id),strategy:s.verticalListSortingStrategy,children:(0,t.jsx)(n.ScrollArea,{className:"kanban-scroll flex-1",children:(0,t.jsxs)("div",{className:(0,o.cn)("kanban-column-cards bg-muted/30 flex min-h-[120px] flex-col gap-3 rounded-2xl p-3 transition",x&&"ring-primary/60 ring-2 ring-offset-2",i),"data-drop-state":x?"active":"inactive",ref:h,style:{minHeight:u},children:[0===g.length&&d,g.map((e,t)=>a(e,t))]})})})}function f({itemId:e,children:r,className:a}){let{attributes:l,listeners:n,setNodeRef:c,transform:u,transition:b,isDragging:m}=(0,s.useSortable)({id:e}),g={transform:d.CSS.Transform.toString(u),transition:b};return(0,t.jsx)(i.Card,{className:(0,o.cn)("border-border/70 bg-background/95 focus-visible:ring-ring grid gap-3 rounded-xl border p-4 text-left shadow-sm ring-0 transition-all outline-none hover:-translate-y-0.5 hover:shadow-md focus-visible:ring-2",m&&"border-primary/60 scale-[1.01] opacity-80 shadow-lg",a),"data-dragging":m?"":void 0,ref:c,style:g,...n,...l,children:r})}function v({data:e,columns:l,mapToKanbanItem:s,updateEntityStatus:d,renderCard:i,renderDragOverlay:n,calculateColumnMeta:o,onItemMove:c,entityName:u="items",emptyStateMessage:b,showTotals:m=!1,formatTotal:v}){let[k,y]=(0,r.useState)(()=>e.map(s)),w=o||((e,t)=>({count:t.filter(t=>t.columnId===e).length})),j=(0,r.useMemo)(()=>{let e={};return l.forEach(t=>{e[t.id]=w(t.id,k)}),e},[l,k,w]),N=(0,r.useMemo)(()=>l.map(e=>({id:e.id,name:e.name,accentColor:e.accentColor})),[l]),C=b||(e=>`No ${u} in ${e}`);return(0,t.jsx)(g,{className:"pb-4",columns:N,data:k,onDataChange:e=>{d?y(e.map(e=>({...e,entity:d(e.entity,e.columnId)}))):y(e)},onItemMove:c,renderDragOverlay:n||(e=>(0,t.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg",children:i(e)})),children:l.map(e=>{let r=j[e.id]??{count:0};return(0,t.jsxs)(h,{className:"min-h-[300px] flex-1",column:N.find(t=>t.id===e.id),children:[(0,t.jsx)(x,{children:(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{"aria-hidden":"true",className:"h-2.5 w-2.5 rounded-full",style:{backgroundColor:e.accentColor}}),(0,t.jsx)("span",{className:"text-foreground text-sm font-semibold",children:e.name}),(0,t.jsxs)(a.Badge,{className:"bg-muted text-muted-foreground rounded-full px-2 py-0 text-xs font-medium",variant:"secondary",children:[r.count," ",u]}),m&&void 0!==r.total&&v&&(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:v(r.total)}),m&&void 0!==r.value&&v&&(0,t.jsx)("span",{className:"text-muted-foreground text-xs",children:v(r.value)})]})}),(0,t.jsx)(p,{className:"min-h-[200px]",columnId:e.id,emptyState:(0,t.jsx)("div",{className:"border-border/60 bg-background/60 text-muted-foreground rounded-xl border border-dashed p-4 text-center text-xs",children:C(e.name)}),children:e=>(0,t.jsx)(f,{itemId:e.id,children:i(e)},e.id)})]},e.id)})})}e.s(["EntityKanban",()=>v],430876)},923225,e=>{"use strict";let t=(0,e.i(383206).default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["default",()=>t])},630754,e=>{"use strict";var t=e.i(923225);e.s(["CheckCircle",()=>t.default])},321561,e=>{"use strict";let t=(0,e.i(383206).default)("loader",[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]]);e.s(["default",()=>t])},794712,e=>{"use strict";var t=e.i(111043);e.i(116233);var r=e.i(363712),a=e.i(989239),l=e.i(818796),s=e.i(276389),d=e.i(630754),i=e.i(136764),n=e.i(606661),o=e.i(321561),o=o,c=e.i(559586),u=e.i(900007);function b(e){return({quoted:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:"Quoted",icon:n.FileText,ariaLabel:"Job status: Quoted"},scheduled:{className:"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400",label:"Scheduled",icon:s.Calendar,ariaLabel:"Job status: Scheduled"},in_progress:{className:"border-blue-500/50 bg-blue-500 text-white hover:bg-blue-600",label:"In Progress",icon:o.default,ariaLabel:"Job status: In Progress"},completed:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Completed",icon:d.CheckCircle,ariaLabel:"Job status: Completed"},cancelled:{className:"border-red-500/50 bg-red-500 text-white hover:bg-red-600",label:"Cancelled",icon:u.XCircle,ariaLabel:"Job status: Cancelled"}})[e]||{className:"border-border/50 bg-background text-muted-foreground",label:e.replace(/_/g," ")}}function m({status:e,type:s,priority:o,contractType:u,className:m,variant:g="outline"}){let h,x=(h=u?({service:{className:"border-blue-200/50 bg-blue-50/50 text-blue-700 dark:border-blue-900/50 dark:bg-blue-950/30 dark:text-blue-400",label:"Service"},maintenance:{className:"border-green-200/50 bg-green-50/50 text-green-700 dark:border-green-900/50 dark:bg-green-950/30 dark:text-green-400",label:"Maintenance"},custom:{className:"border-purple-200/50 bg-purple-50/50 text-purple-700 dark:border-purple-900/50 dark:bg-purple-950/30 dark:text-purple-400",label:"Custom"}})[u]||{className:"border-purple-200/50 bg-purple-50/50 text-purple-700 dark:border-purple-900/50 dark:bg-purple-950/30 dark:text-purple-400",label:u.replace(/_/g," ")}:o?({low:{className:"border-blue-200/50 bg-blue-50/50 text-blue-700 dark:border-blue-900/50 dark:bg-blue-950/30 dark:text-blue-400",label:"Low"},medium:{className:"border-yellow-200/50 bg-yellow-50/50 text-yellow-700 dark:border-yellow-900/50 dark:bg-yellow-950/30 dark:text-yellow-400",label:"Medium"},high:{className:"border-orange-200/50 bg-orange-50/50 text-orange-700 dark:border-orange-900/50 dark:bg-orange-950/30 dark:text-orange-400",label:"High"},urgent:{className:"border-red-200/50 bg-red-50/50 text-red-700 dark:border-red-900/50 dark:bg-red-950/30 dark:text-red-400",label:"Urgent"}})[o]||{className:"border-border/50 bg-background text-muted-foreground",label:o.replace(/_/g," ")}:"purchase_order"===s?({draft:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:"Draft"},pending:{className:"border-yellow-200/50 bg-yellow-50/50 text-yellow-700 dark:border-yellow-900/50 dark:bg-yellow-950/30 dark:text-yellow-400",label:"Pending"},approved:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Approved"},partially_received:{className:"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400",label:"Partially Received"},received:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Received"},cancelled:{className:"border-red-500/50 bg-red-500 text-white hover:bg-red-600",label:"Cancelled"}})[e]||{className:"border-border/50 bg-background text-muted-foreground",label:e.replace(/_/g," ")}:s?function(e,t){switch(t){case"job":return b(e);case"invoice":return({paid:{className:"border-green-500/30 bg-green-500 text-white hover:bg-green-600 shadow-sm",label:"Paid",icon:d.CheckCircle,ariaLabel:"Invoice status: Paid"},unpaid:{className:"border-yellow-200/50 bg-yellow-50/50 text-yellow-700 dark:border-yellow-900/50 dark:bg-yellow-950/30 dark:text-yellow-400 shadow-sm",label:"Unpaid",icon:i.Clock,ariaLabel:"Invoice status: Unpaid"},overdue:{className:"border-red-500/30 bg-red-500 text-white hover:bg-red-600 shadow-sm ring-1 ring-red-500/20",label:"Overdue",icon:l.AlertCircle,ariaLabel:"Invoice status: Overdue - requires immediate attention"},draft:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50 shadow-sm",label:"Draft",icon:n.FileText,ariaLabel:"Invoice status: Draft"},sent:{className:"border-blue-200/50 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400 shadow-sm",label:"Sent",icon:c.Mail,ariaLabel:"Invoice status: Sent"},pending:{className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/20 dark:text-yellow-400 shadow-sm",label:"Pending",icon:i.Clock,ariaLabel:"Invoice status: Pending"}})[e]||{className:"border-border/50 bg-background text-muted-foreground shadow-sm",label:e.replace(/_/g," ")};case"estimate":return({accepted:{className:"bg-green-500 hover:bg-green-600 text-white",label:"Accepted"},sent:{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",label:"Sent"},draft:{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:"Draft"},declined:{className:"bg-red-100 text-red-800 dark:bg-red-900/20 dark:text-red-400",label:"Declined"}})[e]||{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:e.replace(/_/g," ")};case"contract":return({signed:{className:"border-green-500/50 bg-green-500 text-white hover:bg-green-600",label:"Signed"},sent:{className:"border-blue-200 bg-blue-50 text-blue-700 hover:bg-blue-100 dark:border-blue-900 dark:bg-blue-950/50 dark:text-blue-400",label:"Sent"},viewed:{className:"border-purple-200/50 bg-purple-50/50 text-purple-700 dark:border-purple-900/50 dark:bg-purple-950/30 dark:text-purple-400",label:"Viewed"},draft:{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:"Draft"},rejected:{className:"border-red-500/50 bg-red-500 text-white hover:bg-red-600",label:"Rejected"},expired:{className:"border-orange-200/50 bg-orange-50/50 text-orange-700 dark:border-orange-900/50 dark:bg-orange-950/30 dark:text-orange-400",label:"Expired"}})[e]||{className:"border-border/50 bg-background text-muted-foreground hover:bg-muted/50",label:e.replace(/_/g," ")};case"customer":return({active:{className:"bg-green-100 text-green-800 dark:bg-green-900/20 dark:text-green-400",label:"Active"},inactive:{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:"Inactive"},prospect:{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",label:"Prospect"},lead:{className:"bg-blue-100 text-blue-800 dark:bg-blue-900/20 dark:text-blue-400",label:"Lead"}})[e]||{className:"bg-gray-100 text-gray-800 dark:bg-gray-900/20 dark:text-gray-400",label:e.replace(/_/g," ")};default:return{className:"border-border/50 bg-background text-muted-foreground",label:e.replace(/_/g," ")}}}(e,s):b(e)).icon;return(0,t.jsxs)(r.Badge,{className:(0,a.cn)("inline-flex items-center gap-1 px-2 py-0.5 text-[11px] font-medium transition-all duration-200",h.className,m),variant:g,"aria-label":h.ariaLabel||h.label,children:[x&&(0,t.jsx)(x,{className:"h-3 w-3","aria-hidden":"true"}),h.label]})}function g({status:e,className:r}){return(0,t.jsx)(m,{className:r,status:e,type:"job"})}function h({status:e,className:r}){return(0,t.jsx)(m,{className:r,status:e,type:"invoice"})}function x({status:e,className:r}){return(0,t.jsx)(m,{className:r,status:e,type:"estimate"})}function p({status:e,className:r}){return(0,t.jsx)(m,{className:r,status:e,type:"contract"})}function f({status:e,className:r}){return(0,t.jsx)(m,{className:r,status:e,type:"customer"})}function v({priority:e,className:r}){return(0,t.jsx)(m,{className:r,priority:e,status:""})}function k({type:e,className:r}){return(0,t.jsx)(m,{className:r,contractType:e,status:""})}e.s(["ContractStatusBadge",()=>p,"ContractTypeBadge",()=>k,"CustomerStatusBadge",()=>f,"EstimateStatusBadge",()=>x,"InvoiceStatusBadge",()=>h,"JobStatusBadge",()=>g,"PriorityBadge",()=>v,"StatusBadge",()=>m],794712)},957518,e=>{"use strict";let t=(0,e.i(383206).default)("clipboard-list",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);e.s(["default",()=>t])},66774,e=>{"use strict";var t=e.i(957518);e.s(["ClipboardList",()=>t.default])},729768,e=>{"use strict";var t=e.i(111043),r=e.i(550652),a=e.i(560149),l=e.i(66774),s=e.i(176378);e.i(553153);var d=e.i(363712);e.i(889265);var i=e.i(677607),n=e.i(430876),o=e.i(152088);let c=[{id:"draft",name:"Draft",accentColor:"#6B7280"},{id:"sent",name:"Sent",accentColor:"#2563EB"},{id:"accepted",name:"Accepted",accentColor:"#22C55E"},{id:"declined",name:"Declined",accentColor:"#EF4444"}],u=new Map(c.map(e=>[e.id,e.name])),b=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"});function m({estimates:e}){return(0,t.jsx)(n.EntityKanban,{calculateColumnMeta:(e,t)=>{let r=t.filter(t=>t.columnId===e),a=r.reduce((e,t)=>e+t.entity.amount,0);return{count:r.length,total:a}},columns:c,data:e,entityName:"estimates",formatTotal:e=>b.format(e/100),mapToKanbanItem:e=>({id:e.id,columnId:e.status,entity:e,estimate:e}),renderCard:e=>(0,t.jsx)(g,{item:{...e,estimate:e.entity}}),renderDragOverlay:e=>(0,t.jsx)("div",{className:"border-border/70 bg-background/95 w-[280px] rounded-xl border p-4 shadow-lg",children:(0,t.jsx)(g,{item:{...e,estimate:e.entity}})}),showTotals:!0,updateEntityStatus:(e,t)=>({...e,status:t})})}function g({item:e}){let{estimate:n,columnId:c}=e;return(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsx)("div",{className:"flex items-start justify-between gap-3",children:(0,t.jsxs)("div",{className:"space-y-1",children:[(0,t.jsx)("p",{className:"text-muted-foreground text-xs font-semibold tracking-wide uppercase",children:n.estimateNumber}),(0,t.jsx)("h3",{className:"text-foreground text-sm font-semibold",children:n.project}),(0,t.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,t.jsx)(d.Badge,{className:(0,o.cn)("text-xs","declined"===c&&"bg-destructive/10 text-destructive"),variant:"declined"===c?"destructive":"secondary",children:u.get(c)??c}),(0,t.jsx)(d.Badge,{className:"bg-muted/60 text-muted-foreground",variant:"outline",children:b.format(n.amount/100)})]})]})}),(0,t.jsxs)("div",{className:"text-muted-foreground space-y-2 text-xs",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(l.ClipboardList,{className:"text-primary size-4"}),(0,t.jsx)("span",{className:"text-foreground font-medium",children:n.customer})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(a.CalendarDays,{className:"text-primary size-4"}),(0,t.jsxs)("span",{children:[n.date," â†’ ",n.validUntil]})]})]}),(0,t.jsxs)("div",{className:"text-muted-foreground flex items-center justify-between pt-2 text-xs",children:[(0,t.jsxs)("span",{children:["Valid until ",n.validUntil]}),(0,t.jsx)(i.Button,{asChild:!0,className:"text-primary gap-1 text-xs",size:"sm",variant:"ghost",children:(0,t.jsxs)(s.default,{href:`/dashboard/work/estimates/${n.id}`,children:["View",(0,t.jsx)(r.ArrowUpRight,{className:"size-3.5"})]})})]})]})}e.s(["EstimatesKanban",()=>m])},261381,e=>{"use strict";var t=e.i(111043),r=e.i(946672),a=e.i(882896),l=e.i(606661),s=e.i(38614),d=e.i(154115),i=e.i(176378),n=e.i(970799);e.i(235670);var o=e.i(360648);e.i(889265);var c=e.i(677607);e.i(244242);var u=e.i(563078),b=e.i(527756),m=e.i(794712);e.i(116233);var g=e.i(988041),h=e.i(871509);function x({estimates:x,itemsPerPage:p=50,totalCount:f,currentPage:v=1}){let[k,y]=(0,n.useState)({Status:"all",Archive:"active"}),[w,j]=(0,n.useState)(!1),[N,C]=(0,n.useState)(!1),[A,S]=(0,n.useState)(!1),[D,M]=(0,n.useState)(null),[I,F]=(0,n.useState)(new Set),[E,P]=(0,n.useState)(new Set),L=(0,n.useMemo)(()=>{let e={all:x.length,draft:0,sent:0,accepted:0,declined:0,expired:0};for(let t of x)"draft"===t.status?e.draft++:"sent"===t.status?e.sent++:"accepted"===t.status?e.accepted++:"declined"===t.status?e.declined++:"expired"===t.status&&e.expired++;return e},[x]),z=(0,n.useMemo)(()=>{let e=0,t=0;for(let r of x)r.archived_at||r.deleted_at?t++:e++;return{all:x.length,active:e,archived:t}},[x]),T=[{label:"Status",options:[{label:"All Statuses",value:"all",count:L.all},{label:"Draft",value:"draft",count:L.draft},{label:"Sent",value:"sent",count:L.sent},{label:"Accepted",value:"accepted",count:L.accepted},{label:"Declined",value:"declined",count:L.declined},{label:"Expired",value:"expired",count:L.expired}]},{label:"Archive",options:[{label:"Active Only",value:"active",count:z.active},{label:"All Estimates",value:"all",count:z.all},{label:"Archived Only",value:"archived",count:z.archived}]}],B=(0,n.useMemo)(()=>x.filter(e=>{let t=k.Status;if("all"!==t&&e.status!==t)return!1;let r=k.Archive,a=!!(e.archived_at||e.deleted_at);return("active"!==r||!a)&&("archived"!==r||!!a)}),[x,k]),_=+("all"!==k.Status)+ +("active"!==k.Archive),O=[{key:"estimateNumber",header:"Estimate #",width:"w-36",shrink:!0,sortable:!0,hideable:!1,sortFn:(e,t)=>e.estimateNumber.localeCompare(t.estimateNumber),render:e=>(0,t.jsx)(i.default,{className:"text-foreground hover:text-primary text-sm font-medium transition-colors hover:underline",href:`/dashboard/work/estimates/${e.id}`,onClick:e=>e.stopPropagation(),children:e.estimateNumber})},{key:"customer",header:"Customer",width:"w-48",shrink:!0,sortable:!0,hideable:!1,sortFn:(e,t)=>e.customer.localeCompare(t.customer),render:e=>(0,t.jsx)("span",{className:"text-foreground text-sm font-medium",children:e.customer})},{key:"project",header:"Project",width:"flex-1",sortable:!0,hideable:!1,sortFn:(e,t)=>e.project.localeCompare(t.project),render:e=>(0,t.jsx)(i.default,{className:"block min-w-0",href:`/dashboard/work/estimates/${e.id}`,onClick:e=>e.stopPropagation(),children:(0,t.jsx)("span",{className:"text-foreground text-sm leading-tight font-medium hover:underline",children:e.project})})},{key:"date",header:"Date",width:"w-32",shrink:!0,hideOnMobile:!0,sortable:!0,hideable:!0,sortFn:(e,t)=>e.date.localeCompare(t.date),render:e=>(0,t.jsx)("span",{className:"text-muted-foreground text-sm tabular-nums",children:e.date})},{key:"validUntil",header:"Valid Until",width:"w-32",shrink:!0,hideOnMobile:!0,sortable:!0,hideable:!0,sortFn:(e,t)=>e.validUntil.localeCompare(t.validUntil),render:e=>(0,t.jsx)("span",{className:"text-muted-foreground text-sm tabular-nums",children:e.validUntil})},{key:"amount",header:"Amount",width:"w-32",shrink:!0,align:"right",sortable:!0,hideable:!1,sortFn:(e,t)=>e.amount-t.amount,render:e=>(0,t.jsx)("span",{className:"font-semibold tabular-nums",children:(0,h.formatCurrency)(e.amount,{decimals:2})})},{key:"status",header:"Status",width:"w-28",shrink:!0,sortable:!0,hideable:!1,sortFn:(e,t)=>e.status.localeCompare(t.status),render:e=>(0,t.jsx)(m.EstimateStatusBadge,{status:e.status})},{key:"actions",header:"",width:"w-10",shrink:!0,render:e=>(0,t.jsx)("div",{"data-no-row-click":!0,children:(0,t.jsxs)(u.DropdownMenu,{children:[(0,t.jsx)(u.DropdownMenuTrigger,{asChild:!0,children:(0,t.jsx)(c.Button,{size:"icon",variant:"ghost",children:(0,t.jsx)(s.MoreHorizontal,{className:"size-4"})})}),(0,t.jsxs)(u.DropdownMenuContent,{align:"end",children:[(0,t.jsx)(u.DropdownMenuLabel,{children:"Actions"}),(0,t.jsx)(u.DropdownMenuSeparator,{}),(0,t.jsxs)(u.DropdownMenuItem,{children:[(0,t.jsx)(d.Send,{className:"mr-2 size-4"}),"Send to Customer"]}),(0,t.jsxs)(u.DropdownMenuItem,{children:[(0,t.jsx)(a.Download,{className:"mr-2 size-4"}),"Download PDF"]}),(0,t.jsx)(u.DropdownMenuSeparator,{}),(0,t.jsxs)(u.DropdownMenuItem,{className:"text-destructive",onClick:()=>{M(e.id),j(!0)},children:[(0,t.jsx)(r.Archive,{className:"mr-2 size-4"}),"Archive Estimate"]})]})]})})}],[U,R]=(0,n.useState)(!1),$=[{label:"Send",icon:(0,t.jsx)(d.Send,{className:"h-4 w-4"}),onClick:async t=>{if(!U){if(0===B.filter(e=>t.has(e.id)).length){let{toast:t}=await e.A(356202);t.error("No estimates selected");return}P(t),S(!0)}}},{label:"Archive Selected",icon:(0,t.jsx)(r.Archive,{className:"h-4 w-4"}),onClick:async e=>{F(e),C(!0)},variant:"destructive"}];return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(b.FullWidthDataTable,{bulkActions:$,columns:O,data:B,emptyIcon:(0,t.jsx)(l.FileText,{className:"text-muted-foreground mx-auto h-12 w-12"}),emptyMessage:"No estimates found",enableSelection:!0,entity:"estimates",getHighlightClass:()=>"bg-success/30 dark:bg-success/10",getItemId:e=>e.id,isArchived:e=>!!(e.archived_at||e.deleted_at),isHighlighted:e=>"accepted"===e.status,itemsPerPage:p,totalCount:f??B.length,currentPageFromServer:v,serverPagination:!0,onRefresh:()=>window.location.reload(),onRowClick:e=>window.location.href=`/dashboard/work/estimates/${e.id}`,searchFilter:(e,t)=>{let r=t.toLowerCase();return e.estimateNumber.toLowerCase().includes(r)||e.customer.toLowerCase().includes(r)||e.project.toLowerCase().includes(r)||e.status.toLowerCase().includes(r)},searchPlaceholder:"Search estimates by number, customer, project, or status...",showArchived:"active"!==k.Archive,showRefresh:!1,toolbarActions:(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(g.TableFilters,{activeFilters:k,filters:T,onFilterChange:(e,t)=>{y(r=>({...r,[e]:t}))}}),(0,t.jsx)(g.ClearFiltersButton,{count:_,onClear:()=>{y({Status:"all",Archive:"active"})}})]})}),(0,t.jsx)(o.AlertDialog,{onOpenChange:j,open:w,children:(0,t.jsxs)(o.AlertDialogContent,{children:[(0,t.jsxs)(o.AlertDialogHeader,{children:[(0,t.jsx)(o.AlertDialogTitle,{children:"Archive Estimate?"}),(0,t.jsx)(o.AlertDialogDescription,{children:"This estimate will be archived and can be restored within 90 days. After 90 days, it will be permanently deleted."})]}),(0,t.jsxs)(o.AlertDialogFooter,{children:[(0,t.jsx)(o.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(o.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{if(D){let{archiveEstimate:t}=await e.A(672802);await t(D),window.location.reload()}},children:"Archive"})]})]})}),(0,t.jsx)(o.AlertDialog,{onOpenChange:C,open:N,children:(0,t.jsxs)(o.AlertDialogContent,{children:[(0,t.jsxs)(o.AlertDialogHeader,{children:[(0,t.jsxs)(o.AlertDialogTitle,{children:["Archive ",I.size," Estimate(s)?"]}),(0,t.jsx)(o.AlertDialogDescription,{children:"These estimates will be archived and can be restored within 90 days. After 90 days, they will be permanently deleted."})]}),(0,t.jsxs)(o.AlertDialogFooter,{children:[(0,t.jsx)(o.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(o.AlertDialogAction,{className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",onClick:async()=>{let{archiveEstimate:t}=await e.A(672802);for(let e of I)await t(e);window.location.reload()},children:"Archive All"})]})]})}),(0,t.jsx)(o.AlertDialog,{onOpenChange:S,open:A,children:(0,t.jsxs)(o.AlertDialogContent,{children:[(0,t.jsxs)(o.AlertDialogHeader,{children:[(0,t.jsxs)(o.AlertDialogTitle,{children:["Send ",E.size," Estimate(s)?"]}),(0,t.jsxs)(o.AlertDialogDescription,{children:["This will send ",E.size," estimate",1!==E.size?"s":""," via email to your customers.",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),(0,t.jsx)("strong",{children:"Estimated time:"})," ",Math.ceil(.5*E.size)," second",1!==Math.ceil(.5*E.size)?"s":"",(0,t.jsx)("br",{}),(0,t.jsx)("br",{}),"Note: Only estimates with customer email addresses will be sent."]})]}),(0,t.jsxs)(o.AlertDialogFooter,{children:[(0,t.jsx)(o.AlertDialogCancel,{children:"Cancel"}),(0,t.jsx)(o.AlertDialogAction,{onClick:async()=>{S(!1),R(!0);let{useSyncStore:t}=await e.A(431567),{startOperation:r,completeOperation:a}=t.getState(),{toast:l}=await e.A(356202),s=Array.from(E),d=s.length,i=r({type:"bulk_send_estimates",title:`Sending ${d} estimate${1!==d?"s":""}`,description:"Preparing emails...",total:d,current:0});try{let{bulkSendEstimates:t}=await e.A(554355),r=await t(s,{batchSize:10,batchDelay:1e3});r.success||(r.results?.successful??0)>0?(a(i,!0),l.success(r.message)):(a(i,!1,r.error||"Failed to send estimates"),l.error(r.error||"Failed to send estimates")),(r.results?.successful??0)>0&&window.location.reload()}catch(e){a(i,!1,e instanceof Error?e.message:"Failed to send estimates"),l.error(e instanceof Error?e.message:"Failed to send estimates")}finally{R(!1),P(new Set)}},children:"Send Estimates"})]})]})})]})}e.s(["EstimatesTable",()=>x],261381)},356202,e=>{e.v(e=>Promise.resolve().then(()=>e(995403)))},672802,e=>{e.v(t=>Promise.all(["static/chunks/729914b94fa516f9.js"].map(t=>e.l(t))).then(()=>t(148637)))},431567,e=>{e.v(e=>Promise.resolve().then(()=>e(705685)))},554355,e=>{e.v(t=>Promise.all(["static/chunks/f0bbd85b04a86445.js"].map(t=>e.l(t))).then(()=>t(915490)))}]);