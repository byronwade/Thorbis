"use client";

/**
 * Invoice Sidebar Right - Client Component
 *
 * Right-positioned sidebar for invoice customization that matches
 * the left app-sidebar design using shadcn/ui Sidebar component.
 *
 * Features:
 * - Template presets
 * - Color customization
 * - Typography settings
 * - Layout controls
 *
 * Performance optimizations:
 * - Zustand for state management
 * - Selective re-renders with shallow selectors
 * - Uses established sidebar patterns
 */

import {
  Building,
  Columns,
  DollarSign,
  FileCheck,
  FileText,
  Layout,
  Palette,
  QrCode,
  RotateCcw,
  Settings2,
  Sparkles,
  Stamp,
  Type,
} from "lucide-react";
import { Button } from "@/components/ui/button";
import { Input } from "@/components/ui/input";
import { Label } from "@/components/ui/label";
import {
  Select,
  SelectContent,
  SelectItem,
  SelectTrigger,
  SelectValue,
} from "@/components/ui/select";
import { Separator } from "@/components/ui/separator";
import {
  Sidebar,
  SidebarContent,
  SidebarFooter,
  SidebarGroup,
  SidebarGroupLabel,
  SidebarHeader,
} from "@/components/ui/sidebar";
import { Slider } from "@/components/ui/slider";
import { Switch } from "@/components/ui/switch";
import {
  type FontFamily,
  INVOICE_PRESETS,
  type SpacingMode,
  useInvoiceLayoutStore,
} from "@/lib/stores/invoice-layout-store";

// ============================================================================
// Invoice Sidebar Right Component
// ============================================================================

export function InvoiceSidebarRight() {
  const customization = useInvoiceLayoutStore((state) => state.customization);
  const loadPreset = useInvoiceLayoutStore((state) => state.loadPreset);
  const updateColors = useInvoiceLayoutStore((state) => state.updateColors);
  const updateTypography = useInvoiceLayoutStore(
    (state) => state.updateTypography,
  );
  const updateSpacing = useInvoiceLayoutStore((state) => state.updateSpacing);
  const updateLogo = useInvoiceLayoutStore((state) => state.updateLogo);
  const updateLogoPosition = useInvoiceLayoutStore(
    (state) => state.updateLogoPosition,
  );
  const updateLogoSize = useInvoiceLayoutStore((state) => state.updateLogoSize);
  const updateBorderSettings = useInvoiceLayoutStore(
    (state) => state.updateBorderSettings,
  );
  const resetToDefault = useInvoiceLayoutStore((state) => state.resetToDefault);

  // New store actions
  const updateWatermark = useInvoiceLayoutStore(
    (state) => state.updateWatermark,
  );
  const updateQRCode = useInvoiceLayoutStore((state) => state.updateQRCode);
  const updatePaymentLink = useInvoiceLayoutStore(
    (state) => state.updatePaymentLink,
  );
  const updateCurrency = useInvoiceLayoutStore((state) => state.updateCurrency);
  const updateDigitalSignature = useInvoiceLayoutStore(
    (state) => state.updateDigitalSignature,
  );
  const updateVAT = useInvoiceLayoutStore((state) => state.updateVAT);
  const updatePageSettings = useInvoiceLayoutStore(
    (state) => state.updatePageSettings,
  );
  const updateColumnLayout = useInvoiceLayoutStore(
    (state) => state.updateColumnLayout,
  );
  const updateIndustryType = useInvoiceLayoutStore(
    (state) => state.updateIndustryType,
  );

  return (
    <Sidebar collapsible="offcanvas" side="right" variant="inset">
      <SidebarHeader className="border-b">
        <div className="flex items-center gap-2 px-2 py-1">
          <div className="rounded-lg bg-primary/10 p-2">
            <Settings2 className="size-4 text-primary" />
          </div>
          <div className="flex flex-col">
            <span className="font-semibold text-sm">Customize Invoice</span>
            <span className="text-muted-foreground text-xs">
              Design & Layout
            </span>
          </div>
        </div>
      </SidebarHeader>

      <SidebarContent>
        {/* Templates Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Sparkles className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Templates</SidebarGroupLabel>
          </div>
          <div className="space-y-2 px-2">
            {INVOICE_PRESETS.map((preset) => (
              <button
                className={`group relative w-full overflow-hidden rounded-lg border p-3 text-left transition-all hover:border-primary hover:shadow-md ${
                  customization.template === preset.template
                    ? "border-primary bg-primary/5 shadow-md"
                    : "hover:bg-accent/50"
                }`}
                key={preset.id}
                onClick={() => loadPreset(preset)}
                type="button"
              >
                {customization.template === preset.template ? (
                  <div className="absolute top-2 right-2 rounded-full bg-primary p-1">
                    <svg
                      className="size-3 text-primary-foreground"
                      fill="none"
                      stroke="currentColor"
                      strokeWidth="2"
                      viewBox="0 0 24 24"
                    >
                      <path
                        d="M5 13l4 4L19 7"
                        strokeLinecap="round"
                        strokeLinejoin="round"
                      />
                    </svg>
                  </div>
                ) : null}
                <div className="font-medium text-sm">{preset.name}</div>
                <div className="mt-1 text-muted-foreground text-xs leading-relaxed">
                  {preset.description}
                </div>
              </button>
            ))}
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Colors Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Palette className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Colors</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="primary-color">
                Primary Color
              </Label>
              <Input
                className="h-9"
                id="primary-color"
                onChange={(e) => updateColors({ primary: e.target.value })}
                type="color"
                value={customization.colors.primary}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="accent-color">
                Accent Color
              </Label>
              <Input
                className="h-9"
                id="accent-color"
                onChange={(e) => updateColors({ accent: e.target.value })}
                type="color"
                value={customization.colors.accent}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="text-color">
                Text Color
              </Label>
              <Input
                className="h-9"
                id="text-color"
                onChange={(e) => updateColors({ text: e.target.value })}
                type="color"
                value={customization.colors.text}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="text-light-color">
                Secondary Text
              </Label>
              <Input
                className="h-9"
                id="text-light-color"
                onChange={(e) => updateColors({ textLight: e.target.value })}
                type="color"
                value={customization.colors.textLight}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="background-color">
                Background
              </Label>
              <Input
                className="h-9"
                id="background-color"
                onChange={(e) => updateColors({ background: e.target.value })}
                type="color"
                value={customization.colors.background}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="border-color">
                Border Color
              </Label>
              <Input
                className="h-9"
                id="border-color"
                onChange={(e) => updateColors({ border: e.target.value })}
                type="color"
                value={customization.colors.border}
              />
            </div>
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Typography Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Type className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Typography</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="heading-font">
                Heading Font
              </Label>
              <Select
                onValueChange={(value) =>
                  updateTypography({ headingFont: value as FontFamily })
                }
                value={customization.typography.headingFont}
              >
                <SelectTrigger className="h-9" id="heading-font">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="geist-sans">Geist Sans</SelectItem>
                  <SelectItem value="geist-mono">Geist Mono</SelectItem>
                  <SelectItem value="inter">Inter</SelectItem>
                  <SelectItem value="roboto">Roboto</SelectItem>
                  <SelectItem value="open-sans">Open Sans</SelectItem>
                  <SelectItem value="lato">Lato</SelectItem>
                  <SelectItem value="montserrat">Montserrat</SelectItem>
                  <SelectItem value="playfair">Playfair Display</SelectItem>
                  <SelectItem value="merriweather">Merriweather</SelectItem>
                  <SelectItem value="source-sans">Source Sans Pro</SelectItem>
                  <SelectItem value="helvetica">Helvetica</SelectItem>
                  <SelectItem value="arial">Arial</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div>
              <Label className="text-xs" htmlFor="body-font">
                Body Font
              </Label>
              <Select
                onValueChange={(value) =>
                  updateTypography({ bodyFont: value as FontFamily })
                }
                value={customization.typography.bodyFont}
              >
                <SelectTrigger className="h-9" id="body-font">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="geist-sans">Geist Sans</SelectItem>
                  <SelectItem value="geist-mono">Geist Mono</SelectItem>
                  <SelectItem value="inter">Inter</SelectItem>
                  <SelectItem value="roboto">Roboto</SelectItem>
                  <SelectItem value="open-sans">Open Sans</SelectItem>
                  <SelectItem value="lato">Lato</SelectItem>
                  <SelectItem value="montserrat">Montserrat</SelectItem>
                  <SelectItem value="playfair">Playfair Display</SelectItem>
                  <SelectItem value="merriweather">Merriweather</SelectItem>
                  <SelectItem value="source-sans">Source Sans Pro</SelectItem>
                  <SelectItem value="helvetica">Helvetica</SelectItem>
                  <SelectItem value="arial">Arial</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div>
              <Label className="text-xs" htmlFor="heading-size">
                Heading Size
              </Label>
              <Slider
                className="mt-2"
                id="heading-size"
                max={3}
                min={1}
                onValueChange={([value]) =>
                  updateTypography({ headingSize: value })
                }
                step={0.1}
                value={[customization.typography.headingSize]}
              />
              <span className="text-muted-foreground text-xs">
                {customization.typography.headingSize.toFixed(1)}rem
              </span>
            </div>

            <div>
              <Label className="text-xs" htmlFor="body-size">
                Body Size
              </Label>
              <Slider
                className="mt-2"
                id="body-size"
                max={1.5}
                min={0.75}
                onValueChange={([value]) =>
                  updateTypography({ bodySize: value })
                }
                step={0.05}
                value={[customization.typography.bodySize]}
              />
              <span className="text-muted-foreground text-xs">
                {customization.typography.bodySize.toFixed(2)}rem
              </span>
            </div>
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Layout Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Layout className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Layout Settings</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="spacing">
                Spacing
              </Label>
              <Select
                onValueChange={(value) => updateSpacing(value as SpacingMode)}
                value={customization.spacing}
              >
                <SelectTrigger className="h-9" id="spacing">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="compact">Compact</SelectItem>
                  <SelectItem value="normal">Normal</SelectItem>
                  <SelectItem value="relaxed">Relaxed</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <Separator />

            <div>
              <Label className="text-xs" htmlFor="logo-url">
                Logo URL
              </Label>
              <Input
                className="h-9"
                id="logo-url"
                onChange={(e) => updateLogo(e.target.value)}
                placeholder="https://example.com/logo.png"
                type="url"
                value={customization.logo || ""}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="logo-position">
                Logo Position
              </Label>
              <Select
                onValueChange={(value) =>
                  updateLogoPosition(value as "left" | "center" | "right")
                }
                value={customization.logoPosition}
              >
                <SelectTrigger className="h-9" id="logo-position">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="left">Left</SelectItem>
                  <SelectItem value="center">Center</SelectItem>
                  <SelectItem value="right">Right</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div>
              <Label className="text-xs" htmlFor="logo-size">
                Logo Size
              </Label>
              <Slider
                className="mt-2"
                id="logo-size"
                max={200}
                min={60}
                onValueChange={([value]) => updateLogoSize(value)}
                step={10}
                value={[customization.logoSize]}
              />
              <span className="text-muted-foreground text-xs">
                {customization.logoSize}px
              </span>
            </div>

            <Separator />

            <div>
              <Label className="text-xs" htmlFor="border-radius">
                Border Radius
              </Label>
              <Slider
                className="mt-2"
                id="border-radius"
                max={24}
                min={0}
                onValueChange={([value]) =>
                  updateBorderSettings(
                    customization.showBorder,
                    value,
                    customization.shadowEnabled,
                  )
                }
                step={1}
                value={[customization.borderRadius]}
              />
              <span className="text-muted-foreground text-xs">
                {customization.borderRadius}px
              </span>
            </div>
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Watermark Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Stamp className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Watermark</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="watermark-enabled">
                Enable Watermark
              </Label>
              <Switch
                checked={customization.watermarkEnabled}
                id="watermark-enabled"
                onCheckedChange={(checked) =>
                  updateWatermark(
                    checked,
                    customization.watermarkText,
                    customization.watermarkOpacity,
                    customization.watermarkPosition,
                  )
                }
              />
            </div>

            {customization.watermarkEnabled && (
              <>
                <div>
                  <Label className="text-xs" htmlFor="watermark-text">
                    Watermark Text
                  </Label>
                  <Input
                    className="h-9"
                    id="watermark-text"
                    onChange={(e) =>
                      updateWatermark(
                        customization.watermarkEnabled,
                        e.target.value,
                        customization.watermarkOpacity,
                        customization.watermarkPosition,
                      )
                    }
                    placeholder="DRAFT"
                    value={customization.watermarkText || ""}
                  />
                </div>

                <div>
                  <Label className="text-xs" htmlFor="watermark-opacity">
                    Opacity
                  </Label>
                  <Slider
                    className="mt-2"
                    id="watermark-opacity"
                    max={100}
                    min={0}
                    onValueChange={([value]) =>
                      updateWatermark(
                        customization.watermarkEnabled,
                        customization.watermarkText,
                        value,
                        customization.watermarkPosition,
                      )
                    }
                    step={5}
                    value={[customization.watermarkOpacity]}
                  />
                  <span className="text-muted-foreground text-xs">
                    {customization.watermarkOpacity}%
                  </span>
                </div>

                <div>
                  <Label className="text-xs" htmlFor="watermark-position">
                    Position
                  </Label>
                  <Select
                    onValueChange={(value) =>
                      updateWatermark(
                        customization.watermarkEnabled,
                        customization.watermarkText,
                        customization.watermarkOpacity,
                        value as "center" | "diagonal" | "top-right",
                      )
                    }
                    value={customization.watermarkPosition}
                  >
                    <SelectTrigger className="h-9" id="watermark-position">
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="center">Center</SelectItem>
                      <SelectItem value="diagonal">Diagonal</SelectItem>
                      <SelectItem value="top-right">Top Right</SelectItem>
                    </SelectContent>
                  </Select>
                </div>
              </>
            )}
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Payment Features Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <QrCode className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Payment Features</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="qr-enabled">
                QR Code
              </Label>
              <Switch
                checked={customization.qrCodeEnabled}
                id="qr-enabled"
                onCheckedChange={(checked) =>
                  updateQRCode(
                    checked,
                    customization.qrCodeType,
                    customization.qrCodeData,
                  )
                }
              />
            </div>

            {customization.qrCodeEnabled && (
              <>
                <div>
                  <Label className="text-xs" htmlFor="qr-type">
                    QR Code Type
                  </Label>
                  <Select
                    onValueChange={(value) =>
                      updateQRCode(
                        customization.qrCodeEnabled,
                        value as "payment-link" | "venmo" | "crypto" | "custom",
                        customization.qrCodeData,
                      )
                    }
                    value={customization.qrCodeType}
                  >
                    <SelectTrigger className="h-9" id="qr-type">
                      <SelectValue />
                    </SelectTrigger>
                    <SelectContent>
                      <SelectItem value="payment-link">Payment Link</SelectItem>
                      <SelectItem value="venmo">Venmo</SelectItem>
                      <SelectItem value="crypto">Cryptocurrency</SelectItem>
                      <SelectItem value="custom">Custom</SelectItem>
                    </SelectContent>
                  </Select>
                </div>

                <div>
                  <Label className="text-xs" htmlFor="qr-data">
                    QR Code Data
                  </Label>
                  <Input
                    className="h-9"
                    id="qr-data"
                    onChange={(e) =>
                      updateQRCode(
                        customization.qrCodeEnabled,
                        customization.qrCodeType,
                        e.target.value,
                      )
                    }
                    placeholder="Payment URL or data"
                    value={customization.qrCodeData || ""}
                  />
                </div>
              </>
            )}

            <Separator />

            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="payment-link-enabled">
                Payment Link
              </Label>
              <Switch
                checked={customization.paymentLinkEnabled}
                id="payment-link-enabled"
                onCheckedChange={(checked) =>
                  updatePaymentLink(checked, customization.paymentLinkURL)
                }
              />
            </div>

            {customization.paymentLinkEnabled && (
              <div>
                <Label className="text-xs" htmlFor="payment-link-url">
                  Payment URL
                </Label>
                <Input
                  className="h-9"
                  id="payment-link-url"
                  onChange={(e) =>
                    updatePaymentLink(
                      customization.paymentLinkEnabled,
                      e.target.value,
                    )
                  }
                  placeholder="https://pay.example.com"
                  type="url"
                  value={customization.paymentLinkURL || ""}
                />
              </div>
            )}
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Currency Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <DollarSign className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Currency</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="currency">
                Currency
              </Label>
              <Select
                onValueChange={(value) =>
                  updateCurrency(
                    value,
                    customization.currencySymbol,
                    customization.currencyPosition,
                    customization.showCurrencyCode,
                  )
                }
                value={customization.currency}
              >
                <SelectTrigger className="h-9" id="currency">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="USD">USD - US Dollar</SelectItem>
                  <SelectItem value="EUR">EUR - Euro</SelectItem>
                  <SelectItem value="GBP">GBP - British Pound</SelectItem>
                  <SelectItem value="CAD">CAD - Canadian Dollar</SelectItem>
                  <SelectItem value="AUD">AUD - Australian Dollar</SelectItem>
                  <SelectItem value="JPY">JPY - Japanese Yen</SelectItem>
                  <SelectItem value="CNY">CNY - Chinese Yuan</SelectItem>
                  <SelectItem value="INR">INR - Indian Rupee</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div>
              <Label className="text-xs" htmlFor="currency-symbol">
                Currency Symbol
              </Label>
              <Input
                className="h-9"
                id="currency-symbol"
                maxLength={3}
                onChange={(e) =>
                  updateCurrency(
                    customization.currency,
                    e.target.value,
                    customization.currencyPosition,
                    customization.showCurrencyCode,
                  )
                }
                placeholder="$"
                value={customization.currencySymbol || ""}
              />
            </div>

            <div>
              <Label className="text-xs" htmlFor="currency-position">
                Symbol Position
              </Label>
              <Select
                onValueChange={(value) =>
                  updateCurrency(
                    customization.currency,
                    customization.currencySymbol,
                    value as "before" | "after",
                    customization.showCurrencyCode,
                  )
                }
                value={customization.currencyPosition}
              >
                <SelectTrigger className="h-9" id="currency-position">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="before">Before ($100)</SelectItem>
                  <SelectItem value="after">After (100$)</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="show-currency-code">
                Show Currency Code
              </Label>
              <Switch
                checked={customization.showCurrencyCode}
                id="show-currency-code"
                onCheckedChange={(checked) =>
                  updateCurrency(
                    customization.currency,
                    customization.currencySymbol,
                    customization.currencyPosition,
                    checked,
                  )
                }
              />
            </div>
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Compliance & Legal Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <FileCheck className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Compliance & Legal</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="digital-signature-enabled">
                Digital Signature
              </Label>
              <Switch
                checked={customization.digitalSignatureEnabled}
                id="digital-signature-enabled"
                onCheckedChange={(checked) =>
                  updateDigitalSignature(
                    checked,
                    customization.digitalSignatureImage,
                  )
                }
              />
            </div>

            {customization.digitalSignatureEnabled && (
              <div>
                <Label className="text-xs" htmlFor="signature-image">
                  Signature Image URL
                </Label>
                <Input
                  className="h-9"
                  id="signature-image"
                  onChange={(e) =>
                    updateDigitalSignature(
                      customization.digitalSignatureEnabled,
                      e.target.value,
                    )
                  }
                  placeholder="https://example.com/signature.png"
                  type="url"
                  value={customization.digitalSignatureImage || ""}
                />
              </div>
            )}

            <Separator />

            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="vat-enabled">
                VAT Enabled
              </Label>
              <Switch
                checked={customization.vatEnabled}
                id="vat-enabled"
                onCheckedChange={(checked) =>
                  updateVAT(
                    checked,
                    customization.vatNumber,
                    customization.vatRate,
                  )
                }
              />
            </div>

            {customization.vatEnabled && (
              <>
                <div>
                  <Label className="text-xs" htmlFor="vat-number">
                    VAT Number
                  </Label>
                  <Input
                    className="h-9"
                    id="vat-number"
                    onChange={(e) =>
                      updateVAT(
                        customization.vatEnabled,
                        e.target.value,
                        customization.vatRate,
                      )
                    }
                    placeholder="GB123456789"
                    value={customization.vatNumber || ""}
                  />
                </div>

                <div>
                  <Label className="text-xs" htmlFor="vat-rate">
                    VAT Rate (%)
                  </Label>
                  <Input
                    className="h-9"
                    id="vat-rate"
                    onChange={(e) =>
                      updateVAT(
                        customization.vatEnabled,
                        customization.vatNumber,
                        Number.parseFloat(e.target.value) || 0,
                      )
                    }
                    placeholder="20"
                    type="number"
                    value={customization.vatRate || ""}
                  />
                </div>
              </>
            )}
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Page Settings Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <FileText className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Page Settings</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="page-size">
                Page Size
              </Label>
              <Select
                onValueChange={(value) =>
                  updatePageSettings(
                    value as "A4" | "Letter" | "Legal" | "A5",
                    customization.pageOrientation,
                    customization.showPageNumbers,
                    customization.pageNumberPosition,
                  )
                }
                value={customization.pageSize}
              >
                <SelectTrigger className="h-9" id="page-size">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="Letter">Letter (8.5" × 11")</SelectItem>
                  <SelectItem value="A4">A4 (210mm × 297mm)</SelectItem>
                  <SelectItem value="Legal">Legal (8.5" × 14")</SelectItem>
                  <SelectItem value="A5">A5 (148mm × 210mm)</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div>
              <Label className="text-xs" htmlFor="page-orientation">
                Orientation
              </Label>
              <Select
                onValueChange={(value) =>
                  updatePageSettings(
                    customization.pageSize,
                    value as "portrait" | "landscape",
                    customization.showPageNumbers,
                    customization.pageNumberPosition,
                  )
                }
                value={customization.pageOrientation}
              >
                <SelectTrigger className="h-9" id="page-orientation">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="portrait">Portrait</SelectItem>
                  <SelectItem value="landscape">Landscape</SelectItem>
                </SelectContent>
              </Select>
            </div>

            <div className="flex items-center justify-between">
              <Label className="text-xs" htmlFor="show-page-numbers">
                Show Page Numbers
              </Label>
              <Switch
                checked={customization.showPageNumbers}
                id="show-page-numbers"
                onCheckedChange={(checked) =>
                  updatePageSettings(
                    customization.pageSize,
                    customization.pageOrientation,
                    checked,
                    customization.pageNumberPosition,
                  )
                }
              />
            </div>

            {customization.showPageNumbers && (
              <div>
                <Label className="text-xs" htmlFor="page-number-position">
                  Page Number Position
                </Label>
                <Select
                  onValueChange={(value) =>
                    updatePageSettings(
                      customization.pageSize,
                      customization.pageOrientation,
                      customization.showPageNumbers,
                      value as "top" | "bottom",
                    )
                  }
                  value={customization.pageNumberPosition}
                >
                  <SelectTrigger className="h-9" id="page-number-position">
                    <SelectValue />
                  </SelectTrigger>
                  <SelectContent>
                    <SelectItem value="top">Top</SelectItem>
                    <SelectItem value="bottom">Bottom</SelectItem>
                  </SelectContent>
                </Select>
              </div>
            )}
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Column Layout Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Columns className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Column Layout</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="column-layout">
                Layout
              </Label>
              <Select
                onValueChange={(value) =>
                  updateColumnLayout(
                    value as "single" | "two-column" | "three-column",
                  )
                }
                value={customization.columnLayout}
              >
                <SelectTrigger className="h-9" id="column-layout">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="single">Single Column</SelectItem>
                  <SelectItem value="two-column">Two Columns</SelectItem>
                  <SelectItem value="three-column">Three Columns</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>
        </SidebarGroup>

        <Separator className="my-2" />

        {/* Industry Type Group */}
        <SidebarGroup>
          <div className="flex items-center gap-2 px-2">
            <Building className="size-4 text-muted-foreground" />
            <SidebarGroupLabel>Industry Type</SidebarGroupLabel>
          </div>
          <div className="space-y-3 px-2">
            <div>
              <Label className="text-xs" htmlFor="industry-type">
                Industry
              </Label>
              <Select
                onValueChange={(value) =>
                  updateIndustryType(
                    value as
                      | "construction"
                      | "consulting"
                      | "retail"
                      | "healthcare"
                      | "tech"
                      | "general",
                  )
                }
                value={customization.industryType || "general"}
              >
                <SelectTrigger className="h-9" id="industry-type">
                  <SelectValue />
                </SelectTrigger>
                <SelectContent>
                  <SelectItem value="general">General Business</SelectItem>
                  <SelectItem value="construction">Construction</SelectItem>
                  <SelectItem value="consulting">Consulting</SelectItem>
                  <SelectItem value="retail">Retail</SelectItem>
                  <SelectItem value="healthcare">Healthcare</SelectItem>
                  <SelectItem value="tech">Technology</SelectItem>
                </SelectContent>
              </Select>
            </div>
          </div>
        </SidebarGroup>
      </SidebarContent>

      <SidebarFooter className="border-t">
        <div className="p-2">
          <Button
            className="w-full gap-2"
            onClick={() => resetToDefault()}
            size="sm"
            variant="outline"
          >
            <RotateCcw className="size-4" />
            Reset to Default
          </Button>
        </div>
      </SidebarFooter>
    </Sidebar>
  );
}
